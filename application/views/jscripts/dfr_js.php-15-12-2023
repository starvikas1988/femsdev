<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<style>
    .datepicker-modal {
        position: absolute !important;
        top: auto !important;
        left: auto !important;
    }
</style>

<script type="text/javascript">
    $(function () {

        $("#start_date").datepicker({
            maxDate: new Date()
        });
        $("#end_date").datepicker({
            maxDate: new Date()
        });


    });
    $('.number-only-no-minus-also').keyup(function (e) {
        // if(this.value!='-')
        while (isNaN(this.value))
            this.value = this.value.split('').reverse().join('').replace(/[\D]/i, '')
                    .split('').reverse().join('');
    });

    $('.character-only').keydown(function (e) {
        $("#mother_name_status").html("");
        if (e.altKey) {
            e.preventDefault();
        } else {
            var key = e.keyCode;
            if (!((key == 8) || (key == 32) || (key == 46) || (key == 190) || (key >= 35 && key <= 40) || (key >= 65 && key <= 90))) {
                $("#mother_name_status").html("only Alphabate and space allowed");
                e.preventDefault();
            }
        }
    });


    var office_id = "<?php echo get_user_office_id(); ?>";

    function finalselection() {

        //-- DISABLED ON 25 MARCH 2021 ----//
        //father_husband_name - removed required field
        //social_security_no - removed required field

        /*var off_id=$('.frmfinalSelection #location').val();
         
         var f_h_name = $.trim($('#father_husband_name').val()).length;
         var ss_name = $.trim($('#social_security_no').val()).length;
         
         if(isIndiaLocation(off_id)==true){
         if(f_h_name < 5 || ss_name < 12){
         alert("Please fill the Father/Husband Name and Social Security No/Aadhaar No field's, space prohibited");
         return false;
         }
         }else{
         return true;
         }*/

        return true;
    }



    $(document).ready(function () {

        $('.cspl').hide();
        $('#csplBonus').hide();

        var baseURL = "<?php echo base_url(); ?>";
        var location = "<?php echo get_user_office_id(); ?>";
        ////////////////////Requisition JS Part////////////////////
        ////////	

        $(function () {
            $("#proposed_date_add").datepicker();
            $("#proposed_date_edit").datepicker();
        });
        $(function () {
            var currentDate = new Date();
            //$("#due_date").datepicker({minDate:0});
            $("#due_date1").datepicker({
                minDate: 0
            });
            //$('#due_date').datepicker().datepicker('setDate',currentDate.addDays(10));
        });
        $("#date_from").datepicker();
        $("#date_to").datepicker();
		
        $("#fclient_id").change(function () {
            var client_id = $(this).val();
            populate_process_combo_dfr(client_id, '', 'fprocess_id', 'Y');
        });
		
        $("#fdclient_id").change(function () {
            var client_id = $(this).val();
            populate_process_combo(client_id, '', 'fdprocess_id', 'N');
        });
        ////////////////////////
        $("#department_id").change(function () {
            var departmentid = $(this).val();
            if (departmentid == 6) {
                $("#job_title").attr("required", true);
                $('#due_date').datepicker().datepicker('setDate', new Date().addDays(28));
                $('#proposed_date_add').datepicker().datepicker('setDate', new Date().addDays(28));
            } else {
                $("#job_title").attr("required", false);
                $('#due_date').datepicker().datepicker('setDate', new Date().addDays(45));
                $('#proposed_date_add').datepicker().datepicker('setDate', new Date().addDays(45));
            }
            /////////////////	

        });
        /////////////////////		
        /*************************chandigarh********************************/
        $("#location").change(function () {
            var loc = $(this).val();
            // alert(loc);
            if (loc == 'CHA') {
                $('.frmAddRequisition #proposed_date_add_col').css('display', 'block');
                $('.frmAddRequisition .brand').val("12");
                $(".frmAddRequisition .site_cspl").css("display", "block");
                $(".frmAddRequisition .site").prop('required', true);
                // $(".site_cspl").css("display","block");
            } else {
                $('.frmAddRequisition #proposed_date_add_col').css('display', 'none');

                $('.frmAddRequisition .brand').val("");                
                $('#company_brand').selectize()[0].selectize.clear();

                $(".frmAddRequisition .site_cspl").css("display", "none");
                $(".frmAddRequisition .site").removeAttr("required");
                // $(".site_cspl").css("display","none");
            }
        });
        /*****************************************************************/

        $("#fdprocess_id").change(function () {
            var process_id = $(this).val();
            // alert(process_id);
            var office_id = $(".location").val();
            var edit_flag = '0';
            // // alert(process_id);
            baseURL = "<?php echo base_url(); ?>";
            request_url = baseURL + "dfr/auto_batch_name";
            datas = {'process_id': process_id, 'office_id': office_id, 'edit_flag': edit_flag};
            process_ajax(function (response)
            {
                // alert(response);
                $(".job_title").val($.trim(response));
                //console.log(response);
            }, request_url, datas, 'text');

        });

        //Location wise batch name/job title  auto generate code start here on 22/09/2022 by goutam
        $(".location").change(function () {
            var office_id = $(this).val();
            // alert(process_id);
            var edit_flag = '0';
            var process_id = $("#fdprocess_id").val();
            if (process_id != '') {
                //  alert(process_id);
                baseURL = "<?php echo base_url(); ?>";
                request_url = baseURL + "dfr/auto_batch_name";
                datas = {'process_id': process_id, 'office_id': office_id, 'edit_flag': edit_flag};
                process_ajax(function (response)
                {
                    $(".job_title").val($.trim(response));
                    //console.log(response);
                }, request_url, datas, 'text');

            }

        });
        $(".edit_location").change(function () {

            var job_title = $(".job_title").val();
            // var r_id=$("#r_id").val();
            var batch_id = job_title.split("/");
            var batch = batch_id[4];
            // var r_id=batch_id[5];

            // alert(batch+r_id);
            var office_id = $(this).val();
            var edit_flag = '1';
            // alert(process_id);
            var process_id = $("#fedprocess_id").val();
            if (process_id != '') {
                //  alert(process_id);
                baseURL = "<?php echo base_url(); ?>";
                request_url = baseURL + "dfr/auto_batch_name";
                datas = {'process_id': process_id, 'office_id': office_id, 'edit_flag': edit_flag, 'batch_id': batch};
                process_ajax(function (response)
                {
                    $(".job_title").val($.trim(response));
                    //console.log(response);
                }, request_url, datas, 'text');

            }

        });

        $("#fedprocess_id").change(function () {
            var process_id = $(this).val();
            // alert(process_id);
            var office_id = $(".edit_location").val();
            var edit_flag = '1';
            var job_title = $(".job_title").val();
            // var r_id=$("#r_id").val();
            var batch_id = job_title.split("/");
            var batch = batch_id[4];
            // var r_id=batch_id[5];
            // // alert(process_id);
            baseURL = "<?php echo base_url(); ?>";
            request_url = baseURL + "dfr/auto_batch_name";
            datas = {'process_id': process_id, 'office_id': office_id, 'edit_flag': edit_flag, 'batch_id': batch};
            process_ajax(function (response)
            {
                // alert(response);
                $(".job_title").val($.trim(response));
                //console.log(response);
            }, request_url, datas, 'text');

        });



        // Location wise batch name/job title aoto generate code end here on 22/09/2022 by goutam






        $(".addRequisition").click(function () {
            $("#addRequisitionModel").modal('show');
        });
        $("#fedclient_id").change(function () {
            var client_id = $(this).val();
            populate_process_simple(client_id, '', 'fedprocess_id', 'N');
        });
        $('.frmEditRequisition #location').change(function () {
            var loc = $('.frmEditRequisition #location').val();
            if (loc == 'CHA') {
                $('#proposed_date_edit_col').css('display', '');
                $(".frmEditRequisition .site_cspl").css("display", "block");
                $(".frmEditRequisition .site").prop('required', true);
                $('.frmEditRequisition #company_brand').val("12");
            } else {
                $('#proposed_date_edit_col').css('display', 'none');
                $(".frmEditRequisition .site_cspl").css("display", "none");
                $(".frmEditRequisition .site").removeAttr("required");
                $('.frmEditRequisition #company_brand').val("");
            }
        });


        $(document).on('click', ".editRequisition", function () {

            var params = $(this).attr("params");

            //alert(params);

            var r_id = $(this).attr("r_id");
            var requisition_id = $(this).attr("requisition_id");
            var arrPrams = params.split("#");
            //  alert(arrPrams[21]);
            // alert(arrPrams[23]);
            if (arrPrams[0] == 'CHA') {

                $('#proposed_date_edit_col').css('display', '');
                $(".frmEditRequisition .site_cspl").css("display", "block");
                $(".frmEditRequisition .site").prop('required', true);
            } else {
                $('#proposed_date_edit_col').css('display', 'none');
                $(".frmEditRequisition .site_cspl").css("display", "none");
                $(".frmEditRequisition .site").removeAttr("required");
            }

            $('#r_id').val(r_id);
            $('#requisition_id').val(requisition_id);


            if (arrPrams[21] == 'editme') {

                //$('.frmEditRequisition #location').data('selectize').setValue(arrPrams[0]);

                $('.frmEditRequisition #location').val(arrPrams[0]);
                $('.frmEditRequisition #department_id').val(arrPrams[2]);
                $('.frmEditRequisition #req_type').val(arrPrams[14]);
                $('.frmEditRequisition #company_brand').val(arrPrams[16]);
                $('.frmEditRequisition #role_id').val(arrPrams[3]);
                $('.frmEditRequisition #fedclient_id').val(arrPrams[4]);
                $('.frmEditRequisition #fedprocess_id').val(arrPrams[5]);
                $('.frmEditRequisition #employee_status').val(arrPrams[6]);
                $('.frmEditRequisition .site').val(arrPrams[20]);
            }

            let sel = new Array();
            if (arrPrams[23] == '1') {
                $(".frmEditRequisition .asset_required").css("display", "block");
                let arr = arrPrams[24];
                
                sel = arr.split(',');
                $(".frmEditRequisition #asset_requisition").multiselect('clearSelection');
                $(".frmEditRequisition #asset_requisition").multiselect('select', sel);
                $(".frmEditRequisition #asset_requisition").attr("required", true);
                $(".frmEditRequisition #asset_requisition").multiselect('refresh');
                $('#sktPleaseWait').modal('show');
                $.post(baseURL + "Requisition/getRequisitionAssetsData", {
                    sel: sel,
                    r_id: r_id
                }).done(function (respon) {
                    console.log(respon);
                    $('#sktPleaseWait').modal('hide');
                    if (respon != '0') {
                        var dat_asset = JSON.parse(respon);
                        let string = "";
                        $.each(dat_asset, function (r) {
                            string += '<div class="col-md-4">\
                                <div class="form-group">\
                                    <label>' + dat_asset[r].name + ' Count</label>\
                                   <input type="number" id="ast_id_' + dat_asset[r].assets_id + '" name="ast_id_' + dat_asset[r].assets_id + '" class="form-control asset_id" value="' + dat_asset[r].assets_required + '" step="1" min="1" placeholder="Enter Req. ' + dat_asset[r].name + ' count..." required>\
                                </div>\
                            </div>';
                        });
                        $(".assets_count").css('display', 'block');
                        $(".assets_count").html(string);
                    }

                });
            } else {
                $(".frmEditRequisition #asset_requisition").multiselect('clearSelection');
                $(".frmEditRequisition #asset_requisition").multiselect('refresh');
                $(".frmEditRequisition #asset_requisition").attr("required", false);
            }


            $('.frmEditRequisition #r_id').val(r_id);
            $('.frmEditRequisition #location').val(arrPrams[0]);
            // $('.frmEditRequisition #location').prop('disabled', true);
            $('.frmEditRequisition #due_date1').val(arrPrams[1]);
            $('.frmEditRequisition #due_date_edit').val(arrPrams[1]);
            $('.frmEditRequisition #department_id').val(arrPrams[2]);
            $('.frmEditRequisition #role_id').val(arrPrams[3]);
            $('.frmEditRequisition #fedclient_id').val(arrPrams[4]);
            $('.frmEditRequisition #fedprocess_id').val(arrPrams[5]);
            $('.frmEditRequisition #employee_status').val(arrPrams[6]);
            $('.frmEditRequisition #req_qualification').val(arrPrams[7]);
            $('.frmEditRequisition #req_exp_range').val(arrPrams[8]);
            $('.frmEditRequisition #is_asset').val(arrPrams[23]);
            $('.frmEditRequisition #work_type').val(arrPrams[22]);
            $('.frmEditRequisition #req_no_position').val(arrPrams[9]);
            $('.frmEditRequisition #job_title').val(arrPrams[10]);
            $('.frmEditRequisition #job_desc').val(arrPrams[11]);
            $('.frmEditRequisition #req_skill').val(arrPrams[12]);
            $('.frmEditRequisition #additional_info').val(arrPrams[13]);
            $('.frmEditRequisition #req_type').val(arrPrams[14]);
            $('.frmEditRequisition #proposed_date_edit').val(arrPrams[15]);
            $('.frmEditRequisition #company_brand').val(arrPrams[16]);
            $('.frmEditRequisition .site').val(arrPrams[20]);
            // alert(arrPrams[20]);

            //$('.frmEditRequisition #filled_no_position').val(arrPrams[14]);

            if (arrPrams[0] != '' && arrPrams[3] != '' && arrPrams[4] != '' && arrPrams[5] != '') {
                var location_txt = $(".frmEditRequisition #location :selected").text();
                var role_txt = $(".frmEditRequisition #role_id :selected").text();
                var client_txt = $(".frmEditRequisition #fedclient_id :selected").text();
                var process_txt = $(".frmEditRequisition #fedprocess_id :selected").text();           
                $('#job_description_view_div').show();
                $('#job_description_modal_view_title').text(location_txt+' - '+client_txt+' - '+process_txt+' - '+role_txt);
            
            $.ajax({
                type: 'POST',
                url: "<?php echo base_url('dfr/get_job_description'); ?>",
                data: 'role_id=' + arrPrams[3] + '&client_id=' + arrPrams[4] + '&process_id=' + arrPrams[5] + '&location=' + arrPrams[0],
                success: function(str) {
                    //alert(str);
                    var jd_data = str.split("#@");
                    

                    if (jd_data[0].trim() == '0') {
                        //alert('1');
                        <?php if(access_job_description()== true) { ?>
                        $('#job_description_view_title').text('Job description does not exist, Please add job description to update the requisition. ');
                        $('#job_description_view_title').css('pointer-events', 'none'); 
                        $('#job_description_view_title').addClass("noclick_view_job");
                        $('#job_description_view_title').removeClass("view_job"); 
                        <?php } else { ?>
                        $('#job_description_view_title').text('Job description does not exist, please contact your local HR/WFM manager'); 
                        $('#job_description_view_title').css('pointer-events', 'none'); 
                        $('#job_description_view_title').addClass("noclick_view_job");
                        $('#job_description_view_title').removeClass("view_job"); 
                        <?php } ?>

                        
                        $('#editreqjdview').hide();                        
                        $('#editreqjdview').html('');
                        $('.frmEditRequisition #job_desc').val('');                         
                        $('#jd_view_msg').css("display", "none");
                        

                    } else {
                        //alert('2');
                        $('#job_description_view_title').text('View Job Description');
                        $('#job_description_view_title').css('pointer-events', 'auto');
                        $('#job_description_view_title').removeClass("noclick_view_job");
                        $('#job_description_view_title').addClass("view_job");
                        
                        $('#editreqjdview').show();                        
                        $('#jd_view_msg').show();                      
                        
                        var textarea = jd_data[1].trim();
                        var find = ["\r\n", "\n", "\r"];
                        var replace = ["<br/>", "<br/>", "<br/>"];

                        textarea = textarea.replace(new RegExp("(" + find.map(function(i){return i.replace(/[.?*+^$[\]\\(){}|-]/g, "\\$&")}).join("|") + ")", "g"), function(s){ return replace[find.indexOf(s)]});

                        $('#editreqjdview').html(textarea);
                        $('.frmEditRequisition #job_desc').val(jd_data[1].trim());                       

                    }

                },
                error: function() {
                    alert('Something Went Wrong!');
                }
            });
        } 

            $("#editRequisitionModel").modal('show');

        });

        $('.frmEditRequisition #role_id').change(function () {

                var location = $(".frmEditRequisition #location").val();
                var role_id = $(".frmEditRequisition #role_id").val();
                var client_id = $(".frmEditRequisition #fedclient_id").val();
                var process_id = $(".frmEditRequisition #fedprocess_id").val();  

                if (location != '' && role_id != '' && client_id != '' && process_id != '') {
                    var location_txt = $(".frmEditRequisition #location :selected").text();
                    var role_txt = $(".frmEditRequisition #role_id :selected").text();
                    var client_txt = $(".frmEditRequisition #fedclient_id :selected").text();
                    var process_txt = $(".frmEditRequisition #fedprocess_id :selected").text();           
                    $('#job_description_view_div').show();
                    $('#job_description_modal_view_title').text(location_txt+' - '+client_txt+' - '+process_txt+' - '+role_txt);
                
                $.ajax({
                    type: 'POST',
                    url: "<?php echo base_url('dfr/get_job_description'); ?>",
                    data: 'role_id=' + role_id + '&client_id=' + client_id + '&process_id=' + process_id + '&location=' + location,
                    success: function(str) {
                        //alert(str);
                        var jd_data = str.split("#@");
                        

                        if (jd_data[0].trim() == '0') {
                            //alert('1');
                            <?php if(access_job_description()== true) { ?>
                            $('#job_description_view_title').text('Job description does not exist, Please add job description to update the requisition. ');
                            $('#job_description_view_title').css('pointer-events', 'none'); 
                            $('#job_description_view_title').addClass("noclick_view_job");
                            $('#job_description_view_title').removeClass("view_job"); 
                            <?php } else { ?>
                            $('#job_description_view_title').text('Job description does not exist, please contact your local HR/WFM manager'); 
                            $('#job_description_view_title').css('pointer-events', 'none'); 
                            $('#job_description_view_title').addClass("noclick_view_job");
                            $('#job_description_view_title').removeClass("view_job"); 
                            <?php } ?>

                            
                            $('#editreqjdview').hide();                        
                            $('#editreqjdview').html('');
                            $('.frmEditRequisition #job_desc').val('');                         
                            $('#jd_view_msg').css("display", "none");
                            

                        } else {
                            //alert('2');
                            $('#job_description_view_title').text('View Job Description');
                            $('#job_description_view_title').css('pointer-events', 'auto');
                            $('#job_description_view_title').removeClass("noclick_view_job");
                            $('#job_description_view_title').addClass("view_job");
                            
                            $('#editreqjdview').show();                        
                            $('#jd_view_msg').show();                      
                            
                            var textarea = jd_data[1].trim();
                            var find = ["\r\n", "\n", "\r"];
                            var replace = ["<br/>", "<br/>", "<br/>"];

                            textarea = textarea.replace(new RegExp("(" + find.map(function(i){return i.replace(/[.?*+^$[\]\\(){}|-]/g, "\\$&")}).join("|") + ")", "g"), function(s){ return replace[find.indexOf(s)]});

                            $('#editreqjdview').html(textarea);
                            $('.frmEditRequisition #job_desc').val(jd_data[1].trim());                       

                        }

                    },
                    error: function() {
                        alert('Something Went Wrong!');
                    }
                });
            } 
        });

        $(document).on('click', '#close_jd', function() {                   
            $("#job_description_edit_view").modal('hide');
        });

        $(document).on('click', '.editAssetsCount', function () {
            var params = $(this).attr("params");
            var r_id = $(this).attr("r_id");
            var requisition_id = $(this).attr("requisition_id");
            var arrPrams = params.split("#");
            $('.frmEditAssetsRequisition #r_id').val(r_id);
            $('.frmEditAssetsRequisition #requisition_id').val(requisition_id);
            if (arrPrams[23] == '1') {
                let arr = arrPrams[24];
                let sel = new Array();
                sel = arr.split(',');
                $(".frmEditAssetsRequisition #assets").val(arr);
                $('#sktPleaseWait').modal('show');
                $.post(baseURL + "dfr/getRequisitionAssetsData", {
                    sel: sel,
                    r_id: r_id
                }).done(function (respon) {
                    $('#sktPleaseWait').modal('hide');
                    if (respon != '0') {
                        var dat_asset = JSON.parse(respon);
                        let string = "";
                        $.each(dat_asset, function (r) {
                            string += '<div class="col-md-4">\
                                <div class="form-group">\
                                    <label>' + dat_asset[r].name + ' Count</label>\
                                   <input type="number" id="ast_id_' + dat_asset[r].assets_id + '" name="ast_id_' + dat_asset[r].assets_id + '" class="form-control asset_id" value="' + dat_asset[r].assets_required + '" step="1" min="1" placeholder="Enter Req. ' + dat_asset[r].name + ' count..." required>\
                                </div>\
                            </div>';
                        });
                        $(".assets_count_dat").css('display', 'block');
                        $(".assets_count_dat").html(string);
                    }

                });
            } else {
                $(".frmEditAssetsRequisition #assets").val('');
            }
            $("#editRequisitionAssetsCountModel").modal('show');
        });
        //*==============For append html required field validation=================*//


        function requiredValidation(e) {
            var error = false;
            $(e).find('input[required]').each(function (event) {
                var val = $(this).val();
                if (val.trim() == "") {
                    $(this).css({
                        "border": "1px solid red"
                    });
                    popupErrorMsg($(this), "Select a option to proceed", 3);
                    error = true;

                } else {
                    $(this).css({
                        "border": "1px solid #ddd"
                    });

                }
            });
            $(e).find('input[number]').each(function (event) {
                var val = $(this).val();
                if (checkNonDec(val.trim()) == false) {
                    $(this).css({
                        "border": "1px solid red"
                    });
                    popupErrorMsg($(this), "Decimal value Not allowed", 3);
                    error = true;

                } else {
                    $(this).css({
                        "border": "1px solid #ddd"
                    });

                }
            });
            $(e).find('select[required]').each(function (event) {
                var val = $(this).val();
                
                if (typeof (val) != 'object') {
                    if (val.trim() == "") {
                        $(this).focus().css({
                            "border": "1px solid red"
                        });
                        popupErrorMsg($(this), "Select a option to proceed", 3);
                        error = true;
                    } else {
                        $(this).css({
                            "border": "1px solid #ddd"
                        });
                    }
                } else {

                    if (val == null) {                        
                        $(this).focus().css({
                            "border": "1px solid red"
                        });
                        popupErrorMsg($(this), "Select a option to proceed", 3);
                        error = true;
                    }else{
                        if (val.length == "0") {
                            $(this).focus().css({
                                "border": "1px solid red"
                            });
                            popupErrorMsg($(this), "Select a option to proceed", 3);
                            error = true;
                        } else {
                            $(this).css({
                                "border": "1px solid #ddd"
                            });
                        }
                    }


                }
            });
            $(e).find('input[min]').each(function (event) {
                var val = $(this).val();
                var min = $(this).attr("min");
                if (val.trim() < min) {
                    $(this).css({
                        "border": "1px solid red"
                    });
                    popupErrorMsg($(this), "Value must be grater than Zero", 3);
                    error = true;
                } else {
                    $(this).css({
                        "border": "1px solid #ddd"
                    });

                }
            });
            // if (error) {
            //     $("#editRequisition, #editRequisitionAssets,#addRequisition").addClass('disabled');
            //     $("#editRequisition, #editRequisitionAssets,#addRequisition").attr('type', 'button');
            // } else {
            //     $("#editRequisition,#editRequisitionAssets,#addRequisition").removeClass('disabled');
            //     $("#editRequisition, #editRequisitionAssets,#addRequisition").attr('type', 'submit');
            // }

            return error;
        }

        function checkNonDec(val) {
            var ex = /^[0-9]*$/;
            if (val.match(ex) == false) {
                return false;
            } else {
                return true;
            }
        }

        function popupErrorMsg(e, msg, interval) {
            //$(".kmi-popup_error").remove();
            var div = $(e).closest("div");
            var offset = $(e).position();
            var close = document.createElement('div');
            $(close).addClass("kmi-popup_error")
                    .html(msg)
                    .css({
                        "position": "absolute",
                        "left": (offset.left),
                        "top": (offset.top - 30),
                        "z-index": "10999",
                        "color": "white",
                        "font-size": "14px",
                        "cursor": "pointer",
                        "background-color": "#dd4b39",
                        "border-radius": "3px",
                        "padding": "5px",
                        "width": "150px;",
                        "text-align": "center",
                        "display": "none"
                    })
                    .attr("id", "kmi-popup_error")
                    .appendTo(div)
                    .on("click", function () {
                        $(close).remove();
                    });
            $(close).slideDown("slow");
            $(close).fadeOut(interval * 1000);
            setTimeout(function () {
                $(close).remove();
            }, interval * 1000);
        }


        $("#addRequisition").click(function () {
            if (!requiredValidation($(".frmAddRequisition"))) {

                var job_description = $('#job_description').val().trim();
                var job_desc = $('#job_desc').val().trim();                     
                if(job_description =='' && job_desc ==''){ 
                    <?php if(access_job_description()== true) { ?>                   
                        alert('Please add job description.');
                    <?php } else { ?>
                        alert('Job description can not be empty.Please contact your local HR/WFM manager.');
                    <?php } ?>
                } else {                    
                    $(".frmAddRequisition").submit();                    
                } 
                
            }
        });
        $(document).on("click", "#editRequisition", function () {
            if (!requiredValidation($(".frmEditRequisition"))) {

                var job_desc = $('.frmEditRequisition #job_desc').val().trim();                     
                if(job_desc == ''){ 
                    <?php if(access_job_description()== true) { ?>                   
                        alert('Please add job description to update the requisition.');
                    <?php } else { ?>
                        alert('Job description can not be empty.Please contact your local HR/WFM manager.');
                    <?php } ?>
                } else {                    
                    $(".frmEditRequisition").submit();               
                } 
                
            }
        });
        $(document).on("click", "#editRequisitionAssets", function () {
            if (!requiredValidation($(".frmEditAssetsRequisition"))) {
                $(".frmEditAssetsRequisition").submit();
            }
        });


        //////////////////////////////////////////////////////////////	

        /////////////////////////// WFM Requisition approval JS part ////////////////////////
        /////////

        $(".approvalWfm").click(function () {
            var r_id = $(this).attr("r_id");
            var deptid = $(this).attr("deptid");
            var raisedby = $(this).attr("raisedby");
            $('.frmApprovalWfm #r_id').val(r_id);
            $('.frmApprovalWfm #deptid').val(deptid);
            $('.frmApprovalWfm #raisedby').val(raisedby);
            $("#approvalWfmModel").modal('show');
        });
        /* $("#wfmApproval").click(function(){
         var r_id=$(".frmApprovalWfm #r_id").val().trim();
         var r_status=$(".frmApprovalWfm #r_status").val().trim();
         var update_comment=$(".frmApprovalWfm #update_comment").val().trim();
         
         if(r_id!="" && update_comment!=""){
         $('#sktPleaseWait').modal('show');
         $.ajax({
         type	:	'POST',
         url		:	baseURL+'dfr/approved_requisition',
         data	:	$('form.frmApprovalWfm').serialize(),
         success	:	function(msg){
         $('#sktPleaseWait').modal('hide');
         $('#approvalWfmModel').modal('hide');
         window.location.reload();
         }
         });
         } else{
         alert("Field is Blank.");
         }
         }); */




        $(".declineWfm").click(function () {
            var r_id = $(this).attr("r_id");
            $('.frmDeclineWfm #r_id').val(r_id);
            $("#declineWfmModel").modal('show');
        });
        /* $("#wfmDecline").click(function(){
         var r_id=$(".frmDeclineWfm #r_id").val().trim();
         var r_status=$(".frmDeclineWfm #r_status").val().trim();
         var update_comment=$(".frmDeclineWfm #update_comment").val().trim();
         
         if(r_id!="" && update_comment!=""){
         $('#sktPleaseWait').modal('show');
         $.ajax({
         type	:	'POST',
         url		:	baseURL+'dfr/decline_requisition',
         data	:	$('form.frmDeclineWfm').serialize(),
         success	:	function(msg){
         $('#sktPleaseWait').modal('hide');
         $('#declineWfmModel').modal('hide');
         window.location.reload();
         }
         });
         }else{
         alert('Field is Blank.');
         }	
         
         }); */

        ///////////////////////////Cancel Approval Requisition JS part ////////////////////////
        /////////

        $(".cancelRequisition").click(function () {
            var r_id = $(this).attr("r_id");
            var requisition_id = $(this).attr("requisition_id");
            var requisition_status = $(this).attr("requisition_status");
            $('.frmCancelRequisition #r_id').val(r_id);
            $('.frmCancelRequisition #requisition_id').val(requisition_id);
            $('.frmCancelRequisition #requisition_status').val(requisition_status);
            $("#cancelRequisitionModel").modal('show');
        });
        ////////////////////////Handover & Closed Requisition///////////////////////////////	
        /* $("#officeLocation").on('change', function(){
         var off_id=$('#officeLocation').val();
         alert(off_id);
         
         if(off_id!=''){
         $.ajax({
         type: 'POST',    
         url: baseURL+'dfr/handover_dfr_requisition',
         data:'off_id='+ off_id,
         success: function(msg){
         
         }
         });
         }
         }); */


        $(".handoverRequisition").click(function () {
            var r_id = $(this).attr("r_id");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmhandoverRequisition #r_id').val(r_id);
            $('.frmhandoverRequisition #dept_id').val(dept_id);
            $('.frmhandoverRequisition #role_folder').val(role_folder);
            $("#handoverRequisitionModel").modal('show');
        });
        $('#closedRequisition').click(function () {
            $("#handoverRequisitionModel").modal('hide');
        });
        $(".assignTlRequisition").click(function () {
            var r_id = $(this).attr("r_id");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmAssignTlRequisition #r_id').val(r_id);
            $('.frmAssignTlRequisition #dept_id').val(dept_id);
            $('.frmAssignTlRequisition #role_folder').val(role_folder);
            $.ajax({
                type: 'POST',
                url: baseURL + 'dfr/getl1super',
                data: 'role_folder=' + role_folder,
                success: function (aList) {
                    var json_obj = $.parseJSON(aList);
                    $('#l1_supervisor').empty();
                    $('#l1_supervisor').append($('#l1_supervisor').val(''));
                    $('#l1_supervisor').append($('<option></option>').val('').html('--Select--'));
                    for (var i in json_obj) {
                        $('#l1_supervisor').append($('<option></option>').val(json_obj[i].id).html(json_obj[i].name + '-' + json_obj[i].fusion_id + '-' + json_obj[i].dept_name + '-' + json_obj[i].role_name));
                    }
                }
            });
            $("#assignTlRequisitionModel").modal('show');
        });
        $('#assignTlRequisition').click(function () {
            $("#assignTlRequisitionModel").modal('hide');
        });
        $(".closedRequisition").click(function () {
            var rid = $(this).attr("rid");
            var handoverDate = $(this).attr("handoverDate");
            var handoverName = $(this).attr("handoverName");
            var handoverid = $(this).attr("handoverid");
            var raised_by = $(this).attr("raised_by");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmclosedRequisition #rid').val(rid);
            $('.frmclosedRequisition #handoverDate').val(handoverDate);
            $('.frmclosedRequisition #handoverName').val(handoverName);
            $('.frmclosedRequisition #handoverid').val(handoverid);
            $('.frmclosedRequisition #raised_by').val(raised_by);
            $('.frmclosedRequisition #dept_id').val(dept_id);
            $('.frmclosedRequisition #role_folder').val(role_folder);
            $("#closedRequisitionModel").modal('show');
        });
        $(".closedRequisition1").click(function () {
            var rid = $(this).attr("rid");
            var handoverLocation = $(this).attr("handoverLocation");
            if (handoverLocation == "CHA") {
                $(".frmclosedRequisition1 .site_cspl").css("display", "block");
                $(".frmSendBasicLink .site").prop('required', true);
            } else {
                $(".frmclosedRequisition1 .site_cspl").css("display", "none");
                $(".frmSendBasicLink .site").removeAttr("required");
            }
            var handoverDate = $(this).attr("handoverDate");
            var handoverName = $(this).attr("handoverName");
            var handoverid = $(this).attr("handoverid");
            var raised_by = $(this).attr("raised_by");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmclosedRequisition1 #rid').val(rid);
            $('.frmclosedRequisition1 #handoverDate').val(handoverDate);
            $('.frmclosedRequisition1 #handoverName').val(handoverName);
            $('.frmclosedRequisition1 #handoverid').val(handoverid);
            $('.frmclosedRequisition1 #raised_by').val(raised_by);
            $('.frmclosedRequisition1 #dept_id').val(dept_id);
            $('.frmclosedRequisition1 #role_folder').val(role_folder);
            $("#closedRequisitionModel1").modal('show');
        });

        $(".closedRequisitionhnd").click(function () {
            var rid = $(this).attr("rid");
            var handoverDate = $(this).attr("handoverDate");
            var handoverName = $(this).attr("handoverName");
            var handoverid = $(this).attr("handoverid");
            var raised_by = $(this).attr("raised_by");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmclosedRequisition #rid').val(rid);
            $('.frmclosedRequisition #handoverDate').val(handoverDate);
            $('.frmclosedRequisition #handoverName').val(handoverName);
            $('.frmclosedRequisition #handoverid').val(handoverid);
            $('.frmclosedRequisition #raised_by').val(raised_by);
            $('.frmclosedRequisition #dept_id').val(dept_id);
            $('.frmclosedRequisition #role_folder').val(role_folder);
            $("#closedRequisitionModel").modal('show');
        });
        $(".closedRequisitionhnd1").click(function () {
            var rid = $(this).attr("rid");
            var handoverLocation = $(this).attr("handoverLocation");
            if (handoverLocation == "CHA") {
                $(".frmclosedRequisition1 .site_cspl").css("display", "block");
                $(".frmSendBasicLink .site").prop('required', true);
            } else {
                $(".frmclosedRequisition1 .site_cspl").css("display", "none");
                $(".frmSendBasicLink .site").removeAttr("required");
            }
            var handoverDate = $(this).attr("handoverDate");
            var handoverName = $(this).attr("handoverName");
            var handoverid = $(this).attr("handoverid");
            var raised_by = $(this).attr("raised_by");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmclosedRequisition1 #rid').val(rid);
            $('.frmclosedRequisition1 #handoverDate').val(handoverDate);
            $('.frmclosedRequisition1 #handoverName').val(handoverName);
            $('.frmclosedRequisition1 #handoverid').val(handoverid);
            $('.frmclosedRequisition1 #raised_by').val(raised_by);
            $('.frmclosedRequisition1 #dept_id').val(dept_id);
            $('.frmclosedRequisition1 #role_folder').val(role_folder);
            $("#closedRequisitionModelhd1").modal('show');
        });
        $(".closeRequisitionfinal").click(function () {
            var rid = $(this).attr("r_id");
            //var handoverDate=$(this).attr("handoverDate");
            var handoverName = $(this).attr("handoverName");
            var handoverid = $(this).attr("handoverid");
            var raised_by = $(this).attr("raised_by");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmclosed #rid').val(rid);
            //$('.frmclosed #handoverDate').val(handoverDate);
            $('.frmclosed #handoverName').val(handoverName);
            $('.frmclosed #handoverid').val(handoverid);
            $('.frmclosed #raised_by').val(raised_by);
            $('.frmclosed #dept_id').val(dept_id);
            $('.frmclosed #role_folder').val(role_folder);
            $("#closeRequisitionfinalModel1").modal('show');
        });
        // FORCE CLOSE REQUISITION
        $(".forceclosedRequisitionModel").click(function () {
            var rid = $(this).attr("rid");
            var raised_by = $(this).attr("raised_by");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmforceclosedRequisition #rid').val(rid);
            $('.frmforceclosedRequisition #raised_by').val(raised_by);
            $('.frmforceclosedRequisition #dept_id').val(dept_id);
            $('.frmforceclosedRequisition #role_folder').val(role_folder);
            $("#forceclosedRequisitionModel").modal('show');
        });
        $(".forceclosedRequisitionModel1").click(function () {
            var rid = $(this).attr("rid");
            var raised_by = $(this).attr("raised_by");
            var dept_id = $(this).attr("dept_id");
            var role_folder = $(this).attr("role_folder");
            $('.frmforceclosedRequisition1 #rid').val(rid);
            $('.frmforceclosedRequisition1 #raised_by').val(raised_by);
            $('.frmforceclosedRequisition1 #dept_id').val(dept_id);
            $('.frmforceclosedRequisition1 #role_folder').val(role_folder);
            $("#forceclosedRequisitionModel1").modal('show');
        });
        ////////////////////////Reopen Requisition////////////////////////
        $(".reopenRequisition").click(function () {
            var r_id = $(this).attr("r_id");
            $('.frmReopenRequisition #r_id').val(r_id);
            $("#reopenRequisitionModel").modal('show');
        });
        /////////////////////// Candidate JS Part///////////////////////////
        ///////////

        $(".frmAddCandidate #location").change(function () {
            var loc = $(this).val();
            // alert(loc);
            if (loc == 'CHA') {
                $(".frmAddCandidate .site_cspl").css("display", "block");
                $(".frmAddCandidate .site").prop('required', true);
                $('.frmAddCandidate #dis_cont_other').css('display', 'none');
                $('.frmAddCandidate #dis_cont_cha').css('display', '');
                $('.frmAddCandidate #guardian_name').prop('required', true);
                $('.frmAddCandidate #relation_guardian').prop('required', true);
                $('#relationid').css('display', '');
                $('#field_of_interest').css('display', 'none');
                $('.frmAddCandidate #interest_voice').prop('required', false);
                $('.frmAddCandidate #interest_back').prop('required', false);
                $('.frmAddCandidate #interest_other').prop('required', false);
                $('#country_req').css('display', 'none');
                $('#address_req').css('display', 'none');
                $('.frmAddCandidate #country').prop('required', false);
                $('.frmAddCandidate #address').prop('required', false);
            } else {
                $(".frmAddCandidate .site_cspl").css("display", "none");
                $(".frmAddCandidate .site").removeAttr("required");
                $('.frmAddCandidate #dis_cont_cha').css('display', 'none');
                $('.frmAddCandidate #dis_cont_other').css('display', '');
                $('.frmAddCandidate #guardian_name').prop('required', false);
                $('.frmAddCandidate #relation_guardian').prop('required', false);
                $('#relationid').css('display', 'none');
                $('#field_of_interest').css('display', '');
                $('.frmAddCandidate #interest_voice').prop('required', true);
                $('.frmAddCandidate #interest_back').prop('required', true);
                $('.frmAddCandidate #interest_other').prop('required', true);
                $('#country_req').css('display', '');
                $('#address_req').css('display', '');
                $('.frmAddCandidate #country').prop('required', true);
                $('.frmAddCandidate #address').prop('required', true);
            }

        });

        if (isIndiaLocation(location) == true) {
            //$(".frmAddCandidate #dob").datepicker({dateFormat: 'dd/mm/yy',maxDate: new Date()});
            //$("#dob1").datepicker({dateFormat: 'dd/mm/yy',maxDate: new Date()});          

            $(".dobdatepicker").datepicker({
                dateFormat: 'dd/mm/yy',
                maxDate: new Date(),
                changeMonth: true,
                changeYear: true,
                yearRange: "c-70:c+0",
                beforeShow: function (el, dp) {
                    inputField = $(el);
                    inputField.parent().append($('#ui-datepicker-div'));
                    $('#ui-datepicker-div').addClass('datepicker-modal');
                    $('#ui-datepicker-div').hide();
                }

            });
        } else {
            //$(".frmAddCandidate #dob").datepicker({dateFormat: 'mm/dd/yy',maxDate: new Date()});
            //$("#dob1").datepicker({dateFormat: 'mm/dd/yy',maxDate: new Date()});

            $(".dobdatepicker").datepicker({
                dateFormat: 'mm/dd/yy',
                maxDate: new Date(),
                changeMonth: true,
                changeYear: true,
                yearRange: "c-70:c+0",
                beforeShow: function (el, dp) {
                    inputField = $(el);
                    inputField.parent().append($('#ui-datepicker-div'));
                    $('#ui-datepicker-div').addClass('datepicker-modal');
                    $('#ui-datepicker-div').hide();
                }

            });
        }

        //$(".frmAddCandidate #dob").datepicker();
        //$("#dob1").datepicker();

        $('INPUT[type="file"]').change(function () {
            //var ext = this.value.match(/\.(.+)$/)[1];
            var fileName = $(this).val();
            var ext = fileName.substring(fileName.lastIndexOf(".") + 1, fileName.length);
            ext = ext.toLowerCase();

            var current_req = $(this).attr('id');
            ///This is for BGV DOC Upload
            if (current_req == 'uploadFile_1' || current_req == 'uploadFile_2') {
                const fileSize = this.files[0].size / 1024 / 1024; // in MiB
                if (fileSize > 5) {
                    alert('File size exceeds 5 MB');
                    this.value = '';
                } else {
                    var ext = fileName.substring(fileName.lastIndexOf(".") + 1, fileName.length);
                    ext = ext.toLowerCase();
                    switch (ext) {
                        case 'pdf':
                            break;
                        default:
                            alert('This is not an allowed file type.');
                            this.value = '';
                    }
                }
            } else {
                switch (ext) {
                    case 'doc':
                    case 'docx':
                    case 'pdf':
                        $('#uploadButton').attr('disabled', false);
                        break;
                    default:
                        alert('This is not an allowed file type.');
                        this.value = '';
                }
            }

        });

        $(".sendBasicLink").click(function () {
            var r_id = $(this).attr("r_id");
            var requisition_id = $(this).attr("requisition_id");
            var company_brand = $(this).attr("company_brand");
            var offc_location = $('#poffice_id').val();
            // alert(offc_location);
            if (typeof company_brand !== typeof undefined && company_brand !== false) {
                $('.frmSendBasicLink #company').val(company_brand);
            }
            if (typeof offc_location !== typeof undefined && offc_location == 'CHA') {
                $(".frmSendBasicLink .site_cspl").css("display", "block");
                $(".frmSendBasicLink .site").prop('required', true);
            } else {
                $(".frmSendBasicLink .site_cspl").css("display", "none");
                $(".frmSendBasicLink .site").removeAttr("required");
            }


            $('.frmSendBasicLink #link_rid').val(r_id);
            $('.frmSendBasicLink #link_requisition_id').val(requisition_id);
            $("#SendBasicLinkModel").modal('show');
        });
        $("#poffice_id").click(function () {
            var val = $(this).val();
            // console.log(val);
            if (val == "CHA") {
                $('.frmSendBasicLink #company').val("12");
                $('.frmSendBasicLink #pool_location').val("CHA");
                $(".frmSendBasicLink .site_cspl").css("display", "block");
                $(".frmSendBasicLink .site").prop('required', true);
            } else {
                $('.frmSendBasicLink #company').val("");
                $('.frmSendBasicLink #pool_location').val(val);
                $(".frmSendBasicLink .site_cspl").css("display", "none");
                $(".frmSendBasicLink .site").removeAttr("required");
            }
        });
        $("#pool_location").click(function () {
            var val = $(this).val();
            // console.log(val);
            if (val == "CHA") {
                $('.frmSendBasicLink #company').val("12");
                $(".frmSendBasicLink .site_cspl").css("display", "block");
                $(".frmSendBasicLink .site").prop('required', true);
            } else {
                $('.frmSendBasicLink #company').val("");
                $(".frmSendBasicLink .site_cspl").css("display", "none");
                $(".frmSendBasicLink .site").removeAttr("required");
            }
        });
        $(".addCandidate").click(function () {
            var r_id = $(this).attr("r_id");
            var requisition_id = $(this).attr("requisition_id");
            var company_brand = $(this).attr("company_brand");
            var loc = $('#office_location').html();
            if (loc == 'Chandigarh') {
                $('#dis_cont_cha').css('display', '');
                $('#dis_cont_other').css('display', 'none');
            } else {
                $('#dis_cont_other').css('display', '');
                $('#dis_cont_cha').css('display', 'none');
            }
            $('.frmAddCandidate #r_id').val(r_id);
            $('.frmAddCandidate #requisition_id').val(requisition_id);
            $('.frmAddCandidate #company').val(company_brand);
            //$('.frmAddCandidate #assigned_to').select2();
            $("#addCandidateModel").modal('show');
        });
        /////////////////////////////
        $("#existing_employee").hide();
        $("#not_friend_referal").hide();
        /* $("#addCandidateDetails").click(function(){
         alert('Are you sure to add this Candidate ?');
         }); */


        $('.frmAddCandidate').submit(function () {


            if ($('.form-check-input_r', this).is(':checked') &&
                    $('input:radio', this).is(':checked')) {
                // everything's fine...
            } else {
                $(".frmAddCandidate #experience_field_of_interest").html("* Please check Experience Level & Field of Interest..!");
                // alert('Please check Experience Level & Field of Interest..!');
                return false;
            }


            var error = 0;
            var t = $("input[type=radio][name='hiring_source']:checked").length !== 0;
            if (!($('#referal').is(':checked')) && t == false) {
                error = 1;
                $(".frmAddCandidate #hiring_source_status").html("* Please Select hiring source");
                // alert("Please Select hiring source");
            }

            if (error) {
                return false;
            } else {
                dt = 1;
                if ($('.checkrequired').length > 0) {

                    $(".frmAddCandidate .checkrequired").each(function () {
                        if ($(this).text() != '')
                            console.log($(this).text());
                    });

                    dt = 0;
                    //return false;
                }
                var ans = confirm('Are you sure to add this Candidate ?');
                $(".frmAddCandidate input[required]").each(function () {
                    if ($(this).val() == '')
                        dt = 0;
                });
                $(".frmAddCandidate select[required]").each(function () {
                    if ($(this).val() == "")
                        dt = 0
                });





                if (dt == 1) {
                    $("#addCandidateModel").modal('hide');
                    return ans;
                } else {
                    alert("please fill up all mandatory fields");
                }
            }

        });
        $('#onboarding_type').change(function () {
            $('#addCandidateDetails').removeClass("btn btn-primary disabled").addClass('btn btn-primary');
        });
        $(document).on('click', "#referal", function () {
            if ($(this).is(":checked")) {
                $("#existing_employee").show();
                $("#non_existing_employee").hide();
                $("#not_friend_referal").hide();
                $(".form-check-input_v").attr('checked', false);
                $("#ref_name").attr('required', false);
                $("#ref_name").prop("disabled", true);
                $('.existing_employee').prop('disabled', false);
                $("#ref_name1").attr('required', true);
                $("#ref_id").attr('required', true);
            } else {
                $("#ref_name1").val('');
                $("#refferer").val('');
                $("#refferer_dept").val('');
                $("#existing_employee").hide();
                $("#non_existing_employee").show();
                $("#referal").attr('required', false);
                $("#not_friend_referal").hide();
                $("#ref_name").attr('required', true);
                $("#ref_name").prop("disabled", false);
                $('.existing_employee').prop('disabled', true);
                $("#ref_name1").attr('required', false);
                $("#ref_id").attr('required', false);
            }
        });
        $(document).on("click", '[type="radio"][name="hiring_source"]', function () {

            if ($(this).is(":checked")) {
                $('#referal').prop('required', false);
                $('#ref_id').removeAttr('required');
                $('#ref_name1').removeAttr('required');
                $("#ref_name1").prop("disabled", true);
                //$("#ref_name").attr('required',true);

                $("#existing_employee").hide();
                $('.existing_employee').prop('disabled', true);
                $("#non_existing_employee").show();
                $("#referal").attr('required', false);
                $("#not_friend_referal").hide();
                $("#ref_name").attr('required', true);
                $("#ref_name").prop("disabled", false);
            } else {
                $('#ref_name').removeAttr('required');
                $("#ref_id").attr('required', true);
                $("#ref_name1").attr('required', true);
            }
        });
        $(document).on("click", "#job_source_portal", function () {
            if ($(this).is(":checked")) {
                $("#not_friend_referal").show();
                $("#ref_name").removeAttr("placeholder");
                $("#lebel_ref").text("Job Portal");
            } else {
                $("#not_friend_referal").hide();
            }
        });
        $(document).on("click", "#job_source_consult", function () {
            if ($(this).is(":checked")) {
                $("#not_friend_referal").show();
                $("#ref_name").removeAttr("placeholder");
                $("#lebel_ref").text("Consultancy");
            } else {
                $("#not_friend_referal").hide();
            }
        });
        $(document).on("click", "#job_source_callHR", function () {
            if ($(this).is(":checked")) {
                $("#not_friend_referal").show();
                $("#lebel_ref").text("HR Name");
            } else {
                $("#not_friend_referal").hide();
            }
        });
        $(document).on("click", "#job_source_newspaper", function () {
            if ($(this).is(":checked")) {
                $("#not_friend_referal").show();
                $("#lebel_ref").text("Newspaper");
            } else {
                $("#not_friend_referal").hide();
            }
        });
        $(document).on("click", "#job_source_walkin", function () {
            if ($(this).is(":checked")) {
                $("#not_friend_referal").hide();
                $('#ref_name').removeAttr('required');
            }
        });
        $(document).on('change', "#ref_name1", function () {
            var r_name = this.value;
            if (r_name == "")
                alert("--Select User--")
            var URL = '<?php echo base_url(); ?>dfr/getUserDetails';
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'r_name=' + r_name,
                success: function (aList) {
                    var json_obj = $.parseJSON(aList); //parse JSON

                    $('#refferer').empty();
                    $('#refferer').append($('#refferer').val(''));
                    for (var i in json_obj) {
                        $('#refferer').append($('#refferer').val(json_obj[i].name));
                        $('#refferer_dept').append($('#refferer_dept').val(json_obj[i].dept_name));
                    }

                },
                error: function () {
                    alert('Fail!');
                }
            });
        });
        $(".frmEditCandidate #location").on('change', function () {
            var location = $(this).val();
            if (location == 'CHA') {
                $(".frmEditCandidate .site_cspl").css("display", "block");
                $(".frmEditCandidate .site").prop('required', true);
                $('.frmEditCandidate #company').val("12");
                var additional = null;
                additional = $('.frmEditCandidate #additional').text();
                if (additional != null) {
                    $('.frmEditCandidate .site').val(additional);
                }

                $('.frmEditCandidate #skill_set').removeAttr('required');
                $('.frmEditCandidate #postcode').removeAttr('required');
                $('.frmEditCandidate #address').removeAttr('required');
            } else {
                $(".frmEditCandidate .site_cspl").css("display", "none");
                $(".frmEditCandidate .site").removeAttr('required');
                $('.frmEditCandidate #company').val("");
            }
        });
        /////////////////////////////////////////////////////////////

        $(".editCandidate").click(function () {
            // alert('ok');
            var params = $(this).attr("params");
            var c_id = $(this).attr("c_id");
            var r_id = $(this).attr("r_id");
            var arrPrams = params.split("#");
            var office = arrPrams[20];
            var location = arrPrams[23];
            var site = null;
            var site = arrPrams[25];
            var mother_name = arrPrams[24];
            //alert(arrPrams[8]+arrPrams[9]+arrPrams[10]);
            if (location == 'CHA') {
                // console.log(site);
                $(".frmEditCandidate .site_cspl").css("display", "block");
                $(".frmEditCandidate .site").prop('required', true);
                $('.frmEditCandidate #company').val("12");
                if (site != null) {
                    $('.frmEditCandidate .site').val(site);
                }
                $('.frmEditCandidate #skill_set').removeAttr('required');
                $('.frmEditCandidate #postcode').removeAttr('required');
                $('.frmEditCandidate #address').removeAttr('required');
            } else {
                $(".frmEditCandidate .site_cspl").css("display", "none");
                $(".frmEditCandidate .site").removeAttr('required');
            }
            $('.frmEditCandidate #location').val(arrPrams[23]);
            $('.frmEditCandidate #office_location_edit').val(location);
            $('.frmEditCandidate #c_id').val(c_id);
            $('.frmEditCandidate #r_id').val(r_id);
            $('.frmEditCandidate #r_id').val(r_id);
            $('.frmEditCandidate #requisition_id').val(arrPrams[0]);
            $('.frmEditCandidate #fname').val(arrPrams[1]);
            $('.frmEditCandidate #lname').val(arrPrams[2]);
            $('.frmEditCandidate #hiring_source').val(arrPrams[3]);
            $('.frmEditCandidate #dob1').val(arrPrams[4]);
            $('.frmEditCandidate #email').val(arrPrams[5]);
            $('.frmEditCandidate #add_email').val(arrPrams[5]);
            $('.frmEditCandidate #edit_email').val(arrPrams[5]);
            $('.frmEditCandidate #phone').val(arrPrams[6]);
            $('.frmEditCandidate #add_phone').val(arrPrams[6]);
            $('.frmEditCandidate #edit_phone').val(arrPrams[6]);
            $('.frmEditCandidate #last_qualification').val(arrPrams[7]);
            $('.frmEditCandidate #skill_set').val(arrPrams[8]);
            $('.frmEditCandidate #total_work_exp').val(arrPrams[9]);
            $('.frmEditCandidate #country').val(arrPrams[10]);
            $('.frmEditCandidate #state').val(arrPrams[11]);
            $('.frmEditCandidate #city').val(arrPrams[12]);
            $('.frmEditCandidate #postcode').val(arrPrams[13]);
            $('.frmEditCandidate #address').val(arrPrams[14]);
            $('.frmEditCandidate #summary').val(arrPrams[15]);
            $('.frmEditCandidate #attachment').val(arrPrams[16]);
            $('.frmEditCandidate #gender').val(arrPrams[17]);
            $('.frmEditCandidate #ref_name').val(arrPrams[18]);
            $('.frmEditCandidate #ref_name').removeClass('select2-hidden-accessible');
            $('.select2-container--default').css('display', 'none');
            // $('.frmEditCandidate #onboarding_type').val(arrPrams[19]);	
            // $('.frmEditCandidate #company').val(arrPrams[20]);		


            $('.frmEditCandidate #guardian_name').val(arrPrams[19]);
            $('.frmEditCandidate #onboarding_type').val(arrPrams[20]);
            $('.frmEditCandidate #company').val(arrPrams[21]);
            $('.frmEditCandidate #relation_guardian').val(arrPrams[22]);
            $('.frmEditCandidate #edit_mother_name').val(arrPrams[24]);

            if (site != null) {
                $('.frmEditCandidate #additional').text(site);
            }

            $("#editCandidateModel").modal('show');
        });
        //////////////Candidate Experience & Qualification part//////////

        $(function () {
            $("#from_date").datepicker({maxDate: new Date()});
            $("#to_date").datepicker({maxDate: new Date()});
            $("#fromdate").datepicker({maxDate: new Date()});
            $("#todate").datepicker({maxDate: new Date()});
        });
        $(".addExperience").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            $('.frmaddCandidateExp #r_id').val(r_id);
            $('.frmaddCandidateExp #c_id').val(c_id);
            $("#addCandidateExpModel").modal('show');
        });
        $(".editCandidateExp").click(function () {
            var params = $(this).attr("params");
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var c_exp_id = $(this).attr("c_exp_id");
            var arrPrams = params.split("#");
            $('.frmEditCandidateExp #r_id').val(r_id);
            $('.frmEditCandidateExp #c_id').val(c_id);
            $('.frmEditCandidateExp #c_exp_id').val(c_exp_id);
            $('.frmEditCandidateExp #company_name').val(arrPrams[0]);
            $('.frmEditCandidateExp #designation').val(arrPrams[1]);
            $('.frmEditCandidateExp #fromdate').val(arrPrams[2]);
            $('.frmEditCandidateExp #todate').val(arrPrams[3]);
            $('.frmEditCandidateExp #contact').val(arrPrams[4]);
            $('.frmEditCandidateExp #work_exp').val(arrPrams[5]);
            $('.frmEditCandidateExp #job_desc').val(arrPrams[6]);
            $('.frmEditCandidateExp #address').val(arrPrams[7]);
            $("#editCandidateExpModel").modal('show');
        });
        $(".addQualification").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var loc = $('#office_location').html();
            if (loc == 'Chandigarh') {
                $('#div_parcent1').css('display', '');
                $('#div_parcent').css('display', '');
                $('#10eng').attr('required');
                $('#10math').attr('required');
            } else {
                $('#div_parcent1').css('display', 'none1');
                $('#div_parcent').css('display', 'none1');
                $('#10eng').removeAttr('required');
                $('#10math').removeAttr('required');
            }
            $('.frmaddCandidateQual #r_id').val(r_id);
            $('.frmaddCandidateQual #c_id').val(c_id);
            $("#addCandidateQualModel").modal('show');
        });
        $(".editCandidateQual").click(function () {
            var params = $(this).attr("params");
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var c_qual_id = $(this).attr("c_qual_id");
            var arrPrams = params.split("#");
            $('.frmeditCandidateQual #r_id').val(r_id);
            $('.frmeditCandidateQual #c_id').val(c_id);
            $('.frmeditCandidateQual #c_qual_id').val(c_qual_id);
            $('.frmeditCandidateQual #exam').val(arrPrams[0]);
            $('.frmeditCandidateQual #passing_year').val(arrPrams[1]);
            $('.frmeditCandidateQual #board_uv').val(arrPrams[2]);
            $('.frmeditCandidateQual #specialization').val(arrPrams[3]);
            $('.frmeditCandidateQual #grade_cgpa').val(arrPrams[4]);
            $('.frmeditCandidateQual #10eng_edit').val(arrPrams[5]);
            $('.frmeditCandidateQual #10math_edit').val(arrPrams[6]);
            $('.frmeditCandidateQual #12eng_edit').val(arrPrams[7]);
            $('.frmeditCandidateQual #12math_edit').val(arrPrams[8]);
            var loc = $('#office_location').html();
            if (loc == 'Chandigarh') {
                $('#div_parcent1_edit').css('display', '');
                $('#div_parcent_edit').css('display', '');
                $('#10eng_edit').attr('required');
                $('#10math_edit').attr('required');
            } else {
                $('#div_parcent1_edit').css('display', 'none1');
                $('#div_parcent_edit').css('display', 'none1');
                $('#10eng_edit').removeAttr('required');
                $('#10math_edit').removeAttr('required');
            }

            $("#editCandidateQualModel").modal('show');
        });
        /////////////////////////////////////	

        //////////////////////Candidate Schedule interview/////////////////////

        $(function () {
            $("#scheduled_on").datetimepicker({
                minDate: -7
            });
            $(".frmeditScheduleCandidate #scheduled_on1").datetimepicker({
                minDate: -7
            });
            $("#scheduled_on_r2").datetimepicker({
                minDate: -7
            });
        });
        $(".scheduleCandidate").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var dept_id = $(this).attr("hiring_department");
            var c_status = $(this).attr("c_status");
            var interview_site = $(this).attr("interview_site");
            $('.frmaddScheduleCandidate #r_id').val(r_id);
            $('.frmaddScheduleCandidate #c_id').val(c_id);
            $('.frmaddScheduleCandidate #dept_id').val(dept_id);
            $('.frmaddScheduleCandidate #c_status').val(c_status);
            $('.frmaddScheduleCandidate #interview_site').val(interview_site);
            $("#addScheduleCandidate").modal('show');
        });
        ////////////////////////
        $("#interview_type").on('change', function () {
            var pid = this.value;
            //alert(pid);
            // console.log(pid);
            var interview_site = $("#interview_site").val();
            var dept_id = $("#dept_id").val();
            //alert(interview_site);
            //  alert(dept_id);
            if (pid == "")
                alert("Please Select The User")
            var URL = '<?php echo base_url(); ?>dfr/getuserclientlist';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'pid=' + pid + '&interview_site=' + interview_site + '&dept_id=' + dept_id,
                success: function (pList) {
                    //alert(pList);
                    var json_obj = $.parseJSON(pList); //parse JSON

                    $('#assign_interviewer').empty();
                    $('#assign_interviewer').append($('<option></option>').val('').html('-- Select --'));
                    for (var i in json_obj)
                        $('#assign_interviewer').append($('<option></option>').val(json_obj[i].id).html(json_obj[i].name + '-' + json_obj[i].office_id + '-' + json_obj[i].dept_name));
                    $('#sktPleaseWait').modal('hide');
                },
                error: function () {
                    alert('Fail!');
                }

            });
        });
        /////////

        $(".editschedule").click(function () {
            var params1 = $(this).attr("params1");
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var sch_id = $(this).attr("sch_id");
            var arrPrams1 = params1.split("#");
            $('.frmeditScheduleCandidate #r_id').val(r_id);
            $('.frmeditScheduleCandidate #c_id').val(c_id);
            $('.frmeditScheduleCandidate #sch_id').val(sch_id);
            $('.frmeditScheduleCandidate #scheduled_on1').val(arrPrams1[0]);
            //$('.frmeditScheduleCandidate #edinterview_type').val(arrPrams1[1]);
            $('.frmeditScheduleCandidate #edinterview_site').val(arrPrams1[2]);
            $('.frmeditScheduleCandidate #sh_status').val(arrPrams1[3]);
            $('.frmeditScheduleCandidate #remarks').val(arrPrams1[4]);
            $("#editScheduleCandidate").modal('show');
        });
        $("#edinterview_type").on('change', function () {
            var edpid = this.value;
            var edinterview_site = $("#edinterview_site").val();
            if (edpid == "")
                alert("--Select--")
            var URL = '<?php echo base_url(); ?>dfr/getuserclientlist';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'pid=' + edpid + '&interview_site=' + edinterview_site,
                success: function (edpList) {
                    //alert(pList);
                    var json_obj = $.parseJSON(edpList); //parse JSON

                    $('#edassign_interviewer').empty();
                    $('#edassign_interviewer').append($('<option></option>').val('').html('-- Select --'));
                    for (var i in json_obj)
                        $('#edassign_interviewer').append($('<option></option>').val(json_obj[i].id).html(json_obj[i].name + ' -' + json_obj[i].office_id));
                    $('#sktPleaseWait').modal('hide');
                },
                error: function () {
                    alert('Fail!');
                }

            });
        });
        ///////////////////////////////////////	


        ////////////////////////Cancel Interview Scheduled//////////////////////////////

        $(".cancelSchedule").click(function () {
            var id = $(this).attr("id");
            var dis_id = $(this).attr("schedule_id");
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var sch_id = $(this).attr("sch_id");
            $('.frmCancelScheduleCandidate #id').val(id);
            $('.frmCancelScheduleCandidate #r_id').val(r_id);
            $('.frmCancelScheduleCandidate #c_id').val(c_id);
            $('.frmCancelScheduleCandidate #sch_id').val(sch_id);
            $('.frmCancelScheduleCandidate #dis_id').val(dis_id);
            $("#cancelScheduleCandidate").modal('show');
        });

        /////////////////////////////////////////////////	
        $("#transfer_location").on('change', function () {
            var pid = this.value;
            var select_site = $("#select_site").val();
            var department = $("#select_department_pool").val();
            console.log(pid);
            // var interview_site = $("#interview_site").val();
            // var dept_id = $("#dept_id").val();

            // if(pid=="") alert("Please Select The Location")
            var URL = '<?php echo base_url(); ?>dfr/getSiteListByLocation';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                //    data:'pid='+pid+'&interview_site='+interview_site+'&dept_id='+dept_id,
                data: 'pid=' + pid,
                success: function (pList) {
                    //alert(pList);
                    var json_obj = $.parseJSON(pList); //parse JSON
                    // console.log(json_obj);
                    $('#select_site').empty();
                    $('#req_id').empty();
                    $('#req_details').empty();
                    $('#select_site').append($('<option value=""> </option>').val('').html(' Select Site '));
                    for (var i in json_obj)
                        $('#select_site').append($('<option></option>').val(json_obj[i].id).html(json_obj[i].name));
                    $('#sktPleaseWait').modal('hide');
                    // populate_brand_combo_dfr(offid,def='',objid='brand_id',isAll='N');

                    // $('#select_site')[0].selectize.clearOptions();
                    // $('#select_site')[0].selectize.addOption({value:"",text:"Select Site"});
                    // $('#select_site')[0].selectize.addItem(1);

                    // for (var i in json_obj){
                    // 	$('#select_site')[0].selectize.addOption({value:json_obj[i].id,text:json_obj[i].name});
                    // 	$('#select_site')[0].selectize.addItem(i);
                    // }

                    // $('#sktPleaseWait').modal('hide');	
                },
                error: function () {
                    alert('Fail!');
                }

            });

            dependent_requisition(pid, select_site, department);

        });

        /////////
        $("#select_department").on('change', function () {

            var pid = this.value;
            var transfer_location = $("#transfer_location").val();
            var select_site = $("#select_site").val();
            //alert(pid+" "+transfer_location+"   "+select_site);

            // console.log(pid,transfer_location,select_site);

            // if(pid=="") alert("Please Select The Location")
            var URL = '<?php echo base_url(); ?>dfr/getRequisitionByLocationAndSite';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'did=' + pid + '&location=' + transfer_location + '&site_id=' + select_site,
                //    data:'pid='+pid,
                success: function (pList) {

                    var json_obj = $.parseJSON(pList); //parse JSON
                    // console.log(json_obj);
                    $('#req_id').empty();
                    $('#req_id').append($('<option></option>').val('').html(' Select Requisition '));
                    for (var i in json_obj)
                        $('#req_id').append($('<option></option>').val(json_obj[i].id).html(json_obj[i].req_desc));
                    $('#sktPleaseWait').modal('hide');
                    // $('#req_id')[0].selectize.clearOptions();
                    // $('#req_id')[0].selectize.addOption({value:"",text:"Select Requisition"});
                    // $('#req_id')[0].selectize.addItem(1);

                    // for (var i in json_obj){
                    // 	$('#req_id')[0].selectize.addOption({value:json_obj[i].id,text:json_obj[i].req_desc});
                    // 	$('#req_id')[0].selectize.addItem(i);
                    // }

                    // $('#sktPleaseWait').modal('hide');	
                },
                error: function () {
                    alert('Fail!');
                }

            });
        });


        $(document).on('change',"#select_department_pool", function () {
            var pid = this.value;
            var transfer_location = $("#transfer_location").val();
            var select_site = $("#select_site").val();
            var URL = '<?php echo base_url(); ?>dfr/getRequisitionByLocationAndSite';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'did=' + pid + '&location=' + transfer_location + '&site_id=' + select_site,
                success: function (pList) {

                    var json_obj = $.parseJSON(pList); //parse JSON					
                    $('#req_id').empty();
                    $('#req_id').append($('<option></option>').val('').html(' Select Requisition '));
                    $('#req_id').append($('<option></option>').val('0').html('Pool'));
                    for (var i in json_obj)
                        $('#req_id').append($('<option></option>').val(json_obj[i].id).html(json_obj[i].req_desc));
                    $('#sktPleaseWait').modal('hide');
                },
                error: function () {
                    alert('Fail!');
                }

            });
        });
        /////////
        //////////////////////Candidate Interview part/////////////////////

        $(function () {
            $("#scheduled_date").datetimepicker({
                minDate: 0
            });
            $("#interview_date").datetimepicker({
                minDate: 0
            });
        });
        $(".candidateAddInterview").click(function () {


            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var sch_id = $(this).attr("sch_id");
            var sch_date = $(this).attr("sch_date");
            var sh_status = $(this).attr("sh_status");
            var schType = $(this).attr("schType");
            var schSite = $(this).attr("schSite");
            var schAssin = $(this).attr("schAssin");
            $('.frmaddCandidateInterview #r_id').val(r_id);
            $('.frmaddCandidateInterview #c_id').val(c_id);
            $('.frmaddCandidateInterview #sch_id').val(sch_id);
            $('.frmaddCandidateInterview #sh_status').val(sh_status);
            $('.frmaddCandidateInterview #scheduled_date').val(sch_date);
            getInterviewerDropdown(schType, schSite, schAssin, ".frmaddCandidateInterview #interviewer_id", "#addCandidateInterview");
            ////////////////



        });

        function getInterviewerDropdown(schType, schSite, schAssin, selObj, model) {


            //alert(schType + " > " + schSite + " > " + schAssin + " > " + model  );

            var URL = '<?php echo base_url(); ?>dfr/getuserclientlist';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'pid=' + schType + '&interview_site=' + schSite,
                success: function (pList) {
                    //alert(pList);
                    var json_obj = $.parseJSON(pList); //parse JSON dept_name

                    $(selObj).empty();
                    $(selObj).append($('<option></option>').val('').html('-- Select --'));
                    for (var i in json_obj)
                        $(selObj).append($('<option></option>').val(json_obj[i].id).html(json_obj[i].name + '-' + json_obj[i].office_id + '-' + json_obj[i].dept_name));
                    $('#sktPleaseWait').modal('hide');
                    $(selObj).val(schAssin);
                    $(model).modal('show');
                },
                error: function () {
                    alert('Fail!');
                }

            });
        }


        $(".editInterview").click(function () {

            var params2 = $(this).attr("params2");
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var sch_id = $(this).attr("sch_id");
            var interview_date = $(this).attr("interview_date");
            var schType = $(this).attr("schType");
            var schSite = $(this).attr("schSite");
            var schAssin = $(this).attr("schAssin");
            var c_status = $(this).attr("c_status");
            var arrPrams2 = params2.split("#");
            $('.frmeditCandidateInterview #r_id').val(r_id);
            $('.frmeditCandidateInterview #c_id').val(c_id);
            $('.frmeditCandidateInterview #sch_id').val(sch_id);
            $('.frmeditCandidateInterview #interview_date').val(interview_date);
            $('.frmeditCandidateInterview #interviewer_id').val(arrPrams2[0]);
            $('.frmeditCandidateInterview #result').val(arrPrams2[1]);
            $('.frmeditCandidateInterview #ededucationtraining_param').val(arrPrams2[2]);
            $('.frmeditCandidateInterview #edjobknowledge_param').val(arrPrams2[3]);
            $('.frmeditCandidateInterview #edworkexperience_param').val(arrPrams2[4]);
            $('.frmeditCandidateInterview #edanalyticalskills_param').val(arrPrams2[5]);
            $('.frmeditCandidateInterview #edtechnicalskills_param').val(arrPrams2[6]);
            $('.frmeditCandidateInterview #edgeneralawareness_param').val(arrPrams2[7]);
            $('.frmeditCandidateInterview #edbodylanguage_param').val(arrPrams2[8]);
            $('.frmeditCandidateInterview #edenglishcomfortable_param').val(arrPrams2[9]);
            $('.frmeditCandidateInterview #edmti_param').val(arrPrams2[10]);
            $('.frmeditCandidateInterview #edenthusiasm_param').val(arrPrams2[11]);
            $('.frmeditCandidateInterview #edleadershipskills_param').val(arrPrams2[12]);
            $('.frmeditCandidateInterview #edcustomerimportance_param').val(arrPrams2[13]);
            $('.frmeditCandidateInterview #edjobmotivation_param').val(arrPrams2[14]);
            $('.frmeditCandidateInterview #edresultoriented_param').val(arrPrams2[15]);
            $('.frmeditCandidateInterview #edlogicpower_param').val(arrPrams2[16]);
            $('.frmeditCandidateInterview #edinitiative_param').val(arrPrams2[17]);
            $('.frmeditCandidateInterview #edassertiveness_param').val(arrPrams2[18]);
            $('.frmeditCandidateInterview #eddecisionmaking_param').val(arrPrams2[19]);
            $('.frmeditCandidateInterview #edoverall_assessment').val(arrPrams2[20]);
            $('.frmeditCandidateInterview #edinterview_remarks').val(arrPrams2[21]);
            $('.frmeditCandidateInterview #edinterview_status').val(arrPrams2[22]);
            $('.frmeditCandidateInterview #edlisten_skill').val(arrPrams2[23]);
            getInterviewerDropdown(schType, schSite, schAssin, ".frmeditCandidateInterview #interviewer_id", "#editCandidateInterview");
            if (c_status == "E" || c_status == "CS") {


                $('.frmeditCandidateInterview #addCandidateInterview').hide();
                $('.frmeditCandidateInterview #addCandidateInterview').prop("disabled", true);
                $('.frmeditCandidateInterview textarea').prop("disabled", true);
                $('.frmeditCandidateInterview select').prop("disabled", true);
            } else {

                $('.frmeditCandidateInterview #addCandidateInterview').show();
                $('.frmeditCandidateInterview #addCandidateInterview').prop("disabled", false);
                $('.frmeditCandidateInterview textarea').prop("disabled", false);
                $('.frmeditCandidateInterview select').prop("disabled", false);
            }


        });
        ///////////////////////////////////////////////////////////////////////////////

        //////////////////////Candidate Final Status///////////////////////////

        $(".candidateSelectInterview").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            $('.frmCandidateSelectInterview #r_id').val(r_id);
            $('.frmCandidateSelectInterview #c_id').val(c_id);
            $("#candidateSelectInterview").modal('show');
        });
        $(".candidateNotSelectInterview").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            $('.frmCandidateSelectInterviewModel #r_id').val(r_id);
            $('.frmCandidateSelectInterviewModel #c_id').val(c_id);
            $("#candidateNotSelectInterviewModel").modal('show');
        });
        ////////////////////////////////////////////////


        ///////////////////////Shortlisted Candidate Part////////////////////////////	

        if (isIndiaLocation(location) == true) {
            $("#doj").datepicker({
                dateFormat: 'dd/mm/yy',
                minDate: new Date()
            });
        } else {
            $("#doj").datepicker({
                dateFormat: 'mm/dd/yy',
                minDate: new Date()
            });
        }

        $(".viewScheduleInterview").click(function () {
            var cid = $(this).attr("cid");
            $('.frmviewScheduleInterview #cid').val(cid);
            $("#viewScheduleInterviewModel").modal('show');
        });

        $("#is_loi").click(function () {
            get_stipend_data();
        });


        $(".candidateApproval").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var req_id = $(this).attr("req_id");
            var org_role = $(this).attr("org_role");
            var location_id = $(this).attr("location_id");
            var gender = $(this).attr("gender");
            var p_lock = $(this).attr("p_access");
            var c_status = $(this).attr("c_status");
            var brand_id = $(this).attr("brand_id");
            var role_id = $(this).attr("role_id");
            var dept_id = $(this).attr("dept_id");
            var gr_amt = $('#gross_amount').val();
            $('#payroll_chek').val(p_lock);

            $("#prevUserInfoRow").hide();
            //Check stipned permission//
            $(".perday").css('display', 'none');
            $("#training_fees_perday").val('0.00');
            $("#training_ctc").val('0.00');


            if (p_lock == "1") {

                $('#check_payroll #pay_type').removeAttr('required');
                $('#check_payroll #pay_currency').removeAttr('required');
                $('#check_payroll #gross_amount').removeAttr('required');
                $('#check_payroll #emp_type').removeAttr('required');

                $('#check_payroll').hide();
                $('#stop_payroll').show();

                $('#check_payroll input').prop('disabled', true);
                $('#stop_payroll input').prop('disabled', false);
            } else if (p_lock == "0") {
                $('#check_payroll #pay_type').attr('required', 'required');
                $('#check_payroll #pay_currency').attr('required', 'required');
                $('#check_payroll #gross_amount').attr('required', 'required');
                $('#check_payroll #emp_type').attr('required', 'required');

                $('#check_payroll').show();
                $('#stop_payroll').hide();

                $('#check_payroll input').prop('disabled', false);
                $('#stop_payroll input').prop('disabled', true);
            }

            $.post("<?= base_url() ?>dfr/check_stipend_user_permission", {
                org_role: org_role,
                dept_id: dept_id,
                office_id: location_id
            }).done(function (data) {

                let lblHtml;
                if (data == 1) {
                    $(".loi_check").css('display', 'block');
                    $("#is_loi").attr('checked', true);
                    get_stipend_data();
                } else {
                    $(".loi_check").css('display', 'none');
                    $("#is_loi").attr('checked', false);
                    get_stipend_data();

                }
            });



            if (isIndiaLocation(location_id) == true) {

                $.ajax({
                    type: 'POST',
                    url: baseURL + 'dfr/get_candidate_details',
                    data: 'c_id=' + c_id + '&loc=' + location_id,
                    success: function (msg) {

                        if (msg == "hine") {
                            $("#prevUserInfoRow").hide();
                        } else {
                            $("#prevUserInfoRow").show();
                            $('#prevUserInfoContent').html(msg);
                        }

                        $("#approvalFinalSelectModel").modal('show');
                    }

                });
            } else {
                if (location_id == "CEB" || location_id == "MAN") {
                    $('.frmApprovalFinalSelectPhp #r_id').val(r_id);
                    $('.frmApprovalFinalSelectPhp #requisition_id').val(req_id);
                    $('.frmApprovalFinalSelectPhp #c_id').val(c_id);
                    $('.frmApprovalFinalSelectPhp #location_id').val(location_id);
                    $('.frmApprovalFinalSelectPhp #c_status').val(c_status);
                    $('.frmApprovalFinalSelectPhp #org_role').val(org_role);
                    $('.frmApprovalFinalSelectPhp #gender').val(gender);
                    $('.frmApprovalFinalSelectPhp #brand_id').val(brand_id);
                    $("#approvalFinalSelectModelPhp").modal('show');
                } else {
                    $("#approvalFinalSelectModel").modal('show');
                }
            }


            $('.frmApprovalFinalSelect #r_id').val(r_id);
            $('.frmApprovalFinalSelect #requisition_id').val(req_id);
            $('.frmApprovalFinalSelect #c_id').val(c_id);
            $('.frmApprovalFinalSelect #location_id').val(location_id);
            $('.frmApprovalFinalSelect #c_status').val(c_status);
            $('.frmApprovalFinalSelect #org_role').val(org_role);
            $('.frmApprovalFinalSelect #gender').val(gender);
            $('.frmApprovalFinalSelect #brand_id').val(brand_id);
            $('.frmApprovalFinalSelect #role_id').val(role_id);

            if (location_id == "CHA" || brand_id == "12") {
                $('.cspl').show();
                $('.ind_oth').hide();
                //Not needed as per current salary stucture of chandighar 19-04-2023
                $('#csplBonus').hide();

            } else {
                $('.cspl').hide();
                $('.ind_oth').show();
                $('#csplBonus').hide();
            }

            $('#calcKOL').hide();
            $('#gross_amount').val("");
        });

        $(".candidateDecline").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var c_status = $(this).attr("c_status");
            $('.frmDeclineFinalSelect #r_id').val(r_id);
            $('.frmDeclineFinalSelect #c_id').val(c_id);
            $('.frmDeclineFinalSelect #c_status').val(c_status);
            $("#declineFinalSelectModel").modal('show');
        });
        ////////////////////////////////////////

        $("#client_id").select2();
        $("#process_id").select2();
        ////////////////////////Final Selection part//////////////////////////////	

        //minDate   : "-2D"
        //maxDate   : new Date(),

        /*var datepickersOpt = {
         dateFormat: 'mm/dd/yy',
         minDate   : new Date(),
         maxDate   : new Date(),
         }*/

        //$("#d_o_j").datepicker(datepickersOpt);

        if (isIndiaLocation(location) == true) {

            $("#d_o_j").datepicker({
                dateFormat: 'dd/mm/yy',
                minDate: new Date(),
                beforeShow: function (el, dp) {
                    inputField = $(el);
                    inputField.parent().append($('#ui-datepicker-div'));
                    $('#ui-datepicker-div').addClass('datepicker-modal');
                    $('#ui-datepicker-div').hide();
                }
            });
        } else {

            $("#d_o_j").datepicker({
                dateFormat: 'mm/dd/yy',
                minDate: new Date(),
                beforeShow: function (el, dp) {
                    inputField = $(el);
                    inputField.parent().append($('#ui-datepicker-div'));
                    $('#ui-datepicker-div').addClass('datepicker-modal');
                    $('#ui-datepicker-div').hide();
                }
            });
        }

        if (isIndiaLocation(location) == true) {
            //$("#d_o_b").datepicker({dateFormat: 'dd/mm/yy',changeMonth: true,changeYear: true});

            $("#d_o_b").datepicker({
                dateFormat: 'dd/mm/yy',
                maxDate: new Date(),
                changeMonth: true,
                changeYear: true,
                yearRange: "c-70:c+0",
                beforeShow: function (el, dp) {
                    inputField = $(el);
                    inputField.parent().append($('#ui-datepicker-div'));
                    $('#ui-datepicker-div').addClass('datepicker-modal');
                    $('#ui-datepicker-div').hide();
                }

            });
        } else {
            //$("#d_o_b").datepicker({dateFormat: 'mm/dd/yy',changeMonth: true,changeYear: true});

            $("#d_o_b").datepicker({
                dateFormat: 'mm/dd/yy',
                maxDate: new Date(),
                changeMonth: true,
                changeYear: true,
                yearRange: "c-70:c+0",
                beforeShow: function (el, dp) {
                    inputField = $(el);
                    inputField.parent().append($('#ui-datepicker-div'));
                    $('#ui-datepicker-div').addClass('datepicker-modal');
                    $('#ui-datepicker-div').hide();
                }

            });
        }



        $('.frmfinalSelection #department_id').change(function () {

            var dept_id = $('.frmfinalSelection #department_id').val();
            //alert(dept_id);

            populate_sub_dept_combo(dept_id);
        });
        /* $("#location").click(function(){
         var off_id=$('#location').val();
         alert(off_id);
         populate_access_control_combo(off_id,'','assigned_to','N');
         }); */

        $('#role_id').change(function () {
            var option = $('option:selected', this).attr('param');
            $('#org_role_id').val(option);
        });
        $("#client_id").change(function () {
            var client_id = $(this).val();
            var URL = '<?php echo base_url(); ?>dfr/select_process';
            $.ajax({
                type: 'GET',
                url: URL,
                data: 'client_id=' + client_id,
                success: function (data) {
                    var a = JSON.parse(data);
                    //var mySelect = $('#process_id');
                    $("#process_id").empty();
                    $.each(a, function (index, jsonObject) {
                        $("select#process_id").append('<option value="' + jsonObject.id + '">' + jsonObject.name + '</option>');
                    });
                },
                error: function () {
                    alert('error!');
                }
            });
        });
        //        $("#fdclient_id").change(function () {
        //            let client_id=$(this).val();
        //            let select='\#fdprocess_id';
        //            getProcessDrop(client_id,select);
        //        });
        //        function getProcessDrop(client_id, select) {
        //            var URL = '<?php echo base_url(); ?>dfr/select_process';
        //            $.ajax({
        //                type: 'GET',
        //                url: URL,
        //                data: 'client_id=' + client_id,
        //                success: function (data) {
        //                    var a = JSON.parse(data);
        //                    //var mySelect = $('#process_id');
        //                    console.log('"'+select+'"');
        //                    $("#fdprocess_id").empty();
        //                    $("#fdprocess_id").append($('<option></option>').val('').html('--Select--'));
        //                    $.each(a, function (index, jsonObject) {
        //                        $("#fdprocess_id").append('<option value="' + jsonObject.id + '">' + jsonObject.name + '</option>');
        //                    });
        //                },
        //                error: function () {
        //                    alert('error!');
        //                }
        //            });
        //        }

        $("#candidateFinalSelection").click(function () {
            var off_id = $('.frmfinalSelection #location').val();
            if (off_id == 'KOL') {
                //$('#xpoid').attr("required", "true");
                //alert('please fill the XPOID');
                $('#xpoid').removeAttr("required");
            } else if((isUSLocation(off_id) == true) ||( off_id == 'MON' || off_id == 'MEX')) {
           
           $('#xpoid').removeAttr("required");
           $('#social_security_no').removeAttr("required");
       } else {
                $('#xpoid').removeAttr("required");
            }
        });



        $(".finalSelection").click(function () {
            var cparams = $(this).attr("cparams");
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var p_lock = $(this).attr("p_access");

            $('#payroll_chek').val(p_lock);



            if (p_lock == "1") {
                $('#check_payroll #pay_type').removeAttr('required');
                $('#check_payroll #pay_currency').removeAttr('required');
                $('#check_payroll #gross_amount').removeAttr('required');
                $('#check_payroll #emp_type').removeAttr('required');
                $('#check_payroll #payroll_type').removeAttr('required');

                $('#check_payroll').hide();
                $('#stop_payroll').show();
            }

            if (p_lock == "0") {
                $('#check_payroll #pay_type').attr('required', 'required');
                $('#check_payroll #pay_currency').attr('required', 'required');
                $('#check_payroll #gross_amount').attr('required', 'required');
                $('#check_payroll #emp_type').attr('required', 'required');
                $('#check_payroll #payroll_type').attr('required', 'required');

                $('#check_payroll').show();
                $('#stop_payroll').hide();
            }

            //var req_no_position=$(this).attr("req_no_position");
            //var filled_no_position=$(this).attr("filled_no_position");

            var carrPrams = cparams.split("(#)");
            $('.frmfinalSelection #r_id').val(r_id);
            $('.frmfinalSelection #c_id').val(c_id);
            //$('.frmfinalSelection #req_no_position').val(req_no_position);
            //$('.frmfinalSelection #filled_no_position').val(filled_no_position);

            $('.frmfinalSelection #fname').val(carrPrams[0]);
            $('.frmfinalSelection #lname').val(carrPrams[1]);
            $('.frmfinalSelection #hiring_source').val(carrPrams[2]);
            $('.frmfinalSelection #d_o_b').val(carrPrams[3]);
            $('.frmfinalSelection #email').val(carrPrams[4]);
            $('.frmfinalSelection #phone').val(carrPrams[5]);
            $('.frmfinalSelection #department_id').val(carrPrams[6]);
            $('.frmfinalSelection #role_id').val(carrPrams[7]);
            $('.frmfinalSelection #d_o_j').val(carrPrams[8]);
            //$('.frmfinalSelection #d_o_j').datepicker('option', 'minDate', carrPrams[8]);

            $('.frmfinalSelection #gender').val(carrPrams[9]);
            $('.frmfinalSelection #location').val(carrPrams[10]);

            $('.frmfinalSelection #batch_code').val(carrPrams[11]);
            $('.frmfinalSelection #address').val(carrPrams[12]);
            $('.frmfinalSelection #country').val(carrPrams[13]);
            $('.frmfinalSelection #state').val(carrPrams[14]);
            $('.frmfinalSelection #city').val(carrPrams[15]);
            $('.frmfinalSelection #postcode').val(carrPrams[16]);
            //$('.frmfinalSelection #client_id').val(carrPrams[17]);
            //$('.frmfinalSelection #process_id').val(carrPrams[18]);
            $('.frmfinalSelection #org_role_id').val(carrPrams[19]);
            // CLIENT ID SELECTION
            $('.frmfinalSelection #client_id').select2('destroy');
            $('.frmfinalSelection #client_id').val('');
            $('.frmfinalSelection #client_id').attr('readonly', false);
            $('.frmfinalSelection #client_id option').prop('disabled', false);
            if (carrPrams[17] != "") {
                $('.frmfinalSelection #client_id').val(carrPrams[17].split(','));
                $('.frmfinalSelection #client_id').attr('readonly', true);
                $('.frmfinalSelection #client_id option:not(:selected)').prop('disabled', true);
            }
            $('.frmfinalSelection #client_id').select2();
            // PROCESS ID SELECTION
            $('.frmfinalSelection #process_id').select2('destroy');
            $('.frmfinalSelection #process_id').val('');
            $('.frmfinalSelection #process_id').attr('readonly', false);
            $('.frmfinalSelection #process_id option').prop('disabled', false);
            if (carrPrams[18] != "" && carrPrams[18] != "0") {
                $('.frmfinalSelection #process_id').val(carrPrams[18].split(','));
                $('.frmfinalSelection #process_id').attr('readonly', true);
                $('.frmfinalSelection #process_id option:not(:selected)').prop('disabled', true);
            }
            $('.frmfinalSelection #process_id').select2();
            // PAYROLL CHECKUPS
            if (carrPrams[21] != "") {

                $('.frmfinalSelection #payroll_type').val(carrPrams[21]);

                $('.frmfinalSelection input[name="payroll_type"]').each(function () {
                    $(this).val(carrPrams[21]);
                });
            } else {
                $('.frmfinalSelection #payroll_type').val('1');
                $('.frmfinalSelection input[name="payroll_type"]').each(function () {
                    $(this).val('1');
                });
            }
            $('.frmfinalSelection input[name="grosspay"]').each(function () {
                $(this).val(carrPrams[20]);
            });
            $('.frmfinalSelection input[name="currency"]').each(function () {
                $(this).val(carrPrams[22]);
            });
            $('.frmfinalSelection input[name="payroll_status"]').each(function () {
                $(this).val('1');
            });
            // L1 Supervisor Selection
            $('.frmfinalSelection #assigned_to').val('');
            $('.frmfinalSelection #assigned_to').attr('readonly', false);
            $('.frmfinalSelection #assigned_to option').prop('disabled', false);
            if (carrPrams[23] != "") {

                $('.frmfinalSelection #assigned_to').val(carrPrams[23]);
                $('.frmfinalSelection #assigned_to').attr('readonly', true);
                $('.frmfinalSelection #assigned_to option:not(:selected)').prop('disabled', true);
                //$('.frmfinalSelection #assigned_to').css('pointer-events','none');
            }
            $('.frmfinalSelection #assigned_to').select2();
            $('.frmfinalSelection #social_security_no').val(carrPrams[24]);
            $('.frmfinalSelection #pan_no').val(carrPrams[25]);
            $('.frmfinalSelection #father_husband_name').val(carrPrams[26]);
            $('.frmfinalSelection #relation').val(carrPrams[27]);
            $('.frmfinalSelection #caste').val(carrPrams[28]);
            $('.frmfinalSelection #marital_status').val(carrPrams[29]);
            //$('.frmfinalSelection #married_date').val(carrPrams[30]);
            $('.frmfinalSelection #bank_name').val(carrPrams[32]);
            $('.frmfinalSelection #branch_name').val(carrPrams[33]);
            $('.frmfinalSelection #bank_acc_no').val(carrPrams[34]);
            $('.frmfinalSelection #ifsc_code').val(carrPrams[35]);
            $('.frmfinalSelection #acc_type').val(carrPrams[36]);
            // $('.frmfinalSelection #mother_name').val(carrPrams[37]);
            $("#finalSelectionModel").modal('show');
            var dept_id = $('.frmfinalSelection #department_id').val();
            //alert(dept_id);
            populate_sub_dept_combo(dept_id);
            if (isIndiaLocation(carrPrams[10]) == true) {
                $('div#caste_main').show();
                $('#caste').attr('required', true);
            } else {
                $('div#caste_main').hide();
                $('#caste').removeAttr('required', true);
            }

            /*
             if (carrPrams[10] == 'KOL' || carrPrams[10] == 'BLR' || carrPrams[10] == 'CHE' || carrPrams[10] == 'DUR' || carrPrams[10] == 'HWH' || carrPrams[10] == 'JMP' || carrPrams[10] == 'KOC' || carrPrams[10] == 'MUM' || carrPrams[10] == 'NOI' || carrPrams[10] == 'KLY') {
             */

            if (isIndiaLocation(carrPrams[10]) == true) {
                $('#mother_name_div').show();
                // $('#mother_name').attr('required', true);
            } else {
                $('#mother_name_div').hide();
                // $('#mother_name').removeAttr('required', true);
            }

            if(carrPrams[10] == 'ALB'){
                $xpoid_title = 'Eleco ID <span class="red_bg">*</span>';
            }else{
                $xpoid_title = 'Emp ID/XPO ID';
                             
            }
            $('.frmfinalSelection #xpoid_title').html($xpoid_title);


            if((isUSLocation(carrPrams[10]) == true) ||( carrPrams[10] == 'MON' || carrPrams[10] == 'MEX')) {
                    $('#social_security_no').removeAttr("required");
                    $ssn_title = 'Social Security No / Aadhaar No';
                }
                else if( carrPrams[10] == 'JAM') {
                    $('#social_security_no').removeAttr("required");
                    $ssn_title = 'National ID';
                }  
                else if( isIndiaLocation(carrPrams[10]) == true) {
                   
                    $ssn_title = "Social Security No / Aadhaar No <span class='red_bg'>*</span>";
                    $('#social_security_no').prop('required',true);
                }   
                else if( carrPrams[10] == 'UKL') {
                    
                    $ssn_title = "National Insurance Number <span class='red_bg'>*</span>";
                    $('#social_security_no').prop('required',true);
                }   
                else{
                    $ssn_title = "Social Security No / Aadhaar No <span class='red_bg'>*</span>";
                    $('#social_security_no').prop('required',true);
                    
                }  

                $('.frmfinalSelection #ssn_lebel').html($ssn_title);



           


        });
        /////////////////Transfer Candidates////////////////

        $(".rejectCandidateTransfer").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var requisition_id = $(this).attr("requisition_id");
            var c_status = $(this).attr("c_status");
            $('.frmTransferCandidate #r_id').val(r_id);
            $('.frmTransferCandidate #c_id').val(c_id);
            $('.frmTransferCandidate #c_status').val(c_status);
            $(".frmTransferCandidate")[0].reset();
            $("#searchList").empty();
            $("#req_details").empty();
            $("#transferRejectCandidateModel").modal('show');
        });
        $(document).on('change',"#req_id",function () {
            var rid = this.value;
            if (rid == "")
                alert("Please Select The Requisition")
            var URL = '<?php echo base_url(); ?>dfr/getrequisitiondetails';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'rid=' + rid,
                success: function (rList) {
                    //alert(pList);
                    var json_obj = $.parseJSON(rList); //parse JSON

                    $('#req_details').empty();
                    /*$('#req_details').append($('<textarea></textarea>').val('').html(''));		<textarea style="width:550px; height:140px"></textarea> */

                    for (var i in json_obj)
                        $('#req_details').append($('<div></div>').html('<b>Department:</b> ' + json_obj[i].dept_name + '</br><b>Role:</b> ' + json_obj[i].role_name + '</br><b>No. of Position:</b> ' + json_obj[i].req_no_position + '</br><b>Batch Code:</b> ' + json_obj[i].job_title + '</br><b>Client:</b>' + json_obj[i].client_name + '</br><b>Process:</b>' + json_obj[i].process_name + '</br><b>Req. Skill:</b> ' + json_obj[i].req_skill));
                    $('#sktPleaseWait').modal('hide');
                },
                error: function () {
                    alert('Fail!');
                }

            });
        });
        //////////////////////////	
        $("#fdoffice_id").on('change', function () {
            var offid = this.value;
            var req_status = $('#req_status').val();
            //alert(req_status);
            if (offid == "CHA") {
                $('.frmAddRequisition #proposed_date_add_col').css('display', 'block');
                $('.frmAddRequisition .brand').val("12");
                $('.frmAddRequisition #location').val("CHA");
                $(".frmAddRequisition .site_cspl").css("display", "block");
                //$(".site_cspl").css("display","block");
                //$(".frmAddRequisition .site").prop('required',true);
            } else {
                $('.frmAddRequisition #proposed_date_add_col').css('display', 'none');
                $('.frmAddRequisition .brand').val("");
                $('.frmAddRequisition #location').val(offid);
                $(".frmAddRequisition .site_cspl").css("display", "none");
                //$(".site_cspl").css("display","none");
                //$(".frmAddRequisition .site").removeAttr("required");
            }

            if (offid == "")
                alert("--Select--");
            var URL = '<?php echo base_url(); ?>dfr/getRequisitionidstatus';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'offid=' + offid + '&req_status=' + req_status,
                success: function (offList) {
                    var json_obj = $.parseJSON(offList); //parse JSON
                    populate_brand_combo_dfr(offid, def = '', objid = 'brand_id', isAll = 'N');
                    $('#edrequisition_id')[0].selectize.clearOptions();
                    $('#edrequisition_id')[0].selectize.addOption({
                        value: "",
                        text: "All"
                    });
                    $('#edrequisition_id')[0].selectize.addItem(1);
                    for (var i in json_obj) {
                        $('#edrequisition_id')[0].selectize.addOption({
                            value: json_obj[i].requisition_id,
                            text: json_obj[i].requisition_id
                        });
                        $('#edrequisition_id')[0].selectize.addItem(i);
                    }

                    $('#sktPleaseWait').modal('hide');
                },
                error: function () {
                    alert('Fail!');
                }

            });
        });
        $("#fdoffice_ids").on('change', function () {
            generate_requisation();
        });
        $("#select-department").on('change', function () {
            generate_requisation();
        });
        $("#select-brand").on('change', function () {
            generate_requisation();
        });
        //$("#fdoffice_ids").on('change',function(){
        function generate_requisation() {
            var offid = $("#fdoffice_ids").val();
            var req_status = $('#req_status').val();
            var dept = $('#select-department').val();
            var brand = $('#select-brand').val();
            var URL = '<?php echo base_url(); ?>dfr/getRequisitionidstatus_filter';
            //$('#sktPleaseWait').modal('show');
            if ((offid != "") && (dept != "") && (brand != "")) {
                //$('#sktPleaseWait').modal('show');
                $('#requisation_div').css('display', 'block');
                $.ajax({
                    type: 'POST',
                    url: URL,
                    data: 'offid=' + offid + '&req_status=' + req_status + '&dept=' + dept + '&brand=' + brand,
                    success: function (offList) {
                        var json_obj = $.parseJSON(offList);
                        $('#edurequisition_id')[0].selectize.clearOptions();
                        $('#edurequisition_id')[0].selectize.addOption({
                            value: "",
                            text: "All"
                        });
                        $('#edurequisition_id')[0].selectize.addItem(1);
                        for (var i in json_obj) {
                            $('#edurequisition_id')[0].selectize.addOption({
                                value: json_obj[i].requisition_id,
                                text: json_obj[i].requisition_id
                            });
                            $('#edurequisition_id')[0].selectize.addItem(i);
                        }

                        //$('#sktPleaseWait').modal('hide');	

                    },
                    error: function () {
                        alert('Fail!');
                    }

                });
            } else {
                $('#requisation_div').css('display', 'none');
            }
            //});
        }

        $("#foffice_id").on('change', function () {
            var offid = this.value;
            if (offid == "")
                alert("--Select--");
            var URL = '<?php echo base_url(); ?>dfr/getRequisitionid';
            $('#sktPleaseWait').modal('show');
            $.ajax({
                type: 'POST',
                url: URL,
                data: 'offid=' + offid,
                success: function (offList) {
                    var json_obj = $.parseJSON(offList); //parse JSON

                    $('#requisition_id').empty();
                    $('#requisition_id').append($('<option></option>').val('').html('ALL'));
                    for (var i in json_obj) {
                        $('#requisition_id').append($('<option></option>').val(json_obj[i].requisition_id).html(json_obj[i].requisition_id));
                    }

                    $('#sktPleaseWait').modal('hide');
                },
                error: function () {
                    alert('Fail!');
                }

            });
        });
        ////////////// 

        $(".shorlistedCandidateTransfer").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var requisition_id = $(this).attr("requisition_id");
            var c_status = $(this).attr("c_status");
            $('.frmTransferShortlistedCandidate #r_id').val(r_id);
            $('.frmTransferShortlistedCandidate #c_id').val(c_id);
            $('.frmTransferShortlistedCandidate #requisition_id').val(requisition_id);
            $('.frmTransferShortlistedCandidate #c_status').val(c_status);
            $(".frmTransferShortlistedCandidate")[0].reset();
            $("#searchList").empty();
            $("#req_details").empty();
            $("#transferShortlistedCandidateModel").modal('show');
        });
        $(".selectedCandidateTransfer").click(function () {
            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var requisition_id = $(this).attr("requisition_id");
            var c_status = $(this).attr("c_status");
            $('.frmTransferSelectedCandidate #r_id').val(r_id);
            $('.frmTransferSelectedCandidate #c_id').val(c_id);
            $('.frmTransferSelectedCandidate #requisition_id').val(requisition_id);
            $('.frmTransferSelectedCandidate #c_status').val(c_status);
            $(".frmTransferSelectedCandidate")[0].reset();
            $("#searchList").empty();
            $("#req_details").empty();
            $("#transferSelectedCandidateModel").modal('show');
        });

        $(".letter_of_intent").click(function () {

            $('.frmLetterOfIntent #user_history').html("No Previous Record Found");


            var r_id = $(this).attr("r_id");
            var c_id = $(this).attr("c_id");
            var requisition_id = $(this).attr("requisition_id");
            var c_status = $(this).attr("c_status");
            $('.frmLetterOfIntent #r_id').val(r_id);
            $('.frmLetterOfIntent #c_id').val(c_id);
            var URL = '<?php echo base_url(); ?>dfr/loi_candidate_details';
            jQuery.ajax({
                url: URL,
                type: 'POST',
                data: {
                    r_id: r_id,
                    c_id: c_id
                },
                //dataType: "json",
                success: function (response) {
                    var json_obj = JSON.parse($.trim(response));
                    console.log(json_obj);

                    if (json_obj.c_name) {

                        $('.frmLetterOfIntent #user_history').html("");

                        $('.frmLetterOfIntent #user_history').append("Candidate Name: " + json_obj.c_name);

                        if (json_obj.fusion_id) {
                            $('.frmLetterOfIntent #user_history').append(", MWP Id: " + json_obj.fusion_id);
                        }
                        if (json_obj.l1_name) {
                            $('.frmLetterOfIntent #user_history').append(", L1 Name: " + json_obj.l1_name);
                        }
                        if (json_obj.doj) {
                            $('.frmLetterOfIntent #user_history').append(", DOJ: " + json_obj.doj);
                        }
                        if (json_obj.lwd) {
                            $('.frmLetterOfIntent #user_history').append(", LWD: " + json_obj.lwd);
                        }
                    }

                    $('.frmLetterOfIntent #onboarding_typ').val(json_obj.onboarding_typ);
                    $('.frmLetterOfIntent #fname').val(json_obj.fname);
                    $('.frmLetterOfIntent #lname').val(json_obj.lname);
                    $('.frmLetterOfIntent #email').val(json_obj.email);
                    $('.frmLetterOfIntent #training_start_date').val(json_obj.training_start_date);
                    $('.frmLetterOfIntent #stipend_amount').val(json_obj.stipend_amount);
                    $('.frmLetterOfIntent #ctc_amount').val(json_obj.ctc_amount);

                    if (json_obj.email == '') {
                        $('.frmLetterOfIntent #email').attr("readonly", false);
                        $('.frmLetterOfIntent #send_loi_button').prop("disabled", true);
                    } else {
                        $('.frmLetterOfIntent #email').attr("readonly", true);
                    }
                    $("#letter_of_intent").modal('show');
                }
            });
        });

        $('#send_loi_button').click(function (event) {
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/loi_send',
                data: $('.frmLetterOfIntent').serialize(),
                success: function () {
                    alert('Letter Send succesfully');
                    $("#letter_of_intent").modal('hide');
                    $('.frmLetterOfIntent').trigger("reset");
                    window.location.reload();
                }
            });
        });



        $('#stipend_amount').keypress(function (event) {
            if ((event.which != 46 || $(this).val().indexOf('.') != -1) && ((event.which < 48 || event.which > 57) && (event.which != 0 && event.which != 8))) {
                event.preventDefault();
            }
            var text = $(this).val();
            if ((text.indexOf('.') != -1) && (text.substring(text.indexOf('.')).length > 2) && (event.which != 0 && event.which != 8) && ($(this)[0].selectionStart >= text.length - 2)) {
                event.preventDefault();
            }
        });

        $('#ctc_amount').keypress(function (event) {
            if ((event.which != 46 || $(this).val().indexOf('.') != -1) && ((event.which < 48 || event.which > 57) && (event.which != 0 && event.which != 8))) {
                event.preventDefault();
            }
            var text = $(this).val();
            if ((text.indexOf('.') != -1) && (text.substring(text.indexOf('.')).length > 2) && (event.which != 0 && event.which != 8) && ($(this)[0].selectionStart >= text.length - 2)) {
                event.preventDefault();
            }
        });

        ///////////////////////////

        /*---------Search Area for All Candidate List-------------*/
        $("#myInput").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
        /*------------*/

        //////////////////////////////////////
        /* $("#formReqAdd").submit(function{
         $('#addRequisition').prop('disabled',true);
         }); */


        //////////////////////////////////////////////		
    });
    ////////////////////////////////////////////////////////////////	

    function checkDec(el) {
        var ex = /^[0-9]+\.?[0-9]*$/;
        if (ex.test(el.value) == false) {
            el.value = el.value.substring(0, el.value.length - 1);
        }
    }


    $(function () {
        $("#assign_interviewer").select2();
        $("#edassign_interviewer").select2();
    });
    /////////////////////////////////////////////////////
</script>

<script>

    $(document).ready(function () {
        $('#ref_name').select2({
            placeholder: "Type Your Source",
            allowClear: true,
            tags: true,
            dropdownParent: $("#addCandidateModel")
        });

        var pid = $("#transfer_location").val();
        var select_site = "";
        var department = "";

        // not required
        //dependent_requisition(pid, select_site, department);

    });

</script>

<script>
    $(document).on('click', '#job_source_portal,#job_source_consult,#job_source_newspaper,#job_source_callHR', function () {
        var refname = this.value;
        var datas = {
            'refname': refname
        };
        var URL = '<?php echo base_url(); ?>dfr/getRefConsultant';
        // $.ajax({
        // 	type: 'POST',    
        // 	url:URL,
        // 	data:'refname='+refname,
        // 	success: function(refList){
        // 		var json_obj = $.parseJSON(refList);//parse JSON
        // 		console.log(json_obj);
        // 		$('#ref_name').empty();

        // 		if(refname=='Job Portal'){
        // 			for (var i in json_obj){ 
        // 				$('#ref_name').append($('<option></option>').val(json_obj[i].job_portal).html(json_obj[i].job_portal)); 
        // 			}
        // 		}else if(refname=='Consultancy'){
        // 			for (var i in json_obj){ 
        // 				$('#ref_name').append($('<option></option>').val(json_obj[i].consultancy).html(json_obj[i].consultancy));
        // 			}

        // 		}
        // 		else if(refname=='Call From HR'){
        // 			for (var i in json_obj){ 
        // 				$('#ref_name').append($('<option></option>').val(json_obj[i].full_name).html(json_obj[i].full_name));
        // 			}
        // 		}
        // 		else{

        // 		}

        // 		$('#ref_name').val('').trigger('change');

        // 	},
        // 	error: function(){	
        // 		alert('Fail!');
        // 	}
        // });
        process_ajax(function (refList) {
            var json_obj = $.parseJSON(refList); //parse JSON          
            $('#ref_name').empty();
            if (refname == 'Job Portal') {
                // alert(refname);
                // $('#ref_name').empty();
                for (var i in json_obj) {
                    $('#ref_name').append($('<option></option>').val(json_obj[i].job_portal).html(json_obj[i].job_portal));
                }
            } else if (refname == 'Consultancy') {
                // alert(refname);
                // $('#ref_name').empty();
                for (var i in json_obj) {
                    $('#ref_name').append($('<option></option>').val(json_obj[i].consultancy).html(json_obj[i].consultancy));
                }

            } else if (refname == 'Call From HR') {
                for (var i in json_obj) {
                    $('#ref_name').append($('<option></option>').val(json_obj[i].full_name).html(json_obj[i].full_name));
                }
            } else {

            }

            $('#ref_name').val('').trigger('change');
        }, URL, datas, 'text');
    });
</script>

<script>
    $('#qualification_type').change(function () {
        var value = $(this).val();
        if (value != 'Others') {
            $('#req_qualification').val(value);
            $('#qualification_type').parent().parent().removeAttr('class');
            $('#qualification_type').parent().parent().addClass('col-md-3');
            $('#req_qualification_container').hide();
        } else {
            $('#req_qualification').val('');
            $('#req_qualification_container').show();
            $('#qualification_type').parent().parent().removeAttr('class');
            $('#qualification_type').parent().parent().addClass('col-md-3');
        }
    });
</script>


<script>
    /*$(document).on('click','#candidateFinalSelection',function(){
     $('[required]').each(function(index,element){
     if($(element).val() == '')
     {
     $('#candidateFinalSelection').prop('disabled',false);
     return false;
     }
     $('#candidateFinalSelection').prop('disabled',true);
     
     });
     }); 
     
     
     $('.frmfinalSelection').submit(function() {
     var error = 0;
     if(error){
     return false;
     }else{
     var ans=confirm('Are you sure to add this Candidate ?');
     $("#finalSelectionModel").modal('hide');
     return ans;
     }
     }); */

    /*$(document).ready(function () {

        $(".frmfinalSelection").submit(function (e) {

            console.log('check');
            var error = 0;
            if (error) {
                console.log('check2');
                return false;
            } else {
                var dt = 1;
                //console.log('check1');

                if ($('.checkrequired').length > 0) {

                    $(".frmfinalSelection .checkrequired").each(function () {
                        if ($(this).text() != '')
                            console.log($(this).text());
                    });

                    dt = 0;
                    //return false;
                }
                //console.log('check5');


                var ans = confirm('Are you sure to add this Candidate ?');

                $(".frmfinalSelection input[required]").each(function () {
                    if ($(this).val() == '')
                        dt = 0;
                    return false;
                });
                $(".frmfinalSelection select[required]").each(function () {
                    if ($(this).val() == "")
                        dt = 0;
                    return false;
                });

                if (dt == 1) {
                    $("#finalSelectionModel").modal('hide');
                    return true;
                } else {
                    alert("please fill up all mandatory fields");
                    return false;
                }


            }
            //$("#finalSelectionModel").modal('hide');
        });
    });*/

    $(document).ready(function() {

        $(".frmfinalSelection").submit(function(e) {
            //$("#finalSelectionModel").modal('hide');
        });
    });
</script>


<script>
    $(document).ready(function () {


        $(document).on("change", "#country", function () {
            $('#sktPleaseWait').modal('show');
            var URL = '<?php echo base_url(); ?>profile/stateList';
            var country = $("option:selected", this).attr("cid");
            //alert(country);

            jQuery.ajax({
                url: URL,
                type: 'POST',
                data: {
                    country: country
                },
                dataType: "json",
                success: function (response) {
                    $('#sktPleaseWait').modal('hide');
                    //alert(response);

                    if (response.error == false) {
                        if (response.state_list == "") {
                            $("#state").empty();
                            $("#state").append($('<option></option>').val('').html('--select--'));
                        } else {

                            $("#state").empty();
                            $("#state").append($('<option></option>').val('').html('--select--'));
                            for (var i in response.state_list) {
                                $('#state').append($('<option sid="' + response.state_list[i].id + '"></option>').val(response.state_list[i].name).html(response.state_list[i].name));
                            }

                            $("#city").empty();
                            $("#city").append($('<option></option>').val('').html('--select--'));
                            $("#city").attr("disabled", false);
                            $("#city_other").attr("disabled", true).removeAttr("required");
                        }
                    }
                }
            });
        });
        $(document).on("change", "#state", function () {
            $('#sktPleaseWait').modal('show');
            var URL = '<?php echo base_url(); ?>profile/cityList';
            var state = $("option:selected", this).attr("sid");
            //alert(state);

            jQuery.ajax({
                url: URL,
                type: 'POST',
                data: {
                    state: state
                },
                dataType: "json",
                success: function (response) {
                    $('#sktPleaseWait').modal('hide');
                    if (response.error == false) {
                        $("#city").attr("disabled", false);
                        $("#city_other").attr("disabled", true);
                        if (response.city_list == "") {

                            $("#city").empty();
                            $("#city").append($('<option></option>').val('').html('--select--'));
                            $("#city").append($('<option></option>').val('other').html('Other'));
                        } else {

                            $("#city").empty();
                            $("#city").append($('<option></option>').val('').html('--select--'));
                            for (var i in response.city_list) {
                                $('#city').append($('<option></option>').val(response.city_list[i].name).html(response.city_list[i].name));
                            }
                            $("#city").append($('<option></option>').val('other').html('Other'));
                        }
                    }
                }
            });
        });
        $(document).on("change", "#city", function () {

            if ($(this).val() == "other") {
                // $(this).attr("disabled",true);
                $("#city_other").attr("disabled", false).attr("required", true);
            } else {
                $("#city_other").attr("disabled", true).removeAttr("required");
            }

        });
        ////////////////// Start Salary calculation /////////////////////////	
        /////////////////////////////////////////////////////

        //$("#gross_amount").keyup(function(){
        //$(document).on('keyup change', '#gross_amount, #pay_type, #skill_set_slab, #emp_type', function () {
        $(document).on('keyup change', '#gross_amount, #pay_type, #skill_set_slab, #emp_type, #incentive_amt, #incentive_period', function () {
			
			
		// alert('11');

            var location_id = $('.frmApprovalFinalSelect #location_id').val().trim();
            var pay_type = $('.frmApprovalFinalSelect #pay_type').val().trim();
            var emp_type = $('.frmApprovalFinalSelect #emp_type').val().trim();
            var org_role = $('.frmApprovalFinalSelect #org_role').val().trim();
            var role_id = $('.frmApprovalFinalSelect #role_id').val().trim();
            var gender = $('.frmApprovalFinalSelect #gender').val().trim();
            var brand_id = $('.frmApprovalFinalSelect #brand_id').val().trim();
			
			////////
			
			if(emp_type==6){
			 
				$("#contract_dur_days").attr("readonly", false);
				$("#contract_dur_days").attr("required", "true");
                $("#contract_dur_days").css('pointer-events', 'auto');
				
			 }else{
				 $("#contract_dur_days").attr("readonly", true);
				 $("#contract_dur_days").removeAttr("required");
				 $("#contract_dur_days").val("");
                 $("#contract_dur_days").css('pointer-events', 'none');
			 }	
			
			if(pay_type == 14){
				$("#contract_dur_days").attr("readonly", false);
				$("#contract_dur_days").attr("required", "true");
                $("#contract_dur_days").css('pointer-events', 'auto');
				$("#emp_type").val("6");
				 $("#is_loi").attr('checked', false);
			}else{
				 $("#contract_dur_days").attr("readonly", true);
				 $("#contract_dur_days").removeAttr("required");
				 $("#contract_dur_days").val("");
                 $("#contract_dur_days").css('pointer-events', 'none');
				 $("#emp_type").val("1");
			}
			////////////
			
            //Not needed as per current salary stucture of chandighar 19-04-2023
            //var skill_set_slab = $('.frmApprovalFinalSelect #skill_set_slab').val().trim();
            var skill_set_slab = "";

            if (skill_set_slab == "")
                skill_set_slab = 0;
            if (emp_type == "")
                emp_type = 3;

            var incentive_period = $('#incentive_period').val();
            var pli_employers = 0;
            var pli_employers_year = 0; 
            var pli_employers = Math.round($('#incentive_amt').val());

            if (isIndiaLocation(location_id) == true || location_id == "CHA") {
                if(incentive_period == 'Monthly'){  
                    pli_employers = Math.round($('#incentive_amt').val());              
                    pli_employers_year = Math.round(pli_employers * 12);           
                    
                    $("#incentive_amt").attr("readonly", false); 
                    $("#incentive_amt").attr("required", "true");

                } else if(incentive_period == 'Yearly'){
                    pli_employers_year = Math.round($('#incentive_amt').val());
                    pli_employers = Math.round(pli_employers_year / 12);   

                    $("#incentive_amt").attr("readonly", false); 
                    $("#incentive_amt").attr("required", "true");

                } else{
                    pli_employers = 0;
                    pli_employers_year = 0;

                    $("#incentive_amt").attr("readonly", true); 
                    $("#incentive_amt").removeAttr("required");
                    $("#incentive_amt").val(0);
                }
            } 

            

            //12 - cspl
            var gr_amt = $('#gross_amount').val();
            // alert(gr_amt);
            gender = gender.toLowerCase();

            var bsc = 0;
            var hr = 0;
            var conv_amt = 0;
            var bonus_amt = 0;
            var medical_amt = 0;
            var gratuity_employers = 0;

            var lwf_employers = 0;
            var lwf_employers_year = 0;
            var lwf_employees = 0;
            var lwf_employees_year = 0;

            var pt = 0;

            var esi_employers = 0;
            var esi_employersyr = 0;
            var esi_employees = 0;
            var esi_employeesyr = 0;

            var pf_employers = 0;
            var pf_employersyr = 0;

            var pf_employees = 0;
            var pf_employeesyr = 0;


            if (isIndiaLocation(location_id) == true || location_id == "CHA") {
				
				

                get_stipend_data();

                if (pay_type == "1" || pay_type == "7" || pay_type == "8" || pay_type == "9") {

                    $('#grossid label').html('Monthly Total Earning');

                    if (gr_amt >= 1000) {
                        //var bonus_per = .0833;
                         //As per new salary annexture on 17-10-2023
                        var bonus_per = 0;

                        bsc = get_basic(gr_amt, location_id, org_role);
                        hr = get_hra(bsc, location_id, org_role);
                        conv_amt = get_conveyance(gr_amt, location_id, emp_type);

                        gratuity_employers = get_gratuity_employer(bsc, location_id);

                        lwf_employers = get_lwf_employer(location_id,brand_id);
                        lwf_employers_year = get_lwf_employer_year(location_id,brand_id);

                        lwf_employees = get_lwf_employee(location_id,brand_id);
                        lwf_employees_year = get_lwf_employee_year(location_id,brand_id);


                        //alert(brand_id + ">> " + location_id);

                        if (gender == "" && location_id == "MUM")
                            alert("Gender Field is blank");
                        pt = get_ptax(gr_amt, location_id, gender);
                        //alert(gr_amt);

                        //var gr_amt_esi = Math.round(gr_amt + parseInt(pli_employers) - conv_amt);                        
						//var gmt_calamount = Math.round(gr_amt + parseInt(pli_employers));
                        //alert(gmt_calamount);
                        //var gr_amt_esi = Math.round((gr_amt - conv_amt) + parseInt(pli_employers));       
                        
                        //AS per new salary annexture on 17-10-2023
                        var gr_amt_esi = Math.round((gr_amt - conv_amt)); 
                        //var gmt_calamount = Math.round((gr_amt - conv_amt) + parseInt(pli_employers));

                        if(location_id == "CHA"){
                            var gmt_calamount = Math.round((gr_amt - conv_amt) + parseInt(pli_employers));
                        }else{
                            var gmt_calamount = Math.round((gr_amt - conv_amt));
                        }
						
                        esi_employers = get_esi_employer(gr_amt_esi, location_id, gmt_calamount);
                        esi_employees = get_esi_employee(gr_amt_esi, location_id, gmt_calamount);
                        
                        esi_employersyr = Math.round(esi_employers * 12); // ESI Employer's yearly
                        esi_employeesyr = Math.round(esi_employees * 12); // ESI Employee's yearly

                        pf_employers = get_pf_employer(bsc, location_id);
                        pf_employersyr = pf_employers * 12;

                        pf_employees = get_pf_employee(bsc, location_id);
                        pf_employeesyr = pf_employees * 12;

                        //alert(brand_id + ">> " + location_id);


                        if (location_id == "CHA" || brand_id == "12") {

                            //alert(brand_id + ">> " + location_id);

                            $('.cspl').show();
                            $('.ind_oth').hide();

                            //Not needed as per current salary stucture of chandighar 19-04-2023
                            $('#csplBonus').hide();

                            bonus_amt = Math.round(skill_set_slab * bonus_per);
                            bonus_amt = 0; //As per new salary annexture on 17-10-2023
                            medical_amt = gr_amt - (bsc + hr + conv_amt + bonus_amt);

                        }

                        // For UI display
                        if (gr_amt != '') {

                            if (location_id == "CHA" || brand_id == "12") {

                                //alert('OK');
                                $('.cspl').show();
                                $('.ind_oth').hide();
                                //Not needed as per current salary stucture of chandighar 19-04-2023
                                $('#csplBonus').hide();

                            } else {
                                $('.cspl').hide();
                                $('.ind_oth').show();
                                $('#csplBonus').hide();

                            }
                            if ($("#is_loi").is(":not(:checked)")) {
                                $('#calcKOL').show();
                            }

                        } else {
                            $('#calcKOL').hide();
                        }

                        //alert(bsc); 

                        $('#basic').val(bsc);
                        $('#basicyr').val(bsc * 12); // yearly calcultion
                        $('#hra').val(hr);
                        $('#hrayr').val(hr * 12); /// Year callculation
                        $('#conveyance').val(conv_amt);
                        $('#conveyanceyr').val(conv_amt * 12); // Yearly callculation

                        $('#allowance').val(gr_amt - (bsc + hr + conv_amt));
                        $('#allowanceyr').val((gr_amt - (bsc + hr + conv_amt)) * 12); // Yearly callculation

                        $('#bonus_amt').val(bonus_amt);
                        $('#bonus_amtyr').val(bonus_amt * 12); // Yearly callculation

                        $('#medical_amt').val(medical_amt);
                        $('#medical_amtyr').val(medical_amt * 12); // Yearly callculation

                        $('#ptax').val(pt);
                        $('#ptaxyr').val(pt * 12);


                        if (pay_type == "8") {
                            esi_employers = 0;
                            esi_employersyr = 0;
                            esi_employees = 0;
                            esi_employeesyr = 0;

                            pf_employers = 0;
                            pf_employersyr = 0;

                            pf_employees = 0;
                            pf_employeesyr = 0;

                        }

                        //// CTC Calculation ////////////


                        var employers_contribution = Math.round(parseInt(esi_employers) + parseInt(pf_employers) + parseInt(lwf_employers) + parseInt(gratuity_employers));

                        var employees_deduction = Math.round(parseInt(pt) + parseInt(esi_employees) + parseInt(pf_employees) + parseInt(lwf_employees));

                        var ctc = Math.round(parseInt(gr_amt) + parseInt(esi_employers) + parseInt(pf_employers) + parseInt(lwf_employers) + parseInt(gratuity_employers) + parseInt(pli_employers));
                       

                        //// Take home calculation                        
                        var tk_home = Math.round(gr_amt - (pt + esi_employees + pf_employees + lwf_employees)) + parseInt(pli_employers);


                        var employers_contribution_year = Math.round((parseInt(esi_employers + pf_employers + gratuity_employers) * 12) + lwf_employers_year);

                        var employees_deduction_year = Math.round((parseInt(pt + esi_employees + pf_employees) * 12) + lwf_employees_year);


                        var gross_year = Math.round(gr_amt * 12);
                        var ctc_year = Math.round(gross_year + employers_contribution_year) + parseInt(pli_employers_year);

                        var tk_home_year = Math.round(gross_year - employees_deduction_year) + parseInt(pli_employers_year);
 

                        $('#esi_employers').val(esi_employers); // esi_employers 
                        $('#esi_employersyr').val(esi_employersyr); // esi_employersyr Yearly
                        $('#esi_employees').val(esi_employees); // esi_employees 
                        $('#esi_employeesyr').val(esi_employeesyr); // esi_employeesyr Yearly

                        $('#pf_employers').val(pf_employers); // pf_employers 
                        $('#pf_employersyr').val(pf_employersyr); // pf_employersyr Yearly
                        $('#pf_employees').val(pf_employees); // pf_employees 
                        $('#pf_employeesyr').val(pf_employeesyr); // pf_employeesyr Yearly

                        $('#lwf_employers').val(lwf_employers);
                        $('#lwf_employersyr').val(lwf_employers_year);

                        $('#lwf_employees').val(lwf_employees);
                        $('#lwf_employeesyr').val(lwf_employees_year);
                        

                        $('#pli_employers').val(pli_employers); 
                        $('#pli_employersyr').val(pli_employers_year);


                        $('#gratuity_employers').val(gratuity_employers);
                        $('#gratuity_employersyr').val(gratuity_employers * 12); // Yearly callculation

                        $('#tot_earning').val(gr_amt); // Total Earning
                        $('#tot_earningyr').val(gross_year); // Total Earning Yearly

                        $('#ctc').val(ctc); // ctc 
                        $('#ctcyr').val(ctc_year); // ctc Yearly

                        $('#tk_home').val(tk_home); // Take home calculation
                        $('#tk_homeyr').val(tk_home_year); // Take home Yearly calculation

                        $('#ctcchecker').val(ctc);
                        $('#grosschecker').val(tk_home);
                        //alert(gr_amt);

                        get_stipend_data(ctc);//For Loi amount

                    }

                } else if (pay_type == "6") {

                    //var conv_amt = get_conveyance(gr_amt,location_id);
                    //var gr_amt_esi = Math.round(gr_amt - conv_amt);

                    var esi_employers = get_esi_employer(gr_amt, location_id, gr_amt);
                    var esi_employees = get_esi_employee(gr_amt, location_id, gr_amt);

                    // var gratuity_employers = get_gratuity_employer(bsc,location_id);
                    // var lwf_employers = get_lwf_employer(location_id);			
                    // var lwf_employees = get_lwf_employee(location_id);

                    if (gender == "" && location_id == "MUM")
                        alert("Gender Field is blank");
                    pt = get_ptax(gr_amt, location_id, gender);

                    var tk_home = Math.round(gr_amt - (esi_employees + pt));

                    var ctc = Math.round(parseInt(gr_amt) + parseInt(esi_employers));

                    get_stipend_data(ctc);//Fo Loi amount

                    $('#ctcchecker').val(ctc);
                    $('#grosschecker').val(tk_home);
                    $('#calcKOL').hide();
                    $('#grossid label').html('Total CTC <i class="fa fa-asterisk" style="font-size:6px; color:red"></i> ');

                } else {

                    get_stipend_data(gr_amt);
                    $('#ctcchecker').val(gr_amt);
                    $('#grosschecker').val(gr_amt);
                    $('#calcKOL').hide();

                    if ((pay_type == "2") || (pay_type == "3"))
                        $('#grossid label').html('Hourly Earning');
                    else if (pay_type == "11")
                        $('#grossid label').html('Per Day Earning');
                    else
                        $('#grossid label').html('Total CTC <i class="fa fa-asterisk" style="font-size:6px; color:red"></i>');
                }

            } else {
                // $('#+++++++++').val(gr_amt);
                $('#ctcchecker').val(gr_amt);
                $('#grosschecker').val(gr_amt);
                $('#calcKOL').hide();
                $("#tranee_agent").css('display', 'none');
                if ((pay_type == "2") || (pay_type == "3"))
                    $('#grossid label').html('Hourly Earning');
                else if (pay_type == "11")
                    $('#grossid label').html('Per Day Earning');
                else
                    $('#grossid label').html('Total CTC <i class="fa fa-asterisk" style="font-size:6px; color:red"></i>');
            }


        });

        // CANDIDATE SELECTION GROSS PAY FINAL CHECK

        $('.frmApprovalFinalSelect #finalcheck').on('click', function () {

            var v_doj = $('.frmApprovalFinalSelect #doj').val();
            var v_comment = $('.frmApprovalFinalSelect #approved_comment').val();
            var v_paytype = $('.frmApprovalFinalSelect #pay_type').val();
            var v_currency = $('.frmApprovalFinalSelect #pay_currency').val();
            var v_gross = $('.frmApprovalFinalSelect #gross_amount').val();
            var location_id = $('.frmApprovalFinalSelect #location_id').val();
            // && (v_paytype != "") && (v_currency != "") && (v_gross != "")

            //const check_locations = ["ALT", "MON", "DRA", "FTK", "HIG", "MIN", "SPI", "TEX", "UTA", "CAM"];


            var payroll_chek = $('#payroll_chek').val();


            if (payroll_chek == 1) {
                if ((v_doj != "") && (v_comment != "")) {

                    $('#modalfinalchecknow').modal();

                    var grossc = $('#grosschecker').val();
                    var ctcc = $('#ctcchecker').val();
                    var msgpay = "You have entered <b>[Take Home: " + grossc + ", and CTC: " + ctcc + "]</b> <br/><br/>Please check before submitting, you cannot reverse the action.";
                    $("#modalfinalchecknowbody").html(msgpay);

                } else {

                    alert('Please Fill All Details!');
                }
            } else {
                if ((v_doj != "") && (v_comment != "") && (v_paytype != "") && (v_currency != "") && (v_gross != "")) {

                    $('#modalfinalchecknow').modal();
                    // p

                    // p

                    var grossc = $('#grosschecker').val();
                    var ctcc = $('#ctcchecker').val();
                    var msgpay = "You have entered <b>[Take Home: " + grossc + ", and CTC: " + ctcc + "]</b> <br/><br/>Please check before submitting, you cannot reverse the action.";
                    $("#modalfinalchecknowbody").html(msgpay);
                } else {

                    alert('Please Fill All Details!');
                }
            }



        });
        $('#finalcheckedsubmit').on('click', function () {
            $("#candidateSelectionForm").submit();
        });

        $('.frmApprovalFinalSelectPhp #finalcheckphp').on('click', function () {

            var required = $('input,textarea,select').filter('[required]:visible');
            var allRequired = true;
            required.each(function () {
                if ($(this).val() == '') {
                    allRequired = false;
                }
            });
            var v_qualification = $('.frmApprovalFinalSelectPhp #qualification').val();
            var v_job_summary = $('.frmApprovalFinalSelectPhp #job_summary').val();
            if (v_qualification == '') {
                allRequired = false;
            }
            if (v_job_summary == '') {
                allRequired = false;
            }

            var v_doj = $('.frmApprovalFinalSelectPhp #doj').val();
            var v_deminimis = $('#deminimis').val();
            var v_standard_incentive = $('#standard_incentive').val();
            var v_account_premium = $('#account_premium').val();
            var v_night_differential = $('#night_differential').val();
            var v_basicsalary = $('#basic_salary').val();
            var total_amount = $('#total_amount').val();
            //console.log(v_basicsalary)
            //var v_totalamount = parseInt(v_deminimis) + parseInt(v_standard_incentive) + parseInt(v_account_premium) + parseInt(v_night_differential) + parseInt(v_basicsalary);
            //$('#total_amount').val(v_totalamount);
            //alert(v_totalamount);
            //var v_totalamount = $('.frmApprovalFinalSelectPhp #total_amount').val();
            //alert(allRequired);
            //if ((v_doj != "") || (v_basicsalary != "") || (v_deminimis != "") || (v_standard_incentive != "") || (v_account_premium != "") || (v_night_differential != "") || (v_totalamount != "")) {
            if (allRequired == true) {
                $('#modalfinalchecknowphp').modal();
                // p
                //alert('Fail!');
                // p

                var grossc = $('#basic_salary').val();
                var ctcc = $('#total_amount').val();
                var msgpay = "You have entered <b>[Total : " + ctcc + "]</b> <br/><br/>Please check before submitting, you cannot reverse the action.";
                $("#modalfinalchecknowbodyphp").html(msgpay);
            } else {

                alert('Please Fill All Details!');
            }

        });
        $('#finalcheckedsubmitphp').on('click', function () {
            $("#candidateSelectionFormPhp").submit();
        });
    });
    ///////////////////////////////////////////////////////////////////////////
    $(".VerifyDocuments").click(function () {
        var r_id = $(this).attr("r_id");
        var c_id = $(this).attr("c_id");
        var is_verify = $(this).attr("is_verify");
        var cURL = $(this).attr("rel");
        $('.frmVerifyDocuments #r_id').val(r_id);
        $('.frmVerifyDocuments #c_id').val(c_id);
        if (is_verify == 0) {
            $('.frmVerifyDocuments #verify_submit_btn').show();
            $('.frmVerifyDocuments #certify_documents_div').show();
        } else {
            $('.frmVerifyDocuments #verify_submit_btn').hide();
            $('.frmVerifyDocuments #certify_documents_div').hide();
        }
        $('#sktPleaseWait').modal('show');
        $.get(cURL, function (data) {
            $('#sktPleaseWait').modal('hide');
            $('#VerifyDocumentsModal').find('#VerifyDocumentsContent').html(data);
            $("#VerifyDocumentsModal").modal('show');
        })



    });
    // DROP CANDIDATE
    $(".dropCandidateBtn").click(function () {
        var r_id = $(this).attr("r_id");
        var c_id = $(this).attr("c_id");
        $('.frmdropCandidate #r_id').val(r_id);
        $('.frmdropCandidate #c_id').val(c_id);
        $("#dropCandidateModal").modal('show');
    });

    $(".viewbgv").click(function () {
        var r_id = $(this).attr("r_id");
        var c_id = $(this).attr("c_id");


        $.ajax({
            type: 'POST',
            url: "<?php echo base_url('bgv/getBgvData'); ?>",
            data: 'c_id=' + c_id + '&r_id=' + r_id,
            success: function (offList) {

                var json_obj = $.parseJSON(offList);

                if (json_obj.hasOwnProperty('add_user_id') == true) {
                    $('.frmBGVCandidate #crc_date').val('').removeAttr("disabled");
                    $('.frmBGVCandidate #address_verification_date').val('').removeAttr("disabled");

                    $('.frmBGVCandidate #uploadFile_1').css("display", "block");
                    $('.frmBGVCandidate #uploadFile_2').css("display", "block");

                    $('.frmBGVCandidate #address_verification_doc').val('').css("display", "none");
                    $('.frmBGVCandidate #crc_doc').val('').css("display", "none");

                    $('.frmBGVCandidate #crc_doc_view').hide();
                    $('.frmBGVCandidate #address_verification_doc_view').hide();

                    $("#updateCandidateBGVModal .frmSaveButton").show();
                } else {

                    for (var i in json_obj) {
                        $('.frmBGVCandidate #crc_date').val(json_obj[i].crc_date).prop("disabled", true);
                        $('.frmBGVCandidate #address_verification_date').val(json_obj[i].address_verification_date).prop("disabled", true);

                        $('.frmBGVCandidate #uploadFile_1').css("display", "none");
                        $('.frmBGVCandidate #uploadFile_2').css("display", "none");

                        $('.frmBGVCandidate #address_verification_doc').val(json_obj[i].address_verification_doc).css("display", "block");
                        $('.frmBGVCandidate #crc_doc').val(json_obj[i].crc_doc).css("display", "block");

                        var url_address_verification_doc = '<?php echo base_url() . "uploads/bgv_doc/" ?>' + json_obj[i].address_verification_doc;
                        var url_crc_doc = '<?php echo base_url() . "uploads/bgv_doc/" ?>' + json_obj[i].crc_doc;

                        $('.frmBGVCandidate #crc_doc_view').show();
                        $('.frmBGVCandidate #address_verification_doc_view').show();

                        $('.frmBGVCandidate #crc_doc_view').html('<a onclick=window.open("' + url_crc_doc + '"),"popUpWindow","height=500,width=400,left=100,top=100,resizable=no,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no,status=yes"><i class="fa fa-eye"></i></a>');

                        $('.frmBGVCandidate #address_verification_doc_view').html('<a onclick=window.open("' + url_address_verification_doc + '"),"popUpWindow","height=500,width=400,left=100,top=100,resizable=no,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no,status=yes"><i class="fa fa-eye"></i></a>');

                        $("#updateCandidateBGVModal .frmSaveButton").hide();
                    }

                }
            },
            error: function () {
                //$('#sktPleaseWait').modal('hide');
                alert('Something Went Wrong!');
            }
        });
        $('.frmBGVCandidate #r_id').val(r_id);
        $('.frmBGVCandidate #c_id').val(c_id);
        $("#updateCandidateBGVModal").modal('show');
    });

    $('#hir #hiring_source').on('change', function () {

        var refname = this.value;
        var URL = '<?php echo base_url(); ?>dfr/getRefConsultant';
        $.ajax({
            type: 'POST',
            url: URL,
            data: 'refname=' + refname,
            success: function (refList) {
                var json_obj = $.parseJSON(refList); //parse JSON

                $('#reff_name').empty();
                if (refname == 'Job Portal') {
                    $("#lebel_reff").text("Job Portal");
                    for (var i in json_obj) {
                        $('#reff_name').append($('<option></option>').val(json_obj[i].job_portal).html(json_obj[i].job_portal));
                    }
                } else if (refname == 'Consultancy') {
                    $("#lebel_reff").text("Consultancy");
                    for (var i in json_obj) {
                        $('#reff_name').append($('<option></option>').val(json_obj[i].consultancy).html(json_obj[i].consultancy));
                    }

                } else if (refname == 'Call From HR') {
                    $("#lebel_reff").text("Call From HR");
                    for (var i in json_obj) {
                        $('#reff_name').append($('<option></option>').val(json_obj[i].fname).html(json_obj[i].fname));
                    }

                } else {

                }

                $('#ref_name').val('').trigger('change');
            },
            error: function () {
                alert('Fail!');
            }
        });
        var source = $('#hir #hiring_source').val();
        if (source == 'Existing Employee') {
            $(".existing").removeAttr('style');
            $(".not_friend_referal").hide();
            $("#sorce").hide();
        } else if (source == 'Job Portal' || source == 'Consultancy' || source == 'Call From HR') {
            $(".not_friend_referal").removeAttr('style');
            $(".existing").hide();
            $("#sorce").hide();
        } else {
            $("#sorce").show();
            $(".existing").hide();
            $(".not_friend_referal").hide();
        }
    });
    $('#exam').change(function () {
        exam = $(this).val();
        loc = $('#office_location').html();
        $('#12eng').removeAttr('required');
        $('#12math').removeAttr('required');
        if (loc == 'Chandigarh') {
            if ((exam != '10th Pass')) {
                $('#12eng').attr('required', 'true');
                $('#12math').attr('required', 'true');
            } else {
                $('#12eng').removeAttr('required');
                $('#12math').removeAttr('required');
            }
        }
    });
    $('.Interviewfromupload').click(function () {
        var r_id = $(this).attr("r_id");
        var c_id = $(this).attr("c_id");
        $('.frminterviewformupload #r_id').val(r_id);
        $('.frminterviewformupload #c_id').val(c_id);
        $('#InterviewEvalutionFrom').modal('show');
    });
    $('.frminterviewformupload').submit(function (e) {
        e.preventDefault();
        var frm = $('#frminterviewformupload')[0];
        var formData = new FormData(frm);
        $('#sktPleaseWait').modal('show');
        URL = "<?php echo base_url('dfr/uploadInterviewFrom'); ?>";
        $.ajax({
            url: URL,
            type: 'POST',
            data: formData,
            success: function (data) {
                alert(data);
                $('#sktPleaseWait').modal('hide');
                $('#InterviewEvalutionFrom').modal('hide');
            },
            cache: false,
            contentType: false,
            processData: false
        });
    });
    $('.upload_loi').click(function () {
        var r_id = $(this).attr("r_id");
        var c_id = $(this).attr("c_id");
        $('.frmloi #r_id').val(r_id);
        $('.frmloi #c_id').val(c_id);
        $('#loi_form').modal('show');
    });
    $('.frmloi').submit(function (e) {
        e.preventDefault();
        var frm = $('#frmloi')[0];
        var formData = new FormData(frm);
        $('#sktPleaseWait').modal('show');
        URL = "<?php echo base_url('dfr/upload_loi'); ?>";
        $.ajax({
            url: URL,
            type: 'POST',
            data: formData,
            success: function (data) {
                alert(data);
                $('#sktPleaseWait').modal('hide');
                $('#loi_form').modal('hide');
            },
            cache: false,
            contentType: false,
            processData: false
        });
    });
    $('.upload_joining').click(function () {
        var r_id = $(this).attr("r_id");
        var c_id = $(this).attr("c_id");
        $('.frmjoiningkit #r_id').val(r_id);
        $('.frmjoiningkit #c_id').val(c_id);
        $('#upload_joining_kit_form').modal('show');
    });
    $('.frmjoiningkit').submit(function (e) {
        e.preventDefault();
        var frm = $('#frmjoiningkit')[0];
        var formData = new FormData(frm);
        $('#sktPleaseWait').modal('show');
        URL = "<?php echo base_url('dfr/upload_joining_kit'); ?>";
        $.ajax({
            url: URL,
            type: 'POST',
            data: formData,
            success: function (data) {
                alert(data);
                $('#sktPleaseWait').modal('hide');
                $('#upload_joining_kit_form').modal('hide');
            },
            cache: false,
            contentType: false,
            processData: false
        });
    });
    //===============REFERRAL JS =====================//

    $('.btnInfoReferral').click(function () {
        baseURL = "<?php echo base_url(); ?>";
        eidVal = $(this).attr('eid');
        $('#modalInfoReferral .modal-body').html('<span class="text-danger">-- No Info Found --</span>');
        $.ajax({
            url: "<?php echo base_url('dfr/employee_referral_view_details'); ?>",
            type: "GET",
            data: {
                eid: eidVal
            },
            dataType: "text",
            success: function (result) {
                $('#modalInfoReferral .modal-body').html(result);
                $('#modalInfoReferral').modal('show');
                var location = $('#loc').text();
                var site = $('#site_id').text();
                // alert(location);
                if (location == 'CHA') {
                    $('#rf_updateReferralMoveFrm #company').val("12");
                    $('#rf_updateReferralMoveFrm #location').val(location);
                }
                if (site) {
                    $('#rf_updateReferralMoveFrm .site').val(site);
                }
            },
            error: function (result) {
                alert('Something Went Wrong!');
            }
        });
    });

    function repload_referral_div(eidVal) {
        $('#modalInfoReferral .modal-body').html('');
        $.ajax({
            url: "<?php echo base_url('dfr/employee_referral_view_details'); ?>",
            type: "GET",
            data: {
                eid: eidVal
            },
            dataType: "text",
            success: function (result) {
                $('#modalInfoReferral .modal-body').html(result);
                $('#modalInfoReferral').modal('show');
            },
            error: function (result) {
                alert('Something Went Wrong!');
            }
        });
    }


    $('#modalInfoReferral').on('click', '.rf_updateReferralStatus', function () {
        if ($('#rf_updateReferralStatusFrm')[0].checkValidity()) {
            // CAPTCHA VALIDATION
            captchaValidation = 0;
            refID = $('#modalInfoReferral #rf_updateReferralStatusFrm input[name="selection_id"]').val();
            if (refID != "") {
                $('#sktPleaseWait').modal('show');
                var postData = new FormData($('#rf_updateReferralStatusFrm')[0]);
                $.ajax({
                    url: "<?php echo base_url('dfr/employee_referral_update_status'); ?>",
                    type: "POST",
                    data: postData,
                    dataType: "text",
                    processData: false,
                    contentType: false,
                    success: function (jsonData) {
                        //alert(refID);
                        repload_referral_div(refID);
                        $('#sktPleaseWait').modal('hide');
                    },
                    error: function (jsonData) {
                        $('#sktPleaseWait').modal('hide');
                        alert('Something Went Wrong!');
                    }
                });
            } else {
                alert("Invaid Parameters!");
            }

        } else {
            $("#rf_updateReferralStatusFrm")[0].reportValidity();
        }
    });
    $('#modalInfoReferral').on('change', '#rf_updateReferralMoveFrm select[name="selection_location"]', function () {
        var offid = $(this).val();
        // alert(offid);
        if (offid == 'CHA') {
            var site = $('#site_id').text();
            $("#rf_updateReferralMoveFrm .site_cspl").css("display", "block");
            $("#rf_updateReferralMoveFrm .site").prop('required', true);
            $('#rf_updateReferralMoveFrm #company').val("12");
            if (site) {
                $('#rf_updateReferralMoveFrm .site').val(site);
            }
        } else {
            $('#rf_updateReferralMoveFrm #company').val("");
            $('#rf_updateReferralMoveFrm .site').val("");
            $("#rf_updateReferralMoveFrm .site_cspl").css("display", "none");
            $("#rf_updateReferralMoveFrm .site").removeAttr('required');
        }

        var req_status = '0';
        $('#sktPleaseWait').modal('show');
        $.ajax({
            type: 'POST',
            url: "<?php echo base_url('dfr/getRequisitionidstatus'); ?>",
            data: 'offid=' + offid + '&req_status=' + req_status,
            success: function (offList) {
                var json_obj = $.parseJSON(offList);
                $('#rf_updateReferralMoveFrm select[name="selection_requisition"]').empty();
                $('#rf_updateReferralMoveFrm select[name="selection_requisition"]').append($('<option></option>').val('').html('-- Select --'));
                for (var i in json_obj) {
                    $('#rf_updateReferralMoveFrm select[name="selection_requisition"]').append($('<option></option>').val(json_obj[i].requisition_id).html(json_obj[i].requisition_id));
                }
                $('#sktPleaseWait').modal('hide');
            },
            error: function () {
                $('#sktPleaseWait').modal('hide');
                alert('Something Went Wrong!');
            }
        });
    });
    $('#modalInfoReferral').on('change', '#rf_updateReferralMoveFrm select[name="selection_requisition"]', function () {
        var reqID = $(this).val();
        $('#sktPleaseWait').modal('show');
        $.ajax({
            url: "<?php echo base_url('dfr/employee_referral_requistion_details'); ?>",
            type: "GET",
            data: {
                rid: reqID
            },
            dataType: "json",
            success: function (jsonData) {
                $('#rf_updateReferralMoveFrm textarea[name="selection_details"]').val(jsonData.job_title + ', ' + jsonData.job_desc);
                $('#sktPleaseWait').modal('hide');
            },
            error: function () {
                $('#sktPleaseWait').modal('hide');
                alert('Something Went Wrong!');
            }
        });
    });
    $('#modalInfoReferral').on('click', '.rf_updateReferralMove', function () {
        if ($('#rf_updateReferralMoveFrm')[0].checkValidity()) {
            // CAPTCHA VALIDATION
            captchaValidation = 0;
            refID = $('#modalInfoReferral #rf_updateReferralMoveFrm input[name="selection_id"]').val();
            if (refID != "") {
                $('#sktPleaseWait').modal('show');
                var postData = new FormData($('#rf_updateReferralMoveFrm')[0]);
                $.ajax({
                    url: "<?php echo base_url('dfr/employee_referral_move_requisition'); ?>",
                    type: "POST",
                    data: postData,
                    dataType: "text",
                    processData: false,
                    contentType: false,
                    success: function (jsonData) {
                        //alert(refID);
                        console.log(jsonData);
                        repload_referral_div(refID);
                        $('#sktPleaseWait').modal('hide');
                    },
                    error: function (jsonData) {
                        $('#sktPleaseWait').modal('hide');
                        alert('Something Went Wrong!');
                    }
                });
            } else {
                alert("Invaid Parameters!");
            }

        } else {
            $("#rf_updateReferralMoveFrm")[0].reportValidity();
        }
    });
    $('#modalInfoReferral').on('click', '.ref_sendMyLink', function () {
        currentURL = $(this).attr('hrefURL');
        $.get(currentURL, function (dataCap) {
            alert('Mail Has Been Sent Successfully!');
        });
    });
    $(function () {
        $('#search_req').keyup(function () {
            srch = $(this).val();
            $.ajax({
                url: "<?php echo base_url('dfr/get_requisition_data'); ?>",
                type: "GET",
                data: 'search_req=' + srch,
                dataType: "text",
                processData: false,
                contentType: false,
                success: function (resp) {
                    $('#searchList').html(resp);
                },
                error: function (resp) {

                }
            });
        });
    });

    function set_data(dat, id) {
        $('#searchList').html('');
        $('#search_req').val(dat);
        $('#req_id').val(id);
        var URL = '<?php echo base_url(); ?>dfr/getrequisitiondetails';
        $('#sktPleaseWait').modal('show');
        $.ajax({
            type: 'POST',
            url: URL,
            data: 'rid=' + id,
            success: function (rList) {
                //alert(pList);
                var json_obj = $.parseJSON(rList); //parse JSON

                $('#req_details').empty();
                for (var i in json_obj)
                    $('#req_details').append($('<div></div>').html('<b>Department:</b> ' + json_obj[i].dept_name + '</br><b>Role:</b> ' + json_obj[i].role_name + '</br><b>No. of Position:</b> ' + json_obj[i].req_no_position + '</br><b>Batch Code:</b> ' + json_obj[i].job_title + '</br><b>Client:</b>' + json_obj[i].client_name + '</br><b>Process:</b>' + json_obj[i].process_name + '</br><b>Req. Skill:</b> ' + json_obj[i].req_skill));
                $('#sktPleaseWait').modal('hide');
            },
            error: function () {
                alert('Fail!');
            }

        });
    }

    function checkpaycomID() {
        $("#xpoid_status").text("");
        $("#xpoid_status").html(loader);
        var xpoid = $("#xpoid").val();
        var locationValue = $("#xpoid").attr("data-location");        
        var alphanumericRegex = /^[a-zA-Z0-9\-]+$/;
        if (!xpoid.match(alphanumericRegex)) {
            $("#xpoid_status").text("Invalid Paycom ID");
            $("#xpoid_status").focus();
            $('#candidateFinalSelection').prop('disabled',true); 
            return false;
        }
        if (xpoid) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>Requisition/validate_existing_paycomid',
                data: 'xpoid=' + xpoid + '&locationValue=' + locationValue,
                success: function(response) {
                    response = response.trim();
                    if (response == "OK") {
                        $("#xpoid_status").text("");
                        $('#candidateFinalSelection').prop('disabled',false);                       
                    } else {
                        $("#xpoid_status").text(response);
                        $("#xpoid_status").focus();
                        $('#candidateFinalSelection').prop('disabled',true);                       
                        return false;
                    }
                }
            });
        }
    }

    function checkemail(type) {
        var email = $("#" + type + "_email").val();
        $("#" + type + "_email_status").text("");
        var reEmail = /^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/;
        if (!email.match(reEmail)) {
            $("#" + type + "_email_status").text("Invalid email address");
            $("#" + type + "_email_status").focus();
            $("#" + type + "_email_status").addClass('checkrequired');
            return false;
        }
        if (email) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_email',
                data: 'email=' + email,
                success: function (response) {
                    response = response.trim();
                    if (response == "OK") {
                        $("#" + type + "_email_status").text("");
                        $("#" + type + "_email_status").removeClass('checkrequired');
                    } else {
                        $("#" + type + "_email_status").text(response);
                        $("#" + type + "_email_status").focus();
                        $("#" + type + "_email_status").addClass('checkrequired');
                        return false;
                    }
                }
            });
        }
        //  else{
        //   $( '._email_status' ).text("");
        //   return false;
        //  }
    }
    // function checkemail(){
    // 		var email=$(".frmAddCandidate #email").val();

    // 		if(email){
    // 			$.ajax({
    // 			  type: 'POST',
    // 			  url: '<?php echo base_url(); ?>dfr/validate_existest_email',
    // 			  data: 'email='+email,
    // 			  success: function (response){
    // 				   //$('#email_status').html(response);
    // 				   response=response.trim();
    // 				   if(response=="OK"){
    // 		  			$( '#email_status' ).html("");
    // 						//return true;	
    // 				   }else{
    // 				   $('#email_status').html(response);

    // 					//    alert(response);
    // 					//    $(".frmAddCandidate #email").val('');
    // 						//return false;
    // 				   }
    // 			  }
    // 			  });
    // 		 }else{
    // 		  $( '#email_status' ).html("");
    // 		  return false;
    // 		 }
    // }
    function populate_brand_combo_dfr(offid, def = '', objid = 'brand_id', isAll = 'N') {

        var URL = '<?php echo base_url(); ?>user/getBrandList';
        //alert(URL+"?cid="+cid);

        $.ajax({
            type: 'POST',
            url: URL,
            data: 'offid=' + offid,
            success: function (pList) {

                //alert(pList);

                var json_obj = $.parseJSON(pList); //parse JSON

                $('#' + objid)[0].selectize.clearOptions();
                if (json_obj == "") {
                    if (isAll == 'Y') {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "ALL"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    } else {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "NA"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    }


                } else {
                    if (isAll == 'Y') {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "ALL"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    } else {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "-- Select a Process --"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    }


                    for (var i in json_obj) {
                        $('#' + objid)[0].selectize.addOption({
                            value: json_obj[i].id,
                            text: json_obj[i].name
                        });
                        $('#' + objid)[0].selectize.addItem(i);
                    }


                }

                if (isAll == 'Y')
                    $('#' + objid).val("0");
                if (def != "")
                    $('#' + objid).val(def);
                return true;
            },
            error: function () {
                alert('Fail!');
            }
        });
    }

    function checkPostCode(length) {
        var postcode = $("#postcode").val();
        $("#post_status").text("");
        if (postcode.length != length) {
            $("#post_status").text("Please Enter " + length + " Digit Number");
            return false;
        } else {
            $("#post_status").text("");
        }

    }

    function checkphone(length, type) {

        var phone = $("#" + type + "_phone").val();
        $("#" + type + "_phone_status").text("");
        if (phone.length != length) {

            var res = parseInt(phone);
            if (isNaN(res)) {
                $("#" + type + "_phone_status").text("Please Enter Only Number");
                $("#" + type + "_phone_status").addClass('checkrequired');
                return false;
            }
            $("#" + type + "_phone_status").text("Please Enter " + length + " Digit Mobile Number");
            $("#" + type + "_phone_status").addClass('checkrequired');
            return false;
        }
        if (phone) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_phone',
                data: 'phone=' + phone,
                success: function (response) {
                    response = response.trim();
                    //   $('#phone_status').html(response);

                    if (response == "OK") {
                        $("#" + type + "_phone_status").text("");
                        $("#" + type + "_phone_status").removeClass('checkrequired');
                    } else {
                        $("#" + type + "_phone_status").text(response);
                        $("#" + type + "_phone_status").addClass('checkrequired');
                        return false;
                    }
                }
            });
        } else {
            $("#" + type + "_phone_status").text("");
            $("#" + type + "_phone_status").addClass('checkrequired');
            return false;
        }
    }

    function checkonlyphone(type) {

        var phone = $("#" + type + "_phone").val();
        var location = $(".frmAddCandidate #location").val();
        var length;
        if (location == 'ALB') {
            length = 8;
        } else {
            length = 10;
        }
        if (phone.length != length) {

            var res = parseInt(phone);
            if (isNaN(res)) {
                $("#" + type + "_phone_status").text("Please Enter Only Number");
                $("#" + type + "_phone_status").addClass('checkrequired');
                return false;
            }
            $("#" + type + "_phone_status").text("Please Enter " + length + " Digit Mobile Number");
            $("#" + type + "_phone_status").addClass('checkrequired');
            return false;
        }
        if (phone) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_phone',
                data: 'phone=' + phone,
                success: function (response) {
                    response = response.trim();
                    //   $('#phone_status').html(response);

                    if (response == "OK") {
                        $("#" + type + "_phone_status").text("");
                        $("#" + type + "_phone_status").removeClass('checkrequired');
                    } else {
                        $("#" + type + "_phone_status").text(response);
                        $("#" + type + "_phone_status").addClass('checkrequired');
                        return false;
                    }
                }
            });
        } else {
            $("#" + type + "_phone_status").text("");
            $("#" + type + "_phone_status").addClass('checkrequired');
            return false;
        }
    }

    function checkalterphone(length) {

        var phone = $(".frmAddCandidate #alter_phone").val();
        $("#alter_phone_status").text("");
        if (phone.length != length) {

            var res = parseInt(phone);
            if (isNaN(res)) {
                $("#alter_phone_status").text("Please Enter Only Number");
                return false;
            }
            $("#alter_phone_status").text("Please Enter " + length + " Digit Mobile Number");
            return false;
        }
        if (phone) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_phone',
                data: 'phone=' + phone,
                success: function (response) {
                    response = response.trim();
                    //   $('#alter_phone_status').html(response);

                    if (response == "OK") {
                        $('#alter_phone_status').text("");
                        $('#alter_phone_status').removeClass('checkrequired');
                    } else {
                        $('#alter_phone_status').text(response);
                        $('#alter_phone_status').addClass('checkrequired');
                    }
                }
            });
        } else {
            $('#phone_status').html("");
            return false;
        }
    }

    function checkpan() {

        var pan_no = $(".frmfinalSelection #pan_no").val();
        if (pan_no) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_pan',
                data: 'pan_no=' + pan_no,
                success: function (response) {
                    response = response.trim();
                    //   $('#pan_status').html(response);

                    if (response == "OK") {
                        //return true;	
                        $('#pan_status').html('');
                        $('#pan_status').removeClass('checkrequired');
                    } else {
                        //    alert(response);
                        //    $(".frmAddReferrals #pan_no").val('');
                        $('#pan_status').html(response);
                        $('#pan_status').addClass('checkrequired');
                        // return false;
                    }
                }
            });
        } else {
            $('#pan_status').html("");
            $('#pan_status').addClass('checkrequired');
            return false;
        }
    }

    function checkuan() {

        var uan = $(".frmfinalSelection #uan_no").val();
        if (uan) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_uan',
                data: 'uan=' + uan,
                success: function (response) {
                    response = response.trim();
                    //   $('#phone_status').html(response);

                    if (response == "OK") {
                        //return true;	
                        $('#uan_status').html('');
                        $('#uan_status').removeClass('checkrequired');
                    } else {
                        //    alert(response);
                        //    $(".frmAddReferrals #phone").val('');
                        $('#uan_status').html(response);
                        $('#uan_status').addClass('checkrequired');

                        // return false;
                    }
                }
            });
        } else {
            $('#uan_status').html("");
            $('#uan_status').addClass('checkrequired');
            return false;
        }
    }

    function checksecurity() {

        var social_security_no = $(".frmfinalSelection #social_security_no").val();
        if (social_security_no) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_social_security_no',
                data: 'social_security_no=' + social_security_no,
                success: function (response) {
                    response = response.trim();
                    //   $('#phone_status').html(response);

                    if (response == "OK") {
                        //return true;	
                        $('#social_security_no_status').html('');
                        $('#social_security_no_status').removeClass('checkrequired');
                    } else {
                        //    alert(response);
                        //    $(".frmAddReferrals #phone").val('');
                        $('#social_security_no_status').html(response);
                        $('#social_security_no_status').addClass('checkrequired');
                        // return false;
                    }
                }
            });
        } else {
            $('#social_security_no_status').html("");
            $('#social_security_no_status').addClass('checkrequired');
            return false;
        }
    }

    function checksecurity_for_candidate() {

        var social_security_no = $(".frmAddCandidate #social_security_no_for_candidate").val();
        // alert(social_security_no);
        if (social_security_no) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_social_security_no_while_candidate_adding',
                data: 'social_security_no=' + social_security_no,
                success: function (response) {
                    response = response.trim();
                    //   $('#phone_status').html(response);

                    if (response == "OK") {
                        //return true;	
                        $('#social_security_no_status_for_candidate').html('');
                        $('#social_security_no_status_for_candidate').removeClass('checkrequired');
                    } else {
                        //    alert(response);
                        //    $(".frmAddReferrals #phone").val('');
                        $('#social_security_no_status_for_candidate').html(response);
                        $('#social_security_no_status_for_candidate').addClass('checkrequired');
                        // return false;
                    }
                }
            });
        } else {
            $('#social_security_no_status_for_candidate').html("");
            $('#social_security_no_status_for_candidate').addClass('checkrequired');
            return false;
        }
    }

    function checkaccount() {

        var bank_acc_no = $(".frmfinalSelection #bank_acc_no").val();
        if (bank_acc_no) {
            $.ajax({
                type: 'POST',
                url: '<?php echo base_url(); ?>dfr/validate_existest_bank_acc_no',
                data: 'bank_acc_no=' + bank_acc_no,
                success: function (response) {
                    response = response.trim();
                    //   $('#phone_status').html(response);

                    if (response == "OK") {
                        //return true;	
                        $('#bank_acc_no_status').html('');
                        $('#bank_acc_no_status').removeClass('checkrequired');
                    } else {
                        //    alert(response);
                        //    $(".frmAddReferrals #phone").val('');
                        $('#bank_acc_no_status').html(response);
                        $('#bank_acc_no_status').addClass('checkrequired');
                        // return false;
                    }
                }
            });
        } else {
            $('#bank_acc_no_status').html("");
            $('#bank_acc_no_status').addClass('checkrequired');
            return false;
        }
    }

    function populate_process_combo_dfr(cid, def = '', objid = 'process_id', isAll = 'N') {

        var clientid = $('#fclient_id').val();
        var URL = '<?php echo base_url(); ?>dfr/getProcessList';
        //alert(URL+"?cid="+cid);
        $.ajax({
            type: 'POST',
            url: URL,
            data: 'cid=' + clientid,
            success: function (pList) {

                //alert(pList);

                var json_obj = $.parseJSON(pList); //parse JSON

                $('#' + objid)[0].selectize.clearOptions();
				
                if (json_obj == "") {
                    if (isAll == 'Y') {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "ALL"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    } else {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "NA"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    }


                } else {
                    if (isAll == 'Y') {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "ALL"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    } else {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "-- Select a Process --"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    }


                    for (var i in json_obj) {
                        $('#' + objid)[0].selectize.addOption({
                            value: json_obj[i].id,
                            text: json_obj[i].name
                        });
                        $('#' + objid)[0].selectize.addItem(i);
                    }


                }

                if (isAll == 'Y')
                    $('#' + objid).val("0");
                if (def != "")
                    $('#' + objid).val(def);
                return true;
            },
            error: function () {
                alert('Fail!');
            }
        });
    }

    function populate_process_combo(cid, def = '', objid = 'process_id', isAll = 'N') {
        $('#sktPleaseWait').modal('show');
        var URL = '<?php echo base_url(); ?>dfr/getProcessList';
        //alert(URL+"?cid="+cid);
        $.ajax({
            type: 'POST',
            url: URL,
            data: 'cid=' + cid,
            success: function (pList) {
                $('#sktPleaseWait').modal('hide');
                //alert(pList);

                var json_obj = $.parseJSON(pList); //parse JSON

                $('#' + objid)[0].selectize.clearOptions();
                $('#' + objid)[0].selectize.loadedSearches = {};
                if (json_obj == "") {
                    if (isAll == 'Y') {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "ALL"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    } else {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "NA"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    }


                } else {
                    if (isAll == 'Y') {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "ALL"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    } else {
                        $('#' + objid)[0].selectize.addOption({
                            value: "",
                            text: "-- Select a Process --"
                        });
                        $('#' + objid)[0].selectize.addItem(1);
                    }


                    for (var i in json_obj) {
                        $('#' + objid)[0].selectize.addOption({
                            value: json_obj[i].id,
                            text: json_obj[i].name
                        });
                        $('#' + objid)[0].selectize.addItem(i);
                    }


                }

                if (isAll == 'Y')
                    $('#' + objid).val("0");
                if (def != "")
                    $('#' + objid).val(def);
                return true;
            },
            error: function () {
                alert('Fail!');
            }
        });
    }

    function populate_process_simple(cid, def = '', objid = 'process_id', isAll = 'N') {
        $('#sktPleaseWait').modal('show');
        var URL = '<?php echo base_url(); ?>dfr/getProcessList';
        //alert(URL+"?cid="+cid);
        console.log(1);
        $.ajax({
            type: 'POST',
            url: URL,
            data: 'cid=' + cid,
            success: function (pList) {
                $('#sktPleaseWait').modal('hide');
                //alert(pList);

                var json_obj = $.parseJSON(pList); //parse JSON
                $('#' + objid).empty();
                $('#' + objid).append($('#' + objid).val(''));
                $('#' + objid).append($('<option></option>').val('').html('--Select--'));
                for (var i in json_obj) {
                    $('#' + objid).append($('<option></option>').val(json_obj[i].id).html(json_obj[i].name + '-' + json_obj[i].fusion_id + '-' + json_obj[i].dept_name + '-' + json_obj[i].role_name));
                }

            },
            error: function () {
                alert('Fail!');
            }
        });
    }
</script>
<!--  js added by nask....-->
<script>
    $("#multiselectwithsearch").change(function () {
        var sitedata = '<option value="" selected disable >Select Site</option>';
        $(".site_search").html(sitedata);
        var offid = $("#multiselectwithsearch").val();
        //   if(offid=="") alert("--Select--");
        // $('#sktPleaseWait').modal('show');
        var URL = '<?php echo base_url(); ?>dfr/get_cha_sitelist';
        // alert(URL);
        $.ajax({
            type: 'POST',
            url: URL,
            data: 'offid=' + offid,
            success: function (data) {

                var sts = JSON.parse(data);
                $(".site_search").empty();
                var sitedata = '<option value="" selected disable >Select Site</option>';
                $.each(sts, function (index, jsonObject) {
                    sitedata += '<option value="' + jsonObject.id + '">' + jsonObject.name + '</option>';
                    //  $(".site_search").html('<option value="'+jsonObject.id+'">' + jsonObject.name + '</option>');
                });
                $(".site_search").html(sitedata);
            },
            error: function () {
                alert('Fail!');
            }


        });
    });
    $(document).ready(function () {

        $('#experience_exp').change(function () {
            if ($('#experience_exp').is(':checked') && $(this).val() == 'Experienced') {
                $('#total_experience').css('display', 'block');
            }
        });
        $('#experience_fresh').change(function () {
            if ($('#experience_fresh').is(':checked') && $(this).val() == 'Fresher') {
                $('#total_experience').css('display', 'none');
            }
        });
        $("input[type='radio'][name='interest']").click(function () {
            var value = $(this).val();
            if (value == 'Other') {
                $('#interest_type').css('display', 'block');
            } else {
                $('#interest_type').css('display', 'none');
            }
        });






        $(".employee_assets_dfr").click(function () {
            var c_id = $(this).attr("c_id");
            var request_url = "<?php echo base_url('Dfr/dfr_assets_assigned'); ?>";
            $.post(request_url, {
                c_id: c_id
            }).done(function (response) {
                var res = JSON.parse(response);
                if (res.stat == true) {
                    let string = "";
                    string += '<div class="col-md-12">\
                            <div class="form-group">\
                                <label>Assigned Assets</label>\
                            </div>\
                        </div> ';
                    $.each(res.datas, function (r) {
                        string += '<div class="col-md-4">\
                                <div class="form-group">\
                                    <button type="button"  class="btn btn-sm success assets">' + res.datas[r].name + '</button>\
                                </div>\
                            </div>';
                    });
                    $(".dfr_assets_assigned").html(string);
                } else {
                    string += '<div class="col-md-4">\
                                <div class="form-group">\
                                    <button type="button"  class="btn btn-sm success assets">No Assetes Assigned</button>\
                                </div>\
                            </div>';
                    $(".dfr_assets_assigned").html(string);
                }


            });
            $('#employee_assets_model_dfr').modal('show');
        });



    });

</script>
<script>


    function check_size(id) {
        var size = id.files[0].size;
        if (size > 2000010) {
            alert('File Size Exceed 2 MB');
            $(id).val('');
        }
    }

    function get_stipend_data(ctc = '') {

        let gr_amt = $('#gross_amount').val();

        let indLocation = "<?= isIndiaLocation(get_user_office_id()) ?>";

        if ($("#is_loi").is(":checked")) {
            if (indLocation == true) {
                lblHtml = '<i class="fa fa-asterisk" style="font-size:6px; color:red"></i> &nbsp; Training date (dd/mm/yyyy)';
            } else {
                lblHtml = '<i class="fa fa-asterisk" style="font-size:6px; color:red"></i> &nbsp; Training date (mm/dd/yyyy)';
            }
            $(".loi_lbl").html(lblHtml);
            let percent = "<?= get_agent_stipend_percentage() ?>";
            if (ctc != '' && ctc > 0) {
                let total_stipned = Math.round((percent * ctc) / 100);
                let per_day_stipned = Math.round(total_stipned / 30);
                $("#training_fees_perday").val(per_day_stipned);
                $("#training_ctc").val(total_stipned);
            }
            $("#perday_lbl").html(`${percent} % CTC`);
            $("#training_fees_perday").attr('disabled', true);
            $("#training_ctc").attr('disabled', true);
            $(".perday").css('display', 'block');
            $("#is_loi").val(1);
            $('#calcKOL').hide();
        } else {
            if (indLocation == true) {
                lblHtml = '<i class="fa fa-asterisk" style="font-size:6px; color:red"></i> &nbsp; Date of Joining (dd/mm/yyyy)';
            } else {
                lblHtml = '<i class="fa fa-asterisk" style="font-size:6px; color:red"></i> &nbsp; Date of Joining (mm/dd/yyyy)';
            }

            $(".loi_lbl").html(lblHtml);
            $(".perday").css('display', 'none');
            $("#training_fees_perday").val('0.00');
            $("#training_ctc").val('0.00');
            $("#is_loi").val(0);
            if (gr_amt >= 1000) {
                $('#calcKOL').show();
            }
        }

        return true;
    }


    function dependent_requisition(transfer_location, site, department) {
        //alert();
        var URL = '<?php echo base_url(); ?>dfr/getRequisitionByLocationAndSite';
        // $('#sktPleaseWait').modal('show');
        $.ajax({
            type: 'POST',
            url: URL,
            data: 'did=' + department + '&location=' + transfer_location + '&site_id=' + site,
            //    data:'pid='+pid,
            success: function (pList) {
                console.log(pList);
                var json_obj = $.parseJSON(pList); //parse JSON
                // console.log(json_obj);
                // $('#req_id').empty();
                //$('#req_id').append($('<option></option>').val('').html(' Select Requisition '));

                //for (var i in json_obj) $('#req_id').append($('<option></option>').val(json_obj[i].id).html(json_obj[i].req_desc));
                $('#sktPleaseWait').modal('hide');
                // $('#req_id')[0].selectize.clearOptions();
                // $('#req_id')[0].selectize.addOption({value:"",text:"Select Requisition"});
                // $('#req_id')[0].selectize.addItem(1);

                // for (var i in json_obj){
                // 	$('#req_id')[0].selectize.addOption({value:json_obj[i].id,text:json_obj[i].req_desc});
                // 	$('#req_id')[0].selectize.addItem(i);
                // }

                // $('#sktPleaseWait').modal('hide');	
            },
            error: function () {
                alert('Fail!');
            }

        });
    }


    // $('#uploadFile_1').change(function () {    
    //     //var ext = this.value.match(/\.(.+)$/)[1];
    //     var fileName = $(this).val();
    //     const fileSize = this.files[0].size / 1024 / 1024; // in MiB
    //     if (fileSize > 5) {
    //         alert('File size exceeds 5 MB');
    //         this.value = '';
    //     }
    //       else {
    //         var ext = fileName.substring(fileName.lastIndexOf(".") + 1, fileName.length);
    //         ext = ext.toLowerCase();
    //         switch (ext) {
    //             case 'pdf':
    //                 break;
    //             default:
    //                 alert('This is not an allowed file type.');
    //                 this.value = '';
    //         }
    //     }
    // });

    // $('#uploadFile_2').change(function () {    
    //     //var ext = this.value.match(/\.(.+)$/)[1];
    //     var fileName = $(this).val();
    //     const fileSize = this.files[0].size / 1024 / 1024; // in MiB
    //     if (fileSize > 5) {
    //         alert('File size exceeds 5 MB');
    //         this.value = '';
    //     }
    //       else {
    //         var ext = fileName.substring(fileName.lastIndexOf(".") + 1, fileName.length);
    //         ext = ext.toLowerCase();
    //         switch (ext) {
    //             case 'pdf':
    //                 break;
    //             default:
    //                 alert('This is not an allowed file type.');
    //                 this.value = '';
    //         }
    //     }
    // });


    $('.frmSendBasicLink').submit(function () {

        var error = 0;

        if (error) {
            return false;
        } else {
            dt = 1;
            if ($('.checkrequired').length > 0) {

                $(".frmSendBasicLink .checkrequired").each(function () {
                    if ($(this).text() != '')
                        console.log($(this).text());
                });
                dt = 0;
                //return false;
            }
            var ans = confirm('Are you sure to send link to this Candidate ?');
            $(".frmSendBasicLink input[required]").each(function () {
                if ($(this).val() == '')
                    dt = 0;
            });
            $(".frmSendBasicLink select[required]").each(function () {
                if ($(this).val() == "")
                    dt = 0
            });

            if (dt == 1) {
                $("#SendBasicLinkModel").modal('hide');
                return ans;
            } else {
                alert("please fill up all mandatory fields");
            }
        }

    });

</script>


