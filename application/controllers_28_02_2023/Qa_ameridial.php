<?php

 class Qa_ameridial extends CI_Controller{

	public function __construct(){
		parent::__construct();
		$this->load->model('user_model');
		$this->load->model('Common_model');
		$this->load->model('CreateTable_model');
	}

//////////////////////////////////////
	public function getTLname(){
		if(check_logged_in()){
			$aid=$this->input->post('aid');
			$qSql = "Select id, assigned_to, fusion_id, get_process_names(id) as process_name, office_id, (select concat(fname, ' ', lname) from signin tl where tl.id=signin.assigned_to) as tl_name FROM signin where id = '$aid'";
			echo json_encode($this->Common_model->get_query_result_array($qSql));
		}
	}

	public function createPath($path){

		if (!empty($path)) {

	    	if(!file_exists($path)){

	    		$mainPath="./";
	    		$checkPath=str_replace($mainPath,'', $path);
	    		$checkPath=explode("/",$checkPath);
	    		$cnt=count($checkPath);
	    		for($i=0;$i<$cnt;$i++){

		    		$mainPath.=$checkPath[$i].'/';
		    		if (!file_exists($mainPath)) {
		    			$oldmask = umask(0);
						$mkdir=mkdir($mainPath, 0777);
						umask($oldmask);

						if ($mkdir) {
							return true;
						}else{
							return false;
						}
		    		}

	    		}

    		}else{
    			return true;
    		}
    	}


	}


	private function amd_upload_files($files,$path)
    {
    	$result=$this->createPath($path);
    	if($result){
        $config['upload_path'] = $path;
		$config['allowed_types'] = '*';
		//$config['detect_mime'] = FALSE;
		$config['max_size'] = '2024000';
		$this->load->library('upload', $config);
		$this->upload->initialize($config);
        $images = array();
        foreach ($files['name'] as $key => $image) {
			$_FILES['uFiles']['name']= $files['name'][$key];
			$_FILES['uFiles']['type']= $files['type'][$key];
			$_FILES['uFiles']['tmp_name']= $files['tmp_name'][$key];
			$_FILES['uFiles']['error']= $files['error'][$key];
			$_FILES['uFiles']['size']= $files['size'][$key];

            if ($this->upload->do_upload('uFiles')) {
				$info = $this->upload->data();
				$ext = $info['file_ext'];
				$file_path = $info['file_path'];
				$full_path = $info['full_path'];
				$file_name = $info['file_name'];
				if(strtolower($ext)== '.wav'){

					$file_name = str_replace(".","_",$file_name).".mp3";
					$new_path = $file_path.$file_name;
					$comdFile=FCPATH."assets/script/wavtomp3.sh '$full_path' '$new_path'";
					$output = shell_exec( $comdFile);
					sleep(2);
				}
				$images[] = $file_name;
            }else{
                return false;
            }
        }
        return $images;
    	}
    }

    private function edu_upload_files($files,$path)
    {
        $config['upload_path'] = $path;
		$config['allowed_types'] = '*';
		$config['max_size'] = '2024000';
		$this->load->library('upload', $config);
		$this->upload->initialize($config);
        $images = array();
        foreach ($files['name'] as $key => $image) {
			$_FILES['uFiles']['name']= $files['name'][$key];
			$_FILES['uFiles']['type']= $files['type'][$key];
			$_FILES['uFiles']['tmp_name']= $files['tmp_name'][$key];
			$_FILES['uFiles']['error']= $files['error'][$key];
			$_FILES['uFiles']['size']= $files['size'][$key];

            if ($this->upload->do_upload('uFiles')) {
				$info = $this->upload->data();
				$ext = $info['file_ext'];
				$file_path = $info['file_path'];
				$full_path = $info['full_path'];
				$file_name = $info['file_name'];
				if(strtolower($ext)== '.wav'){

					$file_name = str_replace(".","_",$file_name).".mp3";
					$new_path = $file_path.$file_name;
					$comdFile=FCPATH."assets/script/wavtomp3.sh '$full_path' '$new_path'";
					$output = shell_exec( $comdFile);
					sleep(2);
				}

				$images[] = $file_name;


            } else {
                return false;
            }
        }
        return $images;
    }

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Fortune Builder (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function index(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/fortune_builder/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_fortunebuilder_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)  $ops_cond order by audit_date";
			$data["fobi_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_fobi(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/fortune_builder/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"callans5sec" => $this->input->post('callans5sec'),
					"agentintro" => $this->input->post('agentintro'),
					"agentadvise" => $this->input->post('agentadvise'),
					"agentgreeting" => $this->input->post('agentgreeting'),
					"agentzip" => $this->input->post('agentzip'),
					"verifycaller" => $this->input->post('verifycaller'),
					"calleremail" => $this->input->post('calleremail'),
					"agentseminar" => $this->input->post('agentseminar'),
					"agentphone" => $this->input->post('agentphone'),
					"callerreminder" => $this->input->post('callerreminder'),
					"agentsummerize" => $this->input->post('agentsummerize'),
					"registerguest" => $this->input->post('registerguest'),
					"verifyguest" => $this->input->post('verifyguest'),
					"agentdemonstrate" => $this->input->post('agentdemonstrate'),
					"appropiategrammer" => $this->input->post('appropiategrammer'),
					"goodpacing" => $this->input->post('goodpacing'),
					"agentdisplay" => $this->input->post('agentdisplay'),
					"callcontrol" => $this->input->post('callcontrol'),
					"agentclosing" => $this->input->post('agentclosing'),
					"correctdisposition" => $this->input->post('correctdisposition'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/fortune_builder/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_fortunebuilder_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_fortunebuilder_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_fobi_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/fortune_builder/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_amd_fortunebuilder_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["fobi_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;

			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"callans5sec" => $this->input->post('callans5sec'),
					"agentintro" => $this->input->post('agentintro'),
					"agentadvise" => $this->input->post('agentadvise'),
					"agentgreeting" => $this->input->post('agentgreeting'),
					"agentzip" => $this->input->post('agentzip'),
					"verifycaller" => $this->input->post('verifycaller'),
					"calleremail" => $this->input->post('calleremail'),
					"agentseminar" => $this->input->post('agentseminar'),
					"agentphone" => $this->input->post('agentphone'),
					"callerreminder" => $this->input->post('callerreminder'),
					"agentsummerize" => $this->input->post('agentsummerize'),
					"registerguest" => $this->input->post('registerguest'),
					"verifyguest" => $this->input->post('verifyguest'),
					"agentdemonstrate" => $this->input->post('agentdemonstrate'),
					"appropiategrammer" => $this->input->post('appropiategrammer'),
					"goodpacing" => $this->input->post('goodpacing'),
					"agentdisplay" => $this->input->post('agentdisplay'),
					"callcontrol" => $this->input->post('callcontrol'),
					"agentclosing" => $this->input->post('agentclosing'),
					"correctdisposition" => $this->input->post('correctdisposition'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_fortunebuilder_feedback',$field_array);

			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_fortunebuilder_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Fortune Builder (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Ways2well (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function ways2well(){
		if(check_logged_in())
		{			
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ways2well/qa_ways2well_feedback.php";
			$data["content_js"] = "qa_ameridial_js.php";
			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
			
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond="";
			
			if($from_date==""){ 
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}
			
			if($to_date==""){ 
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}
			
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			
			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}
			
			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_ways2well_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["homeward_data"] = $this->Common_model->get_query_result_array($qSql);
			
			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			
			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_ways2well($homeward_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ways2well/add_edit_ways2well.php";
			$data["content_js"] = "qa_ameridial_js.php";
			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133)  and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
			
			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);
			
			$data['homeward_id']=$homeward_id;
			
			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_ways2well_feedback where id='$homeward_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["homeward_health"] = $this->Common_model->get_query_row_array($qSql);
			
			$curDateTime=CurrMySqlDate();
			$a = array();
			
			if($this->input->post('agent_id')){
				$field_array=array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"call_id" => $this->input->post('call_id'),
					"campaign" => $this->input->post('campaign'),
					"phone_number" => $this->input->post('phone_number'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"custSenEarned" => $this->input->post('custSenEarned'),
					"busiSenEarned" => $this->input->post('busiSenEarned'),
					"complSenEarned" => $this->input->post('complSenEarned'),
					"custSenPossible" => $this->input->post('custSenPossible'),
					"busiSenPossible" => $this->input->post('busiSenPossible'),
					"complSenPossible" => $this->input->post('complSenPossible'),
					"overall_score" => $this->input->post('overall_score'),
					"customer_score" => $this->input->post('customer_score'),
					"business_score" => $this->input->post('business_score'),
					"compliance_score" => $this->input->post('compliance_score'),

					"call_opening" => $this->input->post('call_opening'),
					"confirm_first_name" => $this->input->post('confirm_first_name'),
					"appropriate_scripting" => $this->input->post('appropriate_scripting'),
					"greetings_inbound" => $this->input->post('greetings_inbound'),
					"active_listening" => $this->input->post('active_listening'),
					"positive_tone" => $this->input->post('positive_tone'),
					"positive_language" => $this->input->post('positive_language'),
					"effective_time" => $this->input->post('effective_time'),
					"pace_speech" => $this->input->post('pace_speech'),
					"effective_management" => $this->input->post('effective_management'),
					"address_caller" => $this->input->post('address_caller'),
					"interrupt_caller" => $this->input->post('interrupt_caller'),
					"correct_retension" => $this->input->post('correct_retension'),
					"probing_questions" => $this->input->post('probing_questions'),
					"hold_policy" => $this->input->post('hold_policy'),
					"dead_air" => $this->input->post('dead_air'),
					"hold_verbiage" => $this->input->post('hold_verbiage'),
					"accomplish_resolution" => $this->input->post('accomplish_resolution'),
					"followup_steps" => $this->input->post('followup_steps'),
					"answered_caller" => $this->input->post('answered_caller'),
					"policies_procedures" => $this->input->post('policies_procedures'),
					"offers_telephone" => $this->input->post('offers_telephone'),
					// "verify_members" => $this->input->post('verify_members'),
					"additional_assistance" => $this->input->post('additional_assistance'),
					"thanks_member" => $this->input->post('thanks_member'),
					"call_documentated" => $this->input->post('call_documentated'),
					"unprofessionalism" => $this->input->post('unprofessionalism'),
					"critical_error" => $this->input->post('critical_error'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					// "cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"cmt25" => $this->input->post('cmt25'),
					"cmt26" => $this->input->post('cmt26'),
					"cmt27" => $this->input->post('cmt27'),
					"cmt28" => $this->input->post('cmt28'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
				);
			
				if($homeward_id==0){
					
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/ways2well/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_ways2well_feedback',$field_array);
					/////////
					$field_array2 = array(
						"audit_date" => CurrDate(),
						"audit_start_time" => $this->input->post('audit_start_time')
					);
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_ways2well_feedback',$field_array2);
					///////////
					if(get_login_type()=="client"){
						$field_array1 = array("client_entryby" => $current_user);
					}else{
						$field_array1 = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_ways2well_feedback',$field_array1);
					/*******************Fatal Call Email Send functionality added on 12-12-22 START ***********************/
					if($field_array['overall_score'] == 0){
						$tablename = "qa_amd_ways2well_feedback";
						$sql = "SELECT tname.*, ip.email_id_off, ip_tl.email_id_off as tl_email, concat(s.fname, ' ', s.lname) as fullname,
							(SELECT concat(tls.fname, ' ', tls.lname) as tl_fullname FROM signin tls WHERE tls.id=tname.tl_id) as tl_fullname
							FROM $tablename tname
							LEFT JOIN info_personal ip ON ip.user_id=tname.agent_id 
							LEFT JOIN signin s ON s.id=tname.agent_id
							LEFT JOIN signin tl ON tl.id = tname.tl_id
							LEFT JOIN info_personal ip_tl ON ip_tl.user_id = tname.tl_id
							WHERE tname.id=$rowid";
						$result= $this->Common_model->get_query_row_array($sql);				
						$sqlParam ="SELECT process_id,params_columns, fatal_param,param_column_desc FROM qa_defect where table_name='$tablename'"; 
						$resultParams = $this->Common_model->get_query_row_array($sqlParam);
						
						$process = floor($resultParams['process_id']);
						$sqlProcess ="SELECT name FROM process where id='$process'"; 
						$resultProcess = $this->Common_model->get_query_row_array($sqlProcess);
						
						$params = explode(",", $resultParams['params_columns']);
						$fatal_params = explode(",", $resultParams['fatal_param']);
						$descArr = explode(",", $resultParams['param_column_desc']);
						
						$msgTable = "<Table BORDER=1>";
						$msgTable .= "<TR><TH>SL.</TH> <TH>CALL AUDIT PARAMETERS</TH><TH>QA Rating</TH> <TH>QA Remarks</TH></TR>";
						
						$i=1;
						$j=0;
						foreach($params as $par){
							//echo $str = str_replace('_', ' ', $par)."<BR>";
							if($result[$par]=='No'){
								$msgTable .= "<TR><TD>".$i."</TD><TD>".$descArr[$j] ."</TD> <TD>".$result[$par]."</TD><TD>".$result['cmt'.$i]."</TD></TR>";
							}else{
								$msgTable .= "<TR><TD>".$i."</TD><TD>". $descArr[$j]."</TD> <TD>".$result[$par]."</TD><TD>".$result['cmt'.$i]."</TD></TR>";
							}
							$i++;
							$j++;
						}
						///////////////////////////
						//$j=1;
						/* if(!empty($fatal_params)){
							
							foreach($fatal_params as $fatal_par){
								if(!empty($fatal_par)){
								$msgTable .= "<TR><TD>".$i."</TD><TD style='color:#FF0000'>".$descArr[($j-23)]."</TD> <TD>".$result[$fatal_par]."</TD><TD>".$result['cmt'.($i-24)]."</TD></TR>";
								$i++;
								$j++;
								}
							} 
						} */
						$msgTable .= "<TR><TD colspan='3'>Customer Score</TD> <TD>".$result['customer_score']."%</TD></TR>";
						$msgTable .= "<TR><TD colspan='3'>Business Score</TD> <TD>".$result['business_score']."%</TD></TR>";
						$msgTable .= "<TR><TD colspan='3'>Compliance Score</TD> <TD>".$result['compliance_score']."%</TD></TR>";
						
						$msgTable .= "<TR><TD colspan='3'>Overall Score</TD> <TD>".$result['overall_score']."%</TD></TR>";
						
						
						$msgTable .= "</Table>";
						
						$eccA=array();
						//$to = $result['tl_email']; // Have to open when email will trigger to the Respective TL of the Agent
						$to = 'lukas.piercy@fusionbposervices.com,sarah.wolf@fusionbposervices.com,tina.church@fusionbposervices.com,amitabh.vartak@fusionbposervices.com,ashish.tere@fusionbposervices.com,Faisal.Anwar@fusionbposervices.com';
						
						$ebody = "Hello ". $result['tl_fullname'].",<br>";
						$ebody .= "<p>Agent Name : ".$result['fullname']."</p>";
						$ebody .= "<p>Call ID :  ".$result['call_id']."</p>";
						$ebody .= "<p>Total Talk time : ".$result['call_duration']."</p>";
						$ebody .= "<p>Audit Date time : ".ConvServerToLocal($result['entry_date'])."</p>";
						$ebody .= "<p>Call Summary : ".$result['call_summary']."</p>";
						$ebody .= "<p>Feedback : ".$result['feedback']."</p><br><br>";
						$ebody .= "<p>Please listen the call from the MWP Tool and share feedback acceptancy :</p>";
						$ebody .=  $msgTable;
						$ebody .= "<p>Regards,</p>";
						$ebody .= "<p>MWP Team</p>";
						$esubject = "Fatal Call Alert - "." For Process - ".$resultProcess['name'].", Agent Name - ".$result['fullname']." Audit Date - ".$result['audit_date'];
						
						//echo $ebody;
						//exit;
					
						$eccA[]="Bompalli.Somasundaram@omindtech.com";
						$eccA[]="deb.dasgupta@omindtech.com";
						$eccA[]="danish.khan@fusionbposervices.com";
						$eccA[]="sumitra.bagchi@omindtech.com";
						$eccA[]="anshuman.sarkar@fusionbposervices.com";
						
						$ecc = implode(',',$eccA);
						$path = "";
						$from_email="";
						$from_name="";
						
						/* echo $esubject."<br>";
						echo $ebody."<br>";
						exit; */
						
						$send = $this->Email_model->send_email_sox("",$to, $ecc, $ebody, $esubject, $path, $from_email, $from_name, $isBcc="Y");
						unset($eccA);
					}
					
					
					/*******************Fatal Call Email Send functionality added on 12-12-22 END ***********************/
				}else{
					
					$this->db->where('id', $homeward_id);
					$this->db->update('qa_amd_ways2well_feedback',$field_array);
					//////////
					if(get_login_type()=="client"){
						$field_array1 = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$field_array1 = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $homeward_id);
					$this->db->update('qa_amd_ways2well_feedback',$field_array1);
					
				}
				redirect('Qa_ameridial/ways2well');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Ways2well (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	

/********************************************************/
/**********Homeward Health  START*********************/
/********************************************************/
	public function qa_homeward_health(){
		if(check_logged_in())
		{			
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qa_homeward_health/qa_homeward_health_feedback.php";
			$data["content_js"] = "qa_ameridial_js.php";
			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and status=1  order by name";

			// $qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and is_assign_process (id,754) and status=1  order by name";

			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
			
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond="";
			
			if($from_date==""){ 
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}
			
			if($to_date==""){ 
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}
			
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			
			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}
			
			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_homeward_health_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["homeward_data"] = $this->Common_model->get_query_result_array($qSql);
			
			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			
			$this->load->view("dashboard",$data);
		}
	}

	///////////////////////////////////////////////////////////////////	
	public function add_edit_homeward_health($homeward_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qa_homeward_health/add_edit_homeward_health.php";
			$data["content_js"] = "qa_ameridial_js.php";
			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133)  and status=1  order by name";
			//and is_assign_process (id,754)
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
			
			$qSql = "SELECT * FROM signin where id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);
			
			$data['homeward_id']=$homeward_id;
			
			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_homeward_health_feedback where id='$homeward_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["homeward_health"] = $this->Common_model->get_query_row_array($qSql);
			
			$curDateTime=CurrMySqlDate();
			$a = array();
			
			if($this->input->post('agent_id')){
				$field_array=array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"call_id" => $this->input->post('call_id'),
					"campaign" => $this->input->post('campaign'),
					"phone_number" => $this->input->post('phone_number'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"custSenEarned" => $this->input->post('custSenEarned'),
					"busiSenEarned" => $this->input->post('busiSenEarned'),
					"complSenEarned" => $this->input->post('complSenEarned'),
					"custSenPossible" => $this->input->post('custSenPossible'),
					"busiSenPossible" => $this->input->post('busiSenPossible'),
					"complSenPossible" => $this->input->post('complSenPossible'),
					"overall_score" => $this->input->post('overall_score'),
					"customer_score" => $this->input->post('customer_score'),
					"business_score" => $this->input->post('business_score'),
					"compliance_score" => $this->input->post('compliance_score'),

					"call_opening" => $this->input->post('call_opening'),
					"confirm_first_name" => $this->input->post('confirm_first_name'),
					"appropriate_scripting" => $this->input->post('appropriate_scripting'),
					"greetings_inbound" => $this->input->post('greetings_inbound'),
					"active_listening" => $this->input->post('active_listening'),
					"positive_tone" => $this->input->post('positive_tone'),
					"positive_language" => $this->input->post('positive_language'),
					"effective_time" => $this->input->post('effective_time'),
					"pace_speech" => $this->input->post('pace_speech'),
					"effective_management" => $this->input->post('effective_management'),
					"address_caller" => $this->input->post('address_caller'),
					"interrupt_caller" => $this->input->post('interrupt_caller'),
					"correct_retension" => $this->input->post('correct_retension'),
					"probing_questions" => $this->input->post('probing_questions'),
					"hold_policy" => $this->input->post('hold_policy'),
					"dead_air" => $this->input->post('dead_air'),
					"hold_verbiage" => $this->input->post('hold_verbiage'),
					"accomplish_resolution" => $this->input->post('accomplish_resolution'),
					"followup_steps" => $this->input->post('followup_steps'),
					"answered_caller" => $this->input->post('answered_caller'),
					"policies_procedures" => $this->input->post('policies_procedures'),
					"offers_telephone" => $this->input->post('offers_telephone'),
					"verify_members" => $this->input->post('verify_members'),
					"additional_assistance" => $this->input->post('additional_assistance'),
					"thanks_member" => $this->input->post('thanks_member'),
					"call_documentated" => $this->input->post('call_documentated'),
					"unprofessionalism" => $this->input->post('unprofessionalism'),
					"critical_error" => $this->input->post('critical_error'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"cmt25" => $this->input->post('cmt25'),
					"cmt26" => $this->input->post('cmt26'),
					"cmt27" => $this->input->post('cmt27'),
					"cmt28" => $this->input->post('cmt28'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
				);
				
				// echo"<pre>";
				// print_r($field_array);
				// echo"</pre>";
			
				if($homeward_id==0){
					
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_homeward_health/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_homeward_health_feedback',$field_array);
					/////////
					$field_array2 = array(
						"audit_date" => CurrDate(),
						"audit_start_time" => $this->input->post('audit_start_time')
					);
					$this->db->where('id', $rowid);
					$this->db->update('qa_homeward_health_feedback',$field_array2);
					///////////
					if(get_login_type()=="client"){
						$field_array1 = array("client_entryby" => $current_user);
					}else{
						$field_array1 = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_homeward_health_feedback',$field_array1);
					
				}else{
					
					$this->db->where('id', $homeward_id);
					$this->db->update('qa_homeward_health_feedback',$field_array);
					//////////
					if(get_login_type()=="client"){
						$field_array1 = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$field_array1 = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $homeward_id);
					$this->db->update('qa_homeward_health_feedback',$field_array1);
					
				}
				//exit;
				redirect('Qa_ameridial/qa_homeward_health');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

	//////////////////////////////////////////////////////////////////////////////////////////////////////

	public function agent_homeward_feedback(){
		if(check_logged_in())
		{
			$user_site_id= get_user_site_id();
			$role_id= get_role_id();
			$current_user = get_user_id();
			
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qa_homeward_health/agent_homeward_feedback.php";
			$data["content_js"] = "qa_ameridial_js.php";
			$data["agentUrl"] = "qa_ameridial/agent_homeward_feedback";

			//$data["agentUrl"] = "qa_sensio/agent_sensio_feedback";
			
			$qSql="Select count(id) as value from qa_homeward_health_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit')";
			$data["tot_feedback"] =  $this->Common_model->get_single_value($qSql);
			$qSql="Select count(id) as value from qa_homeward_health_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit') and agent_rvw_date is Null";
			$data["yet_rvw"] =  $this->Common_model->get_single_value($qSql);
				
			$from_date = '';
			$to_date = '';
			$cond="";
			
			
			if($this->input->get('btnView')=='View')
			{
				$from_date = mmddyy2mysql($this->input->get('from_date'));
				$to_date = mmddyy2mysql($this->input->get('to_date'));
				
				if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
				
				$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_homeward_health_feedback $cond and agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit')) xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid)";
				$data["agent_rvw_list"] = $this->Common_model->get_query_result_array($qSql);
					
			}else{
	
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_homeward_health_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit')) xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) Where xx.agent_rvw_date is Null";
				$data["agent_rvw_list"] = $this->Common_model->get_query_result_array($qSql);
	
			}
			
			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$this->load->view('dashboard',$data);
		}
	}
	
	
	public function agent_homeward_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qa_homeward_health/agent_homeward_rvw.php";
			$data["content_js"] = "qa_ameridial_js.php";
			$data["agentUrl"] = "qa_ameridial/agent_homeward_feedback";
			
			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_homeward_health_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid)";
			$data["homeward_health"] = $this->Common_model->get_query_row_array($qSql);
			
			$data["pnid"]=$id;
			
			if($this->input->post('pnid'))
			{
				$pnid=$this->input->post('pnid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();
					
				$field_array1=array(
					"agnt_fd_acpt" => $this->input->post('agnt_fd_acpt'),
					"agent_rvw_note" => $this->input->post('note'),
					"agent_rvw_date" => $curDateTime
				);
				$this->db->where('id', $pnid);
				$this->db->update('qa_homeward_health_feedback',$field_array1);
					
				redirect('qa_ameridial/agent_homeward_feedback');
				
			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}


/********************************************************/
/**********Homeward Health  END*********************/
/********************************************************/

/********************************************************/
/**********kenny u pull START*********************/
/********************************************************/

public function qa_kenny_u_pull(){
	if(check_logged_in())
	{			
		$current_user = get_user_id();
		$data["aside_template"] = "qa/aside.php";
		$data["content_template"] = "qa_ameridial/qa_kenny_u_pull/qa_kenny_u_pull_feedback.php";
		$data["content_js"] = "qa_ameridial_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		
		$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,360) and status=1  order by name";
		//and is_assign_process (id,756)
		$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
		
		$from_date = $this->input->get('from_date');
		$to_date = $this->input->get('to_date');
		$agent_id = $this->input->get('agent_id');
		$cond="";
		
		if($from_date==""){ 
			$from_date=CurrDate();
		}else{
			$from_date = mmddyy2mysql($from_date);
		}
		
		if($to_date==""){ 
			$to_date=CurrDate();
		}else{
			$to_date = mmddyy2mysql($to_date);
		}
		
		if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
		if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
		
		if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
			$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
		}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
			$ops_cond=" Where assigned_to='$current_user'";
		}else{
			$ops_cond="";
		}
		
		$qSql = "SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_kenny_u_pull_feedback $cond) xx Left Join
			(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
		$data["kenny_data"] = $this->Common_model->get_query_result_array($qSql);
		
		$data["from_date"] = $from_date;
		$data["to_date"] = $to_date;
		$data["agent_id"] = $agent_id;
		
		$this->load->view("dashboard",$data);
	}
}

public function add_edit_kenny_u_pull($kenny_id){
	if(check_logged_in())
	{
		$current_user=get_user_id();
		$user_office_id=get_user_office_id();
		
		$data["aside_template"] = "qa/aside.php";
		$data["content_template"] = "qa_ameridial/qa_kenny_u_pull/add_edit_kenny_u_pull.php";
		$data["content_js"] = "qa_ameridial_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		
		$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,360)  and status=1  order by name";
		//and is_assign_process (id,756)
		$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
		
		$qSql = "SELECT * FROM signin where id not in (select id from role where folder='agent')";
		$data['tlname'] = $this->Common_model->get_query_result_array($qSql);
		
		$data['kenny_id']=$kenny_id;
		
		$qSql = "SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			from qa_kenny_u_pull_feedback where id='$kenny_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
		$data["kenny_u_pull"] = $this->Common_model->get_query_row_array($qSql);
		
		$curDateTime=CurrMySqlDate();
		$a = array();
		
		if($this->input->post('agent_id')){
			$field_array=array(
				"agent_id" => $this->input->post('agent_id'),
				"tl_id" => $this->input->post('tl_id'),
				"call_date" => mmddyy2mysql($this->input->post('call_date')),
				"call_duration" => $this->input->post('call_duration'),
				"call_id" => $this->input->post('call_id'),
				"call_type" => $this->input->post('call_type'),
				"case" => $this->input->post('case'),
				"site_location" => $this->input->post('site_location'),
				"audit_type" => $this->input->post('audit_type'),
				"auditor_type" => $this->input->post('auditor_type'),
				"voc" => $this->input->post('voc'),
				"overall_score" => $this->input->post('overall_score'),
				"customer_score" => $this->input->post('customer_score'),
				"business_score" => $this->input->post('business_score'),
				"compliance_score" => $this->input->post('compliance_score'),
				"introducing_self" => $this->input->post('introducing_self'),
				"brand_name" => $this->input->post('brand_name'),
				"greet_customer" => $this->input->post('greet_customer'),
				"car_complete" => $this->input->post('car_complete'),
				"the_deduction" => $this->input->post('the_deduction'),
				"negotiation" => $this->input->post('negotiation'),
				"accessibility" => $this->input->post('accessibility'),
				"expected_price" => $this->input->post('expected_price'),
				"branch_selection" => $this->input->post('branch_selection'),
				"postal_card" => $this->input->post('postal_card'),
				"file_opening" => $this->input->post('file_opening'),
				"vehicle_identification" => $this->input->post('vehicle_identification'),
				"mileage" => $this->input->post('mileage'),
				"aesthetic_conditions" => $this->input->post('aesthetic_conditions'),
				"mechanical_condition" => $this->input->post('mechanical_condition'),
				"towing_address" => $this->input->post('towing_address'),
				"drop_off" => $this->input->post('drop_off'),
				"active_listening" => $this->input->post('active_listening'),
				"interruption" => $this->input->post('interruption'),
				"tone_voice" => $this->input->post('tone_voice'),
				"dead_air" => $this->input->post('dead_air'),
				"ending_call" => $this->input->post('ending_call'),
				"confirm_phone" => $this->input->post('confirm_phone'),
				"confirm_address" => $this->input->post('confirm_address'),
				"confirm_date_time" => $this->input->post('confirm_date_time'),
				"purchase_process" => $this->input->post('purchase_process'),
				"adherence_process" => $this->input->post('adherence_process'),
				"rude_behaviour" => $this->input->post('rude_behaviour'),
				"call_avoidance" => $this->input->post('call_avoidance'),
				"cmt1" => $this->input->post('cmt1'),
				"cmt2" => $this->input->post('cmt2'),
				"cmt3" => $this->input->post('cmt3'),
				"cmt4" => $this->input->post('cmt4'),
				"cmt5" => $this->input->post('cmt5'),
				"cmt6" => $this->input->post('cmt6'),
				"cmt7" => $this->input->post('cmt7'),
				"cmt8" => $this->input->post('cmt8'),
				"cmt9" => $this->input->post('cmt9'),
				"cmt10" => $this->input->post('cmt10'),
				"cmt11" => $this->input->post('cmt11'),
				"cmt12" => $this->input->post('cmt12'),
				"cmt13" => $this->input->post('cmt13'),
				"cmt14" => $this->input->post('cmt14'),
				"cmt15" => $this->input->post('cmt15'),
				"cmt16" => $this->input->post('cmt16'),
				"cmt17" => $this->input->post('cmt17'),
				"cmt18" => $this->input->post('cmt18'),
				"cmt19" => $this->input->post('cmt19'),
				"cmt20" => $this->input->post('cmt20'),
				"cmt21" => $this->input->post('cmt21'),
				"cmt22" => $this->input->post('cmt22'),
				"cmt23" => $this->input->post('cmt23'),
				"cmt24" => $this->input->post('cmt24'),
				"cmt25" => $this->input->post('cmt25'),
				"cmt26" => $this->input->post('cmt26'),
				"cmt27" => $this->input->post('cmt27'),
				"cmt28" => $this->input->post('cmt28'),
				"cmt29" => $this->input->post('cmt29'),
				"call_summary" => $this->input->post('call_summary'),
				"feedback" => $this->input->post('feedback'),
				"entry_date" => $curDateTime,
			);
			
			// echo"<pre>";
			// print_r($field_array);
			// echo"</pre>";
		
			if($kenny_id==0){
				
				$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_kenny_u_pull/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_kenny_u_pull_feedback',$field_array);
				//echo ($this->db->last_query()); 
				//	exit();
				/////////
				$field_array2 = array(
					"audit_date" => CurrDate(),
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$this->db->where('id', $rowid);
				$this->db->update('qa_kenny_u_pull_feedback',$field_array2);
				///////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_kenny_u_pull_feedback',$field_array1);
				
			}else{
				
				$this->db->where('id', $kenny_id);
				$this->db->update('qa_kenny_u_pull_feedback',$field_array);
			//////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $kenny_id);
				$this->db->update('qa_kenny_u_pull_feedback',$field_array1);
				
			}
			//exit;
			redirect('Qa_ameridial/qa_kenny_u_pull');
		}
		$data["array"] = $a;
		$this->load->view("dashboard",$data);
	}
}

public function agent_kenny_feedback(){
	if(check_logged_in())
	{
		$user_site_id= get_user_site_id();
		$role_id= get_role_id();
		$current_user = get_user_id();
		
		$data["aside_template"] = "qa/aside.php";
		$data["content_template"] = "qa_ameridial/qa_kenny_u_pull/agent_kenny_feedback.php";
		$data["content_js"] = "qa_ameridial_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["agentUrl"] = "qa_ameridial/agent_kenny_feedback";

		//$data["agentUrl"] = "qa_sensio/agent_sensio_feedback";
		
		$qSql="Select count(id) as value from qa_kenny_u_pull_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit')";
		$data["tot_feedback"] =  $this->Common_model->get_single_value($qSql);
		$qSql="Select count(id) as value from qa_kenny_u_pull_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit') and agent_rvw_date is Null";
		$data["yet_rvw"] =  $this->Common_model->get_single_value($qSql);
			
		$from_date = '';
		$to_date = '';
		$cond="";
		
		
		if($this->input->get('btnView')=='View')
		{
			$from_date = mmddyy2mysql($this->input->get('from_date'));
			$to_date = mmddyy2mysql($this->input->get('to_date'));
			
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			
			$qSql = "SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_kenny_u_pull_feedback $cond and agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit')) xx Left Join
			(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid)";
			$data["agent_rvw_list"] = $this->Common_model->get_query_result_array($qSql);
				
		}else{

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_kenny_u_pull_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit')) xx Left Join
			(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) Where xx.agent_rvw_date is Null";
			$data["agent_rvw_list"] = $this->Common_model->get_query_result_array($qSql);

		}
		
		$data["from_date"] = $from_date;
		$data["to_date"] = $to_date;
		$this->load->view('dashboard',$data);
	}
}

public function agent_kenny_rvw($id){
	if(check_logged_in()){
		$current_user=get_user_id();
		$user_office_id=get_user_office_id();
		
		$data["aside_template"] = "qa/aside.php";
		$data["content_template"] = "qa_ameridial/qa_kenny_u_pull/agent_kenny_rvw.php";
		$data["content_js"] = "qa_ameridial_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["agentUrl"] = "qa_ameridial/agent_kenny_feedback";
		
		$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_kenny_u_pull_feedback where id='$id') xx Left Join
			(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid)";
		$data["kenny_u_pull"] = $this->Common_model->get_query_row_array($qSql);
		
		$data["pnid"]=$id;
		
		if($this->input->post('pnid'))
		{
			$pnid=$this->input->post('pnid');
			$curDateTime=CurrMySqlDate();
			$log=get_logs();
				
			$field_array1=array(
				"agnt_fd_acpt" => $this->input->post('agnt_fd_acpt'),
				"agent_rvw_note" => $this->input->post('note'),
				"agent_rvw_date" => $curDateTime
			);
			$this->db->where('id', $pnid);
			$this->db->update('qa_kenny_u_pull_feedback',$field_array1);
				
			redirect('Qa_ameridial/agent_kenny_feedback');
			
		}else{
			$this->load->view('dashboard',$data);
		}
	}
}

/********************************************************/
/**********kenny u pull  END*********************/
/********************************************************/

/********************************************************/
/**********PURITY FREE BOTTLE  START*********************/
/********************************************************/
	public function purity_bottle()
	{
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_bottle/qa_feedback.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_purity_free_bottle_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["purity_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}
	public function add_purity_bottle(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_bottle/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"file_no" => $this->input->post('file_no'),
					"call_type" => $this->input->post('call_type'),
					"call_type_lob" => $this->input->post('call_type_lob'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"overall_score" => $this->input->post('overall_score'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"customer_prompt" => $this->input->post('customer_prompt'),
					"soft_skills" => $this->input->post('soft_skills'),
					"customer_information" => $this->input->post('customer_information'),
					"super_saver_offer" => $this->input->post('super_saver_offer'),
					"upsell" => $this->input->post('upsell'),
					"payment_procedure" => $this->input->post('payment_procedure'),
					"knowledge_of_product" => $this->input->post('knowledge_of_product'),
					"call_control" => $this->input->post('call_control'),
					"faq" => $this->input->post('faq'),
					"objection_response" => $this->input->post('objection_response'),
					"personalize_the_call" => $this->input->post('personalize_the_call'),
					"correct_confirmation" => $this->input->post('correct_confirmation'),
					"cost_of_delivery" => $this->input->post('cost_of_delivery'),
					"misrepresentation" => $this->input->post('misrepresentation'),
					"dnc_response" => $this->input->post('dnc_response'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);

				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/purity_bottle/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_purity_free_bottle_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_purity_free_bottle_feedback',$field_array1);
			///////////
				redirect('qa_ameridial/purity_bottle/');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_purity_bottle_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_bottle/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			from qa_amd_purity_free_bottle_feedback where id='$id') xx Left Join
			(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["purity_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;


			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"file_no" => $this->input->post('file_no'),
					"call_type" => $this->input->post('call_type'),
					"call_type_lob" => $this->input->post('call_type_lob'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"overall_score" => $this->input->post('overall_score'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"customer_prompt" => $this->input->post('customer_prompt'),
					"soft_skills" => $this->input->post('soft_skills'),
					"customer_information" => $this->input->post('customer_information'),
					"super_saver_offer" => $this->input->post('super_saver_offer'),
					"upsell" => $this->input->post('upsell'),
					"payment_procedure" => $this->input->post('payment_procedure'),
					"knowledge_of_product" => $this->input->post('knowledge_of_product'),
					"call_control" => $this->input->post('call_control'),
					"faq" => $this->input->post('faq'),
					"objection_response" => $this->input->post('objection_response'),
					"personalize_the_call" => $this->input->post('personalize_the_call'),
					"correct_confirmation" => $this->input->post('correct_confirmation'),
					"cost_of_delivery" => $this->input->post('cost_of_delivery'),
					"misrepresentation" => $this->input->post('misrepresentation'),
					"dnc_response" => $this->input->post('dnc_response'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_purity_free_bottle_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_purity_free_bottle_feedback',$field_array1);
			///////////
				redirect('qa_ameridial/purity_bottle/');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
/********************************************************/
/**********PURITY FREE BOTTLE  END*********************/
/********************************************************/

/********************************************************/
/**********PURITY CATALOG START**************************/
/********************************************************/
	public function purity_catalog()
	{
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_catalog/qa_feedback.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_purity_catalog_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)  $ops_cond order by audit_date";
			$data["purity_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_purity_catalog(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_catalog/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"file_no" => $this->input->post('file_no'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"overall_score" => $this->input->post('overall_score'),
					"proper_greeting" => $this->input->post('proper_greeting'),
					"customer_first_name_address_verification" => $this->input->post('customer_first_name_address_verification'),
					"identified_type_of_account" => $this->input->post('identified_type_of_account'),
					"properly_transfer_account" => $this->input->post('properly_transfer_account'),
					"accurate_note_taken" => $this->input->post('accurate_note_taken'),
					"correct_information_given" => $this->input->post('correct_information_given'),
					"proper_terminology" => $this->input->post('proper_terminology'),
					"free_gift_scripting" => $this->input->post('free_gift_scripting'),
					"bulk_offer" => $this->input->post('bulk_offer'),
					"promotion_offered_correctly" => $this->input->post('promotion_offered_correctly'),
					"super_saver_offer_explained_correctly" => $this->input->post('super_saver_offer_explained_correctly'),
					"additional_product_offered" => $this->input->post('additional_product_offered'),
					"order_placed_properly" => $this->input->post('order_placed_properly'),
					"order_confirmation" => $this->input->post('order_confirmation'),
					"user_tool_faq" => $this->input->post('user_tool_faq'),
					"address_verification_at_confirmation" => $this->input->post('address_verification_at_confirmation'),
					"credit_card_verification" => $this->input->post('credit_card_verification'),
					"attemp_to_gather_cvv_code" => $this->input->post('attemp_to_gather_cvv_code'),
					"daily_special_offer" => $this->input->post('daily_special_offer'),
					"product_offered_with_daily_special" => $this->input->post('product_offered_with_daily_special'),
					"thank_you_statement" => $this->input->post('thank_you_statement'),
					"maintained_call_control" => $this->input->post('maintained_call_control'),
					"response_time" => $this->input->post('response_time'),
					"used_proper_hold_techniques" => $this->input->post('used_proper_hold_techniques'),
					"good_attitude" => $this->input->post('good_attitude'),
					"energy_attentiveness" => $this->input->post('energy_attentiveness'),
					"context_related_response" => $this->input->post('context_related_response'),
					"empathy_respectfulness" => $this->input->post('empathy_respectfulness'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/purity_catalog/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_purity_catalog_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_purity_catalog_feedback',$field_array1);
			///////////
				redirect('qa_ameridial/purity_catalog/');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_purity_catalog_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_catalog/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_amd_purity_catalog_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["purity_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;


			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"file_no" => $this->input->post('file_no'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"overall_score" => $this->input->post('overall_score'),
					"proper_greeting" => $this->input->post('proper_greeting'),
					"customer_first_name_address_verification" => $this->input->post('customer_first_name_address_verification'),
					"identified_type_of_account" => $this->input->post('identified_type_of_account'),
					"properly_transfer_account" => $this->input->post('properly_transfer_account'),
					"accurate_note_taken" => $this->input->post('accurate_note_taken'),
					"correct_information_given" => $this->input->post('correct_information_given'),
					"proper_terminology" => $this->input->post('proper_terminology'),
					"free_gift_scripting" => $this->input->post('free_gift_scripting'),
					"bulk_offer" => $this->input->post('bulk_offer'),
					"promotion_offered_correctly" => $this->input->post('promotion_offered_correctly'),
					"super_saver_offer_explained_correctly" => $this->input->post('super_saver_offer_explained_correctly'),
					"additional_product_offered" => $this->input->post('additional_product_offered'),
					"order_placed_properly" => $this->input->post('order_placed_properly'),
					"order_confirmation" => $this->input->post('order_confirmation'),
					"user_tool_faq" => $this->input->post('user_tool_faq'),
					"address_verification_at_confirmation" => $this->input->post('address_verification_at_confirmation'),
					"credit_card_verification" => $this->input->post('credit_card_verification'),
					"attemp_to_gather_cvv_code" => $this->input->post('attemp_to_gather_cvv_code'),
					"daily_special_offer" => $this->input->post('daily_special_offer'),
					"product_offered_with_daily_special" => $this->input->post('product_offered_with_daily_special'),
					"thank_you_statement" => $this->input->post('thank_you_statement'),
					"maintained_call_control" => $this->input->post('maintained_call_control'),
					"response_time" => $this->input->post('response_time'),
					"used_proper_hold_techniques" => $this->input->post('used_proper_hold_techniques'),
					"good_attitude" => $this->input->post('good_attitude'),
					"energy_attentiveness" => $this->input->post('energy_attentiveness'),
					"context_related_response" => $this->input->post('context_related_response'),
					"empathy_respectfulness" => $this->input->post('empathy_respectfulness'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_purity_catalog_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_purity_catalog_feedback',$field_array1);
			///////////
				redirect('qa_ameridial/purity_catalog/');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
/********************************************************/
/**********PURITY CATALOG END****************************/
/********************************************************/

/********************************************************/
/************PURITY CARE START**************************/
/********************************************************/
	public function purity_care()
	{
		if(check_logged_in()){
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_care/qa_feedback.php";

			$off_sql="Select * from office_location where is_active=1";
			$data['location_list'] =  $this->Common_model->get_query_result_array($off_sql);

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and is_assign_client(id,134)  and dept_id=6 and status=1 group by id order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$office_id = $this->input->get('office_id');
			$asc_desc = $this->input->get('asc_desc');
			$cn_call1 = $this->input->get('cn_call1');
			/* $cn_call2 = $this->input->get('cn_call2');
			$cn_call3 = $this->input->get('cn_call3');
			$cn_call4 = $this->input->get('cn_call4');
			$cn_call5 = $this->input->get('cn_call5'); */
			$cond="";
			//$cond1="";
			//$agent_fd_cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($office_id !="")	$cond .=" and office_id='$office_id'";
			if($cn_call1 !="")	$cond .=" and (file_no1 like '%$cn_call1%' or file_no2 like '%$cn_call1%' or file_no3 like '%$cn_call1%' or file_no4 like '%$cn_call1%' or file_no5 like '%$cn_call1%')";
			/* if($cn_call2 !="")	$cond .=" and file_no2 like '%$cn_call2%'";
			if($cn_call3 !="")	$cond .=" and file_no3 like '%$cn_call3%'";
			if($cn_call4 !="")	$cond .=" and file_no4 like '%$cn_call4%'";
			if($cn_call5 !="")	$cond .=" and file_no5 like '%$cn_call5%'"; */
			//if($asc_desc !="")	$cond1 .=" order by overall_score $asc_desc";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" And assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			/* $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_purity_care_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["purity_data"] = $this->Common_model->get_query_result_array($qSql); */
		///////////

		/////// Agent Acceptance //////////
			/* if($from_date !="" && $to_date!=="" )  $agent_fd_cond .=" and (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$agent_fd_cond .=" and agent_id='$agent_id'";
			if($office_id !="")	$agent_fd_cond .=" and office_id='$office_id'";
			if($cn_call1 !="")	$agent_fd_cond .=" and (file_no1 like '%$cn_call1%' or file_no2 like '%$cn_call1%' or file_no3 like '%$cn_call1%' or file_no4 like '%$cn_call1%' or file_no5 like '%$cn_call1%')"; */
			/* if($cn_call2 !="")	$agent_fd_cond .=" and file_no2 like '%$cn_call2%'";
			if($cn_call3 !="")	$agent_fd_cond .=" and file_no3 like '%$cn_call3%'";
			if($cn_call4 !="")	$agent_fd_cond .=" and file_no4 like '%$cn_call4%'";
			if($cn_call5 !="")	$agent_fd_cond .=" and file_no5 like '%$cn_call5%'"; */

			/* $qSql="Select count(pc.id) as value from qa_amd_puritycare_new_feedback pc left join signin s on s.id=pc.agent_id where audit_type in ('CQ Audit', 'BQ Audit') $agent_fd_cond";
			$data["tot_audit"] =  $this->Common_model->get_single_value($qSql);
			$qSql="Select count(pc.id) as value from qa_amd_puritycare_new_feedback pc left join signin s on s.id=pc.agent_id where audit_type in ('CQ Audit', 'BQ Audit') and agent_fd_acpt='Accepted' $agent_fd_cond";
			$data["agent_acpt"] =  $this->Common_model->get_single_value($qSql); */
		///////////////

			/* $avg_tot_score_sql="Select AVG(pc.overall_score) as value from qa_amd_puritycare_new_feedback pc left join signin s on s.id=pc.agent_id $cond $ops_cond";
			$data["agv_tot_score"] = $this->Common_model->get_single_value($avg_tot_score_sql); */

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select xpoid from signin xs where xs.id=entry_by) as xpoid,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_puritycare_new_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $ops_cond";
			$data["purity_new_data"] = $this->Common_model->get_query_result_array($qSql);


			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["office_id"] = $office_id;
			//$data["asc_desc"] = $asc_desc;
			//$data["file_no"] = $file_no;
			$data["cn_call1"] = $cn_call1;
			//$data["cn_call2"] = $cn_call2;
			//$data["cn_call3"] = $cn_call3;
			//$data["cn_call4"] = $cn_call4;
			//$data["cn_call5"] = $cn_call5;

			$this->load->view("dashboard",$data);
		}
	}

	/* public function add_purity_care($id = 0){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_care/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql	=	"SELECT * FROM qa_amd_purity_care_feedback WHERE id='".$id."'";
			$data['call_data'] = $this->Common_model->get_query_row_array($qSql);
			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
						"agent_id" => $this->input->post('agent_id'),
						"tl_id" => $this->input->post('tl_id'),
						"call_date" => mmddyy2mysql($this->input->post('call_date')),
						"call_one_call_duration" => $this->input->post('call_one_call_duration'),
						"call_one_file_no" => $this->input->post('call_one_file_no'),
						"voc" => $this->input->post('voc'),
						"call_two_call_duration" => $this->input->post('call_two_call_duration'),
						"call_two_file_no" => $this->input->post('call_two_file_no'),
						//"call_two_voc" => $this->input->post('call_two_voc'),
						"call_three_call_duration" => $this->input->post('call_three_call_duration'),
						"call_three_file_no" => $this->input->post('call_three_file_no'),
						//"call_three_voc" => $this->input->post('call_three_voc'),
						"audit_type" => $this->input->post('audit_type'),
						"auditor_type" => $this->input->post('auditor_type'),
						"earned_score" => $this->input->post('earned_score'),
						"possible_score" => $this->input->post('possible_score'),
						"overall_score" => $this->input->post('overall_score'),
						"call_one_proper_introduction" => $this->input->post('call_one_proper_introduction'),
						"call_two_proper_introduction" => $this->input->post('call_two_proper_introduction'),
						"call_three_proper_introduction" => $this->input->post('call_three_proper_introduction'),
						"review_proper_introduction" => $this->input->post('review_proper_introduction'),
						"score_proper_introduction" => $this->input->post('score_proper_introduction'),
						"call_one_cust_fname_addrs_verification" => $this->input->post('call_one_cust_fname_addrs_verification'),
						"call_two_cust_fname_addrs_verification" => $this->input->post('call_two_cust_fname_addrs_verification'),
						"call_three_cust_fname_addrs_verification" => $this->input->post('call_three_cust_fname_addrs_verification'),
						"review_cust_fname_addrs_verification" => $this->input->post('review_cust_fname_addrs_verification'),
						"score_cust_fname_addrs_verification" => $this->input->post('score_cust_fname_addrs_verification'),
						"call_one_opening_question" => $this->input->post('call_one_opening_question'),
						"call_two_opening_question" => $this->input->post('call_two_opening_question'),
						"call_three_opening_question" => $this->input->post('call_three_opening_question'),
						"review_opening_question" => $this->input->post('review_opening_question'),
						"score_opening_question" => $this->input->post('score_opening_question'),
						"call_one_accurate_note" => $this->input->post('call_one_accurate_note'),
						"call_two_accurate_note" => $this->input->post('call_two_accurate_note'),
						"call_three_accurate_note" => $this->input->post('call_three_accurate_note'),
						"review_accurate_note" => $this->input->post('review_accurate_note'),
						"score_accurate_note" => $this->input->post('score_accurate_note'),
						"call_one_correct_reason" => $this->input->post('call_one_correct_reason'),
						"call_two_correct_reason" => $this->input->post('call_two_correct_reason'),
						"call_three_correct_reason" => $this->input->post('call_three_correct_reason'),
						"review_correct_reason" => $this->input->post('review_correct_reason'),
						"score_correct_reason" => $this->input->post('score_correct_reason'),
						"call_one_correct_information_given" => $this->input->post('call_one_correct_information_given'),
						"call_two_correct_information_given" => $this->input->post('call_two_correct_information_given'),
						"call_three_correct_information_given" => $this->input->post('call_three_correct_information_given'),
						"review_correct_information_given" => $this->input->post('review_correct_information_given'),
						"score_correct_information_given" => $this->input->post('score_correct_information_given'),
						"call_one_proper_terminology" => $this->input->post('call_one_proper_terminology'),
						"call_two_proper_terminology" => $this->input->post('call_two_proper_terminology'),
						"call_three_proper_terminology" => $this->input->post('call_three_proper_terminology'),
						"review_proper_terminology" => $this->input->post('review_proper_terminology'),
						"score_proper_terminology" => $this->input->post('score_proper_terminology'),
						"call_one_proper_inquiry" => $this->input->post('call_one_proper_inquiry'),
						"call_two_proper_inquiry" => $this->input->post('call_two_proper_inquiry'),
						"call_three_proper_inquiry" => $this->input->post('call_three_proper_inquiry'),
						"review_proper_inquiry" => $this->input->post('review_proper_inquiry'),
						"score_proper_inquiry" => $this->input->post('score_proper_inquiry'),
						"call_one_company_promotion" => $this->input->post('call_one_company_promotion'),
						"call_two_company_promotion" => $this->input->post('call_two_company_promotion'),
						"call_three_company_promotion" => $this->input->post('call_three_company_promotion'),
						"review_company_promotion" => $this->input->post('review_company_promotion'),
						"score_company_promotion" => $this->input->post('score_company_promotion'),
						"call_one_correct_use_of_action" => $this->input->post('call_one_correct_use_of_action'),
						"call_two_correct_use_of_action" => $this->input->post('call_two_correct_use_of_action'),
						"call_three_correct_use_of_action" => $this->input->post('call_three_correct_use_of_action'),
						"review_correct_use_of_action" => $this->input->post('review_correct_use_of_action'),
						"score_correct_use_of_action" => $this->input->post('score_correct_use_of_action'),
						"call_one_database_follow_up" => $this->input->post('call_one_database_follow_up'),
						"call_two_database_follow_up" => $this->input->post('call_two_database_follow_up'),
						"call_three_database_follow_up" => $this->input->post('call_three_database_follow_up'),
						"review_database_follow_up" => $this->input->post('review_database_follow_up'),
						"score_database_follow_up" => $this->input->post('score_database_follow_up'),
						"call_one_product_promotion" => $this->input->post('call_one_product_promotion'),
						"call_two_product_promotion" => $this->input->post('call_two_product_promotion'),
						"call_three_product_promotion" => $this->input->post('call_three_product_promotion'),
						"review_product_promotion" => $this->input->post('review_product_promotion'),
						"score_product_promotion" => $this->input->post('score_product_promotion'),
						"call_one_reason_for_cancel" => $this->input->post('call_one_reason_for_cancel'),
						"call_two_reason_for_cancel" => $this->input->post('call_two_reason_for_cancel'),
						"call_three_reason_for_cancel" => $this->input->post('call_three_reason_for_cancel'),
						"review_reason_for_cancel" => $this->input->post('review_reason_for_cancel'),
						"score_reason_for_cancel" => $this->input->post('score_reason_for_cancel'),
						"call_one_legimate_sequence_offer" => $this->input->post('call_one_legimate_sequence_offer'),
						"call_two_legimate_sequence_offer" => $this->input->post('call_two_legimate_sequence_offer'),
						"call_three_legimate_sequence_offer" => $this->input->post('call_three_legimate_sequence_offer'),
						"review_legimate_sequence_offer" => $this->input->post('review_legimate_sequence_offer'),
						"score_legimate_sequence_offer" => $this->input->post('score_legimate_sequence_offer'),
						"call_one_first_retention_offer" => $this->input->post('call_one_first_retention_offer'),
						"call_two_first_retention_offer" => $this->input->post('call_two_first_retention_offer'),
						"call_three_first_retention_offer" => $this->input->post('call_three_first_retention_offer'),
						"review_first_retention_offer" => $this->input->post('review_first_retention_offer'),
						"score_first_retention_offer" => $this->input->post('score_first_retention_offer'),
						"call_one_second_retention_offer" => $this->input->post('call_one_second_retention_offer'),
						"call_two_second_retention_offer" => $this->input->post('call_two_second_retention_offer'),
						"call_three_second_retention_offer" => $this->input->post('call_three_second_retention_offer'),
						"review_second_retention_offer" => $this->input->post('review_second_retention_offer'),
						"score_second_retention_offer" => $this->input->post('score_second_retention_offer'),
						"call_one_valid_delay" => $this->input->post('call_one_valid_delay'),
						"call_two_valid_delay" => $this->input->post('call_two_valid_delay'),
						"call_three_valid_delay" => $this->input->post('call_three_valid_delay'),
						"review_valid_delay" => $this->input->post('review_valid_delay'),
						"score_valid_delay" => $this->input->post('score_valid_delay'),
						"call_one_preserved_avg_unit" => $this->input->post('call_one_preserved_avg_unit'),
						"call_two_preserved_avg_unit" => $this->input->post('call_two_preserved_avg_unit'),
						"call_three_preserved_avg_unit" => $this->input->post('call_three_preserved_avg_unit'),
						"review_preserved_avg_unit" => $this->input->post('review_preserved_avg_unit'),
						"score_preserved_avg_unit" => $this->input->post('score_preserved_avg_unit'),
						"call_one_proper_confirmation" => $this->input->post('call_one_proper_confirmation'),
						"call_two_proper_confirmation" => $this->input->post('call_two_proper_confirmation'),
						"call_three_proper_confirmation" => $this->input->post('call_three_proper_confirmation'),
						"review_proper_confirmation" => $this->input->post('review_proper_confirmation'),
						"score_proper_confirmation" => $this->input->post('score_proper_confirmation'),
						"call_one_daily_special_offer" => $this->input->post('call_one_daily_special_offer'),
						"call_two_daily_special_offer" => $this->input->post('call_two_daily_special_offer'),
						"call_three_daily_special_offer" => $this->input->post('call_three_daily_special_offer'),
						"review_daily_special_offer" => $this->input->post('review_daily_special_offer'),
						"score_daily_special_offer" => $this->input->post('score_daily_special_offer'),
						"call_one_anything_else" => $this->input->post('call_one_anything_else'),
						"call_two_anything_else" => $this->input->post('call_two_anything_else'),
						"call_three_anything_else" => $this->input->post('call_three_anything_else'),
						"review_anything_else" => $this->input->post('review_anything_else'),
						"score_anything_else" => $this->input->post('score_anything_else'),
						"call_one_thank_you" => $this->input->post('call_one_thank_you'),
						"call_two_thank_you" => $this->input->post('call_two_thank_you'),
						"call_three_thank_you" => $this->input->post('call_three_thank_you'),
						"review_thank_you" => $this->input->post('review_thank_you'),
						"score_thank_you" => $this->input->post('score_thank_you'),
						"call_one_mantained_call" => $this->input->post('call_one_mantained_call'),
						"call_two_mantained_call" => $this->input->post('call_two_mantained_call'),
						"call_three_mantained_call" => $this->input->post('call_three_mantained_call'),
						"review_mantained_call" => $this->input->post('review_mantained_call'),
						"score_mantained_call" => $this->input->post('score_mantained_call'),
						"call_one_response_time" => $this->input->post('call_one_response_time'),
						"call_two_response_time" => $this->input->post('call_two_response_time'),
						"call_three_response_time" => $this->input->post('call_three_response_time'),
						"review_response_time" => $this->input->post('review_response_time'),
						"score_response_time" => $this->input->post('score_response_time'),
						"call_one_proper_hold_technique" => $this->input->post('call_one_proper_hold_technique'),
						"call_two_proper_hold_technique" => $this->input->post('call_two_proper_hold_technique'),
						"call_three_proper_hold_technique" => $this->input->post('call_three_proper_hold_technique'),
						"review_proper_hold_technique" => $this->input->post('review_proper_hold_technique'),
						"score_proper_hold_technique" => $this->input->post('score_proper_hold_technique'),
						"call_one_good_attitude" => $this->input->post('call_one_good_attitude'),
						"call_two_good_attitude" => $this->input->post('call_two_good_attitude'),
						"call_three_good_attitude" => $this->input->post('call_three_good_attitude'),
						"review_good_attitude" => $this->input->post('review_good_attitude'),
						"score_good_attitude" => $this->input->post('score_good_attitude'),
						"call_one_attentiveness" => $this->input->post('call_one_attentiveness'),
						"call_two_attentiveness" => $this->input->post('call_two_attentiveness'),
						"call_three_attentiveness" => $this->input->post('call_three_attentiveness'),
						"review_attentiveness" => $this->input->post('review_attentiveness'),
						"score_attentiveness" => $this->input->post('score_attentiveness'),
						"call_one_context_related_response" => $this->input->post('call_one_context_related_response'),
						"call_two_context_related_response" => $this->input->post('call_two_context_related_response'),
						"call_three_context_related_response" => $this->input->post('call_three_context_related_response'),
						"review_context_related_response" => $this->input->post('review_context_related_response'),
						"score_context_related_response" => $this->input->post('score_context_related_response'),
						"call_one_empathy" => $this->input->post('call_one_empathy'),
						"call_two_empathy" => $this->input->post('call_two_empathy'),
						"call_three_empathy" => $this->input->post('call_three_empathy'),
						"review_empathy" => $this->input->post('review_empathy'),
						"score_empathy" => $this->input->post('score_empathy'),
						"call_one_badgering" => $this->input->post('call_one_badgering'),
						"call_two_badgering" => $this->input->post('call_two_badgering'),
						"call_three_badgering" => $this->input->post('call_three_badgering'),
						"review_badgering" => $this->input->post('review_badgering'),
						"score_badgering" => $this->input->post('score_badgering'),
						"call_one_avg_call" => $this->input->post('call_one_avg_call'),
						"call_two_avg_call" => $this->input->post('call_two_avg_call'),
						"call_three_avg_call" => $this->input->post('call_three_avg_call'),
						"review_avg_call" => $this->input->post('review_avg_call'),
						"score_avg_call" => $this->input->post('score_avg_call'),
						"call_one_avg_save" => $this->input->post('call_one_avg_save'),
						"call_two_avg_save" => $this->input->post('call_two_avg_save'),
						"call_three_avg_save" => $this->input->post('call_three_avg_save'),
						"review_avg_save" => $this->input->post('review_avg_save'),
						"score_avg_save" => $this->input->post('score_avg_save'),
						"call_one_avg_call_length" => $this->input->post('call_one_avg_call_length'),
						"call_two_avg_call_length" => $this->input->post('call_two_avg_call_length'),
						"call_three_avg_call_length" => $this->input->post('call_three_avg_call_length'),
						"review_avg_call_length" => $this->input->post('review_avg_call_length'),
						"score_avg_call_length" => $this->input->post('score_avg_call_length'),
						"call_summary" => $this->input->post('call_summary'),
						"feedback" => $this->input->post('feedback'),
						"entry_date" => $curDateTime
					);
				if($id == 0)
				{
					$field_array["audit_date"] = CurrDate();
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/purity_care/');
					$attach_file	=	implode(',',$a);
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_purity_care_feedback',$field_array);
				}
				else
				{
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/purity_care/');
					$attach_file	=	implode(',',$a);
					if($attach_file != "")
					{
						$field_array["attach_file"] = $attach_file;
					}
					$this->db->where('id', $id);
					$this->db->update('qa_amd_purity_care_feedback',$field_array);
				}

			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_purity_care_feedback',$field_array1);
			///////////

				redirect('qa_ameridial/purity_care/');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_purity_care_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_care/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_amd_purity_care_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["purity_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;

			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_one_call_duration" => $this->input->post('call_one_call_duration'),
					"call_one_file_no" => $this->input->post('call_one_file_no'),
					"voc" => $this->input->post('voc'),
					"call_two_call_duration" => $this->input->post('call_two_call_duration'),
					"call_two_file_no" => $this->input->post('call_two_file_no'),
					//"call_two_voc" => $this->input->post('call_two_voc'),
					"call_three_call_duration" => $this->input->post('call_three_call_duration'),
					"call_three_file_no" => $this->input->post('call_three_file_no'),
					//"call_three_voc" => $this->input->post('call_three_voc'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"earned_score" => $this->input->post('earned_score'),
					"possible_score" => $this->input->post('possible_score'),
					"overall_score" => $this->input->post('overall_score'),
					"call_one_proper_introduction" => $this->input->post('call_one_proper_introduction'),
					"call_two_proper_introduction" => $this->input->post('call_two_proper_introduction'),
					"call_three_proper_introduction" => $this->input->post('call_three_proper_introduction'),
					"review_proper_introduction" => $this->input->post('review_proper_introduction'),
					"score_proper_introduction" => $this->input->post('score_proper_introduction'),
					"call_one_cust_fname_addrs_verification" => $this->input->post('call_one_cust_fname_addrs_verification'),
					"call_two_cust_fname_addrs_verification" => $this->input->post('call_two_cust_fname_addrs_verification'),
					"call_three_cust_fname_addrs_verification" => $this->input->post('call_three_cust_fname_addrs_verification'),
					"review_cust_fname_addrs_verification" => $this->input->post('review_cust_fname_addrs_verification'),
					"score_cust_fname_addrs_verification" => $this->input->post('score_cust_fname_addrs_verification'),
					"call_one_opening_question" => $this->input->post('call_one_opening_question'),
					"call_two_opening_question" => $this->input->post('call_two_opening_question'),
					"call_three_opening_question" => $this->input->post('call_three_opening_question'),
					"review_opening_question" => $this->input->post('review_opening_question'),
					"score_opening_question" => $this->input->post('score_opening_question'),
					"call_one_accurate_note" => $this->input->post('call_one_accurate_note'),
					"call_two_accurate_note" => $this->input->post('call_two_accurate_note'),
					"call_three_accurate_note" => $this->input->post('call_three_accurate_note'),
					"review_accurate_note" => $this->input->post('review_accurate_note'),
					"score_accurate_note" => $this->input->post('score_accurate_note'),
					"call_one_correct_reason" => $this->input->post('call_one_correct_reason'),
					"call_two_correct_reason" => $this->input->post('call_two_correct_reason'),
					"call_three_correct_reason" => $this->input->post('call_three_correct_reason'),
					"review_correct_reason" => $this->input->post('review_correct_reason'),
					"score_correct_reason" => $this->input->post('score_correct_reason'),
					"call_one_correct_information_given" => $this->input->post('call_one_correct_information_given'),
					"call_two_correct_information_given" => $this->input->post('call_two_correct_information_given'),
					"call_three_correct_information_given" => $this->input->post('call_three_correct_information_given'),
					"review_correct_information_given" => $this->input->post('review_correct_information_given'),
					"score_correct_information_given" => $this->input->post('score_correct_information_given'),
					"call_one_proper_terminology" => $this->input->post('call_one_proper_terminology'),
					"call_two_proper_terminology" => $this->input->post('call_two_proper_terminology'),
					"call_three_proper_terminology" => $this->input->post('call_three_proper_terminology'),
					"review_proper_terminology" => $this->input->post('review_proper_terminology'),
					"score_proper_terminology" => $this->input->post('score_proper_terminology'),
					"call_one_proper_inquiry" => $this->input->post('call_one_proper_inquiry'),
					"call_two_proper_inquiry" => $this->input->post('call_two_proper_inquiry'),
					"call_three_proper_inquiry" => $this->input->post('call_three_proper_inquiry'),
					"review_proper_inquiry" => $this->input->post('review_proper_inquiry'),
					"score_proper_inquiry" => $this->input->post('score_proper_inquiry'),
					"call_one_company_promotion" => $this->input->post('call_one_company_promotion'),
					"call_two_company_promotion" => $this->input->post('call_two_company_promotion'),
					"call_three_company_promotion" => $this->input->post('call_three_company_promotion'),
					"review_company_promotion" => $this->input->post('review_company_promotion'),
					"score_company_promotion" => $this->input->post('score_company_promotion'),
					"call_one_correct_use_of_action" => $this->input->post('call_one_correct_use_of_action'),
					"call_two_correct_use_of_action" => $this->input->post('call_two_correct_use_of_action'),
					"call_three_correct_use_of_action" => $this->input->post('call_three_correct_use_of_action'),
					"review_correct_use_of_action" => $this->input->post('review_correct_use_of_action'),
					"score_correct_use_of_action" => $this->input->post('score_correct_use_of_action'),
					"call_one_database_follow_up" => $this->input->post('call_one_database_follow_up'),
					"call_two_database_follow_up" => $this->input->post('call_two_database_follow_up'),
					"call_three_database_follow_up" => $this->input->post('call_three_database_follow_up'),
					"review_database_follow_up" => $this->input->post('review_database_follow_up'),
					"score_database_follow_up" => $this->input->post('score_database_follow_up'),
					"call_one_product_promotion" => $this->input->post('call_one_product_promotion'),
					"call_two_product_promotion" => $this->input->post('call_two_product_promotion'),
					"call_three_product_promotion" => $this->input->post('call_three_product_promotion'),
					"review_product_promotion" => $this->input->post('review_product_promotion'),
					"score_product_promotion" => $this->input->post('score_product_promotion'),
					"call_one_reason_for_cancel" => $this->input->post('call_one_reason_for_cancel'),
					"call_two_reason_for_cancel" => $this->input->post('call_two_reason_for_cancel'),
					"call_three_reason_for_cancel" => $this->input->post('call_three_reason_for_cancel'),
					"review_reason_for_cancel" => $this->input->post('review_reason_for_cancel'),
					"score_reason_for_cancel" => $this->input->post('score_reason_for_cancel'),
					"call_one_legimate_sequence_offer" => $this->input->post('call_one_legimate_sequence_offer'),
					"call_two_legimate_sequence_offer" => $this->input->post('call_two_legimate_sequence_offer'),
					"call_three_legimate_sequence_offer" => $this->input->post('call_three_legimate_sequence_offer'),
					"review_legimate_sequence_offer" => $this->input->post('review_legimate_sequence_offer'),
					"score_legimate_sequence_offer" => $this->input->post('score_legimate_sequence_offer'),
					"call_one_first_retention_offer" => $this->input->post('call_one_first_retention_offer'),
					"call_two_first_retention_offer" => $this->input->post('call_two_first_retention_offer'),
					"call_three_first_retention_offer" => $this->input->post('call_three_first_retention_offer'),
					"review_first_retention_offer" => $this->input->post('review_first_retention_offer'),
					"score_first_retention_offer" => $this->input->post('score_first_retention_offer'),
					"call_one_second_retention_offer" => $this->input->post('call_one_second_retention_offer'),
					"call_two_second_retention_offer" => $this->input->post('call_two_second_retention_offer'),
					"call_three_second_retention_offer" => $this->input->post('call_three_second_retention_offer'),
					"review_second_retention_offer" => $this->input->post('review_second_retention_offer'),
					"score_second_retention_offer" => $this->input->post('score_second_retention_offer'),
					"call_one_valid_delay" => $this->input->post('call_one_valid_delay'),
					"call_two_valid_delay" => $this->input->post('call_two_valid_delay'),
					"call_three_valid_delay" => $this->input->post('call_three_valid_delay'),
					"review_valid_delay" => $this->input->post('review_valid_delay'),
					"score_valid_delay" => $this->input->post('score_valid_delay'),
					"call_one_preserved_avg_unit" => $this->input->post('call_one_preserved_avg_unit'),
					"call_two_preserved_avg_unit" => $this->input->post('call_two_preserved_avg_unit'),
					"call_three_preserved_avg_unit" => $this->input->post('call_three_preserved_avg_unit'),
					"review_preserved_avg_unit" => $this->input->post('review_preserved_avg_unit'),
					"score_preserved_avg_unit" => $this->input->post('score_preserved_avg_unit'),
					"call_one_proper_confirmation" => $this->input->post('call_one_proper_confirmation'),
					"call_two_proper_confirmation" => $this->input->post('call_two_proper_confirmation'),
					"call_three_proper_confirmation" => $this->input->post('call_three_proper_confirmation'),
					"review_proper_confirmation" => $this->input->post('review_proper_confirmation'),
					"score_proper_confirmation" => $this->input->post('score_proper_confirmation'),
					"call_one_daily_special_offer" => $this->input->post('call_one_daily_special_offer'),
					"call_two_daily_special_offer" => $this->input->post('call_two_daily_special_offer'),
					"call_three_daily_special_offer" => $this->input->post('call_three_daily_special_offer'),
					"review_daily_special_offer" => $this->input->post('review_daily_special_offer'),
					"score_daily_special_offer" => $this->input->post('score_daily_special_offer'),
					"call_one_anything_else" => $this->input->post('call_one_anything_else'),
					"call_two_anything_else" => $this->input->post('call_two_anything_else'),
					"call_three_anything_else" => $this->input->post('call_three_anything_else'),
					"review_anything_else" => $this->input->post('review_anything_else'),
					"score_anything_else" => $this->input->post('score_anything_else'),
					"call_one_thank_you" => $this->input->post('call_one_thank_you'),
					"call_two_thank_you" => $this->input->post('call_two_thank_you'),
					"call_three_thank_you" => $this->input->post('call_three_thank_you'),
					"review_thank_you" => $this->input->post('review_thank_you'),
					"score_thank_you" => $this->input->post('score_thank_you'),
					"call_one_mantained_call" => $this->input->post('call_one_mantained_call'),
					"call_two_mantained_call" => $this->input->post('call_two_mantained_call'),
					"call_three_mantained_call" => $this->input->post('call_three_mantained_call'),
					"review_mantained_call" => $this->input->post('review_mantained_call'),
					"score_mantained_call" => $this->input->post('score_mantained_call'),
					"call_one_response_time" => $this->input->post('call_one_response_time'),
					"call_two_response_time" => $this->input->post('call_two_response_time'),
					"call_three_response_time" => $this->input->post('call_three_response_time'),
					"review_response_time" => $this->input->post('review_response_time'),
					"score_response_time" => $this->input->post('score_response_time'),
					"call_one_proper_hold_technique" => $this->input->post('call_one_proper_hold_technique'),
					"call_two_proper_hold_technique" => $this->input->post('call_two_proper_hold_technique'),
					"call_three_proper_hold_technique" => $this->input->post('call_three_proper_hold_technique'),
					"review_proper_hold_technique" => $this->input->post('review_proper_hold_technique'),
					"score_proper_hold_technique" => $this->input->post('score_proper_hold_technique'),
					"call_one_good_attitude" => $this->input->post('call_one_good_attitude'),
					"call_two_good_attitude" => $this->input->post('call_two_good_attitude'),
					"call_three_good_attitude" => $this->input->post('call_three_good_attitude'),
					"review_good_attitude" => $this->input->post('review_good_attitude'),
					"score_good_attitude" => $this->input->post('score_good_attitude'),
					"call_one_attentiveness" => $this->input->post('call_one_attentiveness'),
					"call_two_attentiveness" => $this->input->post('call_two_attentiveness'),
					"call_three_attentiveness" => $this->input->post('call_three_attentiveness'),
					"review_attentiveness" => $this->input->post('review_attentiveness'),
					"score_attentiveness" => $this->input->post('score_attentiveness'),
					"call_one_context_related_response" => $this->input->post('call_one_context_related_response'),
					"call_two_context_related_response" => $this->input->post('call_two_context_related_response'),
					"call_three_context_related_response" => $this->input->post('call_three_context_related_response'),
					"review_context_related_response" => $this->input->post('review_context_related_response'),
					"score_context_related_response" => $this->input->post('score_context_related_response'),
					"call_one_empathy" => $this->input->post('call_one_empathy'),
					"call_two_empathy" => $this->input->post('call_two_empathy'),
					"call_three_empathy" => $this->input->post('call_three_empathy'),
					"review_empathy" => $this->input->post('review_empathy'),
					"score_empathy" => $this->input->post('score_empathy'),
					"call_one_badgering" => $this->input->post('call_one_badgering'),
					"call_two_badgering" => $this->input->post('call_two_badgering'),
					"call_three_badgering" => $this->input->post('call_three_badgering'),
					"review_badgering" => $this->input->post('review_badgering'),
					"score_badgering" => $this->input->post('score_badgering'),
					"call_one_avg_call" => $this->input->post('call_one_avg_call'),
					"call_two_avg_call" => $this->input->post('call_two_avg_call'),
					"call_three_avg_call" => $this->input->post('call_three_avg_call'),
					"review_avg_call" => $this->input->post('review_avg_call'),
					"score_avg_call" => $this->input->post('score_avg_call'),
					"call_one_avg_save" => $this->input->post('call_one_avg_save'),
					"call_two_avg_save" => $this->input->post('call_two_avg_save'),
					"call_three_avg_save" => $this->input->post('call_three_avg_save'),
					"review_avg_save" => $this->input->post('review_avg_save'),
					"score_avg_save" => $this->input->post('score_avg_save'),
					"call_one_avg_call_length" => $this->input->post('call_one_avg_call_length'),
					"call_two_avg_call_length" => $this->input->post('call_two_avg_call_length'),
					"call_three_avg_call_length" => $this->input->post('call_three_avg_call_length'),
					"review_avg_call_length" => $this->input->post('review_avg_call_length'),
					"score_avg_call_length" => $this->input->post('score_avg_call_length'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_purity_care_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_purity_care_feedback',$field_array1);
			///////////

				redirect('qa_ameridial/purity_care/');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	} */

////////////////////////// New Purity ////////////////////////////
	public function add_new_puritycare($pcare_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_care/add_new_puritycare.php";
			$data['pcare_id']=$pcare_id;
			$tl_mgnt_cond='';

			//$data["xpoid"]=$this->Common_model->get_single_value("Select xpoid as value from signin where id='$current_user'");

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and is_assign_process(id,273) and dept_id=6 and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

		
			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin st where st.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_puritycare_new_feedback where id='$pcare_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["purity_new_data"] = $this->Common_model->get_query_row_array($qSql);
			// print_r($data["purity_new_data"]);
			// die();
			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){

				$field_array=array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"voc" => $this->input->post('voc'),

					"voc1" => $this->input->post('voc1'),
					"voc2" => $this->input->post('voc2'),
					"voc3" => $this->input->post('voc3'),
					"voc4" => $this->input->post('voc4'),
					"voc5" => $this->input->post('voc5'),
					"call_date1" => mmddyy2mysql($this->input->post('call_date1')),
					"call_date2" => mmddyy2mysql($this->input->post('call_date2')),
					"call_date3" => mmddyy2mysql($this->input->post('call_date3')),
					"call_date4" => mmddyy2mysql($this->input->post('call_date4')),
					"call_date5" => mmddyy2mysql($this->input->post('call_date5')),
					"file_no1" => $this->input->post('file_no1'),
					"file_no2" => $this->input->post('file_no2'),
					"file_no3" => $this->input->post('file_no3'),
					"file_no4" => $this->input->post('file_no4'),
					"file_no5" => $this->input->post('file_no5'),
					"call_duration1" => $this->input->post('call_duration1'),
					"call_duration2" => $this->input->post('call_duration2'),
					"call_duration3" => $this->input->post('call_duration3'),
					"call_duration4" => $this->input->post('call_duration4'),
					"call_duration5" => $this->input->post('call_duration5'),

					"call1_score" => $this->input->post('call1_score'),
					"call2_score" => $this->input->post('call2_score'),
					"call3_score" => $this->input->post('call3_score'),
					"call4_score" => $this->input->post('call4_score'),
					"call5_score" => $this->input->post('call5_score'),
					"agent_identification_call1" => $this->input->post('agent_identification_call1'),
					"agent_identification_call2" => $this->input->post('agent_identification_call2'),
					"agent_identification_call3" => $this->input->post('agent_identification_call3'),
					"agent_identification_call4" => $this->input->post('agent_identification_call4'),
					"agent_identification_call5" => $this->input->post('agent_identification_call5'),
					"customer_identification_call1" => $this->input->post('customer_identification_call1'),
					"customer_identification_call2" => $this->input->post('customer_identification_call2'),
					"customer_identification_call3" => $this->input->post('customer_identification_call3'),
					"customer_identification_call4" => $this->input->post('customer_identification_call4'),
					"customer_identification_call5" => $this->input->post('customer_identification_call5'),
					"customer_verification_call1" => $this->input->post('customer_verification_call1'),
					"customer_verification_call2" => $this->input->post('customer_verification_call2'),
					"customer_verification_call3" => $this->input->post('customer_verification_call3'),
					"customer_verification_call4" => $this->input->post('customer_verification_call4'),
					"customer_verification_call5" => $this->input->post('customer_verification_call5'),
					"opening_question_call1" => $this->input->post('opening_question_call1'),
					"opening_question_call2" => $this->input->post('opening_question_call2'),
					"opening_question_call3" => $this->input->post('opening_question_call3'),
					"opening_question_call4" => $this->input->post('opening_question_call4'),
					"opening_question_call5" => $this->input->post('opening_question_call5'),
					"identify_reason_call1" => $this->input->post('identify_reason_call1'),
					"identify_reason_call2" => $this->input->post('identify_reason_call2'),
					"identify_reason_call3" => $this->input->post('identify_reason_call3'),
					"identify_reason_call4" => $this->input->post('identify_reason_call4'),
					"identify_reason_call5" => $this->input->post('identify_reason_call5'),
					"acknowledge_responce_call1" => $this->input->post('acknowledge_responce_call1'),
					"acknowledge_responce_call2" => $this->input->post('acknowledge_responce_call2'),
					"acknowledge_responce_call3" => $this->input->post('acknowledge_responce_call3'),
					"acknowledge_responce_call4" => $this->input->post('acknowledge_responce_call4'),
					"acknowledge_responce_call5" => $this->input->post('acknowledge_responce_call5'),
					"inquiry_probing_call1" => $this->input->post('inquiry_probing_call1'),
					"inquiry_probing_call2" => $this->input->post('inquiry_probing_call2'),
					"inquiry_probing_call3" => $this->input->post('inquiry_probing_call3'),
					"inquiry_probing_call4" => $this->input->post('inquiry_probing_call4'),
					"inquiry_probing_call5" => $this->input->post('inquiry_probing_call5'),
					"value_proposition_call1" => $this->input->post('value_proposition_call1'),
					"value_proposition_call2" => $this->input->post('value_proposition_call2'),
					"value_proposition_call3" => $this->input->post('value_proposition_call3'),
					"value_proposition_call4" => $this->input->post('value_proposition_call4'),
					"value_proposition_call5" => $this->input->post('value_proposition_call5'),
					"1st_retention_call1" => $this->input->post('1st_retention_call1'),
					"1st_retention_call2" => $this->input->post('1st_retention_call2'),
					"1st_retention_call3" => $this->input->post('1st_retention_call3'),
					"1st_retention_call4" => $this->input->post('1st_retention_call4'),
					"1st_retention_call5" => $this->input->post('1st_retention_call5'),
					"tactical_hold_call1" => $this->input->post('tactical_hold_call1'),
					"tactical_hold_call2" => $this->input->post('tactical_hold_call2'),
					"tactical_hold_call3" => $this->input->post('tactical_hold_call3'),
					"tactical_hold_call4" => $this->input->post('tactical_hold_call4'),
					"tactical_hold_call5" => $this->input->post('tactical_hold_call5'),
					"2nd_retention_call1" => $this->input->post('2nd_retention_call1'),
					"2nd_retention_call2" => $this->input->post('2nd_retention_call2'),
					"2nd_retention_call3" => $this->input->post('2nd_retention_call3'),
					"2nd_retention_call4" => $this->input->post('2nd_retention_call4'),
					"2nd_retention_call5" => $this->input->post('2nd_retention_call5'),
					"delay_length_call1" => $this->input->post('delay_length_call1'),
					"delay_length_call2" => $this->input->post('delay_length_call2'),
					"delay_length_call3" => $this->input->post('delay_length_call3'),
					"delay_length_call4" => $this->input->post('delay_length_call4'),
					"delay_length_call5" => $this->input->post('delay_length_call5'),
					"supersaver_call1" => $this->input->post('supersaver_call1'),
					"supersaver_call2" => $this->input->post('supersaver_call2'),
					"supersaver_call3" => $this->input->post('supersaver_call3'),
					"supersaver_call4" => $this->input->post('supersaver_call4'),
					"supersaver_call5" => $this->input->post('supersaver_call5'),
					"daily_special_call1" => $this->input->post('daily_special_call1'),
					"daily_special_call2" => $this->input->post('daily_special_call2'),
					"daily_special_call3" => $this->input->post('daily_special_call3'),
					"daily_special_call4" => $this->input->post('daily_special_call4'),
					"daily_special_call5" => $this->input->post('daily_special_call5'),
					"closing_statement_call1" => $this->input->post('closing_statement_call1'),
					"closing_statement_call2" => $this->input->post('closing_statement_call2'),
					"closing_statement_call3" => $this->input->post('closing_statement_call3'),
					"closing_statement_call4" => $this->input->post('closing_statement_call4'),
					"closing_statement_call5" => $this->input->post('closing_statement_call5'),
					"full_conf_call1" => $this->input->post('full_conf_call1'),
					"full_conf_call2" => $this->input->post('full_conf_call2'),
					"full_conf_call3" => $this->input->post('full_conf_call3'),
					"full_conf_call4" => $this->input->post('full_conf_call4'),
					"full_conf_call5" => $this->input->post('full_conf_call5'),
					"made_offer_call1" => $this->input->post('made_offer_call1'),
					"made_offer_call2" => $this->input->post('made_offer_call2'),
					"made_offer_call3" => $this->input->post('made_offer_call3'),
					"made_offer_call4" => $this->input->post('made_offer_call4'),
					"made_offer_call5" => $this->input->post('made_offer_call5'),
					"web_login_call1" => $this->input->post('web_login_call1'),
					"web_login_call2" => $this->input->post('web_login_call2'),
					"web_login_call3" => $this->input->post('web_login_call3'),
					"web_login_call4" => $this->input->post('web_login_call4'),
					"web_login_call5" => $this->input->post('web_login_call5'),
					"email_capture_call1" => $this->input->post('email_capture_call1'),
					"email_capture_call2" => $this->input->post('email_capture_call2'),
					"email_capture_call3" => $this->input->post('email_capture_call3'),
					"email_capture_call4" => $this->input->post('email_capture_call4'),
					"email_capture_call5" => $this->input->post('email_capture_call5'),
					"sms_opt_call1" => $this->input->post('sms_opt_call1'),
					"sms_opt_call2" => $this->input->post('sms_opt_call2'),
					"sms_opt_call3" => $this->input->post('sms_opt_call3'),
					"sms_opt_call4" => $this->input->post('sms_opt_call4'),
					"sms_opt_call5" => $this->input->post('sms_opt_call5'),
					"reason_code_call1" => $this->input->post('reason_code_call1'),
					"reason_code_call2" => $this->input->post('reason_code_call2'),
					"reason_code_call3" => $this->input->post('reason_code_call3'),
					"reason_code_call4" => $this->input->post('reason_code_call4'),
					"reason_code_call5" => $this->input->post('reason_code_call5'),
					"used_purity_call1" => $this->input->post('used_purity_call1'),
					"used_purity_call2" => $this->input->post('used_purity_call2'),
					"used_purity_call3" => $this->input->post('used_purity_call3'),
					"used_purity_call4" => $this->input->post('used_purity_call4'),
					"used_purity_call5" => $this->input->post('used_purity_call5'),
					"information_accuracy_call1" => $this->input->post('information_accuracy_call1'),
					"information_accuracy_call2" => $this->input->post('information_accuracy_call2'),
					"information_accuracy_call3" => $this->input->post('information_accuracy_call3'),
					"information_accuracy_call4" => $this->input->post('information_accuracy_call4'),
					"information_accuracy_call5" => $this->input->post('information_accuracy_call5'),
					"soft_skill_call1" => $this->input->post('soft_skill_call1'),
					"soft_skill_call2" => $this->input->post('soft_skill_call2'),
					"soft_skill_call3" => $this->input->post('soft_skill_call3'),
					"soft_skill_call4" => $this->input->post('soft_skill_call4'),
					"soft_skill_call5" => $this->input->post('soft_skill_call5'),
					"rapport_call1" => $this->input->post('rapport_call1'),
					"rapport_call2" => $this->input->post('rapport_call2'),
					"rapport_call3" => $this->input->post('rapport_call3'),
					"rapport_call4" => $this->input->post('rapport_call4'),
					"rapport_call5" => $this->input->post('rapport_call5'),
					"call_control_call1" => $this->input->post('call_control_call1'),
					"call_control_call2" => $this->input->post('call_control_call2'),
					"call_control_call3" => $this->input->post('call_control_call3'),
					"call_control_call4" => $this->input->post('call_control_call4'),
					"call_control_call5" => $this->input->post('call_control_call5'),
					"unauthorized_shipment_call1" => $this->input->post('unauthorized_shipment_call1'),
					"unauthorized_shipment_call2" => $this->input->post('unauthorized_shipment_call2'),
					"unauthorized_shipment_call3" => $this->input->post('unauthorized_shipment_call3'),
					"unauthorized_shipment_call4" => $this->input->post('unauthorized_shipment_call4'),
					"unauthorized_shipment_call5" => $this->input->post('unauthorized_shipment_call5'),
					"inappropiate_language_call1" => $this->input->post('inappropiate_language_call1'),
					"inappropiate_language_call2" => $this->input->post('inappropiate_language_call2'),
					"inappropiate_language_call3" => $this->input->post('inappropiate_language_call3'),
					"inappropiate_language_call4" => $this->input->post('inappropiate_language_call4'),
					"inappropiate_language_call5" => $this->input->post('inappropiate_language_call5'),
					"hanging_up_call1" => $this->input->post('hanging_up_call1'),
					"hanging_up_call2" => $this->input->post('hanging_up_call2'),
					"hanging_up_call3" => $this->input->post('hanging_up_call3'),
					"hanging_up_call4" => $this->input->post('hanging_up_call4'),
					"hanging_up_call5" => $this->input->post('hanging_up_call5'),
					"badgering_call1" => $this->input->post('badgering_call1'),
					"badgering_call2" => $this->input->post('badgering_call2'),
					"badgering_call3" => $this->input->post('badgering_call3'),
					"badgering_call4" => $this->input->post('badgering_call4'),
					"badgering_call5" => $this->input->post('badgering_call5'),
					"action_autofail_call1" => $this->input->post('action_autofail_call1'),
					"action_autofail_call2" => $this->input->post('action_autofail_call2'),
					"action_autofail_call3" => $this->input->post('action_autofail_call3'),
					"action_autofail_call4" => $this->input->post('action_autofail_call4'),
					"action_autofail_call5" => $this->input->post('action_autofail_call5'),
					"health_claim_call1" => $this->input->post('health_claim_call1'),
					"health_claim_call2" => $this->input->post('health_claim_call2'),
					"health_claim_call3" => $this->input->post('health_claim_call3'),
					"health_claim_call4" => $this->input->post('health_claim_call4'),
					"health_claim_call5" => $this->input->post('health_claim_call5'),
					"no_confirmation1" => $this->input->post('no_confirmation1'),
					"no_confirmation2" => $this->input->post('no_confirmation2'),
					"no_confirmation3" => $this->input->post('no_confirmation3'),
					"no_confirmation4" => $this->input->post('no_confirmation4'),
					"no_confirmation5" => $this->input->post('no_confirmation5'),
					"no_retention1" => $this->input->post('no_retention1'),
					"no_retention2" => $this->input->post('no_retention2'),
					"no_retention3" => $this->input->post('no_retention3'),
					"no_retention4" => $this->input->post('no_retention4'),
					"no_retention5" => $this->input->post('no_retention5'),
					"call_summary1" => $this->input->post('call_summary1'),
					"call_summary2" => $this->input->post('call_summary2'),
					"call_summary3" => $this->input->post('call_summary3'),
					"call_summary4" => $this->input->post('call_summary4'),
					"call_summary5" => $this->input->post('call_summary5'),
					"feedback1" => $this->input->post('feedback1'),
					"feedback2" => $this->input->post('feedback2'),
					"feedback3" => $this->input->post('feedback3'),
					"feedback4" => $this->input->post('feedback4'),
					"feedback5" => $this->input->post('feedback5')
				);


				if($pcare_id==0){

					$upl_arr = array('attach_file1','attach_file2','attach_file3','attach_file4','attach_file5');
					foreach($upl_arr as $value){
						$a = $this->amd_upload_files($_FILES[$value],$path='./qa_files/qa_ameridial/purity_care/pcare_new/');
						$field_array[$value] = implode(',',$a);
					}
					$rowid= data_inserter('qa_amd_puritycare_new_feedback',$field_array);
					/////////
					$field_array2 = array(
						"audit_date" => CurrDate(),
						"entry_date" => $curDateTime,
						"audit_start_time" => $this->input->post('audit_start_time')
					);
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_puritycare_new_feedback',$field_array2);
				///////////////////////
					if(get_user_fusion_id()=='FACC000045' || get_user_fusion_id()=='FACC000046' || get_user_fusion_id()=='FACC000044' || get_user_fusion_id()=='FNCC000021' || get_user_fusion_id()=='FNCC000022' || get_user_fusion_id()=='FKOL000023'){
						$field_array1 = array("client_entryby" => $current_user);
					}else{
						$field_array1 = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_puritycare_new_feedback',$field_array1);

				}else{

					$this->db->where('id', $pcare_id);
					$this->db->update('qa_amd_puritycare_new_feedback',$field_array);
					/////////
					if(get_login_type()=="client"){
						$field_array1 = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$field_array1 = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $pcare_id);
					$this->db->update('qa_amd_puritycare_new_feedback',$field_array1);

				}

				redirect('qa_ameridial/purity_care');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


////////////////////////////////////////////////////////////////////////////////
	/*----------------------- CONSCIOUS SELLING ----------------------------*/
	public function purity_conscious_selling(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_care/conscious_selling/purity_conscious_selling.php";

			$off_sql="Select * from office_location where is_active=1";
			$data['location_list'] =  $this->Common_model->get_query_result_array($off_sql);

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and dept_id=6 and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$office_id = $this->input->get('office_id');
			$asc_desc = $this->input->get('asc_desc');
			$cn_call1 = $this->input->get('cn_call1');
			$cond="";
			$cond1="";
			$agent_fd_cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($office_id !="")	$cond .=" and office_id='$office_id'";
			if($cn_call1 !="")	$cond .=" and customer_no like '%$cn_call1%'";

			if($asc_desc !="")	$cond1 .=" order by audit_date asc, overall_score $asc_desc";

			/* if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else if(get_login_type()=="client"){
				$ops_cond=" Where audit_type not in ('Operation Audit','Trainer Audit')";
			}else{
				$ops_cond="";
			} */

			/////// Agent Acceptance //////////
			if($from_date !="" && $to_date!=="" )  $agent_fd_cond .=" and (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$agent_fd_cond .=" and agent_id='$agent_id'";
			if($office_id !="")	$agent_fd_cond .=" and office_id='$office_id'";
			if($cn_call1 !="")	$agent_fd_cond .=" and customer_no like '%$cn_call1%'";

			$qSql="Select count(pc.id) as value from qa_purity_consciuos_selling_feedback pc left join signin s on s.id=pc.agent_id where audit_type in ('CQ Audit', 'BQ Audit') $agent_fd_cond";
			$data["tot_audit"] =  $this->Common_model->get_single_value($qSql);
			$qSql="Select count(pc.id) as value from qa_purity_consciuos_selling_feedback pc left join signin s on s.id=pc.agent_id where audit_type in ('CQ Audit', 'BQ Audit') and agent_fd_acpt='Accepted' $agent_fd_cond";
			$data["agent_acpt"] =  $this->Common_model->get_single_value($qSql);
		///////////////

			$avg_tot_score_sql="Select AVG(pc.overall_score) as value from qa_purity_consciuos_selling_feedback pc left join signin s on s.id=pc.agent_id $cond ";
			$data["agv_tot_score"] = $this->Common_model->get_single_value($avg_tot_score_sql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin st where st.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_purity_consciuos_selling_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, get_client_ids(id) as client, get_process_ids(id) as pid, get_process_names(id) as process, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1";
			$data["conscious_selling"] = $this->Common_model->get_query_result_array($qSql);


			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["office_id"] = $office_id;
			$data["asc_desc"] = $asc_desc;
			$data["cn_call1"] = $cn_call1;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_conscious_selling($clf_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/purity_care/conscious_selling/add_edit_conscious_selling.php";
			$data['clf_id']=$clf_id;

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin st where st.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_purity_consciuos_selling_feedback where id='$clf_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process, dept_id, (select description from department d where d.id=signin.dept_id) as dept_name from signin) yy on (xx.agent_id=yy.sid)";
			$data["conscious_selling"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";
			if($field_array['agent_id']){

				if($clf_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/purity_care/conscious_selling/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_purity_consciuos_selling_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_purity_consciuos_selling_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $clf_id);
					$this->db->update('qa_purity_consciuos_selling_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $clf_id);
					$this->db->update('qa_purity_consciuos_selling_feedback',$edit_array);

				}
				redirect('qa_ameridial/purity_conscious_selling');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

/********************************************************/
/**********PURITY CARE END****************************/
/********************************************************/

/********************************************************/
/**************JFMI START****************************/
/********************************************************/
	public function jfmi_feedback()
	{
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/jfmi/qa_feedback.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_jfmi_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)
				$ops_cond order by audit_date";
			$data["purity_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_jfmi(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/jfmi/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"overall_score" => $this->input->post('overall_score'),
					"greets_customer_promptly"	=>	$this->input->post('greets_customer_promptly'),
					"uses_professionalism"	=>	$this->input->post('uses_professionalism'),
					"shows_gratitude"	=>	$this->input->post('shows_gratitude'),
					"collects_and_verifies_customer_information"	=>	$this->input->post('collects_and_verifies_customer_information'),
					"follows_correct_scripting_path"	=>	$this->input->post('follows_correct_scripting_path'),
					"collects_information_to_provide_to_partner_relations"	=>	$this->input->post('collects_information_to_provide_to_partner_relations'),
					"covers_all_payment_scripting"	=>	$this->input->post('covers_all_payment_scripting'),
					"maintains_call_control"	=>	$this->input->post('maintains_call_control'),
					"keeps_dead_air_to_minimum"	=>	$this->input->post('keeps_dead_air_to_minimum'),
					"uses_faq_agent_note"	=>	$this->input->post('uses_faq_agent_note'),
					"brands_the_call_with_proper_close"	=>	$this->input->post('brands_the_call_with_proper_close'),
					"stop_recording"	=>	$this->input->post('stop_recording'),
					"read_legal_script"	=>	$this->input->post('read_legal_script'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/jfmi/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_jfmi_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_jfmi_feedback',$field_array1);
			///////////
				redirect('qa_ameridial/jfmi_feedback/');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_jfmi_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/jfmi/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_amd_jfmi_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["jfmi_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["jfmiid"]=$id;

			if($this->input->post('jfmiid'))
			{
				$jfmiid=$this->input->post('jfmiid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"overall_score" => $this->input->post('overall_score'),
					"greets_customer_promptly"	=>	$this->input->post('greets_customer_promptly'),
					"uses_professionalism"	=>	$this->input->post('uses_professionalism'),
					"shows_gratitude"	=>	$this->input->post('shows_gratitude'),
					"collects_and_verifies_customer_information"	=>	$this->input->post('collects_and_verifies_customer_information'),
					"follows_correct_scripting_path"	=>	$this->input->post('follows_correct_scripting_path'),
					"collects_information_to_provide_to_partner_relations"	=>	$this->input->post('collects_information_to_provide_to_partner_relations'),
					"covers_all_payment_scripting"	=>	$this->input->post('covers_all_payment_scripting'),
					"maintains_call_control"	=>	$this->input->post('maintains_call_control'),
					"keeps_dead_air_to_minimum"	=>	$this->input->post('keeps_dead_air_to_minimum'),
					"uses_faq_agent_note"	=>	$this->input->post('uses_faq_agent_note'),
					"brands_the_call_with_proper_close"	=>	$this->input->post('brands_the_call_with_proper_close'),
					"stop_recording"	=>	$this->input->post('stop_recording'),
					"read_legal_script"	=>	$this->input->post('read_legal_script'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $jfmiid);
				$this->db->update('qa_amd_jfmi_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $jfmiid);
				$this->db->update('qa_amd_jfmi_feedback',$field_array1);
			///////////
				redirect('qa_ameridial/jfmi_feedback/');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
/********************************************************/
/**********JFMI END****************************/
/********************************************************/

///////////////////////////////////////////////////////////////////////////////////
/*------------------------- Hoveround (Start) ----------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function hoveround_feedback(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/hoveround/hoveround_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_hoveround_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)  $ops_cond order by audit_date";
			$data["hoveround_data"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_hoveround_jam_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)  $ops_cond order by audit_date";
			$data["hoveround_jam_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_hoveround(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/hoveround/add_hoveround.php";
			// $data["content_js"] = "qa_ameridial_healthcare_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"cust_score" => $this->input->post('cust_score'),
					"busi_score" => $this->input->post('busi_score'),
					"comp_score" => $this->input->post('comp_score'),
					"agentreadyforcall" => $this->input->post('agentreadyforcall'),
					"agentgiveintro" => $this->input->post('agentgiveintro'),
					"agentcorrectprobe" => $this->input->post('agentcorrectprobe'),
					// "agentverifycustomer" => $this->input->post('agentverifycustomer'),
					"agentclosecall" => $this->input->post('agentclosecall'),
					"agentdisposition" => $this->input->post('agentdisposition'),
					"dead_air" => $this->input->post('dead_air'),
					"agentpolite" => $this->input->post('agentpolite'),
					"agentshowenergy" => $this->input->post('agentshowenergy'),
					"agenthavegoodtone" => $this->input->post('agenthavegoodtone'),
					"agentgiveaccurateinfo" => $this->input->post('agentgiveaccurateinfo'),
					"email_address" => $this->input->post('email_address'),
					"lead_properly" => $this->input->post('lead_properly'),
					"Rude_Remarks" => $this->input->post('Rude_Remarks'),
					"Avoidance" => $this->input->post('Avoidance'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/hoveround/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_hoveround_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_hoveround_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/hoveround_feedback');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_hoveround_jam(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/hoveround/add_hoveround_jam.php";
			// $data["content_js"] = "qa_ameridial_healthcare_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_process(id,'782,783') and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"file_no" => $this->input->post('file_no'),
					"rca" => $this->input->post('rca'),
					"l1" => $this->input->post('l1'),
					"l2" => $this->input->post('l2'),
					"incontact" => $this->input->post('incontact'),
					"crm_id" => $this->input->post('crm_id'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					// "cust_score" => $this->input->post('cust_score'),
					// "busi_score" => $this->input->post('busi_score'),
					// "comp_score" => $this->input->post('comp_score'),
					"agentreadyforcall" => $this->input->post('agentreadyforcall'),
					"agentgiveintro" => $this->input->post('agentgiveintro'),
					"agentcorrectprobe" => $this->input->post('agentcorrectprobe'),
					"agentverifycustomer" => $this->input->post('agentverifycustomer'),
					"agentclosecall" => $this->input->post('agentclosecall'),
					"agentdisposition" => $this->input->post('agentdisposition'),
					"dead_air" => $this->input->post('dead_air'),
					"agentpolite" => $this->input->post('agentpolite'),
					"agentshowenergy" => $this->input->post('agentshowenergy'),
					"agenthavegoodtone" => $this->input->post('agenthavegoodtone'),
					"agentgiveaccurateinfo" => $this->input->post('agentgiveaccurateinfo'),
					"email_address" => $this->input->post('email_address'),
					"lead_properly" => $this->input->post('lead_properly'),
					"Rude_Remarks" => $this->input->post('Rude_Remarks'),
					"Avoidance" => $this->input->post('Avoidance'),
					"warm_transfer" => $this->input->post('warm_transfer'),
					"client_questions" => $this->input->post('client_questions'),
					"product_knowledge" => $this->input->post('product_knowledge'),
					"professional_manner" => $this->input->post('professional_manner'),
					"during_call" => $this->input->post('during_call'),
					"talking_over" => $this->input->post('talking_over'),
					"speak" => $this->input->post('speak'),
					"empathetic" => $this->input->post('empathetic'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/hoveround/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_hoveround_jam_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_hoveround_jam_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/hoveround_feedback');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_hoveround_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/hoveround/mgnt_hoveround_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_amd_hoveround_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["hoveround_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["hndid"]=$id;

			if($this->input->post('hndid'))
			{
				$hndid=$this->input->post('hndid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"cust_score" => $this->input->post('cust_score'),
					"busi_score" => $this->input->post('busi_score'),
					"comp_score" => $this->input->post('comp_score'),
					"agentreadyforcall" => $this->input->post('agentreadyforcall'),
					"agentgiveintro" => $this->input->post('agentgiveintro'),
					"agentcorrectprobe" => $this->input->post('agentcorrectprobe'),
					// "agentverifycustomer" => $this->input->post('agentverifycustomer'),
					"agentclosecall" => $this->input->post('agentclosecall'),
					"agentdisposition" => $this->input->post('agentdisposition'),
					"dead_air" => $this->input->post('dead_air'),
					"agentpolite" => $this->input->post('agentpolite'),
					"agentshowenergy" => $this->input->post('agentshowenergy'),
					"agenthavegoodtone" => $this->input->post('agenthavegoodtone'),
					"agentgiveaccurateinfo" => $this->input->post('agentgiveaccurateinfo'),
					"email_address" => $this->input->post('email_address'),
					"lead_properly" => $this->input->post('lead_properly'),
					"Rude_Remarks" => $this->input->post('Rude_Remarks'),
					"Avoidance" => $this->input->post('Avoidance'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $hndid);
				$this->db->update('qa_amd_hoveround_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $hndid);
				$this->db->update('qa_amd_hoveround_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/hoveround_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}

	public function mgnt_hoveround_jam_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/hoveround/mgnt_hoveround_jam_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_process(id,'782,783') and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_amd_hoveround_jam_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["hoveround_jam_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["hndid"]=$id;

			if($this->input->post('hndid'))
			{
				$hndid=$this->input->post('hndid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"rca" => $this->input->post('rca'),
					"l1" => $this->input->post('l1'),
					"l2" => $this->input->post('l2'),
					"incontact" => $this->input->post('incontact'),
					"crm_id" => $this->input->post('crm_id'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					// "cust_score" => $this->input->post('cust_score'),
					// "busi_score" => $this->input->post('busi_score'),
					// "comp_score" => $this->input->post('comp_score'),
					"agentreadyforcall" => $this->input->post('agentreadyforcall'),
					"agentgiveintro" => $this->input->post('agentgiveintro'),
					"agentcorrectprobe" => $this->input->post('agentcorrectprobe'),
					"agentverifycustomer" => $this->input->post('agentverifycustomer'),
					"agentclosecall" => $this->input->post('agentclosecall'),
					"agentdisposition" => $this->input->post('agentdisposition'),
					"dead_air" => $this->input->post('dead_air'),
					"agentpolite" => $this->input->post('agentpolite'),
					"agentshowenergy" => $this->input->post('agentshowenergy'),
					"agenthavegoodtone" => $this->input->post('agenthavegoodtone'),
					"agentgiveaccurateinfo" => $this->input->post('agentgiveaccurateinfo'),
					"email_address" => $this->input->post('email_address'),
					"lead_properly" => $this->input->post('lead_properly'),
					"Rude_Remarks" => $this->input->post('Rude_Remarks'),
					"Avoidance" => $this->input->post('Avoidance'),
					"warm_transfer" => $this->input->post('warm_transfer'),
					"client_questions" => $this->input->post('client_questions'),
					"product_knowledge" => $this->input->post('product_knowledge'),
					"professional_manner" => $this->input->post('professional_manner'),
					"during_call" => $this->input->post('during_call'),
					"talking_over" => $this->input->post('talking_over'),
					"speak" => $this->input->post('speak'),
					"empathetic" => $this->input->post('empathetic'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $hndid);
				$this->db->update('qa_amd_hoveround_jam_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $hndid);
				$this->db->update('qa_amd_hoveround_jam_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/hoveround_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Hoveround (End) --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*------------------------- NCPSSM (Start) ----------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function ncpssm_feedback(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ncpssm/ncpssm_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_ncpssm_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)
				$ops_cond order by audit_date";
			$data["ncpssm_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_ncpssm(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ncpssm/add_ncpssm.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"introcaller" => $this->input->post('introcaller'),
					"introopenning" => $this->input->post('introopenning'),
					"scriptgathered" => $this->input->post('scriptgathered'),
					"scriptemail" => $this->input->post('scriptemail'),
					"scriptstatement" => $this->input->post('scriptstatement'),
					"scriptmedicareissue" => $this->input->post('scriptmedicareissue'),
					"scriptpersonalizecall" => $this->input->post('scriptpersonalizecall'),
					"scriptcallersupport" => $this->input->post('scriptcallersupport'),
					"toneenthusiasm" => $this->input->post('toneenthusiasm'),
					"toneproperpace" => $this->input->post('toneproperpace'),
					"tonecontroldeadair" => $this->input->post('tonecontroldeadair'),
					"tonespokeclearly" => $this->input->post('tonespokeclearly'),
					"tonegoodlistening" => $this->input->post('tonegoodlistening'),
					"toneempathized" => $this->input->post('toneempathized'),
					"toneprofessionalism" => $this->input->post('toneprofessionalism'),
					"closecallconslusion" => $this->input->post('closecallconslusion'),
					"closecorrectinfo" => $this->input->post('closecorrectinfo'),
					"closeconfirmcaller" => $this->input->post('closeconfirmcaller'),
					"autofailinfo" => $this->input->post('autofailinfo'),
					"autofailhungup" => $this->input->post('autofailhungup'),
					"autofailbehaviour" => $this->input->post('autofailbehaviour'),
					"autofaillanguage" => $this->input->post('autofaillanguage'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_by" => $current_user,
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/ncpssm/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_ncpssm_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_ncpssm_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/ncpssm_feedback');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_ncpssm_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ncpssm/mgnt_ncpssm_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_amd_ncpssm_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["ncpssm_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["ncpid"]=$id;


			if($this->input->post('ncpid'))
			{
				$ncpid=$this->input->post('ncpid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"introcaller" => $this->input->post('introcaller'),
					"introopenning" => $this->input->post('introopenning'),
					"scriptgathered" => $this->input->post('scriptgathered'),
					"scriptemail" => $this->input->post('scriptemail'),
					"scriptstatement" => $this->input->post('scriptstatement'),
					"scriptmedicareissue" => $this->input->post('scriptmedicareissue'),
					"scriptpersonalizecall" => $this->input->post('scriptpersonalizecall'),
					"scriptcallersupport" => $this->input->post('scriptcallersupport'),
					"toneenthusiasm" => $this->input->post('toneenthusiasm'),
					"toneproperpace" => $this->input->post('toneproperpace'),
					"tonecontroldeadair" => $this->input->post('tonecontroldeadair'),
					"tonespokeclearly" => $this->input->post('tonespokeclearly'),
					"tonegoodlistening" => $this->input->post('tonegoodlistening'),
					"toneempathized" => $this->input->post('toneempathized'),
					"toneprofessionalism" => $this->input->post('toneprofessionalism'),
					"closecallconslusion" => $this->input->post('closecallconslusion'),
					"closecorrectinfo" => $this->input->post('closecorrectinfo'),
					"closeconfirmcaller" => $this->input->post('closeconfirmcaller'),
					"autofailinfo" => $this->input->post('autofailinfo'),
					"autofailhungup" => $this->input->post('autofailhungup'),
					"autofailbehaviour" => $this->input->post('autofailbehaviour'),
					"autofaillanguage" => $this->input->post('autofaillanguage'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $ncpid);
				$this->db->update('qa_amd_ncpssm_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $ncpid);
				$this->db->update('qa_amd_ncpssm_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/ncpssm_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- NCPSSM (End) --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*------------------------- STC Scoresheet (Start) ----------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function stc_feedback(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/stc/stc_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_stc_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)
				$ops_cond order by audit_date";
			$data["stc_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_stc(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/stc/add_stc.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentproperintro" => $this->input->post('agentproperintro'),
					"agentcapturedonorname" => $this->input->post('agentcapturedonorname'),
					"agentreadscript" => $this->input->post('agentreadscript'),
					"agentcovermonthlyrequest" => $this->input->post('agentcovermonthlyrequest'),
					"agentcapturedonationamount" => $this->input->post('agentcapturedonationamount'),
					"agentofferpayment" => $this->input->post('agentofferpayment'),
					"agentcapturedonoraddress" => $this->input->post('agentcapturedonoraddress'),
					"agentcapturedonorphone" => $this->input->post('agentcapturedonorphone'),
					"agentcapturedonoremail" => $this->input->post('agentcapturedonoremail'),
					"agentproperlyrebuttals" => $this->input->post('agentproperlyrebuttals'),
					"agentfollowscript" => $this->input->post('agentfollowscript'),
					"agentshowfamiliarity" => $this->input->post('agentshowfamiliarity'),
					"agentusescriptnavigation" => $this->input->post('agentusescriptnavigation'),
					"agentfollowproperclose" => $this->input->post('agentfollowproperclose'),
					"agentuseeffectivecommunication" => $this->input->post('agentuseeffectivecommunication'),
					"agentmaintaincontrol" => $this->input->post('agentmaintaincontrol'),
					"agentshowappreciation" => $this->input->post('agentshowappreciation'),
					"autofailfalseinfo" => $this->input->post('autofailfalseinfo'),
					"autofailhungup" => $this->input->post('autofailhungup'),
					"autofailagentbehaviuor" => $this->input->post('autofailagentbehaviuor'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/stc/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_stc_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_stc_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/stc_feedback');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_stc_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/stc/mgnt_stc_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			from qa_amd_stc_feedback where id='$id') xx Left Join
			(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["stc_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["stcid"]=$id;

			if($this->input->post('stcid'))
			{
				$stcid=$this->input->post('stcid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentproperintro" => $this->input->post('agentproperintro'),
					"agentcapturedonorname" => $this->input->post('agentcapturedonorname'),
					"agentreadscript" => $this->input->post('agentreadscript'),
					"agentcovermonthlyrequest" => $this->input->post('agentcovermonthlyrequest'),
					"agentcapturedonationamount" => $this->input->post('agentcapturedonationamount'),
					"agentofferpayment" => $this->input->post('agentofferpayment'),
					"agentcapturedonoraddress" => $this->input->post('agentcapturedonoraddress'),
					"agentcapturedonorphone" => $this->input->post('agentcapturedonorphone'),
					"agentcapturedonoremail" => $this->input->post('agentcapturedonoremail'),
					"agentproperlyrebuttals" => $this->input->post('agentproperlyrebuttals'),
					"agentfollowscript" => $this->input->post('agentfollowscript'),
					"agentshowfamiliarity" => $this->input->post('agentshowfamiliarity'),
					"agentusescriptnavigation" => $this->input->post('agentusescriptnavigation'),
					"agentfollowproperclose" => $this->input->post('agentfollowproperclose'),
					"agentuseeffectivecommunication" => $this->input->post('agentuseeffectivecommunication'),
					"agentmaintaincontrol" => $this->input->post('agentmaintaincontrol'),
					"agentshowappreciation" => $this->input->post('agentshowappreciation'),
					"autofailfalseinfo" => $this->input->post('autofailfalseinfo'),
					"autofailhungup" => $this->input->post('autofailhungup'),
					"autofailagentbehaviuor" => $this->input->post('autofailagentbehaviuor'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $stcid);
				$this->db->update('qa_amd_stc_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $stcid);
				$this->db->update('qa_amd_stc_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/stc_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- STC Scoresheet (End) --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- TOUCHFUSE (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function touchfuse(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/touchfuse/tf_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_touchfuse_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["tf_data"] = $this->Common_model->get_query_result_array($qSql);


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_touchfuse_new_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["touchfuse"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_tf(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/touchfuse/add_tf.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"call_status" => $this->input->post('call_status'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"callasnwer" => $this->input->post('callasnwer'),
					"agentanswer" => $this->input->post('agentanswer'),
					"agentzip" => $this->input->post('agentzip'),
					"agentoffer" => $this->input->post('agentoffer'),
					"callerwish" => $this->input->post('callerwish'),
					"agentconfirm" => $this->input->post('agentconfirm'),
					"calleraddress" => $this->input->post('calleraddress'),
					"calleremail" => $this->input->post('calleremail'),
					"agentphone" => $this->input->post('agentphone'),
					"agentsummerize" => $this->input->post('agentsummerize'),
					"registerguest" => $this->input->post('registerguest'),
					"dispocall" => $this->input->post('dispocall'),
					"agentclosing" => $this->input->post('agentclosing'),
					"agenttone" => $this->input->post('agenttone'),
					"activelistening" => $this->input->post('activelistening'),
					"agentprofession" => $this->input->post('agentprofession'),
					"agentknowledge" => $this->input->post('agentknowledge'),
					"callcontrol" => $this->input->post('callcontrol'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/touchfuse/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_touchfuse_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_touchfuse_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/touchfuse');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_tf_new(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/touchfuse/add_tf_new.php";
			$data["content_js"] = "qa_ameridial_healthcare_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);
			
			/******** Randamiser Start***********/
			
			
			$rand_id=0;
			if(!empty($this->uri->segment(3))){
				$rand_id=$this->uri->segment(3);
			}
			$data['rand_id']=$rand_id;
			$data["rand_data"] = "";
			
			
			
			if($rand_id!=0){
				$client_id=134;
				$pro_id = 753;
				$curDateTime=CurrMySqlDate();
				$upArr = array('distribution_opend_by' =>$current_user,'distribution_opened_datetime'=>$curDateTime);
				$this->db->where('id', $rand_id);
				$this->db->update('qa_randamiser_touchfuse_data',$upArr);
				
				$randSql="Select srd.*,srd.aht as call_duration, S.id as sid, S.fname, S.lname, S.xpoid, S.assigned_to,S.office_id,
				(select concat(fname, ' ', lname) as name from signin s1 where s1.id=S.assigned_to) as tl_name,DATEDIFF(CURDATE(), S.doj) as tenure
				from qa_randamiser_touchfuse_data srd Left Join signin S On srd.fusion_id=S.fusion_id where srd.audit_status=0 and srd.id='$rand_id'";
				$data["rand_data"] = $rand_data =  $this->Common_model->get_query_row_array($randSql);
				
			}
			//print_r($data["rand_data"]);
			/******** Randamiser Ends**********/

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"call_status" => $this->input->post('call_status'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"cust_score" => $this->input->post('cust_score'),
					"busi_score" => $this->input->post('busi_score'),
					"comp_score" => $this->input->post('comp_score'),
					"callasnwer" => $this->input->post('callasnwer'),
					"agentanswer" => $this->input->post('agentanswer'),
					"agentzip" => $this->input->post('agentzip'),
					"agentoffer" => $this->input->post('agentoffer'),
					"callerwish" => $this->input->post('callerwish'),
					"agentconfirm" => $this->input->post('agentconfirm'),
					"calleraddress" => $this->input->post('calleraddress'),
					"calleremail" => $this->input->post('calleremail'),
					"agentphone" => $this->input->post('agentphone'),
					"agentsummerize" => $this->input->post('agentsummerize'),
					"registerguest" => $this->input->post('registerguest'),
					"dispocall" => $this->input->post('dispocall'),
					"agentclosing" => $this->input->post('agentclosing'),
					"agenttone" => $this->input->post('agenttone'),
					"activelistening" => $this->input->post('activelistening'),
					"agentprofession" => $this->input->post('agentprofession'),
					"agentknowledge" => $this->input->post('agentknowledge'),
					"callcontrol" => $this->input->post('callcontrol'),
					"Avoidance" => $this->input->post('Avoidance'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/touchfuse/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_touchfuse_new_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_touchfuse_new_feedback',$field_array1);
				
				if($rand_id!=0){					
					$rand_cdr_array = array("audit_status" => 1);
					$this->db->where('id', $rand_id);
					$this->db->update('qa_randamiser_touchfuse_data',$rand_cdr_array);
					
					$rand_array = array("is_rand" => 1);
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_touchfuse_new_feedback',$rand_array);
				}
			///////////
				if(isset($rand_data['upload_date']) && !empty($rand_data['upload_date'])){
					$up_date = date('Y-m-d', strtotime($rand_data['upload_date']));
					redirect('Qa_randamiser/data_distribute_freshdesk?from_date='.$up_date.'&client_id='.$client_id.'&pro_id='.$pro_id.'&submit=Submit');
				}else{
					redirect('Qa_ameridial/touchfuse');
				}
				//redirect('Qa_ameridial/touchfuse');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}




	

	public function mgnt_tf_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/touchfuse/mgnt_tf_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			from qa_amd_touchfuse_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["tf_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["tfid"]=$id;

			if($this->input->post('tfid'))
			{
				$tfid=$this->input->post('tfid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"file_no" => $this->input->post('file_no'),
					"call_status" => $this->input->post('call_status'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"callasnwer" => $this->input->post('callasnwer'),
					"agentanswer" => $this->input->post('agentanswer'),
					"agentzip" => $this->input->post('agentzip'),
					"agentoffer" => $this->input->post('agentoffer'),
					"callerwish" => $this->input->post('callerwish'),
					"agentconfirm" => $this->input->post('agentconfirm'),
					"calleraddress" => $this->input->post('calleraddress'),
					"calleremail" => $this->input->post('calleremail'),
					"agentphone" => $this->input->post('agentphone'),
					"agentsummerize" => $this->input->post('agentsummerize'),
					"registerguest" => $this->input->post('registerguest'),
					"dispocall" => $this->input->post('dispocall'),
					"agentclosing" => $this->input->post('agentclosing'),
					"agenttone" => $this->input->post('agenttone'),
					"activelistening" => $this->input->post('activelistening'),
					"agentprofession" => $this->input->post('agentprofession'),
					"agentknowledge" => $this->input->post('agentknowledge'),
					"callcontrol" => $this->input->post('callcontrol'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $tfid);
				$this->db->update('qa_amd_touchfuse_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $tfid);
				$this->db->update('qa_amd_touchfuse_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/touchfuse');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}


	public function mgnt_tf_rvw_new($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/touchfuse/mgnt_tf_rvw_new.php";
			$data["content_js"] = "qa_ameridial_healthcare_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			from qa_amd_touchfuse_new_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["tf_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["tfid"]=$id;

			if($this->input->post('tfid'))
			{
				$tfid=$this->input->post('tfid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"call_duration" => $this->input->post('call_duration'),
					"file_no" => $this->input->post('file_no'),
					"call_status" => $this->input->post('call_status'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"cust_score" => $this->input->post('cust_score'),
					"busi_score" => $this->input->post('busi_score'),
					"comp_score" => $this->input->post('comp_score'),
					"callasnwer" => $this->input->post('callasnwer'),
					"agentanswer" => $this->input->post('agentanswer'),
					"agentzip" => $this->input->post('agentzip'),
					"agentoffer" => $this->input->post('agentoffer'),
					"callerwish" => $this->input->post('callerwish'),
					"agentconfirm" => $this->input->post('agentconfirm'),
					"calleraddress" => $this->input->post('calleraddress'),
					"calleremail" => $this->input->post('calleremail'),
					"agentphone" => $this->input->post('agentphone'),
					"agentsummerize" => $this->input->post('agentsummerize'),
					"registerguest" => $this->input->post('registerguest'),
					"dispocall" => $this->input->post('dispocall'),
					"agentclosing" => $this->input->post('agentclosing'),
					"agenttone" => $this->input->post('agenttone'),
					"activelistening" => $this->input->post('activelistening'),
					"agentprofession" => $this->input->post('agentprofession'),
					"agentknowledge" => $this->input->post('agentknowledge'),
					"callcontrol" => $this->input->post('callcontrol'),
					"Avoidance" => $this->input->post('Avoidance'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $tfid);
				$this->db->update('qa_amd_touchfuse_new_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $tfid);
				$this->db->update('qa_amd_touchfuse_new_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/touchfuse');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
//////////////////////////////////////////////////////////////////////////
/*-------------------------- TOUCHFUSE (End) ---------------------------*/
//////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*------------------------------ TBN (Start) ------------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function tbn_feedback(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tbn/tbn_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_tbn_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid)
				$ops_cond order by audit_date";
			$data["tbn_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}
	public function add_tbn(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tbn/add_tbn.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"call_id" => $this->input->post('call_id'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"introrecord" => $this->input->post('introrecord'),
					"introcall" => $this->input->post('introcall'),
					"introname" => $this->input->post('introname'),
					"introstate" => $this->input->post('introstate'),
					"introscript" => $this->input->post('introscript'),
					"introdisclose" => $this->input->post('introdisclose'),
					"verifydonor" => $this->input->post('verifydonor'),
					"verifyaddress" => $this->input->post('verifyaddress'),
					"verifyspelled" => $this->input->post('verifyspelled'),
					"verifyemail" => $this->input->post('verifyemail'),
					"verifyback" => $this->input->post('verifyback'),
					"verifyasked" => $this->input->post('verifyasked'),
					"verifyconfirm" => $this->input->post('verifyconfirm'),
					"verifytype" => $this->input->post('verifytype'),
					"verifycell" => $this->input->post('verifycell'),
					"verifyaskalterphn" => $this->input->post('verifyaskalterphn'),
					"verifyalterphn" => $this->input->post('verifyalterphn'),
					"verifyalterno" => $this->input->post('verifyalterno'),
					"verifyconsent" => $this->input->post('verifyconsent'),
					"presentrequest" => $this->input->post('presentrequest'),
					"presenttieroffer" => $this->input->post('presenttieroffer'),
					"presentmonthask" => $this->input->post('presentmonthask'),
					"presentnavigate" => $this->input->post('presentnavigate'),
					"presenttbnknowledge" => $this->input->post('presenttbnknowledge'),
					"presentauthor" => $this->input->post('presentauthor'),
					"presentadherence" => $this->input->post('presentadherence'),
					"cartclosedonation" => $this->input->post('cartclosedonation'),
					"cartcloseamount" => $this->input->post('cartcloseamount'),
					"cartclosemonthly" => $this->input->post('cartclosemonthly'),
					"cartcloseresource" => $this->input->post('cartcloseresource'),
					"cartclosescript" => $this->input->post('cartclosescript'),
					"callhandleclearly" => $this->input->post('callhandleclearly'),
					"callhandledemeanor" => $this->input->post('callhandledemeanor'),
					"callhandlepace" => $this->input->post('callhandlepace'),
					"callhandlelisten" => $this->input->post('callhandlelisten'),
					"callhandleexhibit" => $this->input->post('callhandleexhibit'),
					"callhandlecommunicate" => $this->input->post('callhandlecommunicate'),
					"callhandlecontrol" => $this->input->post('callhandlecontrol'),
					"autofinfo" => $this->input->post('autofinfo'),
					"autofcall" => $this->input->post('autofcall'),
					"autofbehaviour" => $this->input->post('autofbehaviour'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/tbn/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_tbn_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_tbn_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/tbn_feedback');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}



	public function mgnt_tbn_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tbn/mgnt_tbn_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			from qa_amd_tbn_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["tbn_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["tbnid"]=$id;

			if($this->input->post('tbnid'))
			{
				$tbnid=$this->input->post('tbnid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"call_id" => $this->input->post('call_id'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"introrecord" => $this->input->post('introrecord'),
					"introcall" => $this->input->post('introcall'),
					"introname" => $this->input->post('introname'),
					"introstate" => $this->input->post('introstate'),
					"introscript" => $this->input->post('introscript'),
					"introdisclose" => $this->input->post('introdisclose'),
					"verifydonor" => $this->input->post('verifydonor'),
					"verifyaddress" => $this->input->post('verifyaddress'),
					"verifyspelled" => $this->input->post('verifyspelled'),
					"verifyemail" => $this->input->post('verifyemail'),
					"verifyback" => $this->input->post('verifyback'),
					"verifyasked" => $this->input->post('verifyasked'),
					"verifyconfirm" => $this->input->post('verifyconfirm'),
					"verifytype" => $this->input->post('verifytype'),
					"verifycell" => $this->input->post('verifycell'),
					"verifyaskalterphn" => $this->input->post('verifyaskalterphn'),
					"verifyalterphn" => $this->input->post('verifyalterphn'),
					"verifyalterno" => $this->input->post('verifyalterno'),
					"verifyconsent" => $this->input->post('verifyconsent'),
					"presentrequest" => $this->input->post('presentrequest'),
					"presenttieroffer" => $this->input->post('presenttieroffer'),
					"presentmonthask" => $this->input->post('presentmonthask'),
					"presentnavigate" => $this->input->post('presentnavigate'),
					"presenttbnknowledge" => $this->input->post('presenttbnknowledge'),
					"presentauthor" => $this->input->post('presentauthor'),
					"presentadherence" => $this->input->post('presentadherence'),
					"cartclosedonation" => $this->input->post('cartclosedonation'),
					"cartcloseamount" => $this->input->post('cartcloseamount'),
					"cartclosemonthly" => $this->input->post('cartclosemonthly'),
					"cartcloseresource" => $this->input->post('cartcloseresource'),
					"cartclosescript" => $this->input->post('cartclosescript'),
					"callhandleclearly" => $this->input->post('callhandleclearly'),
					"callhandledemeanor" => $this->input->post('callhandledemeanor'),
					"callhandlepace" => $this->input->post('callhandlepace'),
					"callhandlelisten" => $this->input->post('callhandlelisten'),
					"callhandleexhibit" => $this->input->post('callhandleexhibit'),
					"callhandlecommunicate" => $this->input->post('callhandlecommunicate'),
					"callhandlecontrol" => $this->input->post('callhandlecontrol'),
					"autofinfo" => $this->input->post('autofinfo'),
					"autofcall" => $this->input->post('autofcall'),
					"autofbehaviour" => $this->input->post('autofbehaviour'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $tbnid);
				$this->db->update('qa_amd_tbn_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $tbnid);
				$this->db->update('qa_amd_tbn_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/tbn_feedback');
			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*--------------------------------- TBN (End) -----------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*------------------------ TPM Scoresheet (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function tpm_feedback(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tpm/tpm_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_tpm_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["tpm_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}
	public function add_tpm(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tpm/add_tpm.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"introcall" => $this->input->post('introcall'),
					"verifycall" => $this->input->post('verifycall'),
					"verifypayment" => $this->input->post('verifypayment'),
					"verifycommunicator" => $this->input->post('verifycommunicator'),
					"verifyspelledname" => $this->input->post('verifyspelledname'),
					"verifyaskedaddress" => $this->input->post('verifyaskedaddress'),
					"verifyspelledaddress" => $this->input->post('verifyspelledaddress'),
					"verifyaskedphone" => $this->input->post('verifyaskedphone'),
					"verifycommunicatorphone" => $this->input->post('verifycommunicatorphone'),
					"verifylandline" => $this->input->post('verifylandline'),
					"verifycallverbatim" => $this->input->post('verifycallverbatim'),
					"verifytextverbatim" => $this->input->post('verifytextverbatim'),
					"verifyaskedemail" => $this->input->post('verifyaskedemail'),
					"verifyspelledemail" => $this->input->post('verifyspelledemail'),
					"scriptadherence" => $this->input->post('scriptadherence'),
					"scripthighertier" => $this->input->post('scripthighertier'),
					"scriptnavigate" => $this->input->post('scriptnavigate'),
					"scriptdisplaytpm" => $this->input->post('scriptdisplaytpm'),
					"closedcontent" => $this->input->post('closedcontent'),
					"closedmonthlyask" => $this->input->post('closedmonthlyask'),
					"closedshippingtime" => $this->input->post('closedshippingtime'),
					"closedprovidecart" => $this->input->post('closedprovidecart'),
					"closedreadscript" => $this->input->post('closedreadscript'),
					"callhandlespeakclearly" => $this->input->post('callhandlespeakclearly'),
					"callhandledemeanor" => $this->input->post('callhandledemeanor'),
					"callhandleprofesionalism" => $this->input->post('callhandleprofesionalism'),
					"callhandlepace" => $this->input->post('callhandlepace'),
					"callhandleresponds" => $this->input->post('callhandleresponds'),
					"callhandleemphaty" => $this->input->post('callhandleemphaty'),
					"callhandledonor" => $this->input->post('callhandledonor'),
					"callhandletalktime" => $this->input->post('callhandletalktime'),
					"autofinfo" => $this->input->post('autofinfo'),
					"autofhungup" => $this->input->post('autofhungup'),
					"autofrude" => $this->input->post('autofrude'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/tpm/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_tpm_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_tpm_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/tpm_feedback');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_tpm_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tpm/mgnt_tpm_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_tpm_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["tpm_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["tpmid"]=$id;

		///////Edit Part///////
			if($this->input->post('tpmid'))
			{
				$tpmid=$this->input->post('tpmid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"introcall" => $this->input->post('introcall'),
					"verifycall" => $this->input->post('verifycall'),
					"verifypayment" => $this->input->post('verifypayment'),
					"verifycommunicator" => $this->input->post('verifycommunicator'),
					"verifyspelledname" => $this->input->post('verifyspelledname'),
					"verifyaskedaddress" => $this->input->post('verifyaskedaddress'),
					"verifyspelledaddress" => $this->input->post('verifyspelledaddress'),
					"verifyaskedphone" => $this->input->post('verifyaskedphone'),
					"verifycommunicatorphone" => $this->input->post('verifycommunicatorphone'),
					"verifylandline" => $this->input->post('verifylandline'),
					"verifycallverbatim" => $this->input->post('verifycallverbatim'),
					"verifytextverbatim" => $this->input->post('verifytextverbatim'),
					"verifyaskedemail" => $this->input->post('verifyaskedemail'),
					"verifyspelledemail" => $this->input->post('verifyspelledemail'),
					"scriptadherence" => $this->input->post('scriptadherence'),
					"scripthighertier" => $this->input->post('scripthighertier'),
					"scriptnavigate" => $this->input->post('scriptnavigate'),
					"scriptdisplaytpm" => $this->input->post('scriptdisplaytpm'),
					"closedcontent" => $this->input->post('closedcontent'),
					"closedmonthlyask" => $this->input->post('closedmonthlyask'),
					"closedshippingtime" => $this->input->post('closedshippingtime'),
					"closedprovidecart" => $this->input->post('closedprovidecart'),
					"closedreadscript" => $this->input->post('closedreadscript'),
					"callhandlespeakclearly" => $this->input->post('callhandlespeakclearly'),
					"callhandledemeanor" => $this->input->post('callhandledemeanor'),
					"callhandleprofesionalism" => $this->input->post('callhandleprofesionalism'),
					"callhandlepace" => $this->input->post('callhandlepace'),
					"callhandleresponds" => $this->input->post('callhandleresponds'),
					"callhandleemphaty" => $this->input->post('callhandleemphaty'),
					"callhandledonor" => $this->input->post('callhandledonor'),
					"callhandletalktime" => $this->input->post('callhandletalktime'),
					"autofinfo" => $this->input->post('autofinfo'),
					"autofhungup" => $this->input->post('autofhungup'),
					"autofrude" => $this->input->post('autofrude'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $tpmid);
				$this->db->update('qa_amd_tpm_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $tpmid);
				$this->db->update('qa_amd_tpm_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/tpm_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*------------------------ TPM Scoresheet (End) ---------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- Patchology (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function patchology_feedback(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/patchology/patchology_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_patchology_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["patchology_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_patchology(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/patchology/add_patchology.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentcallopening" => $this->input->post('agentcallopening'),
					"agentclosecall" => $this->input->post('agentclosecall'),
					"agentverifyinformation" => $this->input->post('agentverifyinformation'),
					"agentprovideinformation" => $this->input->post('agentprovideinformation'),
					"agenthippinginformation" => $this->input->post('agenthippinginformation'),
					"callanswertimely" => $this->input->post('callanswertimely'),
					"agentengagedcustomer" => $this->input->post('agentengagedcustomer'),
					"customersatisfaction" => $this->input->post('customersatisfaction'),
					"escalatedresources" => $this->input->post('escalatedresources'),
					"remarks1" => $this->input->post('remarks1'),
					"remarks2" => $this->input->post('remarks2'),
					"remarks3" => $this->input->post('remarks3'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->patchology_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/patchology/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_patchology_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_patchology_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/patchology_feedback');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_patchology_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/patchology/mgnt_patchology_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_patchology_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["patchology_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["ptcid"]=$id;

		///////Edit Part///////
			if($this->input->post('ptcid'))
			{
				$ptcid=$this->input->post('ptcid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentcallopening" => $this->input->post('agentcallopening'),
					"agentclosecall" => $this->input->post('agentclosecall'),
					"agentverifyinformation" => $this->input->post('agentverifyinformation'),
					"agentprovideinformation" => $this->input->post('agentprovideinformation'),
					"agenthippinginformation" => $this->input->post('agenthippinginformation'),
					"callanswertimely" => $this->input->post('callanswertimely'),
					"agentengagedcustomer" => $this->input->post('agentengagedcustomer'),
					"customersatisfaction" => $this->input->post('customersatisfaction'),
					"escalatedresources" => $this->input->post('escalatedresources'),
					"remarks1" => $this->input->post('remarks1'),
					"remarks2" => $this->input->post('remarks2'),
					"remarks3" => $this->input->post('remarks3'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $ptcid);
				$this->db->update('qa_amd_patchology_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $ptcid);
				$this->db->update('qa_amd_patchology_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/patchology_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- Patchology (End) ---------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- Heat Surge (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function heatsurge_feedback(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/heatsurge/heatsurge_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_heatsurge_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["heatsurge_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_heatsurge(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/heatsurge/add_heatsurge.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"callprepared5sec" => $this->input->post('callprepared5sec'),
					"useibobgreeting" => $this->input->post('useibobgreeting'),
					"accesscustomeraccount" => $this->input->post('accesscustomeraccount'),
					"vreifynameaddress" => $this->input->post('vreifynameaddress'),
					"askforemail" => $this->input->post('askforemail'),
					"readminiMiranda" => $this->input->post('readminiMiranda'),
					"giveaccuratepricing" => $this->input->post('giveaccuratepricing'),
					"giveaccurateshiping" => $this->input->post('giveaccurateshiping'),
					"accuratedescribeproduct" => $this->input->post('accuratedescribeproduct'),
					"askforupsellproduct" => $this->input->post('askforupsellproduct'),
					"provideappropiatesolution" => $this->input->post('provideappropiatesolution'),
					"codedordercorrectly" => $this->input->post('codedordercorrectly'),
					"askforcancelarion" => $this->input->post('askforcancelarion'),
					"usePKkeybuying" => $this->input->post('usePKkeybuying'),
					"useappropiateguideline" => $this->input->post('useappropiateguideline'),
					"askforbillingname" => $this->input->post('askforbillingname'),
					"authorizeuserofcheck" => $this->input->post('authorizeuserofcheck'),
					"billingaddressforpayment" => $this->input->post('billingaddressforpayment'),
					"permissiontoauthorizepayment" => $this->input->post('permissiontoauthorizepayment'),
					"vrifyshippingaddress" => $this->input->post('vrifyshippingaddress'),
					"accountwithissue" => $this->input->post('accountwithissue'),
					"summarizesreviewcall" => $this->input->post('summarizesreviewcall'),
					"gaveCSphonenumber" => $this->input->post('gaveCSphonenumber'),
					"wasagentpolite" => $this->input->post('wasagentpolite'),
					"usinginappropiatecomment" => $this->input->post('usinginappropiatecomment'),
					"usesholdtrasferproperly" => $this->input->post('usesholdtrasferproperly'),
					"automaticzero" => $this->input->post('automaticzero'),
					"courteous" => $this->input->post('courteous'),
					"inappropriately" => $this->input->post('inappropriately'),
					"presentation" => $this->input->post('presentation'),
					"compliancescore" => $this->input->post('compliancescore'),
					"customerscore" => $this->input->post('customerscore'),
					"businessscore" => $this->input->post('businessscore'),
					"compliancescoreable" => $this->input->post('compliancescoreable'),
					"customerscoreable" => $this->input->post('customerscoreable'),
					"businessscoreable" => $this->input->post('businessscoreable'),
					"compliance_score_percent" => $this->input->post('compliance_score_percent'),
					"customer_score_percent" => $this->input->post('customer_score_percent'),
					"business_score_percent" => $this->input->post('business_score_percent'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"cmt25" => $this->input->post('cmt25'),
					"cmt26" => $this->input->post('cmt26'),
					"cmt27" => $this->input->post('cmt27'),
					"cmt28" => $this->input->post('cmt28'),
					"cmt29" => $this->input->post('cmt29'),
					"cmt30" => $this->input->post('cmt30'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/heatsurge/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_heatsurge_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_heatsurge_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/heatsurge_feedback');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_heatsurge_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/heatsurge/mgnt_heatsurge_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_heatsurge_feedback where id='$id') xx Left Join (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["heatsurge_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["hsid"]=$id;

		///////Edit Part///////
			if($this->input->post('hsid'))
			{
				$hsid=$this->input->post('hsid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"callprepared5sec" => $this->input->post('callprepared5sec'),
					"useibobgreeting" => $this->input->post('useibobgreeting'),
					"accesscustomeraccount" => $this->input->post('accesscustomeraccount'),
					"vreifynameaddress" => $this->input->post('vreifynameaddress'),
					"askforemail" => $this->input->post('askforemail'),
					"readminiMiranda" => $this->input->post('readminiMiranda'),
					"giveaccuratepricing" => $this->input->post('giveaccuratepricing'),
					"giveaccurateshiping" => $this->input->post('giveaccurateshiping'),
					"accuratedescribeproduct" => $this->input->post('accuratedescribeproduct'),
					"askforupsellproduct" => $this->input->post('askforupsellproduct'),
					"provideappropiatesolution" => $this->input->post('provideappropiatesolution'),
					"codedordercorrectly" => $this->input->post('codedordercorrectly'),
					"askforcancelarion" => $this->input->post('askforcancelarion'),
					"usePKkeybuying" => $this->input->post('usePKkeybuying'),
					"useappropiateguideline" => $this->input->post('useappropiateguideline'),
					"askforbillingname" => $this->input->post('askforbillingname'),
					"authorizeuserofcheck" => $this->input->post('authorizeuserofcheck'),
					"billingaddressforpayment" => $this->input->post('billingaddressforpayment'),
					"permissiontoauthorizepayment" => $this->input->post('permissiontoauthorizepayment'),
					"vrifyshippingaddress" => $this->input->post('vrifyshippingaddress'),
					"accountwithissue" => $this->input->post('accountwithissue'),
					"summarizesreviewcall" => $this->input->post('summarizesreviewcall'),
					"gaveCSphonenumber" => $this->input->post('gaveCSphonenumber'),
					"wasagentpolite" => $this->input->post('wasagentpolite'),
					"usinginappropiatecomment" => $this->input->post('usinginappropiatecomment'),
					"usesholdtrasferproperly" => $this->input->post('usesholdtrasferproperly'),
					"automaticzero" => $this->input->post('automaticzero'),
					"courteous" => $this->input->post('courteous'),
					"inappropriately" => $this->input->post('inappropriately'),
					"presentation" => $this->input->post('presentation'),
					"compliancescore" => $this->input->post('compliancescore'),
					"customerscore" => $this->input->post('customerscore'),
					"businessscore" => $this->input->post('businessscore'),
					"compliancescoreable" => $this->input->post('compliancescoreable'),
					"customerscoreable" => $this->input->post('customerscoreable'),
					"businessscoreable" => $this->input->post('businessscoreable'),
					"compliance_score_percent" => $this->input->post('compliance_score_percent'),
					"customer_score_percent" => $this->input->post('customer_score_percent'),
					"business_score_percent" => $this->input->post('business_score_percent'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"cmt25" => $this->input->post('cmt25'),
					"cmt26" => $this->input->post('cmt26'),
					"cmt27" => $this->input->post('cmt27'),
					"cmt28" => $this->input->post('cmt28'),
					"cmt29" => $this->input->post('cmt29'),
					"cmt30" => $this->input->post('cmt30'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $hsid);
				$this->db->update('qa_amd_heatsurge_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $hsid);
				$this->db->update('qa_amd_heatsurge_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/heatsurge_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- Heat Surge (End) ---------------------------------*/
///////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- ASPCA (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function aspca(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/aspca/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_aspca_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			 $data["aspca_data"] = $this->Common_model->get_query_result_array($qSql);
			// echo '<pre>';
			// print_r($data["aspca_data"]);
			//  die();
			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_aspca_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/aspca/add_feedback.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){

				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"Greet_customer" => $this->input->post('Greet_customer'),
					"Uses_professionalism" => $this->input->post('Uses_professionalism'),
					"Shows_gratitude" => $this->input->post('Shows_gratitude'),
					"Collects_verifies" => $this->input->post('Collects_verifies'),
					"guardians_program" => $this->input->post('guardians_program'),
					"monthly_guardian" => $this->input->post('monthly_guardian'),
					"gift_scripting" => $this->input->post('gift_scripting'),
					"payment_scripting" => $this->input->post('payment_scripting'),
					"Animal_champion" => $this->input->post('Animal_champion'),
					"donation_processing" => $this->input->post('donation_processing'),
					"onetime_donation" => $this->input->post('onetime_donation'),
					"pet_insurance" => $this->input->post('pet_insurance'),
					"correct_script" => $this->input->post('correct_script'),
					"call_control" => $this->input->post('call_control'),
					"min_deadair" => $this->input->post('min_deadair'),
					"call_disposed" => $this->input->post('call_disposed'),
					"faq" => $this->input->post('faq'),
					"personalizes_call" => $this->input->post('personalizes_call'),
					"rude_remarks" => $this->input->post('rude_remarks'),
					"call_avoidance" => $this->input->post('call_avoidance'),
					"compliance_score_percent" => $this->input->post('compliance_score_percent'),
					"customer_score_percent" => $this->input->post('customer_score_percent'),
					"business_score_percent" => $this->input->post('business_score_percent'),
					"compliancescore" => $this->input->post('compliancescore'),
					"customerscore" => $this->input->post('customerscore'),
					"businessscore" => $this->input->post('businessscore'),
					"compliancescoreable" => $this->input->post('compliancescoreable'),
					"customerscoreable" => $this->input->post('customerscoreable'),
					"businessscoreable" => $this->input->post('businessscoreable'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/aspca/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_aspca_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_aspca_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/aspca');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_aspca_rvw($id){
		// echo '<pre>';
		// print_r($_POST);
		// die();
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/aspca/mgnt_aspca_rvw.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			// $qSql="SELECT * from
			// 	(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			// 	(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			// 	(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			// 	from qa_amd_aspca_feedback where id='$id') xx Left Join
			// 	(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid)";
			// $data["aspca_data"] = $this->Common_model->get_query_row_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_aspca_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["aspca_data"] = $this->Common_model->get_query_row_array($qSql);
			// echo '<pre>';
			// print_r($data["aspca_data"]);
			//  die();
			$data["fbid"]=$id;

			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				// echo '<pre>';
				// print_r($fbid);
				// die();
				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"Greet_customer" => $this->input->post('Greet_customer'),
					"Uses_professionalism" => $this->input->post('Uses_professionalism'),
					"Shows_gratitude" => $this->input->post('Shows_gratitude'),
					"Collects_verifies" => $this->input->post('Collects_verifies'),
					"guardians_program" => $this->input->post('guardians_program'),
					"monthly_guardian" => $this->input->post('monthly_guardian'),
					"gift_scripting" => $this->input->post('gift_scripting'),
					"payment_scripting" => $this->input->post('payment_scripting'),
					"Animal_champion" => $this->input->post('Animal_champion'),
					"donation_processing" => $this->input->post('donation_processing'),
					"onetime_donation" => $this->input->post('onetime_donation'),
					"pet_insurance" => $this->input->post('pet_insurance'),
					"correct_script" => $this->input->post('correct_script'),
					"call_control" => $this->input->post('call_control'),
					"min_deadair" => $this->input->post('min_deadair'),
					"call_disposed" => $this->input->post('call_disposed'),
					"faq" => $this->input->post('faq'),
					"personalizes_call" => $this->input->post('personalizes_call'),
					"rude_remarks" => $this->input->post('rude_remarks'),
					"call_avoidance" => $this->input->post('call_avoidance'),
					"compliance_score_percent" => $this->input->post('compliance_score_percent'),
					"customer_score_percent" => $this->input->post('customer_score_percent'),
					"business_score_percent" => $this->input->post('business_score_percent'),
					"compliancescore" => $this->input->post('compliancescore'),
					"customerscore" => $this->input->post('customerscore'),
					"businessscore" => $this->input->post('businessscore'),
					"compliancescoreable" => $this->input->post('compliancescoreable'),
					"customerscoreable" => $this->input->post('customerscoreable'),
					"businessscoreable" => $this->input->post('businessscoreable'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				// echo '<pre>';
				// print_r($field_array);
				// die();
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_aspca_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_aspca_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/aspca');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- ASPCA (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*--------------- FILTER FIRST AGENT IMPROVEMENT  (Start) -----------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function ffai(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ffaif/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_ffai_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["aspca_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_ffai_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ffaif/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"open_call_appropriate_branding" => $this->input->post('text1'),
					"close_call_appropriate_branding" => $this->input->post('text2'),
					"address_using_nato" => $this->input->post('text4'),
					"products_availability" => $this->input->post('text5'),
					"one_call_resolution" => $this->input->post('text6'),
					"agent_accurately_clearly" => $this->input->post('text7'),
					"agent_engaged_customer" => $this->input->post('text8'),
					"membership" => $this->input->post('text9'),
					"offer_donation" => $this->input->post('text10'),
					"was_cust_sat_fulfilled" => $this->input->post('text11'),
					"did_agent_offer_survey" => $this->input->post('text3'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/ffai/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_ffai_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_ffai_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/ffai');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_ffai_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ffaif/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_ffai_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["aspca_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;

			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"open_call_appropriate_branding" => $this->input->post('text1'),
					"close_call_appropriate_branding" => $this->input->post('text2'),
					"address_using_nato" => $this->input->post('text4'),
					"products_availability" => $this->input->post('text5'),
					"one_call_resolution" => $this->input->post('text6'),
					"agent_accurately_clearly" => $this->input->post('text7'),
					"agent_engaged_customer" => $this->input->post('text8'),
					"membership" => $this->input->post('text9'),
					"offer_donation" => $this->input->post('text10'),
					"was_cust_sat_fulfilled" => $this->input->post('text11'),
					"did_agent_offer_survey" => $this->input->post('text3'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_ffai_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_ffai_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/ffai');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------- FILTER FIRST AGENT IMPROVEMENT (End) ---------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*--------------- LIFE QUOTE LIFI QA EVALUATION FORM  (START) -------------------*/
///////////////////////////////////////////////////////////////////////////////////

public function lifi(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/lifi/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_lifi_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["aspca_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_lifi_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/lifi/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"life_quotes_greeting" => $this->input->post('text1'),
					"agent_positive_response" => $this->input->post('text2'),
					"customer_name_capture" => $this->input->post('text3'),
					"capture_address" => $this->input->post('text4'),
					"phone_number_confirmation" => $this->input->post('text5'),
					"email_Address" => $this->input->post('text6'),
					"customer_dob" => $this->input->post('text7'),
					"script_adherence" => $this->input->post('text8'),
					"coverage_amount_insurance" => $this->input->post('text9'),
					"tobacco_smoking" => $this->input->post('text10'),
					"height_weight_customer" => $this->input->post('text11'),
					"mention_price_comparison" => $this->input->post('text12'),
					"overall_confidence_level" => $this->input->post('text13'),
					"call_closing" => $this->input->post('text14'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/lifi/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_lifi_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_lifi_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/lifi');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_lifi_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/lifi/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_lifi_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["lifi_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;

			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"life_quotes_greeting" => $this->input->post('text1'),
					"agent_positive_response" => $this->input->post('text2'),
					"customer_name_capture" => $this->input->post('text3'),
					"capture_address" => $this->input->post('text4'),
					"phone_number_confirmation" => $this->input->post('text5'),
					"email_Address" => $this->input->post('text6'),
					"customer_dob" => $this->input->post('text7'),
					"script_adherence" => $this->input->post('text8'),
					"coverage_amount_insurance" => $this->input->post('text9'),
					"tobacco_smoking" => $this->input->post('text10'),
					"height_weight_customer" => $this->input->post('text11'),
					"mention_price_comparison" => $this->input->post('text12'),
					"overall_confidence_level" => $this->input->post('text13'),
					"call_closing" => $this->input->post('text14'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_lifi_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_lifi_feedback',$field_array1);
			///////////
			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*--------------- LIFE QUOTE LIFI QA EVALUATION FORM  (END) ---------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Stauer Sales (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function stauers_sales(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/stauers_sales/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_stauers_sales_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["aspca_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_stauers_sales_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/stauers_sales/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"customer_score" => $this->input->post('customer_score'),
					"business_score" => $this->input->post('business_score'),
					"compliance_score" => $this->input->post('compliance_score'),
					"custlockPossible" => $this->input->post('custlockPossible'),
					"busilockPossible" => $this->input->post('busilockPossible'),
					"compllockPossible" => $this->input->post('compllockPossible'),
					"custlockEarned" => $this->input->post('custlockEarned'),
					"busilockEarned" => $this->input->post('busilockEarned'),
					"compllockEarned" => $this->input->post('compllockEarned'),
					"call_answered_5_seconds" => $this->input->post('text1'),
					"agent_verify_customer_name_address" => $this->input->post('text2'),
					"agent_capture_correct_offer" => $this->input->post('text3'),
					"agent_verify_phone_number" => $this->input->post('text4'),
					"agent_verify_customer_email" => $this->input->post('text5'),
					"agent_compliment_caller_purchase" => $this->input->post('text6'),
					"agent_recap_item" => $this->input->post('text7'),
					"agent_cover_one_upsell" => $this->input->post('text8'),
					"agent_cover_replacement" => $this->input->post('text9'),
					"agent_appropriate_rebuttal" => $this->input->post('text10'),
					"agent_cover_membership" => $this->input->post('text11'),
					"agent_appropriate_rebuttal_declined" => $this->input->post('text12'),
					"agent_offer_membership" => $this->input->post('text13'),
					"agent_cover_autorenew" => $this->input->post('text14'),
					"shipping_address_verified" => $this->input->post('text15'),
					"quote_correct_delivery_time" => $this->input->post('text16'),
					"agent_total_product_appropriately" => $this->input->post('text17'),
					"agent_quote_shipping_taxes" => $this->input->post('text18'),
					"agent_give_total_charged" => $this->input->post('text19'),
					"agent_provide_order_number" => $this->input->post('text20'),
					"agent_close_call_brand_correctly" => $this->input->post('text21'),
					"customer_satisfied_experience" => $this->input->post('text22'),
					"customer_dissatisfied_professionalism" => $this->input->post('text23'),
					"agent_recap" => $this->input->post('text24'),
					"agent_cover_upsell" => $this->input->post('text25'),
					"agent_disposition" => $this->input->post('text26'),
					"dead_air" => $this->input->post('text27'),
					"rude_remarks" => $this->input->post('rude_remarks'),
					"call_avoidance" => $this->input->post('call_avoidance'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/stauers_sales/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_stauers_sales_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_stauers_sales_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/stauers_sales');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_stauers_sales_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/stauers_sales/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_stauers_sales_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["aspca_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;

			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"customer_score" => $this->input->post('customer_score'),
					"business_score" => $this->input->post('business_score'),
					"compliance_score" => $this->input->post('compliance_score'),
					"custlockPossible" => $this->input->post('custlockPossible'),
					"busilockPossible" => $this->input->post('busilockPossible'),
					"compllockPossible" => $this->input->post('compllockPossible'),
					"custlockEarned" => $this->input->post('custlockEarned'),
					"busilockEarned" => $this->input->post('busilockEarned'),
					"compllockEarned" => $this->input->post('compllockEarned'),
					"call_answered_5_seconds" => $this->input->post('text1'),
					"agent_verify_customer_name_address" => $this->input->post('text2'),
					"agent_capture_correct_offer" => $this->input->post('text3'),
					"agent_verify_phone_number" => $this->input->post('text4'),
					"agent_verify_customer_email" => $this->input->post('text5'),
					"agent_compliment_caller_purchase" => $this->input->post('text6'),
					"agent_recap_item" => $this->input->post('text7'),
					"agent_cover_one_upsell" => $this->input->post('text8'),
					"agent_cover_replacement" => $this->input->post('text9'),
					"agent_appropriate_rebuttal" => $this->input->post('text10'),
					"agent_cover_membership" => $this->input->post('text11'),
					"agent_appropriate_rebuttal_declined" => $this->input->post('text12'),
					"agent_offer_membership" => $this->input->post('text13'),
					"agent_cover_autorenew" => $this->input->post('text14'),
					"shipping_address_verified" => $this->input->post('text15'),
					"quote_correct_delivery_time" => $this->input->post('text16'),
					"agent_total_product_appropriately" => $this->input->post('text17'),
					"agent_quote_shipping_taxes" => $this->input->post('text18'),
					"agent_give_total_charged" => $this->input->post('text19'),
					"agent_provide_order_number" => $this->input->post('text20'),
					"agent_close_call_brand_correctly" => $this->input->post('text21'),
					"customer_satisfied_experience" => $this->input->post('text22'),
					"customer_dissatisfied_professionalism" => $this->input->post('text23'),
					"agent_recap" => $this->input->post('text24'),
					"agent_cover_upsell" => $this->input->post('text25'),
					"agent_disposition" => $this->input->post('text26'),
					"dead_air" => $this->input->post('text27'),
					"rude_remarks" => $this->input->post('rude_remarks'),
					"call_avoidance" => $this->input->post('call_avoidance'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_stauers_sales_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_stauers_sales_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/stauers_sales');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- stauers_sales (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Operation Smile (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function operation_smile(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/operation_smile/operation_smile_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_operation_smile_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["operation_smile"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_operation_smile(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/operation_smile/add_operation_smile.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentreadytohandle" => $this->input->post('agentreadytohandle'),
					"agentgreetthecaller" => $this->input->post('agentgreetthecaller'),
					"agentconfirminfo" => $this->input->post('agentconfirminfo'),
					"agentshowgraduate" => $this->input->post('agentshowgraduate'),
					"agentuserebuttals" => $this->input->post('agentuserebuttals'),
					"agentofferupsell" => $this->input->post('agentofferupsell'),
					"agentfollowscript" => $this->input->post('agentfollowscript'),
					"agentaddressquestion" => $this->input->post('agentaddressquestion'),
					"agentspeakenergy" => $this->input->post('agentspeakenergy'),
					"agentuseproperpacing" => $this->input->post('agentuseproperpacing'),
					"agentmaintaincontrol" => $this->input->post('agentmaintaincontrol'),
					"agentprofessionalspeak" => $this->input->post('agentprofessionalspeak'),
					"agentgoodlistening" => $this->input->post('agentgoodlistening'),
					"agentempathize" => $this->input->post('agentempathize'),
					"agentprovidedonor" => $this->input->post('agentprovidedonor'),
					"agnetaskprompted" => $this->input->post('agnetaskprompted'),
					"agentthankcaller" => $this->input->post('agentthankcaller'),
					"agentgaveinformation" => $this->input->post('agentgaveinformation'),
					"agenthangup" => $this->input->post('agenthangup'),
					"agentlaguage" => $this->input->post('agentlaguage'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/operation_smile/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_operation_smile_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_operation_smile_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/operation_smile');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_operation_smile_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/operation_smile/mgnt_operation_smile_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_operation_smile_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["operation_smile"] = $this->Common_model->get_query_row_array($qSql);

			$data["osid"]=$id;

		///////Edit Part///////
			if($this->input->post('osid'))
			{
				$osid=$this->input->post('osid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentreadytohandle" => $this->input->post('agentreadytohandle'),
					"agentgreetthecaller" => $this->input->post('agentgreetthecaller'),
					"agentconfirminfo" => $this->input->post('agentconfirminfo'),
					"agentshowgraduate" => $this->input->post('agentshowgraduate'),
					"agentuserebuttals" => $this->input->post('agentuserebuttals'),
					"agentofferupsell" => $this->input->post('agentofferupsell'),
					"agentfollowscript" => $this->input->post('agentfollowscript'),
					"agentaddressquestion" => $this->input->post('agentaddressquestion'),
					"agentspeakenergy" => $this->input->post('agentspeakenergy'),
					"agentuseproperpacing" => $this->input->post('agentuseproperpacing'),
					"agentmaintaincontrol" => $this->input->post('agentmaintaincontrol'),
					"agentprofessionalspeak" => $this->input->post('agentprofessionalspeak'),
					"agentgoodlistening" => $this->input->post('agentgoodlistening'),
					"agentempathize" => $this->input->post('agentempathize'),
					"agentprovidedonor" => $this->input->post('agentprovidedonor'),
					"agnetaskprompted" => $this->input->post('agnetaskprompted'),
					"agentthankcaller" => $this->input->post('agentthankcaller'),
					"agentgaveinformation" => $this->input->post('agentgaveinformation'),
					"agenthangup" => $this->input->post('agenthangup'),
					"agentlaguage" => $this->input->post('agentlaguage'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"mgnt_rvw_note" => $this->input->post('note'),
					"mgnt_rvw_by" => $current_user,
					"mgnt_rvw_date" => $curDateTime
				);
				$this->db->where('id', $osid);
				$this->db->update('qa_amd_operation_smile_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $osid);
				$this->db->update('qa_amd_operation_smile_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/operation_smile');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Operation Smile (End) ----------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- Tactical 5-11 (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function tactical_5_11(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tactical_5_11/tactical_5_11_feedback.php";
			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_5_11_tactical_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["tactical"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_tactical_5_11(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$curDateTime=CurrMySqlDate();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tactical_5_11/add_tactical_5_11.php";
			$data["content_js"] = "qa_ameridial_commercial_js.php";
			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);
			
			$a = array();
			
			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"greetthecustomer" => $this->input->post('greetthecustomer'),
					"customeritemtoorder" => $this->input->post('customeritemtoorder'),
					"wouldaddyourorder" => $this->input->post('wouldaddyourorder'),
					"customerlogininformation" => $this->input->post('customerlogininformation'),
					"callerinformationaccuracy" => $this->input->post('callerinformationaccuracy'),
					"coverfinalconfirmation" => $this->input->post('coverfinalconfirmation'),
					"givecustomerordernumber" => $this->input->post('givecustomerordernumber'),
					"userapplicablesearch" => $this->input->post('userapplicablesearch'),
					"coverreturnprocess" => $this->input->post('coverreturnprocess'),
					"coverexchangeprocess" => $this->input->post('coverexchangeprocess'),
					"coverrefundprocess" => $this->input->post('coverrefundprocess'),
					"trackthepackage" => $this->input->post('trackthepackage'),
					"agentaskforassist" => $this->input->post('agentaskforassist'),
					"agentbrandthecall" => $this->input->post('agentbrandthecall'),
					"answerquestions" => $this->input->post('answerquestions'),
					"maintaincallcontrol" => $this->input->post('maintaincallcontrol'),
					"properlynotateAX" => $this->input->post('properlynotateAX'),
					"escalationwaranted" => $this->input->post('escalationwaranted'),
					"agentdispositioncall" => $this->input->post('agentdispositioncall'),
					"maintainprofessionalism" => $this->input->post('maintainprofessionalism'),
					"warranted" => $this->input->post('warranted'),
					"avoidance" => $this->input->post('avoidance'),
					"behavior" => $this->input->post('behavior'),
					"compliance_score_percent" => $this->input->post('compliance_score_percent'),
					"customer_score_percent" => $this->input->post('customer_score_percent'),
					"business_score_percent" => $this->input->post('business_score_percent'),
					"compliancescore" => $this->input->post('compliancescore'),
					"customerscore" => $this->input->post('customerscore'),
					"businessscore" => $this->input->post('businessscore'),
					"compliancescoreable" => $this->input->post('compliance_score_percent'),
					"customerscoreable" => $this->input->post('customerscoreable'),
					"businessscoreable" => $this->input->post('businessscoreable'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_by" => $current_user,
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/tactical_5_11/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_5_11_tactical_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_5_11_tactical_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/tactical_5_11');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_tactical_5_11_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/tactical_5_11/mgnt_tactical_5_11_rvw.php";
			$data["content_js"] = "qa_ameridial_commercial_js.php";
			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_5_11_tactical_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["tectical"] = $this->Common_model->get_query_row_array($qSql);

			$data["tecid"]=$id;

			if($this->input->post('tecid'))
			{
				$tecid=$this->input->post('tecid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"greetthecustomer" => $this->input->post('greetthecustomer'),
					"customeritemtoorder" => $this->input->post('customeritemtoorder'),
					"wouldaddyourorder" => $this->input->post('wouldaddyourorder'),
					"customerlogininformation" => $this->input->post('customerlogininformation'),
					"callerinformationaccuracy" => $this->input->post('callerinformationaccuracy'),
					"coverfinalconfirmation" => $this->input->post('coverfinalconfirmation'),
					"givecustomerordernumber" => $this->input->post('givecustomerordernumber'),
					"userapplicablesearch" => $this->input->post('userapplicablesearch'),
					"coverreturnprocess" => $this->input->post('coverreturnprocess'),
					"coverexchangeprocess" => $this->input->post('coverexchangeprocess'),
					"coverrefundprocess" => $this->input->post('coverrefundprocess'),
					"trackthepackage" => $this->input->post('trackthepackage'),
					"agentaskforassist" => $this->input->post('agentaskforassist'),
					"agentbrandthecall" => $this->input->post('agentbrandthecall'),
					"answerquestions" => $this->input->post('answerquestions'),
					"maintaincallcontrol" => $this->input->post('maintaincallcontrol'),
					"properlynotateAX" => $this->input->post('properlynotateAX'),
					"escalationwaranted" => $this->input->post('escalationwaranted'),
					"agentdispositioncall" => $this->input->post('agentdispositioncall'),
					"maintainprofessionalism" => $this->input->post('maintainprofessionalism'),
					"warranted" => $this->input->post('warranted'),
					"avoidance" => $this->input->post('avoidance'),
					"behavior" => $this->input->post('behavior'),
					"compliance_score_percent" => $this->input->post('compliance_score_percent'),
					"customer_score_percent" => $this->input->post('customer_score_percent'),
					"business_score_percent" => $this->input->post('business_score_percent'),
					"compliancescore" => $this->input->post('compliancescore'),
					"customerscore" => $this->input->post('customerscore'),
					"businessscore" => $this->input->post('businessscore'),
					"compliancescoreable" => $this->input->post('compliance_score_percent'),
					"customerscoreable" => $this->input->post('customerscoreable'),
					"businessscoreable" => $this->input->post('businessscoreable'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				
				$this->db->where('id', $tecid);
				$this->db->update('qa_amd_5_11_tactical_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $tecid);
				$this->db->update('qa_amd_5_11_tactical_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/tactical_5_11');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- 5-11 Tactical (End) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Non-Profit (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function non_profit(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/non_profit/non_profit_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_non_profit_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["nonProfit"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_non_profit(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/non_profit/add_non_profit.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"preparedtakecall" => $this->input->post('preparedtakecall'),
					"paidcallerfromdonor" => $this->input->post('paidcallerfromdonor'),
					"communicatorstarted" => $this->input->post('communicatorstarted'),
					"pronouncedclients" => $this->input->post('pronouncedclients'),
					"gavewarmgreeting" => $this->input->post('gavewarmgreeting'),
					"followedscript1stReq" => $this->input->post('followedscript1stReq'),
					"usedcorrectdollar" => $this->input->post('usedcorrectdollar'),
					"assumptivegiftask" => $this->input->post('assumptivegiftask'),
					"shownempathy" => $this->input->post('shownempathy'),
					"repeatedobjection" => $this->input->post('repeatedobjection'),
					"personalizedobjection" => $this->input->post('personalizedobjection'),
					"attemptedhandleobjection" => $this->input->post('attemptedhandleobjection'),
					"reinforcethenegative" => $this->input->post('reinforcethenegative'),
					"deadendcall" => $this->input->post('deadendcall'),
					"followed2ndReq" => $this->input->post('followed2ndReq'),
					"usedoller2ndReq" => $this->input->post('usedoller2ndReq'),
					"assumptive2ndReq" => $this->input->post('assumptive2ndReq'),
					"attempted3rdReq" => $this->input->post('attempted3rdReq'),
					"usedoller3rdReq" => $this->input->post('usedoller3rdReq'),
					"assumptive3rdReq" => $this->input->post('assumptive3rdReq'),
					"confirmationgiftamount" => $this->input->post('confirmationgiftamount'),
					"assumedhigherdoller" => $this->input->post('assumedhigherdoller'),
					"meaningfulgratitude" => $this->input->post('meaningfulgratitude'),
					"readcreditcard" => $this->input->post('readcreditcard'),
					"confirmedfullname" => $this->input->post('confirmedfullname'),
					"followedmaybeclose" => $this->input->post('followedmaybeclose'),
					"readclosescript" => $this->input->post('readclosescript'),
					"endedcalltime" => $this->input->post('endedcalltime'),
					"soundedconversational" => $this->input->post('soundedconversational'),
					"useappropiatepace" => $this->input->post('useappropiatepace'),
					"confidentpresentation" => $this->input->post('confidentpresentation'),
					"didnotlosecontrol" => $this->input->post('didnotlosecontrol'),
					"properpersonalization" => $this->input->post('properpersonalization'),
					"utilizedpropergrammer" => $this->input->post('utilizedpropergrammer'),
					"bailing" => $this->input->post('bailing'),
					"askforcreditcard" => $this->input->post('askforcreditcard'),
					"gavefalseinformation" => $this->input->post('gavefalseinformation'),
					"donorcarecenter" => $this->input->post('donorcarecenter'),
					"askconfirmationquestion" => $this->input->post('askconfirmationquestion'),
					"unsolidgift" => $this->input->post('unsolidgift'),
					"codingrefusal" => $this->input->post('codingrefusal'),
					"unprofessionalbehaviour" => $this->input->post('unprofessionalbehaviour'),
					"improperpresentation" => $this->input->post('improperpresentation'),
					"omittedDNCcode" => $this->input->post('omittedDNCcode'),
					"falsificationgift" => $this->input->post('falsificationgift'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_by" => $current_user,
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/non_profit/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_non_profit_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_non_profit_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/non_profit');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_non_profit_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/non_profit/mgnt_non_profit_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_non_profit_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid)";
			$data["nonProfit"] = $this->Common_model->get_query_row_array($qSql);

			$data["tecid"]=$id;

			if($this->input->post('tecid'))
			{
				$tecid=$this->input->post('tecid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"preparedtakecall" => $this->input->post('preparedtakecall'),
					"paidcallerfromdonor" => $this->input->post('paidcallerfromdonor'),
					"communicatorstarted" => $this->input->post('communicatorstarted'),
					"pronouncedclients" => $this->input->post('pronouncedclients'),
					"gavewarmgreeting" => $this->input->post('gavewarmgreeting'),
					"followedscript1stReq" => $this->input->post('followedscript1stReq'),
					"usedcorrectdollar" => $this->input->post('usedcorrectdollar'),
					"assumptivegiftask" => $this->input->post('assumptivegiftask'),
					"shownempathy" => $this->input->post('shownempathy'),
					"repeatedobjection" => $this->input->post('repeatedobjection'),
					"personalizedobjection" => $this->input->post('personalizedobjection'),
					"attemptedhandleobjection" => $this->input->post('attemptedhandleobjection'),
					"reinforcethenegative" => $this->input->post('reinforcethenegative'),
					"deadendcall" => $this->input->post('deadendcall'),
					"followed2ndReq" => $this->input->post('followed2ndReq'),
					"usedoller2ndReq" => $this->input->post('usedoller2ndReq'),
					"assumptive2ndReq" => $this->input->post('assumptive2ndReq'),
					"attempted3rdReq" => $this->input->post('attempted3rdReq'),
					"usedoller3rdReq" => $this->input->post('usedoller3rdReq'),
					"assumptive3rdReq" => $this->input->post('assumptive3rdReq'),
					"confirmationgiftamount" => $this->input->post('confirmationgiftamount'),
					"assumedhigherdoller" => $this->input->post('assumedhigherdoller'),
					"meaningfulgratitude" => $this->input->post('meaningfulgratitude'),
					"readcreditcard" => $this->input->post('readcreditcard'),
					"confirmedfullname" => $this->input->post('confirmedfullname'),
					"followedmaybeclose" => $this->input->post('followedmaybeclose'),
					"readclosescript" => $this->input->post('readclosescript'),
					"endedcalltime" => $this->input->post('endedcalltime'),
					"soundedconversational" => $this->input->post('soundedconversational'),
					"useappropiatepace" => $this->input->post('useappropiatepace'),
					"confidentpresentation" => $this->input->post('confidentpresentation'),
					"didnotlosecontrol" => $this->input->post('didnotlosecontrol'),
					"properpersonalization" => $this->input->post('properpersonalization'),
					"utilizedpropergrammer" => $this->input->post('utilizedpropergrammer'),
					"bailing" => $this->input->post('bailing'),
					"askforcreditcard" => $this->input->post('askforcreditcard'),
					"gavefalseinformation" => $this->input->post('gavefalseinformation'),
					"donorcarecenter" => $this->input->post('donorcarecenter'),
					"askconfirmationquestion" => $this->input->post('askconfirmationquestion'),
					"unsolidgift" => $this->input->post('unsolidgift'),
					"codingrefusal" => $this->input->post('codingrefusal'),
					"unprofessionalbehaviour" => $this->input->post('unprofessionalbehaviour'),
					"improperpresentation" => $this->input->post('improperpresentation'),
					"omittedDNCcode" => $this->input->post('omittedDNCcode'),
					"falsificationgift" => $this->input->post('falsificationgift'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"mgnt_rvw_note" => $this->input->post('note'),
					"mgnt_rvw_by" => $current_user,
					"mgnt_rvw_date" => $curDateTime
				);
				$this->db->where('id', $tecid);
				$this->db->update('qa_amd_non_profit_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $tecid);
				$this->db->update('qa_amd_non_profit_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/non_profit');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- Non-Profit (End) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*------------------------------ JMMI (Start) ------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function jmmi(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/jmmi/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}
			
		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_jmmi_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["aspca_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_jmmi_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/jmmi/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				/* if($this->input->post('text24')=='Yes') $text24 = 'No';
				else if ($this->input->post('text24')=='No') $text24 = 'Yes';
				else $text24 = 'N/A'; */

				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agent_appropriate_greeting" => $this->input->post('text1'),
					"agent_excellent_conversational_responses" => $this->input->post('text2'),
					"agent_verify_opening_information" => $this->input->post('text3'),
					"agent_follow_call_flow" => $this->input->post('text4'),
					"agent_appropriate_gratitude" => $this->input->post('text5'),
					"agent_share_upsells" => $this->input->post('text6'),
					"agent_show_familiarity_search" => $this->input->post('text7'),
					"agent_thank_caller_specifically" => $this->input->post('text8'),
					"agent_share_facts_appropriate" => $this->input->post('text9'),
					"agent_professional_communication" => $this->input->post('text10'),
					"agent_proper_enthusiasm" => $this->input->post('text11'),
					"agent_maintain_control_conversation" => $this->input->post('text12'),
					"agent_spoke_clearly" => $this->input->post('text13'),
					"agent_good_listening_skills_responses" => $this->input->post('text14'),
					"agent_empathize_caller_and_compassion" => $this->input->post('text15'),
					"agent_have_minimal_dead_air" => $this->input->post('text16'),
					"agent_have_caller_provide_address" => $this->input->post('text17'),
					"agent_confirm_dollar_amount" => $this->input->post('text18'),
					"agent_read_shipping_information" => $this->input->post('text19'),
					"agent_ask_caller_email_tv_information" => $this->input->post('text20'),
					"agent_proper_thanks" => $this->input->post('text21'),
					"agent_transfer_call_prayer_appropriate" => $this->input->post('text22'),
					"agent_follow_payment" => $this->input->post('text23'),
					"agent_read_back_customer_details_properly" => $this->input->post('text24'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/jmmi/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_jmmi_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_jmmi_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/jmmi');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_jmmi_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/jmmi/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_jmmi_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["jmmi_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["fbid"]=$id;

			if($this->input->post('fbid'))
			{
				$fbid=$this->input->post('fbid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				/* if($this->input->post('text24')=='Yes') $text24 = 'No';
				else if ($this->input->post('text24')=='No') $text24 = 'Yes';
				else $text24 = 'N/A'; */

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agent_appropriate_greeting" => $this->input->post('text1'),
					"agent_excellent_conversational_responses" => $this->input->post('text2'),
					"agent_verify_opening_information" => $this->input->post('text3'),
					"agent_follow_call_flow" => $this->input->post('text4'),
					"agent_appropriate_gratitude" => $this->input->post('text5'),
					"agent_share_upsells" => $this->input->post('text6'),
					"agent_show_familiarity_search" => $this->input->post('text7'),
					"agent_thank_caller_specifically" => $this->input->post('text8'),
					"agent_share_facts_appropriate" => $this->input->post('text9'),
					"agent_professional_communication" => $this->input->post('text10'),
					"agent_proper_enthusiasm" => $this->input->post('text11'),
					"agent_maintain_control_conversation" => $this->input->post('text12'),
					"agent_spoke_clearly" => $this->input->post('text13'),
					"agent_good_listening_skills_responses" => $this->input->post('text14'),
					"agent_empathize_caller_and_compassion" => $this->input->post('text15'),
					"agent_have_minimal_dead_air" => $this->input->post('text16'),
					"agent_have_caller_provide_address" => $this->input->post('text17'),
					"agent_confirm_dollar_amount" => $this->input->post('text18'),
					"agent_read_shipping_information" => $this->input->post('text19'),
					"agent_ask_caller_email_tv_information" => $this->input->post('text20'),
					"agent_proper_thanks" => $this->input->post('text21'),
					"agent_transfer_call_prayer_appropriate" => $this->input->post('text22'),
					"agent_follow_payment" => $this->input->post('text23'),
					"agent_read_back_customer_details_properly" => $this->input->post('text24'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_jmmi_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $fbid);
				$this->db->update('qa_amd_jmmi_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/jmmi');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- JMMI (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- icario (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function icario(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/revel/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,'133,134') and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		 //    $qSql = "SELECT * from
			// 	(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			// 	(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			// 	(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
			// 	from qa_amd_revel_new_feedback $cond) xx Left Join
			// 	(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			// $data["revel_data"] = $this->Common_model->get_query_result_array($qSql);

			//  $qSql = "SELECT * from
			// 	(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			// 	(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			// 	(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
			// 	from qa_amd_icario_feedback $cond) xx Left Join
			// 	(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			// $data["icario"] = $this->Common_model->get_query_result_array($qSql);


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_ica_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["icario_new"] = $this->Common_model->get_query_result_array($qSql);

			 $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_ica_latest_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["icario_latest"] = $this->Common_model->get_query_result_array($qSql); 

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_icario_feedback($icario_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/revel/add_icario_feedback.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['icario_id']=$icario_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_revel_new_feedback where id='$icario_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["icario"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($icario_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_icario/');
                    $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_revel_new_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_revel_new_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_revel_new_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_revel_new_feedback',$edit_array);

				}

				redirect('qa_ameridial/icario');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}

	}



	public function add_icario_feedback_new($icario_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/revel/add_icario_feedback_new.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['icario_id']=$icario_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_icario_feedback where id='$icario_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["icario"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($icario_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_icario/');
                    $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_icario_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_icario_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_icario_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_icario_feedback',$edit_array);

				}

				redirect('qa_ameridial/icario');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}

	}


	public function add_edit_icario_new($icario_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/revel/add_edit_icario_new.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['icario_id']=$icario_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,'133,134') and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_ica_feedback where id='$icario_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["icario"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($icario_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_icario/');
                    $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_ica_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_ica_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_ica_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_ica_feedback',$edit_array);

				}

				redirect('qa_ameridial/icario');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	///////////////////////VIKAS START//////////////////////////////

	public function add_edit_icario_latest($icario_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/revel/add_edit_icario_latest.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['icario_id']=$icario_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,'133,134') and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_ica_latest_feedback where id='$icario_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["icario"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($icario_id==0){
					$field_array=$this->input->post('data');
					//$field_array['tl_id']=$this->input->post('tl_id');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_icario/');
                    $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_ica_latest_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_ica_latest_feedback',$add_array);
					/*******************Fatal Call Email Send functionality added on 12-12-22 START ***********************/
					if($field_array['overall_score'] == 0){
						$tablename = "qa_amd_ica_latest_feedback";
						$sql = "SELECT tname.*, ip.email_id_off, ip_tl.email_id_off as tl_email, concat(s.fname, ' ', s.lname) as fullname,
							(SELECT concat(tls.fname, ' ', tls.lname) as tl_fullname FROM signin tls WHERE tls.id=tname.tl_id) as tl_fullname
							FROM $tablename tname
							LEFT JOIN info_personal ip ON ip.user_id=tname.agent_id 
							LEFT JOIN signin s ON s.id=tname.agent_id
							LEFT JOIN signin tl ON tl.id = tname.tl_id
							LEFT JOIN info_personal ip_tl ON ip_tl.user_id = tname.tl_id
							WHERE tname.id=$rowid";
						$result= $this->Common_model->get_query_row_array($sql);				
						$sqlParam ="SELECT process_id,params_columns, fatal_param,param_column_desc FROM qa_defect where table_name='$tablename'"; 
						$resultParams = $this->Common_model->get_query_row_array($sqlParam);
						
						$process = floor($resultParams['process_id']);
						$sqlProcess ="SELECT name FROM process where id='$process'"; 
						$resultProcess = $this->Common_model->get_query_row_array($sqlProcess);
						
						$params = explode(",", $resultParams['params_columns']);
						$fatal_params = explode(",", $resultParams['fatal_param']);
						$descArr = explode(",", $resultParams['param_column_desc']);
						
						$msgTable = "<Table BORDER=1>";
						$msgTable .= "<TR><TH>SL.</TH> <TH>CALL AUDIT PARAMETERS</TH><TH>QA Rating</TH><TH>QA Remarks</TH> </TR>";
						
						$i=1;
						$j=0;
						foreach($params as $par){
							//echo $str = str_replace('_', ' ', $par)."<BR>";
							if($result[$par]=='No'){
								$msgTable .= "<TR><TD>".$i."</TD><TD>". $descArr[$j]."</TD> <TD style='color:#FF0000'>".$result[$par]."</TD><TD>".$result['cmt'.$i]."</TD></TR>";
							}else{
								$msgTable .= "<TR><TD>".$i."</TD><TD>". $descArr[$j]."</TD> <TD>".$result[$par]."</TD><TD>".$result['cmt'.$i]."</TD></TR>";
							}
							
							$i++;
							$j++;
						}
						///////////////////////////
						//$j=1;
						/* if(!empty($fatal_params)){
							
							foreach($fatal_params as $fatal_par){
								if(!empty($fatal_par)){
								$msgTable .= "<TR><TD>".$i."</TD><TD style='color:#FF0000'>". $descArr[($j-21)]."</TD> <TD>".$result[$fatal_par]."</TD><TD>".$result['cmt'.($i-21)]."</TD></TR>";
								
								$i++;
								$j++;
								}
							}
						} */
						$msgTable .= "<TR><TD colspan='3'>Customer Score</TD> <TD>".$result['cust_score']."%</TD></TR>";
						$msgTable .= "<TR><TD colspan='3'>Business Score</TD> <TD>".$result['busi_score']."%</TD></TR>";
						$msgTable .= "<TR><TD colspan='3'>Compliance Score</TD> <TD>".$result['comp_score']."%</TD></TR>";
						
						
						$msgTable .= "<TR><TD colspan='3'>MECHANICS Score</TD> <TD>".$result['mechanics_overall_score']."%</TD></TR>";
						
						
						$msgTable .= "<TR><TD colspan='3'>SOFT SKILLS Score</TD> <TD>".$result['soft_skills_overall_score']."%</TD></TR>";
						
						
						$msgTable .= "<TR><TD colspan='3'>Overall Score</TD> <TD>".$result['overall_score']."%</TD></TR>";
						
						
						$msgTable .= "</Table>";
						
						$eccA=array();
						//$to = $result['tl_email']; // Have to open when email will trigger to the Respective TL of the Agent
						$to = 'mark.huber@fusionbposervices.com,ted.dulkoski@fusionbposervices.com,sarah.wolf@fusionbposervices.com,tina.church@fusionbposervices.com,amitabh.vartak@fusionbposervices.com,ashish.tere@fusionbposervices.com,Faisal.Anwar@fusionbposervices.com';
						
						$ebody = "Hello ". $result['tl_fullname'].",<br>";
						$ebody .= "<p>Agent Name : ".$result['fullname']."</p>";
						$ebody .= "<p>File No :  ".$result['file_no']."</p>";
						$ebody .= "<p>Total Talk time : ".$result['call_duration']."</p>";
						$ebody .= "<p>Audit Date time : ".ConvServerToLocal($result['entry_date'])."</p>";
						$ebody .= "<p>Call Summary : ".$result['call_summary']."</p>";
						$ebody .= "<p>Feedback : ".$result['feedback']."</p><br><br>";
						$ebody .= "<p>Please listen the call from the MWP Tool and share feedback acceptancy :</p>";
						$ebody .=  $msgTable;
						$ebody .= "<p>Regards,</p>";
						$ebody .= "<p>MWP Team</p>";
						$esubject = "Fatal Call Alert - "." For Process - ".$resultProcess['name'].", Agent Name - ".$result['fullname']." Audit Date - ".$result['audit_date'];
						
						//echo $ebody;
						//exit;
					
						$eccA[]="Bompalli.Somasundaram@omindtech.com";
						$eccA[]="deb.dasgupta@omindtech.com";
						$eccA[]="danish.khan@fusionbposervices.com";
						$eccA[]="sumitra.bagchi@omindtech.com";
						$eccA[]="anshuman.sarkar@fusionbposervices.com";
						
						$ecc = implode(',',$eccA);
						$path = "";
						$from_email="";
						$from_name="";
						
						/* echo $esubject."<br>";
						echo $ebody."<br>";
						exit;
						 */
						$send = $this->Email_model->send_email_sox("",$to, $ecc, $ebody, $esubject, $path, $from_email, $from_name, $isBcc="Y");
						unset($eccA);
					}
					
					
					/*******************Fatal Call Email Send functionality added on 12-12-22 END ***********************/

				}else{

					$field_array1=$this->input->post('data');
					//$field_array1['tl_id']=$this->input->post('tl_id');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_ica_latest_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $icario_id);
					$this->db->update('qa_amd_ica_latest_feedback',$edit_array);

				}
			// 	echo"<pre>";
			// print_r($field_array);
			// echo"</pre>";
			// exit;

				redirect('qa_ameridial/icario');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	///////////////////////VIKAS END/////////////////////////////


	public function add_edit_phone_inbound($phone_inbound_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/brightway/add_phone_inbound.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['phone_inbound_id']=$phone_inbound_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and is_assign_process(id,377) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_phone_inbound_feedback where id='$phone_inbound_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["phone_inbound_data"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($phone_inbound_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/qa_phone_inbound/');
                       $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_phone_inbound_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_phone_inbound_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $phone_inbound_id);
					$this->db->update('qa_amd_phone_inbound_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $phone_inbound_id);
					$this->db->update('qa_amd_phone_inbound_feedback',$edit_array);

				}

				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}

	}

	public function add_edit_phone_inbound_new($phone_inbound_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/brightway/add_phone_inbound_new.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['phone_inbound_id']=$phone_inbound_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,377) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_phone_inbound_new_feedback where id='$phone_inbound_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["phone_inbound_new_data"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($phone_inbound_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/qa_phone_inbound/');
                       $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_phone_inbound_new_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_phone_inbound_new_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $phone_inbound_id);
					$this->db->update('qa_amd_phone_inbound_new_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $phone_inbound_id);
					$this->db->update('qa_amd_phone_inbound_new_feedback',$edit_array);

				}

				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}

	}

	public function add_edit_processing($processing_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/brightway/add_edit_processing.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['processing_id']=$processing_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,377) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_processing_feedback where id='$processing_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["processing_data"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($processing_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/qa_processing/');
                       $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_processing_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_processing_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $processing_id);
					$this->db->update('qa_amd_processing_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $processing_id);
					$this->db->update('qa_amd_processing_feedback',$edit_array);

				}

				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}

	}


		public function add_edit_processing_new($processing_id){

        if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/brightway/add_edit_processing_new.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['processing_id']=$processing_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,377) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_processing_new_feedback where id='$processing_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["processing_data"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($processing_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/qa_processing/');
                       $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_processing_new_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_processing_new_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $processing_id);
					$this->db->update('qa_amd_processing_new_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $processing_id);
					$this->db->update('qa_amd_processing_new_feedback',$edit_array);

				}

				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}

	}

	public function mgnt_revel_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/revel/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_revel_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["revel_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["rvlid"]=$id;

			if($this->input->post('rvlid'))
			{
				$rvlid=$this->input->post('rvlid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"csr_id" => $this->input->post('csr_id'),
					//"call_type" => $this->input->post('call_type'),
					//"caller_type" => $this->input->post('caller_type'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"repgreetingcustomer" => $this->input->post('repgreetingcustomer'),
					"repuserespectfultone" => $this->input->post('repuserespectfultone'),
					"repasnwertimelymanner" => $this->input->post('repasnwertimelymanner'),
					"repcollectcallerinformation" => $this->input->post('repcollectcallerinformation'),
					"repuselisteningskills" => $this->input->post('repuselisteningskills'),
					"repdemonstratecalltechnique" => $this->input->post('repdemonstratecalltechnique'),
					"repreframeinterruptcaller" => $this->input->post('repreframeinterruptcaller'),
					"repspeakclearlyatpace" => $this->input->post('repspeakclearlyatpace'),
					"repavoiduseofterms" => $this->input->post('repavoiduseofterms'),
					"repconfidentinresponce" => $this->input->post('repconfidentinresponce'),
					"repusercallerlastname" => $this->input->post('repusercallerlastname'),
					"repusefiltertoobtain" => $this->input->post('repusefiltertoobtain'),
					"repmaintaincallcontrol" => $this->input->post('repmaintaincallcontrol'),
					"repusetoolappropiately" => $this->input->post('repusetoolappropiately'),
					"repdemonstrateproductknowledge" => $this->input->post('repdemonstrateproductknowledge'),
					"repuseappropiatescript" => $this->input->post('repuseappropiatescript'),
					"repaccuratelycalldocument" => $this->input->post('repaccuratelycalldocument'),
					"repcompletecorrectclosing" => $this->input->post('repcompletecorrectclosing'),
					"repthankthecaller" => $this->input->post('repthankthecaller'),
					"repgiveMedicaladvice" => $this->input->post('repgiveMedicaladvice'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"agentMiscodeCall" => $this->input->post('agentMiscodeCall'),
					"cmt21" => $this->input->post('cmt21'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $rvlid);
				$this->db->update('qa_amd_revel_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $rvlid);
				$this->db->update('qa_amd_revel_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/revel');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- REVEL (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- QPC (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function qpc(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qpc/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_qpc_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["qpc_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_qpc_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qpc/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){

				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					//"csr_id" => $this->input->post('csr_id'),
					//"call_type" => $this->input->post('call_type'),
					//"caller_type" => $this->input->post('caller_type'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"unpreparedCallIntroduce" => $this->input->post('unpreparedCallIntroduce'),
					"didnotUseBranding" => $this->input->post('didnotUseBranding'),
					"dataNotCollected" => $this->input->post('dataNotCollected'),
					"secondDataOccurrence" => $this->input->post('secondDataOccurrence'),
					"inaccurateCallResult" => $this->input->post('inaccurateCallResult'),
					"unusableAfterCallComment" => $this->input->post('unusableAfterCallComment'),
					"underutilizedCallNarration" => $this->input->post('underutilizedCallNarration'),
					"inappropiateFAQResponce" => $this->input->post('inappropiateFAQResponce'),
					"imprpperTransaction" => $this->input->post('imprpperTransaction'),
					"underAcknowledgeCaller" => $this->input->post('underAcknowledgeCaller'),
					"inappropiateScript" => $this->input->post('inappropiateScript'),
					"notDisplayOwnership" => $this->input->post('notDisplayOwnership'),
					"incorrectTransfer" => $this->input->post('incorrectTransfer'),
					"didagentabruptendcall" => $this->input->post('didagentabruptendcall'),
					"didagentanswerpremiumquestion" => $this->input->post('didagentanswerpremiumquestion'),
					"didagentgivewrongcallback" => $this->input->post('didagentgivewrongcallback'),
					"didagentuseincorrectname" => $this->input->post('didagentuseincorrectname'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/qpc/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_qpc_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_qpc_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/qpc');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_qpc_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qpc/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_qpc_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["qpc_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["qpcid"]=$id;

			if($this->input->post('qpcid'))
			{
				$qpcid=$this->input->post('qpcid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					//"csr_id" => $this->input->post('csr_id'),
					//"call_type" => $this->input->post('call_type'),
					//"caller_type" => $this->input->post('caller_type'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"unpreparedCallIntroduce" => $this->input->post('unpreparedCallIntroduce'),
					"didnotUseBranding" => $this->input->post('didnotUseBranding'),
					"dataNotCollected" => $this->input->post('dataNotCollected'),
					"secondDataOccurrence" => $this->input->post('secondDataOccurrence'),
					"inaccurateCallResult" => $this->input->post('inaccurateCallResult'),
					"unusableAfterCallComment" => $this->input->post('unusableAfterCallComment'),
					"underutilizedCallNarration" => $this->input->post('underutilizedCallNarration'),
					"inappropiateFAQResponce" => $this->input->post('inappropiateFAQResponce'),
					"imprpperTransaction" => $this->input->post('imprpperTransaction'),
					"underAcknowledgeCaller" => $this->input->post('underAcknowledgeCaller'),
					"inappropiateScript" => $this->input->post('inappropiateScript'),
					"notDisplayOwnership" => $this->input->post('notDisplayOwnership'),
					"incorrectTransfer" => $this->input->post('incorrectTransfer'),
					"didagentabruptendcall" => $this->input->post('didagentabruptendcall'),
					"didagentanswerpremiumquestion" => $this->input->post('didagentanswerpremiumquestion'),
					"didagentgivewrongcallback" => $this->input->post('didagentgivewrongcallback'),
					"didagentuseincorrectname" => $this->input->post('didagentuseincorrectname'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $qpcid);
				$this->db->update('qa_amd_qpc_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $qpcid);
				$this->db->update('qa_amd_qpc_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/qpc');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- QPC (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Ancient Nutrition (Start) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function ancient_nutrition(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ancient_nutrition/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_ancient_nutrition_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["ancient_nutrition_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_ancient_nutrition_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ancient_nutrition/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){

				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"repgreetingcustomer" => $this->input->post('repgreetingcustomer'),
					"repuserespectfultone" => $this->input->post('repuserespectfultone'),
					"repasnwertimelymanner" => $this->input->post('repasnwertimelymanner'),
					"repcollectcustomerinfo" => $this->input->post('repcollectcustomerinfo'),
					"repcoverpaymentprocedure" => $this->input->post('repcoverpaymentprocedure'),
					"repuselisteningskills" => $this->input->post('repuselisteningskills'),
					"repdemonstratecalltechnique" => $this->input->post('repdemonstratecalltechnique'),
					"repreframeinterruptcaller" => $this->input->post('repreframeinterruptcaller'),
					"repspeakclearlyatpace" => $this->input->post('repspeakclearlyatpace'),
					"repavoiduseinternalterms" => $this->input->post('repavoiduseinternalterms'),
					"repconfidentinresponce" => $this->input->post('repconfidentinresponce'),
					"repusercallerlastname" => $this->input->post('repusercallerlastname'),
					"repusefiltertoobtain" => $this->input->post('repusefiltertoobtain'),
					"repcoverautoshipping" => $this->input->post('repcoverautoshipping'),
					"repgatheredemail" => $this->input->post('repgatheredemail'),
					"repcoverRushshipping" => $this->input->post('repcoverRushshipping'),
					"repcompleteorderconfirmation" => $this->input->post('repcompleteorderconfirmation'),
					"repmaintaincallcontrol" => $this->input->post('repmaintaincallcontrol'),
					"repusetoolappropiately" => $this->input->post('repusetoolappropiately'),
					"repdemonstrateproductknowledge" => $this->input->post('repdemonstrateproductknowledge'),
					"repuseappropiateobjection" => $this->input->post('repuseappropiateobjection'),
					"repaccuratelycalldocument" => $this->input->post('repaccuratelycalldocument'),
					"repcompletecorrectclosing" => $this->input->post('repcompletecorrectclosing'),
					"repthankthecallerbeforeclosing" => $this->input->post('repthankthecallerbeforeclosing'),
					"repcoveroffersappropiately" => $this->input->post('repcoveroffersappropiately'),
					"repcoverupsellappropiately" => $this->input->post('repcoverupsellappropiately'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"cmt25" => $this->input->post('cmt25'),
					"cmt26" => $this->input->post('cmt26'),
					"agentReadConfirmScript" => $this->input->post('agentReadConfirmScript'),
					"cmt27" => $this->input->post('cmt27'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/ancient_nutrition/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_ancient_nutrition_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_ancient_nutrition_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/ancient_nutrition');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_ancient_nutrition_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ancient_nutrition/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_ancient_nutrition_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["ancient_nutrition_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["anid"]=$id;

			if($this->input->post('anid'))
			{
				$anid=$this->input->post('anid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"repgreetingcustomer" => $this->input->post('repgreetingcustomer'),
					"repuserespectfultone" => $this->input->post('repuserespectfultone'),
					"repasnwertimelymanner" => $this->input->post('repasnwertimelymanner'),
					"repcollectcustomerinfo" => $this->input->post('repcollectcustomerinfo'),
					"repcoverpaymentprocedure" => $this->input->post('repcoverpaymentprocedure'),
					"repuselisteningskills" => $this->input->post('repuselisteningskills'),
					"repdemonstratecalltechnique" => $this->input->post('repdemonstratecalltechnique'),
					"repreframeinterruptcaller" => $this->input->post('repreframeinterruptcaller'),
					"repspeakclearlyatpace" => $this->input->post('repspeakclearlyatpace'),
					"repavoiduseinternalterms" => $this->input->post('repavoiduseinternalterms'),
					"repconfidentinresponce" => $this->input->post('repconfidentinresponce'),
					"repusercallerlastname" => $this->input->post('repusercallerlastname'),
					"repusefiltertoobtain" => $this->input->post('repusefiltertoobtain'),
					"repcoverautoshipping" => $this->input->post('repcoverautoshipping'),
					"repgatheredemail" => $this->input->post('repgatheredemail'),
					"repcoverRushshipping" => $this->input->post('repcoverRushshipping'),
					"repcompleteorderconfirmation" => $this->input->post('repcompleteorderconfirmation'),
					"repmaintaincallcontrol" => $this->input->post('repmaintaincallcontrol'),
					"repusetoolappropiately" => $this->input->post('repusetoolappropiately'),
					"repdemonstrateproductknowledge" => $this->input->post('repdemonstrateproductknowledge'),
					"repuseappropiateobjection" => $this->input->post('repuseappropiateobjection'),
					"repaccuratelycalldocument" => $this->input->post('repaccuratelycalldocument'),
					"repcompletecorrectclosing" => $this->input->post('repcompletecorrectclosing'),
					"repthankthecallerbeforeclosing" => $this->input->post('repthankthecallerbeforeclosing'),
					"repcoveroffersappropiately" => $this->input->post('repcoveroffersappropiately'),
					"repcoverupsellappropiately" => $this->input->post('repcoverupsellappropiately'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"cmt25" => $this->input->post('cmt25'),
					"cmt26" => $this->input->post('cmt26'),
					"agentReadConfirmScript" => $this->input->post('agentReadConfirmScript'),
					"cmt27" => $this->input->post('cmt27'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $anid);
				$this->db->update('qa_amd_ancient_nutrition_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $anid);
				$this->db->update('qa_amd_ancient_nutrition_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/ancient_nutrition');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Ancient Nutrition (End) ---------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Power Fan (Start) ------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function power_fan(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/power_fan/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_powerfan_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["powerfan_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_powerfan_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/power_fan/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){

				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"answerCallWithin5sec" => $this->input->post('answerCallWithin5sec'),
					"agentIdentifySelftandCompany" => $this->input->post('agentIdentifySelftandCompany'),
					"collectIntroInformation" => $this->input->post('collectIntroInformation'),
					"mainSelftAgentGiveTerms" => $this->input->post('mainSelftAgentGiveTerms'),
					"agentPromoteUpsell" => $this->input->post('agentPromoteUpsell'),
					"describedProductAccurately" => $this->input->post('describedProductAccurately'),
					"useAppropiateObjection" => $this->input->post('useAppropiateObjection'),
					"askForBillingNamesOnCheck" => $this->input->post('askForBillingNamesOnCheck'),
					"agentVerifyCallerUseofCheck" => $this->input->post('agentVerifyCallerUseofCheck'),
					"askForBillingAddressForPayment" => $this->input->post('askForBillingAddressForPayment'),
					"agentVerifyShippingAddress" => $this->input->post('agentVerifyShippingAddress'),
					"orderWasSetUpAndCodedCorrectly" => $this->input->post('orderWasSetUpAndCodedCorrectly'),
					"askForEmailAddress" => $this->input->post('askForEmailAddress'),
					"gaveTotalAmountCharged" => $this->input->post('gaveTotalAmountCharged'),
					"gaveCorrectShippingInfo" => $this->input->post('gaveCorrectShippingInfo'),
					"gaveMBGInfo" => $this->input->post('gaveMBGInfo'),
					"gaveCSPhoneNumber" => $this->input->post('gaveCSPhoneNumber'),
					"permissionToAuthorizePayment" => $this->input->post('permissionToAuthorizePayment'),
					"wasAgentPolite" => $this->input->post('wasAgentPolite'),
					"agentUsingAppropiateComment" => $this->input->post('agentUsingAppropiateComment'),
					"useHoldAndTransferProperly" => $this->input->post('useHoldAndTransferProperly'),
					"power_fan_autofail" => $this->input->post('power_fan_autofail'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/power_fan/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_powerfan_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_powerfan_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/power_fan');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_powerfan_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/power_fan/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_powerfan_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["powerfan_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["pfid"]=$id;

			if($this->input->post('pfid'))
			{
				$pfid=$this->input->post('pfid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"answerCallWithin5sec" => $this->input->post('answerCallWithin5sec'),
					"agentIdentifySelftandCompany" => $this->input->post('agentIdentifySelftandCompany'),
					"collectIntroInformation" => $this->input->post('collectIntroInformation'),
					"mainSelftAgentGiveTerms" => $this->input->post('mainSelftAgentGiveTerms'),
					"agentPromoteUpsell" => $this->input->post('agentPromoteUpsell'),
					"describedProductAccurately" => $this->input->post('describedProductAccurately'),
					"useAppropiateObjection" => $this->input->post('useAppropiateObjection'),
					"askForBillingNamesOnCheck" => $this->input->post('askForBillingNamesOnCheck'),
					"agentVerifyCallerUseofCheck" => $this->input->post('agentVerifyCallerUseofCheck'),
					"askForBillingAddressForPayment" => $this->input->post('askForBillingAddressForPayment'),
					"agentVerifyShippingAddress" => $this->input->post('agentVerifyShippingAddress'),
					"orderWasSetUpAndCodedCorrectly" => $this->input->post('orderWasSetUpAndCodedCorrectly'),
					"askForEmailAddress" => $this->input->post('askForEmailAddress'),
					"gaveTotalAmountCharged" => $this->input->post('gaveTotalAmountCharged'),
					"gaveCorrectShippingInfo" => $this->input->post('gaveCorrectShippingInfo'),
					"gaveMBGInfo" => $this->input->post('gaveMBGInfo'),
					"gaveCSPhoneNumber" => $this->input->post('gaveCSPhoneNumber'),
					"permissionToAuthorizePayment" => $this->input->post('permissionToAuthorizePayment'),
					"wasAgentPolite" => $this->input->post('wasAgentPolite'),
					"agentUsingAppropiateComment" => $this->input->post('agentUsingAppropiateComment'),
					"useHoldAndTransferProperly" => $this->input->post('useHoldAndTransferProperly'),
					"power_fan_autofail" => $this->input->post('power_fan_autofail'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $pfid);
				$this->db->update('qa_amd_powerfan_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $pfid);
				$this->db->update('qa_amd_powerfan_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/power_fan');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- Power Fan (End) ------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- NuWave (Start) ------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function nuwave(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/nuwave/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,194) and is_assign_process(id,390) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_nuwave_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["nuwave"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_nuwave_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/nuwave/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,194) and is_assign_process(id,390) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){
				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"order_id" => $this->input->post('order_id'),
					"call_duration" => $this->input->post('call_duration'),
					"interaction" => $this->input->post('interaction'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"greeting_identification" => $this->input->post('greeting_identification'),
					"verified_customer" => $this->input->post('verified_customer'),
					"use_caller_CSR_name" => $this->input->post('use_caller_CSR_name'),
					"doesnot_interrupt_customer" => $this->input->post('doesnot_interrupt_customer'),
					"converses_clear_concise_mannaer" => $this->input->post('converses_clear_concise_mannaer'),
					"avoid_use_slang_jargon" => $this->input->post('avoid_use_slang_jargon'),
					"empathy_toward_customer" => $this->input->post('empathy_toward_customer'),
					"CSR_sound_helpful" => $this->input->post('CSR_sound_helpful'),
					"gain_customer_permission" => $this->input->post('gain_customer_permission'),
					"thanks_customer_holding" => $this->input->post('thanks_customer_holding'),
					"hold_time_appropiate" => $this->input->post('hold_time_appropiate'),
					"utilized_established_guidelines" => $this->input->post('utilized_established_guidelines'),
					"use_probing_question" => $this->input->post('use_probing_question'),
					"verbally_verfied_problem" => $this->input->post('verbally_verfied_problem'),
					"manage_customer_expectation" => $this->input->post('manage_customer_expectation'),
					"reason_for_troubleshooting" => $this->input->post('reason_for_troubleshooting'),
					"use_available_resources" => $this->input->post('use_available_resources'),
					"complete_customer_documentation" => $this->input->post('complete_customer_documentation'),
					"customer_comfortable_with_outcome" => $this->input->post('customer_comfortable_with_outcome'),
					"additional_needs_uncovered" => $this->input->post('additional_needs_uncovered'),
					"product_served_their_needs" => $this->input->post('product_served_their_needs'),
					"used_correct_closing" => $this->input->post('used_correct_closing'),
					"infractions" => $this->input->post('infractions'),
					"sub_infractions" => $this->input->post('sub_infractions'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/nuwave/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_nuwave_feedback',$field_array);

			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_nuwave_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/nuwave');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_nuwave_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/nuwave/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,194) and is_assign_process(id,390) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_nuwave_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["nuwave"] = $this->Common_model->get_query_row_array($qSql);

			$data["nwid"]=$id;

		///////Edit Part///////
			if($this->input->post('nwid'))
			{
				$nwid=$this->input->post('nwid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"order_id" => $this->input->post('order_id'),
					"call_duration" => $this->input->post('call_duration'),
					"interaction" => $this->input->post('interaction'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"greeting_identification" => $this->input->post('greeting_identification'),
					"verified_customer" => $this->input->post('verified_customer'),
					"use_caller_CSR_name" => $this->input->post('use_caller_CSR_name'),
					"doesnot_interrupt_customer" => $this->input->post('doesnot_interrupt_customer'),
					"converses_clear_concise_mannaer" => $this->input->post('converses_clear_concise_mannaer'),
					"avoid_use_slang_jargon" => $this->input->post('avoid_use_slang_jargon'),
					"empathy_toward_customer" => $this->input->post('empathy_toward_customer'),
					"CSR_sound_helpful" => $this->input->post('CSR_sound_helpful'),
					"gain_customer_permission" => $this->input->post('gain_customer_permission'),
					"thanks_customer_holding" => $this->input->post('thanks_customer_holding'),
					"hold_time_appropiate" => $this->input->post('hold_time_appropiate'),
					"utilized_established_guidelines" => $this->input->post('utilized_established_guidelines'),
					"use_probing_question" => $this->input->post('use_probing_question'),
					"verbally_verfied_problem" => $this->input->post('verbally_verfied_problem'),
					"manage_customer_expectation" => $this->input->post('manage_customer_expectation'),
					"reason_for_troubleshooting" => $this->input->post('reason_for_troubleshooting'),
					"use_available_resources" => $this->input->post('use_available_resources'),
					"complete_customer_documentation" => $this->input->post('complete_customer_documentation'),
					"customer_comfortable_with_outcome" => $this->input->post('customer_comfortable_with_outcome'),
					"additional_needs_uncovered" => $this->input->post('additional_needs_uncovered'),
					"product_served_their_needs" => $this->input->post('product_served_their_needs'),
					"used_correct_closing" => $this->input->post('used_correct_closing'),
					"infractions" => $this->input->post('infractions'),
					"sub_infractions" => $this->input->post('sub_infractions'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $nwid);
				$this->db->update('qa_amd_nuwave_feedback',$field_array);

			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $nwid);
				$this->db->update('qa_amd_nuwave_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/nuwave');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- NuWave (End) ------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

//////////*----------------------------------------------------------------- HEALTHCARE -------------------------------------------------------------------------*//////////

///////////////////////////////////////////////////////////////////////////////////
/*-------------------------------- SABAL (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function sabal(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/sabal/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_sabal_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["sabal_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_sabal_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/sabal/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){

				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentaskIndividualName" => $this->input->post('agentaskIndividualName'),
					"agentIntroduceHimHerself" => $this->input->post('agentIntroduceHimHerself'),
					"agentStateCustomerService" => $this->input->post('agentStateCustomerService'),
					"agentApologizePhoneCall" => $this->input->post('agentApologizePhoneCall'),
					"agentIndividualRXplan" => $this->input->post('agentIndividualRXplan'),
					"agentReadListedExample" => $this->input->post('agentReadListedExample'),
					"agentAskIndividualColorCard" => $this->input->post('agentAskIndividualColorCard'),
					"agentAskIndividualUpdate" => $this->input->post('agentAskIndividualUpdate'),
					"agentAskIndividualEffectiveDate" => $this->input->post('agentAskIndividualEffectiveDate'),
					"agentUseCorrectRebuttal" => $this->input->post('agentUseCorrectRebuttal'),
					"agentUseIndividualScript" => $this->input->post('agentUseIndividualScript'),
					"agentSaysHeShenotInterested" => $this->input->post('agentSaysHeShenotInterested'),
					"agentAbruptlyEndCall" => $this->input->post('agentAbruptlyEndCall'),
					"agentbecomeUrgumentative" => $this->input->post('agentbecomeUrgumentative'),
					"agentRecordIncirrectMedicare" => $this->input->post('agentRecordIncirrectMedicare'),
					"agentProvideFalseInformation" => $this->input->post('agentProvideFalseInformation'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/sabal/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_sabal_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_sabal_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/sabal');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_sabal_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/sabal/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_sabal_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["sabal_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["sabalid"]=$id;

			if($this->input->post('sabalid'))
			{
				$sabalid=$this->input->post('sabalid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"agentaskIndividualName" => $this->input->post('agentaskIndividualName'),
					"agentIntroduceHimHerself" => $this->input->post('agentIntroduceHimHerself'),
					"agentStateCustomerService" => $this->input->post('agentStateCustomerService'),
					"agentApologizePhoneCall" => $this->input->post('agentApologizePhoneCall'),
					"agentIndividualRXplan" => $this->input->post('agentIndividualRXplan'),
					"agentReadListedExample" => $this->input->post('agentReadListedExample'),
					"agentAskIndividualColorCard" => $this->input->post('agentAskIndividualColorCard'),
					"agentAskIndividualUpdate" => $this->input->post('agentAskIndividualUpdate'),
					"agentAskIndividualEffectiveDate" => $this->input->post('agentAskIndividualEffectiveDate'),
					"agentUseCorrectRebuttal" => $this->input->post('agentUseCorrectRebuttal'),
					"agentUseIndividualScript" => $this->input->post('agentUseIndividualScript'),
					"agentSaysHeShenotInterested" => $this->input->post('agentSaysHeShenotInterested'),
					"agentAbruptlyEndCall" => $this->input->post('agentAbruptlyEndCall'),
					"agentbecomeUrgumentative" => $this->input->post('agentbecomeUrgumentative'),
					"agentRecordIncirrectMedicare" => $this->input->post('agentRecordIncirrectMedicare'),
					"agentProvideFalseInformation" => $this->input->post('agentProvideFalseInformation'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $sabalid);
				$this->db->update('qa_amd_sabal_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $sabalid);
				$this->db->update('qa_amd_sabal_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/sabal');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*------------------------------- SABAL (End) ---------------------------------*/
///////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////
/*-------------------------------- CURATIVE (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function curative(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/curative/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,302) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_curative_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["curative_data"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_curative_feedback(){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/curative/add_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,302) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			if($this->input->post('agent_id')){

				$field_array=array(
					"audit_date" => CurrDate(),
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"greetCustomerProperly" => $this->input->post('greetCustomerProperly'),
					"useRespectfulTone" => $this->input->post('useRespectfulTone'),
					"answerInTimelyManner" => $this->input->post('answerInTimelyManner'),
					"verifyCustomerInformation" => $this->input->post('verifyCustomerInformation'),
					"verifyPatientPHI" => $this->input->post('verifyPatientPHI'),
					"agentProvideAccurateResult" => $this->input->post('agentProvideAccurateResult'),
					"accidentalIncorrectInformation" => $this->input->post('accidentalIncorrectInformation'),
					"agentEscalateTier2Correctly" => $this->input->post('agentEscalateTier2Correctly'),
					"agentRespectPatientPrivacy" => $this->input->post('agentRespectPatientPrivacy'),
					"agentSpeakConcisely" => $this->input->post('agentSpeakConcisely'),
					"agentAvoidInternalTerms" => $this->input->post('agentAvoidInternalTerms'),
					"agentDemonstrateEmpathyUse" => $this->input->post('agentDemonstrateEmpathyUse'),
					"agentUsePleaseThankyou" => $this->input->post('agentUsePleaseThankyou'),
					"agentMinimizeExtendedSilence" => $this->input->post('agentMinimizeExtendedSilence'),
					"agentSpeakWarmthVoice" => $this->input->post('agentSpeakWarmthVoice'),
					"agentDemonstrateCallerPatient" => $this->input->post('agentDemonstrateCallerPatient'),
					"repCompletlyCallDocument" => $this->input->post('repCompletlyCallDocument'),
					"repConfirmCompleteClosing" => $this->input->post('repConfirmCompleteClosing'),
					"thankCallerBeforeClosing" => $this->input->post('thankCallerBeforeClosing'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"agentEnsureEmailAddress" => $this->input->post('agentEnsureEmailAddress'),
					"agentUseCorrectSentence" => $this->input->post('agentUseCorrectSentence'),
					"callerGaveAgentKUDOS" => $this->input->post('callerGaveAgentKUDOS'),
					"repDoEverythingPossible" => $this->input->post('repDoEverythingPossible'),
					"repAncipateCallerNeed" => $this->input->post('repAncipateCallerNeed'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback'),
					"entry_date" => $curDateTime,
					"audit_start_time" => $this->input->post('audit_start_time')
				);
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/curative/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_curative_feedback',$field_array);
			/////////////
				if(get_login_type()=="client"){
					$field_array1 = array("client_entryby" => $current_user);
				}else{
					$field_array1 = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_curative_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/curative');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


	public function mgnt_curative_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/curative/mgnt_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,302) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_curative_feedback where id='$id') xx Left Join
				(Select office_id,id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["curative_data"] = $this->Common_model->get_query_row_array($qSql);

			$data["curid"]=$id;

			if($this->input->post('curid'))
			{
				$curid=$this->input->post('curid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array = array(
					"agent_id" => $this->input->post('agent_id'),
					"tl_id" => $this->input->post('tl_id'),
					"call_date" => mmddyy2mysql($this->input->post('call_date')),
					"file_no" => $this->input->post('file_no'),
					"call_duration" => $this->input->post('call_duration'),
					"audit_type" => $this->input->post('audit_type'),
					"auditor_type" => $this->input->post('auditor_type'),
					"voc" => $this->input->post('voc'),
					"possible_score" => $this->input->post('possible_score'),
					"earned_score" => $this->input->post('earned_score'),
					"overall_score" => $this->input->post('overall_score'),
					"greetCustomerProperly" => $this->input->post('greetCustomerProperly'),
					"useRespectfulTone" => $this->input->post('useRespectfulTone'),
					"answerInTimelyManner" => $this->input->post('answerInTimelyManner'),
					"verifyCustomerInformation" => $this->input->post('verifyCustomerInformation'),
					"verifyPatientPHI" => $this->input->post('verifyPatientPHI'),
					"agentProvideAccurateResult" => $this->input->post('agentProvideAccurateResult'),
					"accidentalIncorrectInformation" => $this->input->post('accidentalIncorrectInformation'),
					"agentEscalateTier2Correctly" => $this->input->post('agentEscalateTier2Correctly'),
					"agentRespectPatientPrivacy" => $this->input->post('agentRespectPatientPrivacy'),
					"agentSpeakConcisely" => $this->input->post('agentSpeakConcisely'),
					"agentAvoidInternalTerms" => $this->input->post('agentAvoidInternalTerms'),
					"agentDemonstrateEmpathyUse" => $this->input->post('agentDemonstrateEmpathyUse'),
					"agentUsePleaseThankyou" => $this->input->post('agentUsePleaseThankyou'),
					"agentMinimizeExtendedSilence" => $this->input->post('agentMinimizeExtendedSilence'),
					"agentSpeakWarmthVoice" => $this->input->post('agentSpeakWarmthVoice'),
					"agentDemonstrateCallerPatient" => $this->input->post('agentDemonstrateCallerPatient'),
					"repCompletlyCallDocument" => $this->input->post('repCompletlyCallDocument'),
					"repConfirmCompleteClosing" => $this->input->post('repConfirmCompleteClosing'),
					"thankCallerBeforeClosing" => $this->input->post('thankCallerBeforeClosing'),
					"cmt1" => $this->input->post('cmt1'),
					"cmt2" => $this->input->post('cmt2'),
					"cmt3" => $this->input->post('cmt3'),
					"cmt4" => $this->input->post('cmt4'),
					"cmt5" => $this->input->post('cmt5'),
					"cmt6" => $this->input->post('cmt6'),
					"cmt7" => $this->input->post('cmt7'),
					"cmt8" => $this->input->post('cmt8'),
					"cmt9" => $this->input->post('cmt9'),
					"cmt10" => $this->input->post('cmt10'),
					"cmt11" => $this->input->post('cmt11'),
					"cmt12" => $this->input->post('cmt12'),
					"cmt13" => $this->input->post('cmt13'),
					"cmt14" => $this->input->post('cmt14'),
					"cmt15" => $this->input->post('cmt15'),
					"cmt16" => $this->input->post('cmt16'),
					"cmt17" => $this->input->post('cmt17'),
					"cmt18" => $this->input->post('cmt18'),
					"cmt19" => $this->input->post('cmt19'),
					"agentEnsureEmailAddress" => $this->input->post('agentEnsureEmailAddress'),
					"agentUseCorrectSentence" => $this->input->post('agentUseCorrectSentence'),
					"callerGaveAgentKUDOS" => $this->input->post('callerGaveAgentKUDOS'),
					"repDoEverythingPossible" => $this->input->post('repDoEverythingPossible'),
					"repAncipateCallerNeed" => $this->input->post('repAncipateCallerNeed'),
					"cmt20" => $this->input->post('cmt20'),
					"cmt21" => $this->input->post('cmt21'),
					"cmt22" => $this->input->post('cmt22'),
					"cmt23" => $this->input->post('cmt23'),
					"cmt24" => $this->input->post('cmt24'),
					"call_summary" => $this->input->post('call_summary'),
					"feedback" => $this->input->post('feedback')
				);
				$this->db->where('id', $curid);
				$this->db->update('qa_amd_curative_feedback',$field_array);
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $curid);
				$this->db->update('qa_amd_curative_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/curative');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*------------------------------- CURATIVE (End) --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Episource (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function episource(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/episource/qa_amd_episource_feedback.php";

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

		////////////////////////
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_episource_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["hra_new_data"] = $this->Common_model->get_query_result_array($qSql);
		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_amd_episource_new(){

		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/episource/add_amd_episource_new.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";
			if($field_array['agent_id']){
				// echo var_dump(mmddyy2mysql($this->input->post('call_date')));
				// die;
				$field_array=$this->input->post('data');
				$field_array['audit_date']=CurrDate();
				$field_array['entry_by']=$current_user;
				$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
				$field_array['entry_date']=$curDateTime;
				$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/episource/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_episource_feedback',$field_array);
				redirect('Qa_ameridial/episource');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_amd_episource_rvw($id){

		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/episource/mgnt_amd_episource_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_episource_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["hra_new"] = $this->Common_model->get_query_row_array($qSql);

			$data["pnid"]=$id;

		///////Edit Part///////
			if($this->input->post('pnid'))
			{
				$pnid=$this->input->post('pnid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array=$this->input->post('data');
				$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
				$this->db->where('id', $pnid);
				$this->db->update('qa_amd_episource_feedback',$field_array);

			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $pnid);
				$this->db->update('qa_amd_episource_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/episource');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Episource (End) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Magnilife (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function magnilife(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/magnilife/qa_amd_magnilife_feedback.php";

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

		////////////////////////
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_magnilife_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["msb_new_data"] = $this->Common_model->get_query_result_array($qSql);
		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;

			$this->load->view("dashboard",$data);
		}
	}

	public function add_amd_magnilife($stratAuditTime){

		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/magnilife/add_amd_magnilife.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,195) and is_assign_process(id,391) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);
			$data["stratAuditTime"]=$stratAuditTime;
			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";
			if($field_array['agent_id']){
				// echo var_dump(mmddyy2mysql($this->input->post('call_date')));
				// die;
				$field_array=$this->input->post('data');
				$field_array['audit_date']=CurrDate();
				$field_array['entry_by']=$current_user;
				$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
				$field_array['entry_date']=$curDateTime;
				$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/magnilife/');
				$field_array["attach_file"] = implode(',',$a);
				$rowid= data_inserter('qa_amd_magnilife_feedback',$field_array);
				redirect('Qa_ameridial/magnilife');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	public function mgnt_amd_magnilife_rvw($id){

		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/magnilife/mgnt_amd_magnilife_rvw.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,195) and is_assign_process(id,391) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_magnilife_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data["msb_new"] = $this->Common_model->get_query_row_array($qSql);

			$data["pnid"]=$id;

		///////Edit Part///////
			if($this->input->post('pnid'))
			{
				$pnid=$this->input->post('pnid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array=$this->input->post('data');
				$this->db->where('id', $pnid);
				$this->db->update('qa_amd_magnilife_feedback',$field_array);

			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $pnid);
				$this->db->update('qa_amd_magnilife_feedback',$field_array1);
			///////////
				redirect('Qa_ameridial/magnilife');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}
///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Magnilife (End) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////


///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Blains (Start) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////


public function process($page="",$parm="",$formparam=""){

		if ($parm=="add") {
			$this->add_process($page,$formparam);
			//$this->add_process_v2($page,$formparam);
		}elseif ($parm=="mgnt_rvw") {
			$this->mgnt_process_rvw($page,$formparam);
		}elseif($parm=="agent"){
			$this->agent_process_feedback($page);
		}elseif($parm=="agnt_feedback"){
			$this->agent_process_rvw($page,$formparam);
		}else{
			$this->$page();
		}

	}

public function blains(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$page="blains";
			// $table="blains_v2";
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/qa_amd_".$page."_feedback.php";
			$data["page"]=$page;
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,271) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

		////////////////////////
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

			if(get_user_fusion_id()=='FHIG000319'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_new_data"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_v2_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_v2_new_data"] = $this->Common_model->get_query_result_array($qSql);

			// $qSql = "SELECT *,xx.entry_by as auditor_name, xx.mgnt_rvw_by as mgnt_rvw_name from
			// 	(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			// 	(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			// 	(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			// 	(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_v2_feedback $cond) xx Left Join
			// 	(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			// $data[$page."_v2_new_data"] = $this->Common_model->get_query_result_array($qSql);
			

			// echo '<pre>';
			// print_r($data);
			// die();
		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}


//////////////////////// Add Blains //////////////////////////////////////////////

	public function add_process($page="",$stratAuditTime=""){

		if(check_logged_in())
		{
			$current_user=get_user_id();
			//$current_user_name= get_username();
			
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/add_amd_".$page.".php";
			//$data["content_js"] = "qa_".$page."_js.php";
			//$data["content_js"] = "qa_ameridial_js.php";
			$data["page"]=$page;


			if($page=="trapollo"){

				$data["scoreCard"]=$this->scoreCard();
				$data["scoreVal"]=$this->scoreVal();
				$data["columname"]=$this->trapollo_columnname();
				$data["scoreParametername"]=$this->parameter_trapollo_scrorecard_details();
			}

			if($page=="sontiq"){
						$table=$page;
						$tableTemp=$table;
						$data["page"]=$table;
						$columname=$page."_columnname";
						$scoreParametername="parameter_".$page."_scrorecard_details";
						$scoreVal=$page."ScoreVal";
						$scoreCardFunc=$page."ScoreCardFunc";
						$titleVal=$page."TitleVal";
						$rowspanVal=$page."TitleRowSpanVal";
						$autofail=$page."AutoFailParam";
						$busiCompCustScore=$page."BusiCompCustScore";
						$nonSelectTDDetails=$page."NonSelectTDDetails";
						$paramId=$page."ParamId";
						$data["paramId"]=$this->$paramId();
						$data["autofail"]=$this->$autofail();
						$data["busiCompCustScore"]=$this->$busiCompCustScore();
						$data["nonSelectTDDetails"]=$this->$nonSelectTDDetails();
						$data['titleVal']=$this->$titleVal();
						$data['rowspanVal']=$this->$rowspanVal();
						$data["columname"]=$this->$columname();
						$data["scoreParametername"]=$this->$scoreParametername();
						$data['paramCount']=count($data["scoreParametername"]);
						$data["scoreVal"]=$this->$scoreVal();
						$data["scoreCardFunc"]=$this->$scoreCardFunc();
						$data["scoreCard1"]=$this->sontiqScoreCard1();
						$data["scoreCard2"]=$this->sontiqScoreCard2();
						$data["scoreCard3"]=$this->sontiqScoreCard3();
			}

				/* if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user')) and ";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" where assigned_to='$current_user' and ";
				}else{
					$ops_cond=" where ";
				} */

				if(get_user_fusion_id()=='FMON004078' || get_user_fusion_id()=='FMON004090' || get_user_fusion_id()=='FSPI000117'){
					$ops_cond=" where ";
				}else{
					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user')) and";
					}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
						$ops_cond=" Where assigned_to='$current_user' and";
					}else{
						$ops_cond=" where ";
					}
				}

			if($page=='delta'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,133) and is_assign_process(id,268) and status=1  order by name";
			}else if($page=='trapollo'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,133) and is_assign_process(id,443) and status=1  order by name";
			}else if($page=='brightway_prescreen' || $page=='brightway_evaluation'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and is_assign_process(id,377) and status=1 order by name";
			}else if($page=='follet'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and (is_assign_client (id,184) or is_assign_client (id,185)) and (is_assign_process (id,378) or is_assign_process (id,379)) and status=1  order by name";
			}else if($page=='blains' || $page=='blains_v2'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and is_assign_process(id,271) and status=1 order by name";
			}else if($page=='sontiq'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client (id,134) and is_assign_process(id,465) and status=1  order by name";
			}else{
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client (id,134) and status=1  order by name";
			}
			// echo $qSql;
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			
			$qSql="SELECT id, concat(fname, ' ', lname) as name, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1 order by name ASC";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);
			
			/******** Randamiser Start for Blains Auditsheet***********/
			if(($page =='blains') || ($page =='blains_v2')){
				$rand_id=0;
				if(!empty($this->uri->segment(6))){
					$rand_id=$this->uri->segment(6);
				}
				$data['rand_id']=$rand_id;
				$data["rand_data"] = "";
				if($rand_id!=0){
					$client_id=134;
					$pro_id = 271;
					$curDateTime=CurrMySqlDate();
					$upArr = array('distribution_opend_by' =>$current_user,'distribution_opened_datetime'=>$curDateTime);
					$this->db->where('id', $rand_id);
					$this->db->update('qa_randamiser_blains_data',$upArr);
					
					$randSql="Select srd.*,srd.aht as call_duration, S.id as sid, S.fname, S.lname, S.xpoid, S.assigned_to,
					(select concat(fname, ' ', lname) as name from signin s1 where s1.id=S.assigned_to) as tl_name,DATEDIFF(CURDATE(), S.doj) as tenure
					from qa_randamiser_blains_data srd Left Join signin S On srd.fusion_id=S.fusion_id where srd.audit_status=0 and srd.id='$rand_id'";
					$data["rand_data"] = $rand_data =  $this->Common_model->get_query_row_array($randSql);
					
					// echo '<pre>';
					// print_r($data);
					// echo '</pre>';
					// die();
				}
			}
			//print_r($data["rand_data"]);
			/******** Randamiser Ends**********/
			$data["stratAuditTime"]=$stratAuditTime;
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";
			if($field_array['agent_id']){
				$field_array=$this->input->post('data');
				$field_array['audit_date']=CurrDate();
				$field_array['entry_date']=$curDateTime;
				$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));

				if(get_login_type()=="client"){
					$field_array['client_entryby']=$current_user;
				}else{
					$field_array['entry_by']=$current_user;
				}

				$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/'.$page);
				$field_array["attach_file"] = implode(',',$a);
				// echo '<pre>';
				// print_r($field_array);
				// echo '</pre>';
				// exit;
				$rowid= data_inserter('qa_amd_'.$page.'_feedback',$field_array);
				
				//redirect('qa_ameridial/blains');
				
				if(in_array($page,array("brightway_prescreen","brightway_evaluation"))){
					$page="brightway";
				}
				
				if(($page =='blains') || ($page =='blains_v2'))
				{
					if($rand_id!=0){
					$rand_cdr_array = array("audit_status" => 1);
					$this->db->where('id', $rand_id);
					$this->db->update('qa_randamiser_blains_data',$rand_cdr_array);
					
					$rand_array = array("is_rand" => 1);
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_'.$page.'_feedback',$rand_array);

					/* $rand_array = array("is_rand" => 1);
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_blains_v2_feedback',$rand_array); */
					}
					
					if(isset($rand_data['upload_date']) && !empty($rand_data['upload_date'])){
						$up_date = date('Y-m-d', strtotime($rand_data['upload_date']));
						redirect('Qa_randamiser/data_distribute_freshdesk?from_date='.$up_date.'&client_id='.$client_id.'&pro_id='.$pro_id.'&submit=Submit');
					}else{
						redirect('qa_ameridial/blains');
					}
				
				}
				redirect('Qa_ameridial/'.$page);
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	

/////////////////////////////// MGNT Blains ///////////////////////////////////////

public function mgnt_process_rvw($page,$id){

		if(check_logged_in()){
			$current_user=get_user_id();
		//	$current_user_name= get_username();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/mgnt_amd_".$page."_rvw.php";
			// $data["content_js"] = "qa_".$page."_js.php";
			$data["page"]=$page;

			if($page=="trapollo"){

				$data["scoreCard"]=$this->scoreCard();
				$data["scoreVal"]=$this->scoreVal();
				$data["columname"]=$this->trapollo_columnname();
				$data["scoreParametername"]=$this->parameter_trapollo_scrorecard_details();
			}

			if($page=="sontiq"){
						$table=$page;
						$tableTemp=$table;
						$data["page"]=$table;
						$columname=$page."_columnname";
						$scoreParametername="parameter_".$page."_scrorecard_details";
						$scoreVal=$page."ScoreVal";
						$scoreCardFunc=$page."ScoreCardFunc";
						$titleVal=$page."TitleVal";
						$rowspanVal=$page."TitleRowSpanVal";
						$autofail=$page."AutoFailParam";
						$busiCompCustScore=$page."BusiCompCustScore";
						$nonSelectTDDetails=$page."NonSelectTDDetails";
						$paramId=$page."ParamId";
						$data["paramId"]=$this->$paramId();
						$data["autofail"]=$this->$autofail();
						$data["busiCompCustScore"]=$this->$busiCompCustScore();
						$data["nonSelectTDDetails"]=$this->$nonSelectTDDetails();
						$data['titleVal']=$this->$titleVal();
						$data['rowspanVal']=$this->$rowspanVal();
						$data["columname"]=$this->$columname();
						$data["scoreParametername"]=$this->$scoreParametername();
						$data['paramCount']=count($data["scoreParametername"]);
						$data["scoreVal"]=$this->$scoreVal();
						$data["scoreCardFunc"]=$this->$scoreCardFunc();
						$data["scoreCard1"]=$this->sontiqScoreCard1();
						$data["scoreCard2"]=$this->sontiqScoreCard2();
						$data["scoreCard3"]=$this->sontiqScoreCard3();
			}

			/* if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user')) and ";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" where assigned_to='$current_user' and ";
				}else{
					$ops_cond=" where ";
				} */

				if(get_user_fusion_id()=='FMON004078' || get_user_fusion_id()=='FMON004090' || get_user_fusion_id()=='FSPI000117'){
					$ops_cond=" where ";
				}else{
					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user')) and";
					}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
						$ops_cond=" Where assigned_to='$current_user' and";
					}else{
						$ops_cond=" where ";
					}
				}

				$table_cal=$page;

			if($page=='delta'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,133) and is_assign_process(id,268) and status=1  order by name";
			}else if($page=='trapollo'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,133) and is_assign_process(id,443) and status=1  order by name";
			}else if($page=='follet'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and (is_assign_client (id,184) or is_assign_client (id,185)) and (is_assign_process (id,378) or is_assign_process (id,379)) and status=1  order by name";
			}else if($page=='blains' || $page=='blains_v2'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and is_assign_process(id,271) and status=1 order by name";
			}else if($page=='brightway_prescreen' || $page=='brightway_evaluation'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and is_assign_process(id,377) and status=1 order by name";
			}else if($page=='sontiq'){
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client (id,134) and is_assign_process(id,465) and status=1  order by name";
			}else{
				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client (id,134) and status=1  order by name";
			}

			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$table_cal."_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid)";
			$data[$table_cal."_new"] = $this->Common_model->get_query_row_array($qSql);

			$data["pnid"]=$id;

		///////Edit Part///////
			if($this->input->post('pnid'))
			{
				$pnid=$this->input->post('pnid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array=$this->input->post('data');
				$this->db->where('id', $pnid);
				$this->db->update('qa_amd_'.$table_cal.'_feedback',$field_array);

				
			////////////
				if(get_login_type()=="client"){
					$field_array1 = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$field_array1 = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
					
				
				}
				$this->db->where('id', $pnid);
				$this->db->update('qa_amd_'.$table_cal.'_feedback',$field_array1);
				redirect('qa_ameridial/blains');
			///////////
				if(in_array($table_cal,array("brightway_prescreen","brightway_evaluation"))){
					$table_cal="brightway";
				}
				redirect('Qa_ameridial/'.$table_cal);

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}

	

///////////////////////////////////////////////////////////////////////////////////
/*----------------------------- Blains (End) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////



///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Pajama (Start) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

public function pajamagram(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$page="pajamagram";
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/qa_amd_".$page."_feedback.php";
			$data["page"]=$page;
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

		////////////////////////
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_new_data"] = $this->Common_model->get_query_result_array($qSql);
		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Pajama (End) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// SOTIQ (Start) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

public function sontiq(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$page="sontiq";
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/qa_amd_".$page."_feedback.php";
			$data["page"]=$page;

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and is_assign_process(id,465) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond='';
			$ops_cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_amd_".$page."_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_new_data"] = $this->Common_model->get_query_result_array($qSql);
		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// SONTIQ (End) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Delta (Start) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

	public function delta(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$page="delta";
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/qa_amd_".$page."_feedback.php";
			$data["page"]=$page;
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,133) and is_assign_process (id,268) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

		////////////////////////
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

			/* if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			} */

			if(get_user_fusion_id()=='FSPI000117'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_new_data"] = $this->Common_model->get_query_result_array($qSql);
		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}


public function scoreCard(){
    	return $arrayName = array('Effective','Unacceptable','N/A');
    }

public function scoreVal(){
    	return $arrayName = array("val0"=>"0","val1"=>"1","val1p5"=>"1.5","val2"=>"2","val3"=>"3","val4"=>"4","val5"=>"5","val6"=>"6","val8"=>"8","val10"=>"10","val15"=>"15");
    }

public function trapollo_columnname(){
    	return array("promply","goodTimeTalk","callRecord","priorReaching","memberCorrectly","availabilityBox","availabilityTape","callerIns","confirmAddress","dateSpecified","handledEffectively","leastOnce","pleaseThankYou","silencesCall","agentSpeak","agentSpeakClearly","repReapeat","memberQuestions","anythingElse","memberCall","TMCfollowing","ticketNote","promisedTime","custEmpathy","repMember","callPromised","agentConfirmAdd","properGreeting","agentDocument");
    }

public function parameter_trapollo_scrorecard_details(){
    	return array("1.1 Did the rep greet the caller promptly and properly?","1.2 Did the rep ask if it is a good time to talk?","1.3 Did the rep advise that the call is recorded?","2.1 Did the rep try all phone numbers on file prior to reaching back out to the customer?","2.2 Did the rep verify the member correctly?","2.3 Did the agent correctly check availability of box?","2.4 Did the rep correctly check availability of tape?","2.5 Did the rep refer the caller to the instructions in the box? ","2.6 Did the rep confirm the address?","2.7 Was the correct call tag initiated and pick up by date specified?","3.1 Did the agent reassure the caller that everything would be handled effectively?","3.3 Did the agent address the member by name at least once?","3.4 Did the agent use 'please' and 'thank you' throughout the call?","3.5 Did the agent minimize extended silences throughout the call?","3.6 Did the agent speak with sincere warmth in his/her voice? (empathy)","3.7 Did the agent speak clearly?","4.1 Did the rep repeat or reiterate the instructions so that they are clear?","4.2 Did the rep ask if the member had any questions or was clear on the process?","4.3 Did the rep ask if there was anything else we could help with? ","4.4 Did the rep collect a good call back number?","4.5 Did the rep leave complete, detailed notes in documentation in TMC following the 5 'w s?'","4.1 Did the rep have all information updated correctly in the ticket note?","4.2 If a callback was promised, was this done on time?","4.3 Did the rep treat the customer with both empathy and respect and behave professionally?","4.4 Did the rep call the correct member?","4.5 Did the rep initiate the call tag as promised?","4.6 Did the agent confirm the address?","4.7 Did the agent use the proper greeting? ","4.8 Did the agent document using the 4 'w s?'");
    }

	public function sontiqScoreCard1(){
    	return $arrayName = array(10,5,1);
    }

    public function sontiqScoreCard2(){
    	return $arrayName = array(10,1,'N/A');
    }

    public function sontiqScoreCard3(){
    	return $arrayName = array('YES','NO');
    }

    public function sontiqScoreVal(){
    	return $arrayName = array(10,10,10,10,10,10,10,15,15);
    }

    public function sontiqScoreCardFunc(){
    	return $arrayName = array(1,1,1,1,1,2,1,3,3);
    }

    public function sontiq_columnname(){
    	return array("Procedural_Execution","Information_Accuracy","Service_Adherence","Activity_Accuracy","Records_Documentation","Survey_Completion","Interaction_Engagement","Security","Professionalism");
    }

    public function sontiqTitleVal(){
    	return array(0=>"ISSUE MANAGEMENT",4=>"RECORDS MANAGEMENT",8=>"CALL EXPERIENCE",10=>"COMPLIANCE");
    }

    public function sontiqTitleRowSpanVal(){
    	return array(0=>4,4=>4,8=>2,10=>3);
    }

    public function sontiqAutoFailParam(){
    	return array();
    }

    public function sontiqBusiCompCustScore(){
    	return array("sec1","sec1","sec1","sec2","sec2","sec2","sec3","sec4","sec4");
    }

    public function sontiqParamId(){
    	return array(3=>"sec1",7=>"sec2",9=>"sec3",12=>"sec4");
    }

    public function sontiqNonSelectTDDetails(){
    	return array(3,7,9,12);
    }

    public function parameter_sontiq_scrorecard_details(){
    	return array("Procedural Execution:	Proper tools, knowledge base and workflows utilized to research customer issue(s); Relevant departments contacted to obtain necessary assistance; All issues and complaints escalated correctly","Information Accuracy and Relevancy:	All valid customer concerns addressed based on information provided by customer or identified with research; Accurate information provided regarding issue(s), research and resolution","Service Level Adherence:	Issue research, follow-up and resolution completed within appropriate timeframe","EXPECTATIONS MET?","Activity Accuracy:	All necessary account adjustments and activities performed to resolve issue(s); Correct spelling and grammar used with customer/third party correspondence","Records and Documentation:	New or existing customer record (case, contact or account) updated properly; Accurate notations entered on account, case and relevant platforms detailing issue research and resolution; Accurate information entered for Record Type, Case Reason, Interaction Type, End Result, and additional case factors","Survey Completion:	Correct survey issued to customer (if applicable); Survey feedback addressed (if applicable)","EXPECTATIONS MET?","Interaction and Engagement:	Empathy expressed to customer situation and concerns acknowledged; Customer needs anticipated; Went above and beyond with service and information provided (as relevant to case); Correct expectations set for research, resolution and next steps","EXPECTATIONS MET?","Security:	Customer and partner security maintained throughout issue research and resolution; Privacy and Security guidelines followed in respect to PII; MRD advised on outbound calls","Professionalism:	Respectful and polite manner maintained throughout call; No vulgarity or abusive language used; No call disconnection or unwarranted hold time used","EXPECTATIONS MET?");  /// not required for english lang
    }

    public function manualColumnProcess($column_val,$comment_val){

			 	$cnt=count($column_val);
				 	$manualColumn="";
			 	if($cnt!=0){
				 	for($i=0;$i<$cnt;$i++){

				 			$manualColumn.='`'.$column_val[$i].'`  varchar(20) NOT NULL COMMENT "'.$comment_val[$i].'",';

				 	}

				 	for($j=1;$j<=$cnt;$j++){

				 			$manualColumn.='`cmt'.$j.'`  TEXT NULL COMMENT "Comments '.$j.'",';

				 	}
			 }

			 return $manualColumn;
    }

///////////////////////// Trapollo start //////////////////////////////////

	public function trapollo(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$page="trapollo";
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/qa_amd_".$page."_feedback.php";
			$data["page"]=$page;
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			$column_val=$this->trapollo_columnname();
			$comment_val=$this->parameter_trapollo_scrorecard_details();

			 $manualColumn=$this->manualColumnProcess($column_val,$comment_val);
			 $createdTableorNot=$this->CreateTable_model->createTable($page,$manualColumn);

			 if($createdTableorNot){

			 	if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user')) and ";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" where assigned_to='$current_user' and ";
				}else{
					$ops_cond=" where ";
				}

					$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and is_assign_client (id,133) and is_assign_process(id,443) and status=1  order by name";
					$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

				////////////////////////
					if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
					if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
					}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
						$ops_cond=" Where assigned_to='$current_user'";
					}else{
						$ops_cond="";
					}


					$qSql = "SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_feedback $cond) xx Left Join
						(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
					$data[$page."_new_data"] = $this->Common_model->get_query_result_array($qSql);
				///////////////////

					$data["from_date"] = $from_date;
					$data["to_date"] = $to_date;
					$data["agent_id"] = $agent_id;

					$this->load->view("dashboard",$data);

			}else{
				echo "table not created";
			}
		}
	}

//////////////////////// Trapollo end ////////////////////////////////////

//////////////////////// SONTIQ add start ////////////////////////////////



//////////////////////// SONTIQ end start ////////////////////////////////


////////////// Delta Dental (IOWA) ///////////////////
	public function delta_dental_iowa(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/delta/dd_iowa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,262) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_delta_iowa_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["iowa"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_dd_iowa($iowa_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/delta/add_edit_dd_iowa.php";
			$data["iowa_id"]=$iowa_id;

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,262) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			 $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_delta_iowa_feedback where id='$iowa_id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to, office_id from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
			$data["iowa"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";
			if($field_array['agent_id']){
				if($iowa_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['entry_by']=$current_user;
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/delta/iowa/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_delta_iowa_feedback',$field_array);

				}else{

					$field_array=$this->input->post('data');
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $iowa_id);
					$this->db->update('qa_amd_delta_iowa_feedback',$field_array);
				////////////
					if(get_login_type()=="client"){
						$field_array1 = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$field_array1 = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $iowa_id);
					$this->db->update('qa_amd_delta_iowa_feedback',$field_array1);
				}

				redirect('Qa_ameridial/delta_dental_iowa');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Delta (End) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Follet (Start) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

public function follet(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$page="follet";
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/".$page."/qa_amd_".$page."_feedback.php";
			$data["page"]=$page;
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and (is_assign_client (id,184) or is_assign_client (id,185)) and (is_assign_process (id,378) or is_assign_process (id,379)) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

		////////////////////////
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_new_data"] = $this->Common_model->get_query_result_array($qSql);
		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Follet (End) /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// Brightway (START) /////////////////////////////
//////////////////////////////////////////////////////////////////////////////////

	public function brightway(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$page="brightway";
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qa_amd_".$page."_feedback.php";
			$data["page"]=$page;
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$cond='';

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name"; /* and is_assign_process(id,377) */
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
		    ////////////////////////
			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(call_date)>='$from_date' and date(call_date)<='$to_date') ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";


			if(get_user_fusion_id()=='FMON004078' || get_user_fusion_id()=='FMON004090' || get_user_fusion_id()=='FSPI000035' || get_user_fusion_id()=='FSPI000004'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_brightway_prescreen_new_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["brightway_prescreen_data"] = $this->Common_model->get_query_result_array($qSql);


			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_prescreen_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_prescreen_new_data"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_evaluation_new_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["brightway_evaluation"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_evaluation_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data[$page."_evaluation_new_data"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_brightway_ib_bank_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["ib_bank"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_offline_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["qa_offline"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_ab_commercial_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["commercial_list"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_phone_inbound_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["phone_inbound_data"] = $this->Common_model->get_query_result_array($qSql);

			// $qSql = "SELECT * from
			// 	(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			// 	(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			// 	(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			// 	(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_phone_inbound_new_feedback $cond) xx Left Join
			// 	(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			// $data["phone_inbound_new_data"] = $this->Common_model->get_query_result_array($qSql);
			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_phone_inbound_new_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["phone_inbound_new_data"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_processing_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["processing_data"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_processing_new_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["processing_data_new"] = $this->Common_model->get_query_result_array($qSql);



		///////////////////

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;

			$this->load->view("dashboard",$data);
		}
	}

     // Prescreen

	public function add_eidit_brightway_prescreen($prescreen_id){

		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/add_eidit_brightway_prescreen.php";
			$data["content_js"] = "qa_clio_js.php";
			$data['prescreen_id']=$prescreen_id;
			$tl_mgnt_cond='';
			if(get_user_fusion_id()=='FMON004078' || get_user_fusion_id()=='FMON004090' || get_user_fusion_id()=='FSPI000117'){
					$ops_cond=" where ";
				}else{
					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user')) and";
					}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
						$ops_cond=" Where assigned_to='$current_user' and";
					}else{
						$ops_cond=" where ";
					}
				}
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and is_assign_process(id,377) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_brightway_prescreen_new_feedback where id='$prescreen_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["prescreen"] = $this->Common_model->get_query_row_array($qSql);


			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($prescreen_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/prescreen_new/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_brightway_prescreen_new_feedback',$field_array);
				//////////////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_brightway_prescreen_new_feedback',$add_array);

				}else{
					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					if($_FILES['attach_file']['tmp_name'][0]!=''){
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/prescreen_new/');
					$field_array1['attach_file'] = implode(',',$a);
					}
					$this->db->where('id', $prescreen_id);
					$this->db->update('qa_amd_brightway_prescreen_new_feedback',$field_array1);
				/////////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $prescreen_id);
					$this->db->update('qa_amd_brightway_prescreen_new_feedback',$edit_array);

				}
				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_brightway_evaluation($evaluation_id){

		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/add_edit_brightway_evaluation.php";
			$data["content_js"] = "qa_clio_js.php";
			$data['evaluation_id']=$evaluation_id;
			$tl_mgnt_cond='';
			if(get_user_fusion_id()=='FMON004078' || get_user_fusion_id()=='FMON004090' || get_user_fusion_id()=='FSPI000117'){
					$ops_cond=" where ";
				}else{
					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user')) and";
					}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
						$ops_cond=" Where assigned_to='$current_user' and";
					}else{
						$ops_cond=" where ";
					}
				}
			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` ".$ops_cond." dept_id=6 and role_id in (select id from role where folder ='agent') and is_assign_client(id,134) and is_assign_process(id,377) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);
			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_brightway_evaluation_new_feedback where id='$evaluation_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["evaluation"] = $this->Common_model->get_query_row_array($qSql);


			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($evaluation_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/evaluation_new/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_brightway_evaluation_new_feedback',$field_array);

					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_brightway_evaluation_new_feedback',$add_array);

				}else{
					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
                    /*
					if($_FILES['attach_file']['tmp_name'][0]!=''){
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/prescreen_new/');
					$field_array1['attach_file'] = implode(',',$a);
					}
					*/
					$this->db->where('id', $evaluation_id);
					$this->db->update('qa_amd_brightway_evaluation_new_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $evaluation_id);
					$this->db->update('qa_amd_brightway_evaluation_new_feedback',$edit_array);

				}
				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_ab_commercial($commercial_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qa_ab_commercial/add_edit_ab_commercial.php";
			$data["content_js"] = "qa_universal_js.php";
			$data['commercial_id']=$commercial_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,377) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * FROM signin where role_id not in (select id from role where folder='agent')";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_ab_commercial_feedback where id='$commercial_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["ab_commercial"] = $this->Common_model->get_query_row_array($qSql);

			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($commercial_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');

					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ab_commercial/');
                    $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_ab_commercial_feedback',$field_array);
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_ab_commercial_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $commercial_id);
					$this->db->update('qa_amd_ab_commercial_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $commercial_id);
					$this->db->update('qa_amd_ab_commercial_feedback',$edit_array);

				}

				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;

			$this->load->view("dashboard",$data);
		}
	}

	//Offline

	public function add_edit_offline($offline_id){

		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/offline/add_edit_offline.php";
			$data["content_js"] = "qa_clio_js.php";
			$data['offline_id']=$offline_id;
			$tl_mgnt_cond='';
			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,377) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_offline_feedback where id='$offline_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["offline"] = $this->Common_model->get_query_row_array($qSql);


			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($offline_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/offline/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_offline_feedback',$field_array);

					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_offline_feedback',$add_array);

				}else{
					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					if($_FILES['attach_file']['tmp_name'][0]!=''){
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/offline/');
					$field_array1['attach_file'] = implode(',',$a);
					}
					$this->db->where('id', $offline_id);
					$this->db->update('qa_amd_offline_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $offline_id);
					$this->db->update('qa_amd_offline_feedback',$edit_array);

				}
				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

	/////IB Bank

	public function add_edit_brightway_ibbank($gds_id){

		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ib_bank/add_edit_ib_bank.php";
			$data["content_js"] = "qa_clio_js.php";
			$data['gds_id']=$gds_id;
			$tl_mgnt_cond='';
			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,377) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_brightway_ib_bank_feedback where id='$gds_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["clio"] = $this->Common_model->get_query_row_array($qSql);


			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($gds_id==0){

					$bonus_question=$this->input->post('bonus_question');

					$field_array=$this->input->post('data');
					if($bonus_question=='AB'){
					$field_array['bonus_question'] = 'AB';
					}
					if($bonus_question=='AS'){
					$field_array['bonus_question'] = 'AS';
					}
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/brightway_ibbank/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_brightway_ib_bank_feedback',$field_array);

					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_brightway_ib_bank_feedback',$add_array);

				}else{
					$bonus_question=$this->input->post('bonus_question');

					$field_array1=$this->input->post('data');
					if($bonus_question=='AB'){
					$field_array1['bonus_question'] = 'AB';
					}
					if($bonus_question=='AS'){
					$field_array1['bonus_question'] = 'AS';
					}
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					if($_FILES['attach_file']['tmp_name'][0]!=''){
						$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/brightway_ibbank/');
						$field_array1['attach_file'] = implode(',',$a);
					}
					$this->db->where('id', $gds_id);
					$this->db->update('qa_amd_brightway_ib_bank_feedback',$field_array1);
					/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $gds_id);
					$this->db->update('qa_amd_brightway_ib_bank_feedback',$edit_array);

				}
				redirect('qa_ameridial/brightway');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

	/////////////////////////////////////////////////////////////////////
/////////////////////////Agent part/////////////////////////////////
public function agent_ib_bank_feedback()
	{
		if(check_logged_in())
		{
			$user_site_id= get_user_site_id();
			$role_id= get_role_id();
			$current_user = get_user_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ib_bank/agent_ib_bank_feedback.php";
			$data["content_js"] = "qa_clio_js.php";
			$data["agentUrl"] = "qa_ameridial/agent_ib_bank_feedback";

			$qSql="Select count(id) as value from qa_amd_brightway_ib_bank_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit', 'Trainer Audit')";
			$data["tot_feedback"] =  $this->Common_model->get_single_value($qSql);

			$qSql="Select count(id) as value from qa_amd_brightway_ib_bank_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit', 'Trainer Audit') and agent_rvw_date is Null";
			$data["yet_rvw"] =  $this->Common_model->get_single_value($qSql);
			$from_date = '';
			$to_date = '';
			$cond="";
			$user="";
			if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}

			if($this->input->get('btnView')=='View')
			{
				$from_date = mmddyy2mysql($this->input->get('from_date'));
				$to_date = mmddyy2mysql($this->input->get('to_date'));

				if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";

				$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_brightway_ib_bank_feedback $cond And audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit', 'Trainer Audit')) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_client_names(id) as client, get_process_names(id) as process from signin $user) yy on (xx.agent_id=yy.sid)";
				$data["agent_rvw_list"] = $this->Common_model->get_query_result_array($qSql);
			}else{
             $qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_brightway_ib_bank_feedback where agent_id='$current_user' And audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit', 'Trainer Audit')) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_client_names(id) as client, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid) Where xx.agent_rvw_date is Null";
				$data["agent_rvw_list"] = $this->Common_model->get_query_result_array($qSql);

			}

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;

			$this->load->view('dashboard',$data);
		}
	}

	public function agent_ib_bank_rvw($id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data['gds_id']=$id;
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/ib_bank/agent_ib_bank_rvw.php";
			$data["content_js"] = "qa_clio_js.php";
			$data["agentUrl"] = "qa_ameridial/agent_ib_bank_feedback";

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_brightway_ib_bank_feedback where id='$id') xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["clio"] = $this->Common_model->get_query_row_array($qSql);

			$data["pnid"]=$id;

			if($this->input->post('pnid'))
			{
				$pnid=$this->input->post('pnid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array1=array(
					"agnt_fd_acpt" => $this->input->post('agnt_fd_acpt'),
					"agent_rvw_note" => $this->input->post('note'),
					"agent_rvw_date" => $curDateTime
				);
				$this->db->where('id', $pnid);
				$this->db->update('qa_amd_brightway_ib_bank_feedback',$field_array1);

				redirect('qa_ameridial/agent_ib_bank_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}

	/////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Report Part //////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_ib_bank_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports/aside.php";
			$data["content_template"] = "qa_ameridial/ib_bank/qa_ib_bank_report.php";
			$data["content_js"] = "qa_clio_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			$campaign ="IB_Bank";

			$data["ib_bank_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_amd_brightway_ib_bank_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin $user) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["ib_bank_list"] = $fullAray;
				$this->create_qa_ib_bank_CSV($fullAray,$campaign);
				$dn_link = base_url()."qa_ameridial/download_ib_bank_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_ib_bank_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./assets/reports/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_ib_bank_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./assets/reports/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","Overall Score", "Possible Score", "Earned Score","1.  Did the CSR use the approved greeting including Brightway branding name and customer name and policy number and offer assistance?","2. If applicable did rep advise they were on a recorded line?","3. Verified and captured points of contact according to procedure.","1. Did the associate use the appropriate tone pace and professionalism ?","2. Did the associate avoid insurance jargon and used proper grammar throughout the call?","3. Did the associate demonstrate the right level of empathy or sympathy?","4. Did the associate listen carefully to understand and address the customers needs ?","5. Did the associate ask to place the caller on hold set proper time expectations and thank them when returning?","6. The associate maintained call control throughout the call by guiding the conversation to stay on topic","7. There was not any silence dead air or self talking that had a negative impact on the call.","8. All verbal and written information provided by associate to insured and other parties was clear accurate and included all relevant information. (2pts for each)","1. Did the associate ask probing questions and verbally verify the changes requested and information provided?","2. If applicable was the call warm transferred","3. Expectations provided and time frame for follow up if any was met.","4. If the call was disconnected prior to resolution did the CSR attempt to contact the caller back to complete the call?","5. Documented correct policy is AMS","6. Are the notes clear descriptive and fully capture what occurred on the call so others understand what was discussed and if anything additional is needed?","7. Created all activities corresponding with the interaction","8. Were the correct templates used? ","9. Attached all emails fax confirmations and other documents as needed","10. Was the issue or request resolved/completed?","11. Requested all signed documents/supporting documentation when further action is required from the customer. CSR did not request any unnecessary or incorrect documents.","12. CSR offered any possible alternative options or solutions to callers request.","13. Effectively accessed and utilized all appropriate systems and resources.","14. Were all changes made in AMS and/or carrier site ?","15. All associated policies were updated as needed (for example flood and umbrella).","16. Was the appropriate suspense created for follow up if needed?","17. Addressed any service-related suspense items that were open at the time they spoke with the customer.","18. CSR updated any suspense that was addressed during the call and closed if applicable.","19. Was the correct disposition selected","1. Did the CSR provide a wrap-up summary including the CSRs and callers action items?","2. Did the associate offer additional assistance thanked the customer?","1. Bonus Question","1. Was the call an Auto-Fail?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				if($user['bonus_question']=='AB') $bonus_question='Associate was able to retain customer that indicated they were going to leave Brightway.';
				if($user['bonus_question']=='AS') $bonus_question='Associate identified a cross sell opportunity and was able to refer to agent for additional quotes.';

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['did_csr_use_approved_greeting'].'",';
				$row .= '"'.$user['did_applicable_rep_advice'].'",';
				$row .= '"'.$user['verified_captured_point_contact'].'",';
				$row .= '"'.$user['did_associate_use_tone'].'",';
				$row .= '"'.$user['did_associate_use_tone'].'",';
				$row .= '"'.$user['did_associate_avoid_insurance'].'",';
				$row .= '"'.$user['did_associate_listen_carefully'].'",';
				$row .= '"'.$user['did_associate_ask_place'].'",';
				$row .= '"'.$user['associate_maintained_call'].'",';
				$row .= '"'.$user['not_any_silence_dead_air'].'",';
				$row .= '"'.$user['all_verbal_written_information'].'",';
				$row .= '"'.$user['did_associate_ask_probing'].'",';
				$row .= '"'.$user['applicable_call_warn_transferred'].'",';
				$row .= '"'.$user['expectation_provided'].'",';
				$row .= '"'.$user['if_call_dicconnected_prior'].'",';
				$row .= '"'.$user['documented_correct_policy'].'",';
				$row .= '"'.$user['are_notes_clear'].'",';
				$row .= '"'.$user['created_all_activities'].'",';
				$row .= '"'.$user['do_correct_template_used'].'",';
				$row .= '"'.$user['attached_all_email'].'",';
				$row .= '"'.$user['was_the_issue'].'",';
				$row .= '"'.$user['requested_all_signed_documents'].'",';
				$row .= '"'.$user['csr_offered_any_possible'].'",';
				$row .= '"'.$user['effectively_accessed'].'",';
				$row .= '"'.$user['ware_all_changes_made'].'",';
				$row .= '"'.$user['all_associated_policies'].'",';
				$row .= '"'.$user['was_the_appropriate_suspense'].'",';
				$row .= '"'.$user['address_any_service_related'].'",';
				$row .= '"'.$user['csr_updated_any_suspense'].'",';
				$row .= '"'.$user['was_correct_disposion_selected'].'",';
				$row .= '"'.$user['did_csr_provide_summary'].'",';
				$row .= '"'.$user['did_associate_offer'].'",';
				$row .= '"'.$bonus_question.'",';
				$row .= '"'.$user['do_call_auto_fail'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


        }

///////////////////////////////////////////////////////////////////////////////////
//////////////////////////////// Brightway (END) //////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Brightway Evaluation (Start) /////////////////////////
//////////////////////////////////////////////////////////////////////////////////

// public function brightway_evaluation(){
// 		if(check_logged_in())
// 		{
// 			$current_user = get_user_id();
// 			$page="brightway_evaluation";
// 			$data["aside_template"] = "qa/aside.php";
// 			$data["content_template"] = "qa_ameridial/".$page."/qa_amd_".$page."_feedback.php";
// 			$data["page"]=$page;
// 			$from_date = $this->input->get('from_date');
// 			$to_date = $this->input->get('to_date');
// 			$agent_id = $this->input->get('agent_id');
// 			$cond='';

// 			if($from_date==""){
// 				$from_date=CurrDate();
// 			}else{
// 				$from_date = mmddyy2mysql($from_date);
// 			}

// 			if($to_date==""){
// 				$to_date=CurrDate();
// 			}else{
// 				$to_date = mmddyy2mysql($to_date);
// 			}

// 			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,134) and is_assign_client (id,134) and is_assign_process(id,377) and status=1  order by name";
// 			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

// 		////////////////////////
// 			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
// 			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";

// 			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
// 				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
// 			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
// 				$ops_cond=" Where assigned_to='$current_user'";
// 			}else{
// 				$ops_cond="";
// 			}


// 			$qSql = "SELECT * from
// 				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
// 				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
// 				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
// 				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$page."_feedback $cond) xx Left Join
// 				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
// 			$data[$page."_new_data"] = $this->Common_model->get_query_result_array($qSql);
// 		///////////////////

// 			$data["from_date"] = $from_date;
// 			$data["to_date"] = $to_date;
// 			$data["agent_id"] = $agent_id;

// 			$this->load->view("dashboard",$data);
// 		}
// 	}

///////////////////////////////////////////////////////////////////////////////////
///////////////////////////// Brightway Evaluation (End) /////////////////////////
//////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*------------------------------ Air Method (Start) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function air_method(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/air_method/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,444) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_airmethod_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["air_method"] = $this->Common_model->get_query_result_array($qSql);

			 $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_airmethod_email_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["air_method_email"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_airmethod($am_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/air_method/add_edit_airmethod.php";
			$data['am_id']=$am_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,444) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_airmethod_feedback where id='$am_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["air_method"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($am_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/air_method');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_airmethod_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_airmethod_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $am_id);
					$this->db->update('qa_amd_airmethod_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $am_id);
					$this->db->update('qa_amd_airmethod_feedback',$edit_array);

				}
				redirect('qa_ameridial/air_method');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


public function add_edit_airmethod_email($am_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/air_method/add_edit_airmethod_email.php";
			$data['am_id']=$am_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,444) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_airmethod_email_feedback where id='$am_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["air_method"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($am_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/air_method');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_airmethod_email_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_airmethod_email_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $am_id);
					$this->db->update('qa_amd_airmethod_email_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $am_id);
					$this->db->update('qa_amd_airmethod_email_feedback',$edit_array);

				}
				redirect('qa_ameridial/air_method');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*------------------------------ Air Method (End) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*------------------------------ Food Saver (Start) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function foodsaver(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/foodsaver/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_foodsaver_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["foodsaver"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_foodsaver($fs_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/foodsaver/add_edit_foodsaver.php";
			$data['fs_id']=$fs_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_foodsaver_feedback where id='$fs_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["foodsaver"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($fs_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='.qa_files/qa_ameridial/foodsaver/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_foodsaver_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_foodsaver_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $fs_id);
					$this->db->update('qa_amd_foodsaver_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $fs_id);
					$this->db->update('qa_amd_foodsaver_feedback',$edit_array);

				}
				redirect('qa_ameridial/foodsaver');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*------------------------------ Food Saver (End) -------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------------- SAS (Start) --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function sas(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/sas/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_sas_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["sas"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_sas($sas_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/sas/add_edit_sas.php";
			$data["content_js"] = "qa_ameridial_commercial_js.php";
			$data['sas_id']=$sas_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_sas_feedback where id='$sas_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["sas"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($sas_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/sas/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_sas_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_sas_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $sas_id);
					$this->db->update('qa_amd_sas_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $sas_id);
					$this->db->update('qa_amd_sas_feedback',$edit_array);

				}
				// echo"<pre>";
				// print_r($field_array);
				// echo"</pre>";
				// exit;
				redirect('qa_ameridial/sas');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------------- GAP (Start) --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function gap(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/gap/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_gap_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["gap"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_gap($gap_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/gap/add_edit_gap.php";
			$data['gap_id']=$gap_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_gap_feedback where id='$gap_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["gap"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($gap_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='.qa_files/qa_ameridial/gap/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_gap_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_gap_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $gap_id);
					$this->db->update('qa_amd_gap_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $gap_id);
					$this->db->update('qa_amd_gap_feedback',$edit_array);

				}
				redirect('qa_ameridial/gap');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------- SFE Scorecard (Nilkanta)--------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function sfe(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/sfe/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,241) and is_assign_process(id,488) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_sfe_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["sfe_scorecard"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_sfe($fs_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/sfe/add_edit_sfe_scorecard.php";
			$data['fs_id']=$fs_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,241) and is_assign_process(id,488) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_sfe_feedback where id='$fs_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["sfe_scorecard"] = $this->Common_model->get_query_row_array($qSql);


			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($fs_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					//$a = $this->amd_upload_files($_FILES['attach_file'], $path='.qa_files/qa_ameridial/sfe/');
					//$field_array["attach_file"] = implode(',',$a);
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/sfe/');
                    $field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_sfe_feedback',$field_array);

				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_sfe_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $fs_id);
					$this->db->update('qa_amd_sfe_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $fs_id);
					$this->db->update('qa_amd_sfe_feedback',$edit_array);

				}
				redirect('qa_ameridial/sfe');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*------------------------------------- QPC ESAL --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function qpc_esal(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qpc_esal/qpc_esal_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and office_id in ('ELS') and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_qpc_esal_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["qpc_esal"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_qpc_esal($qpc_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/qpc_esal/add_edit_qpc_esal.php";
			$data['qpc_id']=$qpc_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and office_id in ('ELS') and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_qpc_esal_feedback where id='$qpc_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["qpc_esal"] = $this->Common_model->get_query_row_array($qSql);


			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($qpc_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='.qa_files/qa_ameridial/qpc_esal');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_qpc_esal_feedback',$field_array);

				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_qpc_esal_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $qpc_id);
					$this->db->update('qa_amd_qpc_esal_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $qpc_id);
					$this->db->update('qa_amd_qpc_esal_feedback',$edit_array);

				}
				redirect('qa_ameridial/qpc_esal');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------------- MPC (Start) --------------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function mpc(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/mpc/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_mpc_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["mpc"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_mpc($mpc_id){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/mpc/add_edit_mpc.php";
			$data['mpc_id']=$mpc_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_mpc_feedback where id='$mpc_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["mpc"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($mpc_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/mpc');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_mpc_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_mpc_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $mpc_id);
					$this->db->update('qa_amd_mpc_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $mpc_id);
					$this->db->update('qa_amd_mpc_feedback',$edit_array);

				}
				redirect('qa_ameridial/mpc');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}


/*-------------------------------------------------------------------------*/
/*----------------------------- REPORT PART ------------------------------*/
	public function qa_ameridial_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports/aside.php";
			$data["content_template"] = "qa_ameridial/qa_ameridial_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$process_id="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$cond2="";
			$cmp1='';

			$process_id = $this->input->get('process_id');

			$data["qa_ameridial_list"] = array();

			if($process_id!=""){

				if($this->input->get('show')=='Show')
				{
					$from_date = mmddyy2mysql($this->input->get('from_date'));
					$to_date = mmddyy2mysql($this->input->get('to_date'));
					$office_id = $this->input->get('office_id');
					$lob = $this->input->get('lob');


					if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
						$ops_cond="";
					}else{
						if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
							$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
						}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
							$ops_cond=" Where assigned_to='$current_user'";
						}else{
							$ops_cond="";
						}
					}

					 $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$process_id."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid)";

					$fullAray = $this->Common_model->get_query_result_array($qSql);

					$data["qa_ameridial_list"] = $fullAray;

					if(!in_array($process_id,array('episource','magnilife','blains','pajamagram','delta','brightway_prescreen_new','brightway_prescreen','brightway_evaluation_new','brightway_evaluation'))){
						$this->create_qa_ameridial_CSV($fullAray,$process_id);
					}else{
						$header=$process_id."Header";
						$header=$this->$header();
						$this->create_qa_amd_common_new_CSV($header,$fullAray,$process_id);
					}

					$dn_link = base_url()."qa_ameridial/download_qa_ameridial_CSV/".$process_id;


				}

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['from_date'] = $from_date;
			$data['to_date'] = $to_date;
			$data['office_id']=$office_id;
			$data['process_id']=$process_id;
			//$data['lob']=$lob;

			$this->load->view('dashboard',$data);
		}
	}

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------------- Empire //Edited By Samrat 29/11/2021 (Start) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////
public function empire(){
  if(check_logged_in()){
    $current_user = get_user_id();
    $data["aside_template"] = "qa/aside.php";
    $data["content_template"] = "qa_ameridial/empire/qa_feedback.php";

    $qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1 order by name";
    $data["agentName"] = $this->Common_model->get_query_result_array($qSql);

    $from_date = $this->input->get('from_date');
    $to_date = $this->input->get('to_date');
    $agent_id = $this->input->get('agent_id');
    $file = $this->input->get('file');
    $cond="";

    if($from_date==""){
      $from_date=CurrDate();
    }else{
      $from_date = mmddyy2mysql($from_date);
    }

    if($to_date==""){
      $to_date=CurrDate();
    }else{
      $to_date = mmddyy2mysql($to_date);
    }

    if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
    if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
    if($file !="")	$cond .=" and file_no like '%$file%'";

    if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
      $ops_cond="";
    }else{
      if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
        $ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
      }else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
        $ops_cond=" Where assigned_to='$current_user'";
      }else{
        $ops_cond="";
      }
    }

      $qSql = "SELECT * from
      (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
      (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
      (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
      from qa_amd_empire_feedback $cond) xx Left Join
      (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
    $data["empire"] = $this->Common_model->get_query_result_array($qSql);

    $data["from_date"] = $from_date;
    $data["to_date"] = $to_date;
    $data["agent_id"] = $agent_id;
    $data["file"] = $file;

    $this->load->view("dashboard",$data);
  }
}
public function add_edit_empire($empire_id){
  if(check_logged_in()){
    $current_user=get_user_id();
    $user_office_id=get_user_office_id();

    $data["aside_template"] = "qa/aside.php";
    $data["content_template"] = "qa_ameridial/empire/add_edit_empire.php";
    $data["content_js"] = "qa_avon_js.php";

    $data['empire_id']=$empire_id;
    $tl_mgnt_cond='';

    if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
      $tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
    }else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
      $tl_mgnt_cond=" and assigned_to='$current_user'";
    }else{
      $tl_mgnt_cond="";
    }

    $qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
    $data["agentName"] = $this->Common_model->get_query_result_array($qSql);

    $qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
    $data['tlname'] = $this->Common_model->get_query_result_array($qSql);

    $qSql = "SELECT * from
      (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
      (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
      (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
      (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
      from qa_amd_empire_feedback where id='$empire_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
    $data["empire"] = $this->Common_model->get_query_row_array($qSql);

    //$currDate=CurrDate();
    $curDateTime=CurrMySqlDate();
    $a = array();


    $field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

    if($field_array['agent_id']){

      if($empire_id==0){

        $field_array=$this->input->post('data');
        $field_array['audit_date']=CurrDate();
        $field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
        $field_array['entry_date']=$curDateTime;
        $field_array['audit_start_time']=$this->input->post('audit_start_time');
        $a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/empire');
        $field_array["attach_file"] = implode(',',$a);
        $rowid= data_inserter('qa_amd_empire_feedback',$field_array);
      ///////////
        if(get_login_type()=="client"){
          $add_array = array("client_entryby" => $current_user);
        }else{
          $add_array = array("entry_by" => $current_user);
        }
        $this->db->where('id', $rowid);
        $this->db->update('qa_amd_empire_feedback',$add_array);

      }else{

        $field_array1=$this->input->post('data');
        $field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
        $this->db->where('id', $empire_id);
        $this->db->update('qa_amd_empire_feedback',$field_array1);
      /////////////
        if(get_login_type()=="client"){
          $edit_array = array(
            "client_rvw_by" => $current_user,
            "client_rvw_note" => $this->input->post('note'),
            "client_rvw_date" => $curDateTime
          );
        }else{
          $edit_array = array(
            "mgnt_rvw_by" => $current_user,
            "mgnt_rvw_note" => $this->input->post('note'),
            "mgnt_rvw_date" => $curDateTime
          );
        }
        $this->db->where('id', $empire_id);
        $this->db->update('qa_amd_empire_feedback',$edit_array);

      }
      redirect('qa_ameridial/empire');
    }
    $data["array"] = $a;
    $this->load->view("dashboard",$data);
  }
}
///////////////////////////////////////////////////////////////////////////////////
/*---------------------------------- Empire //Edited By Samrat 29/11/2021 (End) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------------- Cinemark //Edited By Samrat 29/11/2021 (Start) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////
public function cinemark(){
  if(check_logged_in()){
    $current_user = get_user_id();
    $data["aside_template"] = "qa/aside.php";
    $data["content_template"] = "qa_ameridial/cinemark/qa_feedback.php";

    $qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,'134,293') and status=1 order by name";
    $data["agentName"] = $this->Common_model->get_query_result_array($qSql);

    $from_date = $this->input->get('from_date');
    $to_date = $this->input->get('to_date');
    $agent_id = $this->input->get('agent_id');
    $file = $this->input->get('file');
    $cond="";

    if($from_date==""){
      $from_date=CurrDate();
    }else{
      $from_date = mmddyy2mysql($from_date);
    }

    if($to_date==""){
      $to_date=CurrDate();
    }else{
      $to_date = mmddyy2mysql($to_date);
    }

    if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
    if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
    if($file !="")	$cond .=" and file_no like '%$file%'";

    if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
      $ops_cond="";
    }else{
      if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
        $ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
      }else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
        $ops_cond=" Where assigned_to='$current_user'";
      }else{
        $ops_cond="";
      }
    }

      $qSql = "SELECT * from
      (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
      (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
      (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
      from qa_amd_cinemark_feedback $cond) xx Left Join
      (Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
    $data["cinemark"] = $this->Common_model->get_query_result_array($qSql);

    $data["from_date"] = $from_date;
    $data["to_date"] = $to_date;
    $data["agent_id"] = $agent_id;
    $data["file"] = $file;

    $this->load->view("dashboard",$data);
  }
}
public function add_edit_cinemark($cinemark_id){
  if(check_logged_in()){
    $current_user=get_user_id();
    $user_office_id=get_user_office_id();

    $data["aside_template"] = "qa/aside.php";
    $data["content_template"] = "qa_ameridial/cinemark/add_edit_cinemark.php";
    $data['cinemark_id']=$cinemark_id;
    $tl_mgnt_cond='';

    if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
      $tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
    }else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
      $tl_mgnt_cond=" and assigned_to='$current_user'";
    }else{
      $tl_mgnt_cond="";
    }

    $qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,'134,293') and status=1  order by name";
    $data["agentName"] = $this->Common_model->get_query_result_array($qSql);

    $qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
    $data['tlname'] = $this->Common_model->get_query_result_array($qSql);

    $qSql = "SELECT * from
      (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
      (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
      (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
      (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
      from qa_amd_cinemark_feedback where id='$cinemark_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
    $data["cinemark"] = $this->Common_model->get_query_row_array($qSql);

    //$currDate=CurrDate();
    $curDateTime=CurrMySqlDate();
    $a = array();


    $field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

    if($field_array['agent_id']){

      if($cinemark_id==0){

        $field_array=$this->input->post('data');
        $field_array['audit_date']=CurrDate();
        $field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
        $field_array['entry_date']=$curDateTime;
        $field_array['audit_start_time']=$this->input->post('audit_start_time');
        $a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/cinemark');
        $field_array["attach_file"] = implode(',',$a);
        $rowid= data_inserter('qa_amd_cinemark_feedback',$field_array);
      ///////////
        if(get_login_type()=="client"){
          $add_array = array("client_entryby" => $current_user);
        }else{
          $add_array = array("entry_by" => $current_user);
        }
        $this->db->where('id', $rowid);
        $this->db->update('qa_amd_cinemark_feedback',$add_array);

      }else{
        $field_array1=$this->input->post('data');
        $field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
        $this->db->where('id', $cinemark_id);
        $this->db->update('qa_amd_cinemark_feedback',$field_array1);
      /////////////
        if(get_login_type()=="client"){
          $edit_array = array(
            "client_rvw_by" => $current_user,
            "client_rvw_note" => $this->input->post('note'),
            "client_rvw_date" => $curDateTime
          );
        }else{
          $edit_array = array(
            "mgnt_rvw_by" => $current_user,
            "mgnt_rvw_note" => $this->input->post('note'),
            "mgnt_rvw_date" => $curDateTime
          );
        }
        $this->db->where('id', $cinemark_id);
        $this->db->update('qa_amd_cinemark_feedback',$edit_array);
      }
      redirect('qa_ameridial/cinemark');
    }
    $data["array"] = $a;
    $this->load->view("dashboard",$data);
  }
}

///////////////////////////////////////////////////////////////////////////////////
/*---------------------------------- Cinemark //Edited By Samrat 29/11/2021 (End) -----------------------------*/
///////////////////////////////////////////////////////////////////////////////////
	public function download_qa_ameridial_CSV($pid)
	{
		if($pid=='fortunebuilder'){
			$pname='Fortune Biulder';
		}else if($pid=='hoveround'){
			$pname='Hoveround';
		}else if($pid=='ncpssm'){
			$pname='NCPSSM';
		}else if($pid=='stc'){
			$pname='STC Scoresheet';
		}else if($pid=='touchfuse'){
			$pname='TouchFuse';
		}else if($pid=='tbn'){
			$pname='TBN Scoresheet';
		}else if($pid=='purity_free_bottle'){
			$pname='Purity Free Bottle';
		}else if($pid=='purity_catalog'){
			$pname='Purity Catalog';
		}else if($pid=='purity_care'){
			$pname='Purity Care';
		}else if($pid=='puritycare_new'){
			$pname='Purity Care New';
		}else if($pid=='jfmi'){
			$pname='JFMI';
		}else if($pid=='tpm'){
			$pname='TPM Scoresheet';
		}else if($pid=='patchology'){
			$pname='Patchology Agent Improvement';
		}else if($pid=='aspca'){
			$pname='ASPCA Scoresheet';
		}else if($pid=='ffai'){
			$pname='FilterFast Agent Improvement Scoresheet';
		}else if($pid=='lifi'){
			$pname='LIFI Improvement Scoresheet';
		}else if($pid=='heatsurge'){
			$pname='Heat Surge';
		}else if($pid=='stauers_sales'){
			$pname='Stauers Sales';
		}else if($pid=='operation_smile'){
			$pname='Operation Smile';
		}else if($pid=='5_11_tactical'){
			$pname='5-11 Tactical';
		}else if($pid=='jmmi'){
			$pname='JMMI';
		}else if($pid=='non_profit'){
			$pname='Non-Profit';
		}else if($pid=='revel_new'){
			$pname='REVEL';
		}else if($pid=='qpc'){
			$pname='QPC';
		}else if($pid=='ancient_nutrition'){
			$pname='Ancient Nutrition';
		}else if($pid=='powerfan'){
			$pname='Power Fan';
		}else if($pid=='nuwave'){
			$pname='NuWave';
		}else if($pid=='sabal'){
			$pname='SABAL';
		}else if($pid=='curative'){
			$pname='CURATIVE';
		}else if($pid=='episource'){
			$pname='EPISOURCE';
		}else if($pid=='magnilife'){
			$pname='MAGNILIFE';
		}else if($pid=='blains'){
			$pname='BLAINS';
		}else if($pid=='pajamagram'){
			$pname='PAJAMAGRAM';
		}else if($pid=='delta'){
			$pname='DELTA DENTAL [ILLINOIS]';
		}else if($pid=='delta_iowa'){
			$pname='DELTA DENTAL [IOWA]';
		}else if($pid=='brightway_prescreen_new'){
			$pname='Brightway Prescreen';
		}else if($pid=='brightway_prescreen'){
			$pname='Brightway Prescreen(Old)';
		}else if($pid=='brightway_evaluation'){
			$pname='Brightway Evaluation';
		}else if($pid=='brightway_ib_bank'){
			$pname='IB BANKS AND CANCELLATION';
		}else if($pid=='offline'){
			$pname='Offline Qa';
		}else if($pid=='foodsaver'){
			$pname='Food Saver';
		}else if($pid=='suarez'){
			$pname='Suarez';
		}else if($pid=='sfe'){
			$pname='SFE';
		}else if($pid=='qpc_esal'){
			$pname='QPC ESAL';
		}else if($pid=='ab_commercial'){
			$pname='AB Commercial Offline';
		}else if ($pid=="cinemark") {
      $pname="Cinemark";
    }else if($pid=="empire"){
      $pname="Empire";
    }else if($pid=="hcpss"){
      $pname="HCPSS";
    }else if($pid=="cmn"){
      $pname="CMN";
    }else if($pid=="pilgrim"){
      $pname="Pilgrim";
    }else if($pid=="bluebenefits"){
      $pname="Blue Benefits";
 	}else if($pid=="healthbridge"){
      $pname="Health Bridge";
 	}else if($pid=="healthbridgenew"){
	$pname="Health Bridge New";
   }

		$currDate=date("Y-m-d");
		$filename = "./assets/reports/Report".get_user_id().".csv";
		$newfile="QA Ameridial ".$pname." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

//////////// qa_amd_report_header///////////////////////////////////

	function episourceHeader(){

		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Call Reference","Call Status","System","Site","Call Duration","File No.","Audit Type","Auditor Type","VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Did the agent provide the appropriate introduction? ","Did the agent provide a clear reason for the call?","Did the agent accurately respond to the members questions?","Did the agent allow the member to speak uninterrupted?","Did the agent avoid long periods of silence?","Did the agent ask to schedule the visit.","Did the agent verify the member?","Did the agent include all relevant details for the appointment?","Did the agent verify the full address?","Did the agent advise member to take note of all confirmation details?","Did the agent accurately document notes to NP?","Did the agent provide two response?","Did the agent advise of a reminder call?","Did the agent provide a fitting  closing for each call?","Did the agent status and document Salesforce correctly?","Did the agent advise the member he/she was on a recorded line?","Did the agent follow verification requirements for the script?","Did the agent maintain security of PHI and abide by HIPAA requirements?","Did the agent Inappropriately release the call prior ot providing an approptiate closing?","Did the agent perform any unauthorized action on a member profile","Did the agent knowingly providing false information?","Did the agent place blame?","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");

	}

	///////////////////////Magnilife/////////////////////////////////////

	function magnilifeHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","File No","Call Date","Call Duration","Audit Type","Auditor Type","VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "disposition","Overall Score","Possible Score","Earned Score","Greeting (Agent complied with greeting mentioned Brand and call reason )","Enthusiasm (Agent sounds with enthusiasm good energy when speaking)","Clarity (Agent demonstrate a good level of grammar pronunciation pace and confidence at the time of speaking)","Professionalism (listening skills phone etiquette maintain call control and ethics agent's ethics)","Product knowledge (Agent answers product questions sounds as a product expert)","Accuracy (Agent provides accurate product information to the customer avoid providing false expectation/information to the customer)","Efficiency (Agent works effectively during the call to complete the purpose of the call )","System Knowledge (Agent demonstrates program knowledge)","Offer Information (Agents read offer information to the customer including price and features with good and clear pace)","Purchase confirmation (Agent confirms purchase information including prices provides confirmation number to the customer)","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date" );
	}

	///////////////////////Blains/////////////////////////////////////

	function blainsHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","Filler 2","Area Code","Site","Call Duration","File No","Audit Type","Auditor Type","VOC", "Possible Score","Earned Score","Overall Score","Call opening with Brand Name","Customers name at least once","Verified the customers name address email and phone number","Correct use of Flagging & Notating","Transfer to store if required","Did the agent follow training docs along with ACP and Blains Website","Integrity Accountability Teamwork and Results","Demonstrates an attitude with every customer encounter through words and actions to show the customer respect and recgnition","Did the agent avoid dead air","Tone Over talking and pacing","Listening to the words a customer is speaking and understanding the request","Empathized with customer","Offering more items to the customer when an order is placed or signing up for newsletter when the time is right","Did the agent close the call properly","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Call Summary","Feedback","Entry By","Entry Date","Audit Start Time","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	function brightway_evaluationHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","Audit Type","Auditor Type ","VOC ","Enter Policy Information ","Skill - Select all the Apply ","File No. ", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score ","Possible Score ","Earned Score ","Did the CSR use the approved greeting ","Did rep advise they were on a recorded line ","Did the associate use the appropriate tone pace and professionalism while avoidinginsurance jargon? ","Did the associate demonstrate the right level of empathy or sympathy? ","Did the associate listen carefully to understand and address the customers needs askingprobing questions and verbally verify the information obtained and processed? ","Did the CSR follow the appropriate hold procedure and provide a wrap-up summary ","The associate maintained call control throughout the call by guiding the conversation ","All verbal and written information provided by associate to insured and other parties wasclear ","If call was transferred was the appropriate transfer process followed? ","Did the CSR attempt to contact the callerback to complete the call? ","Worked correct policy. ","Created all activities corresponding with the interaction with clear ","Were the correct interaction templates used? ","Attached all emails fax confirmations and other documents as needed ","Was the issue or request resolved/completed? ","Effectively accessed and utilized all appropriate systems and resources to obtaininformation ","If a renewal payment was processed and there is an open renewal suspense was thesuspense updated and closed? ","Did the associate offer additional assistance thanked the customer? ","Was the customer adversely impacted? ","Were there any additional adverse impacts? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent Feedback Acceptance","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	function brightway_prescreenHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","Filler 2","Area Code","Site ","Call Duration ","File No. ","Audit Type ","Auditor Type ","VOC ", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score ","Earned Score ","Overall Score ","Transfer to ","Did the associate use the appropriate greeting? ","Was the Pre-Screen template completed correctly? ","Did the associate disposition the call correctly? ","Did the associate use the appropriate verbiage tone pace and professionalism? ","Did the associate transfer to the correct skill based on the decision flow diagram? ","Was the caller appropriately authenticated? ","If verified and change needed was AMS updated? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent Feedback Acceptance","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	function brightway_prescreen_newHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","File No. ","Filler","Campaign Code","Area Code","Call Duration ","Audit Type ","Auditor Type ","VOC ", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score ","Earned Score ","Overall Score ","Transfer to ","Did the CSR Transfer to:","1.1 Did the CSR use the appropriate greeting? ","1.2 Was the Pre-Screen template completed correctly?","1.3 Did the CSR disposition the call correctly?","1.4 Did the agent use appropriate soft skills no overtalk and demonstrated professionalism?","1.5 Did the CSR use the proper hold procedure?","1.6  Did the CSR transfer to the correct skill based on the decision flow diagram?","1.7  Was the caller appropriately authenticated?","1.8  Did the CSR experience any audio issues? (For Tracking Puposes Only)","1.9  If verified and change necessary was AMS updated correctly?","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent Feedback Acceptance","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	function pajamagramHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","Call Duration","File No","Audit Type","Auditor Type","VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score","Earned Score","Overall Score","Caller is ready and logged in to website to handle call","Greet caller and Thank them for calling Pajamagram or Vermont Teddy Bear","Ask caller what can we order for them today","Verify all  caller and product information","Assist search if caller doesnt know specific item","Offer personalization if available","Offer Upsell","Ask for additional items","Confirm email and phone number","Energy/enthusiasm","Proper pace","Maintained control of the conversation/Minimal Dead Air","Spoke clearly/utilized proper grammar (NO SLANG)","Good listening skills/Does not interrupt","Empathized with caller","Overall professionalism","Ask for Priority code if caller has catalog","Enter advertising source from CRM screen or ask caller for it","Close call with order confirmaiton and Thank caller for their order","False/inappropriate information","Hung up inappropriately","Unprofessional or rude behavior","Inappropriate language","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Call Summary","Feedback","Entry By","Entry Date","Audit Start Time","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	public function deltaHeader(){

		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","Audit Type","Auditor Type","VOC","File No.", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Possible Score","Earned Score","Did CER appropriately greet the caller?","Did CER use a pleasant respectful tone and use the caller's name at least once during the call?","Did CER answer in a timely manner?","Did CER obtain 3 pieces of PHI?","Did CER obtain member's information first and then provider's if on provider call?","If Non-Covered Parent did the caller answer yes to all 3 questions on Guidelines tab?","Did CER ask appropriate questions to determine the purpose of the call?","Did CER assess all information before responding to the caller? (BVN)","Did CER pose appropriate questions to clarify the caller's issue? (Restate Issue)","Did CER utilize active listening skills throughout the inquiry?","Did CER demonstrate use of call control techniques?","Did CER refrain from interrupting the caller?","Did CER speak clearly and concisely and at an appropriate pace?","Did CER avoid use of internal terms technical terms slang and jargon?","Did CER demonstrate confidence in responses?","Did CER minimize silences and use fillers to obtain additional information?","Did CER provide accurate information and/or demonstrate knowledge of client's benefit programs?","Did CER take correct action to resolve the caller's issues?","Did CER promote self-service options where appropriate?","Did CER answer questions clearly and completely?","Was CER proactive by anticipating additional needs of the caller?","Did CER accurately and completely document the call's outcome?","Did the CER document the callers phone number name call type CITS code etc?","Did CER close CITS if it did not require a follow up?","Did CER confirm resolution of the caller's question?","Did CER ask if any additional information could be provided?","Did CER thank the individual for calling and release the call within 5 seconds","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25","Comments 26","Comments 27","Call Summary","Feedback","Entry By","Entry Date","Audit Start Time","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	////////////////////support function for Report///////////////////////

	public function getval($arrs, $k) {
    foreach($arrs as $key=>$val) {
        if( $key === $k ) {
            return $val;
        }
        else {
            if(is_array($val)) {
                $ret = $this->getval($val, $k);
                if($ret !== NULL) {
                    return $ret;
                }
            }
        }
    }
    return NULL;
	}


	// function abc(){

	// 	echo "work please";

	// 	// $this->db->query("create table xyz1 as SELECT phno as phone1,concat(fname,' ',lname) as name,email_id as email FROM `signin` WHERE 1");


	// 	$field_name=$this->Common_model->get_query_result_array("SELECT phno as phone1,concat(fname,' ',lname) as name,email_id as email FROM `signin` WHERE 1");
	// 	// print_r($field_name);
	// 	$this->create_qa_ameridial_CSV($field_name,"xyz");
	// 	$dn_link = base_url()."qa_ameridial/download_qa_ameridial_CSV/"."Full User Details";



	// }

	////////////////Dynamic function for automatic report generation//////////////

	public function create_qa_amd_common_new_CSV($header,$rr,$pid)
	{
		$filename = "./assets/reports/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$field_name="SHOW FULL COLUMNS FROM qa_amd_".$pid."_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}

	public function create_qa_ameridial_CSV($rr,$pid)
	{
		$filename = "./assets/reports/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($pid=='fortunebuilder'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the call answered within 5 seconds?", "Did the agent introduce him/herself to the caller?", "Did the agent advise the call is being recorded?", "Did the agent use the standard greeting?", "Did the agent ask for the zip code?", "Did the agent verify callers first and last name and complete address?", "Did the agent ask for and verify the caller's email address", "Did the agent correctly offer the seminars?", "Did the agent correctly ask for and verify the phone number?", "Did the agent inform the caller about the text reminders he/she will receive?", "Did the agent summarize the call with relevant details?", "Did the agent offer to register a guest?", "Did the agents collect and verify the guests email address?", "Did the agent demonstrate knowledge of Fortune Builders?", "Did the agent use appropriate grammar and pronunciation?", "Did the agent use good pacing and tone?", "Did the agent display professionalism and handle difficult callers appropriately?", "Did the agent maintain call control throughout the call?", "Did the agent use the appropriate Closing?", "Did the agent correctly disposition the call?", "Call Summary", "Feedback", "Agent Feedback Acceptance","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='xyz'){
			$header=array("phone1","Name","Email");
	  }else if($pid=='purity_free_bottle'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Call Type/LOB", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "Did the rep greet the customer promptly and properly?", "Did the rep use their soft skills appropriately?", "Did the rep collect and verify the customers information appropriately?", "Did the rep cover the super saver offer appropriately?", "Did the rep cover the upsell appropriately?", "Did the rep cover the payment procedures appropriately?", "Did the rep demonstrate knowledge of the product/program?", "Did the rep maintain call control?", "Did the rep use the tools/FAQ's appropriately?", "Did the rep use the appropriate objection responses?", "Did the rep use the callers last name to personalize the call at least once per section?", "Did the rep complete the correct confirmation and closing?", "Did the rep cover the frequency and cost of each delivery when applicable?", "Did the rep have any misrepresentation?", "Did the rep response appropriately to a DNC response?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='purity_catalog'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Proper Greeting", "Customer First Name and Address Verification", "Identifies Type of Account Properly", "Properly transfers the Account", "Accurate Notes Taken/Info Verified Appropriately", "Correct Information Given", "Proper Terminology/Use of Disc Names, etc", "Free Gift Scripting", "Bulk Offer", "Promotions Offered Correctly", "Super Saver Offered and Explained Properly", "Additional Product Offered", "Order Placed Properly/Cancelled Properly", "Order Confirmation", "Uses Tools and FAQ", "Address Verification at Confirmation", "Credit Card Verification/Charged Correct Information", "Attempt to Gather CVV Code", "Daily Special Offer", "Product/Benefits Offered with Daily Special", "Thank You Statement", "Maintained Call Control/Call Flow", "Response Time/Minimal Dead Air", "Used Proper Hold Techniques", "Good Attitude/Maintained Composure", "Energy/Enthusiasm/Attentiveness", "Context Related Responses", "Empathy/Respectfulness/Courteous", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid =='purity_care'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date",
			"Call 1 Call Duration", "Call 1 File No","Call 2 Call Duration", "Call 2 File No","Call 3 Call Duration", "Call 3 File No", "Audit Type", "VOC","Overall Score","Proper Introduction Call 1","Proper Introduction Call 2","Proper Introduction Call 3","Proper Introduction Review","Proper Introduction Score","Customer First Name and Address Verification Call 1","Customer First Name and Address Verification Call 2","Customer First Name and Address Verification Call 3","Customer First Name and Address Verification Review","Customer First Name and Address Verification Score", "Opening Question Call 1","Opening Question Call 2","Opening Question Call 3","Opening Question Review"
			,"Opening Question Score","Accurate Notes Taken Call 1","Accurate Notes Taken Call 2","Accurate Notes Taken Call 3","Accurate Notes Taken Review","Accurate Notes Taken Score","Correct Reason Code Call 1","Correct Reason Code Call 2","Correct Reason Code Call 3","Correct Reason Code Review","Correct Reason Code Score","Correct Information Given Call 1","Correct Information Given Call 2","Correct Information Given Call 3","Correct Information Given Review","Correct Information Given Score","Proper Terminology/use of disc names. etc. Call 1","Proper Terminology/use of disc names. etc. Call 2","Proper Terminology/use of disc names. etc. Call 3","Proper Terminology/use of disc names. etc. Review","Proper Terminology/use of disc names. etc. Score","Proper Inquiry Call 1","Proper Inquiry Call 2","Proper Inquiry Call 3","Proper Inquiry Review","Proper Inquiry Score","Company Promotion Call 1","Company Promotion Call 2","Company Promotion Call 3","Company Promotion Review","Company Promotion Score","Correct Use of Actions Call 1","Correct Use of Actions Call 2","Correct Use of Actions 3","Correct Use of Actions Review","Correct Use of Actions Score","Database Follow Up Call 1","Database Follow Up Call 2","Database Follow Up Call 3","Database Follow Up Review","Database Follow Up Score","Product Promotion Call 1","Product Promotion Call 2","Product Promotion Call 3","Product Promotion Review","Product Promotion Score","Reason for Cancel Call 1","Reason for Cancel Call 2","Reason for Cancel Call 3","Reason for Cancel Review","Reason for Cancel Score","Legitimate Offers/Sequence of Offers Call 1","Legitimate Offers/Sequence of Offers Call 2","Legitimate Offers/Sequence of Offers Call 3","Legitimate Offers/Sequence of Offers Review","Legitimate Offers/Sequence of Offers Score","1st Retention Offer Call 1","1st Retention Offer Call 2","1st Retention Offer Call 3","1st Retention Offer Review","1st Retention Offer Score","2nd Retention Offer Call 1","2nd Retention Offer Call 2","2nd Retention Offer Call 3","2nd Retention Offer Review","2nd Retention Offer Score","Valid Delay Call 1","Valid Delay Call 2","Valid Delay Call 3","Valid Delay Review","Valid Delay Score","Preserved Avg # Units/Shipment Call 1","Preserved Avg # Units/Shipment Call 2","Preserved Avg # Units/Shipment Call 3","Preserved Avg # Units/Shipment Review","Preserved Avg # Units/Shipment Score","Proper Confirmation Call 1","Proper Confirmation Call 2","Proper Confirmation Call 3","Proper Confirmation Review","Proper Confirmation Score","Daily Special Offer Call 1","Daily Special Offer Call 2","Daily Special Offer Call 3","Daily Special Offer Review","Daily Special Offer Score","Anything Else Statement Call 1","Anything Else Statement Call 2","Anything Else Statement Call 3","Anything Else Statement Review","Anything Else Statement Score","Thank You Statement Call 1","Thank You Statement Call 2","Thank You Statement Call 3","Thank You Statement Review","Thank You Statement Score","Maintained call control Call 1","Maintained call control Call 2","Maintained call control Call 3","Maintained call control Review","Maintained call control Score","Response Time/Minimal dead air Call 1","Response Time/Minimal dead air Call 2","Response Time/Minimal dead air Call 3","Response Time/Minimal dead air Review","Response Time/Minimal dead air Score","Uses proper hold techniques Call 1","Uses proper hold techniques Call 2","Uses proper hold techniques Call 3","Uses proper hold techniques Review","Uses proper hold techniques Score","Good Attitude/Maintained Composure Call 1","Good Attitude/Maintained Composure Call 2","Good Attitude/Maintained Composure Call 3","Good Attitude/Maintained Composure Review","Good Attitude/Maintained Composure Score","Energy/Enthusiasm/Attentiveness Call 1","Energy/Enthusiasm/Attentiveness Call 2","Energy/Enthusiasm/Attentiveness Call 3","Energy/Enthusiasm/Attentiveness Review","Energy/Enthusiasm/Attentiveness Score","Context Related Responses Call 1","Context Related Responses Call 2","Context Related Responses Call 3","Context Related Responses Review","Context Related Responses Score","Empathy/Respectfulness/Courteous Call 1","Empathy/Respectfulness/Courteous Call 2","Empathy/Respectfulness/Courteous Call 3","Empathy/Respectfulness/Courteous Review","Empathy/Respectfulness/Courteous Score","Badgering Call 1","Badgering Call 2","Badgering Call 3","Badgering Review","Badgering Score","Average Calls Per Hour/4 or More Call 1","Average Calls Per Hour/4 or More Call 2","Average Calls Per Hour/4 or More Call 3","Average Calls Per Hour/4 or More Review","Average Calls Per Hour/4 or More Score","Average Save % Above 44% Call 1","Average Save % Above 44% Call 2","Average Save % Above 44% Call 3","Average Save % Above 44% Review","Average Save % Above 44% Score","Average Call Length Does Not Exceed 8 min. Call 1","Average Call Length Does Not Exceed 8 min. Call 2","Average Call Length Does Not Exceed 8 min. Call 3","Average Call Length Does Not Exceed 8 min. Review","Average Call Length Does Not Exceed 8 min. Score","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid =='puritycare_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "Call1 Date", "Call2 Date", "Call3 Date", "Call4 Date", "Call5 Date", "Customer Number1", "Customer Number2", "Customer Number3", "Customer Number4", "Customer Number5", "Call1 Duration", "Call2 Duration", "Call3 Duration", "Call4 Duration", "Call5 Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Call VOC1", "Call VOC2", "Call VOC3", "Call VOC4", "Call VOC5", "Overall Score", "Identification of Agent Call1", "Identification of Agent Call2", "Identification of Agent Call3", "Identification of Agent Call4", "Identification of Agent Call5", "Customer Identification Call1", "Customer Identification Call2", "Customer Identification Call3", "Customer Identification Call4", "Customer Identification Call5", "Customer Verification Call1", "Customer Verification Call2", "Customer Verification Call3", "Customer Verification Call4", "Customer Verification Call5", "Opening question Call1", "Opening question Call2", "Opening question Call3", "Opening question Call4", "Opening question Call5", "Identify Reason for Discovery Call1", "Identify Reason for Discovery Call2", "Identify Reason for Discovery Call3", "Identify Reason for Discovery Call4", "Identify Reason for Discovery Call5", "Acknowledge Response Call1", "Acknowledge Response Call2", "Acknowledge Response Call3", "Acknowledge Response Call4", "Acknowledge Response Call5", "Inquiry Probing Call1", "Inquiry Probing Call2", "Inquiry Probing Call3", "Inquiry Probing Call4", "Inquiry Probing Call5", "Value Proposition Call1", "Value Proposition Call2", "Value Proposition Call3", "Value Proposition Call4", "Value Proposition Call5", "1st Retention Attempt Call1", "1st Retention Attempt Call2", "1st Retention Attempt Call3", "1st Retention Attempt Call4", "1st Retention Attempt Call5", "Tactical Hold Call1", "Tactical Hold Call2", "Tactical Hold Call3", "Tactical Hold Call4", "Tactical Hold Call5", "2nd Retention Attempt Call1", "2nd Retention Attempt Call2", "2nd Retention Attempt Call3", "2nd Retention Attempt Call4", "2nd Retention Attempt Call5", "Correct Delay Length Call1", "Correct Delay Length Call2", "Correct Delay Length Call3", "Correct Delay Length Call4", "Correct Delay Length Call5", "Supersaver Confirmation Call1", "Supersaver Confirmation Call2", "Supersaver Confirmation Call3", "Supersaver Confirmation Call4", "Supersaver Confirmation Call5", "Daily Special Call1", "Daily Special Call2", "Daily Special Call3", "Daily Special Call4", "Daily Special Call5", "Thank you Closing Statement Call1", "Thank you Closing Statement Call2", "Thank you Closing Statement Call3", "Thank you Closing Statement Call4", "Thank you Closing Statement Call5", "Full Conf & Cst Acknowledgement Call1", "Full Conf & Cst Acknowledgement Call2", "Full Conf & Cst Acknowledgement Call3", "Full Conf & Cst Acknowledgement Call4", "Full Conf & Cst Acknowledgement Call5", "Made offer to save package Call1", "Made offer to save package Call2", "Made offer to save package Call3", "Made offer to save package Call4", "Made offer to save package Call5",  "Web Login-if applicable Call1", "Web Login-if applicable Call2", "Web Login-if applicable Call3", "Web Login-if applicable Call4", "Web Login-if applicable Call5", "Email Capture-if applicable Call1", "Email Capture-if applicable Call2", "Email Capture-if applicable Call3", "Email Capture-if applicable Call4", "Email Capture-if applicable Call5", "SMS Opt-In-if applicable Call1", "SMS Opt-In-if applicable Call2", "SMS Opt-In-if applicable Call3", "SMS Opt-In-if applicable Call4", "SMS Opt-In-if applicable Call5", "Proper Reason Code Call1", "Proper Reason Code Call2", "Proper Reason Code Call3", "Proper Reason Code Call4", "Proper Reason Code Call5", "Correctly Used Purity Points Call1", "Correctly Used Purity Points Call2", "Correctly Used Purity Points Call3", "Correctly Used Purity Points Call4", "Correctly Used Purity Points Call5", "Agent provided correct information Call1", "Agent provided correct information Call2", "Agent provided correct information Call3", "Agent provided correct information Call4", "Agent provided correct information Call5", "Soft Skills Call1", "Soft Skills Call2", "Soft Skills Call3", "Soft Skills Call4", "Soft Skills Call5", "Rapport Call1", "Rapport Call2", "Rapport Call3", "Rapport Call4", "Rapport Call5", "Maintaining Call Control Call1", "Maintaining Call Control Call2", "Maintaining Call Control Call3", "Maintaining Call Control Call4", "Maintaining Call Control Call5", "***Unauthorized Shipments Call1", "***Unauthorized Shipments Call2", "***Unauthorized Shipments Call3", "***Unauthorized Shipments Call4", "***Unauthorized Shipments Call5", "***Inappropriate Language Call1", "***Inappropriate Language Call2", "***Inappropriate Language Call3", "***Inappropriate Language Call4", "***Inappropriate Language Call5", "***Badgering Call1", "***Badgering Call2", "***Badgering Call3", "***Badgering Call4", "***Badgering Call5", "***Incorrect use of actions Autofail Call1", "***Incorrect use of actions Autofail Call2", "***Incorrect use of actions Autofail Call3", "***Incorrect use of actions Autofail Call4", "***Incorrect use of actions Autofail Call5", "***Making Health Claims Call1", "***Making Health Claims Call2", "***Making Health Claims Call3", "***Making Health Claims Call4", "***Making Health Claims Call5", "***No Confirmation Call1", "***No Confirmation Call2", "***No Confirmation Call3", "***No Confirmation Call4", "***No Confirmation Call5", "***No Retention Call1", "***No Retention Call2", "***No Retention Call3", "***No Retention Call4", "***No Retention Call5", "Call Summary / Feedback #1", "Call Summary / Feedback #2", "Call Summary / Feedback #3", "Call Summary / Feedback #4", "Call Summary / Feedback #5", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
			/* "***Hanging up on Customer Call1", "***Hanging up on Customer Call2", "***Hanging up on Customer Call3", "***Hanging up on Customer Call4", "***Hanging up on Customer Call5", */
		}else if($pid=='touchfuse'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Call Status", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the call answered promptly?", "Did the agent answer with thank you for calling", "Did the agent ask for the zip code?", "Did the agent correctly offer the seminars?", "Did the caller wish to cancel the seminar?", "Did the agent confirm the callers first and last name?", "Did the agent confirm the callers address?", "Did the agent ask for and correctly verify the email phonetically?", "Did the agent correctly ask for and verify the phone number", "Did the agent summarize the call with relevant detail?", "Did the agent offer to register a guest", "Did the agent correctly disposition the call?", "Did the agent use the appropriate closing?", "Did the agent use appropriate tone/pacing/grammar/pronunciation?", "Did the agent use active listening throughout the call?", "Was the agent professional throughout the call?", "Did the agent show knowledge of TouchFuse throughout the call?", "Did the agent maintain call control throughout the call?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='tbn'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Call ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Full Recording Between Communicator and Caller is Captured", "Communicator Properly Prepared for Call", "Communicator Gave Her/His First Name", "Stated-This Call May Be Recorded For Training Purposes", "Stated Offer Title as Scripted", "Stated No Offer Disclosure (if applicable)", "Spelled Donors Full Name Back on ALL CALLS", "EXISTING File - Communicator Verified Address", "IF NEW ADDRESS - Communicator Spelled Address", "IF No Existing Email - Asked for Email", "Spelled Back Email", "Asked for Phone Number", "Confirmed Phone Number", "Verified Phone Number Type", "IF Cell Asked for Consent", "Asked for Alternate Phone Number", "Verified Alternate Phone Number", "Verified Alternate Number Type", "IF Alternate Phone Number is Cell - Asked for Consent", "Read First Request as Scripted", "Appropriately Presented Higher Tier Offers (if applicable )", "Read Monthly Ask As Scripted (if applicable)", "Navigates Script With Ease", "Displays TBN Knowledge and Answers Questions Appropriately", "Correctly Pronounces Speaker/Author Name and Title of Offer", "Overall Script Adherence", "Verified Donation Frequency (One-Time/Monthly)", "Verified Donation Amount", "Verified Monthly Donation Beginning and End Date (if applicable)", "Verified Resource Donor Will Be Receiving (if applicable)", "Read Close as Scripted", "Speaks Clearly with Proper Articulation (no slang)", "Pleasant Demeanor", "Speaks at an Appropriate Pace", "Actively Listens and Responds Appropriately", "Exhibits Empathy (if appropriate)", "Communicator Shows Sincere Appreciation for Donor and Donations", "Maintained Control of the Conversation and Talk Time", "Autofail - False and/or Inappropriate Information", "Autofail - Inappropriately Ended Call", "Autofail - Rudeness/Unprofessional Behavior", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='jfmi'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Greets the customer promptly and properly","Uses professionalism/courtesy/enthusiasm/proper grammar/no jargon","Shows gratitude throughout the call","Collects and verifies all customer information/uses phonetic when applicable","Follows correct Scripting Path","Collects information to provide to Partner Relations if necessary","Covers all payment scripting and responses properly","Maintains call control","Keeps dead air to a minimum","Uses FAQ's/Agent notes to answer questions properly","Brands the call with proper close", "Not stopping the recording for credit card capture", "Agent read legal scripting to the caller", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='hoveround'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Was the agent ready for the call (no dead air)?", "Did the agent give the proper introduction including company name?", "Did the agent correctly probe and transfer if applicable?", "Did the agent verify all customer information/NATO spell back of email address?", "Did the agent close the call with proper branding?", "Did the agent disposition the call properly?", "Was the agent polite and courteous?", "Did the agent show energy empathy and enthusiasm?", "Did the agent have good tone grammer?", "Did the agent give accurate information and show a complete grasp of information?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='ncpssm'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Thanks caller for calling NCPSSM", "Verified opening info", "Gathered and spelled back all necessary information", "Verified/Asked for Email Address", "Makes thank you/supporting statements", "Familiarity with FAQ -Organization", "Personalized call (Mr./Mrs etc)", "Thanked Caller for being a member/previous support", "Energy/enthusiasm", "Proper pace", "Maintained control of the conversation/Minimal Dead Air", "Spoke clearly/utilized proper grammar (NO SLANG)", "Good listening skills/Does not interrupt", "Empathized with caller", "Overall professionalism", "Proper thanks at call conclusion", "Provided correct and appropriate information", "Confirmed caller has no further questions", "False/inappropriate information", "Hung up inappropriately", "Unprofessional behavior", "Inappropriate language", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='stc'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the agent use proper introduction?", "Did the agent correctly capture and verify donor name?", "Did the agent read first request as scripted?", "Did the agent cover second monthly request (if applicable)?", "Did the agent correctly capture and verify donation amount?", "Did the agent offer payment types?", "Did the agent correctly capture and verify donor address?", "Did the agent correctly capture and verify donor phone number?", "Did the agent correctly capture and verify donor email address?", "Did the agent properly present rebuttals (if applicable)?", "Did the agent follow overall script adherence?", "Did the agent show familiarity with Save the Children?", "Did the agent use appropriate script navigation and proper disposition?", "Did the agent follow proper close?", "Did the agent use effective communication?", "Did the agent maintain control of the conversation and talk time?", " Did the agent show appreciation for donor and donations?", "Did the agent give false or inappropriate information?", "Did the agent hang up inappropriately?", "Did the agent show any rudeness or unprofessional behavior?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='tpm'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Read Call Opening as Scripted", "Are You Calling From the US or Canada", "Verify Form of Payment", "Communicator Asked for Name", "Communicator Spelled Name", "Communicator Asked for Address", "Communicator Spelled Address", "Communicator Asked for Phone Number", "Communicator Verified Phone Number", "Communicator Verified Landline or Cell", "Communicator Read Consent to Call Verbatim", "Communicator Read Consent to Text Verbatim", "Communicator Asked for Email", "Communicator Spelled Email", "Overall Script Adherence", "Appropriately Presented higher Tier Offers (If applicable)", "Navigates Script with Ease", "Displays TPM Knowledge and Answers Questions Appropriately", "Verified Contents of the Cart", "Monthly Ask Presented (If Applicable)", "Reviewed Shipping Time Frame", "Provided Cart Total Including Shipping (If Applicable)", "Read Close As Scripted", "Speaks Clearly and Articulately", "Pleasant Demeanor", "Professionalism", "Speaks at an Appropriate Pace", "Listens and Responds Approriately", "Exibits Empathy If Applicable", "Communicator Shows Sincere Appreciation for Donor and Donations", "Maintained Control of the Conversation and Talk Time", "Blatantly False/Inappropriate Information", "Rudely Hung up on Donor", "Rude/Hostile/Uses Profanity", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='patchology'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the agent open the call using their name and the appropriate branding for the call?", "Did the agent close the call using the appropriate branding?", "Remarks1", "Did the agent verify/confirm all necessary information?", "Did agent provide consistent/accurate information regarding products and availability?", "Did agent provide/confirm shipping information/next steps/resolution of issue?", "Remarks2", "Was call answered in a timely manner?", "Was agent engaged/helpful with customer?", "Was customer satisfied/fulfilled?", "If escalated were all resources explored before sending escalation form?", "Remarks3", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='aspca'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greets the customer promptly and properly", "Uses professionalism/courtesy/enthusiasm/proper grammar/no jargon",  "Shows gratitude throughout the call","Collects and verifies all customer information/ uses phonetic when applicable", "Asks if they are calling to join ASPCA guardians program",  "Covered monthly guardian/roundup upsell $25", "Covered one time gift scripting (when applicable)", "Covered all payment scripting and responses properly", "Offers the Animal Champion T-Shirt", "Covers donation processing script", "Covers additional one time donation", "Covers pet insurance / proper close", "Followed correct script path/followed transfer procedures and scripting", "Maintains call control", "Keeps dead air to a minimum", "Uses FAQ's/KB's to answer questions properly", "Personalizes the call", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='ffai'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the agent open the call using their name and the appropriate branding for the call?", "Did the agent close the call using the appropriate branding?", "Did the agent verify/confirm all necessary information and spell back email address using NATO?", "Did agent provide consistent/accurate information regarding products and availability?", "Did agent provide confirm shipping information/next steps/resolution of issue to ensure one call resolution?", "Did agent accurately and clearly fill out pulse on Monday.com?", "Was agent engaged/empathetic with customer?", "Did agent offer membership in the Home Filter Club (if applicable)?", "Did agent offer donation to Wine to Water?", "Was customer satisfied/fulfilled?", "Did agent offer the survey?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='lifi'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Life Quotes Greeting & Introduction", "Did the agent give positive response to the caller", "Customer Name Capture", "Did the agent capture the address of the customer", "Phone Number confirmation", "Email address", "Customer's DOB", "Overall Script Adherence", "Did the agent ask for coverage amount of the Insurance", "Confirmation of Tobacco or smoking", "Did the agent ask for Height & Weight of the customer", "Did the agent mention about price comparison report", "Overall confidence level professionalism & tone", "Call closing", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='heatsurge'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the agent Prepared for call or answer within 5 seconds", "Did the agent use inbound or outbound greeting", "Accesses customers accounts or any reports needed", "Agent verifies cst name address phone and TPA if needed", "Verifies or Asks for email address spelling and gave email disclaimer", "Reads mini Miranda and or Recording statement on outbound calls", "Gives accurate pricing or refund or return information", "Gives accurate shipping or delivery information", "Accurately describes product or promo or answers questions", "Asks for Upsell or add on product where appropriate", "Provides appropriate solution or alternatives", "Keyed or coded order correctly and corrected info as needed", "Asks for cancelation reason", "1st save attempt did agent use PK key buying factors", "2nd save attempt used appropriately and per guidelines", "Asks for billing Name as it appears on cc or check", "agent verified caller is an authorized user of the cc or check", "Asks for billing address for payment method used", "Asks for permission to authorize payment (cc or check)", "Agent verifies shipping address", "Notates account with issue or resolution", "Summarizes and reviews call or appropriate closure to call", "Gave CS hours of operation and CS phone number", "Was the agent polite courteous and patient", "Agent refrained from using inappropriate comments or presentation", "Uses hold and transfers properly", "**Automatic Zero", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='stauers_sales'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the call answered within 5 seconds?","Did the agent verify the customer's name and address on the account?","Did the agent capture the correct offer code?","Did the agent verify the phone number with the customer?","Did the agent verify the customer's email address?","Did the agent compliment the caller's purchase choice?","Did the agent recap the item and ask if the customer would be interested in any other product(s)?","Did the agent cover at least one upsell?","Did the agent cover the replacement guarantee pitch?","Did the agent use an appropriate rebuttal if the replacement guarantee was declined?","Did the agent cover the membership pitch?","Did the agent use an appropriate rebuttal if the membership pitch was declined?","Did the agent offer the membership accurately?","Did the agent cover the auto-renew offer correctly?","Was the shipping address verified?","Did the agent quote the correct delivery time?","Did the agent give a total product quote appropriately?","Did the agent quote shipping & taxes correctly?","Did the agent give the total to be charged and verify the credit card to be charged correctly?","Did the agent provide the order number correctly?","Did the agent close the call with the brand correctly?","Was the customer satisfied with his/her experience?","Was the customer dissatisfied with the agent's professionalism and/or tone?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='operation_smile'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the agent ready to handle the call promptly and answer properly?", "Did the agent greet the caller read the scripted opening?", "Did the agent confirm all information and utilize phonetic spell back when necessary?", "Does the agent show gratitude and acknowledge callers concerns?", "Did the agent use rebuttals appropriately?", "Did the agent offer the upsell?", "Did the agent follow the script correctly and with confidence?", "Did the agent address questions about the program and utilize the FAQs correctly?", "Did the agent speak with energy and enthusiasm?", "Did the agent use proper pacing?", "Did the agent maintain control of the conversation and minimize dead air?", "Was the agent professional and speak with proper enunciation grammar and tone?", "Did the agent use good listening skills and does not interrupt?", "Did the agent empathize with the caller?", "Did the agent provide a good donor experience and show appropriate appreciation?", "Did the agent ask what prompted them to call today?", "Did the agent thank the caller for their call today and close appropriately?", "***Did the agent give false or inappropriate information?", "***Did the agent hang up inappropriately?", "***Did the agent use inappropriate language?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='5_11_tactical'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the rep greet the customer promptly and properly?", "Did the rep confirm the customers item to order (product size colour price)", "Did the rep ask is there anything else you would like to add to your order?", "Did the rep ask for customer login information or continue as guest appropriately", "Did the rep gather/verify the callers information for accuracy", "Did the rep cover the final confirmation (each product total cost to be charged)?", "Did the rep give customer their order number?", "Did the rep use all applicable search method?", "Did the rep cover the returns process appropriately?", "Did the rep cover the exchange process appropriately?", "Did the rep cover the refund process appropriately?", "Did the rep track the package appropriately", "Did the agent ask is there anything else I can assist you with today?", "Did the agent close and brand the call appropriately?", "Did the rep answer questions appropriately", "Did the rep maintain call control?", "Did the rep properly notate AX?", "If an escalation was done was it warranted?", "Did the agent disposition the call appropriately?", "Did the rep maintain professionalism throughout the call?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='jmmi'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1) Did the agent give appropriate greeting?",	"2) Did the agent give excellent conversational responses to caller's requests?",	"3) Did the agent verify the opening information (name-zip code-address-phone number)?",	"4) Did the agent follow call flow with caller's initial request (orders what the caller asks for)?",	"5) Did the agent show appropriate gratitude throughout the call?",	"6) Did the agent share upsells when presented?",	"7) Did the agent show familiarity and search all options for offers products?", "8) If partner-did the agent thank the caller specifically?",	"9) Did the agent share HOM/JMM facts as appropriate and make good use of dead air?",	"10) Was the agent professional with communication?",	"11) Did the agent use proper pace energy & enthusiasm?",	"12) Did the agent maintain control of the conversation?",	"13) Did the agent spoke clearly and utilize proper grammar (no slang)?",	"14) Did the agent use good listening skills and appropriate responses?",	"15) Did the agent empathize with the caller and show compassion?",	"16) Did the agent have minimal dead air?",	"17) Did the agent have the caller provide the address if not populated on review screen?",	"18) Did the agent confirm dollar amount and frequency as well as reviewing cart?", "19) Did the agent read shipping information as scripted/share charges as appropriate?", "20) Did the agent ask caller for email and tv information?", "21) Did the agent use proper thanks at the call conclusion?", "22) Did the agent transfer the call to prayer/CS when appropriate?", "23) ***Did the agent follow payment industry compliance policies properly?", "24) ***Did the agent read back the customer's details properly? Like name - phone number etc.", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='non_profit'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Properly prepared to take calls", "Clearly stated paid caller from Donor Care Center/recorded line", "Communicator stated his/her full name", "Pronounced clients name correctly", "Gave a warm friendly greeting", "Followed scripted 1st request as scripted", "1st request Used correct dollar amounts", "1st request Assumptive gift ask", "Showed empathy/Concern", "Repeated the objection", "Personalized the objection", "Attempted to handle objection", "Did not reinforce the negative", "Exited a dead-end call", "Followed scripted 2nd request as scripted", "2nd request Used correct dollar amounts", "2nd request Assumptive gift ask", "Attempted 3rd request as scripted (when applicable)", "3rd request Used correct dollar amounts", "3rd request Assumptive gift ask", "Confirmation question/Confirmed gift amount & waited for response", "Assumed the higher dollar amount", "Showed meaningful gratitude/Thanked the donor or volunteer", "Read credit card/ACH ask verbatim/assumptively asked for credit card", "Confirmed full name and address", "Followed Maybe Close appropriately", "Read close as scripted", "Ended call in a reasonable time", "Sounded conversational used good voice inflection not read or monotone", "Mirrored donor / Used appropriate pace", "Confident presentation w/out hesitation filler words or uptalking", "Did not lose control of the conversation", "Proper personalization", "Utilized proper grammar & pronunciation", "BAILING", "DID NOT ASK FOR A CREDIT CARD/ACH", "GAVE FALSE INFORMATION", "OMITTED PAID CALLER FROM DONOR CARE CENTER STATEMENT", "DID NOT ASK CONFIRMATION QUESTION", "UNSOLID GIFT", "NOT CODING A REFUSAL/CODING A REFUSAL INAPPROPRIATELY", "UNPROFESSIONAL BEHAVIOR/RUDENESS (not extreme)", "IMPROPER PRESENTATION", "OMITTED DNC CODE/USED DNC CODE INCORRECTLY", "FALSIFICATION OF A GIFT", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='revel_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Agent greeted the member used correct client opening introduced themselves and continued following the basic scripting to open the call", "Agent properly authenticated the member", "Did Agent attempt to update Email/SMS/IVR/Phone Number?", "Agent gave Health Care Activity info Correctly", "Agent collected Health Care Activity information correctly", "Agent gave correct Gift Card information", "Agent offered to provide information on the Health Care Activities that the member has remaining to complete", "Agent provided online self-service information", "Agent used correct transfer procedure", "Agent logged call correctly in all appropriate systems", "Agent followed script guidelines ", "Agent gave correct and complete information", "Agent resolved all questions and concerns", "Agent displayed active listening skills and probed for details effectively","Agent effectively engaged with the caller","Agent displayed a polite/appropriate tone", "Agent sounded confident and knowledgeable", "Agent did not interrupt or talk over the customer","Agent used pleasing words and phrases ","Agent maintained call control","Agent used correct grammar avoided slang", "Agent offered additional assistance", "Agent used correct client closing ", "Agent submitted escalation in system when required (Auto-Fail)", "Agent was not rude or inappropriate? (Auto-Fail)", "Agent used the correct client name during the call (Auto-Fail) ", "Agent did not demonstrate call avoidance (Auto-Fail)", "Agent properly authenticated the member (Auto-Fail)", "The agent received direct appreciation from the member ","Is the recording quality acceptable? (Tracking)","Would play this for the client?(Tracking)","Mechanics Comment 1","Mechanics Comment 2","Mechanics Comment 3","Mechanics Comment 4","Mechanics Comment 5","Mechanics Comment 6","Mechanics Comment 7","Mechanics Comment 8","Mechanics Comment 9","Mechanics Comment 10","Mechanics Comment 11","Mechanics Comment 12","Mechanics Comment 13","Soft Skills Comment 1","Soft Skills Comment 2","Soft Skills Comment 3","Soft Skills Comment 4","Soft Skills Comment 5","Soft Skills Comment 6","Soft Skills Comment 7","Soft Skills Comment 8","Soft Skills Comment 9","Soft Skills Comment 10","Auto-fail Comment 1","Auto-fail Comment 2","Auto-fail Comment 3","Auto-fail Comment 4","Auto-fail Comment 5","Bonus Point Comment","Tracking Comment 1","Tracking Comment 2","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");

		}else if($pid=='revel_old'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "CSR ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the rep greet the customer promptly and properly?", "Did the rep use a pleasant respectful tone and use the caller name", "Did the rep answer in a timely manner?", "Did the rep collect and verify the caller information appropriately and accurately?", "Did the rep use active listening skills throughout the inquiry so the caller did not have to repeat themselves?", "Did the rep demonstrate use of call control techniques?", "Did the rep refrain from interrupting the caller?", "Did the rep speak clearly and concisely and at an appropriate pace?", "Did the rep avoid use of internal terms technical terms slang and jargon?", "Did the rep demonstrate confidence in responses?", "Did the rep use the callers last name to personalize the call at least once per section?", "Did the rep minimize silences and use fillers to obtain additional information?", "Did the rep maintain call control?", "Did the rep use the tools appropriately?", "Did the rep demonstrate knowledge of the product/program?", "Did the rep use the appropriate scripting responses verbatim?", "Did the rep accurately and completely document the call?", "Did the rep complete the correct confirmation and closing?", "Did the rep thank the caller before closing?", "***Did the rep attempt give Medical Advice to the caller?", "***Did the agent miscode the call?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Authentication Comment 2.1", "Listening Skills Comment 3.1", "Listening Skills Comment 3.2", "Listening Skills Comment 3.3", "Soft Skills Comment 4.1", "Soft Skills Comment 4.2", "Soft Skills Comment 4.3", "Soft Skills Comment 4.4", "Soft Skills Comment 4.5", "Knowledge Procedure & Call Flow Comment 5.1", "Knowledge Procedure & Call Flow Comment 5.2", "Knowledge Procedure & Call Flow Comment 5.3", "Knowledge Procedure & Call Flow Comment 5.4", "Closing Comment 6.1", "Closing Comment 6.2", "Closing Comment 6.3", "Auto-Fail Comment 7.1", "Auto-Fail Comment 7.2", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='qpc'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Unprepared to Introduce Call", "Did Not Use Branding", "Data Not Collected or Collected Incorrectly", "Second Data Occurrence", "Inaccurate Call Result Code", "Inappropriate or Unusable After-Call Comments", "Underutilized Call Narration", "Inappropriate FAQ Responses", "No or Improper Transitions", "Under-Acknowledged Caller's Concerns", "Inappropriate Script Navigation", "Did Not Display Ownership", "Incorrect Transfer or Referral", "***Did the agent abruptly end the call or display any rude behavior?", "***Did the agent answer premium/cover questions?", "***Did the agent give a wrong callback or referral number?", "***Did the agent use an incorrect carrier name?", "Open/Close Comment 1.1", "Open/Close Comment 1.2", "Data Accuracy Comment 2.1", "Data Accuracy Comment 2.2", "Data Accuracy Comment 2.3", "Data Accuracy Comment 2.4", "Active Listening Comment 3.1", "Active Listening Comment 3.2", "Customer Experience Comment 4.1", "Customer Experience Comment 4.2", "Customer Experience Comment 4.3", "Customer Experience Comment 4.4", "Customer Experience Comment 4.5", "Auto-Fail Comment 5.1", "Auto-Fail Comment 5.2", "Auto-Fail Comment 5.3", "Auto-Fail Comment 5.4", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='ancient_nutrition'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the customer promptly and properly?", "1.2 Did the rep use a pleasant respectful tone and use the callers name at least once?", "1.3 Did the rep answer in a timely manner?", "2.1 Did the rep collect and verify the callers information appropriately and accurately?", "2.2 Did the rep cover the payment procedures appropriately?", "3.1 Did the rep use active listening skills throughout the inquiry so the caller did not have to repeat themselves?", "3.2 Did the rep demonstrate use of call control techniques?", "3.3 Did the rep refrain from interrupting the caller?", "4.1 Did the rep speak clearly and concisely and at an appropriate pace?", "4.2 Did the rep avoid use of internal terms technical terms slang and jargon?", "4.3 Did the rep demonstrate confidence in responses?", "4.4 Did the rep use the callers last name to personalize the call at least once per section?", "4.5 Did the rep minimize silences and use fillers to obtain additional information?", "5.1 Did the rep cover the Auto Shipping appropriately?", "5.2 If rep gathered email did they read the complete email scripting?", "5.3 Did the rep cover the Rush Shipping appropriately?", "5.4 Did the rep complete order confirmation?", "5.5 Did the rep maintain call control?", "5.6 Did the rep use the tools appropriately?", "5.7 Did the rep demonstrate knowledge of the product/program?", "5.8 Did the rep use the appropriate objection responses?", "6.1 Did the rep accurately and completely document the call?", "6.2 Did the rep complete the correct confirmation and closing?", "6.3 Did the rep thank the caller before closing?", "7.1 ***Did the rep attempt give Medical Advice to the caller?", "7.2 ***Did the rep cover the upsell appropriately?", "7.3 ***Did the agent read the confirmation script if email address was obtained?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Authentication Comment 2.1", "Authentication Comment 2.2", "Listening Skills Comment 3.1", "Listening Skills Comment 3.2", "Listening Skills Comment 3.3", "Soft Skills Comment 4.1", "Soft Skills Comment 4.2", "Soft Skills Comment 4.3", "Soft Skills Comment 4.4", "Soft Skills Comment 4.5", "Knowledge Procedure& Call Flow Comment 5.1", "Knowledge Procedure& Call Flow Comment 5.2", "Knowledge Procedure& Call Flow Comment 5.3", "Knowledge Procedure& Call Flow Comment 5.4", "Knowledge Procedure& Call Flow Comment 5.5", "Knowledge Procedure& Call Flow Comment 5.6", "Knowledge Procedure& Call Flow Comment 5.7", "Knowledge Procedure& Call Flow Comment 5.8", "Closing Comment 6.1", "Closing Comment 6.2", "Closing Comment 6.3", "Auto-Fail Comment 7.1", "Auto-Fail Comment 7.2", "Auto-Fail Comment 7.3", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='sabal'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the agent ask for the individual by Mr. or Mrs. Last Name?", "Did the agent introduce him/herself?", "Did the agent state he/she is a Customer Service Specialist for WellCare?", "Did the agent apologize for the unannounced phone call and state reason for the call?", "Did the agent ask how the individuals Rx plan is currently working for him/her and respond with the appropriate scripted response?", "Did the agent read the listed examples of benefits they could add? Comprehensive Dental i)Complete Vision ii)Extensive Hearing iii)Transportation iv)Free membership to fitness centers and some even come with a free Fitbit!", "Did the agent ask for the individuals red white and blue card and explain why this was needed?", "Did the agent ask for the individuals updated Medicare ID and accurately record the inforamtion?", "Did the agent ask for the individuals Part A effective date and accurately record the information?", "Did the agent use correct rebuttal is individual doesnt want to give ID over the phone?", "Did the agent use scripting if the individual wants to know the cost to him/her?", "Did the agent use correct rebuttal if the agent says he/she is not interested?", "***Did the agent abruptly end the call or display any rude behavior?", "***Did the agent become argumentative with the individual?", "***Did the agent record the incorrect Medicare members information?", "***Did agent provide any false or misleading information?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Call Flow Comment 2.1", "Call Flow Comment 2.2", "Call Flow Comment 2.3", "Data Collection Comment 3.1", "Data Collection Comment 3.2", "Data Collection Comment 3.3", "Rebuttals Comment 4.1", "Rebuttals Comment 4.2", "Rebuttals Comment 4.3", "Auto-Fail Comment 5.1", "Auto-Fail Comment 5.2", "Auto-Fail Comment 5.3", "Auto-Fail Comment 5.4", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='curative'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the customer promptly and properly?", "1.2 Did the rep use a pleasant respectful tone?", "1.3 Did the rep answer in a timely manner? (within 5 seconds)", "2.1 Did the rep collect and verify the customers information appropriately and accurately?", "2.2 Did the rep verify patients PHI (name email phone number address email address DOB) is entered correctly in Patient Portal?", "2.3 Did the agent accurately send the email regarding correct use of all PHI?", "2.4 Did the agent escalate to Tier 2 when necessary? (Helpscout ticket tag Tier 2 Escalation) Test Cancelled", "2.5 Did the agent respect the patients privacy and provide results only to the verified caller?", "2.6 Did the agent ensure the email address was correct prior to sending the email message and only send to the verified caller?", "3.1 Did the agent speak clearly concisely and at an appropriate pace?", "3.2 Did the agent avoid use of internal terms technical terms slang and jargon on the call and in email?", "3.3 Did the agent demonstrate a strong use of empathy in responses where required on the call and in email?", "3.4 Did the agent use please and thank you throughout the call and in email communication?", "3.5 Did the agent minimize extended silences throughout the call?", "3.6 Did the agent speak with sincere warmth in his/her voice?", "3.7 Did the agent use correct sentence structure and grammar in email commumnication?", "3.8 Did the agent demonstrate patience with the caller?", "3.9 Did the caller give the agent a KUDOS or express happiness with the rep?", "4.1 Did the rep accurately and completely document the call?", "4.2 Did the rep complete the correct confirmation and closing?", "4.3 Did the rep thank the caller before closing?", "4.4 Did the agent provide accurate results?", "4.5 Did the rep anticipate the caller's needs?", "4.6 Did the rep do everything possible to assist the caller?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "AutoFail Comment 2.1", "AutoFail Comment 2.2", "AutoFail Comment 2.3", "AutoFail Comment 2.4", "AutoFail Comment 2.5", "AutoFail Comment 2.6", "Soft Skills Comment 3.1", "Soft Skills Comment 3.2", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5", "Soft Skills Comment 3.6", "Soft Skills Comment 3.7", "Soft Skills Comment 3.8", "Soft Skills Comment 3.9", "Closing Comment 4.1", "Closing Comment 4.2", "Closing Comment 4.3", "Closing Comment 4.4", "Closing Comment 4.5", "Closing Comment 4.6", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='powerfan'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the agent Prepared for call answer within 5 seconds", "Did the agent identify self and the company?", "Collects intro information Claim code zip code", "Main Sell agent accurately gave terms of offer asks for sale per script quanity", "Did the agent promote upsell downsell asks for sale per script", "Accurately Described Product answered", "Used appropriate Objection Handling", "Asks for billing Name as it appears on cc or check", "If billing name is different than caller agent verified caller is an authorized user of the cc or check", "Asks for billing address for payment method used", "Agent verifies shipping address", "Order was set up and or coded correctly", "Asks for email address spelling and gave email disclaimer", "Gave total amount charged payment information", "Gave correct shipping information", "Gave MBG return info in", "Gave CS phone number", "Asks for permission to authorize payment cc or check", "Was the agent polite courteous and patient", "Agent refrained from using inappropriate comments presentation", "Uses hold and transfers properly", "Auto Fail", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='nuwave'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Order ID", "Call Duration", "Interaction", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greeting & Identification: Example Thank you for calling NuWave", "Asked and Verified Customer Information: May I please have your Order ID Primary name or e-mail address?", "Used the Callers Name: CSR should address the customer as he/she addresses him/herself Mr. Mrs. Dr. Rev. etc.", "Active Listening: Doesnt interrupt the customer understands customers frame of reference doesnt anticipate or make assumptions", "Communication Skills: Converses in a clear concise manner", "Professionalism: Avoids the use of slang jargon and acronyms", "Empathy Towards Customer: CSR sounds sincere about helping the customer and apologizes", "Courtesy: CSR sounds helpful upbeat friendly and patient", "Put On Hold: Asked customer May I put you on hold or Could you hold while I research this further please?", "Thanked Customer for Holding: CSR thanked customer for holding upon returning to customers call", "Hold Time/Reason Appropriate/Inappropriate: Was it really necessary for the CSR to put the customer on hold?", "Escalation/Referral Procedures: Utilized established guidelines and procedures policy from the leadership team", "Fact Finding: Used probing questions and resources to identify problem", "Verbally Verified Problem Reported: Clearly defined and restated needs reported by the customer", "Managed Customer Expectations: Regarding the order of the product and the shipping time", "Explained: Reason for troubleshooting for possible resolution", "Used Available Resources Well: Referred to knowledge training or other resource programs for order troubleshooting", "Complete & Accurate Customer Documentation: Complete description of the order and or the troubleshooting steps", "Trial Close: Confirmed customer is comfortable with outcome", "Additional Needs Uncovered: CSR asked Is there anything else that I can assist you with today?", "Upsale: Ask customer if the product completely serves their needs", "Used Correct Closing Gave Customer Order Number: Mr. Ms. Mrs. I would like to thank you for ordering with NuWave", "Infractions", "Sub-Infractions", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='delta_iowa'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call ID", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Answered the call promptly (within 5 seconds)", "1.2 Opens the call properly obtains caller name", "1.3 Verifies all identifying information to continue the call", "2.1 Adhered to HIPAA/PCI guidelines depending on the type of call", "2.2 Adhered to Client Policies & Procedures", "2.3 Performed the correct actions for the caller", "2.4 Set approriate expectations", "2.5 Gave accurate and complete information", "2.6 Routed issue to the appropriate department", "2.7 Completed all necessary documentation", "3.1 Used courtesy phrases like please and thank you throughout the call", "3.2 Used the caller's name at least once during the call", "3.3 Followed acceptable hold and transfer procedures", "3.4 Allowed the caller to state the reason for the call", "3.5 Avoided the use of jargon acronyms and slang", "3.6 Allowed the caller to speak without interruption", "3.7 Explained all positives of the plan-type without pushing the caller to purchase", "3.8 Stated a willingness to help the caller usually at the beginning of the call", "3.9 Gained agreement with the caller on the proposed solution", "3.10 Demonstrated an empathetic manner professional tone", "4.1 Closed call by offering further assistance", "4.2 Resolved and followed through on all actions to resolve the customers issue", "4.3 Assured customer their concern will be handled to resolution when possible", "4.4 Made an effective attempt to handle a difficult situation", "*** Agent disconnects customer inappropriately", "*** Agent transfers customer without notifying customer", "*** Agent uses offensive words or profanity", "*** Agent was antagonistic talked back or talked down to caller", "*** Agent discloses confidential information inappropriately", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Call Handling Comment 2.1", "Call Handling Comment 2.2", "Call Handling Comment 2.3", "Call Handling Comment 2.4", "Call Handling Comment 2.5", "Call Handling Comment 2.6", "Call Handling Comment 2.7", "Soft Skills Comment 3.1", "Soft Skills Comment 3.2", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5", "Soft Skills Comment 3.6", "Soft Skills Comment 3.7", "Soft Skills Comment 3.8", "Soft Skills Comment 3.9", "Soft Skills Comment 3.10", "Closing Comment 4.1", "Closing Comment 4.2", "Closing Comment 4.3", "Closing Comment 4.4", "Auto Fail Comment 1.1", "Auto Fail Comment 1.2", "Auto Fail Comment 1.3", "Auto Fail Comment 1.4", "Auto Fail Comment 1.5", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='foodsaver'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the caller promptly and properly with the correct scripted greeting?", "1.2 Did the rep use a pleasant, respectful tone?", "2.1 If the caller said no to the initial offer did the rep use the 1st rebuttal", "2.2 Did the rep also include the 2nd and 3rd points to explain how FoodSaver preserves", "2.3 Did the rep ask the question - Which credit or debit card would you like to use?", "2.4 If the caller said no to this first rebuttal did the rep use the 2nd rebuttal advising of the lowered price at just $99.99 with free shipping and handling?", "2.5 If the caller still said no did the rep advise - We appreciate your call and your interest in FoodSaver", "2.6 Did the rep thank the caller for calling today?", "3.1 Did the rep advise of the 2 Pack of 11 x 16 Rolls at $19.99?", "3.3 Did the rep ask - Would you like to add these to your order and confrim how many they want to add?", "3.4 Did the rep offer Auto Delivery at a 20% savings? ", "3.5 Did the rep ask if the caller would like to add another Food Saver as a gift?", "3.6 Did the rep ask for an email address?", "3.7 Did the rep ask which credit card the caller will be using?", "4.1 Did the rep thank the caller for the order?", "4.2 Did the rep review the order summary and total cost?", "4.3 Did the rep ask if there was anything else we could help with?", "4.4 Did the rep end with a positive statement?", "**Did the rep enter an incorrect credit card number?", "**Did the rep speak rudely to the caller in any way?", "**Did the rep badger the caller?", "**Did the rep disconnect the call without reason?",
			"Greeting Comment 1.1", "Greeting Comment 1.2", "Rebuttals Comment 2.1", "Rebuttals Comment 2.2", "Rebuttals Comment 2.3", "Rebuttals Comment 2.4", "Rebuttals Comment 2.5", "Rebuttals Comment 2.6", "Yes to offer Comment 3.1", " Comment 3.3", "Yes to offer Comment 3.4", "Yes to offer Comment 3.5", "Yes to offer Comment 3.6", "Yes to offer Comment 3.7", "Closure Comment 4.1", "Closure Comment 4.2", "Closure Comment 4.3", "Closure Comment 4.4", "Auto Fail Comment 1.1", "Auto Fail Comment 1.2", "Auto Fail Comment 1.3", "Auto Fail Comment 1.4", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='suarez'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "This call was a/an", "Account Identifiers", "Date of Coaching/Copy Received", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did you answer the call promptly and sound ready to take the call?", "Was your introduction clear and free of excess Unacceptableise and distraction?", "Did you use the correct greeting?", "Did you smile and sound friendly and happy to take the customer call?", "Was the drop code captured correctly?", "Did you adhere to the script correctly and follow the appropriate decision points?", "Did you ask for and verify all information correctly?", "Did you read all disclaimers and special Unacceptabletes offered in the script?", "Did you complete the call properly?", "Did you sound confident about the product and/or offer?", "Were all required upsells offered correctly?", "Did you go above and beyond the requirements to obtain a sale additional units or additional upsell opportunity?", "Additional units or additional upsell opportunity?", "Did you control the call without excessive chatting and Unacceptablen-business conversation?", "Did you lose a sale?", "Did you appropriately answer the customer questions and make every effort to satisfy the customer and the purpose of the call?", "Did the customer have your full attention?/ were you listening while the customer was speaking?", "Were you heard interrupting the customer raising your voice or using an unfriendly or unprofessional tone?", "What is the Specialist impression of customer temperature at the END of the call?", "Was there a Unacceptableticeable change in customer temperature during the call?", "Did you use hold times appropriately in regard to this call?", "Was the order keyed correctly?", "Was there anything regarding this customer account or experience that you missed?", "On this call was it obvious that you use your down time to study products promotions and procedures?", "Were you heard saying anything negative or unprofessional in regard to this call on or off the phone?", "Greeting Comment 1", "Greeting Comment 2", "Greeting Comment 3", "Greeting Comment 4", "Script and Procedure Adherence Comment 1", "Script and Procedure Adherence Comment 2", "Script and Procedure Adherence Comment 3", "Script and Procedure Adherence Comment 4", "Script and Procedure Adherence Comment 5", "Sales Ability Comment 1", "Sales Ability Comment 2", "Sales Ability Comment 3", "Sales Ability Comment 4", "Sales Ability Comment 5", "Sales Ability Comment 6", "Soft Skills Comment 1", "Soft Skills Comment 2", "Soft Skills Comment 3", "Soft Skills Comment 4", "Soft Skills Comment 5", "Additional Details Comment 1", "Additional Details Comment 2", "Additional Details Comment 3", "Additional Details Comment 4", "Additional Details Comment 5", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='sfe'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
				"1.1 Did the agent advise who he/she is who he/she is calling from and who he/she represents?","1.2 Did the agent advise the call is being recorded for quality assurance and training purposes?",
				"2.1 Did the agent provide all program benefits including rates explanation and benefits?","2.2 Did the agent ask if he/she was speaking with the account holder?","2.3 Did the agent ask if the caller was receiving any government assistance?","2.4 Did the agent ask for the address and email?","2.5 Did the agent ask if the caller was 18 years or older?",
				"3.1 Did the rep sound confident and polite to the person on the phone?","3.2 Did the agent address the caller by name at least once?","3.3 Did the agent use 'please' and 'thank you' throughout the call?","3.4 Did the agent minimize extended silences throughout the call?","3.5 Did the agent speak clearly?",
				"4.1 Did the agent use the first rebuttal correctly if the caller was not interested?","4.2 Did the agent use the second rebuttal correctly if the caller was not interested?","4.3 Did the agent provide the phone number for call back it the caller was not interested?",
				"5.1 Did the agent advise of the Welcome Package would be sent including the program details and contact information?","5.2 Did the agent ask for the sale and gain a 'yes' before proceeding?","5.3 Did the rep finalize the date for the quote?","5.4 Did the rep take complete detailed notes?",
				"6.1 Did the rep proceed with the call without a firm 'yes'","6.2 Did the rep provide accurate information?","6.3 Did the rep mislead the caller in any way?","6.4 Did the rep advise that he/she uses this service?","6.5 Did the rep advise that he/she uses this service?(need more detail for this)",
				"Greeting Comment 1.1", "Greeting Comment 1.2","Details Comment 2.1", "Details Comment 2.2", "Details Comment 2.3", "Details Comment 2.4","Details Comment 2.5","Soft Skills Comment 3.1", "Soft Skills Comment 3.2", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5","Rebuttls Comment 4.1", "Rebuttls Comment 4.2", "Rebuttls Comment 4.3","Closure Comment 5.1", "Closure Comment 5.2", "Closure Comment 5.3", "Closure Comment 5.4","Auto Fail Comment 6.1", "Auto Fail Comment 6.2", "Auto Fail Comment 6.3", "Auto Fail Comment 6.4","Auto Fail Comment 6.5",
				"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='brightway_ib_bank'){
         $header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","Overall Score", "Possible Score", "Earned Score","1.  Did the CSR use the approved greeting including Brightway branding name and customer name and policy number and offer assistance?","2. If applicable did rep advise they were on a recorded line?","3. Verified and captured points of contact according to procedure.","1. Did the associate use the appropriate tone pace and professionalism ?","2. Did the associate avoid insurance jargon and used proper grammar throughout the call?","3. Did the associate demonstrate the right level of empathy or sympathy?","4. Did the associate listen carefully to understand and address the customers needs ?","5. Did the associate ask to place the caller on hold set proper time expectations and thank them when returning?","6. The associate maintained call control throughout the call by guiding the conversation to stay on topic","7. There was not any silence dead air or self talking that had a negative impact on the call.","8. All verbal and written information provided by associate to insured and other parties was clear accurate and included all relevant information. (2pts for each)","1. Did the associate ask probing questions and verbally verify the changes requested and information provided?","2. If applicable was the call warm transferred","3. Expectations provided and time frame for follow up if any was met.","4. If the call was disconnected prior to resolution did the CSR attempt to contact the caller back to complete the call?","5. Documented correct policy is AMS","6. Are the notes clear descriptive and fully capture what occurred on the call so others understand what was discussed and if anything additional is needed?","7. Created all activities corresponding with the interaction","8. Were the correct templates used? ","9. Attached all emails fax confirmations and other documents as needed","10. Was the issue or request resolved/completed?","11. Requested all signed documents/supporting documentation when further action is required from the customer. CSR did not request any unnecessary or incorrect documents.","12. CSR offered any possible alternative options or solutions to callers request.","13. Effectively accessed and utilized all appropriate systems and resources.","14. Were all changes made in AMS and/or carrier site ?","15. All associated policies were updated as needed (for example flood and umbrella).","16. Was the appropriate suspense created for follow up if needed?","17. Addressed any service-related suspense items that were open at the time they spoke with the customer.","18. CSR updated any suspense that was addressed during the call and closed if applicable.","19. Was the correct disposition selected","1. Did the CSR provide a wrap-up summary including the CSRs and callers action items?","2. Did the associate offer additional assistance thanked the customer?","1. Bonus Question","1. Was the call an Auto-Fail?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
         }else if($pid=='offline'){
         $header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Phone","Rep","Enter Policy Information","Florida or National?","Type of Policy","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","Overall Score", "Possible Score", "Earned Score","Did the associate handle the request according to Brightways standards?","Did the associate handle the request according to the carriers standards?","Did the associate process the change correctly?","Did the associate use the appropriate verbiage tone pace and professionalism?","All verbal and written information provided by associate to insured and other parties was clear accurate and included all relevant information","Was the customer adversely impacted?","Were there any additional adverse impacts?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='qpc_esal'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Call ID", "Call Type", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1. Opens the call with a correct introduction", "2. Accurate translation", "3. Provides correct data", "4. Uses correct grammar", "5. Effective communication", "6. Active listening", "7. Avoids long silence gaps", "8. Communicates in a polite and respectful manner", "9. Correctly indicates cannot translate profanity", "10. Closes the call accordingly", "Comment 1", "Comment 2", "Comment 3", "Comment 4", "Comment 5", "Comment 6", "Comment 7", "Comment 8", "Comment 9", "Comment 10", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='ab_commercial'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super","Call Date","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","Overall Score","Correct Subject line","Correct Signature/Billing/ Docusign/Bank fax sent if necessary","Subjectivities mentioned on email","Coverage changes mentioned on email","Correct invoice included","Quote included","Correct edits made","Application/forms included if necessary","DE suspense sent if necessary","Prem increase suspense sent if necessary","Coverage Change suspense sent if necessary","Suspense status updated","Renewal sheet updated","Correct activity entered into AMS with email attached","Correct requirements via Docusign (if appliable)","Email 40% Comment 1","Email 40% Comment 2","Email 40% Comment 3","Email 40% Comment 4","Packet 20% Comment 1","Packet 20% Comment 2","Packet 20% Comment 3","Packet 20% Comment 4","Requirements Met 20% Comment 1","Requirements Met 20% Comment 2","Requirements Met 20% Comment 3","Status Update 20 % Comment 1","Status Update 20 % Comment 2","Status Update 20 % Comment 3","Status Update 20 % Comment 4","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}elseif ($pid=="cinemark") {
      $header= Array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time","Interval","QA Score",
      "1.1 Did the agent greet the customer appropriately?","1.2 Did the agent provide his/her name?","1.3 Did the agent ask how/he or she could assist the caller?","2.1 Did the agent adhere to the refund rules?",
      "2.2 If the customer asked to speak to a supervisor did we transfer to an internal supervisor?","2.3 Did the agent fill out a ticket properly?","2.4 Did the agent include the theater number?",
      "2.5 Did the agent leave a correct note?","2.6 Did the agent leave the confirmation number or order number?","2.7 If a Fandango customer called in did the agent supply the correct information?",
      "2.8 Was the agent able to access customers past transactions (if applicable)?","3.1 Did the agent have an appropriate tone and use please and thank you throughout the call?",
      "3.2 Did the agent close the call correctly?","4.1 Did the agent complete all necessary tasks correctly?","4.2 Did the agent use any inappropriate language or demean the caller?",
      "4.3 Did the agent hang up on the caller?","Remarks 1","Remarks 2","Remarks 3","Remarks 4","Remarks 5","Remarks 6","Remarks 7","Remarks 8","Remarks 9","Remarks 10","Remarks 11",
      "Remarks 12","Remarks 13","Remarks 14","Remarks 15","Remarks 16","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="empire"){
      $header = array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time","Interval","QA Score",
      "1.1 Prepared to take the call","1.2 Use of standard greeting","1.3 Open the call with an enthusiastic pleasant tone of voice","2.1 Use courtesy phrases such as please and thank you",
      "2.2 Use of customers name appropriately during the call","2.3 Professional communication","2.4 Positively represent Empire","2.5 Active listening","2.6 Maintain Call Control",
      "3.1 Probe for accurate understanding of customer need","3.2 Restate customer need correctly","3.3 Set expectations","3.4 Ask customer for appointment","4.1 Verify Customer Account",
      "4.2 Confirm All Data","4.3 Provide accurate and complete information","4.4 Demonstrate confidence in the information being conveyed","4.5 Overcome objections",
      "5.1 Confirm appointment","5.2 Use standard closing","Remarks 1","Remarks 2","Remarks 3","Remarks 4","Remarks 5","Remarks 6","Remarks 7","Remarks 8","Remarks 9","Remarks 10","Remarks 11",
      "Remarks 12","Remarks 13","Remarks 14","Remarks 15","Remarks 16","Remarks 17","Remarks 18","Remarks 19","Remarks 20","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }elseif ($pid=="hcpss") {
      $header=array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time", "Interval","QA Score",
      "1.1 Did you answer the call promptly and sound ready to take the call?","1.2 Was your introduction clear and free of excess noise and distraction?","1.3 Did you use the correct greeting?",
      "1.4 Did you smile and sound friendly and happy to take the customers call?","2.1 Was the case captured correctly? Close Contact/ Confirmed Positive","2.2 Did you adhere to the script correctly and Capture all the correct information needed?",
      "2.3 Did you ask for and verify all information correctly?","2.4 Did you add all the appropriate notes on the call?","2.5 Did you complete the call properly?","3.1 Did you sound confident about the process?",
      "3.2 Did you go above and beyond the requirements to assure the caller was taken care of?","4.1 Did you appropriately answer the callers questions and make every effort to satisfy the caller and complete your calls purpose?",
      "4.2 Did the caller have your full attention?/ were you actively listening while the caller was speaking?","4.3 Were you heard interrupting the caller raising your voice or using an unfriendly or unprofessional tone or words/Slang (was your email professional as well)",
      "5.1 Did you use hold times appropriately?","5.2 Was the call handled correctly/dipostioned correctly?","5.3 If confirmed Postive did the agent correctly list all the close contacts.",
      "5.4 Were you heard saying anything negative or unprofessional in regard to this call on or off the phone?","Comment 1","Comment 2","Comment 3","Comment 4","Comment 5","Comment 6","Comment 7","Comment 8","Comment 9","Comment 10","Comment 11",
      "Comment 12","Comment 13","Comment 14","Comment 15","Comment 16","Comment 17","Comment 18","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="cmn"){
      $header=array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time", "Interval","QA Score",
      "Opening","Closing","Empathy/Apology","Ownership/Assurance","Tone / Rate of Speech / Fumbling","Active Listening","Interruption / Parallel Conversation","Issue Identification / Understanding","Probing",
      "Mode of Payment confirmation","Refund Processed Correctly","Email ID Verification","Phone Number Verification","ZTP","Comment 1","Comment 2","Comment 3","Comment 4","Comment 5","Comment 6","Comment 7","Comment 8",
      "Comment 9","Comment 10","Comment 11","Comment 12","Comment 13","Comment 14","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="pilgrim"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "QA Score",
      "Did the agent give the proper introduction and include their name?",
      "Did the agent explain the offer and/or products?","Did the agent give customer proper responses?","Did the agent correctly probe?",
      "Did the agent disposition the call properly?",
      "Was the agent polite & courteous?",
      "Was the agent ready for the call (minimal dead air)?","Did the agent show energy empathy and enthusiasm?",
      "Did the agent use appropriate tone pacing grammar & pronunciation?",
      "Did the agent show accurate and complete grasp of information?",
      "Did the agent set up Gold Card correctly-ideology",
      "Did the agent properly disengage disruptive/prank caller",
       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="bluebenefits"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "QA Score",
      "Did the rep greet the customer promptly and properly?",
      "Did the rep use a pleasant respectful tone?",
      "Did the rep correctly verify the callers info prior to proceeding with the call? ",
      "Did the rep offer a willingness statement? I d be happy to help you with that etc",
      "Did the rep display a professional manner and refrain from speaking over or interrupting the caller?",

      "Did the rep have any incomplete provider info?",
      "Did the rep incorrectly quote any benefits? ",
      "Did the rep incorrectly quote any copay or coinsurance? Or did they miss the coinsurance copay?",
      "Did the rep incorrectly give CR RC MAB RAA CY or PY?",
      "Did the rep incorrectly quote the deductible?",
      "Did the rep give any other incorrect information or miss any of the following regarding plan Effective Date Frequency Limitation Network OOP Max Precert Pre-X Term Date",
      "Did the rep provide the correct Claims Address when necessary?",
      "Did the rep include all information necessary regarding Medical Necessity?",
      "Did the rep include all details correctly regarding DME coverage when necessary?",


      "Did the agent speak clearly concisely and at an appropriate pace?",
      "Did the agent avoid use of internal terms technical terms slang and jargon on the call and in email?",
      "Did the agent demonstrate a strong use of empathy in responses where required on the call and in email?",
      "Did the agent use please and thank you throughout the call and in email communication?",
      "Did the agent minimize extended silences throughout the call?",
      "Did the agent speak with sincere warmth in his her voice?",
      "Did the agent use correct sentence structure and grammar in email commumnication?",
      "Did the agent demonstrate patience with the caller on call and in email communication?",

      "Did the rep accurately and completely document the call?",
      "Did the rep complete the correct confirmation and closing?",
      "Did the rep thank the caller before closing?",
      "Did the rep do everything possible to assist the caller?",
      "Did the rep anticipate the callers needs?to avoid unecessary callbacks or confusion",


       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Comment 20",
       "Comment 21",
       "Comment 22",
       "Comment 23",
       "Comment 24",
       "Comment 25",
       "Comment 26",
       "Comment 27",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="healthbridge"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "QA Score",

      "Correct Information provided regarding account details, benefit, information, plan, etc",
      "Resolved all member concerns or questions.",
      "Added detailed notes to the member account. ",
      "Disposition the call appropriately.",
      

      "Verified the member's name, last 4 SS#, DOB, and zipcode. ",
      "Used the verification button. ",
      "Followed all company procedures, guidelines, and policies.",
      "Informed the member of call recording (OUTBOUND ONLY)",

      "Proper Greeting and Closing was used including name, company, and name. ",
      "Clear communication, active listening, call control, and efficiency was demonstrated throughout the call. ",
      "Proper expectations were set, empathetic, pleasant voice tone, and positive attitude during the call. ",
      "Avoided industry jargon, excessive hold time, dead air, slang, interruptions, or self talk.",
      "Verified current address, preffered phone number and email address. ",


      "If applicable, requested payment from member and other family members.",
      "If applicable, the member has outstanding balance after payment, ask if they would like us to set up a recurring payment.",
      "Did agent present the authorize payment ask before processing",
      "Did agent offer confirmation number",

      "Adhered to HIPAA regulations throughout the entire call.",
      "Used inappropriate tone and language with the member",
      "Did agent repeat card numbers back. ",
      "Call Avoidance",


       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Comment 20",
       "Comment 21",
       "Comment 22",
       "Comment 23",
      
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($pid=='fortunebuilder'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['callans5sec'].'",';
				$row .= '"'.$user['agentintro'].'",';
				$row .= '"'.$user['agentadvise'].'",';
				$row .= '"'.$user['agentgreeting'].'",';
				$row .= '"'.$user['agentzip'].'",';
				$row .= '"'.$user['verifycaller'].'",';
				$row .= '"'.$user['calleremail'].'",';
				$row .= '"'.$user['agentseminar'].'",';
				$row .= '"'.$user['agentphone'].'",';
				$row .= '"'.$user['callerreminder'].'",';
				$row .= '"'.$user['agentsummerize'].'",';
				$row .= '"'.$user['registerguest'].'",';
				$row .= '"'.$user['verifyguest'].'",';
				$row .= '"'.$user['agentdemonstrate'].'",';
				$row .= '"'.$user['appropiategrammer'].'",';
				$row .= '"'.$user['goodpacing'].'",';
				$row .= '"'.$user['agentdisplay'].'",';
				$row .= '"'.$user['callcontrol'].'",';
				$row .= '"'.$user['agentclosing'].'",';
				$row .= '"'.$user['correctdisposition'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='xyz'){
			echo "User";
			foreach($rr as $user){
			$row = '"'.$user['phone1'].'",';
				$row .= '"'.$user['name'].'",';
				$row .= '"'.$user['email'].'",';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='purity_free_bottle'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_type_lob'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['customer_prompt'].'",';
				$row .= '"'.$user['soft_skills'].'",';
				$row .= '"'.$user['customer_information'].'",';
				$row .= '"'.$user['super_saver_offer'].'",';
				$row .= '"'.$user['upsell'].'",';
				$row .= '"'.$user['payment_procedure'].'",';
				$row .= '"'.$user['knowledge_of_product'].'",';
				$row .= '"'.$user['call_control'].'",';
				$row .= '"'.$user['faq'].'",';
				$row .= '"'.$user['objection_response'].'",';
				$row .= '"'.$user['personalize_the_call'].'",';
				$row .= '"'.$user['correct_confirmation'].'",';
				$row .= '"'.$user['cost_of_delivery'].'",';
				$row .= '"'.$user['misrepresentation'].'",';
				$row .= '"'.$user['dnc_response'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='purity_catalog'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['proper_greeting'].'",';
				$row .= '"'.$user['customer_first_name_address_verification'].'",';
				$row .= '"'.$user['identified_type_of_account'].'",';
				$row .= '"'.$user['properly_transfer_account'].'",';
				$row .= '"'.$user['accurate_note_taken'].'",';
				$row .= '"'.$user['correct_information_given'].'",';
				$row .= '"'.$user['proper_terminology'].'",';
				$row .= '"'.$user['free_gift_scripting'].'",';
				$row .= '"'.$user['bulk_offer'].'",';
				$row .= '"'.$user['super_saver_offer_explained_correctly'].'",';
				$row .= '"'.$user['additional_product_offered'].'",';
				$row .= '"'.$user['order_placed_properly'].'",';
				$row .= '"'.$user['order_confirmation'].'",';
				$row .= '"'.$user['user_tool_faq'].'",';
				$row .= '"'.$user['address_verification_at_confirmation'].'",';
				$row .= '"'.$user['credit_card_verification'].'",';
				$row .= '"'.$user['attemp_to_gather_cvv_code'].'",';
				$row .= '"'.$user['daily_special_offer'].'",';
				$row .= '"'.$user['product_offered_with_daily_special'].'",';
				$row .= '"'.$user['thank_you_statement'].'",';
				$row .= '"'.$user['maintained_call_control'].'",';
				$row .= '"'.$user['response_time'].'",';
				$row .= '"'.$user['used_proper_hold_techniques'].'",';
				$row .= '"'.$user['good_attitude'].'",';
				$row .= '"'.$user['energy_attentiveness'].'",';
				$row .= '"'.$user['context_related_response'].'",';
				$row .= '"'.$user['empathy_respectfulness'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='ab_commercial'){
		foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['correct_subject'].'",';
				$row .= '"'.$user['correct_signature'].'",';
				$row .= '"'.$user['subjectivities'].'",';
				$row .= '"'.$user['coverage_changes'].'",';
				$row .= '"'.$user['correct_invoice'].'",';
				$row .= '"'.$user['quote_included'].'",';
				$row .= '"'.$user['correct_edits_made'].'",';
				$row .= '"'.$user['application_forms'].'",';
				$row .= '"'.$user['de_suspense_sent'].'",';
				$row .= '"'.$user['prem_increase_suspense'].'",';
				$row .= '"'.$user['coverage_change'].'",';
				$row .= '"'.$user['suspense_status'].'",';
				$row .= '"'.$user['renewal_sheet'].'",';
				$row .= '"'.$user['correct_activity'].'",';
				$row .= '"'.$user['correct_requirements'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='purity_care'){
			foreach($rr as $user){
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_one_call_duration'].'",';
				$row .= '"'.$user['call_one_file_no'].'",';
				$row .= '"'.$user['call_two_call_duration'].'",';
				$row .= '"'.$user['call_two_file_no'].'",';
				//$row .= '"'.$user['call_two_voc'].'",';
				$row .= '"'.$user['call_three_call_duration'].'",';
				$row .= '"'.$user['call_three_file_no'].'",';
				//$row .= '"'.$user['call_three_voc'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_one_proper_introduction'].'",';
				$row .= '"'.$user['call_two_proper_introduction'].'",';
				$row .= '"'.$user['call_three_proper_introduction'].'",';
				$row .= '"'.$user['review_proper_introduction'].'",';
				$row .= '"'.$user['score_proper_introduction'].'",';
				$row .= '"'.$user['call_one_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['call_two_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['call_three_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['review_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['score_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['call_one_opening_question'].'",';
				$row .= '"'.$user['call_two_opening_question'].'",';
				$row .= '"'.$user['call_three_opening_question'].'",';
				$row .= '"'.$user['review_opening_question'].'",';
				$row .= '"'.$user['score_opening_question'].'",';
				$row .= '"'.$user['call_one_accurate_note'].'",';
				$row .= '"'.$user['call_two_accurate_note'].'",';
				$row .= '"'.$user['call_three_accurate_note'].'",';
				$row .= '"'.$user['review_accurate_note'].'",';
				$row .= '"'.$user['score_accurate_note'].'",';
				$row .= '"'.$user['call_one_correct_reason'].'",';
				$row .= '"'.$user['call_two_correct_reason'].'",';
				$row .= '"'.$user['call_three_correct_reason'].'",';
				$row .= '"'.$user['review_correct_reason'].'",';
				$row .= '"'.$user['score_correct_reason'].'",';
				$row .= '"'.$user['call_one_correct_information_given'].'",';
				$row .= '"'.$user['call_two_correct_information_given'].'",';
				$row .= '"'.$user['call_three_correct_information_given'].'",';
				$row .= '"'.$user['review_correct_information_given'].'",';
				$row .= '"'.$user['score_correct_information_given'].'",';
				$row .= '"'.$user['call_one_proper_terminology'].'",';
				$row .= '"'.$user['call_two_proper_terminology'].'",';
				$row .= '"'.$user['call_three_proper_terminology'].'",';
				$row .= '"'.$user['review_proper_terminology'].'",';
				$row .= '"'.$user['score_proper_terminology'].'",';
				$row .= '"'.$user['call_one_proper_inquiry'].'",';
				$row .= '"'.$user['call_two_proper_inquiry'].'",';
				$row .= '"'.$user['call_three_proper_inquiry'].'",';
				$row .= '"'.$user['review_proper_inquiry'].'",';
				$row .= '"'.$user['score_company_promotion'].'",';
				$row .= '"'.$user['call_one_company_promotion'].'",';
				$row .= '"'.$user['call_two_company_promotion'].'",';
				$row .= '"'.$user['call_three_company_promotion'].'",';
				$row .= '"'.$user['review_company_promotion'].'",';
				$row .= '"'.$user['score_company_promotion'].'",';
				$row .= '"'.$user['call_one_correct_use_of_action'].'",';
				$row .= '"'.$user['call_two_correct_use_of_action'].'",';
				$row .= '"'.$user['call_three_correct_use_of_action'].'",';
				$row .= '"'.$user['review_correct_use_of_action'].'",';
				$row .= '"'.$user['score_correct_use_of_action'].'",';
				$row .= '"'.$user['call_one_database_follow_up'].'",';
				$row .= '"'.$user['call_two_database_follow_up'].'",';
				$row .= '"'.$user['call_three_database_follow_up'].'",';
				$row .= '"'.$user['review_database_follow_up'].'",';
				$row .= '"'.$user['score_database_follow_up'].'",';
				$row .= '"'.$user['call_one_product_promotion'].'",';
				$row .= '"'.$user['call_two_product_promotion'].'",';
				$row .= '"'.$user['call_three_product_promotion'].'",';
				$row .= '"'.$user['review_product_promotion'].'",';
				$row .= '"'.$user['score_product_promotion'].'",';
				$row .= '"'.$user['call_one_reason_for_cancel'].'",';
				$row .= '"'.$user['call_two_reason_for_cancel'].'",';
				$row .= '"'.$user['call_three_reason_for_cancel'].'",';
				$row .= '"'.$user['review_reason_for_cancel'].'",';
				$row .= '"'.$user['score_reason_for_cancel'].'",';
				$row .= '"'.$user['call_one_legimate_sequence_offer'].'",';
				$row .= '"'.$user['call_two_legimate_sequence_offer'].'",';
				$row .= '"'.$user['call_three_legimate_sequence_offer'].'",';
				$row .= '"'.$user['review_legimate_sequence_offer'].'",';
				$row .= '"'.$user['score_legimate_sequence_offer'].'",';
				$row .= '"'.$user['call_one_first_retention_offer'].'",';
				$row .= '"'.$user['call_two_first_retention_offer'].'",';
				$row .= '"'.$user['call_three_first_retention_offer'].'",';
				$row .= '"'.$user['review_first_retention_offer'].'",';
				$row .= '"'.$user['score_first_retention_offer'].'",';
				$row .= '"'.$user['call_one_second_retention_offer'].'",';
				$row .= '"'.$user['call_two_second_retention_offer'].'",';
				$row .= '"'.$user['call_three_second_retention_offer'].'",';
				$row .= '"'.$user['review_second_retention_offer'].'",';
				$row .= '"'.$user['score_second_retention_offer'].'",';
				$row .= '"'.$user['call_one_valid_delay'].'",';
				$row .= '"'.$user['call_two_valid_delay'].'",';
				$row .= '"'.$user['call_three_valid_delay'].'",';
				$row .= '"'.$user['review_valid_delay'].'",';
				$row .= '"'.$user['score_valid_delay'].'",';
				$row .= '"'.$user['call_one_preserved_avg_unit'].'",';
				$row .= '"'.$user['call_two_preserved_avg_unit'].'",';
				$row .= '"'.$user['call_three_preserved_avg_unit'].'",';
				$row .= '"'.$user['review_preserved_avg_unit'].'",';
				$row .= '"'.$user['score_preserved_avg_unit'].'",';
				$row .= '"'.$user['call_one_proper_confirmation'].'",';
				$row .= '"'.$user['call_two_proper_confirmation'].'",';
				$row .= '"'.$user['call_three_proper_confirmation'].'",';
				$row .= '"'.$user['review_proper_confirmation'].'",';
				$row .= '"'.$user['score_proper_confirmation'].'",';
				$row .= '"'.$user['call_one_daily_special_offer'].'",';
				$row .= '"'.$user['call_two_daily_special_offer'].'",';
				$row .= '"'.$user['call_three_daily_special_offer'].'",';
				$row .= '"'.$user['review_daily_special_offer'].'",';
				$row .= '"'.$user['score_daily_special_offer'].'",';
				$row .= '"'.$user['call_one_anything_else'].'",';
				$row .= '"'.$user['call_two_anything_else'].'",';
				$row .= '"'.$user['call_three_anything_else'].'",';
				$row .= '"'.$user['review_anything_else'].'",';
				$row .= '"'.$user['score_anything_else'].'",';
				$row .= '"'.$user['call_one_thank_you'].'",';
				$row .= '"'.$user['call_two_thank_you'].'",';
				$row .= '"'.$user['call_three_thank_you'].'",';
				$row .= '"'.$user['review_thank_you'].'",';
				$row .= '"'.$user['score_thank_you'].'",';
				$row .= '"'.$user['call_one_mantained_call'].'",';
				$row .= '"'.$user['call_two_mantained_call'].'",';
				$row .= '"'.$user['call_three_mantained_call'].'",';
				$row .= '"'.$user['review_mantained_call'].'",';
				$row .= '"'.$user['score_mantained_call'].'",';
				$row .= '"'.$user['call_one_response_time'].'",';
				$row .= '"'.$user['call_two_response_time'].'",';
				$row .= '"'.$user['call_three_response_time'].'",';
				$row .= '"'.$user['review_response_time'].'",';
				$row .= '"'.$user['score_response_time'].'",';
				$row .= '"'.$user['call_one_proper_hold_technique'].'",';
				$row .= '"'.$user['call_two_proper_hold_technique'].'",';
				$row .= '"'.$user['call_three_proper_hold_technique'].'",';
				$row .= '"'.$user['review_proper_hold_technique'].'",';
				$row .= '"'.$user['score_proper_hold_technique'].'",';
				$row .= '"'.$user['call_one_good_attitude'].'",';
				$row .= '"'.$user['call_two_good_attitude'].'",';
				$row .= '"'.$user['call_three_good_attitude'].'",';
				$row .= '"'.$user['review_good_attitude'].'",';
				$row .= '"'.$user['score_good_attitude'].'",';
				$row .= '"'.$user['call_one_attentiveness'].'",';
				$row .= '"'.$user['call_two_attentiveness'].'",';
				$row .= '"'.$user['call_three_attentiveness'].'",';
				$row .= '"'.$user['review_attentiveness'].'",';
				$row .= '"'.$user['score_attentiveness'].'",';
				$row .= '"'.$user['call_one_context_related_response'].'",';
				$row .= '"'.$user['call_two_context_related_response'].'",';
				$row .= '"'.$user['call_three_context_related_response'].'",';
				$row .= '"'.$user['review_context_related_response'].'",';
				$row .= '"'.$user['score_context_related_response'].'",';
				$row .= '"'.$user['call_one_empathy'].'",';
				$row .= '"'.$user['call_two_empathy'].'",';
				$row .= '"'.$user['call_three_empathy'].'",';
				$row .= '"'.$user['review_empathy'].'",';
				$row .= '"'.$user['score_empathy'].'",';
				$row .= '"'.$user['call_one_badgering'].'",';
				$row .= '"'.$user['call_two_badgering'].'",';
				$row .= '"'.$user['call_three_badgering'].'",';
				$row .= '"'.$user['review_badgering'].'",';
				$row .= '"'.$user['score_badgering'].'",';
				$row .= '"'.$user['call_one_avg_call'].'",';
				$row .= '"'.$user['call_two_avg_call'].'",';
				$row .= '"'.$user['call_three_avg_call'].'",';
				$row .= '"'.$user['review_avg_call'].'",';
				$row .= '"'.$user['score_avg_call'].'",';
				$row .= '"'.$user['call_one_avg_save'].'",';
				$row .= '"'.$user['call_two_avg_save'].'",';
				$row .= '"'.$user['call_three_avg_save'].'",';
				$row .= '"'.$user['review_avg_save'].'",';
				$row .= '"'.$user['score_avg_save'].'",';
				$row .= '"'.$user['call_one_avg_call_length'].'",';
				$row .= '"'.$user['call_two_avg_call_length'].'",';
				$row .= '"'.$user['call_three_avg_call_length'].'",';
				$row .= '"'.$user['review_avg_call_length'].'",';
				$row .= '"'.$user['score_avg_call_length'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='puritycare_new'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['call_date1'].'",';
				$row .= '"'.$user['call_date2'].'",';
				$row .= '"'.$user['call_date3'].'",';
				$row .= '"'.$user['call_date4'].'",';
				$row .= '"'.$user['call_date5'].'",';
				$row .= '"'.$user['file_no1'].'",';
				$row .= '"'.$user['file_no2'].'",';
				$row .= '"'.$user['file_no3'].'",';
				$row .= '"'.$user['file_no4'].'",';
				$row .= '"'.$user['file_no5'].'",';
				$row .= '"'.$user['call_duration1'].'",';
				$row .= '"'.$user['call_duration2'].'",';
				$row .= '"'.$user['call_duration3'].'",';
				$row .= '"'.$user['call_duration4'].'",';
				$row .= '"'.$user['call_duration5'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['voc1'].'",';
				$row .= '"'.$user['voc2'].'",';
				$row .= '"'.$user['voc3'].'",';
				$row .= '"'.$user['voc4'].'",';
				$row .= '"'.$user['voc5'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_identification_call1'].'",';
				$row .= '"'.$user['agent_identification_call2'].'",';
				$row .= '"'.$user['agent_identification_call3'].'",';
				$row .= '"'.$user['agent_identification_call4'].'",';
				$row .= '"'.$user['agent_identification_call5'].'",';
				$row .= '"'.$user['customer_identification_call1'].'",';
				$row .= '"'.$user['customer_identification_call2'].'",';
				$row .= '"'.$user['customer_identification_call3'].'",';
				$row .= '"'.$user['customer_identification_call4'].'",';
				$row .= '"'.$user['customer_identification_call5'].'",';
				$row .= '"'.$user['customer_verification_call1'].'",';
				$row .= '"'.$user['customer_verification_call2'].'",';
				$row .= '"'.$user['customer_verification_call3'].'",';
				$row .= '"'.$user['customer_verification_call4'].'",';
				$row .= '"'.$user['customer_verification_call5'].'",';
				$row .= '"'.$user['opening_question_call1'].'",';
				$row .= '"'.$user['opening_question_call2'].'",';
				$row .= '"'.$user['opening_question_call3'].'",';
				$row .= '"'.$user['opening_question_call4'].'",';
				$row .= '"'.$user['opening_question_call5'].'",';
				$row .= '"'.$user['identify_reason_call1'].'",';
				$row .= '"'.$user['identify_reason_call2'].'",';
				$row .= '"'.$user['identify_reason_call3'].'",';
				$row .= '"'.$user['identify_reason_call4'].'",';
				$row .= '"'.$user['identify_reason_call5'].'",';
				$row .= '"'.$user['acknowledge_responce_call1'].'",';
				$row .= '"'.$user['acknowledge_responce_call2'].'",';
				$row .= '"'.$user['acknowledge_responce_call3'].'",';
				$row .= '"'.$user['acknowledge_responce_call4'].'",';
				$row .= '"'.$user['acknowledge_responce_call5'].'",';
				$row .= '"'.$user['inquiry_probing_call1'].'",';
				$row .= '"'.$user['inquiry_probing_call2'].'",';
				$row .= '"'.$user['inquiry_probing_call3'].'",';
				$row .= '"'.$user['inquiry_probing_call4'].'",';
				$row .= '"'.$user['inquiry_probing_call5'].'",';
				$row .= '"'.$user['value_proposition_call1'].'",';
				$row .= '"'.$user['value_proposition_call2'].'",';
				$row .= '"'.$user['value_proposition_call3'].'",';
				$row .= '"'.$user['value_proposition_call4'].'",';
				$row .= '"'.$user['value_proposition_call5'].'",';
				$row .= '"'.$user['1st_retention_call1'].'",';
				$row .= '"'.$user['1st_retention_call2'].'",';
				$row .= '"'.$user['1st_retention_call3'].'",';
				$row .= '"'.$user['1st_retention_call4'].'",';
				$row .= '"'.$user['1st_retention_call5'].'",';
				$row .= '"'.$user['tactical_hold_call1'].'",';
				$row .= '"'.$user['tactical_hold_call2'].'",';
				$row .= '"'.$user['tactical_hold_call3'].'",';
				$row .= '"'.$user['tactical_hold_call4'].'",';
				$row .= '"'.$user['tactical_hold_call5'].'",';
				$row .= '"'.$user['2nd_retention_call1'].'",';
				$row .= '"'.$user['2nd_retention_call2'].'",';
				$row .= '"'.$user['2nd_retention_call3'].'",';
				$row .= '"'.$user['2nd_retention_call4'].'",';
				$row .= '"'.$user['2nd_retention_call5'].'",';
				$row .= '"'.$user['delay_length_call1'].'",';
				$row .= '"'.$user['delay_length_call2'].'",';
				$row .= '"'.$user['delay_length_call3'].'",';
				$row .= '"'.$user['delay_length_call4'].'",';
				$row .= '"'.$user['delay_length_call5'].'",';
				$row .= '"'.$user['supersaver_call1'].'",';
				$row .= '"'.$user['supersaver_call2'].'",';
				$row .= '"'.$user['supersaver_call3'].'",';
				$row .= '"'.$user['supersaver_call4'].'",';
				$row .= '"'.$user['supersaver_call5'].'",';
				$row .= '"'.$user['daily_special_call1'].'",';
				$row .= '"'.$user['daily_special_call2'].'",';
				$row .= '"'.$user['daily_special_call3'].'",';
				$row .= '"'.$user['daily_special_call4'].'",';
				$row .= '"'.$user['daily_special_call5'].'",';
				$row .= '"'.$user['closing_statement_call1'].'",';
				$row .= '"'.$user['closing_statement_call2'].'",';
				$row .= '"'.$user['closing_statement_call3'].'",';
				$row .= '"'.$user['closing_statement_call4'].'",';
				$row .= '"'.$user['closing_statement_call5'].'",';
				$row .= '"'.$user['full_conf_call1'].'",';
				$row .= '"'.$user['full_conf_call2'].'",';
				$row .= '"'.$user['full_conf_call3'].'",';
				$row .= '"'.$user['full_conf_call4'].'",';
				$row .= '"'.$user['full_conf_call5'].'",';
				$row .= '"'.$user['made_offer_call1'].'",';
				$row .= '"'.$user['made_offer_call2'].'",';
				$row .= '"'.$user['made_offer_call3'].'",';
				$row .= '"'.$user['made_offer_call4'].'",';
				$row .= '"'.$user['made_offer_call5'].'",';
				$row .= '"'.$user['web_login_call1'].'",';
				$row .= '"'.$user['web_login_call2'].'",';
				$row .= '"'.$user['web_login_call3'].'",';
				$row .= '"'.$user['web_login_call4'].'",';
				$row .= '"'.$user['web_login_call5'].'",';
				$row .= '"'.$user['email_capture_call1'].'",';
				$row .= '"'.$user['email_capture_call2'].'",';
				$row .= '"'.$user['email_capture_call3'].'",';
				$row .= '"'.$user['email_capture_call4'].'",';
				$row .= '"'.$user['email_capture_call5'].'",';
				$row .= '"'.$user['sms_opt_call1'].'",';
				$row .= '"'.$user['sms_opt_call2'].'",';
				$row .= '"'.$user['sms_opt_call3'].'",';
				$row .= '"'.$user['sms_opt_call4'].'",';
				$row .= '"'.$user['sms_opt_call5'].'",';
				$row .= '"'.$user['reason_code_call1'].'",';
				$row .= '"'.$user['reason_code_call2'].'",';
				$row .= '"'.$user['reason_code_call3'].'",';
				$row .= '"'.$user['reason_code_call4'].'",';
				$row .= '"'.$user['reason_code_call5'].'",';
				$row .= '"'.$user['used_purity_call1'].'",';
				$row .= '"'.$user['used_purity_call2'].'",';
				$row .= '"'.$user['used_purity_call3'].'",';
				$row .= '"'.$user['used_purity_call4'].'",';
				$row .= '"'.$user['used_purity_call5'].'",';
				$row .= '"'.$user['information_accuracy_call1'].'",';
				$row .= '"'.$user['information_accuracy_call2'].'",';
				$row .= '"'.$user['information_accuracy_call3'].'",';
				$row .= '"'.$user['information_accuracy_call4'].'",';
				$row .= '"'.$user['information_accuracy_call5'].'",';
				$row .= '"'.$user['soft_skill_call1'].'",';
				$row .= '"'.$user['soft_skill_call2'].'",';
				$row .= '"'.$user['soft_skill_call3'].'",';
				$row .= '"'.$user['soft_skill_call4'].'",';
				$row .= '"'.$user['soft_skill_call5'].'",';
				$row .= '"'.$user['rapport_call1'].'",';
				$row .= '"'.$user['rapport_call2'].'",';
				$row .= '"'.$user['rapport_call3'].'",';
				$row .= '"'.$user['rapport_call4'].'",';
				$row .= '"'.$user['rapport_call5'].'",';
				$row .= '"'.$user['call_control_call1'].'",';
				$row .= '"'.$user['call_control_call2'].'",';
				$row .= '"'.$user['call_control_call3'].'",';
				$row .= '"'.$user['call_control_call4'].'",';
				$row .= '"'.$user['call_control_call5'].'",';
				$row .= '"'.$user['unauthorized_shipment_call1'].'",';
				$row .= '"'.$user['unauthorized_shipment_call2'].'",';
				$row .= '"'.$user['unauthorized_shipment_call3'].'",';
				$row .= '"'.$user['unauthorized_shipment_call4'].'",';
				$row .= '"'.$user['unauthorized_shipment_call5'].'",';
				$row .= '"'.$user['inappropiate_language_call1'].'",';
				$row .= '"'.$user['inappropiate_language_call2'].'",';
				$row .= '"'.$user['inappropiate_language_call3'].'",';
				$row .= '"'.$user['inappropiate_language_call4'].'",';
				$row .= '"'.$user['inappropiate_language_call5'].'",';
				/*$row .= '"'.$user['hanging_up_call1'].'",';
				$row .= '"'.$user['hanging_up_call2'].'",';
				$row .= '"'.$user['hanging_up_call3'].'",';
				$row .= '"'.$user['hanging_up_call4'].'",';
				$row .= '"'.$user['hanging_up_call5'].'",'; */
				$row .= '"'.$user['badgering_call1'].'",';
				$row .= '"'.$user['badgering_call2'].'",';
				$row .= '"'.$user['badgering_call3'].'",';
				$row .= '"'.$user['badgering_call4'].'",';
				$row .= '"'.$user['badgering_call5'].'",';
				$row .= '"'.$user['action_autofail_call1'].'",';
				$row .= '"'.$user['action_autofail_call2'].'",';
				$row .= '"'.$user['action_autofail_call3'].'",';
				$row .= '"'.$user['action_autofail_call4'].'",';
				$row .= '"'.$user['action_autofail_call5'].'",';
				$row .= '"'.$user['health_claim_call1'].'",';
				$row .= '"'.$user['health_claim_call2'].'",';
				$row .= '"'.$user['health_claim_call3'].'",';
				$row .= '"'.$user['health_claim_call4'].'",';
				$row .= '"'.$user['health_claim_call5'].'",';
				$row .= '"'.$user['no_confirmation1'].'",';
				$row .= '"'.$user['no_confirmation2'].'",';
				$row .= '"'.$user['no_confirmation3'].'",';
				$row .= '"'.$user['no_confirmation4'].'",';
				$row .= '"'.$user['no_confirmation5'].'",';
				$row .= '"'.$user['no_retention1'].'",';
				$row .= '"'.$user['no_retention2'].'",';
				$row .= '"'.$user['no_retention3'].'",';
				$row .= '"'.$user['no_retention4'].'",';
				$row .= '"'.$user['no_retention5'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary5'])).'",';
				$row .= '"'.$user['agent_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='touchfuse'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_status'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['callasnwer'].'",';
				$row .= '"'.$user['agentanswer'].'",';
				$row .= '"'.$user['agentzip'].'",';
				$row .= '"'.$user['agentoffer'].'",';
				$row .= '"'.$user['callerwish'].'",';
				$row .= '"'.$user['agentconfirm'].'",';
				$row .= '"'.$user['calleraddress'].'",';
				$row .= '"'.$user['calleremail'].'",';
				$row .= '"'.$user['agentphone'].'",';
				$row .= '"'.$user['agentsummerize'].'",';
				$row .= '"'.$user['registerguest'].'",';
				$row .= '"'.$user['dispocall'].'",';
				$row .= '"'.$user['agentclosing'].'",';
				$row .= '"'.$user['agenttone'].'",';
				$row .= '"'.$user['activelistening'].'",';
				$row .= '"'.$user['agentprofession'].'",';
				$row .= '"'.$user['agentknowledge'].'",';
				$row .= '"'.$user['callcontrol'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='tbn'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['introrecord'].'",';
				$row .= '"'.$user['introcall'].'",';
				$row .= '"'.$user['introname'].'",';
				$row .= '"'.$user['introstate'].'",';
				$row .= '"'.$user['introscript'].'",';
				$row .= '"'.$user['introdisclose'].'",';
				$row .= '"'.$user['verifydonor'].'",';
				$row .= '"'.$user['verifyaddress'].'",';
				$row .= '"'.$user['verifyspelled'].'",';
				$row .= '"'.$user['verifyemail'].'",';
				$row .= '"'.$user['verifyback'].'",';
				$row .= '"'.$user['verifyasked'].'",';
				$row .= '"'.$user['verifyconfirm'].'",';
				$row .= '"'.$user['verifytype'].'",';
				$row .= '"'.$user['verifycell'].'",';
				$row .= '"'.$user['verifyaskalterphn'].'",';
				$row .= '"'.$user['verifyalterphn'].'",';
				$row .= '"'.$user['verifyalterno'].'",';
				$row .= '"'.$user['verifyconsent'].'",';
				$row .= '"'.$user['presentrequest'].'",';
				$row .= '"'.$user['presenttieroffer'].'",';
				$row .= '"'.$user['presentmonthask'].'",';
				$row .= '"'.$user['presentnavigate'].'",';
				$row .= '"'.$user['presenttbnknowledge'].'",';
				$row .= '"'.$user['presentauthor'].'",';
				$row .= '"'.$user['presentadherence'].'",';
				$row .= '"'.$user['cartclosedonation'].'",';
				$row .= '"'.$user['cartcloseamount'].'",';
				$row .= '"'.$user['cartclosemonthly'].'",';
				$row .= '"'.$user['cartcloseresource'].'",';
				$row .= '"'.$user['cartclosescript'].'",';
				$row .= '"'.$user['callhandleclearly'].'",';
				$row .= '"'.$user['callhandledemeanor'].'",';
				$row .= '"'.$user['callhandlepace'].'",';
				$row .= '"'.$user['callhandlelisten'].'",';
				$row .= '"'.$user['callhandleexhibit'].'",';
				$row .= '"'.$user['callhandlecommunicate'].'",';
				$row .= '"'.$user['callhandlecontrol'].'",';
				$row .= '"'.$user['autofinfo'].'",';
				$row .= '"'.$user['autofcall'].'",';
				$row .= '"'.$user['autofbehaviour'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='jfmi'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greets_customer_promptly'].'",';
				$row .= '"'.$user['uses_professionalism'].'",';
				$row .= '"'.$user['shows_gratitude'].'",';
				$row .= '"'.$user['collects_and_verifies_customer_information'].'",';
				$row .= '"'.$user['follows_correct_scripting_path'].'",';
				$row .= '"'.$user['collects_information_to_provide_to_partner_relations'].'",';
				$row .= '"'.$user['covers_all_payment_scripting'].'",';
				$row .= '"'.$user['maintains_call_control'].'",';
				$row .= '"'.$user['keeps_dead_air_to_minimum'].'",';
				$row .= '"'.$user['uses_faq_agent_note'].'",';
				$row .= '"'.$user['brands_the_call_with_proper_close'].'",';
				$row .= '"'.$user['stop_recording'].'",';
				$row .= '"'.$user['read_legal_script'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='hoveround'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentreadyforcall'].'",';
				$row .= '"'.$user['agentgiveintro'].'",';
				$row .= '"'.$user['agentcorrectprobe'].'",';
				$row .= '"'.$user['agentverifycustomer'].'",';
				$row .= '"'.$user['agentclosecall'].'",';
				$row .= '"'.$user['agentdisposition'].'",';
				$row .= '"'.$user['agentpolite'].'",';
				$row .= '"'.$user['agentshowenergy'].'",';
				$row .= '"'.$user['agenthavegoodtone'].'",';
				$row .= '"'.$user['agentgiveaccurateinfo'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='ncpssm'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['introcaller'].'",';
				$row .= '"'.$user['introopenning'].'",';
				$row .= '"'.$user['scriptgathered'].'",';
				$row .= '"'.$user['scriptemail'].'",';
				$row .= '"'.$user['scriptstatement'].'",';
				$row .= '"'.$user['scriptmedicareissue'].'",';
				$row .= '"'.$user['scriptpersonalizecall'].'",';
				$row .= '"'.$user['scriptcallersupport'].'",';
				$row .= '"'.$user['toneenthusiasm'].'",';
				$row .= '"'.$user['toneproperpace'].'",';
				$row .= '"'.$user['tonecontroldeadair'].'",';
				$row .= '"'.$user['tonespokeclearly'].'",';
				$row .= '"'.$user['tonegoodlistening'].'",';
				$row .= '"'.$user['toneempathized'].'",';
				$row .= '"'.$user['toneprofessionalism'].'",';
				$row .= '"'.$user['closecallconslusion'].'",';
				$row .= '"'.$user['closecorrectinfo'].'",';
				$row .= '"'.$user['closeconfirmcaller'].'",';
				$row .= '"'.$user['autofailinfo'].'",';
				$row .= '"'.$user['autofailhungup'].'",';
				$row .= '"'.$user['autofailbehaviour'].'",';
				$row .= '"'.$user['autofaillanguage'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='stc'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentproperintro'].'",';
				$row .= '"'.$user['agentcapturedonorname'].'",';
				$row .= '"'.$user['agentreadscript'].'",';
				$row .= '"'.$user['agentcovermonthlyrequest'].'",';
				$row .= '"'.$user['agentcapturedonationamount'].'",';
				$row .= '"'.$user['agentofferpayment'].'",';
				$row .= '"'.$user['agentcapturedonoraddress'].'",';
				$row .= '"'.$user['agentcapturedonorphone'].'",';
				$row .= '"'.$user['agentcapturedonoremail'].'",';
				$row .= '"'.$user['agentproperlyrebuttals'].'",';
				$row .= '"'.$user['agentfollowscript'].'",';
				$row .= '"'.$user['agentshowfamiliarity'].'",';
				$row .= '"'.$user['agentusescriptnavigation'].'",';
				$row .= '"'.$user['agentfollowproperclose'].'",';
				$row .= '"'.$user['agentuseeffectivecommunication'].'",';
				$row .= '"'.$user['agentmaintaincontrol'].'",';
				$row .= '"'.$user['agentshowappreciation'].'",';
				$row .= '"'.$user['autofailfalseinfo'].'",';
				$row .= '"'.$user['autofailhungup'].'",';
				$row .= '"'.$user['autofailagentbehaviuor'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='tpm'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['introcall'].'",';
				$row .= '"'.$user['verifycall'].'",';
				$row .= '"'.$user['verifypayment'].'",';
				$row .= '"'.$user['verifycommunicator'].'",';
				$row .= '"'.$user['verifyspelledname'].'",';
				$row .= '"'.$user['verifyaskedaddress'].'",';
				$row .= '"'.$user['verifyspelledaddress'].'",';
				$row .= '"'.$user['verifyaskedphone'].'",';
				$row .= '"'.$user['verifycommunicatorphone'].'",';
				$row .= '"'.$user['verifylandline'].'",';
				$row .= '"'.$user['verifycallverbatim'].'",';
				$row .= '"'.$user['verifytextverbatim'].'",';
				$row .= '"'.$user['verifyaskedemail'].'",';
				$row .= '"'.$user['verifyspelledemail'].'",';
				$row .= '"'.$user['scriptadherence'].'",';
				$row .= '"'.$user['scripthighertier'].'",';
				$row .= '"'.$user['scriptnavigate'].'",';
				$row .= '"'.$user['scriptdisplaytpm'].'",';
				$row .= '"'.$user['closedcontent'].'",';
				$row .= '"'.$user['closedmonthlyask'].'",';
				$row .= '"'.$user['closedshippingtime'].'",';
				$row .= '"'.$user['closedprovidecart'].'",';
				$row .= '"'.$user['closedreadscript'].'",';
				$row .= '"'.$user['callhandlespeakclearly'].'",';
				$row .= '"'.$user['callhandledemeanor'].'",';
				$row .= '"'.$user['callhandleprofesionalism'].'",';
				$row .= '"'.$user['callhandlepace'].'",';
				$row .= '"'.$user['callhandleresponds'].'",';
				$row .= '"'.$user['callhandleemphaty'].'",';
				$row .= '"'.$user['callhandledonor'].'",';
				$row .= '"'.$user['callhandletalktime'].'",';
				$row .= '"'.$user['autofinfo'].'",';
				$row .= '"'.$user['autofhungup'].'",';
				$row .= '"'.$user['autofrude'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='patchology'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentcallopening'].'",';
				$row .= '"'.$user['agentclosecall'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remarks1'])).'",';
				$row .= '"'.$user['agentverifyinformation'].'",';
				$row .= '"'.$user['agentprovideinformation'].'",';
				$row .= '"'.$user['agenthippinginformation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remarks2'])).'",';
				$row .= '"'.$user['callanswertimely'].'",';
				$row .= '"'.$user['agentengagedcustomer'].'",';
				$row .= '"'.$user['customersatisfaction'].'",';
				$row .= '"'.$user['escalatedresources'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remarks3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='aspca'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['Greet_customer'].'",';
				$row .= '"'.$user['Uses_professionalism'].'",';
				$row .= '"'.$user['Shows_gratitude'].'",';
				$row .= '"'.$user['Collects_verifies'].'",';
				$row .= '"'.$user['guardians_program'].'",';
				$row .= '"'.$user['monthly_guardian'].'",';
				$row .= '"'.$user['gift_scripting'].'",';
				$row .= '"'.$user['payment_scripting'].'",';
				$row .= '"'.$user['Animal_champion'].'",';
				$row .= '"'.$user['donation_processing'].'",';
				$row .= '"'.$user['onetime_donation'].'",';
				$row .= '"'.$user['pet_insurance'].'",';
				$row .= '"'.$user['correct_script'].'",';
				$row .= '"'.$user['call_control'].'",';
				$row .= '"'.$user['min_deadair'].'",';
				$row .= '"'.$user['faq'].'",';
				$row .= '"'.$user['personalizes_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='ffai'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['open_call_appropriate_branding'].'",';
				$row .= '"'.$user['close_call_appropriate_branding'].'",';
				$row .= '"'.$user['address_using_nato'].'",';
				$row .= '"'.$user['products_availability'].'",';
				$row .= '"'.$user['one_call_resolution'].'",';
				$row .= '"'.$user['agent_accurately_clearly'].'",';
				$row .= '"'.$user['agent_engaged_customer'].'",';
				$row .= '"'.$user['membership'].'",';
				$row .= '"'.$user['offer_donation'].'",';
				$row .= '"'.$user['was_cust_sat_fulfilled'].'",';
				$row .= '"'.$user['did_agent_offer_survey'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='lifi'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['life_quotes_greeting'].'",';
				$row .= '"'.$user['agent_positive_response'].'",';
				$row .= '"'.$user['customer_name_capture'].'",';
				$row .= '"'.$user['capture_address'].'",';
				$row .= '"'.$user['phone_number_confirmation'].'",';
				$row .= '"'.$user['email_Address'].'",';
				$row .= '"'.$user['customer_dob'].'",';
				$row .= '"'.$user['script_adherence'].'",';
				$row .= '"'.$user['coverage_amount_insurance'].'",';
				$row .= '"'.$user['tobacco_smoking'].'",';
				$row .= '"'.$user['height_weight_customer'].'",';
				$row .= '"'.$user['mention_price_comparison'].'",';
				$row .= '"'.$user['overall_confidence_level'].'",';
				$row .= '"'.$user['call_closing'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='heatsurge'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['callprepared5sec'].'",';
				$row .= '"'.$user['useibobgreeting'].'",';
				$row .= '"'.$user['accesscustomeraccount'].'",';
				$row .= '"'.$user['vreifynameaddress'].'",';
				$row .= '"'.$user['askforemail'].'",';
				$row .= '"'.$user['readminiMiranda'].'",';
				$row .= '"'.$user['giveaccuratepricing'].'",';
				$row .= '"'.$user['giveaccurateshiping'].'",';
				$row .= '"'.$user['accuratedescribeproduct'].'",';
				$row .= '"'.$user['askforupsellproduct'].'",';
				$row .= '"'.$user['provideappropiatesolution'].'",';
				$row .= '"'.$user['codedordercorrectly'].'",';
				$row .= '"'.$user['askforcancelarion'].'",';
				$row .= '"'.$user['usePKkeybuying'].'",';
				$row .= '"'.$user['useappropiateguideline'].'",';
				$row .= '"'.$user['askforbillingname'].'",';
				$row .= '"'.$user['authorizeuserofcheck'].'",';
				$row .= '"'.$user['billingaddressforpayment'].'",';
				$row .= '"'.$user['permissiontoauthorizepayment'].'",';
				$row .= '"'.$user['vrifyshippingaddress'].'",';
				$row .= '"'.$user['accountwithissue'].'",';
				$row .= '"'.$user['summarizesreviewcall'].'",';
				$row .= '"'.$user['gaveCSphonenumber'].'",';
				$row .= '"'.$user['wasagentpolite'].'",';
				$row .= '"'.$user['usinginappropiatecomment'].'",';
				$row .= '"'.$user['usesholdtrasferproperly'].'",';
				$row .= '"'.$user['automaticzero'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='stauers_sales'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_answered_5_seconds'].'",';
				$row .= '"'.$user['agent_verify_customer_name_address'].'",';
				$row .= '"'.$user['agent_capture_correct_offer'].'",';
				$row .= '"'.$user['agent_verify_phone_number'].'",';
				$row .= '"'.$user['agent_verify_customer_email'].'",';
				$row .= '"'.$user['agent_compliment_caller_purchase'].'",';
				$row .= '"'.$user['agent_recap_item'].'",';
				$row .= '"'.$user['agent_cover_one_upsell'].'",';
				$row .= '"'.$user['agent_cover_replacement'].'",';
				$row .= '"'.$user['agent_appropriate_rebuttal'].'",';
				$row .= '"'.$user['agent_cover_membership'].'",';
				$row .= '"'.$user['agent_appropriate_rebuttal_declined'].'",';
				$row .= '"'.$user['agent_offer_membership'].'",';
				$row .= '"'.$user['agent_cover_autorenew'].'",';
				$row .= '"'.$user['shipping_address_verified'].'",';
				$row .= '"'.$user['quote_correct_delivery_time'].'",';
				$row .= '"'.$user['agent_total_product_appropriately'].'",';
				$row .= '"'.$user['agent_quote_shipping_taxes'].'",';
				$row .= '"'.$user['agent_give_total_charged'].'",';
				$row .= '"'.$user['agent_provide_order_number'].'",';
				$row .= '"'.$user['agent_close_call_brand_correctly'].'",';
				$row .= '"'.$user['customer_satisfied_experience'].'",';
				$row .= '"'.$user['customer_dissatisfied_professionalism'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='operation_smile'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentreadytohandle'].'",';
				$row .= '"'.$user['agentgreetthecaller'].'",';
				$row .= '"'.$user['agentconfirminfo'].'",';
				$row .= '"'.$user['agentshowgraduate'].'",';
				$row .= '"'.$user['agentuserebuttals'].'",';
				$row .= '"'.$user['agentofferupsell'].'",';
				$row .= '"'.$user['agentfollowscript'].'",';
				$row .= '"'.$user['agentaddressquestion'].'",';
				$row .= '"'.$user['agentspeakenergy'].'",';
				$row .= '"'.$user['agentuseproperpacing'].'",';
				$row .= '"'.$user['agentmaintaincontrol'].'",';
				$row .= '"'.$user['agentprofessionalspeak'].'",';
				$row .= '"'.$user['agentgoodlistening'].'",';
				$row .= '"'.$user['agentempathize'].'",';
				$row .= '"'.$user['agentprovidedonor'].'",';
				$row .= '"'.$user['agnetaskprompted'].'",';
				$row .= '"'.$user['agentthankcaller'].'",';
				$row .= '"'.$user['agentgaveinformation'].'",';
				$row .= '"'.$user['agenthangup'].'",';
				$row .= '"'.$user['agentlaguage'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='5_11_tactical'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greetthecustomer'].'",';
				$row .= '"'.$user['customeritemtoorder'].'",';
				$row .= '"'.$user['wouldaddyourorder'].'",';
				$row .= '"'.$user['customerlogininformation'].'",';
				$row .= '"'.$user['callerinformationaccuracy'].'",';
				$row .= '"'.$user['coverfinalconfirmation'].'",';
				$row .= '"'.$user['givecustomerordernumber'].'",';
				$row .= '"'.$user['userapplicablesearch'].'",';
				$row .= '"'.$user['coverreturnprocess'].'",';
				$row .= '"'.$user['coverexchangeprocess'].'",';
				$row .= '"'.$user['coverrefundprocess'].'",';
				$row .= '"'.$user['trackthepackage'].'",';
				$row .= '"'.$user['agentaskforassist'].'",';
				$row .= '"'.$user['agentbrandthecall'].'",';
				$row .= '"'.$user['answerquestions'].'",';
				$row .= '"'.$user['maintaincallcontrol'].'",';
				$row .= '"'.$user['properlynotateAX'].'",';
				$row .= '"'.$user['escalationwaranted'].'",';
				$row .= '"'.$user['agentdispositioncall'].'",';
				$row .= '"'.$user['maintainprofessionalism'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='jmmi'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_appropriate_greeting'].'",';
				$row .= '"'.$user['agent_excellent_conversational_responses'].'",';
				$row .= '"'.$user['agent_verify_opening_information'].'",';
				$row .= '"'.$user['agent_follow_call_flow'].'",';
				$row .= '"'.$user['agent_appropriate_gratitude'].'",';
				$row .= '"'.$user['agent_share_upsells'].'",';
				$row .= '"'.$user['agent_show_familiarity_search'].'",';
				$row .= '"'.$user['agent_thank_caller_specifically'].'",';
				$row .= '"'.$user['agent_share_facts_appropriate'].'",';
				$row .= '"'.$user['agent_professional_communication'].'",';
				$row .= '"'.$user['agent_proper_enthusiasm'].'",';
				$row .= '"'.$user['agent_maintain_control_conversation'].'",';
				$row .= '"'.$user['agent_spoke_clearly'].'",';
				$row .= '"'.$user['agent_good_listening_skills_responses'].'",';
				$row .= '"'.$user['agent_empathize_caller_and_compassion'].'",';
				$row .= '"'.$user['agent_have_minimal_dead_air'].'",';
				$row .= '"'.$user['agent_have_caller_provide_address'].'",';
				$row .= '"'.$user['agent_confirm_dollar_amount'].'",';
				$row .= '"'.$user['agent_read_shipping_information'].'",';
				$row .= '"'.$user['agent_ask_caller_email_tv_information'].'",';
				$row .= '"'.$user['agent_proper_thanks'].'",';
				$row .= '"'.$user['agent_transfer_call_prayer_appropriate'].'",';
				$row .= '"'.$user['agent_follow_payment'].'",';
				$row .= '"'.$user['agent_read_back_customer_details_properly'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='non_profit'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['preparedtakecall'].'",';
				$row .= '"'.$user['paidcallerfromdonor'].'",';
				$row .= '"'.$user['communicatorstarted'].'",';
				$row .= '"'.$user['pronouncedclients'].'",';
				$row .= '"'.$user['gavewarmgreeting'].'",';
				$row .= '"'.$user['followedscript1stReq'].'",';
				$row .= '"'.$user['usedcorrectdollar'].'",';
				$row .= '"'.$user['assumptivegiftask'].'",';
				$row .= '"'.$user['shownempathy'].'",';
				$row .= '"'.$user['repeatedobjection'].'",';
				$row .= '"'.$user['personalizedobjection'].'",';
				$row .= '"'.$user['attemptedhandleobjection'].'",';
				$row .= '"'.$user['reinforcethenegative'].'",';
				$row .= '"'.$user['deadendcall'].'",';
				$row .= '"'.$user['followed2ndReq'].'",';
				$row .= '"'.$user['usedoller2ndReq'].'",';
				$row .= '"'.$user['assumptive2ndReq'].'",';
				$row .= '"'.$user['attempted3rdReq'].'",';
				$row .= '"'.$user['usedoller3rdReq'].'",';
				$row .= '"'.$user['assumptive3rdReq'].'",';
				$row .= '"'.$user['confirmationgiftamount'].'",';
				$row .= '"'.$user['assumedhigherdoller'].'",';
				$row .= '"'.$user['meaningfulgratitude'].'",';
				$row .= '"'.$user['readcreditcard'].'",';
				$row .= '"'.$user['confirmedfullname'].'",';
				$row .= '"'.$user['followedmaybeclose'].'",';
				$row .= '"'.$user['readclosescript'].'",';
				$row .= '"'.$user['endedcalltime'].'",';
				$row .= '"'.$user['soundedconversational'].'",';
				$row .= '"'.$user['useappropiatepace'].'",';
				$row .= '"'.$user['confidentpresentation'].'",';
				$row .= '"'.$user['didnotlosecontrol'].'",';
				$row .= '"'.$user['properpersonalization'].'",';
				$row .= '"'.$user['utilizedpropergrammer'].'",';
				$row .= '"'.$user['bailing'].'",';
				$row .= '"'.$user['askforcreditcard'].'",';
				$row .= '"'.$user['gavefalseinformation'].'",';
				$row .= '"'.$user['donorcarecenter'].'",';
				$row .= '"'.$user['askconfirmationquestion'].'",';
				$row .= '"'.$user['unsolidgift'].'",';
				$row .= '"'.$user['codingrefusal'].'",';
				$row .= '"'.$user['unprofessionalbehaviour'].'",';
				$row .= '"'.$user['improperpresentation'].'",';
				$row .= '"'.$user['omittedDNCcode'].'",';
				$row .= '"'.$user['falsificationgift'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='revel_new') {

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_greeted_the_member'].'",';
				$row .= '"'.$user['agent_properly_authenticated'].'",';
				$row .= '"'.$user['did_agent_attempt'].'",';
				$row .= '"'.$user['agent_gave_health'].'",';
				$row .= '"'.$user['agent_collected_health'].'",';
				$row .= '"'.$user['agent_gave_correct_gift'].'",';
				$row .= '"'.$user['agent_offered_to_provide'].'",';
				$row .= '"'.$user['agent_provided_online'].'",';
				$row .= '"'.$user['agent_used_correct'].'",';
				$row .= '"'.$user['agent_logged_call'].'",';
				$row .= '"'.$user['agent_followed_script'].'",';
				$row .= '"'.$user['agent_gave_correct'].'",';
				$row .= '"'.$user['agent_resolved_all'].'",';
				$row .= '"'.$user['agent_displayed_active'].'",';
				$row .= '"'.$user['agent_effectively_engaged'].'",';
				$row .= '"'.$user['agent_displayed_polite'].'",';
				$row .= '"'.$user['agent_sounded_confident'].'",';
				$row .= '"'.$user['agent_did_not_interrupt'].'",';
				$row .= '"'.$user['agent_used_pleasing'].'",';
				$row .= '"'.$user['agent_maintained_call'].'",';
				$row .= '"'.$user['agent_used_correct_grammer'].'",';
				$row .= '"'.$user['agent_offered_additional'].'",';
				$row .= '"'.$user['agent_used_correct_client'].'",';

				$row .= '"'.$user['agent_submitted_escalation'].'",';
				$row .= '"'.$user['agent_was_not_rude'].'",';
				$row .= '"'.$user['agent_used_the_correct'].'",';
				$row .= '"'.$user['agent_did_not_demonstrate'].'",';
				$row .= '"'.$user['properly_authenticated_member'].'",';

				$row .= '"'.$user['the_agent_received'].'",';
				$row .= '"'.$user['is_the_recording'].'",';
				$row .= '"'.$user['would_play_this'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';



				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		} else if($pid=='revel_old'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['csr_id'].'",';
				//$row .= '"'.$user['call_type'].'",';
				//$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['repgreetingcustomer'].'",';
				$row .= '"'.$user['repuserespectfultone'].'",';
				$row .= '"'.$user['repasnwertimelymanner'].'",';
				$row .= '"'.$user['repcollectcallerinformation'].'",';
				$row .= '"'.$user['repuselisteningskills'].'",';
				$row .= '"'.$user['repdemonstratecalltechnique'].'",';
				$row .= '"'.$user['repreframeinterruptcaller'].'",';
				$row .= '"'.$user['repspeakclearlyatpace'].'",';
				$row .= '"'.$user['repavoiduseofterms'].'",';
				$row .= '"'.$user['repconfidentinresponce'].'",';
				$row .= '"'.$user['repusercallerlastname'].'",';
				$row .= '"'.$user['repusefiltertoobtain'].'",';
				$row .= '"'.$user['repmaintaincallcontrol'].'",';
				$row .= '"'.$user['repusetoolappropiately'].'",';
				$row .= '"'.$user['repdemonstrateproductknowledge'].'",';
				$row .= '"'.$user['repuseappropiatescript'].'",';
				$row .= '"'.$user['repaccuratelycalldocument'].'",';
				$row .= '"'.$user['repcompletecorrectclosing'].'",';
				$row .= '"'.$user['repthankthecaller'].'",';
				$row .= '"'.$user['repgiveMedicaladvice'].'",';
				$row .= '"'.$user['agentMiscodeCall'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='qpc'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				//$row .= '"'.$user['csr_id'].'",';
				//$row .= '"'.$user['call_type'].'",';
				//$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['unpreparedCallIntroduce'].'",';
				$row .= '"'.$user['didnotUseBranding'].'",';
				$row .= '"'.$user['dataNotCollected'].'",';
				$row .= '"'.$user['secondDataOccurrence'].'",';
				$row .= '"'.$user['inaccurateCallResult'].'",';
				$row .= '"'.$user['unusableAfterCallComment'].'",';
				$row .= '"'.$user['underutilizedCallNarration'].'",';
				$row .= '"'.$user['inappropiateFAQResponce'].'",';
				$row .= '"'.$user['imprpperTransaction'].'",';
				$row .= '"'.$user['underAcknowledgeCaller'].'",';
				$row .= '"'.$user['inappropiateScript'].'",';
				$row .= '"'.$user['notDisplayOwnership'].'",';
				$row .= '"'.$user['incorrectTransfer'].'",';
				$row .= '"'.$user['didagentabruptendcall'].'",';
				$row .= '"'.$user['didagentanswerpremiumquestion'].'",';
				$row .= '"'.$user['didagentgivewrongcallback'].'",';
				$row .= '"'.$user['didagentuseincorrectname'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='ancient_nutrition'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['repgreetingcustomer'].'",';
				$row .= '"'.$user['repuserespectfultone'].'",';
				$row .= '"'.$user['repasnwertimelymanner'].'",';
				$row .= '"'.$user['repcollectcustomerinfo'].'",';
				$row .= '"'.$user['repcoverpaymentprocedure'].'",';
				$row .= '"'.$user['repuselisteningskills'].'",';
				$row .= '"'.$user['repdemonstratecalltechnique'].'",';
				$row .= '"'.$user['repreframeinterruptcaller'].'",';
				$row .= '"'.$user['repspeakclearlyatpace'].'",';
				$row .= '"'.$user['repavoiduseinternalterms'].'",';
				$row .= '"'.$user['repconfidentinresponce'].'",';
				$row .= '"'.$user['repusercallerlastname'].'",';
				$row .= '"'.$user['repusefiltertoobtain'].'",';
				$row .= '"'.$user['repcoverautoshipping'].'",';
				$row .= '"'.$user['repgatheredemail'].'",';
				$row .= '"'.$user['repcoverRushshipping'].'",';
				$row .= '"'.$user['repcompleteorderconfirmation'].'",';
				$row .= '"'.$user['repmaintaincallcontrol'].'",';
				$row .= '"'.$user['repusetoolappropiately'].'",';
				$row .= '"'.$user['repdemonstrateproductknowledge'].'",';
				$row .= '"'.$user['repuseappropiateobjection'].'",';
				$row .= '"'.$user['repaccuratelycalldocument'].'",';
				$row .= '"'.$user['repcompletecorrectclosing'].'",';
				$row .= '"'.$user['repthankthecallerbeforeclosing'].'",';
				$row .= '"'.$user['repcoveroffersappropiately'].'",';
				$row .= '"'.$user['repcoverupsellappropiately'].'",';
				$row .= '"'.$user['agentReadConfirmScript'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='sabal'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentaskIndividualName'].'",';
				$row .= '"'.$user['agentIntroduceHimHerself'].'",';
				$row .= '"'.$user['agentStateCustomerService'].'",';
				$row .= '"'.$user['agentApologizePhoneCall'].'",';
				$row .= '"'.$user['agentIndividualRXplan'].'",';
				$row .= '"'.$user['agentReadListedExample'].'",';
				$row .= '"'.$user['agentAskIndividualColorCard'].'",';
				$row .= '"'.$user['agentAskIndividualUpdate'].'",';
				$row .= '"'.$user['agentAskIndividualEffectiveDate'].'",';
				$row .= '"'.$user['agentUseCorrectRebuttal'].'",';
				$row .= '"'.$user['agentUseIndividualScript'].'",';
				$row .= '"'.$user['agentSaysHeShenotInterested'].'",';
				$row .= '"'.$user['agentAbruptlyEndCall'].'",';
				$row .= '"'.$user['agentbecomeUrgumentative'].'",';
				$row .= '"'.$user['agentRecordIncirrectMedicare'].'",';
				$row .= '"'.$user['agentProvideFalseInformation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='curative'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greetCustomerProperly'].'",';
				$row .= '"'.$user['useRespectfulTone'].'",';
				$row .= '"'.$user['answerInTimelyManner'].'",';
				$row .= '"'.$user['verifyCustomerInformation'].'",';
				$row .= '"'.$user['verifyPatientPHI'].'",';
				$row .= '"'.$user['accidentalIncorrectInformation'].'",';
				$row .= '"'.$user['agentEscalateTier2Correctly'].'",';
				$row .= '"'.$user['agentEnsureEmailAddress'].'",';
				$row .= '"'.$user['agentRespectPatientPrivacy'].'",';
				$row .= '"'.$user['agentSpeakConcisely'].'",';
				$row .= '"'.$user['agentAvoidInternalTerms'].'",';
				$row .= '"'.$user['agentDemonstrateEmpathyUse'].'",';
				$row .= '"'.$user['agentUsePleaseThankyou'].'",';
				$row .= '"'.$user['agentMinimizeExtendedSilence'].'",';
				$row .= '"'.$user['agentUseCorrectSentence'].'",';
				$row .= '"'.$user['agentSpeakWarmthVoice'].'",';
				$row .= '"'.$user['callerGaveAgentKUDOS'].'",';
				$row .= '"'.$user['agentDemonstrateCallerPatient'].'",';
				$row .= '"'.$user['repCompletlyCallDocument'].'",';
				$row .= '"'.$user['repConfirmCompleteClosing'].'",';
				$row .= '"'.$user['thankCallerBeforeClosing'].'",';
				$row .= '"'.$user['repDoEverythingPossible'].'",';
				$row .= '"'.$user['repAncipateCallerNeed'].'",';
				$row .= '"'.$user['agentProvideAccurateResult'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='powerfan'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['answerCallWithin5sec'].'",';
				$row .= '"'.$user['agentIdentifySelftandCompany'].'",';
				$row .= '"'.$user['collectIntroInformation'].'",';
				$row .= '"'.$user['mainSelftAgentGiveTerms'].'",';
				$row .= '"'.$user['agentPromoteUpsell'].'",';
				$row .= '"'.$user['describedProductAccurately'].'",';
				$row .= '"'.$user['useAppropiateObjection'].'",';
				$row .= '"'.$user['askForBillingNamesOnCheck'].'",';
				$row .= '"'.$user['agentVerifyCallerUseofCheck'].'",';
				$row .= '"'.$user['askForBillingAddressForPayment'].'",';
				$row .= '"'.$user['agentVerifyShippingAddress'].'",';
				$row .= '"'.$user['orderWasSetUpAndCodedCorrectly'].'",';
				$row .= '"'.$user['askForEmailAddress'].'",';
				$row .= '"'.$user['gaveTotalAmountCharged'].'",';
				$row .= '"'.$user['gaveCorrectShippingInfo'].'",';
				$row .= '"'.$user['gaveMBGInfo'].'",';
				$row .= '"'.$user['gaveCSPhoneNumber'].'",';
				$row .= '"'.$user['permissionToAuthorizePayment'].'",';
				$row .= '"'.$user['wasAgentPolite'].'",';
				$row .= '"'.$user['agentUsingAppropiateComment'].'",';
				$row .= '"'.$user['useHoldAndTransferProperly'].'",';
				$row .= '"'.$user['power_fan_autofail'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='nuwave'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['order_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['interaction'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greeting_identification'].'",';
				$row .= '"'.$user['verified_customer'].'",';
				$row .= '"'.$user['use_caller_CSR_name'].'",';
				$row .= '"'.$user['doesnot_interrupt_customer'].'",';
				$row .= '"'.$user['converses_clear_concise_mannaer'].'",';
				$row .= '"'.$user['avoid_use_slang_jargon'].'",';
				$row .= '"'.$user['empathy_toward_customer'].'",';
				$row .= '"'.$user['CSR_sound_helpful'].'",';
				$row .= '"'.$user['gain_customer_permission'].'",';
				$row .= '"'.$user['thanks_customer_holding'].'",';
				$row .= '"'.$user['hold_time_appropiate'].'",';
				$row .= '"'.$user['utilized_established_guidelines'].'",';
				$row .= '"'.$user['use_probing_question'].'",';
				$row .= '"'.$user['verbally_verfied_problem'].'",';
				$row .= '"'.$user['manage_customer_expectation'].'",';
				$row .= '"'.$user['reason_for_troubleshooting'].'",';
				$row .= '"'.$user['use_available_resources'].'",';
				$row .= '"'.$user['complete_customer_documentation'].'",';
				$row .= '"'.$user['customer_comfortable_with_outcome'].'",';
				$row .= '"'.$user['additional_needs_uncovered'].'",';
				$row .= '"'.$user['product_served_their_needs'].'",';
				$row .= '"'.$user['used_correct_closing'].'",';
				$row .= '"'.$user['infractions'].'",';
				$row .= '"'.$user['sub_infractions'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='delta_iowa'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['answer_call_promptly'].'",';
				$row .= '"'.$user['open_call_property'].'",';
				$row .= '"'.$user['verify_identify_information'].'",';
				$row .= '"'.$user['adhered_HIPAA'].'",';
				$row .= '"'.$user['adhere_client_policies'].'",';
				$row .= '"'.$user['perform_correct_action'].'",';
				$row .= '"'.$user['set_appropiate_expectation'].'",';
				$row .= '"'.$user['gave_accurate_info'].'",';
				$row .= '"'.$user['routed_issue'].'",';
				$row .= '"'.$user['complete_documentation'].'",';
				$row .= '"'.$user['phrases_courtsey'].'",';
				$row .= '"'.$user['use_caller_name'].'",';
				$row .= '"'.$user['hold_and_transfer'].'",';
				$row .= '"'.$user['state_call_reason'].'",';
				$row .= '"'.$user['use_jargon'].'",';
				$row .= '"'.$user['allow_caller_speak'].'",';
				$row .= '"'.$user['positive_plan_type'].'",';
				$row .= '"'.$user['willingness_help_caller'].'",';
				$row .= '"'.$user['gained_agrrement'].'",';
				$row .= '"'.$user['emphathetic_manner'].'",';
				$row .= '"'.$user['closed_call'].'",';
				$row .= '"'.$user['resolved_customer_issue'].'",';
				$row .= '"'.$user['assure_customer_comcern'].'",';
				$row .= '"'.$user['effective_attempt'].'",';
				$row .= '"'.$user['agent_disconnect_customer'].'",';
				$row .= '"'.$user['agent_transfer_customer'].'",';
				$row .= '"'.$user['agent_use_offensive_word'].'",';
				$row .= '"'.$user['agent_talked_down_caller'].'",';
				$row .= '"'.$user['agent_disclosed_info'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='foodsaver'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greet_caller_properly'].'",';
				$row .= '"'.$user['read_entire_script'].'",';
				$row .= '"'.$user['caller_no_initial_offer'].'",';
				$row .= '"'.$user['preserve_highest_quality'].'",';
				$row .= '"'.$user['rep_ask_question'].'",';
				$row .= '"'.$user['caller_no_first_rebuttal'].'",';
				$row .= '"'.$user['caller_no_rep_advise'].'",';
				$row .= '"'.$user['re_thank_caller'].'",';
				$row .= '"'.$user['rep_advise_price_tag'].'",';
				$row .= '"'.$user['rep_ask_order_confirmation'].'",';
				$row .= '"'.$user['rep_offer_auto_delivary'].'",';
				$row .= '"'.$user['ask_caller_foodsaver_gift'].'",';
				$row .= '"'.$user['rep_ask_email_address'].'",';
				$row .= '"'.$user['rep_ask_about_credit_card'].'",';
				$row .= '"'.$user['thank_caller_for_order'].'",';
				$row .= '"'.$user['review_order_summary'].'",';
				$row .= '"'.$user['rep_ask_for_help'].'",';
				$row .= '"'.$user['rep_end_positive_statement'].'",';
				$row .= '"'.$user['enter_incorrect_credit_card'].'",';
				$row .= '"'.$user['rep_speak_rudely'].'",';
				$row .= '"'.$user['rep_badger_caller'].'",';
				$row .= '"'.$user['disconnet_call_without_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='suarez'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_an'].'",';
				$row .= '"'.$user['account_identifiers'].'",';
				$row .= '"'.$user['copy_received'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_promptly_sound_ready'].'",';
				$row .= '"'.$user['introduction_clear_noise'].'",';
				$row .= '"'.$user['correct_greeting'].'",';
				$row .= '"'.$user['friendly_happy'].'",';
				$row .= '"'.$user['captured_correctly'].'",';
				$row .= '"'.$user['script_correctly'].'",';
				$row .= '"'.$user['information_correctly'].'",';
				$row .= '"'.$user['disclaimers_offered'].'",';
				$row .= '"'.$user['call_properly_sale'].'",';
				$row .= '"'.$user['sound_confident'].'",';
				$row .= '"'.$user['upsells_offered_correctly'].'",';
				$row .= '"'.$user['obtain_requirement_scale'].'",';
				$row .= '"'.$user['additional_upsell_opportunity'].'",';
				$row .= '"'.$user['call_without_excessive'].'",';
				$row .= '"'.$user['lose_a_sale'].'",';
				$row .= '"'.$user['appropriately_answer'].'",';
				$row .= '"'.$user['full_attention'].'",';
				$row .= '"'.$user['heard_interrupting'].'",';
				$row .= '"'.$user['impression_of_customer'].'",';
				$row .= '"'.$user['noticeable_change'].'",';
				$row .= '"'.$user['times_appropriately'].'",';
				$row .= '"'.$user['keyed_correctly'].'",';
				$row .= '"'.$user['account_or_experience'].'",';
				$row .= '"'.$user['promotions_and_procedures'].'",';
				$row .= '"'.$user['negative_or_unprofessional'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='sfe'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['is_agent_advice'].'",';
				$row .= '"'.$user['is_agent_advice_record'].'",';
				$row .= '"'.$user['agent_provide_all_program'].'",';
				$row .= '"'.$user['agent_speaking_account_holder'].'",';
				$row .= '"'.$user['agent_ask_caller_receiving_govt_assist'].'",';
				$row .= '"'.$user['do_ask_addr_email'].'",';
				$row .= '"'.$user['is_caller_18_years_old'].'",';
				$row .= '"'.$user['is_rep_sound_confident_polite'].'",';
				$row .= '"'.$user['agent_address_caller'].'",';
				$row .= '"'.$user['is_agent_use_greeting'].'",';
				$row .= '"'.$user['is_agent_extended_silence'].'",';
				$row .= '"'.$user['agent_speak_clearly'].'",';
				$row .= '"'.$user['agent_first_rebuttal_correctly'].'",';
				$row .= '"'.$user['agent_second_rebuttal_correctly'].'",';
				$row .= '"'.$user['agent_provide_phone_call_back'].'",';
				$row .= '"'.$user['agent_advice_welcome_package'].'",';
				$row .= '"'.$user['agent_ask_for_sale'].'",';
				$row .= '"'.$user['rep_finalize_date_for_quote'].'",';
				$row .= '"'.$user['rep_take_complete_notes'].'",';
				$row .= '"'.$user['rep_proceed_call_without_yes'].'",';
				$row .= '"'.$user['rep_provide_accurate_information'].'",';
				$row .= '"'.$user['rep_mislead_caller_any_way'].'",';
				$row .= '"'.$user['rep_advice_to_uses_service'].'",';
				$row .= '"'.$user['do_rep_advice_service'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='brightway_ib_bank'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				if($user['bonus_question']=='AB') $bonus_question='Associate was able to retain customer that indicated they were going to leave Brightway.';
				if($user['bonus_question']=='AS') $bonus_question='Associate identified a cross sell opportunity and was able to refer to agent for additional quotes.';

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['did_csr_use_approved_greeting'].'",';
				$row .= '"'.$user['did_applicable_rep_advice'].'",';
				$row .= '"'.$user['verified_captured_point_contact'].'",';
				$row .= '"'.$user['did_associate_use_tone'].'",';
				$row .= '"'.$user['did_associate_use_tone'].'",';
				$row .= '"'.$user['did_associate_avoid_insurance'].'",';
				$row .= '"'.$user['did_associate_listen_carefully'].'",';
				$row .= '"'.$user['did_associate_ask_place'].'",';
				$row .= '"'.$user['associate_maintained_call'].'",';
				$row .= '"'.$user['not_any_silence_dead_air'].'",';
				$row .= '"'.$user['all_verbal_written_information'].'",';
				$row .= '"'.$user['did_associate_ask_probing'].'",';
				$row .= '"'.$user['applicable_call_warn_transferred'].'",';
				$row .= '"'.$user['expectation_provided'].'",';
				$row .= '"'.$user['if_call_dicconnected_prior'].'",';
				$row .= '"'.$user['documented_correct_policy'].'",';
				$row .= '"'.$user['are_notes_clear'].'",';
				$row .= '"'.$user['created_all_activities'].'",';
				$row .= '"'.$user['do_correct_template_used'].'",';
				$row .= '"'.$user['attached_all_email'].'",';
				$row .= '"'.$user['was_the_issue'].'",';
				$row .= '"'.$user['requested_all_signed_documents'].'",';
				$row .= '"'.$user['csr_offered_any_possible'].'",';
				$row .= '"'.$user['effectively_accessed'].'",';
				$row .= '"'.$user['ware_all_changes_made'].'",';
				$row .= '"'.$user['all_associated_policies'].'",';
				$row .= '"'.$user['was_the_appropriate_suspense'].'",';
				$row .= '"'.$user['address_any_service_related'].'",';
				$row .= '"'.$user['csr_updated_any_suspense'].'",';
				$row .= '"'.$user['was_correct_disposion_selected'].'",';
				$row .= '"'.$user['did_csr_provide_summary'].'",';
				$row .= '"'.$user['did_associate_offer'].'",';
				$row .= '"'.$bonus_question.'",';
				$row .= '"'.$user['do_call_auto_fail'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
        }else if($pid=='offline'){
        foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';

                $row .= '"'.$user['phone'].'",';
                $row .= '"'.$user['rep'].'",';
                $row .= '"'.$user['enter_policy_information'].'",';
                $row .= '"'.$user['florida_or_national'].'",';
                $row .= '"'.$user['type_of_policy'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
                $row .= '"'.$user['associate_handle_request_according_Brightway'].'",';
                $row .= '"'.$user['associate_handle_request_according_carrier'].'",';
                $row .= '"'.$user['associate_process_change'].'",';
                $row .= '"'.$user['associate_use_appropriate_verbiage'].'",';
                $row .= '"'.$user['All_verbal_written_information'].'",';
                $row .= '"'.$user['was_customer_adversely'].'",';
                $row .= '"'.$user['were_there_any_additional'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

	    }else if($pid=='brightway_prescreen_new'){
        foreach($rr as $user){

				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';


                $row .= '"'.$user['phone'].'",';
                $row .= '"'.$user['file_no'].'",';
                $row .= '"'.$user['filler'].'",';

                $row .= '"'.$user['site'].'",';
                $row .= '"'.$user['area_code'].'",';
                $row .= '"'.$user['call_duration'].'",';

				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';

				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

                $row .= '"'.$user['transfer_to'].'",';
                $row .= '"'.$user['appropriate_greeting'].'",';
                $row .= '"'.$user['pre_screen_template'].'",';
                $row .= '"'.$user['csr_disposition'].'",';
                $row .= '"'.$user['appropriate_soft_skills'].'",';
                $row .= '"'.$user['csr_use_the_proper'].'",';
                $row .= '"'.$user['csr_transfer_correct'].'",';
                $row .= '"'.$user['appropriately_authenticated'].'",';
                $row .= '"'.$user['experience_any_audio'].'",';
                 $row .= '"'.$user['verified_and_change'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';


				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='qpc_esal'){
			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['open_call_introduction'].'",';
				$row .= '"'.$user['accurate_translation'].'",';
				$row .= '"'.$user['provide_correct_data'].'",';
				$row .= '"'.$user['use_correct_grammar'].'",';
				$row .= '"'.$user['effective_communication'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['avoid_silence_gap'].'",';
				$row .= '"'.$user['communicate_respectful_manner'].'",';
				$row .= '"'.$user['cannot_translet_profanity'].'",';
				$row .= '"'.$user['close_call'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='cinemark'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['greet_customer_appropriately'].'",';
				$row .= '"'.$user['agent_provide_name'].'",';
				$row .= '"'.$user['agent_ask_how_assist'].'",';

				$row .= '"'.$user['adhere_to_refund_rules'].'",';
				$row .= '"'.$user['transfer_to_inter_super'].'",';
				$row .= '"'.$user['agent_fill_ticket'].'",';
				$row .= '"'.$user['agent_include_th_no'].'",';
				$row .= '"'.$user['agent_leave_correct_note'].'",';
				$row .= '"'.$user['agent_leave_conf_no'].'",';
				$row .= '"'.$user['agent_supply_correct_info'].'",';
        $row .= '"'.$user['agent_able_access_cust_past_transacs'].'",';
        $row .= '"'.$user['agent_appropriate_tone'].'",';
        $row .= '"'.$user['agent_close_correctly'].'",';
        $row .= '"'.$user['agent_complete_necessary_task'].'",';
        $row .= '"'.$user['agent_use_inappropriate_lang'].'",';
        $row .= '"'.$user['agent_provide_cinemark_customer_advise'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='empire'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['prepared_take_call'].'",';
				$row .= '"'.$user['use_standard_greeting'].'",';
				$row .= '"'.$user['open_call_pleasant'].'",';

				$row .= '"'.$user['use_thank_you'].'",';
				$row .= '"'.$user['use_customer_name'].'",';
				$row .= '"'.$user['professional_communication'].'",';
				$row .= '"'.$user['positive_represent_empire'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['maintain_call_control'].'",';
				$row .= '"'.$user['probe_accurate_need'].'",';
        $row .= '"'.$user['restate_cust_need'].'",';
        $row .= '"'.$user['set_expectation'].'",';
        $row .= '"'.$user['ask_cust_appoint'].'",';
        $row .= '"'.$user['verify_cust_account'].'",';
        $row .= '"'.$user['confirm_all_data'].'",';
        $row .= '"'.$user['provide_acurate_comp_info'].'",';
        $row .= '"'.$user['demo_confidence_info'].'",';
        $row .= '"'.$user['overcome_objections'].'",';
        $row .= '"'.$user['comfirm_appointment'].'",';
        $row .= '"'.$user['use_standard_closing'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='hcpss'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['answer_call_promptly'].'",';
				$row .= '"'.$user['introduction_clear_noise'].'",';
				$row .= '"'.$user['use_correct_greeting'].'",';

				$row .= '"'.$user['sound_friendly'].'",';
				$row .= '"'.$user['case_captured_correctly'].'",';
				$row .= '"'.$user['capture_correct_info'].'",';
				$row .= '"'.$user['verify_info'].'",';
				$row .= '"'.$user['add_all_app_notes'].'",';
				$row .= '"'.$user['complete_call_prop'].'",';
				$row .= '"'.$user['sound_confident'].'",';
        $row .= '"'.$user['beyond_requrie'].'",';
        $row .= '"'.$user['answer_caller_question'].'",';
        $row .= '"'.$user['caller_have_attention'].'",';
        $row .= '"'.$user['interrupted_caller'].'",';
        $row .= '"'.$user['use_hold_times'].'",';
        $row .= '"'.$user['call_handled_correctly'].'",';
        $row .= '"'.$user['conf_positive_correct_list'].'",';
        $row .= '"'.$user['saying_negative'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=="cmn"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['opening'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['empathy_apology'].'",';

				$row .= '"'.$user['owner_assure'].'",';
				$row .= '"'.$user['tone_speech'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['parallel_conversation'].'",';
				$row .= '"'.$user['issue_identification'].'",';
				$row .= '"'.$user['probing'].'",';
				$row .= '"'.$user['pay_conf'].'",';
        $row .= '"'.$user['refund_process'].'",';
        $row .= '"'.$user['email_id_verification'].'",';
        $row .= '"'.$user['phone_no_verification'].'",';
        $row .= '"'.$user['ztp'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="pilgrim"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['proper_introduction'].'",';
				$row .= '"'.$user['explain_offer'].'",';
				$row .= '"'.$user['proper_response'].'",';

				$row .= '"'.$user['correct_probe'].'",';
				$row .= '"'.$user['proper_disposition'].'",';
				$row .= '"'.$user['polite_agent'].'",';
				$row .= '"'.$user['minimal_dead_air'].'",';
				$row .= '"'.$user['energy'].'",';
				$row .= '"'.$user['tone_pacing'].'",';
				$row .= '"'.$user['acc_comp_info'].'",';
        $row .= '"'.$user['setup_gold_card'].'",';
        $row .= '"'.$user['disengage_prank_call'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="bluebenefits"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['greet_the_customer'].'",';
				$row .= '"'.$user['respectful_tone'].'",';
				$row .= '"'.$user['correctly_verify_the_caller'].'",';
				$row .= '"'.$user['willingness_statement'].'",';
				$row .= '"'.$user['professional_manner'].'",';

				$row .= '"'.$user['incomplete_provider'].'",';
				$row .= '"'.$user['incorrectly_quote'].'",';
				$row .= '"'.$user['miss_the_coinsurance'].'",';
				$row .= '"'.$user['incorrectly_give_cr'].'",';
				$row .= '"'.$user['incorrectly_deductible'].'",';
				$row .= '"'.$user['incorrect_information'].'",';
				$row .= '"'.$user['correct_claims_address'].'",';
				$row .= '"'.$user['medical_necessity'].'",';
				$row .= '"'.$user['correctly_dme_coverage'].'",';

				$row .= '"'.$user['speak_clearly'].'",';
				$row .= '"'.$user['internal_terms'].'",';
				$row .= '"'.$user['agent_demonstrate'].'",';
				$row .= '"'.$user['email_communication'].'",';
				$row .= '"'.$user['minimize_extended_silences'].'",';
				$row .= '"'.$user['speak_with_sincere_warmth'].'",';
				$row .= '"'.$user['sentence_structure'].'",';
				$row .= '"'.$user['agent_demonstrate_patience'].'",';

				$row .= '"'.$user['accurately_and_completely_document'].'",';
				$row .= '"'.$user['correct_confirmation_and_closing'].'",';
				$row .= '"'.$user['caller_before_closing'].'",';
				$row .= '"'.$user['possible_to_assist_the_caller'].'",';
				$row .= '"'.$user['anticipate_the_caller'].'",';
				


       			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="healthbridge"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['correct_information'].'",';
				$row .= '"'.$user['resolved_all'].'",';
				$row .= '"'.$user['added_detailed'].'",';
				$row .= '"'.$user['disposition_the'].'",';
				$row .= '"'.$user['verified_the'].'",';
				$row .= '"'.$user['used_the_verification'].'",';
				$row .= '"'.$user['followed_all_company'].'",';
				$row .= '"'.$user['informed_the_member'].'",';
				$row .= '"'.$user['proper_greeting'].'",';
				$row .= '"'.$user['clear_communication'].'",';
				$row .= '"'.$user['demonstrated'].'",';
				$row .= '"'.$user['proper_expectations'].'",';
				$row .= '"'.$user['avoided_industry'].'",';
				$row .= '"'.$user['verified_current_address'].'",';
				$row .= '"'.$user['if_applicable_requested'].'",';
				$row .= '"'.$user['if_applicable_the_member'].'",';
				$row .= '"'.$user['did_agent_present'].'",';
				$row .= '"'.$user['did_agent_offer'].'",';
				$row .= '"'.$user['adhered_to_HIPAA'].'",';
				$row .= '"'.$user['used_inappropriate'].'",';
				$row .= '"'.$user['did_agent_repeat'].'",';
				$row .= '"'.$user['call_avoidance'].'",';


       			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }
	}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/*--------------------------------------------------------------------*/
/*					ALL AGENT FEEDBACK PART							  */
/*--------------------------------------------------------------------*/
	public function agent_amd_feedback()
	{
		if(check_logged_in())
		{
			$user_site_id= get_user_site_id();
			$role_id= get_role_id();
			$current_user = get_user_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/agent_amd_feedback.php";
			$data["agentUrl"] = "qa_ameridial/agent_amd_feedback";

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
		
			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			// $from_date = '';
			// $to_date = '';
			$campaign='';
			$cond="";

			$campaign = $this->input->get('campaign');


			if($campaign!=''){

				if($campaign=="mercy_ship"){
					$qSql1="Select count(id) as value from qa_mercy_feedback where agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit','Calibration','WOW Call', 'Trainer Audit')";
					$qSql2="Select count(id) as value from qa_mercy_feedback where agent_rvw_date is null and agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit','WOW Call', 'Trainer Audit')";
				}else if ($campaign=="kenny_u_pull") {
					$qSql1="Select count(id) as value from qa_kenny_u_pull_feedback where agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit','WOW Call', 'Trainer Audit')";
					$qSql2="Select count(id) as value from qa_kenny_u_pull_feedback where agent_rvw_date is null and agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit','WOW Call', 'Trainer Audit')";
				}else if ($campaign=="homeward_health") {
					$qSql1="Select count(id) as value from qa_homeward_health_feedback where agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit','WOW Call', 'Trainer Audit')";
					$qSql2="Select count(id) as value from qa_homeward_health_feedback where agent_rvw_date is null and agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit','WOW Call', 'Trainer Audit')";
				}else{
					$qSql1="Select count(id) as value from qa_amd_".$campaign."_feedback where agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'WOW Call','Operation Audit', 'Trainer Audit')";
					$qSql2="Select count(id) as value from qa_amd_".$campaign."_feedback where agent_rvw_date is null and agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit','WOW Call', 'Trainer Audit')";
				}

				$data["tot_feedback"] =  $this->Common_model->get_single_value($qSql1);
				$data["yet_rvw"] =  $this->Common_model->get_single_value($qSql2);


				if($this->input->get('btnView')=='View')
				{
					$fromDate = $this->input->get('from_date');
					if($fromDate!="") $from_date = mmddyy2mysql($fromDate);

					$toDate = $this->input->get('to_date');
					if($toDate!="") $to_date = mmddyy2mysql($toDate);

					if($fromDate !="" && $toDate!=="" ){
						$cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date') And agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit', 'Trainer Audit','WOW Call') ";
					}else{
						$cond= " Where agent_id='$current_user' and audit_type in ('CQ Audit', 'BQ Audit', 'Operation Audit', 'Trainer Audit','WOW Call') ";
					}

					if($campaign=="mercy_ship"){
						$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name from qa_mercy_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
					}else if($campaign=="kenny_u_pull"){
						$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name from qa_kenny_u_pull_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
					}else if($campaign=="homeward_health"){
						$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name from qa_homeward_health_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
					}
					else{
					 $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name from qa_amd_".$campaign."_feedback $cond) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process_name from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
					}
					$data["agent_list"] = $this->Common_model->get_query_result_array($qSql);
					//print_r($data["agent_list"]);
				}
			}

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["campaign"] = $campaign;
			$this->load->view('dashboard',$data);
		}
	}

	public function agent_amd_rvw($id,$campaign){
		if(check_logged_in()){
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();
			
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/agent_amd_rvw.php";
			$data["agentUrl"] = "qa_ameridial/agent_amd_feedback";

			if($campaign=="mercy_ship"){
				$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name,agent_rvw_note as agent_note,mgnt_rvw_note as mgnt_note from qa_mercy_feedback where id=$id) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
			}else if ($campaign=="kenny_u_pull") {
				$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name,agent_rvw_note as agent_note,mgnt_rvw_note as mgnt_note from qa_kenny_u_pull_feedback where id=$id) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
			}else if ($campaign=="homeward_health") {
				$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name,agent_rvw_note as agent_note,mgnt_rvw_note as mgnt_note from qa_homeward_health_feedback where id=$id) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
			}
			else{
				$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name,agent_rvw_note as agent_note,mgnt_rvw_note as mgnt_note from qa_amd_".$campaign."_feedback where id=$id) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to,get_process_names(id) as process_name from signin) yy on (xx.agent_id=yy.sid) order by audit_date";
			}
			$data["agnt_feedback"] = $this->Common_model->get_query_row_array($qSql);

			$data["pnid"]=$id;
			$data["campaign"]=$campaign;

			if($campaign=="mercy_ship"){
				$table='qa_mercy_feedback';
			}else if($campaign=="homeward_health" || $campaign=="kenny_u_pull"){
				$table='qa_'.$campaign.'_feedback';
			}
			else{
				$table='qa_amd_'.$campaign.'_feedback';
			}

			if(in_array($campaign,array("trapollo","sontiq"))){

				$columnname=$campaign."_columnname";
				$scorecard="parameter_".$campaign."_scrorecard_details";
				$data["columname"]=$this->$columnname();
				$data["scoreParametername"]=$this->$scorecard();
				$data["cnt"]=count($data["columname"]);

				if($campaign=="sontiq"){
					$mainArrayColumn=$this->$scorecard();
					$nonSelectTDDetails=$this->sontiqnonSelectTDDetails();
					$cnt=count($nonSelectTDDetails);
					for ($i=0; $i <$cnt ; $i++) {
						unset($mainArrayColumn[$i]);
					}
					$sotniqArrayscore=array_values(array_filter($mainArrayColumn));
					$data["scoreParametername"]=$sotniqArrayscore;
				}
			}

			if($this->input->post('pnid'))
			{
				$pnid=$this->input->post('pnid');
				$curDateTime=CurrMySqlDate();
				$log=get_logs();

				$field_array=array(
					"agnt_fd_acpt" => $this->input->post('agnt_fd_acpt'),
					"agent_rvw_note" => $this->input->post('note'),
					"agent_rvw_date" => $curDateTime
				);
				$this->db->where('id', $pnid);
				$this->db->update($table,$field_array);

				redirect('Qa_ameridial/agent_amd_feedback');

			}else{
				$this->load->view('dashboard',$data);
			}
		}
	}


///////////////////////////////////////////////////////////////////////////////////
/*-------------------------- Suarez (Amir- 08/07/2021) --------------------------*/
///////////////////////////////////////////////////////////////////////////////////

	public function suarez(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/suarez/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_suarez_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["suarez"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_suarez($suarez_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/suarez/add_edit_suarez.php";
			$data['suarez_id']=$suarez_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_suarez_feedback where id='$suarez_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["suarez"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($suarez_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/suarez/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_suarez_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_suarez_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $suarez_id);
					$this->db->update('qa_amd_suarez_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $suarez_id);
					$this->db->update('qa_amd_suarez_feedback',$edit_array);

				}
				redirect('qa_ameridial/suarez');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

  ///////////////////////////////////////////////////////////////////////////////////
  /*-------------------------- HCPSS - Howard County Public School System (Start) ---------------------------*/
  /*------------- Edited By Samrat 2/12/2021 --------------------*/
  ///////////////////////////////////////////////////////////////////////////////////
  public function hcpss(){
    if(check_logged_in()){
      $current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/hcpss/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,597) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_hcpss_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["hcpss"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
    }
  }

  public function add_edit_hcpss($hcpss_id){
    if(check_logged_in()){
      $current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/hcpss/add_edit_hcpss.php";
			$data['hcpss_id']=$hcpss_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id, 597) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_hcpss_feedback where id='$hcpss_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["hcpss"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($hcpss_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/hcpss/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_hcpss_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_hcpss_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					// $field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_hcpss_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_hcpss_feedback',$edit_array);

				}
				redirect('qa_ameridial/hcpss');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
    }
  }
  ///////////////////////////////////////////////////////////////////////////////////
  /*-------------------------- HCPSS - Howard County Public School System (End) ---------------------------*/
  /*------------- Edited By Samrat 2/12/2021 --------------------*/
  ///////////////////////////////////////////////////////////////////////////////////

  ///////////////////////////////////////////////////////////////////////////////////
  /*-------------------------- CMN - Children Miracle Network (Start) ---------------------------*/
  /*------------- Edited By Samrat 9/12/2021 --------------------*/
  ///////////////////////////////////////////////////////////////////////////////////
  public function cmn(){
    if(check_logged_in()){
      $current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/cmn/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,271) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_cmn_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["cmn"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
    }
  }

  public function add_edit_cmn($cmn_id){
    if(check_logged_in()){
      $current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/cmn/add_edit_cmn.php";
			$data['cmn_id']=$cmn_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and is_assign_process(id,271) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_cmn_feedback where id='$cmn_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["cmn"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";
			if($field_array['agent_id']){
				if($cmn_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/cmn/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_cmn_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_cmn_feedback',$add_array);
				}else{
					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					// $field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $cmn_id);
					$this->db->update('qa_amd_cmn_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $cmn_id);
					$this->db->update('qa_amd_cmn_feedback',$edit_array);

				}
				redirect('qa_ameridial/cmn');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
    }
  }
  ///////////////////////////////////////////////////////////////////////////////////
  /*-------------------------- CMN - Children Miracle Network (End) ---------------------------*/
  /*------------- Edited By Samrat 9/12/2021 --------------------*/
  ///////////////////////////////////////////////////////////////////////////////////
  ///////////////////////////////////////////////////////////////////////////////////
  /*-------------------------- Pilgrim (Start) ---------------------------*/
  /*------------- Edited By Samrat 13/12/2021 --------------------*/
  ///////////////////////////////////////////////////////////////////////////////////
  public function pilgrim(){
    if(check_logged_in()){
      $current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/pilgrim/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_pilgrim_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["pilgrim"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
    }
  }
  public function add_edit_pilgrim($pilgrim_id){
    if(check_logged_in()){
      $current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/pilgrim/add_edit_pilgrim.php";
			$data['pilgrim_id']=$pilgrim_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_pilgrim_feedback where id='$pilgrim_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["pilgrim"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();

			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";
			if($field_array['agent_id']){
				if($pilgrim_id==0){
					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/pilgrim/');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_pilgrim_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_pilgrim_feedback',$add_array);
				}else{
					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					// $field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $pilgrim_id);
					$this->db->update('qa_amd_pilgrim_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $pilgrim_id);
					$this->db->update('qa_amd_pilgrim_feedback',$edit_array);

				}
				redirect('qa_ameridial/pilgrim');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
    }
  }

  ///////////////////////////////////////////////////////////////////////////////////
  /*-------------------------- Blue Benefits - Healthcare Quality Guidelines (Start) ---------------------------*/
  /*------------- Amir Hussain 17 01 2022 --------------------*/
  ///////////////////////////////////////////////////////////////////////////////////
  public function bluebenefits(){
    if(check_logged_in()){
      $current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/bluebenefits/qa_feedback.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133)  and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_bluebenefits_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["hcpss"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
			//$this->load->view("qa/aside.php");
    }
  }

  public function add_edit_bluebenefits($hcpss_id){
    if(check_logged_in()){
      $current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/bluebenefits/add_edit_bluebenefits.php";
			$data['hcpss_id']=$hcpss_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_bluebenefits_feedback where id='$hcpss_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["hcpss"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($hcpss_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/bluebenefits/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_bluebenefits_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_bluebenefits_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					// $field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_bluebenefits_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_bluebenefits_feedback',$edit_array);

				}
				redirect('qa_ameridial/bluebenefits');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
    }
  }
  ///////////////////////////////////////////////////////////////////////////////////
  /*-------------------------- Blue Benefits - Healthcare Quality Guidelines (End) */



///////////////////////////////////////Health Bridge(Riya - 1/02/2022)////////////////////////////////////
///////////////////////////////////////Health Bridge New(Saikat - 07/12/2022)////////////////////////////////////



  public function healthBridge(){
    if(check_logged_in()){
      $current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/healthBridge/feedback_healthbridge.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133)  and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_healthbridge_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["healthbridge"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
			from qa_amd_healthbridgenew_feedback $cond) xx Left Join
			(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
		$data["healthbridge_new"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
			//$this->load->view("qa/aside.php");
    }
  }

  public function add_edit_healthBridge($hcpss_id){
    if(check_logged_in()){
      $current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/healthBridge/add_edit_healthbridge.php";
			$data["content_js"] = "qa_ameridial_js.php";
			$data['hcpss_id']=$hcpss_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_healthbridge_feedback where id='$hcpss_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["healthbridge"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($hcpss_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/healthBridge/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_healthbridge_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_healthbridge_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					// $field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_healthbridge_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_healthbridge_feedback',$edit_array);

				}
				redirect('qa_ameridial/healthBridge');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
    }
  }

  public function add_edit_healthBridge_new($hbnew_id){
    if(check_logged_in()){
      $current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/healthBridge/add_edit_healthbridge_new.php";
			$data["content_js"] = "qa_ameridial_js.php";
			$data['hbnew_id']=$hbnew_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_healthbridgenew_feedback where id='$hbnew_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["healthbridge_new"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($hbnew_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/healthBridge/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_healthbridgenew_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_healthbridgenew_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					if(!isset($field_array1['auditor_type'])){
						$field_array1['auditor_type'] = "";
					}
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					// $field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $hbnew_id);
					$this->db->update('qa_amd_healthbridgenew_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $hbnew_id);
					$this->db->update('qa_amd_healthbridgenew_feedback',$edit_array);

				}
				redirect('qa_ameridial/healthBridge');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
    }
  }





  ////////////////////////////////////////End Heath Bridge//////////////////////////////////////////




  ////////////////////////////////////////Mckinsey/////////////////////////////////////////////////

	public function mcKinsey(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "Qa_McKinsey/feedback_mckinsey.php";
			$data["content_js"] = "qa_one_assist_js.php";
			// $data["content_js"] = "qa_ameridial_js.php";			
			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$cond='';
			
			if($from_date==""){ 
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}
			
			if($to_date==""){ 
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}
			
		////////////////////////	
			if($from_date !="" && $to_date!=="" )  $cond= " Where (audit_date >= '$from_date' and audit_date <= '$to_date' ) ";
			
			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}

			$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_mcKinsey_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["mckinsey"] = $this->Common_model->get_query_result_array($qSql);
		
			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			
			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_mckinsey($am_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "Qa_McKinsey/add_edit_mckinsey.php";
			$data["content_js"] = "qa_one_assist_js.php";
			// $data["content_js"] = "qa_ameridial_js.php";
			$data['am_id']=$am_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and is_assign_process(id,444) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_mcKinsey_feedback where id='$am_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["mckinsey"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($am_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'],$path='./qa_files/qa_ameridial/mcKinsey');
					$field_array["attach_file"] = implode(',',$a);
					$rowid= data_inserter('qa_amd_mcKinsey_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_mcKinsey_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$this->db->where('id', $am_id);
					$this->db->update('qa_amd_mcKinsey_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $am_id);
					$this->db->update('qa_amd_mcKinsey_feedback',$edit_array);

				}
				redirect('Qa_McKinsey');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}






  
  /////////////////////////////////////////////////////////////////////////////////////////////////





  ///////////////////////////////////////Riya Compliance///////////////////////////////////////////



   public function compliance(){
    if(check_logged_in()){
      $current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/compliance/feedback_compliance.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134)  and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_compliance_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["compliance"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
			//$this->load->view("qa/aside.php");
    }
  }

  public function add_edit_compliance($hcpss_id){
  	ini_set("display_errors","on");
  	ini_set("error_reporting","E_ALL");

    if(check_logged_in()){
      $current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/compliance/add_edit_compliance.php";
			$data["content_js"] = "qa_ameridial_js.php";
			$data['hcpss_id']=$hcpss_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,134) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_compliance_feedback where id='$hcpss_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["compliance"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($hcpss_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/compliance/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_compliance_feedback',$field_array);
					
					$this->db->insert('qa_amd_compliance_feedback',$insert_data);
					
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_compliance_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					// $field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_compliance_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $hcpss_id);
					$this->db->update('qa_amd_compliance_feedback',$edit_array);

				}
				redirect('qa_ameridial/compliance');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
    }
  }



///////////////////////////////////////////////////////////////////////////////////////////////



public function cci_medicare(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/cci_medicare/feedback_cci_medicare.php";
			$data["content_js"] = "qa_ameridial_healthcare_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_cci_medicare_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["cci_medicare"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_cci_medicare($cci_medicare_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/cci_medicare/add_edit_cci_medicare.php";
			$data["content_js"] = "qa_ameridial_healthcare_js.php";
			$data['cci_medicare_id']=$cci_medicare_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_cci_medicare_feedback where id='$cci_medicare_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["cci_medicare"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($cci_medicare_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					//$field_array['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/cci_medicare/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_cci_medicare_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_cci_medicare_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					//$field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $cci_medicare_id);
					$this->db->update('qa_amd_cci_medicare_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $cci_medicare_id);
					$this->db->update('qa_amd_cci_medicare_feedback',$edit_array);

				}
				redirect('qa_ameridial/cci_medicare');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}



	public function cci_commercial(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/cci_commercial/feedback_cci_commercial.php";
			$data["content_js"] = "qa_ameridial_healthcare_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_cci_commercial_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["cci_commercial"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_cci_commercial($cci_medicare_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/cci_commercial/add_edit_cci_commercial.php";
			$data["content_js"] = "qa_ameridial_healthcare_js.php";
			$data['cci_medicare_id']=$cci_medicare_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_cci_commercial_feedback where id='$cci_medicare_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["cci_commercial"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($cci_medicare_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					//$field_array['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/cci_commercial/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_cci_commercial_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_cci_commercial_feedback',$add_array);

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					//$field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $cci_medicare_id);
					$this->db->update('qa_amd_cci_commercial_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $cci_medicare_id);
					$this->db->update('qa_amd_cci_commercial_feedback',$edit_array);

				}
				redirect('qa_ameridial/cci_commercial');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

 ///////////////////////////////////////////////////////////////////////////////////////////

public function lockheed(){
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/lockheed/feedback_lockheed.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1 order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$from_date = $this->input->get('from_date');
			$to_date = $this->input->get('to_date');
			$agent_id = $this->input->get('agent_id');
			$file = $this->input->get('file');
			$cond="";

			if($from_date==""){
				$from_date=CurrDate();
			}else{
				$from_date = mmddyy2mysql($from_date);
			}

			if($to_date==""){
				$to_date=CurrDate();
			}else{
				$to_date = mmddyy2mysql($to_date);
			}

			if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
			if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
			if($file !="")	$cond .=" and file_no like '%$file%'";

			if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
				$ops_cond="";
			}else{
				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$ops_cond=" Where assigned_to='$current_user'";
				}else{
					$ops_cond="";
				}
			}

		    $qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
				from qa_amd_lockheed_feedback $cond) xx Left Join
				(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
			$data["lockheed"] = $this->Common_model->get_query_result_array($qSql);

			$data["from_date"] = $from_date;
			$data["to_date"] = $to_date;
			$data["agent_id"] = $agent_id;
			$data["file"] = $file;

			$this->load->view("dashboard",$data);
		}
	}


	public function add_edit_lockheed($cci_medicare_id){
		if(check_logged_in())
		{
			$current_user=get_user_id();
			$user_office_id=get_user_office_id();

			$data["aside_template"] = "qa/aside.php";
			$data["content_template"] = "qa_ameridial/lockheed/add_edit_lockheed.php";
			$data["content_js"] = "qa_ameridial_js.php";
			$data['cci_medicare_id']=$cci_medicare_id;
			$tl_mgnt_cond='';

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$tl_mgnt_cond=" and assigned_to='$current_user'";
			}else{
				$tl_mgnt_cond="";
			}

			$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
			$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

			$qSql = "SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_amd_lockheed_feedback where id='$cci_medicare_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
			$data["lockheed"] = $this->Common_model->get_query_row_array($qSql);

			//$currDate=CurrDate();
			$curDateTime=CurrMySqlDate();
			$a = array();


			$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

			if($field_array['agent_id']){

				if($cci_medicare_id==0){

					$field_array=$this->input->post('data');
					$field_array['audit_date']=CurrDate();
					$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
					//$field_array['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$field_array['entry_date']=$curDateTime;
					$field_array['audit_start_time']=$this->input->post('audit_start_time');
					$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/lockheed/');
					$field_array["attach_file"] = implode(',',$a);

					$rowid= data_inserter('qa_amd_lockheed_feedback',$field_array);
				///////////
					if(get_login_type()=="client"){
						$add_array = array("client_entryby" => $current_user);
					}else{
						$add_array = array("entry_by" => $current_user);
					}
					$this->db->where('id', $rowid);
					$this->db->update('qa_amd_lockheed_feedback',$add_array);
					/*******************Fatal Call Email Send functionality added on 12-12-22 START ***********************/
					if($field_array['overall_score'] == 0){
						$tablename = "qa_amd_lockheed_feedback";
						$sql = "SELECT tname.*, ip.email_id_off, ip_tl.email_id_off as tl_email, concat(s.fname, ' ', s.lname) as fullname,
							(SELECT concat(tls.fname, ' ', tls.lname) as tl_fullname FROM signin tls WHERE tls.id=tname.tl_id) as tl_fullname
							FROM $tablename tname
							LEFT JOIN info_personal ip ON ip.user_id=tname.agent_id 
							LEFT JOIN signin s ON s.id=tname.agent_id
							LEFT JOIN signin tl ON tl.id = tname.tl_id
							LEFT JOIN info_personal ip_tl ON ip_tl.user_id = tname.tl_id
							WHERE tname.id=$rowid";
						$result= $this->Common_model->get_query_row_array($sql);				
						$sqlParam ="SELECT process_id,params_columns, fatal_param,param_column_desc FROM qa_defect where table_name='$tablename'"; 
						$resultParams = $this->Common_model->get_query_row_array($sqlParam);
						
						$process = floor($resultParams['process_id']);
						$sqlProcess ="SELECT name FROM process where id='$process'"; 
						$resultProcess = $this->Common_model->get_query_row_array($sqlProcess);
						
						$params = explode(",", $resultParams['params_columns']);
						$fatal_params = explode(",", $resultParams['fatal_param']);
						$descArr = explode(",", $resultParams['param_column_desc']);
						
						$msgTable = "<Table BORDER=1>";
						$msgTable .= "<TR><TH>SL.</TH> <TH>CALL AUDIT PARAMETERS</TH><TH>QA Rating</TH> </TR>";
						
						$i=1;
						$j=0;
						foreach($params as $par){
							//echo $str = str_replace('_', ' ', $par)."<BR>";
							if($result[$par]=='No'){
								$msgTable .= "<TR><TD>".$i."</TD><TD>". $descArr[$j]."</TD> <TD style='color:#FF0000'>".$result[$par]."</TD></TR>";
							}else{
								$msgTable .= "<TR><TD>".$i."</TD><TD>". $descArr[$j]."</TD> <TD>".$result[$par]."</TD></TR>";
							}
							
							$i++;
							$j++;
						}
						///////////////////////////
						//$j=1;
						/* if(!empty($fatal_params)){
							
							foreach($fatal_params as $fatal_par){
								if(!empty($fatal_par)){
								$msgTable .= "<TR><TD>".$i."</TD><TD style='color:#FF0000'>".ucwords( str_replace('_', ' ',$fatal_par))."</TD> <TD>".$result[$fatal_par]."</TD></TR>";
								
								$i++;
								}
							}
						} */
											
						$msgTable .= "<TR><TD colspan='2'>Overall Score</TD> <TD>".$result['overall_score']."%</TD></TR>";					
						$msgTable .= "</Table>";
						
						$eccA=array();
						//$to = $result['tl_email']; // Have to open when email will trigger to the Respective TL of the Agent
						$to = 'acacia.ingle@fusionbposervices.com,sarah.wolf@fusionbposervices.com,tina.church@fusionbposervices.com,amitabh.vartak@fusionbposervices.com,ashish.tere@fusionbposervices.com,Faisal.Anwar@fusionbposervices.com';
						
						$ebody = "Hello ". $result['tl_fullname'].",<br>";
						$ebody .= "<p>Agent Name : ".$result['fullname']."</p>";
						$ebody .= "<p>Phone Number :  ".$result['phone_number']."</p>";
						$ebody .= "<p>Total Talk time : ".$result['call_duration']."</p>";
						$ebody .= "<p>Audit Date time : ".ConvServerToLocal($result['entry_date'])."</p>";
						$ebody .= "<p>Call Summary : ".$result['call_summary']."</p>";
						$ebody .= "<p>Feedback : ".$result['feedback']."</p><br><br>";
						$ebody .= "<p>Please listen the call from the MWP Tool and share feedback acceptancy :</p>";
						$ebody .=  $msgTable;
						$ebody .= "<p>Regards,</p>";
						$ebody .= "<p>MWP Team</p>";
						$esubject = "Fatal Call Alert - "." For Process - ".$resultProcess['name'].", Agent Name - ".$result['fullname']." Audit Date - ".$result['audit_date'];
						
						//echo $ebody;
						//exit;
					
						$eccA[]="Bompalli.Somasundaram@omindtech.com"; 
						$eccA[]="sumitra.bagchi@omindtech.com";
						$eccA[]="deb.dasgupta@omindtech.com";
						$eccA[]="danish.khan@fusionbposervices.com";
						$eccA[]="anshuman.sarkar@fusionbposervices.com";
						
						$ecc = implode(',',$eccA);
						$path = "";
						$from_email="";
						$from_name="";
						
						/* echo $esubject."<br>";
						echo $ebody."<br>";
						exit; */
						
						$send = $this->Email_model->send_email_sox("",$to, $ecc, $ebody, $esubject, $path, $from_email, $from_name, $isBcc="Y");
						unset($eccA);
					}
					
					
					/*******************Fatal Call Email Send functionality added on 12-12-22 END ***********************/

				}else{

					$field_array1=$this->input->post('data');
					$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
					//$field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
					$this->db->where('id', $cci_medicare_id);
					$this->db->update('qa_amd_lockheed_feedback',$field_array1);
				/////////////
					if(get_login_type()=="client"){
						$edit_array = array(
							"client_rvw_by" => $current_user,
							"client_rvw_note" => $this->input->post('note'),
							"client_rvw_date" => $curDateTime
						);
					}else{
						$edit_array = array(
							"mgnt_rvw_by" => $current_user,
							"mgnt_rvw_note" => $this->input->post('note'),
							"mgnt_rvw_date" => $curDateTime
						);
					}
					$this->db->where('id', $cci_medicare_id);
					$this->db->update('qa_amd_lockheed_feedback',$edit_array);

				}
				redirect('qa_ameridial/lockheed');
			}
			$data["array"] = $a;
			$this->load->view("dashboard",$data);
		}
	}

 ///////////////////////////////////////////////////////////////////////////////////////////

 public function conduent(){
	if(check_logged_in())
	{
		$current_user = get_user_id();
		$data["aside_template"] = "qa/aside.php";
		$data["content_template"] = "qa_ameridial/conduent/qa_conduent_feedback.php";
		//$data["content_js"] = "qa_ameridial_js.php";

		$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM signin where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1 order by name";
		$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

		$from_date = $this->input->get('from_date');
		$to_date = $this->input->get('to_date');
		$agent_id = $this->input->get('agent_id');
		$file = $this->input->get('file');
		$cond="";

		if($from_date==""){
			$from_date=CurrDate();
		}else{
			$from_date = mmddyy2mysql($from_date);
		}

		if($to_date==""){
			$to_date=CurrDate();
		}else{
			$to_date = mmddyy2mysql($to_date);
		}

		if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";
		if($agent_id !="")	$cond .=" and agent_id='$agent_id'";
		if($file !="")	$cond .=" and file_no like '%$file%'";

		if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
			$ops_cond="";
		}else{
			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$ops_cond=" Where assigned_to='$current_user'";
			}else{
				$ops_cond="";
			}
		}

		$qSql = "SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_name
			from qa_amd_conduent_feedback $cond) xx Left Join
			(Select id as sid, fname, lname, fusion_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) $ops_cond order by audit_date";
		$data["conduent_data"] = $this->Common_model->get_query_result_array($qSql);

		$data["from_date"] = $from_date;
		$data["to_date"] = $to_date;
		$data["agent_id"] = $agent_id;
		$data["file"] = $file;

		$this->load->view("dashboard",$data);
	}
}


public function add_edit_conduent($conduent_id){
	if(check_logged_in())
	{
		$current_user=get_user_id();
		$user_office_id=get_user_office_id();

		$data["aside_template"] = "qa/aside.php";
		$data["content_template"] = "qa_ameridial/conduent/add_edit_conduent.php";
		//$data["content_js"] = "qa_ameridial_js.php";
		$data['conduent_id']=$conduent_id;
		$tl_mgnt_cond='';

		if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
			$tl_mgnt_cond=" and (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
		}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
			$tl_mgnt_cond=" and assigned_to='$current_user'";
		}else{
			$tl_mgnt_cond="";
		}

		/******** Randamiser Start***********/
			//VIKAS START//
			//Condulent
			$rand_id=0;
			if(!empty($this->uri->segment(4))){
				$rand_id=$this->uri->segment(4);
			}
			$data['rand_id']=$rand_id;
			$data["rand_data"] = "";

			if($rand_id!=0){
				$client_id=133;
				$pro_id = 706;
				$curDateTime=CurrMySqlDate();
				$upArr = array('distribution_opend_by' =>$current_user,'distribution_opened_datetime'=>$curDateTime);
				$this->db->where('id', $rand_id);
				$this->db->update('qa_randamiser_conduent_data',$upArr);
				
				$randSql="Select srd.*,srd.aht as call_duration, S.id as sid, S.fname, S.lname, S.xpoid, S.assigned_to,
				(select concat(fname, ' ', lname) as name from signin s1 where s1.id=S.assigned_to) as tl_name,
				(SELECT r.folder as designation FROM `signin` sd
			LEFT JOIN role r ON sd.role_id=r.id
			where sd.fusion_id=srd.fusion_id) as designation,
				DATEDIFF(CURDATE(), S.doj) as tenure
				from qa_randamiser_conduent_data srd Left Join signin S On srd.fusion_id=S.fusion_id where srd.audit_status=0 and srd.id='$rand_id'";
				$data["rand_data"] = $rand_data =  $this->Common_model->get_query_row_array($randSql);
				
			}
			//VIKAS ENDS//
			/******** Randamiser Ends**********/

		$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client(id,133) and status=1  order by name";
		$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

		$qSql = "SELECT id, fname, lname, fusion_id, office_id FROM signin where role_id in (select id from role where (folder in ('tl','trainer','am','manager')) or (name in ('Client Services'))) and status=1";
		$data['tlname'] = $this->Common_model->get_query_result_array($qSql);

		$qSql = "SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
			from qa_amd_conduent_feedback where id='$conduent_id') xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid)";
		$data["conduent_add"] = $this->Common_model->get_query_row_array($qSql);

		//$currDate=CurrDate();
		$curDateTime=CurrMySqlDate();
		$a = array();


		$field_array['agent_id']=!empty($_POST['data']['agent_id'])?$_POST['data']['agent_id']:"";

		if($field_array['agent_id']){

			if($conduent_id==0){

				$field_array=$this->input->post('data');
				$field_array['audit_date']=CurrDate();
				$field_array['call_date']=mmddyy2mysql($this->input->post('call_date'));
				//$field_array['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
				$field_array['entry_date']=$curDateTime;
				$field_array['audit_start_time']=$this->input->post('audit_start_time');
				$a = $this->amd_upload_files($_FILES['attach_file'], $path='./qa_files/qa_ameridial/conduent/');
				$field_array["attach_file"] = implode(',',$a);

				$rowid= data_inserter('qa_amd_conduent_feedback',$field_array);
			///////////
				if(get_login_type()=="client"){
					$add_array = array("client_entryby" => $current_user);
				}else{
					$add_array = array("entry_by" => $current_user);
				}
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_conduent_feedback',$add_array);
				if($rand_id!=0){
				$rand_cdr_array = array("audit_status" => 1);
				$this->db->where('id', $rand_id);
				$this->db->update('qa_randamiser_conduent_data',$rand_cdr_array);
				
				$rand_array = array("is_rand" => 1);
				$this->db->where('id', $rowid);
				$this->db->update('qa_amd_conduent_feedback',$rand_array);
				}
				/*******************Fatal Call Email Send functionality added on 12-12-22 START ***********************/
					if($field_array['overall_score'] == 0){
						$tablename = "qa_amd_conduent_feedback";
						$sql = "SELECT tname.*, ip.email_id_off, ip_tl.email_id_off as tl_email, concat(s.fname, ' ', s.lname) as fullname,
							(SELECT concat(tls.fname, ' ', tls.lname) as tl_fullname FROM signin tls WHERE tls.id=tname.tl_id) as tl_fullname
							FROM $tablename tname
							LEFT JOIN info_personal ip ON ip.user_id=tname.agent_id 
							LEFT JOIN signin s ON s.id=tname.agent_id
							LEFT JOIN signin tl ON tl.id = tname.tl_id
							LEFT JOIN info_personal ip_tl ON ip_tl.user_id = tname.tl_id
							WHERE tname.id=$rowid";
						$result= $this->Common_model->get_query_row_array($sql);				
						$sqlParam ="SELECT process_id,params_columns, fatal_param,param_column_desc FROM qa_defect where table_name='$tablename'"; 
						$resultParams = $this->Common_model->get_query_row_array($sqlParam);
						
						$process = floor($resultParams['process_id']);
						$sqlProcess ="SELECT name FROM process where id='$process'"; 
						$resultProcess = $this->Common_model->get_query_row_array($sqlProcess);
						
						$params = explode(",", $resultParams['params_columns']);
						$fatal_params = explode(",", $resultParams['fatal_param']);
						$descArr = explode(",", $resultParams['param_column_desc']);
						
						$msgTable = "<Table BORDER=1>";
						$msgTable .= "<TR><TH>SL.</TH> <TH>CALL AUDIT PARAMETERS</TH><TH>QA Rating</TH> </TR>";
						
						$i=1;
						$j=0;
						foreach($params as $par){
							//echo $str = str_replace('_', ' ', $par)."<BR>";
							if($result[$par]=='No'){
								$msgTable .= "<TR><TD>".$i."</TD><TD>". $descArr[$j]."</TD> <TD style='color:#FF0000'>".$result[$par]."</TD></TR>";
							}else{
								$msgTable .= "<TR><TD>".$i."</TD><TD>". $descArr[$j]."</TD> <TD>".$result[$par]."</TD></TR>";
							}
							
							$i++;
							$j++;
						}
						///////////////////////////
						//$j=1;
						/* if(!empty($fatal_params)){
							
							foreach($fatal_params as $fatal_par){
								if(!empty($fatal_par)){
								$msgTable .= "<TR><TD>".$i."</TD><TD style='color:#FF0000'>".$descArr[($j-14)]."</TD> <TD>".$result[$fatal_par]."</TD></TR>";
								
								$i++;
								$j++;
								}
							}
						} */
						
						
						$msgTable .= "<TR><TD colspan='2'>Overall Score</TD> <TD>".$result['overall_score']."%</TD></TR>";
						$msgTable .= "</Table>";
						
						$eccA=array();
						//$to = $result['tl_email']; // Have to open when email will trigger to the Respective TL of the Agent
						$to = 'fallon.stovall@fusionbposervices.com,sarah.wolf@fusionbposervices.com,tina.church@fusionbposervices.com,amitabh.vartak@fusionbposervices.com,ashish.tere@fusionbposervices.com,Faisal.Anwar@fusionbposervices.com';
						
						$ebody = "Hello ". $result['tl_fullname'].",<br>";
						$ebody .= "<p>Agent Name : ".$result['fullname']."</p>";
						$ebody .= "<p>Phone Number :  ".$result['phone_number']."</p>";
						$ebody .= "<p>Total Talk time : ".$result['call_duration']."</p>";
						$ebody .= "<p>Audit Date time : ".ConvServerToLocal($result['entry_date'])."</p>";
						$ebody .= "<p>Call Summary : ".$result['call_summary']."</p>";
						$ebody .= "<p>Feedback : ".$result['feedback']."</p><br><br>";
						$ebody .= "<p>Please listen the call from the MWP Tool and share feedback acceptancy :</p>";
						$ebody .=  $msgTable;
						$ebody .= "<p>Regards,</p>";
						$ebody .= "<p>MWP Team</p>";
						$esubject = "Fatal Call Alert - "." For Process - ".$resultProcess['name'].", Agent Name - ".$result['fullname']." Audit Date - ".$result['audit_date'];
						
						//echo $ebody;
						//exit;
					
						$eccA[]="Bompalli.Somasundaram@omindtech.com";
						$eccA[]="deb.dasgupta@omindtech.com";
						$eccA[]="danish.khan@fusionbposervices.com";
						$eccA[]="sumitra.bagchi@omindtech.com";
						$eccA[]="anshuman.sarkar@fusionbposervices.com";
						$eccA[]="leanna.hayes@fusionbposervices.com";
						
						$ecc = implode(',',$eccA);
						$path = "";
						$from_email="";
						$from_name="";
						
						/* echo $esubject."<br>";
						echo $ebody."<br>";
						exit; */
						
						$send = $this->Email_model->send_email_sox("",$to, $ecc, $ebody, $esubject, $path, $from_email, $from_name, $isBcc="Y");
						unset($eccA);
					}
					
					
					/*******************Fatal Call Email Send functionality added on 12-12-22 END ***********************/

			}else{

				$field_array1=$this->input->post('data');
				$field_array1['call_date']=mmddyy2mysql($this->input->post('call_date'));
				//$field_array1['copy_received']=mmddyy2mysql($this->input->post('copy_received'));
				$this->db->where('id', $conduent_id);
				$this->db->update('qa_amd_conduent_feedback',$field_array1);
			/////////////
				if(get_login_type()=="client"){
					$edit_array = array(
						"client_rvw_by" => $current_user,
						"client_rvw_note" => $this->input->post('note'),
						"client_rvw_date" => $curDateTime
					);
				}else{
					$edit_array = array(
						"mgnt_rvw_by" => $current_user,
						"mgnt_rvw_note" => $this->input->post('note'),
						"mgnt_rvw_date" => $curDateTime
					);
				}
				$this->db->where('id', $conduent_id);
				$this->db->update('qa_amd_conduent_feedback',$edit_array);

			}

			if(isset($rand_data['upload_date']) && !empty($rand_data['upload_date'])){
					$up_date = date('Y-m-d', strtotime($rand_data['upload_date']));
					redirect('Qa_randamiser_vikas/data_distribute_freshdesk?from_date='.$up_date.'&client_id='.$client_id.'&pro_id='.$pro_id.'&submit=Submit');
				}else{
					redirect('qa_ameridial/conduent');
				}
			//redirect('qa_ameridial/conduent');
		}
		$data["array"] = $a;
		$this->load->view("dashboard",$data);
	}
}


/////////////////////////////////////////////////////////////////////////////////////////////


 }
