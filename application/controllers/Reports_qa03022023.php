<?php
 class Reports_qa extends CI_Controller
 {

	public function __construct(){
		parent::__construct();
		$this->load->model('user_model');
		$this->load->model('Common_model');
		$this->load->model('reports_model');
		$this->load->model('Qa_welcomepickup_model');
		$this->load->model('Qa_RPM_Sentry_model');
		$this->load->model('QA_Servicerequest_model');
		$this->load->model('Qa_checkpoint_model');
		$this->load->model('Qa_checkpoint_chat_model');
		$this->load->model('Profile_model');
		$this->load->helper(array('form', 'url'));
		$this->load->model('Qa_verso_model');
		$this->load->model('Dfr_model');
		$this->reports_model->set_report_database("report");
		$this->load->model('Qa_vrs_model');
		$this->load->model('Qa_od_model');
		$this->load->library('excel');
		$this->objPHPExcel = new PHPExcel();
	}


////////////////////////////////////////////// VFS Report////////////////////////////////////////////////////

	public function qa_vfs_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_vfs_report.php";
			$data["content_js"] = "qa_od_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = $this->input->get('campaign');

			$data["qa_vfs_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_vfs_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_vfs_list"] = $fullAray;
				$this->create_qa_vfs_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_vfs_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_vfs_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VFS ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_vfs_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=='chat'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Chat Date", "AHT", "Mission", "Recording ID", "Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Fatal/Non Fatal", "Target", "Total Score", "Overall Score Percentage", "Opening - a)Appropriate greeting as per script", "Technical aspects - a)Response Time", "Technical aspects - b)FCR achieved","Technical aspects - c)Complete and accurate information", "Technical aspects - d)Understand the issue of the applicant", "Technical aspects - e)Attentiveness displayed", "Technical aspects - f)Paraphrasing", "Technical aspects - g)Used all the available resources for providing resolution", "Technical aspects - h)Appropriate Probing", "Additions - a)Offers VAS options wherever applicable", "Additions - b)Awareness created with regards to VFS", "Documentation - a)Correct dispostion", "Documentation - b)Update ASM/V2", "Hold Protocol - a)Was Hold Required", "Hold Protocol - b)Hold Guidelines followed", "Communication - a)Formatting", "Communication - b)Avoid Negative statements", "Communication - c)Telling the customer what to do next", "Communication - d)Avoid Slangs & Jargons", "Communication - e)Correct and accurate grammar usage", "Communication - f)Further assistance", "Chat Closing - a)Adherence to chat closing script", "Fatal Parameter - a)Delayed opening", "Fatal Parameter - b)Rude on chat",  "Fatal Parameter - c)Incomplete Information", "Fatal Parameter - d)Complaint Avoidance","Comments 0","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25", "Reason For Fatal Error", "Inprovement Area", "Chat Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=='call'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "AHT", "Mission", "Recording ID", "Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Fatal/Non Fatal", "Target", "Total Score", "Overall Score Percentage", "Opening - a)Appropriate greeting - as per script & Clear and Crisp opening", "Communication - a)Voice modulation (Maintained proper tone & pitch & volume throughout the call) & Appropriate pace & clarity of speech", "Communication - b)Empathy on call & Personalization / Power words", "Communication - c)Adjusted to customer language & Courteous & Professional", "Communication - d)No jargons - simple words used & Avoid fumbling & fillers", "Communication - e)Active listening / Attentiveness & Paraphrasing & Acknowledgment", "Communication - f)Grammatically correct sentences & Comprehension","Technical aspects - a)Appropriate Probing", "Technical aspects - b)Took ownership to resolve customers concern", "Technical aspects - c)Escalate the issue wherever required", "Technical aspects - d)Call control","Technical aspects - e)Query resolved on call - FTR","Technical aspects - f)Step by step procuedure to resolve the QRC(Query/Request/Complaint)","Value Additons- a)Offers VAS options wherever applicable", "Value Additons - b. Awareness created with regards to VFS website (wherever applicable)", "Documentation - a)Correct dispostion", "Documentation - b)Update ASM V2","Hold Protocol - a)Hold Guidelines followed","Call Closing - a)Further assistance & Adherence to call closing script", "Call Closing - b)Attempt to take feedback on experience CSAT","Fatal Parameter - a)Delayed opening", "Fatal Parameter - b)Rude on chat", "Fatal Parameter - c)Incomplete/Inaccurate Information shared", "Fatal Parameter - d)Complaint Avoidance","Comments 0","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Disposition","Communication mode through which customer contacted previously","Description of Disposition selected","Was this the first time customer called us?","Did the customer call us more than once but less than 3 times?","Did the customer call us more than 3 times?","Reason For Fatal Error", "Improvement Area", "Call Summary", "Feedback","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=='email'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Email Date", "AHT", "Mission", "Recording ID", "Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Fatal/Non Fatal", "Target", "Total Score", "Overall Score Percentage", "Content Writing - a)Used one idea per paragraph", "Content Writing - b)Used bullet points where appropriate", "Content Writing - c)Simple & definite statements", "Content Writing - d)Template Adherence where applicable", "Accuracy follow up - a)Interim response provided", "Accuracy follow up - b)FCR achieved","Accuracy follow up - c)Complete and accurate information","Accuracy follow up - d)Understand the issue of the customer", "Accuracy follow up - e)Attentiveness displayed", "Accuracy follow up - f)Used all the available resources for providing resolution", "Accuracy follow up - g)Standardized subject line on trail mails", "Additions - a)Offers VAS options wherever applicable", "Additions - b)Awareness created with regards to VFS website", "Documentation - a)Correct dispostion", "Documentation - b)Update ASM V2", "Composition - a)Formatting", "Composition - b)Shows respect and makes the customer feel valued", "Composition - c)Telling the customer what to do next", "Composition - d)Avoid Slangs & Jargons", "Composition - e)Correct and accurate grammar usage", "Composition - f)Correct closing", "Composition - g)Further assistance", "Fatal Parameter - a)Rude or unprofessional on email", "Fatal Parameter - b)Incomplete", "Fatal Parameter - c)Email hygiene", "Fatal Parameter - d)Complaint Avoidance","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25","Disposition","Communication mode through which customer contacted previously","Description of Disposition selected","Was this the first time customer called us?","Did the customer call us more than once but less than 3 times?","Did the customer call us more than 3 times?","Reason For Fatal Error", "Improvement Area", "Email Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($pid=="bluebenefits"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "QA Score",
      "Did the rep greet the customer promptly and properly?",
      "Did the rep use a pleasant respectful tone?",
      "Did the rep correctly verify the callers info prior to proceeding with the call? ",
      "Did the rep offer a willingness statement? I d be happy to help you with that etc",
      "Did the rep display a professional manner and refrain from speaking over or interrupting the caller?",

      "Did the rep have any incomplete provider info?",
      "Did the rep incorrectly quote any benefits? ",
      "Did the rep incorrectly quote any copay or coinsurance? Or did they miss the coinsurance copay?",
      "Did the rep incorrectly give CR RC MAB RAA CY or PY?",
      "Did the rep incorrectly quote the deductible?",
      "Did the rep give any other incorrect information or miss any of the following regarding plan Effective Date Frequency Limitation Network OOP Max Precert Pre-X Term Date",
      "Did the rep provide the correct Claims Address when necessary?",
      "Did the rep include all information necessary regarding Medical Necessity?",
      "Did the rep include all details correctly regarding DME coverage when necessary?",


      "Did the agent speak clearly concisely and at an appropriate pace?",
      "Did the agent avoid use of internal terms technical terms slang and jargon on the call and in email?",
      "Did the agent demonstrate a strong use of empathy in responses where required on the call and in email?",
      "Did the agent use please and thank you throughout the call and in email communication?",
      "Did the agent minimize extended silences throughout the call?",
      "Did the agent speak with sincere warmth in his her voice?",
      "Did the agent use correct sentence structure and grammar in email commumnication?",
      "Did the agent demonstrate patience with the caller on call and in email communication?",

      "Did the rep accurately and completely document the call?",
      "Did the rep complete the correct confirmation and closing?",
      "Did the rep thank the caller before closing?",
      "Did the rep do everything possible to assist the caller?",
      "Did the rep anticipate the callers needs?to avoid unecessary callbacks or confusion",


       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Comment 20",
       "Comment 21",
       "Comment 22",
       "Comment 23",
       "Comment 24",
       "Comment 25",
       "Comment 26",
       "Comment 27",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='chat'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['mission'].'",';
				$row .= '"'.$user['recording_id'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['autofail_status'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['appropiate_greeting'].'",';
				$row .= '"'.$user['response_time'].'",';
				$row .= '"'.$user['FCR_achieved'].'",';
				$row .= '"'.$user['accurate_information'].'",';
				$row .= '"'.$user['understand_issue'].'",';
				$row .= '"'.$user['attentiveness_display'].'",';
				$row .= '"'.$user['paraphrasing'].'",';
				$row .= '"'.$user['use_available_resource'].'",';
				$row .= '"'.$user['appropiate_probing'].'",';
				$row .= '"'.$user['VAS_options'].'",';
				$row .= '"'.$user['awareness_created'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['update_ASM'].'",';
				$row .= '"'.$user['hold_required'].'",';
				$row .= '"'.$user['hold_guidelines'].'",';
				$row .= '"'.$user['formatting'].'",';
				$row .= '"'.$user['avoid_negative_statement'].'",';
				$row .= '"'.$user['procedure_guide_step'].'",';
				$row .= '"'.$user['avoid_slangs'].'",';
				$row .= '"'.$user['correct_grammar_use'].'",';
				$row .= '"'.$user['further_assistance'].'",';
				$row .= '"'.$user['chat_adherence'].'",';
				$row .= '"'.$user['delayed_opening'].'",';
				$row .= '"'.$user['rude_on_chat'].'",';
				$row .= '"'.$user['inacurate_information'].'",';
				$row .= '"'.$user['complaint_avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm0'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_fatal'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['inprovement_area'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}if($campaign=='call'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['mission'].'",';
				$row .= '"'.$user['recording_id'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['autofail_status'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['appropiate_greeting'].'",';
				$row .= '"'.$user['voice_modulation'].'",';
				$row .= '"'.$user['call_empathy'].'",';
				$row .= '"'.$user['adjust_customer_language'].'",';
				$row .= '"'.$user['simple_word_used'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['avoid_fumbling'].'",';
				$row .= '"'.$user['appropiate_probing'].'",';
				$row .= '"'.$user['ownership_resolve'].'",';
				$row .= '"'.$user['escalate_issue'].'",';
				$row .= '"'.$user['call_control'].'",';
				$row .= '"'.$user['query_resolved'].'",';
				$row .= '"'.$user['procuedure_request'].'",';
				$row .= '"'.$user['offers_VAS'].'",';
				$row .= '"'.$user['awareness_created'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['update_ASM'].'",';
				$row .= '"'.$user['hold_required'].'",';
				$row .= '"'.$user['further_assistance'].'",';
				$row .= '"'.$user['CSAT_experience_feedback'].'",';

				$row .= '"'.$user['delayed_opening'].'",';
				$row .= '"'.$user['rude_on_call'].'",';
				$row .= '"'.$user['incomplete_information'].'",';
				$row .= '"'.$user['complaint_avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm0'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['disposition'])).'",';
				$row .= '"'.$user['contacted_previously'].'",';
				$row .= '"'.$user['disposition_selected'].'",';
				$row .= '"'.$user['customer_called_first'].'",';
				$row .= '"'.$user['customer_called_less_three'].'",';
				$row .= '"'.$user['customer_called_more_three'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_fatal'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['inprovement_area'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}if($campaign=='email'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['mission'].'",';
				$row .= '"'.$user['recording_id'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['autofail_status'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['use_paragraph_idea'].'",';
				$row .= '"'.$user['use_bullet_point'].'",';
				$row .= '"'.$user['adhered_word_limit'].'",';
				$row .= '"'.$user['template_adherence'].'",';
				$row .= '"'.$user['interim_responce'].'",';
				$row .= '"'.$user['FCR_achieved'].'",';
				$row .= '"'.$user['complete_information'].'",';
				$row .= '"'.$user['understand_issue'].'",';
				$row .= '"'.$user['attentiveness_display'].'",';
				$row .= '"'.$user['use_available_resource'].'",';
				$row .= '"'.$user['standardized_subject'].'",';
				$row .= '"'.$user['VAS_option'].'",';
				$row .= '"'.$user['awarreness_created'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['update_ASM'].'",';
				$row .= '"'.$user['formatting'].'",';
				$row .= '"'.$user['show_customer_feel_value'].'",';
				$row .= '"'.$user['procedure_guide_step'].'",';
				$row .= '"'.$user['avoid_slangs'].'",';
				$row .= '"'.$user['correct_grammar_use'].'",';
				$row .= '"'.$user['correct_closing'].'",';
				$row .= '"'.$user['further_assistance'].'",';
				$row .= '"'.$user['rude_on_email'].'",';
				$row .= '"'.$user['inacurate_information'].'",';
				$row .= '"'.$user['email_hygiene'].'",';
				$row .= '"'.$user['complaint_avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['disposition'])).'",';
				$row .= '"'.$user['contacted_previously'].'",';
				$row .= '"'.$user['disposition_selected'].'",';
				$row .= '"'.$user['customer_called_first'].'",';
				$row .= '"'.$user['customer_called_less_three'].'",';
				$row .= '"'.$user['customer_called_more_three'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_fatal'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['inprovement_area'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}

	}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////// Biomet Report //////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
		public function qa_biomet_report(){
			if(check_logged_in()){
				$user_office_id=get_user_office_id();
				$current_user = get_user_id();
				$is_global_access=get_global_access();
				$role_dir=get_role_dir();
				$data["show_download"] = false;
				$data["download_link"] = "";
				$data["show_table"] = false;
				$data["show_table"] = false;
				$data["aside_template"] = "reports/aside.php";
				$data["content_template"] = "reports_qa/qa_biomet_report.php";
				$data["content_js"] = "qa_biomet_js.php";

				$data['location_list'] = $this->Common_model->get_office_location_list();

				$office_id = "";
				$date_from="";
				$date_to="";
				$campaign="";
				$action="";
				$dn_link="";
				$cond="";
				$cond1="";

				$campaign = $this->input->get('campaign');

				$data["qa_biomet_list"] = array();

				if($this->input->get('show')=='Show')
				{
					$date_from = mmddyy2mysql($this->input->get('date_from'));
					$date_to = mmddyy2mysql($this->input->get('date_to'));
					$office_id = $this->input->get('office_id');

					if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
					}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
						$cond1 .=" And assigned_to='$current_user'";
					}else{
						$cond1 .="";
					}

					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_biomet_".$campaign."_feedback) xx Left Join
					(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_biomet_list"] = $fullAray;
					$this->create_qa_biomet_CSV($fullAray,$campaign);
					$dn_link = base_url()."reports_qa/download_qa_biomet_CSV/".$campaign;
				}

				$data['download_link']=$dn_link;
				$data["action"] = $action;
				$data['date_from'] = $date_from;
				$data['date_to'] = $date_to;
				$data['office_id']=$office_id;
				$data['campaign']=$campaign;

				$this->load->view('dashboard',$data);
			}
		}


		public function download_qa_biomet_CSV($campaign)
		{
			$currDate=date("Y-m-d");
			$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
			$newfile="QA biomet ".$campaign." Audit List-'".$currDate."'.csv";
			header('Content-Disposition: attachment;  filename="'.$newfile.'"');
			readfile($filename);
		}


		public function create_qa_biomet_CSV($rr,$campaign)
		{
			$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
			$currentURL = base_url();
			$controller = "Qa_biomet";

			$fopen = fopen($filename,"w+");

			if($campaign=='chat'){
				$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Chat Date", "AHT", "Mission", "Recording ID", "Week", "Audit Type", "VOC","Audit Link", "Audit Date Time", "Interval(In Second)", "Overall Score", "Opening - a)Appropriate greeting as per script", "Technical aspects - a)Response Time", "Technical aspects - b)FCR achieved", "Technical aspects - c)Understand the issue of the applicant", "Technical aspects - d)Attentiveness displayed", "Technical aspects - e)Paraphrasing", "Technical aspects - f)Used all the available resources for providing resolution", "Technical aspects - g)Appropriate Probing", "Additions - a)Offers VAS options wherever applicable", "Additions - b)Awareness created with regards to VFS", "Documentation - a)Correct dispostion", "Documentation - b)Correct disposition sub-type","Documentation - c)Captured response query precisely", "Hold Protocol - a)Was Hold Required", "Hold Protocol - b)Hold Guidelines followed", "Communication - a)Formatting", "Communication - b)Avoid Negative statements", "Communication - c)Telling the customer what to do next", "Communication - d)Avoid Slangs & Jargons", "Communication - e)Correct and accurate grammar usage", "Communication - f)Further assistance", "Chat Closing - a)Adherence to chat closing script", "Fatal Parameter - a)Delayed opening", "Fatal Parameter - b)Rude on chat",  "Fatal Parameter - c)Incomplete Information", "Fatal Parameter - d)Complaint Avoidance", "Reason For Fatal Error", "Improvement Area", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			}else if($campaign=='call'){
				$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Chat Date", "AHT", "Mission", "Recording ID", "Week", "Audit Type", "VOC","Audit Link", "Audit Date Time", "Interval(In Second)", "Overall Score", "Opening - a)Appropriate greeting as per script", "Opening - b)Clear and Crisp opening", "Communication - a)Voice modulation", "Communication - b)Appropriate pace", "Communication - c)Courteous and professional", "Communication - d)Empathy on call", "Communication - e)Adjusted to customer language", "Communication - f)No jargons simple words used", "Communication - g)Active listening", "Communication - h)Paraprashing", "Communication - i)Grammatically correct sentences", "Technical aspects - a)Appropriate Probing", "Technical aspects - b)Escalate the issue wherever required", "Technical aspects - c)Call control", "Technical aspects - d)Query resolved on call FTR", "Additons - a)Offers VAS options wherever applicable", "Additons - b. Awareness created with regards to VFS", "Documentation - a)Correct dispostion", "Documentation - b)Correct disposition sub-type","Documentation - c)Captured response query precisely", "Hold Protocol - a)Was Hold Required", "Hold Protocol - b)Hold Guidelines followed", "Hold Protocol - c)Dead Air <= 8 seconds", "Call Closing - a)Further assistance", "Call Closing - b)Attempt to take feedback on experience CSAT", "Call Closing - c)Adherence to call closing script", "Fatal Parameter - a)Delayed opening", "Fatal Parameter - b)Rude on chat", "Fatal Parameter - c)Incomplete/Inaccurate Information shared", "Fatal Parameter - d)Complaint Avoidance", "Reason For Fatal Error", "Improvement Area", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			}else if($campaign=='email'){
				$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Chat Date", "AHT", "Mission", "Recording ID", "Week", "Audit Type", "VOC","Audit Link", "Audit Date Time", "Interval(In Second)", "Overall Score", "Content Writing - a)a. Used one idea per paragraph", "Content Writing - b)Used bullet points where appropriate", "Content Writing - c)Adhered word limit per sentence", "Content Writing - d)Template Adherence where applicable", "Accuracy follow up - a)Interim response provided", "Accuracy follow up - b)FCR achieved", "Accuracy follow up - c)Understand the issue of the applicant", "Accuracy follow up - d)Attentiveness displayed", "Accuracy follow up - e)Used all the available resources for providing resolution", "Accuracy follow up - f)Standardized subject line on trail mails", "Additions - a)Offers VAS options wherever applicable", "Additions - b)Awareness created with regards to VFS website", "Documentation - a)Correct dispostion", "Documentation - b)Correct disposition sub-type","Documentation - c)Captured response query precisely", "Composition - a)Formatting", "Composition - b)Shows respect and makes the customer feel valued", "Composition - c)Telling the customer what to do next", "Composition - d)Avoid Slangs & Jargons", "Composition - e)Correct and accurate grammar usage", "Composition - f)Correct closing", "Fatal Parameter - a)Rude or unprofessional on email", "Fatal Parameter - b)Incomplete", "Fatal Parameter - c)Email hygiene", "Fatal Parameter - d)Complaint Avoidance", "Reason For Fatal Error", "Improvement Area", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			}

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			if($campaign=='chat'){
				$edit_url = "add_edit_biomet_chat";
				$main_url =  $currentURL.''.$controller.'/'.$edit_url;

				foreach($rr as $user){
					if($user['entry_by']!=''){
						$auditorName = $user['auditor_name'];
					}else{
						$auditorName = $user['client_name'];
					}

					if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
						$interval1 = '---';
					}else{
						$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
					}
					$main_urls = $main_url.'/'.$user['id'];

					$row = '"'.$auditorName.'",';
					$row .= '"'.$user['audit_date'].'",';
					$row .= '"'.$user['fusion_id'].'",';
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
					$row .= '"'.$user['tl_name'].'",';
					$row .= '"'.$user['call_date'].'",';
					$row .= '"'.$user['call_duration'].'",';
					$row .= '"'.$user['mission'].'",';
					$row .= '"'.$user['recording_id'].'",';
					$row .= '"'.$user['week'].'",';
					$row .= '"'.$user['audit_type'].'",';
					$row .= '"'.$user['voc'].'",';
					$row .= '"'.$main_urls.'",';
					// $row .= '"'.$user['audit_start_time'].'",';
					$row .= '"'.$user['entry_date'].'",';
					$row .= '"'.$interval1.'",';
					$row .= '"'.$user['overall_score'].'%'.'",';
					$row .= '"'.$user['appropiate_greeting'].'",';
					$row .= '"'.$user['response_time'].'",';
					$row .= '"'.$user['FCR_achieved'].'",';
					$row .= '"'.$user['understand_issue'].'",';
					$row .= '"'.$user['attentiveness_display'].'",';
					$row .= '"'.$user['paraphrasing'].'",';
					$row .= '"'.$user['use_available_resource'].'",';
					$row .= '"'.$user['appropiate_probing'].'",';
					$row .= '"'.$user['VAS_options'].'",';
					$row .= '"'.$user['awareness_created'].'",';
					$row .= '"'.$user['correct_disposition'].'",';
					$row .= '"'.$user['update_ASM'].'",';
					$row .= '"'.$user['capture_query'].'",';
					$row .= '"'.$user['hold_required'].'",';
					$row .= '"'.$user['hold_guidelines'].'",';
					$row .= '"'.$user['formatting'].'",';
					$row .= '"'.$user['avoid_negative_statement'].'",';
					$row .= '"'.$user['procedure_guide_step'].'",';
					$row .= '"'.$user['avoid_slangs'].'",';
					$row .= '"'.$user['correct_grammar_use'].'",';
					$row .= '"'.$user['further_assistance'].'",';
					$row .= '"'.$user['chat_adherence'].'",';

					$row .= '"'.$user['delayed_opening'].'",';
					$row .= '"'.$user['rude_on_chat'].'",';
					$row .= '"'.$user['inacurate_information'].'",';
					$row .= '"'.$user['complaint_avoidance'].'",';

					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_fatal'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['improvement_area'])).'",';

					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
					$row .= '"'.$user['agent_rvw_date'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
					$row .= '"'.$user['mgnt_rvw_date'].'",';
					$row .= '"'.$user['mgnt_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
					$row .= '"'.$user['client_rvw_date'].'",';
					$row .= '"'.$user['client_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
					fwrite($fopen,$row."\r\n");
				}
				fclose($fopen);

			}if($campaign=='call'){
				$edit_url = "add_edit_biomet_call";
				$main_url =  $currentURL.''.$controller.'/'.$edit_url;

				foreach($rr as $user){
					if($user['entry_by']!=''){
						$auditorName = $user['auditor_name'];
					}else{
						$auditorName = $user['client_name'];
					}

					if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
						$interval1 = '---';
					}else{
						$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
					}
					$main_urls = $main_url.'/'.$user['id'];

					$row = '"'.$auditorName.'",';
					$row .= '"'.$user['audit_date'].'",';
					$row .= '"'.$user['fusion_id'].'",';
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
					$row .= '"'.$user['tl_name'].'",';
					$row .= '"'.$user['call_date'].'",';
					$row .= '"'.$user['call_duration'].'",';
					$row .= '"'.$user['mission'].'",';
					$row .= '"'.$user['recording_id'].'",';
					$row .= '"'.$user['week'].'",';
					$row .= '"'.$user['audit_type'].'",';
					$row .= '"'.$user['voc'].'",';
					$row .= '"'.$main_urls.'",';
					// $row .= '"'.$user['audit_start_time'].'",';
					$row .= '"'.$user['entry_date'].'",';
					$row .= '"'.$interval1.'",';
					$row .= '"'.$user['overall_score'].'%'.'",';
					$row .= '"'.$user['appropiate_greeting'].'",';
					$row .= '"'.$user['clear_opening'].'",';
					$row .= '"'.$user['voice_modulation'].'",';
					$row .= '"'.$user['appropiate_pace'].'",';
					$row .= '"'.$user['professional_courteous'].'",';
					$row .= '"'.$user['call_empathy'].'",';
					$row .= '"'.$user['adjust_customer_language'].'",';
					$row .= '"'.$user['simple_word_used'].'",';
					$row .= '"'.$user['active_listening'].'",';
					$row .= '"'.$user['paraprasing'].'",';
					$row .= '"'.$user['avoid_fumbling'].'",';
					$row .= '"'.$user['appropiate_probing'].'",';
					$row .= '"'.$user['escalate_issue'].'",';
					$row .= '"'.$user['call_control'].'",';
					$row .= '"'.$user['query_resolved'].'",';
					$row .= '"'.$user['offers_VAS'].'",';
					$row .= '"'.$user['awareness_created'].'",';
					$row .= '"'.$user['correct_disposition'].'",';
					$row .= '"'.$user['update_ASM'].'",';
					$row .= '"'.$user['capture_query'].'",';
					$row .= '"'.$user['hold_required'].'",';
					$row .= '"'.$user['hold_guidelines'].'",';
					$row .= '"'.$user['dead_air_8sec'].'",';
					$row .= '"'.$user['further_assistance'].'",';
					$row .= '"'.$user['CSAT_experience_feedback'].'",';
					$row .= '"'.$user['call_adherence'].'",';

					$row .= '"'.$user['delayed_opening'].'",';
					$row .= '"'.$user['rude_on_call'].'",';
					$row .= '"'.$user['incomplete_information'].'",';
					$row .= '"'.$user['complaint_avoidance'].'",';

					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_fatal'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['improvement_area'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
					$row .= '"'.$user['agent_rvw_date'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
					$row .= '"'.$user['mgnt_rvw_date'].'",';
					$row .= '"'.$user['mgnt_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
					$row .= '"'.$user['client_rvw_date'].'",';
					$row .= '"'.$user['client_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
					fwrite($fopen,$row."\r\n");
				}
				fclose($fopen);

			}if($campaign=='email'){
				$edit_url = "add_edit_biomet_email";
				$main_url =  $currentURL.''.$controller.'/'.$edit_url;
				foreach($rr as $user){
					if($user['entry_by']!=''){
						$auditorName = $user['auditor_name'];
					}else{
						$auditorName = $user['client_name'];
					}

					if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
						$interval1 = '---';
					}else{
						$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
					}
					$main_urls = $main_url.'/'.$user['id'];
					$row = '"'.$auditorName.'",';
					$row .= '"'.$user['audit_date'].'",';
					$row .= '"'.$user['fusion_id'].'",';
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
					$row .= '"'.$user['tl_name'].'",';
					$row .= '"'.$user['call_date'].'",';
					$row .= '"'.$user['call_duration'].'",';
					$row .= '"'.$user['mission'].'",';
					$row .= '"'.$user['recording_id'].'",';
					$row .= '"'.$user['week'].'",';
					$row .= '"'.$user['audit_type'].'",';
					$row .= '"'.$user['voc'].'",';
					$row .= '"'.$main_urls.'",';
					// $row .= '"'.$user['audit_start_time'].'",';
					$row .= '"'.$user['entry_date'].'",';
					$row .= '"'.$interval1.'",';
					$row .= '"'.$user['overall_score'].'%'.'",';
					$row .= '"'.$user['use_paragraph_idea'].'",';
					$row .= '"'.$user['use_bullet_point'].'",';
					$row .= '"'.$user['adhered_word_limit'].'",';
					$row .= '"'.$user['template_adherence'].'",';
					$row .= '"'.$user['interim_responce'].'",';
					$row .= '"'.$user['FCR_achieved'].'",';
					$row .= '"'.$user['understand_issue'].'",';
					$row .= '"'.$user['attentiveness_display'].'",';
					$row .= '"'.$user['use_available_resource'].'",';
					$row .= '"'.$user['standardized_subject'].'",';
					$row .= '"'.$user['VAS_option'].'",';
					$row .= '"'.$user['awarreness_created'].'",';
					$row .= '"'.$user['correct_disposition'].'",';
					$row .= '"'.$user['update_ASM'].'",';
					$row .= '"'.$user['capture_query'].'",';
					$row .= '"'.$user['formatting'].'",';
					$row .= '"'.$user['show_customer_feel_value'].'",';
					$row .= '"'.$user['procedure_guide_step'].'",';
					$row .= '"'.$user['avoid_slangs'].'",';
					$row .= '"'.$user['correct_grammar_use'].'",';
					$row .= '"'.$user['correct_closing'].'",';
					// $row .= '"'.$user['further_assistance'].'",';

					$row .= '"'.$user['rude_on_email'].'",';
					$row .= '"'.$user['inacurate_information'].'",';
					$row .= '"'.$user['email_hygiene'].'",';
					$row .= '"'.$user['complaint_avoidance'].'",';

					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_fatal'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['improvement_area'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
					$row .= '"'.$user['agent_rvw_date'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
					$row .= '"'.$user['mgnt_rvw_date'].'",';
					$row .= '"'.$user['mgnt_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
					$row .= '"'.$user['client_rvw_date'].'",';
					$row .= '"'.$user['client_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
					fwrite($fopen,$row."\r\n");
				}
				fclose($fopen);

			}

		}




/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////// QA HElpdesk ////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

public function qa_it_helpdesk_feedback_report(){
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_it_helpdesk_feedback_report.php";
		$data["content_js"] = "qa_biomet_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		$data["qa_it_helpdesk_feedback_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_it_helpdesk_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_it_helpdesk_feedback_list"] = $fullAray;
			$this->create_qa_it_helpdesk_feedback_CSV($fullAray);
			$dn_link = base_url()."reports_qa/download_qa_it_helpdesk_feedback_CSV";
		}

		$data['download_link']=$dn_link;
		$data["action"] = $action;
		$data['date_from'] = $date_from;
		$data['date_to'] = $date_to;
		$data['office_id']=$office_id;

		$this->load->view('dashboard',$data);
	}
}


public function download_qa_it_helpdesk_feedback_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA IT HELPDESK Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}


public function create_qa_it_helpdesk_feedback_CSV($rr)
{
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Ticket Date", "Ticket Category", "Audit Type", "VOC", "Entry Date Time", "Overall Score", "Initial Responce", "Communication/Formation", "probing", "Assistance Enthusiasmt", "Identification of Issue", "Documentation", "Ownership", "Escalationt", "Knowledge", "Verbiage", "On call resolution/Proper Assistance", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

	$row = "";
	foreach($header as $data) $row .= ''.$data.',';
	fwrite($fopen,rtrim($row,",")."\r\n");
	$searches = array("\r", "\n", "\r\n");

	foreach($rr as $user){
		if($user['entry_by']!=''){
			$auditorName = $user['auditor_name'];
		}else{
			$auditorName = $user['client_name'];
		}


		$row = '"'.$auditorName.'",';
		$row .= '"'.$user['audit_date'].'",';
		$row .= '"'.$user['fusion_id'].'",';
		$row .= '"'.$user['fname']." ".$user['lname'].'",';
		$row .= '"'.$user['tl_name'].'",';
		$row .= '"'.$user['ticket_date'].'",';
		$row .= '"'.$user['ticket_category'].'",';
		$row .= '"'.$user['audit_type'].'",';
		$row .= '"'.$user['voc'].'",';
		$row .= '"'.$user['entry_date'].'",';
		$row .= '"'.$user['overall_score'].'%'.'",';
		$row .= '"'.$user['initial_responce'].'",';
		$row .= '"'.$user['communication'].'",';
		$row .= '"'.$user['probing'].'",';
		$row .= '"'.$user['assistance_enthusiasm'].'",';
		$row .= '"'.$user['issue_identification'].'",';
		$row .= '"'.$user['documentation'].'",';
		$row .= '"'.$user['ownership'].'",';
		$row .= '"'.$user['escalation'].'",';
		$row .= '"'.$user['knowledge'].'",';
		$row .= '"'.$user['verbiage'].'",';
		$row .= '"'.$user['on_call_resolution'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
		$row .= '"'.$user['agent_rvw_date'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
		$row .= '"'.$user['mgnt_rvw_date'].'",';
		$row .= '"'.$user['mgnt_rvw_name'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
		$row .= '"'.$user['client_rvw_date'].'",';
		$row .= '"'.$user['client_rvw_name'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
		fwrite($fopen,$row."\r\n");
	}
	fclose($fopen);

}




/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////// QA SENSIO REPORT ////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_sensio_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_sensio_report.php";
			$data["content_js"] = "qa_metropolis_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_sensio_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_sensio_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_sensio_list"] = $fullAray;
				$this->create_qa_sensio_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_sensio_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_sensio_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Sensio Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_sensio_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call ID", "Call Duration", "Call Type", "Can be Automated", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Scripted Opening", "Answered Call within 20 Seconds", "Active Listening", "Acknowledgement", "Grammar and Pronounciation", "Appropriate Speech", "Easy to Understand", "Correct Use of Phonetics", "Did the Agent Properly Educate the Customer?", "Ownership", "Polite", "Empathy/Assurance", "Hold", "Offer of Additional Assistance", "Scripted Close","Rude Remarks","Call Avoidance", "OPENING Remarks 1", "OPENING Remarks 2", "LISTENING SKILLS Remarks 1", "LISTENING SKILLS Remarks 2", "COMMUNICATION SKILLS Remarks 1", "COMMUNICATION SKILLS Remarks 2", "COMMUNICATION SKILLS Remarks 3", "COMMUNICATION SKILLS Remarks 4", "EDUCATION Remarks", "CUSTOMER SERVICE Remarks 1", "CUSTOMER SERVICE Remarks 2", "CUSTOMER SERVICE Remarks 3", "CUSTOMER SERVICE Remarks 4", "CLOSING Remarks 1", "CLOSING Remarks 2","OTHER Remarks 1","OTHER Remarks 2", "Customer score","Business Score","Compliance Score","Call Summary", "Feedback", "Agent Review Date","Agent Acceptance", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['can_automated'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['script_openning'].'",';
			$row .= '"'.$user['call_answer_20sec'].'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'.$user['acknowledgement'].'",';
			$row .= '"'.$user['grammar_pronounciation'].'",';
			$row .= '"'.$user['appropiate_speech'].'",';
			$row .= '"'.$user['easy_to_understand'].'",';
			$row .= '"'.$user['correct_use_phonetics'].'",';
			$row .= '"'.$user['properly_educate_customer'].'",';
			$row .= '"'.$user['ownership'].'",';
			$row .= '"'.$user['polite'].'",';
			$row .= '"'.$user['empathy_assurance'].'",';
			$row .= '"'.$user['hold'].'",';
			$row .= '"'.$user['additional_assistance'].'",';
			$row .= '"'.$user['script_close'].'",';
			$row .= '"'.$user['rude_behaviour'].'",';
			$row .= '"'.$user['call_avoidance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'.$user['customer_score'].'%'.'",';
			$row .= '"'.$user['business_score'].'%'.'",';
			$row .= '"'.$user['compliance_score'].'%'.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}


///////////////////////////////////////////////////////////////////////////////////////

	public function qa_safe_eco_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_safe_eco_report.php";
			$data["content_js"] = "qa_metropolis_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_sensio_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_safe_eco_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_sensio_list"] = $fullAray;
				$this->create_qa_safe_eco_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_safe_eco_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_safe_eco_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Safe Eco Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_safe_eco_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array( "Auditor Name","Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "QA Score",
      // "Business Score",
      // "Customer Score",
      // "Compliance Score",
      "Se prsente selon la charte d'accueil",
      "Demande et obtient l'interlocuteur cible-Identification du dcisionnaire",
      "Prsente l'objet de l'appel d'une manire claire",
      "Presentation de l'offre et mise en avant de ses avantages",
      "Adapte son vocabulaire  celui de l'interlocuteur",
      "Argumente de faon professionnelle",
      "Maitrise l'offre et Pose les bonnes questions",
      "Reformule pour aider la comprhension",
      "Reformule pour valider",
      "Accueille l'objection et reste calme",
      "Rassure le client et traite l'objection",
      "Gre les blancs et les interruptions",
      "Rcapitule les points clfs et valide l'entretien",
      "S'assure de l'accord et de la Qt 'PM & Ar)",
      "Prend cong par une formule de politesse",
      "coute activen  attentive",
      "Ton sourire dbit de voix correct",
      "Amabilit ",
      "Aisance de l'expression  locution  Vocabulaire ",
      "Drictivit ",
      "Mise en attente ",
      "Qualifie le fichier ",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				// $row .= '"'.$user['business_score'].'%'.'",';
				// $row .= '"'.$user['customer_score'].'%'.'",';
				// $row .= '"'.$user['compliance_score'].'%'.'",';
				$row .= '"'.$user['daccueil'].'",';
				$row .= '"'.$user['decisionnaire'].'",';
				$row .= '"'.$user['claire'].'",';
				$row .= '"'.$user['avantages'].'",';
				$row .= '"'.$user['linterlocuteur'].'",';
				$row .= '"'.$user['professionnelle'].'",';
				$row .= '"'.$user['questions'].'",';
				$row .= '"'.$user['comprehension'].'",';
				$row .= '"'.$user['valider'].'",';
				$row .= '"'.$user['calme'].'",';
				$row .= '"'.$user['lobjection'].'",';
				$row .= '"'.$user['interruptions'].'",';
				$row .= '"'.$user['lentretien'].'",';
				$row .= '"'.$user['Sassure'].'",';
				$row .= '"'.$user['politesse'].'",';
				$row .= '"'.$user['attentive'].'",';
				$row .= '"'.$user['correct'].'",';
				$row .= '"'.$user['Amabilite'].'",';
				$row .= '"'.$user['Vocabulaire'].'",';
				$row .= '"'.$user['Derictivite'].'",';
				$row .= '"'.$user['attente'].'",';
				$row .= '"'.$user['fichier'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}

	//////////////////////////////////////////////////////////////////////////////////////////////////


	///////////////////////////////////////////////////////////////////////////////////////

	public function qa_cloudflare_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_cloudflare_report.php";
			$data["content_js"] = "qa_metropolis_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_sensio_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_cloudflare_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_sensio_list"] = $fullAray;
				$this->create_qa_cloudflare_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_cloudflare_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_cloudflare_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Cloudflare Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_cloudflare_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array( "Auditor Name","Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "File No",
      "Dispositons",
      "Incorrect Disposition",
      "Correct Disposition by QA",
      "Interaction ID",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "QA Score",
      "Agent open the call with good tone and friendly attitude",
      "Acknowledgement of caller needs",
      "Agent took Customer Information Properly and confirmed the same.",
      "Agent took Comapny information properly and confirm caller's position on the same.",
      "Agent informed to the caller that case will be followed up in the available hours?",
      "Agent provided correct website information based on customer need",
      "Empathy and rapport applied on the call",
      "Agent shared good tone of voice and friendly attitude",
      "Agent uses correct Holding procedures",
      "Agent is rude and disrespect the customer over the call.",
      "Agent did not save notes for the interaction",
      "Work Avoidance (Avoids creating ticket for caller/ Provide proper assistance)",
      "comment1","comment2","comment3","comment4","comment5","comment6","comment7","comment8","comment9","comment10","comment11","comment12",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['call_duration'].'",';
        		$row .= '"'.$user['file_no'].'",';
        		$row .= '"'.$user['Dispositons'].'",';
        		$row .= '"'.$user['Incorrect_Disposition'].'",';
        		$row .= '"'.$user['Correct_Disposition'].'",';
        		$row .= '"'.$user['Interaction'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['attitude'].'",';
				$row .= '"'.$user['needs'].'",';
				$row .= '"'.$user['same'].'",';
				$row .= '"'.$user['position_same'].'",';
				$row .= '"'.$user['hours'].'",';
				$row .= '"'.$user['need'].'",';
				$row .= '"'.$user['the_call'].'",';
				$row .= '"'.$user['skill_attitude'].'",';
				$row .= '"'.$user['procedures'].'",';
				$row .= '"'.$user['disrespect'].'",';
				$row .= '"'.$user['fatal_interaction'].'",';
				$row .= '"'.$user['assistance'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}

	//////////////////////////////////////////////////////////////////////////////////////////////////



///////////////////////////////////////////////////////////////////////////////////////
//////

	public function qa_tvs_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_tvs_report.php";
			$data["content_js"] = "qa_metropolis_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_tvs_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_tvs_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_tvs_list"] = $fullAray;
				$this->create_qa_tvs_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_tvs_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_tvs_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA TVS Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_tvs_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array( "Auditor Name","Audit Date",
		  "Call Date",
		  "Fusion ID",
		  "Agent","L1 Super","Campaign","Product","Customer Voc","Phone","Agent Disposition","QA Disposition",
		  "Call Duration",
		  "Audit Type",
		  "VOC",
		  "Audit Start Date Time",
		  "Audit End Date Time",
		  "Earned Score",
		  "Possible Score",
		  "QA Score",
		  "Did the agent understand/Paraphrase customer",
		  "Clear & appropriate language used",
		  "Did the agent handle the call with good Enthusiasm",
		  "Did the agent empathise and acknowledge the customer's concern wherever required",
		  "Did the agent avoid dead air on the call",
		  "Did the agent adhere to the standard script during call opening closing hold and transfer of call?",
		  "Did the agent update correct & complete remarks tagged the disposition properly in the system",
		  "Explaining USPs/ Features/ Product details",
		  "Did the Agent handled objection effectively?",
		  "Did the agent probe effectively based on the scenario?",
		  "Did the agent verify the customer details properly and provide reference number for the conversation to the customer wherever applicable",
		  "Did the agent attempted to take the customer & SCE on Con call",
		  "Consent not taken - No consent received from the customer but still field executive visit arranged Miselling/ False commitment given by the agent",
		  "Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13",
		   "Call Summary",
		   "Feedback",
		   "Agent Feedback Acceptance",
		  "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['tl_name'].'",';
        		$row .= '"'.$user['campaign'].'",';
        		$row .= '"'.$user['product'].'",';
        		$row .= '"'.$user['customer_voc'].'",';
        		$row .= '"'.$user['phone'].'",';
        		$row .= '"'.$user['agent_disposition'].'",';
        		$row .= '"'.$user['qa_disposition'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['Comprehension'].'",';
				$row .= '"'.$user['Communication'].'",';
				$row .= '"'.$user['Personalization'].'",';
				$row .= '"'.$user['acknowledgment'].'",';
				$row .= '"'.$user['air'].'",';
				$row .= '"'.$user['Adherence'].'",';
				$row .= '"'.$user['Documentation'].'",';
				$row .= '"'.$user['product'].'",';
				$row .= '"'.$user['handling'].'",';
				$row .= '"'.$user['Probing'].'",';
				$row .= '"'.$user['Verification'].'",';
				$row .= '"'.$user['team'].'",';
				$row .= '"'.$user['Appointment'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}

	//////////////////////////////////////////////////////////////////////////////////////////////////




///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA Paynearby REPORT ////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
	public function qa_paynearby_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_paynearby_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = $this->input->get('campaign');

			if($campaign=="ob_sales"){
				$table='qa_paynearby_ob_sales_feedback';
			}else if($campaign=="ob_service"){
				$table='qa_paynearby_ob_service_feedback';
			}else if($campaign=="pnb_email"){
				$table='qa_paynearby_pnb_email_feedback';
			}else if($campaign=="email"){
				$table='qa_paynearby_email_feedback';
			}else if($campaign=="closeloop"){
				$table='qa_paynearby_closeloop_feedback';
			}else if($campaign=="inbound_new"){
				$table='qa_pnb_inbound_new_feedback';
			}else if($campaign=="outbound_new"){
				$table='qa_pnb_outbound_new_feedback';
			}else if($campaign=="new_inb"){
				$table="qa_pnb_new_inb_feedback";
			}else if($campaign=="new_kyc_inb"){
				$table="qa_pnb_new_kyc_inb_feedback";
			}else if($campaign=="new_outbound"){
				$table="qa_paynearby_outbound_feedback";
			}else if($campaign=="new_one_outbound"){
				$table="qa_paynearby_outbound_new_feedback";
			}else if($campaign=="new_email"){
				$table="qa_paynearby_new_email_feedback";
			}else if($campaign=="new_social"){
				$table="qa_paynearby_new_social_media_feedback";
			}

			$data["qa_paynearby_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				//$dt_frm = getEstToLocal($date_from,agent_id);

				$date_to = mmddyy2mysql($this->input->get('date_to'));
				//$dt_to = getEstToLocal($date_to,agent_id);

				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				// if($date_from !="" && $date_to!=="" )  $cond= " Where (getLocalToEST(audit_date,agent_id) >= '$date_from' and getLocalToEST(audit_date,agent_id) <= '$date_to' ) ";

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )  ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All") $cond .= "";
				else $cond .=" and audit_type='$audit_type'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else if(get_login_type()=="client"){
					$cond1 .=" And audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond1 .="";
				}

				if($campaign=='inbound'){
					$qSql="SELECT P.*,
						(select concat(fname, ' ', lname) as name from signin sa where sa.id=P.entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin st where st.id=P.tl_id) as tl_name,
						S.id AS sid, S.fname, S.lname, S.fusion_id, S.office_id, GET_PROCESS_NAMES(S.id) AS campaign, DATEDIFF(CURDATE(), S.doj) AS tenure, S.assigned_to, PAR.fd_id, PAR.agnt_fd_acpt, PAR.note AS agent_note, DATE(PAR.entry_date) AS agent_rvw_date, PMR.fd_id AS mgnt_fd_id, PMR.note AS mgnt_note,  DATE(PMR.entry_date) AS mgnt_rvw_date,  PMR.entry_by AS mgnt_entry_by,
						(select concat(fname, ' ', lname) as name from signin s where s.id=PMR.entry_by) as mgnt_name
						FROM
						qa_paynearby_feedback P LEFT JOIN
						signin S ON P.agent_id = S.id LEFT JOIN
						qa_paynearby_agent_rvw PAR ON P.id = PAR.fd_id LEFT JOIN
						qa_paynearby_mgnt_rvw PMR ON P.id = PMR.fd_id
						$cond $cond1 order by audit_date";
				}else{
					 $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from ".$table.") xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond order by audit_date";
				}
				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_paynearby_list"] = $fullAray;

				if(!in_array($campaign,array('closeloop'))){

					$this->create_qa_paynearby_CSV($fullAray,$campaign);


					}else{

						$header=$campaign."Header";
						$header=$this->$header();

						$this->create_qa_paynearby_common_new_CSV($header,$fullAray,$campaign);

					}


				$dn_link = base_url()."reports_qa/download_qa_paynearby_CSV/".$campaign;

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['campaign']=$campaign;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_paynearby_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		if($campaign=='inbound'){
			$pnb_hdr='Paynearby Inbound';
		}else if($campaign=='ob_sales'){
			$pnb_hdr='Paynearby Outbound - Sales';
		}else if($campaign=='ob_service'){
			$pnb_hdr='Paynearby Outbound - Service';
		}else if($campaign=='pnb_email'){
			$pnb_hdr='Paynearby PNB Email';
		}else if($campaign=='email'){
			$pnb_hdr='Paynearby Email(old)';
		}else if($campaign=='inbound_new'){
			$pnb_hdr='Paynearby Inbound(NEW)';
		}else if($campaign=='outbound_new'){
			$pnb_hdr='Paynearby Outbound(NEW)';
		}else if($campaign=="new_inb"){
		  $pnb_hdr="Paynearby Inbound";
		}else if($campaign=="new_kyc_inb"){
		  $pnb_hdr="Paynearby KYC Inbound";
		}else if($campaign=="new_email"){
		  $pnb_hdr="Paynearby Email";
		}else if($campaign=="new_social"){
		  $pnb_hdr="Paynearby Social Media";
		}else if($campaign=="new_outbound"){
		  $pnb_hdr="Paynearby Outbound";
		}else if($campaign=="new_one_outbound"){
		  $pnb_hdr="Paynearby Retention VRM";
		}

		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$pnb_hdr." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_paynearby_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=='inbound'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Tenurity (in Days)", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging", "Query/Service", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Opening with Greeting (incl late opening/Name confirmation)", "Initial Empathy with Assurance statement done", "DID AGENT UNDERSTOOD THE QUERY & NECESSARY PROBING DONE", "Followed proper Telephone etiquettes (mute hold transfer)", "IVR Promotion done", "Effective rebuttals on Objection Handling/Convincing skills", "Fraud Alert Message informed", "Appropriate sentences and acknowledgment used on call", "Did the Agent was Polite on call/Not done Arguments/Professional", "Good Behavior/Willingness", "Good in listening/Repetition not happened due to lack in listening skills/Attentive", "Not interrupted", "Proper Empathy done whenever required", "Did the agent maintained Proper Pace/tone modulation/clarity in speech", "Did the agent have Patience", "Energy/Enthusiasm", "Confidence Level", "Grammatical errors/Fumbling/Fillers", "No Dead Air found", "Not Dragged the call", "Rude flirting foul language Abusive with customer not happened", "Was Exact TAT informed (Not less than Actual)", "Not provided Wrong information on call", "Was Correct tagging done/raised proper ticket", "Not having (Minor Errors in Comments/Sub dispositions)", "Customer satisfied/Rapport building done", "Did the agent followed Proper call closing Script as per process", "Overall Score", "Grade", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='ob_sales'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Tenurity (in Days)", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging", "Query/Service", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "STANDARD CALL OPENING PROCEDURE", "** EXPLANATION ABOUT PRODUCT AND PROCESS WITH FULL INFORMATION", "**CORRECT TAGGINGS / WRONG INFORMATION", "NECESSARY PROBING DONE ON CALL BASED", "SALES PICHER POLITE PITCHING URGE FOR SALES & SERVICE", "ACTIVE LISTENING", "ASSURANCE ACKNOWLEDGEMENT STATEMENTS ON CALL", "TONE MODULATION", "DRAGGING / STAMMERING / JARGONS / FILLERS", "CLOSING PROCEDURE FOLLOWED", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='ob_service'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Tenurity (in Days)", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging", "Query/Service", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "STANDARD CALL OPENING WITH COMPANY NAME", "NECESSARY PROBING TO BE DONE & UNDERSTANDING THE CUSTOMER", "FOR BNB AND AMAZON EXPLAINATION ABOUT SHOP SET UP AS PER CHECK LIST", "**FOR FLIPKART- EXPLANATION ABOUT FLIPKART PROCESS WITH FULL INFORMATION", "**TAGGING / WRONG INFORAMTION ON CALL", "ACTIVE LISTENING", "RAPPO BUILDING / ASSURANCE", "TONE MODULATION", "DRAGGING / STAMMERING / JARGONS / FILLERS", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='pnb_email'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date", "Campaign", "Call Duration", "Incoming No", "Register No.", "Customer Name", "Call Link", "Ticket No.", "Call Disconnect By", "Tagging/Disposition", "Query/Service", "Type of Call", "Audit Type", "Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Agent addressed and answered all customer queries", "Contextual Awareness: Agent checked the ticket history (parent-child if any)/referred to relevant attachments/ probing", "Agent shared the correct resolution", "Empathy/Apologies", "Assurance(Power Statement) / Paraphrasing/ Comprehension/ Acknowledgement", "Correct sentence Formation with appropriate salutation", "Rate of Speech/ Speech of Clarity/Tone & Manner", "Pronounciation/Fumbling/Stammering/Overlapping", "Agent called and cleared all customer queries if required", "Agent did utilize the system eficiently as per requirement to solve a query - CRM Remarks", "Agent did utilize the system eficiently as per requirement to solve a query - Proper CRM reports referred", "Update the Vertical/LOB Issue category & Sub Category/ Issue Category Reason/Order ID or Transaction ID (if any)", "Ticket status is updated as per activity and assigned to correct group if solved - response was sent to the customer", "Policy and procedure followed by the agent as per ZTP (Rude Profanity etc)", "Agent followed the opening and closing script (including asking for further assisstance)", "Active listening/ interruption & no Dead air on call", "HMT protocol followed on call", "Observation", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='email'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Date of Mail Received", "Date of Mail Action", "Status", "TAT", "Replied Date of TAT", "Email Number", "MSISDN", "Mail ID", "Interaction ID", "Category", "Sub Category", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Has all the queries of the customer answered", "Correct process followed", "Correct & Accurate Resolution given & completed on time", "For the missing details has the CSE called the customer to get those", "MINOR ERRORS - NOT GIVEN COMPLETE SOLUTION", "**Wrong or in complete information provided on mail", "Professional and Empathy statements used as per senario and acknowledge as per the query", "Email Etiquette Grammatical error punctuations font & spelling mistakes", "Email Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='inbound_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Tenurity (in Days)", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging", "Query/Service", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Agent addressed and answered all customer queries.","Contextual Awareness: Agent checked the ticket history (parent-child if any)/referred to relevant attachments/ probing.","Agent shared the correct resolution.","Empathy/Apologies.","Assurance(Power Statement) / Paraphrasing/ Comprehension/ Acknowledgement.","Correct sentence Formation with appropriate salutation.","Rate of Speech/ Speech of Clarity/Tone & Manner.","Pronounciation/Fumbling/Stammering/Overlapping.","Agent called and cleared all customer queries if required.","Agent did utilize the system eficiently as per requirement to solve a query - CRM Remarks.","Agent did utilize the system eficiently as per requirement to solve a query - Proper CRM reports referred.","Update the Vertical/LOB Issue category & Sub Category/ Issue Category Reason/Order ID or Transaction ID (if any).","Ticket status is updated as per activity and assigned to correct group if solved - response was sent to the customer.","Policy and procedure followed by the agent as per ZTP (Rude Profanity etc).","Agent followed the opening and closing script (including asking for further assisstance)","Active listening/ interruption & no Dead air on call.","HMT protocol followed on call","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='outbound_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Tenurity (in Days)", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging", "Query/Service", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Agent addressed and answered all customer queries.","Contextual Awareness: Agent checked the ticket history (parent-child; if any)/referred to relevant attachments/ probing.","Agent shared the correct resolution.","Assurance(Power Statement) / Paraphrasing/ Comprehension/ Acknowledgement/Empathy/Apologies.","Correct sentence Formation with appropriate salutation","Rate of Speech/ Speech of Clarity/Tone & Manner/Pronounciation/Fumbling/Stammering/Overlapping.","Sales urgency was created/Selling opportunities were properly utilized.","Proper Rebuttal Given","All Product features mentioned.","Agent did utilize the system eficiently as per requirement to solve a query - CRM Remarks.","Agent did utilize the system eficiently as per requirement to solve a query - Proper CRM reports referred.","Update the Vertical/LOB Issue category & Sub Category/ Issue Category Reason/Order ID or Transaction ID (if any).","Ticket status is updated as per activity and assigned to correct group if solved - response was sent to the customer.","Policy and procedure followed by the agent as per ZTP (Rude and Profanity etc).","Agent followed the opening and closing script (including asking for further assisstance).","Active listening/ interruption & no Dead air on call.","Active listening/ interruption & no Dead air on call.","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=="new_inb"){
		  $header=array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "ACPT", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging/Disposition", "Query/Compaint/Others", "Type Of Call", "Audit Type", "VOC","Issue Resolved?","Customer came with (mood)","Customer left with (mood)","Product related","Process related","Agent related","Needs Escalation","Call Back Required?","Prediactive CSAT", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
		  "Standard Call Opening","Reason 1","Remark 1", "Appropriate Empathy/Apology Wherever Applicable","Reason 2","Remark 2", "Assurance/Paraphrasing","Reason 3","Remark 3", "Correct Sentence Formation With Appropriate Salutation","Reason 4","Remark 4", "Feeling Confident/Well Mannered/Ros/Clarity Of Speech/Jargon","Reason 5","Remark 5", "Active Listening/Attentiveness","Reason 6","Remark 6", "Interruption & Parallel Talking","Reason 7","Remark 7", "Closing on call","Reason 8","Remark 8", "HMT Protocol","Reason 9","Remark 9", "Effective Probing/System Check","Reason 10","Remark 10", "Self help-IVR Promotion/Sales Pitch/Convincing skill","Reason 11","Remark 11", "Security Check-Authentication","Reason 12","Remark 12", "Agent Shared The Correct/Complete Information","Reason 13","Remark 13", "Whether All The Information Collected And Recorded Properly","Reason 14","Remark 14", "Update The Vertical/Lob Issue Category & Sub Category/ Issue Category Reason/Order Id Or Transaction Id","Reason 15","Remark 15", "Policy And Procedure Followed By The Agent As Per Ztp (Rude And Profanity Etc)","Reason 16","Remark 16",
		  "Call Summary", "Feedback", "TNI Feedback", "QA Feedback Type", "QA Feedback", "QA Feedback Date", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=="new_kyc_inb"){
		  $header=array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "ACPT", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging/Disposition", "Query/Compaint/Others", "Type Of Call", "Audit Type", "VOC", "Digi KYC Done Post Call", "Digi KYC Not Completed on Call Reason", "Digi KYC Status", "E-KYC Done Post Call", "E-KYC Status", "Ekyc Not Completed On Call Reason", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
		  "Standard Call Opening","Reason 1","Remark 1", "Appropriate Empathy/Apology Wherever Applicable","Reason 2","Remark 2", "Assurance/Paraphrasing","Reason 3","Remark 3", "Correct Sentence Formation With Appropriate Salutation","Reason 4","Remark 4", "Feeling Confident/Well Mannered/Ros/Clarity Of Speech/Jargon","Reason 5","Remark 5", "Active Listening/Attentiveness","Reason 6","Remark 6", "Interruption & Parallel Talking","Reason 7","Remark 7", "Closing on call","Reason 8","Remark 8", "HMT Protocol","Reason 9","Remark 9", "Effective Probing/System Check","Reason 10","Remark 10", "Self help-IVR Promotion/Sales Pitch/Convincing skill","Reason 11","Remark 11", "Security Check-Authentication","Reason 12","Remark 12", "Agent Shared The Correct/Complete Information","Reason 13","Remark 13", "Whether All The Information Collected And Recorded Properly","Reason 14","Remark 14", "Update The Vertical/Lob Issue Category & Sub Category/ Issue Category Reason/Order Id Or Transaction Id","Reason 15","Remark 15", "Policy And Procedure Followed By The Agent As Per Ztp (Rude And Profanity Etc)","Reason 16","Remark 16",
		  "Call Summary", "Feedback", "TNI Feedback", "QA Feedback Type", "QA Feedback", "QA Feedback Date", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}else if($campaign=="new_outbound"){
		  $header=array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging/Disposition", "Query/Compaint/Others", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score","Earned Score","Overall Score",
		  "Standard Call Opening (Greeting With Company Name Right Party Confirmation)","Reason 1","Remarks 1", "Appropriate Empathy/Apology Wherever Applicable","Reason 2","Remarks 2", "Personalization & Connect","Reason 3","Remarks 3", "Rate of Speech / Clarity Of Speech / Jargons","Reason 4","Remarks 5", "Active Listening/Attentive On Call","Reason 5","Remarks 5", "Interruption & Parallel Talking","Reason 6","Remarks 6", "Closing On Call","Reason 7","Remarks 7", "Hold/Mute/Transfer","Reason 8","Remarks 8", "Rapport Building & Effective Probing","Reason 9","Remarks 10", "Sales Urgency & Proper Rebuttal Given","Reason 10","Remarks 10", "Agent Shared The Correct/Complete Information","Reason 11","Remarks 11", "All Product Features Mentioned","Reason 12","Remarks 12",
		  "Whether All The Information Collected And Recorded Properly","Reason 13","Remarks 13", "Update The Vertical/Lob Issue Category & Sub Category","Reason 14","Remarks 14", "Policy And Procedure Followed By The Agent","Reason 15","Remarks 15", "Call Summary", "Feedback", "QA Feedback Type", "QA Feedback", "QA Feedback Date", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		  /* "Assurance / Paraphrasing","Correct Sentence Formation With Appropriate Salutation","Feeling Confident/Well Mannered/Ros/Clarity Of Speech/Jargons","Sales Urgency Was Created/Selling Opportunities Were Properly Utilized","Remark 14","Remark 15","Remark 16","Remark 17" */
		}else if($campaign=="new_one_outbound"){
			$header=array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Call Link", "Ticket Number", "Call Disconnect By", "Tagging/Disposition", "Query/Compaint/Others", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score","Earned Score","Overall Score",
		  "Standard Call Opening (Greeting With Company Name Right Party Confirmation)","Reason 1","Remarks 1", "Appropriate Empathy/Apology Wherever Applicable","Reason 2","Remarks 2", "Maintained professional Tone/ Assured the retailer wherever applicable","Reason 3","Remarks 3", "Eshtablished connect with the retailer","Reason 4","Remarks 4", "Rate/Clarity of speech was moderate/No usage of Jargons","Reason 5","Remarks 5", "Active Listening","Reason 6","Remarks 6", "Interruption & Parallel Talking","Reason 7","Remarks 7", "Seamless Conversation (No abrupt pause/dead air)","Reason 8","Remarks 8", "Reason for drop in business figures","Reason 9","Remarks 9", "All required checks done for conversion (System checks)","Reason 10","Remarks 10", "Agent Shared The Correct/Complete Information","Reason 11","Remarks 11", "Business opportunity was explored and explained","Reason 12","Remarks 12","CRM/Convox Remarks were captured properly","Reason 13","Remarks 13","Actioning in System Need to follow up ( For Complaint / Issue which escalated to concern Team)","Reason 14","Remarks 14","Summarization of Call","Reason 15","Remarks 15","Closing of call","Reason 16","Remarks 16","Tagging & Disposition in Convox","Reason 17","Remarks 17","ZTP","Reason 18","Remarks 18",
		    "Call Summary", "Feedback", "QA Feedback Type", "QA Feedback", "QA Feedback Date", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}
		else if($campaign=="new_email" || $campaign=="new_social"){
		  $header=array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time", "Call Duration", "Incoming Number", "Campaign", "Register No", "Customer Name", "Ticket Number", "Call Disconnect By", "Tagging/Disposition", "Query/Service", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
		  "Was the advisor fluent in his/her written communication skills?","Reason 1","Remark 1", "Agent Shared The Correct/Complete Information(Email-Resolution)","Reason 2","Remark 2", "Actioned the request/complaint/concern correctly","Reason 3","Remark 3", "Did the agent follow prescribed template when replying","Reason 4","Remark 4", "Did the agent call back to collect missing details?","Reason 5","Remark 5", "Standard Call Opening","Reason 6","Remark 6", "Assurance / Paraphrasing","Reason 7","Remark 7", "Appropriate Empathy/Apology Wherever Applicable","Reason 8","Remark 8", "Communication Skill of the associate during close-looping","Reason 9","Remark 9", "Effective Probing/System utilization or navigation","Reason 10","Remark 10", "Closing","Reason 11","Remark 11", "Agent Shared The Correct/Complete Information(In-Call)","Reason 12","Remark 12", "Tagging/Appropriate Remarks updation","Reason 13","Remark 13", "Policy And Procedure Followed By The Agent","Reason 14","Remark 14",
		  "Call Summary", "Feedback", "QA Feedback Type", "QA Feedback", "QA Feedback Date", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='inbound'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['opening_greeting'].'",';
				$row .= '"'.$user['initial_empathy'].'",';
				$row .= '"'.$user['agent_query'].'",';
				$row .= '"'.$user['proper_telephone'].'",';
				$row .= '"'.$user['ivr_promotion'].'",';
				$row .= '"'.$user['efective_rebuttal'].'",';
				$row .= '"'.$user['fraud_alert'].'",';
				$row .= '"'.$user['sentence_acknowledge'].'",';
				$row .= '"'.$user['polite_call'].'",';
				$row .= '"'.$user['good_behaviour'].'",';
				$row .= '"'.$user['good_listening'].'",';
				$row .= '"'.$user['not_interrupt'].'",';
				$row .= '"'.$user['proper_empathy'].'",';
				$row .= '"'.$user['proper_pace'].'",';
				$row .= '"'.$user['agent_patience'].'",';
				$row .= '"'.$user['energy_enthusias'].'",';
				$row .= '"'.$user['confident_level'].'",';
				$row .= '"'.$user['error_fumbling'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['dragged_call'].'",';
				$row .= '"'.$user['rude_language'].'",';
				$row .= '"'.$user['exact_tat'].'",';
				$row .= '"'.$user['wrong_provide'].'",';
				$row .= '"'.$user['correct_tagging'].'",';
				$row .= '"'.$user['minor_error'].'",';
				$row .= '"'.$user['satisfy_rapport'].'",';
				$row .= '"'.$user['closing_script'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['grade'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
				$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
				$row .= '"'.$user['mgnt_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='ob_sales'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['standart_call_opening'].'",';
				$row .= '"'.$user['explain_about_product'].'",';
				$row .= '"'.$user['correct_tagging'].'",';
				$row .= '"'.$user['necessary_probing'].'",';
				$row .= '"'.$user['sales_picher'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['assurance_acknowledge'].'",';
				$row .= '"'.$user['tone_modulation'].'",';
				$row .= '"'.$user['dragging_stammering'].'",';
				$row .= '"'.$user['closing_procedure'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='ob_service'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['standard_call_opening'].'",';
				$row .= '"'.$user['necessary_probing'].'",';
				$row .= '"'.$user['explain_about_BNB_Amazon'].'",';
				$row .= '"'.$user['explain_about_Flipkart'].'",';
				$row .= '"'.$user['wrong_call_information'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['rappo_building'].'",';
				$row .= '"'.$user['tone_modulation'].'",';
				$row .= '"'.$user['dragging_stammering'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($campaign=='pnb_email'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer_name'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['type_of_call'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';


				$row .= '"'.$user['agent_addressed_answered'].'",';
				$row .= '"'.$user['contextual_awareness'].'",';
				$row .= '"'.$user['agent_shared_correct'].'",';
				$row .= '"'.$user['empathy_apologies'].'",';
				$row .= '"'.$user['assurance'].'",';
				$row .= '"'.$user['correct_sentence'].'",';
				$row .= '"'.$user['rate_of_speech'].'",';
				$row .= '"'.$user['pronounciation'].'",';
				$row .= '"'.$user['agent_called_cleared'].'",';
				$row .= '"'.$user['agent_utilize_crm_remark'].'",';
				$row .= '"'.$user['agent_utilize_crm_report'].'",';
				$row .= '"'.$user['update_the_vertical'].'",';
				$row .= '"'.$user['ticket_status_updated'].'",';
				$row .= '"'.$user['policy_and_procedure'].'",';
				$row .= '"'.$user['agent_followed_opening'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['hmt_protocol_followed'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='email'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['mail_action_date'].'",';
				$row .= '"'.$user['status'].'",';
				$row .= '"'.$user['tat'].'",';
				$row .= '"'.$user['tat_replied_date'].'",';
				$row .= '"'.$user['email_no'].'",';
				$row .= '"'.$user['msisdn'].'",';
				$row .= '"'.$user['email_id'].'",';
				$row .= '"'.$user['interaction_id'].'",';
				$row .= '"'.$user['category'].'",';
				$row .= '"'.$user['sub_category'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['customer_query_answer'].'",';
				$row .= '"'.$user['correct_process_follow'].'",';
				$row .= '"'.$user['accurate_resolution_given'].'",';
				$row .= '"'.$user['missing_details_for_CSE_call'].'",';
				$row .= '"'.$user['not_given_complete_solution'].'",';
				$row .= '"'.$user['product_process_knowledge'].'",';
				$row .= '"'.$user['empathy_statement_use'].'",';
				$row .= '"'.$user['grammatical_error'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='inbound_new'){

		     foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_addressed_customer_queries'].'",';
				$row .= '"'.$user['contextual_awareness'].'",';
				$row .= '"'.$user['agent_shared_resolution'].'",';
				$row .= '"'.$user['empathy_pologies'].'",';
				$row .= '"'.$user['power_statement'].'",';
				$row .= '"'.$user['correct_sentence_formation'].'",';
				$row .= '"'.$user['rate_of_speech'].'",';
				$row .= '"'.$user['pronunciation'].'",';
				$row .= '"'.$user['agent_called_and_cleared'].'",';
				$row .= '"'.$user['agent_utilize_the_system_crm_remark'].'",';
				$row .= '"'.$user['agent_utilize_the_system_crm_reports'].'",';
				$row .= '"'.$user['update_the_vertical_lob'].'",';
				$row .= '"'.$user['ticket_status_is_updated'].'",';
				$row .= '"'.$user['policy_and_procedure_followed'].'",';
				$row .= '"'.$user['agent_followed_the_opening'].'",';
				$row .= '"'.$user['active_listening_interruption'].'",';
				$row .= '"'.$user['hmt_protocol_followed'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='outbound_new'){

		     foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_address'].'",';
				$row .= '"'.$user['contextual_awareness'].'",';
				$row .= '"'.$user['agent_shared_correct'].'",';
				$row .= '"'.$user['assurance'].'",';
				$row .= '"'.$user['correct_sentence_formation'].'",';
				$row .= '"'.$user['rate_of_speech'].'",';
				$row .= '"'.$user['sales_urgency'].'",';
				$row .= '"'.$user['proper_rebuttal'].'",';
				$row .= '"'.$user['all_product_features'].'",';
				$row .= '"'.$user['agent_did_utilize_remarks'].'",';
				$row .= '"'.$user['agent_did_utilize_reports'].'",';
				$row .= '"'.$user['update_the_vertical'].'",';
				$row .= '"'.$user['ticket_status'].'",';
				$row .= '"'.$user['policy_and_procedure'].'",';
				$row .= '"'.$user['agent_followed_opening'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['hmt_protocol'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='new_inb'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$adtdate=ConvServerToLocal($user['entry_date']);
				$time = strtotime($adtdate);
				$auditDate = date('Y-m-d',$time);

				if($user['qa_feedback_date']=="" || $user['qa_feedback_date']=='0000-00-00 00:00:00'){
					$qa_feedback_date='---';
				}else{
					$qa_feedback_date=ConvServerToLocal($user['qa_feedback_date']);
				}

				if($user['agent_rvw_date']=="" || $user['agent_rvw_date']=='0000-00-00 00:00:00'){
					$agent_rvw_date='---';
				}else{
					$agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
				}

				if($user['mgnt_rvw_date']=="" || $user['mgnt_rvw_date']=='0000-00-00 00:00:00'){
					$mgnt_rvw_date='---';
				}else{
					$mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$auditDate.'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['customer_voc'].'",';
				$row .= '"'.$user['issue_resolved'].'",';
				$row .= '"'.$user['customer_came_withmood'].'",';
				$row .= '"'.$user['customer_left_with_mood'].'",';
				$row .= '"'.$user['product_related'].'",';
				$row .= '"'.$user['process_related'].'",';
				$row .= '"'.$user['agent_related'].'",';
				$row .= '"'.$user['need_escalation'].'",';
				$row .= '"'.$user['call_back_required'].'",';
				$row .= '"'.$user['voc'].'",';
                $row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['standard_call_opening'].'",';
				$row .= '"'.$user['sco_reason'].'",';
				$row .= '"'.$user['remark1'].'",';
				$row .= '"'.$user['appr_empathy_apology'].'",';
				$row .= '"'.$user['appr_emp_ap_reason'].'",';
				$row .= '"'.$user['remark2'].'",';
				$row .= '"'.$user['assurance_paraph'].'",';
				$row .= '"'.$user['assurance_paraph_reason'].'",';
				$row .= '"'.$user['remark3'].'",';
				$row .= '"'.$user['correct_sentence_formation'].'",';
				$row .= '"'.$user['correct_sentence_form_reason'].'",';
				$row .= '"'.$user['remark4'].'",';
				$row .= '"'.$user['feeling_confident'].'",';
				$row .= '"'.$user['feeling_confident_reason'].'",';
				$row .= '"'.$user['remark5'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['active_listening_reason'].'",';
				$row .= '"'.$user['remark6'].'",';
				$row .= '"'.$user['interruption'].'",';
				$row .= '"'.$user['interruption_reason'].'",';
				$row .= '"'.$user['remark7'].'",';
				$row .= '"'.$user['closing_on_call'].'",';
				$row .= '"'.$user['closing_on_call_reason'].'",';
				$row .= '"'.$user['remark8'].'",';
				$row .= '"'.$user['hmt_protocol'].'",';
				$row .= '"'.$user['hmt_protocol_reason'].'",';
				$row .= '"'.$user['remark9'].'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'.$user['effective_probing_reason'].'",';
				$row .= '"'.$user['remark10'].'",';
				$row .= '"'.$user['self_help'].'",';
				$row .= '"'.$user['self_help_reason'].'",';
				$row .= '"'.$user['remark11'].'",';
				$row .= '"'.$user['security_check'].'",';
				$row .= '"'.$user['security_check_reason'].'",';
				$row .= '"'.$user['remark12'].'",';
				$row .= '"'.$user['agent_shared_comp_info'].'",';
				$row .= '"'.$user['agent_shared_comp_info_reason'].'",';
				$row .= '"'.$user['remark13'].'",';
				$row .= '"'.$user['all_info_collected'].'",';
				$row .= '"'.$user['all_info_collected_reason'].'",';
				$row .= '"'.$user['remark14'].'",';
				$row .= '"'.$user['update_vertical_lob_issue'].'",';
				$row .= '"'.$user['update_vertical_lob_issue_reason'].'",';
				$row .= '"'.$user['remark15'].'",';
				$row .= '"'.$user['policy_and_procedure'].'",';
				$row .= '"'.$user['policy_and_procedure_reason'].'",';
				$row .= '"'.$user['remark16'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['tni_feedback'])).'",';
				$row .= '"'.$user['qa_feedback_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['qa_feedback'])).'",';
				$row .= '"'.$qa_feedback_date.'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$agent_rvw_date.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$mgnt_rvw_date.'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=="new_kyc_inb"){

			foreach($rr as $user){

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$adtdate=ConvServerToLocal($user['entry_date']);
				$time = strtotime($adtdate);
				$auditDate = date('Y-m-d',$time);

				if($user['qa_feedback_date']=="" || $user['qa_feedback_date']=='0000-00-00 00:00:00'){
					$qa_feedback_date='---';
				}else{
					$qa_feedback_date=ConvServerToLocal($user['qa_feedback_date']);
				}

				if($user['agent_rvw_date']=="" || $user['agent_rvw_date']=='0000-00-00 00:00:00'){
					$agent_rvw_date='---';
				}else{
					$agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
				}

				if($user['mgnt_rvw_date']=="" || $user['mgnt_rvw_date']=='0000-00-00 00:00:00'){
					$mgnt_rvw_date='---';
				}else{
					$mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$auditDate.'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['kyc_done_post_call'].'",';
				$row .= '"'.$user['kyc_not_complete_reason'].'",';
				$row .= '"'.$user['kyc_status'].'",';
				$row .= '"'.$user['ekyc_post_call'].'",';
				$row .= '"'.$user['ekyc_status'].'",';
				$row .= '"'.$user['ekyc_not_complete_reason'].'",';
                $row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['standard_call_opening'].'",';
				$row .= '"'.$user['sco_reason'].'",';
				$row .= '"'.$user['remark1'].'",';
				$row .= '"'.$user['appr_empathy_apology'].'",';
				$row .= '"'.$user['appr_emp_ap_reason'].'",';
				$row .= '"'.$user['remark2'].'",';
				$row .= '"'.$user['assurance_paraph'].'",';
				$row .= '"'.$user['assurance_paraph_reason'].'",';
				$row .= '"'.$user['remark3'].'",';
				$row .= '"'.$user['correct_sentence_formation'].'",';
				$row .= '"'.$user['correct_sentence_form_reason'].'",';
				$row .= '"'.$user['remark4'].'",';
				$row .= '"'.$user['feeling_confident'].'",';
				$row .= '"'.$user['feeling_confident_reason'].'",';
				$row .= '"'.$user['remark5'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['active_listening_reason'].'",';
				$row .= '"'.$user['remark6'].'",';
				$row .= '"'.$user['interruption'].'",';
				$row .= '"'.$user['interruption_reason'].'",';
				$row .= '"'.$user['remark7'].'",';
				$row .= '"'.$user['closing_on_call'].'",';
				$row .= '"'.$user['closing_on_call_reason'].'",';
				$row .= '"'.$user['remark8'].'",';
				$row .= '"'.$user['hmt_protocol'].'",';
				$row .= '"'.$user['hmt_protocol_reason'].'",';
				$row .= '"'.$user['remark9'].'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'.$user['effective_probing_reason'].'",';
				$row .= '"'.$user['remark10'].'",';
				$row .= '"'.$user['self_help'].'",';
				$row .= '"'.$user['self_help_reason'].'",';
				$row .= '"'.$user['remark11'].'",';
				$row .= '"'.$user['security_check'].'",';
				$row .= '"'.$user['security_check_reason'].'",';
				$row .= '"'.$user['remark12'].'",';
				$row .= '"'.$user['agent_shared_comp_info'].'",';
				$row .= '"'.$user['agent_shared_comp_info_reason'].'",';
				$row .= '"'.$user['remark13'].'",';
				$row .= '"'.$user['all_info_collected'].'",';
				$row .= '"'.$user['all_info_collected_reason'].'",';
				$row .= '"'.$user['remark14'].'",';
				$row .= '"'.$user['update_vertical_lob_issue'].'",';
				$row .= '"'.$user['update_vertical_lob_issue_reason'].'",';
				$row .= '"'.$user['remark15'].'",';
				$row .= '"'.$user['policy_and_procedure'].'",';
				$row .= '"'.$user['policy_and_procedure_reason'].'",';
				$row .= '"'.$user['remark16'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['tni_feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['qa_feedback'])).'",';
				$row .= '"'.$user['qa_feedback_type'].'",';
				$row .= '"'.$qa_feedback_date.'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$agent_rvw_date.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$mgnt_rvw_date.'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='new_email' || $campaign=="new_social"){

			foreach($rr as $user){

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$adtdate=ConvServerToLocal($user['entry_date']);
				$time = strtotime($adtdate);
				$auditDate = date('Y-m-d',$time);

				if($user['qa_feedback_date']=="" || $user['qa_feedback_date']=='0000-00-00 00:00:00'){
					$qa_feedback_date='---';
				}else{
					$qa_feedback_date=ConvServerToLocal($user['qa_feedback_date']);
				}

				if($user['agent_rvw_date']=="" || $user['agent_rvw_date']=='0000-00-00 00:00:00'){
					$agent_rvw_date='---';
				}else{
					$agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
				}

				if($user['mgnt_rvw_date']=="" || $user['mgnt_rvw_date']=='0000-00-00 00:00:00'){
					$mgnt_rvw_date='---';
				}else{
					$mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$auditDate.'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer_name'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['type_of_call'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['advisor_fluent'].'",';
				$row .= '"'.$user['advisor_fluent_reason'].'",';
				$row .= '"'.$user['remark1'].'",';
				$row .= '"'.$user['agent_shared_comp_info'].'",';
				$row .= '"'.$user['asci_reason'].'",';
				$row .= '"'.$user['remark2'].'",';
				$row .= '"'.$user['action_req_correctly'].'",';
				$row .= '"'.$user['arc_reason'].'",';
				$row .= '"'.$user['remark3'].'",';
				$row .= '"'.$user['agent_follow_prescribed_temp'].'",';
				$row .= '"'.$user['afp_temp_reason'].'",';
				$row .= '"'.$user['remark4'].'",';
				$row .= '"'.$user['agent_call_back'].'",';
				$row .= '"'.$user['acb_reason'].'",';
				$row .= '"'.$user['remark5'].'",';
				$row .= '"'.$user['standard_call_opening'].'",';
				$row .= '"'.$user['sco_reason'].'",';
				$row .= '"'.$user['remark6'].'",';
				$row .= '"'.$user['assurance_paraph'].'",';
				$row .= '"'.$user['assurance_paraph_reason'].'",';
				$row .= '"'.$user['remark7'].'",';
				$row .= '"'.$user['appr_emp_ap'].'",';
				$row .= '"'.$user['appr_emp_ap_reason'].'",';
				$row .= '"'.$user['remark8'].'",';
				$row .= '"'.$user['communication_skill'].'",';
				$row .= '"'.$user['comm_skill_reason'].'",';
				$row .= '"'.$user['remark9'].'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'.$user['effective_probing_reason'].'",';
				$row .= '"'.$user['remark10'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['closing_reason'].'",';
				$row .= '"'.$user['remark11'].'",';
				$row .= '"'.$user['agent_shared_in_call'].'",';
				$row .= '"'.$user['agent_shared_in_call_reason'].'",';
				$row .= '"'.$user['remark12'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['tagging_reason'].'",';
				$row .= '"'.$user['remark13'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['ztp_reason'].'",';
				$row .= '"'.$user['remark14'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['qa_feedback_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['qa_feedback'])).'",';
				$row .= '"'.$qa_feedback_date.'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$agent_rvw_date.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$agent_rvw_date.'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='new_outbound'){

			foreach($rr as $user){

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$adtdate=ConvServerToLocal($user['entry_date']);
				$time = strtotime($adtdate);
				$auditDate = date('Y-m-d',$time);

				if($user['qa_feedback_date']=="" || $user['qa_feedback_date']=='0000-00-00 00:00:00'){
					$qa_feedback_date='---';
				}else{
					$qa_feedback_date=ConvServerToLocal($user['qa_feedback_date']);
				}

				if($user['agent_rvw_date']=="" || $user['agent_rvw_date']=='0000-00-00 00:00:00'){
					$agent_rvw_date='---';
				}else{
					$agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
				}

				if($user['mgnt_rvw_date']=="" || $user['mgnt_rvw_date']=='0000-00-00 00:00:00'){
					$mgnt_rvw_date='---';
				}else{
					$mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$auditDate.'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['standard_call_opening'].'",';
				$row .= '"'.$user['sco_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark1'])).'",';
				$row .= '"'.$user['appr_empathy_apology'].'",';
				$row .= '"'.$user['appr_emp_ap_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark2'])).'",';
				$row .= '"'.$user['personalization_connect'].'",';
				$row .= '"'.$user['personalization_connect_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark3'])).'",';
				$row .= '"'.$user['rate_of_speech'].'",';
				$row .= '"'.$user['rate_of_speech_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark4'])).'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['active_listening_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark5'])).'",';
				$row .= '"'.$user['parallel_talking'].'",';
				$row .= '"'.$user['parallel_talking_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark6'])).'",';
				$row .= '"'.$user['closing_on_call'].'",';
				$row .= '"'.$user['coc_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark7'])).'",';
				$row .= '"'.$user['hmt'].'",';
				$row .= '"'.$user['hmt_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark8'])).'",';
				$row .= '"'.$user['rapport_building'].'",';
				$row .= '"'.$user['rapport_building_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark9'])).'",';
				/*$row .= '"'.$user['sales_urgency'].'",';
				$row .= '"'.$user['sales_urgency_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark10'])).'",';*/
				$row .= '"'.$user['proper_rebuttal'].'",';
				$row .= '"'.$user['proper_rebuttal_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark10'])).'",';
				$row .= '"'.$user['agent_shared_comp_info'].'",';
				$row .= '"'.$user['as_c_info_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark11'])).'",';
				$row .= '"'.$user['all_product_features'].'",';
				$row .= '"'.$user['apf_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark12'])).'",';
				$row .= '"'.$user['all_info_collected'].'",';
				$row .= '"'.$user['aic_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark13'])).'",';
				$row .= '"'.$user['update_the_vertical_lob'].'",';
				$row .= '"'.$user['utvl_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark14'])).'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['ztp_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['qa_feedback_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['qa_feedback'])).'",';
				$row .= '"'.$qa_feedback_date.'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$agent_rvw_date.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$mgnt_rvw_date.'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($campaign=='new_one_outbound'){

			foreach($rr as $user){

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$adtdate=ConvServerToLocal($user['entry_date']);
				$time = strtotime($adtdate);
				$auditDate = date('Y-m-d',$time);

				if($user['qa_feedback_date']=="" || $user['qa_feedback_date']=='0000-00-00 00:00:00'){
					$qa_feedback_date='---';
				}else{
					$qa_feedback_date=ConvServerToLocal($user['qa_feedback_date']);
				}

				if($user['agent_rvw_date']=="" || $user['agent_rvw_date']=='0000-00-00 00:00:00'){
					$agent_rvw_date='---';
				}else{
					$agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
				}

				if($user['mgnt_rvw_date']=="" || $user['mgnt_rvw_date']=='0000-00-00 00:00:00'){
					$mgnt_rvw_date='---';
				}else{
					$mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$auditDate.'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['standard_call_opening'].'",';
				$row .= '"'.$user['sco_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark1'])).'",';
				$row .= '"'.$user['appr_empathy_apology'].'",';
				$row .= '"'.$user['appr_emp_ap_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark2'])).'",';
				$row .= '"'.$user['professional'].'",';
				$row .= '"'.$user['professional_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark3'])).'",';
				$row .= '"'.$user['connect_retailer'].'",';
				$row .= '"'.$user['connect_retailer_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark4'])).'",';
				$row .= '"'.$user['clarity_of_speech'].'",';
				$row .= '"'.$user['clarity_of_speech_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark5'])).'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['active_listening_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark6'])).'",';
				$row .= '"'.$user['parallel_talking'].'",';
				$row .= '"'.$user['parallel_talking_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark7'])).'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['dead_air_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark8'])).'",';
				$row .= '"'.$user['drop_business'].'",';
				$row .= '"'.$user['drop_business_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark9'])).'",';
				$row .= '"'.$user['conversion_check'].'",';
				$row .= '"'.$user['conversion_check_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark10'])).'",';
				$row .= '"'.$user['complete_information'].'",';
				$row .= '"'.$user['complete_information_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark11'])).'",';
				$row .= '"'.$user['business_opportunity'].'",';
				$row .= '"'.$user['business_opportunity_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark12'])).'",';
				$row .= '"'.$user['crm'].'",';
				$row .= '"'.$user['crm_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark13'])).'",';
				$row .= '"'.$user['actioning_in_system'].'",';
				$row .= '"'.$user['actioning_in_system_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark14'])).'",';
				$row .= '"'.$user['summarization_of_call'].'",';
				$row .= '"'.$user['summarization_of_call_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark15'])).'",';
				$row .= '"'.$user['closing_call'].'",';
				$row .= '"'.$user['closing_call_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark16'])).'",';
				$row .= '"'.$user['tagging_disposition'].'",';
				$row .= '"'.$user['tagging_disposition_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark17'])).'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['ztp_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remark18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['qa_feedback_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['qa_feedback'])).'",';
				$row .= '"'.$qa_feedback_date.'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$agent_rvw_date.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$mgnt_rvw_date.'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
	}

///////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// QA RPM Report ////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_rpm_report()
	{
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_rpm_report.php";
			$data["content_js"] = "qa_rpm_sentry_js.php";
			$from_date="";
			$to_date="";
			$action="";
			$agent ="";
			$dn_link="";
			$rpm_data = array();

			if($this->input->get('show')=='Show')
			{
				$from_date = $this->input->get('from_date');
				$to_date = $this->input->get('to_date');
				$agent = $this->input->get('agent');
				if($from_date!="" && $to_date!="")
				{
					$rpm_data =	$this->Qa_RPM_Sentry_model->qa_rpm_report(mmddyy2mysql($from_date),mmddyy2mysql($to_date),$agent,$current_user);
				}
				$this->create_qa_rpm_CSV($rpm_data);
				$dn_link = base_url()."reports_qa/download_qa_rpm_CSV";
			}
			$data["from_date"] = $from_date;
            $data["to_date"] = $to_date;
			$data['agent'] = $agent;
			$data['rpm_data'] =	$rpm_data;
			$data['download_link']=$dn_link;
			$data["agent_list"] = $this->Qa_RPM_Sentry_model->get_agent_id(56,68);
			$this->load->view('dashboard',$data);
		}
	}
	/****************QA RPM CSV Generator*****************/
	public function create_qa_rpm_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/qa_rpm_report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_RPM_Sentry";
		$edit_url = "edit_rpm";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date","Audit Time","Agent","Audit Type","VOC","Audit Link","Caller Title","Caller Name","Caller Phone","Call Type","Disposition Type","Total Score","Total Score Count","Customer Information/Opening","Voice Delivery","Communication Skills","Customer Service","Disposition","Transfer","Protocol","Call Summary","Feedback");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $rdata)
		{
			$main_urls = $main_url.'/'.$rdata['id'];
			$row = '"'.$rdata['auditor_name'].'",';
			$row .= '"'.$rdata['audit_date'].'",';
			$row .= '"'.$rdata['audit_time'].'",';
			$row .= '"'.$rdata['agent_name'].'",';
			$row .= '"'.$rdata['audit_type'].'",';
			$row .= '"'.$rdata['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$rdata['caller_title'].'",';
			$row .= '"'.$rdata['caller_name'].'",';
			$row .= '"'.$rdata['caller_phone'].'",';
			$row .= '"'.$rdata['call_type'].'",';
			$row .= '"'.$rdata['disposition_type'].'",';
			$row .= '"'.$rdata['overall_score'].'",';
			$row .= '"'.$rdata['total_score_count'].'",';
			$row .= '"'.$rdata['customer_information'].'",';
			$row .= '"'.$rdata['voice_delivery'].'",';
			$row .= '"'.$rdata['communication_skills'].'",';
			$row .= '"'.$rdata['customer_service'].'",';
			$row .= '"'.$rdata['disposition'].'",';
			$row .= '"'.$rdata['transfer'].'",';
			$row .= '"'.$rdata['protocol'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['feedback'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}
	public function download_qa_rpm_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/qa_rpm_report".get_user_id().".csv";
		$newfile="QA RPM List-".$currDate.".csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	/****************QA Sentry Report*****************/
	public function qa_sentry_report()
	{
		if(check_logged_in())
		{
			$current_user = get_user_id();
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_sentry_report.php";
			$data["content_js"] = "qa_rpm_sentry_js.php";
			$from_date="";
			$to_date="";
			$action="";
			$agent ="";
			$dn_link="";
			$sentry_data = array();

			if($this->input->get('show')=='Show')
			{
				$from_date = $this->input->get('from_date');
				$to_date = $this->input->get('to_date');
				$agent = $this->input->get('agent');
				if($from_date!="" && $to_date!="")
				{
					$sentry_data =	$this->Qa_RPM_Sentry_model->qa_sentry_report(mmddyy2mysql($from_date),mmddyy2mysql($to_date),$agent,$current_user);
				}
				$this->create_qa_sentry_CSV($sentry_data);
				$dn_link = base_url()."reports_qa/download_qa_sentry_CSV";
			}
			$data["from_date"] = $from_date;
            $data["to_date"] = $to_date;
			$data['agent'] = $agent;
			$data['sentry_data'] =	$sentry_data;
			$data['download_link']=$dn_link;
			$data["agent_list"] = $this->Qa_RPM_Sentry_model->get_agent_id(55,174);
			$this->load->view('dashboard',$data);
		}
	}
	/****************QA Sentry CSV Generator*****************/
	public function create_qa_sentry_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/qa_sentry_report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date","Audit Time","Agent","Audit Type","VOC","Caller Name","Caller Date","Caller Phone","Audit Result","Total Score","Total Score Count","Verified Consumer","Advise Recording","Professional","Speech","Objections","Fluidity","Experience","Call Summary","Feedback");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $rdata)
		{


			$row = '"'.$rdata['auditor_name'].'",';
			$row .= '"'.$rdata['audit_date'].'",';
			$row .= '"'.$rdata['audit_time'].'",';
			$row .= '"'.$rdata['agent_name'].'",';
			$row .= '"'.$rdata['audit_type'].'",';
			$row .= '"'.$rdata['voc'].'",';
			$row .= '"'.$rdata['caller_name'].'",';
			$row .= '"'.$rdata['caller_date'].'",';
			$row .= '"'.$rdata['caller_phone'].'",';
			$row .= '"'.$rdata['audit_result'].'",';
			$row .= '"'.$rdata['overall_score'].'",';
			$row .= '"'.$rdata['total_score_count'].'",';
			$row .= $rdata['verified_consumer']==0?'"No",':'"Yes",';
			$row .= $rdata['advise_recording']==0?'"No",':'"Yes",';
			$row .= '"'.$rdata['professional'].'",';
			$row .= '"'.$rdata['speech'].'",';
			$row .= '"'.$rdata['objections'].'",';
			$row .= '"'.$rdata['fluidity'].'",';
			$row .= '"'.$rdata['experience'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['feedback'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}
	public function download_qa_sentry_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/qa_sentry_report".get_user_id().".csv";
		$newfile="QA Sentry List-".$currDate.".csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA RugDoctor REPORT ////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_rugdoctor_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_rugdoctor_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$date_from = $this->input->get('date_from');
			$date_to = $this->input->get('date_to');
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from==""){
				$date_from=CurrDate();
			}else{
				$date_from = mmddyy2mysql($date_from);
			}

			if($date_to==""){
				$date_to=CurrDate();
			}else{
				$date_to = mmddyy2mysql($date_to);
			}

			$data["qa_rugdoctor_list"] = array();

			if($this->input->get('show')=='Show')
			{
				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All") $cond .= "";
				else $cond .=" and audit_type='$audit_type'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else if(get_login_type()=="client"){
					$cond1 .=" And audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name from qa_rugdoctor_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_rugdoctor_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_rugdoctor_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_rugdoctor_list"] = $fullAray;
				$this->create_qa_rugdoctor_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_rugdoctor_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_rugdoctor_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA RugDoctor Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_rugdoctor_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_rugdoctor";
		$edit_url = "mgnt_rugdoctor_feedback_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Phone", "Call Duration", "Customer Name", "Issue", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Greet the caller by Thanking them for the call?", "Comment", "Confirm the customer's identity?", "Comment", "Request for machine serial number?", "Comment", "Identify the correct reason the customer is calling?", "Comment", "Demonstrate active listening skills?", "Comment", "Maintain control of the call?", "Comment", "Words and tone of voice communicates confidence and assurance?", "Comment", "Treat the caller with care?", "Comment", "Avoid long periods of silence?", "Comment", "Follow the correct procedures for telephone handling?", "Comment", "Accurately communicate during the interaction?", "Comment", "Demonstrate efficient and effective use of all systems to handle the call?", "Comment", "Provide correct/complete information based on policies and procedures?", "Comment", "Accurately document the call?", "Comment", "Resolve the customers reason for calling to the extent possible during the interaction?", "Comment", "Offer to provide the customer with their ticket number?", "Comment", "Summarize action taken and ask the customer if there is anything else they need help with?", "Comment", "Educate the customer on self-help options for the future?", "Comment", "Thank the caller for calling?", "Comment", "Overall Score", "Earned Score", "Customer Critical", "Business Critical", "Compliance Critical", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['greeting_caller']==1) $greeting_caller='Yes';
			else $greeting_caller='No';

			if($user['verification_confirm']==2) $verification_confirm='Yes';
			else $verification_confirm='No';

			if($user['verification_request']==2) $verification_request='Yes';
			else $verification_request='No';

			if($user['discovery_identity']==4) $discovery_identity='Yes';
			else $discovery_identity='No';

			if($user['discovery_demo']==1) $discovery_demo='Yes';
			else $discovery_demo='No';

			if($user['customer_maintain']==2) $customer_maintain='Yes';
			else $customer_maintain='No';

			if($user['customer_word']==3) $customer_word='Yes';
			else $customer_word='No';

			if($user['customer_treat']==4) $customer_treat='Yes';
			else $customer_treat='No';

			if($user['customer_avoid']==1) $customer_avoid='Yes';
			else $customer_avoid='No';

			if($user['customer_follow']==1) $customer_follow='Yes';
			else $customer_follow='No';

			if($user['customer_accurate']==1) $customer_accurate='Yes';
			else $customer_accurate='No';

			if($user['skill_demo']==2) $skill_demo='Yes';
			else $skill_demo='No';

			if($user['resolution_provide']==5) $resolution_provide='Yes';
			else $resolution_provide='No';

			if($user['resolution_accurate']==4) $resolution_accurate='Yes';
			else $resolution_accurate='No';

			if($user['resolution_resolve']==5) $resolution_resolve='Yes';
			else $resolution_resolve='No';

			if($user['closing_offer']==1) $closing_offer='Yes';
			else $closing_offer='No';

			if($user['closing_summarize']==1) $closing_summarize='Yes';
			else $closing_summarize='No';

			if($user['closing_educate']==1) $closing_educate='Yes';
			else $closing_educate='No';

			if($user['closing_thank']==1) $closing_thank='Yes';
			else $closing_thank='No';


			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['customer_name'].'",';
			$row .= '"'.$user['issue'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$greeting_caller.'",';
			$row .= '"'.$user['greeting_caller_comment'].'",';
			$row .= '"'.$verification_confirm.'",';
			$row .= '"'.$user['verification_confirm_comment'].'",';
			$row .= '"'.$verification_request.'",';
			$row .= '"'.$user['verification_request_comment'].'",';
			$row .= '"'.$discovery_identity.'",';
			$row .= '"'.$user['discovery_identity_comment'].'",';
			$row .= '"'.$discovery_demo.'",';
			$row .= '"'.$user['discovery_demo_comment'].'",';
			$row .= '"'.$customer_maintain.'",';
			$row .= '"'.$user['customer_maintain_comment'].'",';
			$row .= '"'.$customer_word.'",';
			$row .= '"'.$user['customer_word_comment'].'",';
			$row .= '"'.$customer_treat.'",';
			$row .= '"'.$user['customer_treat_comment'].'",';
			$row .= '"'.$customer_avoid.'",';
			$row .= '"'.$user['customer_avoid_comment'].'",';
			$row .= '"'.$customer_follow.'",';
			$row .= '"'.$user['customer_follow_comment'].'",';
			$row .= '"'.$customer_accurate.'",';
			$row .= '"'.$user['customer_accurate_comment'].'",';
			$row .= '"'.$skill_demo.'",';
			$row .= '"'.$user['skill_demo_comment'].'",';
			$row .= '"'.$resolution_provide.'",';
			$row .= '"'.$user['resolution_provide_comment'].'",';
			$row .= '"'.$resolution_accurate.'",';
			$row .= '"'.$user['resolution_accurate_comment'].'",';
			$row .= '"'.$resolution_resolve.'",';
			$row .= '"'.$user['resolution_resolve_comment'].'",';
			$row .= '"'.$closing_offer.'",';
			$row .= '"'.$user['closing_offer_comment'].'",';
			$row .= '"'.$closing_summarize.'",';
			$row .= '"'.$user['closing_summarize_comment'].'",';
			$row .= '"'.$closing_educate.'",';
			$row .= '"'.$user['closing_educate_comment'].'",';
			$row .= '"'.$closing_thank.'",';
			$row .= '"'.$user['closing_thank_comment'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['point_earned'].'",';
			$row .= '"'.$user['rdCustomerTotal'].'",';
			$row .= '"'.$user['rdBusinessTotal'].'",';
			$row .= '"'.$user['rdComplianceTotal'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////

		public function dipcheck(){
		if(check_logged_in()){

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/dipcheck.php";
			$data["content_js"] = "qa_dipcheck/dipcheck_js.php";

			$SQLtxt ="SELECT * FROM qa_dipcheck ORDER BY id ASC";
			$data_fields = $this->db->query($SQLtxt);

			$data['campaign'] = $data_fields->result();

			$this->load->view("dashboard",$data);

		}
	}

	public function download_dipcheck_rep(){
		if(check_logged_in()){
			if($_GET['process_download'] == "Download" &&  $_GET['campaign_id']!=""){

				$SQLtxt ="SELECT allotted_set_id, exam_status FROM lt_examination INNER JOIN lt_exam_schedule ON lt_examination.id = lt_exam_schedule.exam_id where lt_exam_schedule.exam_id=". $_GET['campaign_id'] ." GROUP BY allotted_set_id";

				$data_fields = $this->db->query($SQLtxt);
				$data['set_count'] = $data_fields->result_array();

				$this->generate_dipcheck_xls($_GET['campaign_id'],$_GET['desc'],$data['set_count']);

			}else{
				redirect('reports_qa/dipcheck','refresh');
			}
		}
	}


	private function generate_dipcheck_xls($campaign_id, $heading, $set_count ){
		if(check_logged_in()){
			$this->objPHPExcel->createSheet();
			$this->objPHPExcel->setActiveSheetIndex();
			$objWorksheet = $this->objPHPExcel->getActiveSheet();
			$objWorksheet->setTitle("Exam Result Report");

			// START GRIDLINES HIDE AND SHOW//
			$objWorksheet->setShowGridlines(true);
			// END GRIDLINES HIDE AND SHOW//
			//$this->objPHPExcel->getDefaultStyle()->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);

		$this->objPHPExcel->getDefaultStyle()->getAlignment()->setWrapText(true);


			$objWorksheet->getColumnDimension('A')->setWidth(15);
			$objWorksheet->getColumnDimension('B')->setWidth(15);
			$objWorksheet->getColumnDimension('C')->setWidth(15);
			$objWorksheet->getColumnDimension('D')->setWidth(15);
			$objWorksheet->getColumnDimension('E')->setWidth(50);
			$objWorksheet->getColumnDimension('F')->setWidth(50);
			$objWorksheet->getColumnDimension('G')->setWidth(50);
			$objWorksheet->getColumnDimension('H')->setWidth(50);
			$objWorksheet->getColumnDimension('I')->setWidth(50);
			$objWorksheet->getColumnDimension('J')->setWidth(50);
			$objWorksheet->getColumnDimension('K')->setWidth(50);
			$objWorksheet->getColumnDimension('L')->setWidth(50);
			$objWorksheet->getColumnDimension('M')->setWidth(50);
			$objWorksheet->getColumnDimension('N')->setWidth(50);
			$objWorksheet->getColumnDimension('O')->setWidth(50);
			$objWorksheet->getColumnDimension('P')->setWidth(50);
			$objWorksheet->getColumnDimension('Q')->setWidth(50);
			$objWorksheet->getColumnDimension('R')->setWidth(50);
			$objWorksheet->getColumnDimension('S')->setWidth(50);
			$objWorksheet->getColumnDimension('T')->setWidth(50);
			$objWorksheet->getColumnDimension('U')->setWidth(50);
			$objWorksheet->getColumnDimension('V')->setWidth(50);

			$style = array(
				'alignment' => array(
					'horizontal' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
				)
			);

			$objWorksheet->getStyle("A1:P1")->applyFromArray($style);
			$sheet = $this->objPHPExcel->getActiveSheet();

			unset($style);

			// CELL BACKGROUNG COLOR
			$this->objPHPExcel->getActiveSheet()->getStyle("A2:O2")->getFill()->applyFromArray(
                $styleArray =array(
								'type' => PHPExcel_Style_Fill::FILL_SOLID,
								'startcolor' => array(
									 'rgb' => "F28A8C"
								),
								'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER
							)
                );

			// CELL FONT AND FONT COLOR
			$styleArray = array(
			'font'  => array(
				'bold'  => true,
				'color' => array('rgb' => '000000'),
				'size'  => 14,
				'name'  => 'Algerian',
				'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
			));

			$style = array(
				'alignment' => array(
					'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
				)
			);

			$this->objPHPExcel->getActiveSheet()->getStyle('A1')->applyFromArray($styleArray);


			$sheet = $this->objPHPExcel->getActiveSheet();
			$sheet->getDefaultStyle()->applyFromArray($style);
			$sheet->setCellValueByColumnAndRow(0, 1, "Dip Check ".$heading);
			$sheet->mergeCells('A1:J1');


					foreach($set_count as $no_set){

					$col1=0;
					$row1=2;

						$SQLtxt = "Select * from lt_questions where set_id = ". $no_set['allotted_set_id'] ." order by id";
						$data_fields1 = $this->db->query($SQLtxt);
						$data['candidate'] = $data_fields1->result_array();

						$header_column = array("SL No","FUSION ID","AGENT NAME","TL Name");

							foreach($header_column as $val){
								if($col1 < 4){
									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col1,2,$val);
									$col1++;
								}
							}

							foreach($data['candidate'] as $excel_header){

									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col1,$row1,$excel_header['title']);
									$col1++;

							}

							/*$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col1,$row1,'Score');
							$fcol = $col1;
							$fcol = $col1+1; */
							$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col1,$row1,'Score Percentage');

					 /*
					    $SQLtxt="Select fusion_id,fname,lname,(Select CONCAT(fname,' ' ,lname) from signin where signin.id=s.assigned_to) as asign_tl, user_id,set_id,exam_id,exam_schedule_id,ques_id,ans_id, (SELECT text FROM lt_questions_ans_options QA_O WHERE QA_O.id = ua.ans_id )AS User_answer from lt_exam_schedule x inner JOIN lt_questions y on y.set_id = x.allotted_set_id
						inner JOIN lt_user_exam_answer ua on ua.exam_schedule_id = x.id and ua.ques_id = y.id
						left JOIN signin s on s.id = x.user_id
						where exam_id =". $campaign_id ." and allotted_set_id = ". $no_set['allotted_set_id'] ."
						order by user_id,ques_id";
					*/

					   $SQLtxt="Select fusion_id,fname,lname,(Select CONCAT(fname,' ' ,lname) from signin where signin.id=s.assigned_to) as asign_tl, user_id,set_id,exam_id,exam_schedule_id, ua.ques_id, no_of_question, ans_id, QA_O.text AS User_answer, QA_O.correct_answer from lt_exam_schedule x
						inner JOIN lt_questions y on y.set_id = x.allotted_set_id
						inner JOIN lt_user_exam_answer ua on ua.exam_schedule_id = x.id and ua.ques_id = y.id
						LEFT JOIN lt_questions_ans_options QA_O ON QA_O.id=ua.ans_id
						left JOIN signin s on s.id = x.user_id
						where exam_id =". $campaign_id ." and allotted_set_id = ". $no_set['allotted_set_id'] ."
						order by user_id,ques_id";


						$data_fields1 = $this->db->query($SQLtxt);
						$data['Questions'] = $data_fields1->result_array();


						$no_of_question=$data['Questions'][0]['no_of_question'];

						$col=0;
						$row=2;
						$cnt=1;

							$correct_answer=0;
							$old_fusion_id='';
							/* for($i=0;$i<count($data['Questions']);$i++){ */
							foreach($data['Questions'] as $recRow){
							 if($recRow['User_answer'] =='') $recRow['User_answer'] ="NA";

								//if($data['Questions'][$i]['fusion_id'] != $old_fusion_id){
								if($recRow['fusion_id'] == $old_fusion_id ){

									$col++;
									$correct_answer += $recRow['correct_answer'];
									//FOR COLOR TEST LIGHT GREEN
									if($recRow['correct_answer'] == 1){
										$this->objPHPExcel->getActiveSheet()->getStyleByColumnAndRow($col,$row)->getFill()->setFillType(PHPExcel_Style_Fill::FILL_SOLID)->getStartColor()->setARGB('CCFF99');
									}
									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col,$row, $recRow['User_answer']  );

									//$this->objPHPExcel->getActiveSheet()->getStyleByColumnAndRow($col1, $row)->getNumberFormat()->setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_PERCENTAGE);

									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col1,$row, ($correct_answer / $no_of_question));


								}else{


									$old_fusion_id =  $recRow['fusion_id'];
									$correct_answer=0;
									$col=0;
									$row++;
									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col,$row, $cnt++ );
									$col++;
									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col,$row, $recRow['fusion_id'] );
									$col++;
									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col,$row, $recRow['fname']." ".$recRow['lname'] );
									$col++;
									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col,$row, $recRow['asign_tl'] );
									$col++;
									//FOR COLOR TEST LIGHT GREEN
									if($recRow['correct_answer'] == 1){
										$this->objPHPExcel->getActiveSheet()->getStyleByColumnAndRow($col,$row)->getFill()->setFillType(PHPExcel_Style_Fill::FILL_SOLID)->getStartColor()->setARGB('CCFF99');
									}

									$this->objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($col,$row, $recRow['User_answer']  );
									$correct_answer += $recRow['correct_answer'];


								}



							}

					}



		    ob_end_clean();
            header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
            header('Content-Disposition: attachment;filename="dipcheck_'.$heading.'.xlsx"');
            header('Cache-Control: max-age=0');
            $objWriter = PHPExcel_IOFactory::createWriter($this->objPHPExcel , 'Excel2007');
            $objWriter->setIncludeCharts(TRUE);
            $objWriter->save('php://output');
			exit();

		}
	}



	///////////////////////////////////////////////////////////////////////////

/*------------------QA OYO Report-----------------------------*/
	public function qa_oyo_report(){
		if(check_logged_in()){
			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data['location_list'] = $this->Common_model->get_office_location_list();
			$office_id = $this->input->get('office_id');
			if($office_id=="")  $office_id=$user_office_id;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_oyo_report.php";
			$data["content_js"] = "qa_oyo/uk_us_js.php";
			//$data["content_js"] = "qa_idfc_js.php";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$pValue = trim($this->input->post('process_id'));
			if($pValue=="") $pValue = trim($this->input->get('process_id'));
			$lob = trim($this->input->get('lob'));
			$data['pValue']=$pValue;
			$data['lob']=$lob;
			$data["qa_oyo_list"] = array();
			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				$field_array = array(
						"date_from"=>$date_from,
						"date_to" => $date_to,
						"office_id" => $office_id,
						"process_id" => $pValue,
						"lob" => $lob,
						"current_user" => $current_user
					);


				if($pValue=='OYO IBD'){
					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_ibd_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_ibd_CSV";

				}else if($pValue=='OYO SIG'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_sig_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_sig_CSV";

				}else if($pValue=='OYO LIFE'){

					if($lob=='IB/OB'){
						$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
						$data["qa_oyo_list"] = $fullAray;
						$this->create_qa_oyolife_ibob_CSV($fullAray);
						$dn_link = base_url()."reports_qa/download_qa_oyolife_ibob_CSV";
					}else{
						$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
						$data["qa_oyo_list"] = $fullAray;
						$this->create_qa_oyolife_followup_CSV($fullAray,$lob);
						$dn_link = base_url()."reports_qa/download_qa_oyolife_followup_CSV/".$lob;
					}

				}else if($pValue=='Social Media RCA'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_sme_rca_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_sme_rca_CSV";

				}else if($pValue=='OYO/WALLET/RECHARGE'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_wallet_recharge_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_wallet_recharge_CSV";

				}else if($pValue=='OYO/ESAL'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_esal_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_esal_CSV";

				}else if($pValue=='UK/US'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_uk_us_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_uk_us_CSV";

				}else if($pValue=='UK/US/NEW'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_uk_us_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_uk_us_new_CSV";

				}else if($pValue=='OYOINB'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyoinb_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyoinb_new_CSV";

				}else if($pValue=='OYOINB Hygiene'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyoinb_hygiene_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyoinb_hygiene_CSV";

				}else if($pValue=='booking_lost_validation'){
					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_booking_lost_validation_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_booking_lost_validation_CSV";
				}else if($pValue=='Booking_status_check'){

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_Booking_status_check_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_Booking_status_check_CSV";

				}else if($pValue=='OYO SIG New' || $pValue=='oyo_sigchat_service' || $pValue=='oyo_sigchat_escalation'){
					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyosig_new_CSV($fullAray,$pValue);
					$dn_link = base_url()."reports_qa/download_qa_oyosig_new_CSV/".$pValue;
				}else{

					$fullAray = $this->reports_model->qa_oyo_report_model($field_array);
					$data["qa_oyo_list"] = $fullAray;
					$this->create_qa_oyo_dsat_rcasig_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_oyo_dsat_rcasig_CSV";

				}

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


/*---------OYO IBD CSS Part Start-----------*/
	public function download_qa_oyo_ibd_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO International List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyo_ibd_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Fusion ID", "Agent Name", "L1 Supervisor", "Phone", "Call Duration", "Recorded Date Time", "Mail ID", "Booking ID", "Audit Date", "Auditor Name", "Call Type", "Campiagn", "opening and Branding", "Acknowledgment", "Personalization", "Verification Process", "Politeness", "Empathy", "Overlapping", "Relevant Probing", "Enthusiasm", "Switch Language", "Voice Clarity", "Intonation", "Grammar", "Transfer", "Dead Air", "Complaint", "Selling Efforts", "Rebuttals", "USPS", " Payment Confirmation", "Retention", "Ownership", "Disclosure", "CRS", "Adherence", "Summarization", "IVR", "Further Assistance", "Closing", "Overall Result", "Overall Score","Call Summary", "Feedback", "Infraction Stat", "Remarks", "Agent Review Date", "Agent Review Comment", "Mgnt Review Date", "Mgnt Review Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$row = '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['agent_name'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['agent_phone'].'",';
			$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
			$row .= '"'.ConvServerToLocal($user['record_date_time']).'",';
			$row .= '"'.$user['mail_id'].'",';
			$row .= '"'.$user['booking_id'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['process_name'].'",';
			$row .= '"'.$user['opening_and_branding'].'",';
			$row .= '"'.$user['acknowledgement'].'",';
			$row .= '"'.$user['personalization'].'",';
			$row .= '"'.$user['verification_process'].'",';
			$row .= '"'.$user['politeness'].'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'.$user['overlapping'].'",';
			$row .= '"'.$user['relevant_probing'].'",';
			$row .= '"'.$user['enthusiasm'].'",';
			$row .= '"'.$user['switch_language'].'",';
			$row .= '"'.$user['voice_clarity'].'",';
			$row .= '"'.$user['intonation'].'",';
			$row .= '"'.$user['grammar'].'",';
			$row .= '"'.$user['transfer'].'",';
			$row .= '"'.$user['dead_air'].'",';
			$row .= '"'.$user['complaint'].'",';
			$row .= '"'.$user['selling_efforts'].'",';
			$row .= '"'.$user['rebuttals'].'",';
			$row .= '"'.$user['usps'].'",';
			$row .= '"'.$user['payment_confirmation'].'",';
			$row .= '"'.$user['retention'].'",';
			$row .= '"'.$user['ownership'].'",';
			$row .= '"'.$user['disclosure'].'",';
			$row .= '"'.$user['crs'].'",';
			$row .= '"'.$user['adherence'].'",';
			$row .= '"'.$user['summarization'].'",';
			$row .= '"'.$user['ivr'].'",';
			$row .= '"'.$user['further_assistance'].'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'.$user['overall_result'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['infraction_stat'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_type'])).'",';
			$row .= '"'.$user['agent_rvw_dt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw'])).'",';
			$row .= '"'.$user['mgnt_rvw_dt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw'])).'",';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/*----------------OYO SIG CSS Part Start--------------------*/
	public function download_qa_oyo_sig_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO SIG List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyo_sig_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Fusion ID", "Agent Name", "Tenurity", "Batch Code", "C-zentrix", "L1 Supervisor", "Call Duration", "Recorded Date Time", "Booking ID", "Audit Date", "Auditor Name", "Call Type", "Ticket ID", "Phone", "Campaign", "Audit Type", "VOC", "Overall Score", "Overall Result", "Call Summary", "Feedback", "call Open 5sec", "call Open Self Intro", "call Open Score", "Probing Issue Indetify", "Probing Responce Positively", "Probing Effective", "Probing Score", "Soft Skill Apology", "Soft Skill Voice Intonation", "Soft Skill Active Listening", "Soft Skill Confidence", "Soft Skill Politeness", "Soft Skill Grammar", "Soft Skill Acknowledgment", "Soft Skill Score", "Hold Dead Ask Permission", "Hold Dead Unhold Procedure", "Hold Dead Took Guest Permission *", "Hold Dead do not Refresh *", "Hold Dead avoid Dead Air", "Hold Dead Score", "Resolution Fatal Correct Booking *", "Resolution Fatal Correct Information *", "Resolution Fatal Correct Refund *", "Resolution Fatal Proper Follow up *", "Resolution Fatal Recon Adjustment *", "Resolution Fatal Score", "Resolution Nonfatal gnc Closure", "Resolution Nonfatal Duplicate Ticket", "Resolution Nonfatal ccb Process", "Resolution Nonfatal case Library", "Resolution Nonfatal Email to Sent", "Resolution Nonfatal Score", "Fresh Desk Complete Notes", "Fresh Desk Tagging Issue *", "Fresh Desk Incorrect Shifting *", "Fresh Desk Correct Ticket Status *", "Fresh Desk did Agent Verify *", "Fresh Desk Agent meet Compliant *", "Fresh Desk Score", "Closing Further Assistance", "Closing Done Branding", "Closing G-sat Survey Pitched", "Closing G-sat Survey Avoidance *", "OYO Assist Pitch", "Closing Score", "Wow Factor Call Take Positive", "Agent Review Date", "Agent Comment", "Management Review Date", "Management Comment", "Coach Name");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['cl_open_5_sec']==2) $cl_open_5_sec='Pass';
			else if($user['cl_open_5_sec']==2.1) $cl_open_5_sec='N/A';
			else $cl_open_5_sec='Fail';

			if($user['cl_open_self_intro']==2) $cl_open_self_intro='Pass';
			else if($user['cl_open_self_intro']==2.1) $cl_open_self_intro='N/A';
			else $cl_open_self_intro='Fail';

			if($user['probing_issue_indetify']==2) $probing_issue_indetify='Pass';
			else if($user['probing_issue_indetify']==2.1) $probing_issue_indetify='N/A';
			else $probing_issue_indetify='Fail';

			if($user['probing_responce_positively']==2) $probing_responce_positively='Pass';
			else if($user['probing_responce_positively']==2.1) $probing_responce_positively='N/A';
			else $probing_responce_positively='Fail';

			if($user['probing_effective']==2) $probing_effective='Pass';
			else if($user['probing_effective']==2.1) $probing_effective='N/A';
			else $probing_effective='Fail';

			if($user['soft_skill_apology']==3) $soft_skill_apology='Pass';
			else if($user['soft_skill_apology']==3.1) $soft_skill_apology='N/A';
			else $soft_skill_apology='Fail';

			if($user['soft_skill_voice_intonation']==1) $soft_skill_voice_intonation='Pass';
			else if($user['soft_skill_voice_intonation']==1.1) $soft_skill_voice_intonation='N/A';
			else $soft_skill_voice_intonation='Fail';

			if($user['soft_skill_active_listening']==3) $soft_skill_active_listening='Pass';
			else if($user['soft_skill_active_listening']==3.1) $soft_skill_active_listening='N/A';
			else $soft_skill_active_listening='Fail';

			if($user['soft_skill_confidence']==2) $soft_skill_confidence='Pass';
			else if($user['soft_skill_confidence']==2.1) $soft_skill_confidence='N/A';
			else $soft_skill_confidence='Fail';

			if($user['soft_skill_politeness']==2) $soft_skill_politeness='Pass';
			else if($user['soft_skill_politeness']==2.1) $soft_skill_politeness='N/A';
			else $soft_skill_politeness='Fail';

			if($user['soft_skill_grammar']==2) $soft_skill_grammar='Pass';
			else if($user['soft_skill_grammar']==2.1) $soft_skill_grammar='N/A';
			else $soft_skill_grammar='Fail';

			if($user['soft_skill_acknowledgement']==2) $soft_skill_acknowledgement='Pass';
			else if($user['soft_skill_acknowledgement']==2.1) $soft_skill_acknowledgement='N/A';
			else $soft_skill_acknowledgement='Fail';

			if($user['hold_dead_ask_permission']==2) $hold_dead_ask_permission='Pass';
			else if($user['hold_dead_ask_permission']==2.1) $hold_dead_ask_permission='N/A';
			else $hold_dead_ask_permission='Fail';

			if($user['hold_dead_unhold_procedure']==2) $hold_dead_unhold_procedure='Pass';
			else if($user['hold_dead_unhold_procedure']==2.1) $hold_dead_unhold_procedure='N/A';
			else $hold_dead_unhold_procedure='Fail';

			if($user['hold_dead_took_guest_permission']==2) $hold_dead_took_guest_permission='Pass';
			else if($user['hold_dead_took_guest_permission']==2.1) $hold_dead_took_guest_permission='N/A';
			else $hold_dead_took_guest_permission='Fail';

			if($user['hold_dead_do_not_refresh']==2) $hold_dead_do_not_refresh='Pass';
			else if($user['hold_dead_do_not_refresh']==2.1) $hold_dead_do_not_refresh='N/A';
			else $hold_dead_do_not_refresh='Fail';

			if($user['hold_dead_avoid_dead_air']==2) $hold_dead_avoid_dead_air='Pass';
			else if($user['hold_dead_avoid_dead_air']==2.1) $hold_dead_avoid_dead_air='N/A';
			else $hold_dead_avoid_dead_air='Fail';

			if($user['resolution_fatal_correct_booking']==3) $resolution_fatal_correct_booking='Pass';
			else if($user['resolution_fatal_correct_booking']==3.1) $resolution_fatal_correct_booking='N/A';
			else $resolution_fatal_correct_booking='Fail';

			if($user['resolution_fatal_correct_information']==3) $resolution_fatal_correct_information='Pass';
			else if($user['resolution_fatal_correct_information']==3.1) $resolution_fatal_correct_information='N/A';
			else $resolution_fatal_correct_information='Fail';

			if($user['resolution_fatal_correct_refund']==3) $resolution_fatal_correct_refund='Pass';
			else if($user['resolution_fatal_correct_refund']==3.1) $resolution_fatal_correct_refund='N/A';
			else $resolution_fatal_correct_refund='Fail';

			if($user['resolution_fatal_proper_follow_up']==3) $resolution_fatal_proper_follow_up='Pass';
			else if($user['resolution_fatal_proper_follow_up']==3.1) $resolution_fatal_proper_follow_up='N/A';
			else $resolution_fatal_proper_follow_up='Fail';

			if($user['resolution_fatal_recon_adjustment']==3) $resolution_fatal_recon_adjustment='Pass';
			else if($user['resolution_fatal_recon_adjustment']==3.1) $resolution_fatal_recon_adjustment='N/A';
			else $resolution_fatal_recon_adjustment='Fail';

			if($user['resolution_nonfatal_gnc_closure']==3) $resolution_nonfatal_gnc_closure='Pass';
			else if($user['resolution_nonfatal_gnc_closure']==3.1) $resolution_nonfatal_gnc_closure='N/A';
			else $resolution_nonfatal_gnc_closure='Fail';

			if($user['resolution_nonfatal_gnc_closure']==3) $resolution_nonfatal_gnc_closure='Pass';
			else if($user['resolution_nonfatal_gnc_closure']==3.1) $resolution_nonfatal_gnc_closure='N/A';
			else $resolution_nonfatal_gnc_closure='Fail';

			if($user['resolution_nonfatal_duplicate_ticket']==3) $resolution_nonfatal_duplicate_ticket='Pass';
			else if($user['resolution_nonfatal_duplicate_ticket']==3.1) $resolution_nonfatal_duplicate_ticket='N/A';
			else $resolution_nonfatal_duplicate_ticket='Fail';

			if($user['resolution_nonfatal_ccb_process']==2) $resolution_nonfatal_ccb_process='Pass';
			else if($user['resolution_nonfatal_ccb_process']==2.1) $resolution_nonfatal_ccb_process='N/A';
			else $resolution_nonfatal_ccb_process='Fail';

			if($user['resolution_nonfatal_case_library']==4) $resolution_nonfatal_case_library='Pass';
			else if($user['resolution_nonfatal_case_library']==4.1) $resolution_nonfatal_case_library='N/A';
			else $resolution_nonfatal_case_library='Fail';

			if($user['resolution_nonfatal_email_to_sent']==4) $resolution_nonfatal_email_to_sent='Pass';
			else if($user['resolution_nonfatal_email_to_sent']==4.1) $resolution_nonfatal_email_to_sent='N/A';
			else $resolution_nonfatal_email_to_sent='Fail';

			if($user['fresh_desk_complete_notes']==6) $fresh_desk_complete_notes='Pass';
			else if($user['fresh_desk_complete_notes']==6.1) $fresh_desk_complete_notes='N/A';
			else $fresh_desk_complete_notes='Fail';

			if($user['fresh_desk_tagging_issue']==4) $fresh_desk_tagging_issue='Pass';
			else if($user['fresh_desk_tagging_issue']==4.1) $fresh_desk_tagging_issue='N/A';
			else $fresh_desk_tagging_issue='Fail';

			if($user['fresh_desk_incorrect_shifting']==3) $fresh_desk_incorrect_shifting='Pass';
			else if($user['fresh_desk_incorrect_shifting']==3.1) $fresh_desk_incorrect_shifting='N/A';
			else $fresh_desk_incorrect_shifting='Fail';

			if($user['fresh_desk_correct_ticket_status']==4) $fresh_desk_correct_ticket_status='Pass';
			else if($user['fresh_desk_correct_ticket_status']==4.1) $fresh_desk_correct_ticket_status='N/A';
			else $fresh_desk_correct_ticket_status='Fail';

			if($user['fresh_desk_did_agent_verify']==2) $fresh_desk_did_agent_verify='Pass';
			else if($user['fresh_desk_did_agent_verify']==2.1) $fresh_desk_did_agent_verify='N/A';
			else $fresh_desk_did_agent_verify='Fail';

			if($user['fresh_desk_agent_meet_compliant']==3) $fresh_desk_agent_meet_compliant='Pass';
			else if($user['fresh_desk_agent_meet_compliant']==3.1) $fresh_desk_agent_meet_compliant='N/A';
			else $fresh_desk_agent_meet_compliant='Fail';

			if($user['closing_further_assistance']==2) $closing_further_assistance='Pass';
			else if($user['closing_further_assistance']==2.1) $closing_further_assistance='N/A';
			else $closing_further_assistance='Fail';

			if($user['closing_done_branding']==2) $closing_done_branding='Pass';
			else if($user['closing_done_branding']==2.1) $closing_done_branding='N/A';
			else $closing_done_branding='Fail';

			if($user['closing_gsat_survey_pitched']==4) $closing_gsat_survey_pitched='Pass';
			else if($user['closing_gsat_survey_pitched']==4.1) $closing_gsat_survey_pitched='N/A';
			else $closing_gsat_survey_pitched='Fail';

			if($user['closing_gsat_survey_avoidance']==2) $closing_gsat_survey_avoidance='Pass';
			else if($user['closing_gsat_survey_avoidance']==2.1) $closing_gsat_survey_avoidance='N/A';
			else $closing_gsat_survey_avoidance='Fail';

			if($user['oyo_assist_pitch']==2) $oyo_assist_pitch='Pass';
			else if($user['oyo_assist_pitch']==2.1) $oyo_assist_pitch='N/A';
			else $oyo_assist_pitch='Fail';

			$row = '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['agent_name'].'",';
			$row .= '"'.$user['tenurity'].'",';
			$row .= '"'.$user['batch_code'].'",';
			$row .= '"'.$user['czentrix'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
			$row .= '"'.ConvServerToLocal($user['record_date_time']).'",';
			$row .= '"'.$user['booking_id'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['ticket_id'].'",';
			$row .= '"'.$user['guest_phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['overall_result'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$cl_open_5_sec.'",';
			$row .= '"'.$cl_open_self_intro.'",';
			$row .= '"'.$user['cl_open_overall_score'].'",';
			$row .= '"'.$probing_issue_indetify.'",';
			$row .= '"'.$probing_responce_positively.'",';
			$row .= '"'.$probing_effective.'",';
			$row .= '"'.$user['probing_overall_score'].'",';
			$row .= '"'.$soft_skill_apology.'",';
			$row .= '"'.$soft_skill_voice_intonation.'",';
			$row .= '"'.$soft_skill_active_listening.'",';
			$row .= '"'.$soft_skill_confidence.'",';
			$row .= '"'.$soft_skill_politeness.'",';
			$row .= '"'.$soft_skill_grammar.'",';
			$row .= '"'.$soft_skill_acknowledgement.'",';
			$row .= '"'.$user['soft_skill_overall_score'].'",';
			$row .= '"'.$hold_dead_ask_permission.'",';
			$row .= '"'.$hold_dead_unhold_procedure.'",';
			$row .= '"'.$hold_dead_took_guest_permission.'",';
			$row .= '"'.$hold_dead_do_not_refresh.'",';
			$row .= '"'.$hold_dead_avoid_dead_air.'",';
			$row .= '"'.$user['hold_dead_overall_score'].'",';
			$row .= '"'.$resolution_fatal_correct_booking.'",';
			$row .= '"'.$resolution_fatal_correct_information.'",';
			$row .= '"'.$resolution_fatal_correct_refund.'",';
			$row .= '"'.$resolution_fatal_proper_follow_up.'",';
			$row .= '"'.$resolution_fatal_recon_adjustment.'",';
			$row .= '"'.$user['resolution_fatal_overall_score'].'",';
			$row .= '"'.$resolution_nonfatal_gnc_closure.'",';
			$row .= '"'.$resolution_nonfatal_duplicate_ticket.'",';
			$row .= '"'.$resolution_nonfatal_ccb_process.'",';
			$row .= '"'.$resolution_nonfatal_case_library.'",';
			$row .= '"'.$resolution_nonfatal_email_to_sent.'",';
			$row .= '"'.$user['resolution_nonfatal_overall_score'].'",';
			$row .= '"'.$fresh_desk_complete_notes.'",';
			$row .= '"'.$fresh_desk_tagging_issue.'",';
			$row .= '"'.$fresh_desk_incorrect_shifting.'",';
			$row .= '"'.$fresh_desk_correct_ticket_status.'",';
			$row .= '"'.$fresh_desk_did_agent_verify.'",';
			$row .= '"'.$fresh_desk_agent_meet_compliant.'",';
			$row .= '"'.$user['fresh_desk_overall_score'].'",';
			$row .= '"'.$closing_further_assistance.'",';
			$row .= '"'.$closing_done_branding.'",';
			$row .= '"'.$closing_gsat_survey_pitched.'",';
			$row .= '"'.$closing_gsat_survey_avoidance.'",';
			$row .= '"'.$oyo_assist_pitch.'",';
			$row .= '"'.$user['closing_overall_score'].'",';
			$row .= '"'.$user['wow_factor_cl_take_positive'].'",';
			$row .= '"'.$user['review_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agnt_comnt'])).'",';
			$row .= '"'.$user['mgnt_review_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_comnt'])).'",';
			$row .= '"'.$user['coach_name'].'",';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/*---------OYO RCA CSS Part Start-----------*/
	public function download_qa_oyo_dsat_rcasig_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO DSAT SIG RCA List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_oyo_dsat_rcasig_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor", "Ticket ID", "Rating", "Czentrix ID", "Issue Category", "Issue Subcategory", "Guest Call Issue", "Control/Uncontrol", "ACPT", "WHY1", "WHY2", "Call Summary", "Feedback");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['agent_name'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['ticket_id'].'",';
			$row .= '"'.$user['rating'].'",';
			$row .= '"'.$user['czentrix_id'].'",';
			$row .= '"'.$user['sigrca_cat'].'",';
			$row .= '"'.$user['sigrca_subcat'].'",';
			$row .= '"'.$user['guest_call_issue'].'",';
			$row .= '"'.$user['control_uncontrol'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['why1'].'",';
			$row .= '"'.$user['why2'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/*---------OYO  Social Media Escalation RCA CSS Part Start-----------*/
	public function download_qa_oyo_sme_rca_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO Social Media Escalation RCA List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_oyo_sme_rca_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "Campaign", "L1 Supervisor", "Booking ID", "Ticket1", "Ticket2", "Ticket3", "Caller No", "ORM Ticket", "Complaint Type", "Transaction", "Defective Transaction", "Escalated Date", "Week", "Call Date", "Fusion Prevent", "Monetory Loss", "Amount", "ACPT", "WHY1", "WHY2", "Action Policy", "Call Summary", "Feedback");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['agent_name'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['booking_id'].'",';
			$row .= '"'.$user['ticket1'].'",';
			$row .= '"'.$user['ticket2'].'",';
			$row .= '"'.$user['ticket3'].'",';
			$row .= '"'.$user['caller_no'].'",';
			$row .= '"'.$user['orm_ticket'].'",';
			$row .= '"'.$user['complaint_type'].'",';
			$row .= '"'.$user['transaction'].'",';
			$row .= '"'.$user['defective_transaction'].'",';
			$row .= '"'.$user['escalated_date'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.ConvServerToLocal($user['call_date']).'",';
			$row .= '"'.$user['fusion_prevent'].'",';
			$row .= '"'.$user['monetory_loss'].'",';
			$row .= '"'.$user['amount'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['why1'].'",';
			$row .= '"'.$user['why2'].'",';
			$row .= '"'.$user['action_policy'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/*----------------OYO LIFE IB/OB CSS Part Start--------------------*/
	public function download_qa_oyolife_ibob_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO Life Inbound/Outbound List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyolife_ibob_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Fusion ID", "Agent Name", "L1 Supervisor", "Campaign", "Auditor", "Audit Date Time", "Call Date Time", "Call Duration", "Phone", "LOB", "Audit Type", "VOC", "Welcome the Customer", "WC Reason", "Know the Customer", "KYC Reason", "Effective Communication", "EC Reason", "Building Rapport", "BR Reason", "Maintain Courtesy", "MC Reason", "Probing Assistance *", "PA Reason *", "Significance of Information *", "SI Reason *", "Action for Solution *", "AS Reason *", "Proper Documentation", "PD Reason", "Zero Tolerance Policy *", "ZTP Reason *", "Overall Score", "Agent Disposition", "Actual Disposition", "Correct/Incorrect", "Opportunity/Non Opportunity", "Rebuttals/Probing Used", "ACPT", "Observation L1", "Audit Observations", "Agent informed the customer about creating a SAV?", "Customer agreed for a SAV?", "Correct property details & Pricing pitched?", "Valid / Invalid?", "Call Summary", "Feedback", "Agent Review Date", "Agent Review Comment", "Mgnt Reviewed By", "Mgnt Review Date", "Mgnt Review Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['welcome_customer']=='0') $welcome_customer='0%';
			else $welcome_customer='100%';
			if($user['know_customer']=='0') $know_customer='0%';
			else $know_customer='100%';
			if($user['effective_communication']=='0') $effective_communication='0%';
			else $effective_communication='100%';
			if($user['building_rapport']=='0') $building_rapport='0%';
			else $building_rapport='100%';
			if($user['maintain_courtesy']=='0') $maintain_courtesy='0%';
			else $maintain_courtesy='100%';
			if($user['probing_assistance']=='-1') $probing_assistance='0%';
			else $probing_assistance='100%';
			if($user['significance_info']=='-1') $significance_info='0%';
			else $significance_info='100%';
			if($user['action_solution']=='-1') $action_solution='0%';
			else $action_solution='100%';
			if($user['proper_docu']=='0') $proper_docu='0%';
			else $proper_docu='100%';


			$row = '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['auditor_name'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.ConvServerToLocal($user['call_date_time']).'",';
			$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['lob'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$welcome_customer.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['wc_reason'])).'",';
			$row .= '"'.$know_customer.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['kyc_reason'])).'",';
			$row .= '"'.$effective_communication.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ec_reason'])).'",';
			$row .= '"'.$building_rapport.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['br_reason'])).'",';
			$row .= '"'.$maintain_courtesy.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mc_reason'])).'",';
			$row .= '"'.$probing_assistance.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['pa_reason'])).'",';
			$row .= '"'.$significance_info.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['si_reason'])).'",';
			$row .= '"'.$action_solution.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['as_reason'])).'",';
			$row .= '"'.$proper_docu.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['pd_reason'])).'",';
			$row .= '"'.$user['zero_tolerance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ztp_reason'])).'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_disposition'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['actual_dispo'])).'",';
			$row .= '"'.$user['correct_incorrect'].'",';
			$row .= '"'.$user['oppor_nonoppor'].'",';
			$row .= '"'.$user['rebuttals_probing'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['acpt'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['observation_l1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['audit_observe'])).'",';
			$row .= '"'.$user['agent_info'].'",';
			$row .= '"'.$user['customer_agreed'].'",';
			$row .= '"'.$user['correct_property'].'",';
			$row .= '"'.$user['valid_invalid'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/*----------------OYO LIFE FOLLOW UP CSS Part Start--------------------*/
	public function download_qa_oyolife_followup_CSV($lob)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";

		if($lob=='Booking'){
			$newfile="QA OYO Life Booking List-'".$currDate."'.csv";
		}else{
			$newfile="QA OYO Life Follow Up List-'".$currDate."'.csv";
		}

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyolife_followup_CSV($rr,$lob)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Fusion ID", "Agent Name", "L1 Supervisor", "Auditor", "Audit Date Time", "Call Date Time", "Call Duration", "Phone", "Campaign", "Audit Type", "VOC", "Opening", "Opening Reason", "Product *", "Product Reason *", "Rebuttals *", "Rebuttals Reason *", "Sales Effort *", "Sales Effort Reason *", "Closing", "Closing Reason", "Compliance", "Compliance Reason", "Zero Tolerance Policy *", "ZTP Reason *", "Overall Score", "Agent Disposition", "Actual Disposition", "Correct/Incorrect", "ACPT", "Audit Observations", "L1 Observation", "Call Summary", "Feedback", "Agent Review Date", "Agent Review Comment", "Mgnt Reviewed By", "Mgnt Review Date", "Mgnt Review Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['opening']=='0') $opening='0%';
			else $opening='100%';
			if($user['product']=='-1') $product='0%';
			else $product='100%';
			if($user['rebuttals']=='-1') $rebuttals='0%';
			else $rebuttals='100%';
			if($user['sales_effort']=='-1') $sales_effort='0%';
			else $sales_effort='100%';
			if($user['closing']=='0') $closing='0%';
			else $closing='100%';
			if($user['compliance']=='0') $compliance='0%';
			else $compliance='100%';


			$row = '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['auditor_name'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.ConvServerToLocal($user['call_date_time']).'",';
			$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$opening.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['opening_reason'])).'",';
			$row .= '"'.$product.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['product_reason'])).'",';
			$row .= '"'.$rebuttals.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['rebuttals_reason'])).'",';
			$row .= '"'.$sales_effort.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['sales_effort_reason'])).'",';
			$row .= '"'.$closing.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['closing_reason'])).'",';
			$row .= '"'.$compliance.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['compliance_reason'])).'",';
			$row .= '"'.$user['zero_tolerance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ztp_reason'])).'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_dispo'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['actual_dispo'])).'",';
			$row .= '"'.$user['correct_incorrect'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['acpt'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['audit_observe'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['l1_observe'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/*----------------OYO UK / US CSS Part Start--------------------*/
	public function download_qa_oyo_uk_us_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO UK/US Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyo_uk_us_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Tenure (in Days)", "Tenure Bucket", "Recording Date and Time", "Avaya ID", "Call Duration", "Phone", "Booking ID", "Geography to be audited", "Type of Audit", "Cancellation Sub Type", "Call Type", "Can be Automated", "Call Sub Type", "Tagging by Agent - Call Type", "Tagging by Agent - Call Sub Type", "Audit Type", "Auditor Type", "VOC","Prepay Adharance", "ACPT","Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
			"Delayed Opening >5 sec",
			"Was the opening correct?",
			"Did the agent ask for further assistance?",
			"Was the closure correct?",
			"Was there any grammatical error on the call?",
			"Was there any MTI observed on the call?",
			"Did the agent display active listening skills on the call?",
			"Did the agent do relevant probing?",
			"Did the agent provide the correct tariff room category etc?",
			"Did the agent pitch for additional nights?",
			"Did the agent create urgency on call?",
			"Did the agent give the property details with the DID information?",
			"Did the agent check with the PM?",
			"Did the agent summarize the call?",
			"Did the agent effectively pitch for on-call payment?",
			"Was the tagging/disposition correct?",
			"Did the agent adhere to the SOP?",
			"Did the agent provide any incorrect or misleading information to the customer?",
			"Was there any ZTP observed on the call?",
			"Did the agent capture correct information of the customer?",
			"Did the agent give all the mandatory information?",
			"Did the agent create correct booking?",
			"Was the agent polite/courteous on the call?",
			"Did the agent show empathy/acknowledgement/apology when required?",
			"Did the agent take the name of the customer atleast once on the call?",
			"Was there any dead air on the call?",
			"Did the agent follow hold procedure?",
			"Was the agent energetic throughout the call?",
			"Call Summary", "Feedback", "L1","L2", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			if($user['tenure']>='0' && $user['tenure']<='30'){
				$tenure_bucket = "0-30";
			}else if($user['tenure']>'30' && $user['tenure']<='60'){
				$tenure_bucket = "31-60";
			}else if($user['tenure']>'60' && $user['tenure']<='90'){
				$tenure_bucket = "61-90";
			}else if($user['tenure']>'90'){
				$tenure_bucket = "91 and Above";
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$tenure_bucket.'",';
			$row .= '"'.ConvServerToLocal($user['call_date']).'",';
			$row .= '"'.$user['avaya_id'].'",';
			$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['booking_id'].'",';
			$row .= '"'.$user['geography_audit'].'",';
			$row .= '"'.$user['type_audit'].'",';
			$row .= '"'.$user['cancel_sub_audit_type'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['can_automated'].'",';
			$row .= '"'.$user['call_sub_type'].'",';
			$row .= '"'.$user['agent_call_type'].'",';
			$row .= '"'.$user['agent_call_sub_type'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['prepay_adharance'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['delayed_opening'].'",';
			$row .= '"'.$user['was_opening_correct'].'",';
			$row .= '"'.$user['agent_ask_further_assistance'].'",';
			$row .= '"'.$user['was_closure_correct'].'",';
			$row .= '"'.$user['grammatical_error'].'",';
			$row .= '"'.$user['MTI_observed_call'].'",';
			$row .= '"'.$user['display_active_listening'].'",';
			$row .= '"'.$user['agent_relevant_probing'].'",';
			$row .= '"'.$user['agent_provide_correct_tariff'].'",';
			//$row .= '"'.$user['start_lowest_discount'].'",';
			//$row .= '"'.$user['offer_alternate_property'].'",';
			$row .= '"'.$user['pitch_additional_night'].'",';
			$row .= '"'.$user['create_call_urgency'].'",';
			$row .= '"'.$user['give_property_details'].'",';
		//	$row .= '"'.$user['agent_check_lifeline'].'",';
			$row .= '"'.$user['check_with_PM'].'",';
			$row .= '"'.$user['agent_summarize_call'].'",';
			$row .= '"'.$user['pitch_for_on_call'].'",';
			$row .= '"'.$user['was_tagging_correct'].'",';
			$row .= '"'.$user['agent_adhere_to_SOP'].'",';
			$row .= '"'.$user['agent_provide_incorrect_info'].'",';
			$row .= '"'.$user['ZTP_call_observe'].'",';
			$row .= '"'.$user['capture_correct_information'].'",';
			$row .= '"'.$user['agent_give_mandatory_info'].'",';
			$row .= '"'.$user['create_correct_booking'].'",';
			//$row .= '"'.$user['acknowlegde_the_concern'].'",';
			$row .= '"'.$user['agent_polite_on_call'].'",';
			$row .= '"'.$user['show_emphaty_when_required'].'",';
			$row .= '"'.$user['take_customer_name_once'].'",';
			$row .= '"'.$user['any_dead_air_on_call'].'",';
			$row .= '"'.$user['follow_hold_procedure'].'",';
			$row .= '"'.$user['energetic_through_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level1_comment'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level2'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/*----------------OYO UK / US / NEW CSS Part Start--------------------*/
	public function download_qa_oyo_uk_us_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO UK/US/NEW Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyo_uk_us_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Tenure (in Days)", "Tenure Bucket", "Recording Date and Time", "Avaya ID", "Call Duration", "Phone", "Booking ID", "Geography to be audited", "Type of Audit", "Cancellation Sub Type", "Call Type", "Can be Automated", "Call Sub Type", "Tagging by Agent - Call Type", "Tagging by Agent - Call Sub Type","Property Code","Agent Disposition","QA Disposition", "Audit Type", "Auditor Type", "VOC", "ACPT","Prepay Adharanc","Payments Status", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
		 	"Delayed Opening >5 sec",
		 	"Was the opening correct?",
		 	"Did the agent ask for further assistance?",
		 	"Was the closure correct?",
		 	"Was there any grammatical error on the call?",
		 	"Was there any MTI observed on the call?",
		 	"Did the agent display active listening skills on the call?",
		 	"Did the agent do relevant probing?",
		 	"Did the agent puts sales effort?",
		 	"Did the agent pitch for additional nights?",
		 	"Did the agent pitch alternate property  if required?",
		 	"Did the agent give the property details with the DID information?",
		 	"Split booking done without customer consent",
		 	"Did the agent check with the PM IF REQUIRED??",
		 	"Did the agent summarize the call?",
		 	"Did the agent effectively pitch for on call payment?",
		 	"Was the tagging disposition correct?",
		 	"Did the agent give IVR Information?",
		 	"Did the agent inform payment TAT?",
		 	"Incorrect information given",
		 	"Incomplete information given",
		 	"Unethical booking done",
		 	"Wrong booking done",
		 	"Force booking done for additional night",
		 	"Duplicate booking done",
		 	"Was the agent polite courteous on the call?",
		 	"Did the agent show empathy acknowledgement apology when required?",
		 	"Did the agent take the name of the customer at least twice on the call?",
		 	"Was there any dead air on the call?",
		 	"Did the agent follow hold procedure?",
		 	"Call Summary", "Feedback", "L1","L2", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			if($user['tenure']>='0' && $user['tenure']<='30'){
				$tenure_bucket = "0-30";
			}else if($user['tenure']>'30' && $user['tenure']<='60'){
				$tenure_bucket = "31-60";
			}else if($user['tenure']>'60' && $user['tenure']<='90'){
				$tenure_bucket = "61-90";
			}else if($user['tenure']>'90'){
				$tenure_bucket = "91 and Above";
			}
			
			if($user['agent_rvw_date']=="" || $user['agent_rvw_date']=='0000-00-00 00:00:00'){
				$agent_rvw_date = '';
			}else{
				$agent_rvw_date = ConvServerToLocal($user['agent_rvw_date']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$tenure_bucket.'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['avaya_id'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['booking_id'].'",';
			$row .= '"'.$user['geography_audit'].'",';
			$row .= '"'.$user['type_audit'].'",';
			$row .= '"'.$user['cancel_sub_audit_type'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['can_automated'].'",';
			$row .= '"'.$user['call_sub_type'].'",';
			$row .= '"'.$user['agent_call_type'].'",';
			$row .= '"'.$user['agent_call_sub_type'].'",';
			$row .= '"'.$user['property_code'].'",';
			$row .= '"'.$user['agent_disposition'].'",';
			$row .= '"'.$user['qa_disposition'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['prepay_adharance'].'",';
			$row .= '"'.$user['payments_status'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['delayed_opening'].'",';
			$row .= '"'.$user['was_opening_correct'].'",';
			$row .= '"'.$user['agent_ask_further_assistance'].'",';
			$row .= '"'.$user['was_closure_correct'].'",';
			$row .= '"'.$user['grammatical_error'].'",';
			$row .= '"'.$user['MTI_observed_call'].'",';
			$row .= '"'.$user['display_active_listening'].'",';
			$row .= '"'.$user['agent_relevant_probing'].'",';
			$row .= '"'.$user['agent_provide_correct_tariff'].'",';
			$row .= '"'.$user['pitch_additional_night'].'",';
			$row .= '"'.$user['create_call_urgency'].'",';
			$row .= '"'.$user['give_property_details'].'",';
			$row .= '"'.$user['customer_consent'].'",';
			$row .= '"'.$user['check_with_PM'].'",';
			$row .= '"'.$user['agent_summarize_call'].'",';
			$row .= '"'.$user['pitch_for_on_call'].'",';
			$row .= '"'.$user['was_tagging_correct'].'",';
			$row .= '"'.$user['ivr_information'].'",';
			$row .= '"'.$user['payment_tat'].'",';
			$row .= '"'.$user['agent_provide_incorrect_info'].'",';
			$row .= '"'.$user['agent_provide_incomplete_info'].'",';
			$row .= '"'.$user['unethical_booking'].'",';
			$row .= '"'.$user['wrong_booking'].'",';
			$row .= '"'.$user['force_booking'].'",';
			$row .= '"'.$user['duplicate_booking'].'",';
			$row .= '"'.$user['agent_polite_on_call'].'",';
			$row .= '"'.$user['show_emphaty_when_required'].'",';
			$row .= '"'.$user['take_customer_name_once'].'",';
			$row .= '"'.$user['any_dead_air_on_call'].'",';
			$row .= '"'.$user['follow_hold_procedure'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level1_comment'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level2'])).'",';
			$row .= '"'.$agent_rvw_date.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}
	/*----------------OYO WALLET / RECHARGE CSS Part Start--------------------*/
	public function download_qa_oyo_wallet_recharge_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO WALLET RECHARGE Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyo_wallet_recharge_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Recording Date and Time", "Call Duration", "Phone", "Product", "Campaign", "Customer VOC", "Customer Sub VOC", "Objection","Property Code","Agent Disposition","QA Disposition", "Audit Type", "Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score","Earned Score","Overall Score",
		 	"Call Opening",
		 	"Account details and recharge amount",
		 	"Disposition",
		 	"Urgency Creation?",
		 	"App benefits",
		 	"Call Opening Comment",
		 	"Account details and recharge amount Comment",
		 	"Disposition Comment",
		 	"Urgency Creation Comment",
		 	"App benefits Comment",
			"Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.ConvServerToLocal($user['call_date']).'",';
			$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['product'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['customer_voc'].'",';
			$row .= '"'.$user['customer_sub_voc'].'",';
			$row .= '"'.$user['objection'].'",';
			$row .= '"'.$user['property_code'].'",';
			$row .= '"'.$user['agent_disposition'].'",';
			$row .= '"'.$user['qa_disposition'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
			$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['call_opening'].'",';
			$row .= '"'.$user['financials_system'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['urgency_creation'].'",';
			$row .= '"'.$user['app_benefits'].'",';
			$row .= '"'.$user['call_opening_cmnt'].'",';
			$row .= '"'.$user['financials_system_cmnt'].'",';
			$row .= '"'.$user['disposition_cmnt'].'",';
			$row .= '"'.$user['urgency_creation_cmnt'].'",';
			$row .= '"'.$user['app_benefits_cmnt'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level1_comment'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level2'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/*----------------OYO ESAL /  CSS Part Start--------------------*/
public function download_qa_oyo_esal_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA OYO ESAL Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_oyo_esal_CSV($rr)
{
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");
	$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration",  "Booking ID", "Phone", "Disposition", "Correct Dispo by QA", "Wrong Disposition", "Audit Type", "Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score","Earned Score","Overall Score",
		 "Were the amenities and features of the room properly shared?","Remarks 1",
		 "Did the agent acknowledge the caller needs and use it in the offering?","Remarks 2",
		 "Did the agent use Closing Statements after price sharing?","Remarks 3",
		 "Did the agent ask for reason of rejection?","Remarks 4",
		 "Did the agent provide rebuttals and try to overcome objections?","Remarks 5",
		 "Did the agent pitch alternate property if required?","Remarks 6",
		 "Did the agent check with PM IF REQUIRED?","Remarks 7",
		 "Agent effectively pitch for on-call payment?","Remarks 8",
		 "Agent proactively offered assistance for on-call payment?","Remarks 9",
		 "Was the on-call payment completed?","Remarks 10",
		 "Agent personalized by using customer's name at least 2 times?","Remarks 11",
		 "Agent offered further assistance before ending the call?","Remarks 12",
		 "Agent display active listening skills?","Remarks 13",
		 "Was the opening correct and properly?","Remarks 14",
		 "Was the agent polite and corteous on call?","Remarks 15",
		 "Agent uses a good tone of voice and pace","Remarks 16",
		 "Did the agent follow hold procedure?","Remarks 17",
		 "ACPT","L1","L2","L3",
		"Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

	$row = "";
	foreach($header as $data) $row .= ''.$data.',';
	fwrite($fopen,rtrim($row,",")."\r\n");
	$searches = array("\r", "\n", "\r\n");

	foreach($rr as $user)
	{

		if($user['entry_by']!=''){
			$auditorName = $user['auditor_name'];
		}else{
			$auditorName = $user['client_name'];
		}

		if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
			$interval1 = '---';
		}else{
			$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
		}

		$row = '"'.$auditorName.'",';
		$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
		$row .= '"'.$user['fusion_id'].'",';
		$row .= '"'.$user['fname']." ".$user['lname'].'",';
		$row .= '"'.$user['tl_name'].'",';
		$row .= '"'.ConvServerToLocal($user['call_date']).'",';
		$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
		$row .= '"'.$user['booking_id'].'",';
		$row .= '"'.$user['phone_no'].'",';
		$row .= '"'.$user['disposition'].'",';
		$row .= '"'.$user['correct_dispo'].'",';
		$row .= '"'.$user['wrong_dispo'].'",';
		$row .= '"'.$user['audit_type'].'",';
		$row .= '"'.$user['auditor_type'].'",';
		$row .= '"'.$user['voc'].'",';
		$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
		$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
		$row .= '"'.$interval1.'",';
		$row .= '"'.$user['possible_score'].'",';
		$row .= '"'.$user['earned_score'].'",';
		$row .= '"'.$user['overall_score'].'%'.'",';
		$row .= '"'.$user['amenities_features'].'",';
		$row .= '"'.$user['cmt1'].'",';
		$row .= '"'.$user['acknowledge'].'",';
		$row .= '"'.$user['cmt2'].'",';
		$row .= '"'.$user['closing_statement'].'",';
		$row .= '"'.$user['cmt3'].'",';
		$row .= '"'.$user['rejection'].'",';
		$row .= '"'.$user['cmt4'].'",';
		$row .= '"'.$user['rebuttals'].'",';
		$row .= '"'.$user['cmt5'].'",';
		$row .= '"'.$user['alternate_property'].'",';
		$row .= '"'.$user['cmt6'].'",';
		$row .= '"'.$user['pm_required'].'",';
		$row .= '"'.$user['cmt7'].'",';
		$row .= '"'.$user['effectively_pitch'].'",';
		$row .= '"'.$user['cmt8'].'",';
		$row .= '"'.$user['proactively'].'",';
		$row .= '"'.$user['cmt9'].'",';
		$row .= '"'.$user['call_payment'].'",';
		$row .= '"'.$user['cmt10'].'",';
		$row .= '"'.$user['personalized'].'",';
		$row .= '"'.$user['cmt11'].'",';
		$row .= '"'.$user['further_assistance'].'",';
		$row .= '"'.$user['cmt12'].'",';
		$row .= '"'.$user['active_listening'].'",';
		$row .= '"'.$user['cmt13'].'",';
		$row .= '"'.$user['correct_opening'].'",';
		$row .= '"'.$user['cmt14'].'",';
		$row .= '"'.$user['polite_corteous'].'",';
		$row .= '"'.$user['cmt15'].'",';
		$row .= '"'.$user['voice_tone'].'",';
		$row .= '"'.$user['cmt16'].'",';
		$row .= '"'.$user['hold_procedure'].'",';
		$row .= '"'.$user['cmt17'].'",';
		$row .= '"'.$user['acpt'].'",';
		$row .= '"'.$user['l1'].'",';
		$row .= '"'.$user['l2'].'",';
		$row .= '"'.$user['l3'].'",';

		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
		$row .= '"'.$user['agent_rvw_date'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
		$row .= '"'.$user['mgnt_rvw_date'].'",';
		$row .= '"'.$user['mgnt_rvw_name'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
		$row .= '"'.$user['client_rvw_date'].'",';
		$row .= '"'.$user['client_rvw_name'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

		fwrite($fopen,$row."\r\n");
	}

	fclose($fopen);
}

/*----------------OYO SIG New CSS Part Start--------------------*/
	public function download_qa_oyosig_new_CSV($pValue)
	{
		if($pValue=='OYO SIG New'){
			$hdr_val='OYO SIG New';
		}else if($pValue=='oyo_sigchat_service'){
			$hdr_val='OYO SIG Chat Service';
		}else if($pValue=='oyo_sigchat_escalation'){
			$hdr_val='OYO SIG Chat Escalation';
		}

		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$hdr_val." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyosig_new_CSV($rr,$pValue)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($pValue=='OYO SIG New'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date/Time", "Czentrix ID", "Call Duration", "Phone", "Call Type", "Disconnection Source", "Call ID", "CONF Unique ID", "Monitor File Name", "Czentrix Disposition","Property Code","Agent Disposition","QA Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
			"1.1 Opening Protocol","2.1 Effective Probing Done","2.2 Issue Identified and Paraphrased for guest confirmation","3.1 Apology & Empathy","3.2 Voice Intonation Modulation & Rate Of Speech","3.3 Active Listening / Avoid Interruption & Repetitions","3.4 Confidence and Enthusiasm","3.5 Politeness & Professionalism","3.6 Grammar & Sentence Construction","3.7 Acknowledgement of guest queries and offer assurance","4.1 Did the agent adhere to Hold Protocol","4.2 Did the agent adhere to dead air Protocol","4.3 Legitimate Hold used","5.1 Correct Information / Resolution provided","5.2 Correct refund /complimentary procedure","5.3 Proper follow up with PM/Stock team","5.4 GNC Closure Procedure","5.5 Ownership","5.6 Send correct resolution email","6.1 Complete and correct notes","6.2 Accurate Tagging of Issue Category and sub category","6.3 Call Disposed accurately on Czentrix","6.4 Correct Ticket Status and tagging of remaining fields in Oyo Desk","7.1 Pitched Need Help for self help","7.2 Further Assistance Asked","7.3 G-Sat Survey Effectively Pitched","7.4 G- Sat Survey Avoidance","7.5 Closing done with branding of OYO","8.1 Process ZT - Back ground noise","Transaction was handled ethically - Call was not disconnected","Agent maintained profanity on the call","Agent did not sounded sarcastic /degraded customer","Agent did not make False commitment to guest >> financial loss >>3000 INR","Agent did not Force Close ticket","Agent raised escalation ticket on IB call","Agent raised duplicate tickets for the same category less than 14 days","Agent adhered to Escalation matrix /Did not refuse next level escalation","Agent did not misuse hold protocol",
			"1.1 Remark","2.1 Remark","2.2 Remark","3.1 Remark","3.2 Remark","3.3 Remark","3.4 Remark","3.5 Remark","3.6 Remark","3.7 Remark","4.1 Remark","4.2 Remark","4.3 Remark","5.1 Remark","5.2 Remark","5.3 Remark","5.4 Remark","5.5 Remark","5.6 Remark","6.1 Remark","6.2 Remark","6.3 Remark","6.4 Remark","7.1 Remark","7.2 Remark","7.3 Remark","7.4 Remark","7.5 Remark","8.1 Remark",
			"Call Summary", "Feedback", "Agent Review Date", "Agent Feedback Acceptance","Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pValue=='oyo_sigchat_service'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Chat Date", "Guest Number", "Booking ID", "Chat Link", "Haptik ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Earned Score", "Possible Score", "Overall Score","1.1 Opening & Salutation","Dropdown","2.1 Effective Probing Done", "Dropdown","2.2 Identify issue and offer assurance ", "Dropdown","3.1 Capital letter/long sentence/spacing error/Punctuation","Dropdown","3.2 Grammar / Sentence Structure/Incomplete Sentence","Dropdown","3.3 Spell Check ","Dropdown","3.4 Apology & Empathy and Power/Courteous Words used","Dropdown","3.5 Choice of Words","Dropdown","3.6 SMS language/Abbreviations","Dropdown","3.7 Acknowledgement Time/Refresh Interval time","Dropdown","3.8 Guest connect check/Wait time protocol","Dropdown","3.9 Attentive on chat/Repetition","Dropdown","3.10 Legitimate wait time used","Dropdown","4.1 CRS Compliance / Hotline Compliance","Dropdown","4.2 Resolution of guest query/concern","Dropdown","4.3 Proper follow up with PM/Stock team","Dropdown","5.1 Log Service Ticket Accuracy","Dropdown","5.2 Accurate Tagging of Issue Category and sub category on OYO desk","Dropdown","5.3 Complete and correct notes (CRS/OYO desk)","Dropdown","6.1 Further Assistance","Dropdown","6.2 Disconnect check/Response time","Dropdown","6.3 Closing","Dropdown","Tier 1","Dropdown","Email Warning","Dropdown","Advisor ZTP","Dropdown","Call Summary", "Feedback", "Agent Review Date", "Agent Review Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Review Comment");
		}else if($pValue=='oyo_sigchat_escalation'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Chat Date", "Guest Number", "Booking ID", "Chat Link", "Escalation Ticket ID", "Haptik ID", "tenurity","Property Code","Agent Disposition","QA Disposition", "Audit Type", "VOC", "Conversation identifier", "AHT", "CRS Id", "Haptik Category", "Haptik Sub Category","OD Reason", "OD Category", "OD Subcategory", "OD Actual Reason", "OD Actual Category", "OD Actual Subcategory", "Chat Synopsis", "Monitor File Name (Guest)", "Monitor File Name (PM)", "Monitor File Name (SM)", "Var 1", "Var 2", "Var 3", "Earned Score", "Possible Score", "Overall Score",
				"1.1 Opening & Salutation", "Dropdown",
				"2.1 Effective Probing Done", "Dropdown",
				"2.2 Identify issue and offer assurance", "Dropdown",
				"3.1 Apology & Empathy", "Dropdown",
				"3.2 Capital letter/long sentence/spacing error/Punctuation", "Dropdown",
				"3.3 Attentiveness", "Dropdown",
				"3.4 SMS language/Abbreviations/Choice of words", "Dropdown",
				"3.5 Spell check", "Dropdown",
				"3.6 Politeness /Courtesy / Professionalism", "Dropdown",
				"3.7 Grammar / Sentence Structure/Incomplete Sentence", "Dropdown",
				"3.8 Timely Acknowledgment", "Dropdown",
				"4.1 Unnecessary time taken from guest for follow up", "Dropdown",
				"4.2 Correct Information / Resolution provided", "Dropdown",
				"4.3 Correct refund or complimentary procedure", "Dropdown",
				"4.4 Proper follow up", "Dropdown",
				"5.1 Complete and correct notes (CRS/Lifeline/OYO desk)", "Dropdown",
				"5.2 Tagging of Issue Category and sub category", "Dropdown",

				"5.3 Correct Ticket Status and tagging of remaining fields in OYO desk", "Dropdown",
				"5.4 Resolution Email to be sent to Guest", "Dropdown",
				"6.1 Further Assistance Asked", "Dropdown",
				"6.2 G-sat avoidance", "Dropdown",
				"6.3 Closing done with branding of OYO", "Dropdown",
				"6.4 Disconnect check/Response time", "Dropdown",
				"7.1 Transaction was handled ethically",
				"7.2 Agent maintained profanity on the call",
				"7.3 Agent sounded rude/ sarcastic /degraded customer",
				"7.4 Agent made false commitment to guest >> financial loss >>3000 INR",
				"7.5 Agent raised escalation ticket/worked on existing ticket",
				"7.6 Agent raised duplicate tickets for the same category less than 14 days",
				 "7.7 Agent adhered to Escalation matrix /Did not refuse next level escalation", "Call Summary", "Feedback", "Agent Review Date", "Agent Review Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Review Comment");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($pValue=='OYO SIG New'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.ConvServerToLocal($user['call_date']).'",';
				$row .= '"'.$user['czentrix_id'].'",';
				$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['disconnection_source'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['conf_id'].'",';
				$row .= '"'.$user['monitor_file_name'].'",';
				$row .= '"'.$user['czentrix_disposition'].'",';
				$row .= '"'.$user['property_code'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['qa_disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['call_opening_5sec'].'",';
				$row .= '"'.$user['probing_done'].'",';
				$row .= '"'.$user['issue_identified'].'",';
				$row .= '"'.$user['apology_empathy'].'",';
				$row .= '"'.$user['voice_intonation'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['confidence_enthusiasm'].'",';
				$row .= '"'.$user['politeness'].'",';
				$row .= '"'.$user['sentence_construction'].'",';
				$row .= '"'.$user['acknowledgement'].'",';
				$row .= '"'.$user['adhere_hold_protocol'].'",';
				$row .= '"'.$user['dead_air_protocol'].'",';
				$row .= '"'.$user['legitimate_hold'].'",';
				$row .= '"'.$user['correct_information'].'",';
				$row .= '"'.$user['correct_refund'].'",';
				$row .= '"'.$user['proper_followup'].'",';
				$row .= '"'.$user['gnc_closure'].'",';
				$row .= '"'.$user['ownership'].'",';
				$row .= '"'.$user['correct_email'].'",';
				$row .= '"'.$user['correct_notes'].'",';
				$row .= '"'.$user['accurate_tagging'].'",';
				$row .= '"'.$user['call_disposed'].'",';
				$row .= '"'.$user['correct_ticket_status'].'",';
				$row .= '"'.$user['piched_need_help'].'",';
				$row .= '"'.$user['further_assistance'].'",';
				$row .= '"'.$user['Gsat_survey_pitched'].'",';
				$row .= '"'.$user['Gsat_survey_avoidance'].'",';
				$row .= '"'.$user['closing_done_branding'].'",';
				$row .= '"'.$user['back_ground_noise'].'",';
				$row .= '"'.$user['handled_ethically'].'",';
				$row .= '"'.$user['maintained_profanity'].'",';
				$row .= '"'.$user['sounded_sarcastic'].'",';
				$row .= '"'.$user['false_commitment'].'",';
				$row .= '"'.$user['force_close_ticket'].'",';
				$row .= '"'.$user['escalation_ticket'].'",';
				$row .= '"'.$user['duplicate_tickets'].'",';
				$row .= '"'.$user['escalation_matrix'].'",';
				$row .= '"'.$user['misuse_hold_protocol'].'",';

				$row .= '"'.$user['remarks1'].'",';
				$row .= '"'.$user['remarks2'].'",';
				$row .= '"'.$user['remarks3'].'",';
				$row .= '"'.$user['remarks4'].'",';
				$row .= '"'.$user['remarks5'].'",';
				$row .= '"'.$user['remarks6'].'",';
				$row .= '"'.$user['remarks7'].'",';
				$row .= '"'.$user['remarks8'].'",';
				$row .= '"'.$user['remarks9'].'",';
				$row .= '"'.$user['remarks10'].'",';
				$row .= '"'.$user['remarks11'].'",';
				$row .= '"'.$user['remarks12'].'",';
				$row .= '"'.$user['remarks13'].'",';
				$row .= '"'.$user['remarks14'].'",';
				$row .= '"'.$user['remarks15'].'",';
				$row .= '"'.$user['remarks16'].'",';
				$row .= '"'.$user['remarks17'].'",';
				$row .= '"'.$user['remarks18'].'",';
				$row .= '"'.$user['remarks19'].'",';
				$row .= '"'.$user['remarks20'].'",';
				$row .= '"'.$user['remarks21'].'",';
				$row .= '"'.$user['remarks22'].'",';
				$row .= '"'.$user['remarks23'].'",';
				$row .= '"'.$user['remarks24'].'",';
				$row .= '"'.$user['remarks25'].'",';
				$row .= '"'.$user['remarks26'].'",';
				$row .= '"'.$user['remarks27'].'",';
				$row .= '"'.$user['remarks28'].'",';
				$row .= '"'.$user['remarks29'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pValue=='oyo_sigchat_service'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.ConvServerToLocal($user['call_date']).'",';
				$row .= '"'.$user['guest_number'].'",';
				$row .= '"'.$user['booking_id'].'",';
				$row .= '"'.$user['chat_link'].'",';
				$row .= '"'.$user['haptik_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
		        $row .= '"'.$user['opening'].'",';
	            $row .= '"'.$user['dd_val1'].'",';
	            $row .= '"'.$user['effective_probing'].'",';
	            $row .= '"'.$user['dd_val2'].'",';
	            $row .= '"'.$user['identify_issue'].'",';
	            $row .= '"'.$user['dd_val3'].'",';
	            $row .= '"'.$user['capital_letter'].'",';
	            $row .= '"'.$user['dd_val4'].'",';
	            $row .= '"'.$user['grammar_sentence'].'",';
	            $row .= '"'.$user['dd_val5'].'",';
	            $row .= '"'.$user['spell_check'].'",';
	            $row .= '"'.$user['dd_val6'].'",';
	            $row .= '"'.$user['apology_empathy'].'",';
	            $row .= '"'.$user['dd_val7'].'",';
	            $row .= '"'.$user['choice_of_words'].'",';
	            $row .= '"'.$user['dd_val8'].'",';
	            $row .= '"'.$user['language_abbreviations'].'",';
	            $row .= '"'.$user['dd_val9'].'",';
	            $row .= '"'.$user['acknowledgement'].'",';
	            $row .= '"'.$user['dd_val10'].'",';
	            $row .= '"'.$user['guest_connect_check'].'",';
	            $row .= '"'.$user['dd_val11'].'",';
	            $row .= '"'.$user['attentive_on_chat'].'",';
	            $row .= '"'.$user['dd_val12'].'",';
	            $row .= '"'.$user['legitimate_wait'].'",';
	            $row .= '"'.$user['dd_val13'].'",';
	            $row .= '"'.$user['crs_compliance'].'",';
	            $row .= '"'.$user['dd_val14'].'",';
	            $row .= '"'.$user['resolution'].'",';
	            $row .= '"'.$user['dd_val15'].'",';
	            $row .= '"'.$user['proper_follow_up'].'",';
	            $row .= '"'.$user['dd_val16'].'",';
	            $row .= '"'.$user['log_service_ticket'].'",';
	            $row .= '"'.$user['dd_val17'].'",';
	            $row .= '"'.$user['accurate_tagging'].'",';
	            $row .= '"'.$user['dd_val18'].'",';
	            $row .= '"'.$user['complete_and_correct'].'",';
	            $row .= '"'.$user['dd_val19'].'",';
	            $row .= '"'.$user['further_assistance'].'",';
	            $row .= '"'.$user['dd_val20'].'",';
	            $row .= '"'.$user['disconnect_check'].'",';
	            $row .= '"'.$user['dd_val21'].'",';
	            $row .= '"'.$user['closing'].'",';
	            $row .= '"'.$user['dd_val22'].'",';
	            $row .= '"'.$user['tier'].'",';
	            $row .= '"'.$user['dd_val23'].'",';
	            $row .= '"'.$user['email_warning'].'",';
	            $row .= '"'.$user['dd_val24'].'",';
	            $row .= '"'.$user['advisor_ztp'].'",';
	            $row .= '"'.$user['dd_val25'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pValue=='oyo_sigchat_escalation'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.ConvServerToLocal($user['call_date']).'",';
				$row .= '"'.$user['guest_number'].'",';
				$row .= '"'.$user['booking_id'].'",';
				$row .= '"'.$user['chat_link'].'",';
				$row .= '"'.$user['escalation_ticket_id'].'",';
				$row .= '"'.$user['haptik_id'].'",';
				$row .= '"'.$user['tenurity'].'",';
				$row .= '"'.$user['property_code'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['qa_disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['conversation_identifier'].'",';
				$row .= '"'.$user['aht'].'",';
				$row .= '"'.$user['crs_id'].'",';
				$row .= '"'.$user['haptik_category'].'",';
				$row .= '"'.$user['haptik_subcategory'].'",';
				$row .= '"'.$user['od_reason'].'",';
				$row .= '"'.$user['od_category'].'",';
				$row .= '"'.$user['od_subcategory'].'",';
				$row .= '"'.$user['od_actual_reason'].'",';
				$row .= '"'.$user['od_actual_category'].'",';
				$row .= '"'.$user['od_actual_subcategory'].'",';
				$row .= '"'.$user['chat_synopsis'].'",';
				$row .= '"'.$user['monitor_filename_guest'].'",';
				$row .= '"'.$user['monitor_filename_pm'].'",';
				$row .= '"'.$user['monitor_filename_sm'].'",';
				$row .= '"'.$user['var_1'].'",';
				$row .= '"'.$user['var_2'].'",';
				$row .= '"'.$user['var_3'].'",';

				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['opening_salutation'].'",';
				$row .= '"'.$user['dd_val1'].'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'.$user['dd_val2'].'",';
				$row .= '"'.$user['issue_identified'].'",';
				$row .= '"'.$user['dd_val3'].'",';
				$row .= '"'.$user['apology_empathy'].'",';
				$row .= '"'.$user['dd_val4'].'",';
				$row .= '"'.$user['spacing_error_punctuation'].'",';
				$row .= '"'.$user['dd_val5'].'",';
				$row .= '"'.$user['attentiveness'].'",';
				$row .= '"'.$user['dd_val6'].'",';
				$row .= '"'.$user['sms_language'].'",';
				$row .= '"'.$user['dd_val7'].'",';
				$row .= '"'.$user['spell_check'].'",';
				$row .= '"'.$user['dd_val8'].'",';
				$row .= '"'.$user['courteous_words'].'",';
				$row .= '"'.$user['dd_val9'].'",';
				$row .= '"'.$user['incomplete_sentence'].'",';
				$row .= '"'.$user['dd_val10'].'",';
				$row .= '"'.$user['time_acknowledge'].'",';
				$row .= '"'.$user['dd_val11'].'",';
				$row .= '"'.$user['unnecessary_time_taken'].'",';
				$row .= '"'.$user['dd_val12'].'",';
				$row .= '"'.$user['correct_information'].'",';
				$row .= '"'.$user['dd_val13'].'",';
				$row .= '"'.$user['correct_refund'].'",';
				$row .= '"'.$user['dd_val14'].'",';
				$row .= '"'.$user['proper_followup'].'",';
				$row .= '"'.$user['dd_val15'].'",';
				$row .= '"'.$user['complete_notes'].'",';
				$row .= '"'.$user['dd_val16'].'",';
				$row .= '"'.$user['tagging_issue_category'].'",';
				$row .= '"'.$user['dd_val17'].'",';
				$row .= '"'.$user['correct_ticket_status'].'",';
				$row .= '"'.$user['dd_val18'].'",';
				$row .= '"'.$user['resolution_email'].'",';
				$row .= '"'.$user['dd_val19'].'",';
				$row .= '"'.$user['further_assistance'].'",';
				$row .= '"'.$user['dd_val20'].'",';
				$row .= '"'.$user['infraction_Gsat'].'",';
				$row .= '"'.$user['dd_val21'].'",';
				$row .= '"'.$user['OYO_branding_closing_done'].'",';
				$row .= '"'.$user['dd_val22'].'",';
				$row .= '"'.$user['disconnect_check'].'",';
				$row .= '"'.$user['dd_val23'].'",';
				$row .= '"'.$user['transaction_handled'].'",';
				$row .= '"'.$user['agent_profanity'].'",';
				$row .= '"'.$user['agent_sounded_rude'].'",';
				$row .= '"'.$user['false_commitment'].'",';
				$row .= '"'.$user['agent_raised_escalation'].'",';
				$row .= '"'.$user['agent_raised_duplicate'].'",';
				$row .= '"'.$user['agent_adhered'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}
	}


	/////////////////////////////////////OYOINB///////////////////////////

	public function headerDetails(){

		return $arrayName = array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","Campaign","Booking Id","APCT","Audit Type","Auditor Type","VOC","Czentrix","AT_calltype","AT_subtype","Correct Calltype","Correct Subtype","Lead conversion Done","Non Conversion Reason","L1","L2","Service Score","Soft Skill Score","Overall Result","Overall Score","Booking Details","Guest Understand","Complete Resolution","Objection Handling","Retention Efforts","Ownership Resolve","Customer Issue","Effective Probing","Sale Future","Selling Skills","Customer Objection","Hotel Amenities","Multiple Option","Whatsapp Option","Lifeline Compliance","OYO Assist","Escalation Metrix","SIG CID","Greet Customer Branding","Courtesy Confidence","Apology Empathy","Interruption","Active Listening","Switch Language","Grammar Sentence","Guest Permission","Verbiage Followed","Dead Air","Does Infraction Exist","Choose Reason","Tier","Attempt","Equivalent_to","Call Summary","BOD","Feedback","Entry By","Entry Date","Audit Start Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");

	}

	public function download_qa_oyoinb_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA oyo_inb New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_oyoinb_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header=$this->headerDetails();
		$field_name="SHOW FULL COLUMNS FROM qa_oyoinb_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}

	public function download_qa_Booking_status_check_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Booking Status Check Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function download_qa_booking_lost_validation_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Booking lost validation Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_booking_lost_validation_CSV($rr)
	{
	  $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date","Call Type","Customer Type","Gues Number","Zentrix Id","Disposition Captured","Actual Disposition","Call Path","Correct Disposition Captured","Was booking created on the call?","Was booking valid?","Booking loss reason","Was booking Cannibalized","Was booking Split","How was the call related to sales Intent","How call was service related","Was Customer Redirected to IVR with proper SOP","ACPT (Cause of booking loss)","Agent Error Type","Feedback", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)",  "Call Observation", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.ConvServerToLocal($user['call_date']).'",';

			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['customer_type'].'",';

			$row .= '"'.$user['guest_number'].'",';
			$row .= '"'.$user['zentrix_id'].'",';
			$row .= '"'.$user['disposition_captured'].'",';
			$row .= '"'.$user['actual_disposition'].'",';

			$row .= '"'.$user['call_path'].'",';


			$row .= '"'.$user['correct_disposition'].'",';
			$row .= '"'.$user['was_lost_validation_valid'].'",';
			$row .= '"'.$user['was_lost_validation_reason'].'",';

			$row .= '"'.$user['was_lost_validation_cannibalized'].'",';
			$row .= '"'.$user['was_lost_validation_split'].'",';
			$row .= '"'.$user['how_was_the_call'].'",';
			$row .= '"'.$user['how_call_was_service'].'",';
			$row .= '"'.$user['was_customer_redirected'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['agent_error_type'].'",';



			$row .= '"'.$user['call_summary'].'",';
			$row .= '"'.$user['feedback'].'",';



			$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
			$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);

	}


	public function create_qa_Booking_status_check_CSV($rr)
	{
	  $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Guest Number", "C-Zentrix ID", "Disposition Captured by agent", "Actual Disposition", "Call Path", "Disposition Correct or Not", "Unethical Booking ?", "Duplicate Booking", "Cannibalisation Done ?", "Meal Plan Pitched on call", "Meal Plan Sold on call", "Prepay pitched on call", "Observation", "Feedback", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)",  "Call Observation", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.ConvServerToLocal($user['call_date']).'",';

			//New
			$row .= '"'.$user['guest_number'].'",';
			$row .= '"'.$user['zentrix_id'].'",';
			$row .= '"'.$user['disposition_captured'].'",';
			$row .= '"'.$user['actual_disposition'].'",';
			$row .= '"'.$user['call_path'].'",';

			$row .= '"'.$user['disposition_correct'].'",';
			$row .= '"'.$user['unethical_booking'].'",';
			$row .= '"'.$user['duplicate_booking'].'",';
			$row .= '"'.$user['cannibalisation_done'].'",';
			$row .= '"'.$user['meal_plan_pitched'].'",';
			$row .= '"'.$user['meal_plan_sold'].'",';
			$row .= '"'.$user['prepay_pitched'].'",';

			$row .= '"'.$user['call_summary'].'",';
			$row .= '"'.$user['feedback'].'",';



			$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
			$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);

	}

/*----------------OYO Inbound Hygiene--------------------*/
	public function download_qa_oyoinb_hygiene_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA OYO Inbound Hygiene Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}



	public function create_qa_oyoinb_hygiene_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Booking ID", "Booking Status", "Was Agent pitched meal plan?", "Was the Agent informed of the meal plan price?", "Was the Meal plan Sold?", "Was Meal Plan Sold Ethical?", "Was booking ethical?", "BOD Reason", "If the booking got canceled the guest made any new booking with same details", "New booking id if created", "New booking status", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)",  "Call Observation", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.ConvServerToLocal($user['audit_date']).'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.ConvServerToLocal($user['call_date']).'",';
			$row .= '"'.$user['booking_id'].'",';
			$row .= '"'.$user['booking_status'].'",';
			$row .= '"'.$user['pitched_meal_plan'].'",';
			$row .= '"'.$user['inform_meal_plan_price'].'",';
			$row .= '"'.$user['meal_plan_sold'].'",';
			$row .= '"'.$user['meal_plan_sold_ethical'].'",';
			$row .= '"'.$user['booking_ethical'].'",';
			$row .= '"'.$user['bod_reason'].'",';
			$row .= '"'.$user['guest_made_any_booking'].'",';
			$row .= '"'.$user['new_booking_created'].'",';
			$row .= '"'.$user['new_booking_status'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
			$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


////////////////////////////////////////////////////////////
//////////////////////// CARPARTS SALES////////////////////
//////////////////////////////////////////////////////////

	public function qa_process_report($process){

		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_".$process."_report.php";
			$data["content_js"] = "qa_".$process."_js.php";
			if (in_array($process, array('carddata','creditsafe','solucia','alteras'))) {
				$data["content_js"] = "qa_grille_js.php";
			}
			$data['page']=$process;
			$data['returnProcess']=$process;
			//echo $process;
			$date_from="";
			$date_to="";
			$office_id="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';
			$campaign = '';

			$data["qa_".$process."_list"] = array();

			$data['location_list'] = $this->Common_model->get_office_location_list();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$job = $this->input->get('process');
				$campaign = $this->input->get('campaign');
				$table=$campaign;
				// if($process == 'cati' ){
				// 	$table=$process;
				// }else{
				// 	$table=$campaign;
				// }

				if (!empty($job)) {
						if ($job!="") {
							if($job == 'cati' ){
								$table=$job;
							}
							
							$data['campaign']=$job;
							$process=$job;
							$data['page']=$process;

						}
					}

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($office_id != "") $cond1 .= " and office_id='$office_id'";
				 //echo $table;
				// exit();
               $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_".$table."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_".$process."_list"] = $fullAray;

					$header_arr=$this->Common_model->get_query_result_array("SELECT column_comment FROM information_schema.COLUMNS WHERE table_name = 'qa_".$table."_feedback' and `table_schema` = 'femsdev'");
					$cnt=count($header_arr);

					for($i=0;$i<$cnt;$i++){
						$val=$this->getval($header_arr[$i],'column_comment');
						if($val!=""){
							$header[]=$val;
						}
					}
					// if($table == 'service' || $table == 'sales_carpart' || $table == 'sales_carpart_inbound2' || $table == 'sales_carpart_inbound'){
					// 	array_unshift($header ,"Audit Link");
					// }
					array_unshift($header ,"Auditor Name");
					$key = array_search ('Agent', $header);
					//$key2 = array_search ('Fusion Id', $header);
					//array_splice($header, $key2, 0, 'Audit Link');
					array_splice($header, $key, 0, 'Fusion Id');
					if(in_array($table,array('fiberconnect','magnilife','alpha',"indiamart_bl","indiamart_nonbl","indiamart_deletion"))){
						$key1 = array_search ('Mgnt review by', $header);
						array_splice($header, $key1, 0, 'Interval');
					}
					// print_r($header);
					// die;
					$header=$process."Header";
					$header=$this->$header();
					if($process=='final_pmo'){
				    $this->create_qa_final_pmo_CSV($fullAray,$process);
				    }elseif($process=="telaidstarbucks"){
                    $this->create_qa_telaidstarbucks_CSV($fullAray,$process);

			        }
				     elseif($process=='chariot'){
				    $this->create_qa_chariot_CSV($fullAray,$process);
                    } elseif($process=="grille_moreco"){
                     $this->create_qa_grille_moreco_CSV($fullAray,$process);
                    }  elseif($process=="telaidsaob"){
                    $this->create_qa_telaidsaob_CSV($fullAray, $header, $process);

			        }else if($process=="nordnet"){
           				 $this->create_qa_nordnet_CSV($fullAray, $process);
          			}
          			elseif($process=="telaidqa"){
                    $this->create_qa_telaidqa_CSV($fullAray, $header, $process);
			        }else if($process=="service"){
                     $this->create_qa_carparts_service_CSV($fullAray, $header, $process);
                    }else if($process=="inbound"){
                     $this->create_qa_carparts_inbound_CSV($fullAray, $header, $process);
                    }else if($process=="awareness_call"||$process=="awareness_chat"||$process=="awareness_email"){
            $sub_process=$this->input->get("process");
            $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_".$sub_process."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
            $fullAray = $this->Common_model->get_query_result_array($qSql);
  					$data["qa_".$process."_list"] = $fullAray;
            $this->create_qa_awareness_CSV($fullAray, $sub_process);
          }else if($process=="sales_carpart"){
            $this->create_qa_carparts_sales_CSV($fullAray, $header, $process);
          }else if($process=="inbound"){
            $this->create_qa_carparts_sales_inbound_CSV($fullAray, $header, $process);
          }else {
          	// echo $table;
          	// echo"<br>";
            $this->create_qa_process_new_CSV($fullAray,$header,$table);
          }

			$dn_link = base_url()."reports_qa/download_qa_process_new_CSV/".$table;
		  }

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id'] = $office_id;
			$data['campaign'] = $campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_qa_process_new_CSV($param){
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".ucfirst($param)." New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

  //Edited By Samrat 6/12/2021
// public function create_qa_nordnet_CSV($rowData, $process){
// 	$currDate=date("Y-m-d");
// 		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
// 		$fopen = fopen($filename,"w+");

//     $row = "";
//     $header=$process."Header";
//     $header=$this->$header();
//     foreach($header as $header_data){
//       $row .= ''.$header_data.',';
//     }
//     fwrite($fopen,rtrim($row,",")."\r\n");
// 		$searches = array("\r", "\n", "\r\n");
// 	if($process=="nordnet"){
//       foreach ($rowData as $user) {
//         if($user['entry_by']!=''){
//           $auditorName=$user['auditor_name'];
//         }else{
//           $auditorName=$user['client_name'];
//         }

//         if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
//           $interval1 = '---';
//         }else{
//           $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
//         }
//         $row = '"'.$auditorName.'",';
//         $row .= '"'.$user['auditor_type'].'",';
//         $row .= '"'.$user['audit_date'].'",';
//         $row .= '"'.$user['audit_type'].'",';
//         $row .= '"'.$user['call_date'].'",';
//         $row .= '"'.$user['call_duration'].'",';
//         $row .= '"'.$user['fusion_id'].'",';
//         $row .= '"'.$user['fname']." ".$user['lname'].'",';
//         $row .= '"'.$user['tl_name'].'",';
//         $row .= '"'.$user['voc'].'",';
//         $row .= '"'.$user['overall_score'].'"%,';
//         $row .= '"'.$user['possible_score'].'",';
//         $row .= '"'.$user['earned_score'].'",';
//         $row .= '"'.$user['cust_welcome'].'",';
//         $row .= '"'.$user['smile_courtesy'].'",';
//         $row .= '"'.$user['french_expression'].'",';
//         $row .= '"'.$user['put_hold'].'",';
//         $row .= '"'.$user['inappr_hold'].'",';
//         $row .= '"'.$user['taking_leave'].'",';
//         $row .= '"'.$user['identification_client'].'",';
//         $row .= '"'.$user['ans_expected'].'",';
//         $row .= '"'.$user['quality_explanations'].'",';
//         $row .= '"'.$user['use_tool'].'",';
//         $row .= '"'.$user['attitude_vendeurs'].'",';
//         $row .= '"'.$user['cmt1'].'",';
//         $row .= '"'.$user['cmt2'].'",';
//         $row .= '"'.$user['cmt3'].'",';
//         $row .= '"'.$user['cmt4'].'",';
//         $row .= '"'.$user['cmt5'].'",';
//         $row .= '"'.$user['cmt6'].'",';
//         $row .= '"'.$user['cmt7'].'",';
//         $row .= '"'.$user['cmt8'].'",';
//         $row .= '"'.$user['cmt9'].'",';
//         $row .= '"'.$user['cmt10'].'",';
//         $row .= '"'.$user['cmt11'].'",';
//         $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
//         $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
//         $row .= '"'.$user['entry_date'].'",';
//         $row .= '"'.$user['agnt_fd_acpt'].'",';
//         $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
//         $row .= '"'.$user['agent_rvw_date'].'",';
//         $row .= '"'.$user['audit_start_time'].'",';
//         $row .= '"'.$user['mgnt_rvw_name'].'",';
//         $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
//         $row .= '"'.$user['mgnt_rvw_date'].'",';

//         fwrite($fopen,$row."\r\n");
//       }
//       fclose($fopen);
//     }	
// }
public function create_qa_nordnet_CSV($rr,$campaign)
{
	// echo"okkk";
	// echo $campaign;
	// die();
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		    if($campaign=='nordnet'){
			$header = array("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type","Auditor Type","VOC ","Overall Score ","Possible Score ","Earned Score ","Customer welcome ","Smile and courtesy of the advisor ","French expression of the counselor ","Put on hold ","Inappropriate hold? ","Taking leave ","Identification of the client and his request ","Is the answer the one expected? ","Quality of explanations and customer support ","Use of tool ","ATTITUDE TOUS VENDEURS","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Call Summary ","Feedback ","Entry Date ","Audit Start Time ","Agent Feedback Acceptance ","Agent review note ","Agent review date ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Client review by ","Client review note ","Client_rvw_date");
		        }

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");
		    if($campaign=='nordnet'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				 $row = '"'.$auditorName.'",';
		        $row .= '"'.$user['audit_date'].'",';
		        $row .= '"'.$user['fusion_id'].'",';
		        $row .= '"'.$user['fname']." ".$user['lname'].'",';
		        $row .= '"'.$user['tl_name'].'",';
		        $row .= '"'.$user['call_date'].'",';
		        $row .= '"'.$user['call_duration'].'",';
		        $row .= '"'.$user['audit_type'].'",';
		        $row .= '"'.$user['auditor_type'].'",';
		        $row .= '"'.$user['voc'].'",';
		        $row .= '"'.$user['overall_score'].'"%,';
		        $row .= '"'.$user['possible_score'].'",';
		        $row .= '"'.$user['earned_score'].'",';
		        $row .= '"'.$user['cust_welcome'].'",';
		        $row .= '"'.$user['smile_courtesy'].'",';
		        $row .= '"'.$user['french_expression'].'",';
		        $row .= '"'.$user['put_hold'].'",';
		        $row .= '"'.$user['inappr_hold'].'",';
		        $row .= '"'.$user['taking_leave'].'",';
		        $row .= '"'.$user['identification_client'].'",';
		        $row .= '"'.$user['ans_expected'].'",';
		        $row .= '"'.$user['quality_explanations'].'",';
		        $row .= '"'.$user['use_tool'].'",';
		        $row .= '"'.$user['attitude_vendeurs'].'",';
		        $row .= '"'.$user['cmt1'].'",';
		        $row .= '"'.$user['cmt2'].'",';
		        $row .= '"'.$user['cmt3'].'",';
		        $row .= '"'.$user['cmt4'].'",';
		        $row .= '"'.$user['cmt5'].'",';
		        $row .= '"'.$user['cmt6'].'",';
		        $row .= '"'.$user['cmt7'].'",';
		        $row .= '"'.$user['cmt8'].'",';
		        $row .= '"'.$user['cmt9'].'",';
		        $row .= '"'.$user['cmt10'].'",';
		        $row .= '"'.$user['cmt11'].'",';
		        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
		        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
		        $row .= '"'.$user['entry_date'].'",';
		        $row .= '"'.$interval1.'",';
		        $row .= '"'.$user['agnt_fd_acpt'].'",';
		        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
		        $row .= '"'.$user['agent_rvw_date'].'",';
		        $row .= '"'.$user['audit_start_time'].'",';
		        $row .= '"'.$user['mgnt_rvw_name'].'",';
		        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
		        $row .= '"'.$user['mgnt_rvw_date'].'",';
		        $row .= '"'.$user['client_rvw_by'].'",';
		        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
		        $row .= '"'.$user['client_rvw_date'].'",';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		 }
	}

  public function create_qa_awareness_CSV($rowData, $process){
    $currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

    $row = "";
    $header=$process."Header";
    $header=$this->$header();
    foreach($header as $header_data){
      $row .= ''.$header_data.',';
    }
    fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
    if($process=="awareness_call"){
      foreach ($rowData as $user) {
        if($user['entry_by']!=''){
          $auditorName=$user['auditor_name'];
        }else{
          $auditorName=$user['client_name'];
        }

        if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
          $interval1 = '---';
        }else{
          $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
        }
        $row = '"'.$auditorName.'",';
        $row .= '"'.$user['auditor_type'].'",';
        $row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['audit_type'].'",';
        $row .= '"'.$user['call_date'].'",';
        $row .= '"'.$user['call_id'].'",';
        $row .= '"'.$user['call_duration'].'",';
        $row .= '"'.$user['call_type'].'",';
        $row .= '"'.$user['fusion_id'].'",';
        $row .= '"'.$user['fname']." ".$user['lname'].'",';
        $row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['acpt'].'",';
        $row .= '"'.$user['channel'].'",';
        $row .= '"'.$user['voc'].'",';

        $row .= '"'.$user['overall_score'].'"%,';
        $row .= '"'.$user['possible_score'].'",';
        $row .= '"'.$user['earned_score'].'",';

        $row .= '"'.$user['cust_score'].'",';
        $row .= '"'.$user['busi_score'].'",';
        $row .= '"'.$user['comp_score'].'",';

        $row .= '"'.$user['agentVerUser'].'",';
        $row .= '"'.$user['settingProExpec'].'",';
        $row .= '"'.$user['didTheAgent'].'",';
        $row .= '"'.$user['didTheAgnetFoll'].'",';
        $row .= '"'.$user['provideCompleteInfo'].'",';
        $row .= '"'.$user['agentGreetIdentified'].'",';
        $row .= '"'.$user['identifiedCust'].'",';
        $row .= '"'.$user['demonActiveList'].'",';
        $row .= '"'.$user['pacedMatch'].'",';
        $row .= '"'.$user['refrainNegative'].'",';
        $row .= '"'.$user['mustDisplay'].'",';
        $row .= '"'.$user['acknowledgesResponds'].'",';
        $row .= '"'.$user['focusConcise'].'",';
        $row .= '"'.$user['communicatesCustomer'].'",';
        $row .= '"'.$user['logicalTrouble'].'",';
        $row .= '"'.$user['excessiveDeadAir'].'",';
        $row .= '"'.$user['contactingProperly'].'",';

        $row .= '"'.$user['cmt1'].'",';
        $row .= '"'.$user['cmt2'].'",';
        $row .= '"'.$user['cmt3'].'",';
        $row .= '"'.$user['cmt4'].'",';
        $row .= '"'.$user['cmt5'].'",';
        $row .= '"'.$user['cmt6'].'",';
        $row .= '"'.$user['cmt7'].'",';
        $row .= '"'.$user['cmt8'].'",';
        $row .= '"'.$user['cmt9'].'",';
        $row .= '"'.$user['cmt10'].'",';
        $row .= '"'.$user['cmt11'].'",';
        $row .= '"'.$user['cmt12'].'",';
        $row .= '"'.$user['cmt13'].'",';
        $row .= '"'.$user['cmt14'].'",';
        $row .= '"'.$user['cmt15'].'",';
        $row .= '"'.$user['cmt16'].'",';
        $row .= '"'.$user['cmt17'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
        $row .= '"'.$user['entry_date'].'",';
        $row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
        $row .= '"'.$user['agent_rvw_date'].'",';
        $row .= '"'.$user['audit_start_time'].'",';
        $row .= '"'.$user['mgnt_rvw_name'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
        $row .= '"'.$user['mgnt_rvw_date'].'",';

        fwrite($fopen,$row."\r\n");
      }
      fclose($fopen);
    }else if($process=="awareness_chat"){
      foreach ($rowData as $user) {
        if($user['entry_by']!=''){
          $auditorName=$user['auditor_name'];
        }else{
          $auditorName=$user['client_name'];
        }

        if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
          $interval1 = '---';
        }else{
          $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
        }
        $row = '"'.$auditorName.'",';
        $row .= '"'.$user['auditor_type'].'",';
        $row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['audit_type'].'",';
        $row .= '"'.$user['call_date'].'",';
        $row .= '"'.$user['call_id'].'",';
        $row .= '"'.$user['call_duration'].'",';
        $row .= '"'.$user['call_type'].'",';
        $row .= '"'.$user['fusion_id'].'",';
        $row .= '"'.$user['fname']." ".$user['lname'].'",';
        $row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['acpt'].'",';
        $row .= '"'.$user['channel'].'",';
        $row .= '"'.$user['voc'].'",';

        $row .= '"'.$user['overall_score'].'"%,';
        $row .= '"'.$user['possible_score'].'",';
        $row .= '"'.$user['earned_score'].'",';

        $row .= '"'.$user['cust_score'].'",';
        $row .= '"'.$user['busi_score'].'",';
        $row .= '"'.$user['comp_score'].'",';

        $row .= '"'.$user['agentver'].'",';
        $row .= '"'.$user['settingproperexp'].'",';
        $row .= '"'.$user['didtheagentaskifthereis'].'",';
        $row .= '"'.$user['didtheagentfollow'].'",';
        $row .= '"'.$user['givingacc'].'",';
        $row .= '"'.$user['didtheagentcreateaca'].'",';
        $row .= '"'.$user['noCaseCr'].'",';
        $row .= '"'.$user['incomple'].'",';
        $row .= '"'.$user['other'].'",';
        $row .= '"'.$user['theagen'].'",';
        $row .= '"'.$user['theagentshowedpolitenessco'].'",';
        $row .= '"'.$user['staysfocusandconcisewit'].'",';
        $row .= '"'.$user['accuratelycommu'].'",';
        $row .= '"'.$user['performlogicaltrouble'].'",';
        $row .= '"'.$user['theagentfollowcorrectprocedu'].'",';
        $row .= '"'.$user['befor'].'",';
        $row .= '"'.$user['duringReso'].'",';
        $row .= '"'.$user['afterReso'].'",';
        $row .= '"'.$user['iEA'].'",';
        $row .= '"'.$user['theagentmu'].'",';

        $row .= '"'.$user['cmt1'].'",';
        $row .= '"'.$user['cmt2'].'",';
        $row .= '"'.$user['cmt3'].'",';
        $row .= '"'.$user['cmt4'].'",';
        $row .= '"'.$user['cmt5'].'",';
        $row .= '"'.$user['cmt6'].'",';
        $row .= '"'.$user['cmt7'].'",';
        $row .= '"'.$user['cmt8'].'",';
        $row .= '"'.$user['cmt9'].'",';
        $row .= '"'.$user['cmt10'].'",';
        $row .= '"'.$user['cmt11'].'",';
        $row .= '"'.$user['cmt12'].'",';
        $row .= '"'.$user['cmt13'].'",';
        $row .= '"'.$user['cmt14'].'",';
        $row .= '"'.$user['cmt15'].'",';
        $row .= '"'.$user['cmt16'].'",';
        $row .= '"'.$user['cmt17'].'",';
        $row .= '"'.$user['cmt18'].'",';
        $row .= '"'.$user['cmt19'].'",';
        $row .= '"'.$user['cmt20'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
        $row .= '"'.$user['entry_date'].'",';
        $row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
        $row .= '"'.$user['agent_rvw_date'].'",';
        $row .= '"'.$user['audit_start_time'].'",';
        $row .= '"'.$user['mgnt_rvw_name'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
        $row .= '"'.$user['mgnt_rvw_date'].'",';

        fwrite($fopen,$row."\r\n");
      }
      fclose($fopen);
    }else if($process=="awareness_email"){
      foreach ($rowData as $user) {
        if($user['entry_by']!=''){
          $auditorName=$user['auditor_name'];
        }else{
          $auditorName=$user['client_name'];
        }

        if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
          $interval1 = '---';
        }else{
          $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
        }
        $row = '"'.$auditorName.'",';
        $row .= '"'.$user['auditor_type'].'",';
        $row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['audit_type'].'",';
        $row .= '"'.$user['call_date'].'",';
        $row .= '"'.$user['call_id'].'",';
        $row .= '"'.$user['call_duration'].'",';
        $row .= '"'.$user['call_type'].'",';
        $row .= '"'.$user['fusion_id'].'",';
        $row .= '"'.$user['fname']." ".$user['lname'].'",';
        $row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['acpt'].'",';
        $row .= '"'.$user['channel'].'",';
        $row .= '"'.$user['voc'].'",';

        $row .= '"'.$user['overall_score'].'"%,';
        $row .= '"'.$user['possible_score'].'",';
        $row .= '"'.$user['earned_score'].'",';

        $row .= '"'.$user['cust_score'].'",';
        $row .= '"'.$user['busi_score'].'",';
        $row .= '"'.$user['comp_score'].'",';

        $row .= '"'.$user['agentVerUser'].'",';
        $row .= '"'.$user['settingProExpec'].'",';
        $row .= '"'.$user['didTheAgent'].'",';
        $row .= '"'.$user['didTheAgnetFoll'].'",';
        $row .= '"'.$user['givingAccuInfo'].'",';
        $row .= '"'.$user['createCaseDoc'].'",';
        $row .= '"'.$user['identifiedCust'].'",';
        $row .= '"'.$user['politeCourt'].'",';
        $row .= '"'.$user['allowCustComp'].'",';
        $row .= '"'.$user['accurateCommCust'].'",';
        $row .= '"'.$user['performLogical'].'",';
        $row .= '"'.$user['agentFollowCorrect'].'",';
        $row .= '"'.$user['agentMustThank'].'",';

        $row .= '"'.$user['cmt1'].'",';
        $row .= '"'.$user['cmt2'].'",';
        $row .= '"'.$user['cmt3'].'",';
        $row .= '"'.$user['cmt4'].'",';
        $row .= '"'.$user['cmt5'].'",';
        $row .= '"'.$user['cmt6'].'",';
        $row .= '"'.$user['cmt7'].'",';
        $row .= '"'.$user['cmt8'].'",';
        $row .= '"'.$user['cmt9'].'",';
        $row .= '"'.$user['cmt10'].'",';
        $row .= '"'.$user['cmt11'].'",';
        $row .= '"'.$user['cmt12'].'",';
        $row .= '"'.$user['cmt13'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
        $row .= '"'.$user['entry_date'].'",';
        $row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
        $row .= '"'.$user['agent_rvw_date'].'",';
        $row .= '"'.$user['audit_start_time'].'",';
        $row .= '"'.$user['mgnt_rvw_name'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
        $row .= '"'.$user['mgnt_rvw_date'].'",';

        fwrite($fopen,$row."\r\n");
      }
      fclose($fopen);
    }
  }

  public function awareness_chatHeader(){
    return array("Auditor Name", "Auditor Type", "Audit Date", "Audit Type", "Call Date", "Call ID", "Call Duration", "Call Type", "Fusion ID", "Agent",
    "L1 Supervisor","ACPT", "Channel", "VOC", "Overall Score", "Possible Score", "Earned Score","Customer Score", "Business Score", "Compliance Score",
    "Agent verify Username / Email Address for correct account.", "Setting proper expectation to the customer.",
    "Did the agent ask if there is anything that they can do to enhance customer experience before interaction ends?","Did the agent follow correct / proper procedure?",
    "Giving accurate information.", "	Did the agent create a case and document properly.", "No Case Created", "	Incomplete notes", "Others",
    "The agent greet and identified themselves to the customer.", "	The agent showed politeness courtesy and professionalism throughout interaction.",
    "Stays focus and concise with directions and allows customers to complete tasks prior to moving to next steps.","Accurately communicates to the customer.",
    "Perform logical troubleshooting steps and uses targeted probing questions.","The agent follow correct procedures for placing the customer on hold",
    "Before Resolution","During Resolution","After Resolution","IEAT","The agent must thank the customer for contacting at the end of every chat session.","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Call Summary","Feedback","Entry Date ","Agent Feedback Acceptance","Agent review note ","Agent review date","Audit Start Time ","Mgnt review by ","Mgnt review note ","Mgnt review date");
  }

  public function awareness_emailHeader(){
    return array("Auditor Name", "Auditor Type", "Audit Date", "Audit Type", "Call Date", "Call ID", "Call Duration", "Call Type", "Fusion ID", "Agent",
    "L1 Supervisor","ACPT", "Channel", "VOC", "Overall Score", "Possible Score", "Earned Score","Customer Score", "Business Score", "Compliance Score",
    "Setting proper expectation to the customer.", "Did the agent tag the interaction accordingly?",
    "Did the agent ask if there is anything that they can do to enhance customer experience before interaction ends?","Did the agent follow correct / proper procedure?",
    "Provide accurate information.", "The agent showed politeness courtesy and professionalism throughout interaction.", "Acknowledges and responds to the customers emotional statements. Expresses empathy appropriately.", "Response time must be within 6 hours from the last time the agent grab the ticket.", "Must address all concern in an interaction if already provided by the customer without letting them to repeat it.",
    "Accurately communicates to the customer. Thought and sentence construction must be understandable enough not to confuse the customer.", "Perform logical troubleshooting steps and uses targeted probing questions. Pays attention to key words and phrases to quickly determine the issue and all questions are tailored fit to the customer.",
    "Refrains from using language that could be interpreted as offensive or controversial to a customer.","Did the agent comply with agreed upon follow-up when scheduled.",
    "Perform logical troubleshooting steps and uses targeted probing questions.","The agent follow correct procedures for placing the customer on hold",
    "Before Resolution","During Resolution","After Resolution","IEAT","The agent must thank the customer for contacting at the end of every chat session.","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Call Summary","Feedback","Entry Date ","Agent Feedback Acceptance","Agent review note ","Agent review date","Audit Start Time ","Mgnt review by ","Mgnt review note ","Mgnt review date");
  }

  public function awareness_callHeader(){
    return array("Auditor Name", "Auditor Type", "Audit Date", "Audit Type", "Call Date", "Call ID", "Call Duration", "Call Type", "Fusion ID", "Agent", "L1 Supervisor",
    "ACPT", "Channel", "VOC", "Overall Score", "Possible Score", "Earned Score", "Customer Score", "Business Score", "Compliance Score", "Agent verify Username / Email Address for correct account.",
    "Setting proper expectation to the customer.", "Did the agent ask if there is anything that they can do to enhance customer experience before interaction ends?",
    "Did the agent follow correct / proper procedure based on company policy and/or mandated guidelines?", "Provided accurate and complete information. This could be about the product functionality pricing services offered and etc.",
    "The agent greet and identified themselves to the customer. Warm and genuine tone of voice must be displayed to show willingness to assist.",
    "Ask customer name and use it appropriately.", "Paraphrase demonstrate active listening and acknowledge all statements / concerns.", "	Agent should paced match that of the customer.",
    "The agent refrains from negative or derogatory comments about customers fellow employees or products and services.", "Must display confidence and act professional throughout the call.",
    "Acknowledges and responds to the customers emotional statements. Expresses empathy appropriately.", "Stays focus and concise with directions and allows customers to complete tasks prior to moving to next steps.",
    "Accurately communicates to the customer. Thought and sentence construction must be understandable enough not to confuse the customer.",
    "Perform logical troubleshooting steps and uses targeted probing questions. Pays attention to key words and phrases to quickly determine the issue and all questions are tailored fit to the customer.",
    "Refrain from an excessive dead air or awkward silence.", "The agent must thank the customer for contacting to properly end the call.", "Comments 1", "Comments 2",
    "Comments 3", "Comments 4", "Comments 5", "Comments 6", "Comments 7", "Comments 8", "Comments 9", "Comments 10", "Comments 11", "Comments 12", "Comments 13",
    "Comments 14", "Comments 15", "Comments 16", "Comments 17", "Call Summary ","Feedback ","Entry Date ","Agent Feedback Acceptance","Agent review note ","Agent review date ",
    "Audit Start Time ","Mgnt review by ","Mgnt review note ","Mgnt review date ");
  }

  //Edited By Samrat 2/12/2021
  public function create_qa_carparts_service_CSV($data, $header, $process){
    $currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_service";
		$edit_url = "process/mgnt_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$row = "";
		array_unshift($header ,"Audit Link");
		//print_r($header);
		foreach($header as $header_data){
      $row .= ''.$header_data.',';
    }
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

    foreach ($data as $user) {
      if($user['entry_by']!=''){
        $auditorName=$user['auditor_name'];
      }else{
        $auditorName=$user['client_name'];
      }

      if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
        $interval1 = '---';
      }else{
        $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
      }
      $main_urls = $main_url.'/'.$user['id'];

      $row = '"'.$main_urls.'",';
      $row .= '"'.$auditorName.'",';
      $row .= '"'.$user['audit_date'].'",';
      $row .= '"'.$user['fusion_id'].'",';
      $row .= '"'.$user['fname']." ".$user['lname'].'",';
      $row .= '"'.$user['tl_name'].'",';
      $row .= '"'.$user['call_id'].'",';
      $row .= '"'.$user['call_date'].'",';
      $row .= '"'.$user['call_duration'].'",';
      $row .= '"'.$user['call_type'].'",';
      $row .= '"'.$user['audit_type'].'",';
      $row .= '"'.$user['auditor_type'].'",';
      $row .= '"'.$user['voc'].'",';
      $row .= '"'.$user['qa_sampling'].'",';
      $row .= '"'.$user['mc_disposition'].'",';
      $row .= '"'.$user['order_no'].'",';
      $row .= '"'.$user['sub_category'].'",';
      $row .= '"'.$user['nps'].'",';
      $row .= '"'.$user['csat'].'",';

      $row .= '"'.$user['overall_score'].'"%,';
      $row .= '"'.$user['possible_score'].'",';
      $row .= '"'.$user['earned_score'].'",';

      $row .= '"'.$user['cust_score'].'",';
      $row .= '"'.$user['busi_score'].'",';
      $row .= '"'.$user['comp_score'].'",';

      $row .= '"'.$user['auto_fail'].'",';
      $row .= '"'.$user['call_opening'].'",';
      $row .= '"'.$user['account_verification'].'",';
      $row .= '"'.$user['concern_assurance'].'",';
      $row .= '"'.$user['tone_energy'].'",';
      $row .= '"'.$user['rapport_empathy'].'",';
      $row .= '"'.$user['probing'].'",';
      $row .= '"'.$user['conveyance_resolution'].'",';
      $row .= '"'.$user['proper_procedure'].'",';
      $row .= '"'.$user['recap_statement'].'",';
      $row .= '"'.$user['objections_handling'].'",';
      $row .= '"'.$user['returns_tagging'].'",';
      $row .= '"'.$user['documentation'].'",';
      $row .= '"'.$user['actions_taken'].'",';
      $row .= '"'.$user['action_self_service'].'",';

      $row .= '"'.$user['cmt1'].'",';
      $row .= '"'.$user['cmt2'].'",';
      $row .= '"'.$user['cmt3'].'",';
      $row .= '"'.$user['cmt4'].'",';
      $row .= '"'.$user['cmt5'].'",';
      $row .= '"'.$user['cmt6'].'",';
      $row .= '"'.$user['cmt7'].'",';
      $row .= '"'.$user['cmt8'].'",';
      $row .= '"'.$user['cmt9'].'",';
      $row .= '"'.$user['cmt10'].'",';
      $row .= '"'.$user['cmt11'].'",';
      $row .= '"'.$user['cmt12'].'",';
      $row .= '"'.$user['cmt13'].'",';
      $row .= '"'.$user['cmt14'].'",';

      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
      $row .= '"'.$user['entry_date'].'",';
      $row .= '"'.$user['audit_start_time'].'",';
      $row .= '"'.$user['mgnt_rvw_name'].'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
      $row .= '"'.$user['mgnt_rvw_date'].'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
      $row .= '"'.$user['agent_rvw_date'].'",';
      $row .= '"'.$user['agnt_fd_acpt'].'",';

      fwrite($fopen,$row."\r\n");
    }
    fclose($fopen);
  }

  //Edited By Samrat 14/12/2021
  public function create_qa_carparts_sales_CSV($data, $header, $process){
    $currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_sales_carpart";
		$edit_url = "process/mgnt_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$row = "";
		array_unshift($header ,"Audit Link");
		foreach($header as $header_data){
      $row .= ''.$header_data.',';
    }
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

    foreach ($data as $user) {
      if($user['entry_by']!=''){
        $auditorName=$user['auditor_name'];
      }else{
        $auditorName=$user['client_name'];
      }

      if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
        $interval1 = '---';
      }else{
        $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
      }
      $main_urls = $main_url.'/'.$user['id'];

      $row = '"'.$main_urls.'",';
      $row .= '"'.$auditorName.'",';
      $row .= '"'.$user['audit_date'].'",';
      $row .= '"'.$user['fusion_id'].'",';
      $row .= '"'.$user['fname']." ".$user['lname'].'",';
      $row .= '"'.$user['tl_name'].'",';
      $row .= '"'.$user['call_id'].'",';
      $row .= '"'.$user['call_date'].'",';
      $row .= '"'.$user['call_duration'].'",';
      $row .= '"'.$user['call_type'].'",';
      $row .= '"'.$user['audit_type'].'",';
      $row .= '"'.$user['auditor_type'].'",';
      $row .= '"'.$user['voc'].'",';
      $row .= '"'.$user['qa_sampling'].'",';
      $row .= '"'.$user['order_no'].'",';
      $row .= '"'.$user['nps'].'",';
      $row .= '"'.$user['csat'].'",';

      $row .= '"'.$user['overall_score'].'"%,';
      $row .= '"'.$user['possible_score'].'",';
      $row .= '"'.$user['earned_score'].'",';

      $row .= '"'.$user['cust_score'].'",';
      $row .= '"'.$user['busi_score'].'",';
      $row .= '"'.$user['comp_score'].'",';

      $row .= '"'.$user['auto_fail'].'",';
      $row .= '"'.$user['sales_call_type'].'",';
      $row .= '"'.$user['nonSale'].'",';
      $row .= '"'.$user['Introduction'].'",';
      $row .= '"'.$user['active_listening'].'",';
      $row .= '"'.$user['questioning'].'",';
      $row .= '"'.$user['presentation'].'",';
      $row .= '"'.$user['closing_sale'].'",';
      $row .= '"'.$user['add_cpp'].'",';
      $row .= '"'.$user['add_parts'].'",';
      $row .= '"'.$user['shipping_options'].'",';
      $row .= '"'.$user['shipping_billing'].'",';
      $row .= '"'.$user['YMMSE'].'",';
      $row .= '"'.$user['recap_summary'].'",';
      $row .= '"'.$user['total_price'].'",';

      $row .= '"'.$user['rebranding'].'",';
      $row .= '"'.$user['tracking_email'].'",';
      $row .= '"'.$user['overcoming_objections'].'",';
      $row .= '"'.$user['discount_rules'].'",';
      $row .= '"'.$user['account_verification'].'",';
      $row .= '"'.$user['documentation'].'",';
      $row .= '"'.$user['data_gathering'].'",';
      $row .= '"'.$user['account_accuracy'].'",';

      $row .= '"'.$user['cmt1'].'",';
      $row .= '"'.$user['cmt2'].'",';
      $row .= '"'.$user['cmt3'].'",';
      $row .= '"'.$user['cmt4'].'",';
      $row .= '"'.$user['cmt5'].'",';
      $row .= '"'.$user['cmt6'].'",';
      $row .= '"'.$user['cmt7'].'",';
      $row .= '"'.$user['cmt8'].'",';
      $row .= '"'.$user['cmt9'].'",';
      $row .= '"'.$user['cmt10'].'",';
      $row .= '"'.$user['cmt11'].'",';
      $row .= '"'.$user['cmt12'].'",';
      $row .= '"'.$user['cmt13'].'",';
      $row .= '"'.$user['cmt14'].'",';
      $row .= '"'.$user['cmt15'].'",';
      $row .= '"'.$user['cmt16'].'",';
      $row .= '"'.$user['cmt17'].'",';
      $row .= '"'.$user['cmt18'].'",';
      $row .= '"'.$user['cmt19'].'",';
      $row .= '"'.$user['cmt20'].'",';

      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
      $row .= '"'.$user['entry_date'].'",';
      $row .= '"'.$user['audit_start_time'].'",';
      $row .= '"'.$user['mgnt_rvw_name'].'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
      $row .= '"'.$user['mgnt_rvw_date'].'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
      $row .= '"'.$user['agent_rvw_date'].'",';
      $row .= '"'.$user['agnt_fd_acpt'].'",';

      fwrite($fopen,$row."\r\n");
    }
    fclose($fopen);
  }

  public function create_qa_carparts_inbound_CSV($data, $header, $process){
    $currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_sales_carpart";
		$edit_url = "process/mgnt_rvw_inbound";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$row = "";
		array_unshift($header ,"Audit Link");
		foreach($header as $header_data){
      $row .= ''.$header_data.',';
    }
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

    foreach ($data as $user) {
      if($user['entry_by']!=''){
        $auditorName=$user['auditor_name'];
      }else{
        $auditorName=$user['client_name'];
      }

      if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
        $interval1 = '---';
      }else{
        $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
      }
      $main_urls = $main_url.'/'.$user['id'];

      $row = '"'.$main_urls.'",';
      $row .= '"'.$auditorName.'",';
      $row .= '"'.$user['audit_date'].'",';
      $row .= '"'.$user['fusion_id'].'",';
      $row .= '"'.$user['fname']." ".$user['lname'].'",';
      $row .= '"'.$user['tl_name'].'",';
      $row .= '"'.$user['call_id'].'",';
      $row .= '"'.$user['call_date'].'",';
      $row .= '"'.$user['call_duration'].'",';
      $row .= '"'.$user['call_type'].'",';
      $row .= '"'.$user['audit_type'].'",';
      $row .= '"'.$user['auditor_type'].'",';
      $row .= '"'.$user['voc'].'",';
      $row .= '"'.$user['qa_sampling'].'",';
      $row .= '"'.$user['order_no'].'",';
      $row .= '"'.$user['nps'].'",';
      $row .= '"'.$user['csat'].'",';

      $row .= '"'.$user['overall_score'].'"%,';
      $row .= '"'.$user['possible_score'].'",';
      $row .= '"'.$user['earned_score'].'",';

      $row .= '"'.$user['cust_score'].'",';
      $row .= '"'.$user['busi_score'].'",';
      $row .= '"'.$user['comp_score'].'",';

      $row .= '"'.$user['auto_fail'].'",';
      $row .= '"'.$user['sales_call_type'].'",';
      $row .= '"'.$user['nonSale'].'",';
      $row .= '"'.$user['Introduction'].'",';
      $row .= '"'.$user['active_listening'].'",';
      $row .= '"'.$user['questioning'].'",';
      $row .= '"'.$user['presentation'].'",';
      $row .= '"'.$user['closing_sale'].'",';
      $row .= '"'.$user['add_cpp'].'",';
      $row .= '"'.$user['add_parts'].'",';
      $row .= '"'.$user['shipping_options'].'",';
      $row .= '"'.$user['shipping_billing'].'",';
      $row .= '"'.$user['YMMSE'].'",';
      $row .= '"'.$user['recap_summary'].'",';
      $row .= '"'.$user['total_price'].'",';

      $row .= '"'.$user['rebranding'].'",';
      $row .= '"'.$user['tracking_email'].'",';
      $row .= '"'.$user['overcoming_objections'].'",';
      $row .= '"'.$user['discount_rules'].'",';
      $row .= '"'.$user['account_verification'].'",';
      $row .= '"'.$user['documentation'].'",';
      $row .= '"'.$user['data_gathering'].'",';
      $row .= '"'.$user['account_accuracy'].'",';

      $row .= '"'.$user['cmt1'].'",';
      $row .= '"'.$user['cmt2'].'",';
      $row .= '"'.$user['cmt3'].'",';
      $row .= '"'.$user['cmt4'].'",';
      $row .= '"'.$user['cmt5'].'",';
      $row .= '"'.$user['cmt6'].'",';
      $row .= '"'.$user['cmt7'].'",';
      $row .= '"'.$user['cmt8'].'",';
      $row .= '"'.$user['cmt9'].'",';
      $row .= '"'.$user['cmt10'].'",';
      $row .= '"'.$user['cmt11'].'",';
      $row .= '"'.$user['cmt12'].'",';
      $row .= '"'.$user['cmt13'].'",';
      $row .= '"'.$user['cmt14'].'",';
      $row .= '"'.$user['cmt15'].'",';
      $row .= '"'.$user['cmt16'].'",';
      $row .= '"'.$user['cmt17'].'",';
      $row .= '"'.$user['cmt18'].'",';
      $row .= '"'.$user['cmt19'].'",';
      $row .= '"'.$user['cmt20'].'",';

      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
      $row .= '"'.$user['entry_date'].'",';
      $row .= '"'.$user['audit_start_time'].'",';
      $row .= '"'.$user['mgnt_rvw_name'].'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
      $row .= '"'.$user['mgnt_rvw_date'].'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
      $row .= '"'.$user['agent_rvw_date'].'",';
      $row .= '"'.$user['agnt_fd_acpt'].'",';

      fwrite($fopen,$row."\r\n");
    }
    fclose($fopen);
  }

	public function create_qa_grille_moreco_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

			$header = array("Auditor Name","Audit Date","Agent","Fusion ID","L1 Supervisor","Call Date","Audit Type","Auditor Type","VOC","Earned Score","Possible Score","Overall Score","Prsentation de lentreprise et de lagent","Identification du client","Questionnement & dcouverte des besoins","Reformulation","Presentation de l'offre et mise en avant de ses avantages","Validation de la comprehension","Traitement d'objections","Conformit des informations communiques ", "Verrouillage ( validation Intrt/Voicelog )", "Ecoute active & attentive","Aisance de l'expression / debit de parole","Amabilit - Dynamisme", "Directivit","Prise de cong","Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13","Remark 14","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';

                $row .= '"'.$user['presentation_de'].'",';
                $row .= '"'.$user['identification'].'",';
                $row .= '"'.$user['questionnement'].'",';
                $row .= '"'.$user['reformulation'].'",';
                $row .= '"'.$user['presentation'].'",';
                $row .= '"'.$user['validation'].'",';
                $row .= '"'.$user['traitement'].'",';
                $row .= '"'.$user['conformite'].'",';
                $row .= '"'.$user['verrouillage'].'",';
                $row .= '"'.$user['ecoute_active'].'",';
                $row .= '"'.$user['aisance_de'].'",';
                $row .= '"'.$user['amabilite'].'",';
                $row .= '"'.$user['directivite'].'",';
                $row .= '"'.$user['prise_de'].'",';


                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


        }

	public function create_qa_final_pmo_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Review Date","CSR Name", "Team Manager", "Case Topic", "ACPT","Reviewed By","Audit Type", "Auditor Type", "Voc","Overall Score", "Possible Score", "Earned Score","Initial call to the Field Technician","Field Technicians assigned to the job: Names and cell numbers" ,"Review tools and equipment needed for the task to be performed","Review the MS Shredd Document","Verify the technician on site and quantity of techs","Verify Field tech has the scope all documents needed to complete the task","Quick overview of Scope and tools scanner excel laptop camera (cell) post-it notes sharpie","Provide proper expectations of the task to technicians","Ensure the technician has the Zoom Meeting information","Relay that an option to use the MS Guest Wi-Fi is available if cell signal is an issue Report out to MS if assistance is needed for access.","Deliverables","Field techs will need to make a final sweep of the Branch","ALL assets will need to be stored in the Comm Room or a locked room","Verify final resting place of all assets inventoried- DNR tags are correct and in place",	"Email notification to MS and the Telaid team",	"Ensure the technicians information","Keep in contact with the MS PM","Ensure you are receiving the pictures required for the task","Ensure the number reference is clearly visible in the picture and is not on any label tag or writing on the device","All devices need to be clear in the picture and the entire piece of equipment visible","Upload pictures in the MS Box", "Ensure the number sequence is followed when uploading and labeling is accurate","There should never be a long pause receiving pictures from the Field", "Notify MS for resolution if MS controls. Internal if it is something Telaid controls","Understand the timing of the scope/task","Telaid rep populate a draft shred document ","Check all pictures against the shredd document	","Doublecheck the desktop computers along with the hard drives or SSDs","Verify all number references and pictures match",	"Upload all pictures in a timely manner","Double-check all SN in the cells ","Final Telaid document will be uploaded after the MS review ","Follow the scope protocols when saving the final shredd","Ask LCON sign your work order and check out","Ask tech to check in with Telaid PM and look for the LCON","Check tools needed //COC boxes box cutter sharpie -bubble wrap -as per sow","Agent confirm if the tech receive an email notification ","Verify tech if the box contains the necessary materials for the task", "Review all pictures/documents prior to finalizing with MS","Send the bottom/top picture of the first box and send it to MS for approval","Verify the COC to ensure all recorded info is accurate","Working with the LCON to ensure the review is accurate","Place the Security serialized seals","Tech must ask approval to PM for boxes to be sealed", "Chain of Custody form - must be reviewed before and after",	"Deliverables",	"Contact the technician 24 to 48 hours prior to being scheduled to be onsite","Discuss the SOW (Review prior to arriving on site the toolds needed i.e. wood titanium drill bits bucket clamps and safety glasses and gloves as per the scope of work","Review again once the tech arrives on site	","Ensure the techs arrive with the required tools.","Verify information on the COC with the tech","Confirm the tech has the correct zoom bridge info","Review wat is expected on zoom and ensure there is an understanding of proper protoclols","Drill technician SOW","Provided disclaimers in accordance with program requirements","Responded in a way that is limited to the caller's inquiry","Appropriately greeted caller and identified self and organization","Verify if tech receives the email regarding the SOW","Asked relevant clarifying questions to accurately identify caller's inquiry","Took the lead used ownership phrases and promoted confidence in resolving the inquiry","Handled callers needs in a clear and organized manner", "Listened actively and limited need to ask caller to repeat information","Used appropriate volume pace and voice tone. Words were clearly enunciated and properly pronounced.",	"Demonstrated empathy and diffused angry callers when appropriate","Maintained business professional relationship", "Avoided interrupting caller","Asked if caller had additional inquiries prior to call completion","Agent mentions the brand Telaid together with the recommended spiels during opening","Pre Calls : Survey Remark 1","Pre Calls : Survey Remark 2","Pre Calls : Survey Remark 3","Pre Calls : Survey Remark 4","Field technician arrival Remark 1","Field technician arrival Remark 2","Field technician arrival Remark 3","Field technician arrival Remark 4","Field technician arrival Remark 5","Field technician arrival Remark 6","Field Technician Completion/Departure Remark 1","Field Technician Completion/Departure Remark 2","Field Technician Completion/Departure Remark 3","Field Technician Completion/Departure Remark 4","TELAID COORDINATOR / PM Remark 1","TELAID COORDINATOR / PM Remark 2","TELAID COORDINATOR / PM Remark 3","TELAID COORDINATOR / PM Remark 4","TELAID COORDINATOR / PM Remark 5","TELAID COORDINATOR / PM Remark 6","TELAID COORDINATOR / PM Remark 7","TELAID COORDINATOR / PM Remark 8","TELAID COORDINATOR / PM Remark 9","TELAID COORDINATOR / PM Remark 10","TELAID COORDINATOR / PM Remark 11","TELAID COORDINATOR / PM Remark 12","TELAID COORDINATOR / PM Remark 13","TELAID COORDINATOR / PM Remark 14","TELAID COORDINATOR / PM Remark 15","TELAID COORDINATOR / PM Remark 16","TELAID COORDINATOR / PM Remark 17","TELAID COORDINATOR / PM Remark 18","TELAID COORDINATOR / PM Remark 19","TELAID COORDINATOR / PM Remark 20","Packing Remark 1","Packing Remark 2","Packing Remark 3","Packing Remark 4","Packing Remark 5","Packing Remark 6","Packing Remark 7","Packing Remark 8","Packing Remark 9","Packing Remark 10","Packing Remark 11","Packing Remark 12","Drilling Remark 1","Drilling Remark 2","Drilling Remark 3","Drilling Remark 4","Drilling Remark 5","Drilling Remark 6","Drilling Remark 7","Drilling Remark 8","Compliance Remark 1","Compliance Remark 2","Soft Skills Remark 1","Soft Skills Remark 2","Identifying and Meetings Needs Remark 1","Identifying and Meetings Needs Remark 2","Identifying and Meetings Needs Remark 3","Identifying and Meetings Needs Remark 4","Communication Skills Remark 1","Communication Skills Remark 2","Communication Skills Remark 3","Communication Skills Remark 4","Closing Remark 1","Closing Remark 2","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['csr'].'",';
				$row .= '"'.$user['team_manager'].'",';
				$row .= '"'.$user['case_topic'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['initial_call_to'].'",';
				$row .= '"'.$user['field_technicians'].'",';
				$row .= '"'.$user['review_tools_and'].'",';
				$row .= '"'.$user['review_the_ms'].'",';
				$row .= '"'.$user['verify_the_technician'].'",';
				$row .= '"'.$user['verify_field_tech'].'",';
				$row .= '"'.$user['quick_overview_of'].'",';
				$row .= '"'.$user['provide_proper'].'",';
				$row .= '"'.$user['ensure_the_technician'].'",';
				$row .= '"'.$user['relay_that_an_option'].'",';
				$row .= '"'.$user['deliverables'].'",';
				$row .= '"'.$user['field_techs_will'].'",';
				$row .= '"'.$user['all_assets_will'].'",';
				$row .= '"'.$user['verify_final_resting'].'",';
				$row .= '"'.$user['email_notification'].'",';
				$row .= '"'.$user['ensure_the_technician_info'].'",';
				$row .= '"'.$user['keep_in_contact'].'",';
				$row .= '"'.$user['ensure_you_are'].'",';
				$row .= '"'.$user['ensure_the_number'].'",';
				$row .= '"'.$user['all_devices_need'].'",';
				$row .= '"'.$user['upload_pictures'].'",';
				$row .= '"'.$user['ensure_the_number_sequence'].'",';
				$row .= '"'.$user['there_should_never'].'",';
				$row .= '"'.$user['notify_ms_for'].'",';
				$row .= '"'.$user['understand_the_timing'].'",';
				$row .= '"'.$user['telaid_rep_populate'].'",';
				$row .= '"'.$user['check_all_pictures'].'",';
				$row .= '"'.$user['doublecheck_the_desktop'].'",';
				$row .= '"'.$user['verify_all_number'].'",';
				$row .= '"'.$user['upload_all_pictures'].'",';
				$row .= '"'.$user['double_check_all'].'",';
				$row .= '"'.$user['final_telaid_document'].'",';
				$row .= '"'.$user['follow_the_scope'].'",';
				$row .= '"'.$user['ask_lcon_sign'].'",';
				$row .= '"'.$user['ask_all_tech_to'].'",';
				$row .= '"'.$user['check_tools_needed'].'",';
				$row .= '"'.$user['agent_confirm_if'].'",';
				$row .= '"'.$user['veerify_tech_if_the'].'",';
				$row .= '"'.$user['review_all_pictures'].'",';
				$row .= '"'.$user['send_the_bottom'].'",';
				$row .= '"'.$user['verify_the_coc'].'",';
				$row .= '"'.$user['working_with_the'].'",';
				$row .= '"'.$user['place_the_security'].'",';
				$row .= '"'.$user['tech_must_ask'].'",';
				$row .= '"'.$user['chain_of_custody'].'",';
				$row .= '"'.$user['deliverables2'].'",';
				$row .= '"'.$user['contact_the_technician'].'",';
				$row .= '"'.$user['discuss_the_sow'].'",';
				$row .= '"'.$user['review_again_once'].'",';
				$row .= '"'.$user['ensure_the_techs'].'",';
				$row .= '"'.$user['verify_information'].'",';
				$row .= '"'.$user['confirm_the_tech'].'",';
				$row .= '"'.$user['review_wat_is_expected'].'",';
				$row .= '"'.$user['drill_technician'].'",';
				$row .= '"'.$user['provided_disclaimers_in'].'",';
				$row .= '"'.$user['responded_in_way'].'",';
				$row .= '"'.$user['appropriately_greeted'].'",';
				$row .= '"'.$user['verify_if_tech'].'",';
				$row .= '"'.$user['asked_relevant_clarifying'].'",';
				$row .= '"'.$user['took_the_lead'].'",';
				$row .= '"'.$user['handled_callers'].'",';
				$row .= '"'.$user['listened_actively'].'",';
				$row .= '"'.$user['used_appropriate_volume'].'",';
				$row .= '"'.$user['demonstrated_empathy'].'",';
				$row .= '"'.$user['maintained_business'].'",';
				$row .= '"'.$user['avoided_interrupting'].'",';
				$row .= '"'.$user['asked_if_caller_had'].'",';
				$row .= '"'.$user['agent_mentions_the_brand'].'",';

                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';
                $row .= '"'.$user['cmt22'].'",';
                $row .= '"'.$user['cmt23'].'",';
                $row .= '"'.$user['cmt24'].'",';
                $row .= '"'.$user['cmt25'].'",';
                $row .= '"'.$user['cmt26'].'",';
                $row .= '"'.$user['cmt27'].'",';
                $row .= '"'.$user['cmt28'].'",';
                $row .= '"'.$user['cmt29'].'",';
                $row .= '"'.$user['cmt30'].'",';
                $row .= '"'.$user['cmt31'].'",';
                $row .= '"'.$user['cmt32'].'",';
                $row .= '"'.$user['cmt33'].'",';
                $row .= '"'.$user['cmt34'].'",';
                $row .= '"'.$user['cmt35'].'",';
                $row .= '"'.$user['cmt36'].'",';
                $row .= '"'.$user['cmt37'].'",';
                $row .= '"'.$user['cmt38'].'",';
                $row .= '"'.$user['cmt39'].'",';
                $row .= '"'.$user['cmt40'].'",';
                $row .= '"'.$user['cmt41'].'",';
                $row .= '"'.$user['cmt42'].'",';
                $row .= '"'.$user['cmt43'].'",';
                $row .= '"'.$user['cmt44'].'",';
                $row .= '"'.$user['cmt45'].'",';
                $row .= '"'.$user['cmt46'].'",';
                $row .= '"'.$user['cmt47'].'",';
                $row .= '"'.$user['cmt48'].'",';
                $row .= '"'.$user['cmt49'].'",';
                $row .= '"'.$user['cmt50'].'",';
                $row .= '"'.$user['cmt51'].'",';
                $row .= '"'.$user['cmt52'].'",';
                $row .= '"'.$user['cmt53'].'",';
                $row .= '"'.$user['cmt54'].'",';
                $row .= '"'.$user['cmt55'].'",';
                $row .= '"'.$user['cmt56'].'",';
                $row .= '"'.$user['cmt57'].'",';
                $row .= '"'.$user['cmt58'].'",';
                $row .= '"'.$user['cmt59'].'",';
                $row .= '"'.$user['cmt60'].'",';
                $row .= '"'.$user['cmt61'].'",';
                $row .= '"'.$user['cmt62'].'",';
                $row .= '"'.$user['cmt63'].'",';
                $row .= '"'.$user['cmt64'].'",';
                $row .= '"'.$user['cmt65'].'",';
                $row .= '"'.$user['cmt66'].'",';
                $row .= '"'.$user['cmt67'].'",';
                $row .= '"'.$user['cmt68'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


        }

        public function create_qa_telaidstarbucks_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Review Date","CSR Name", "Team Manager", "Case Topic", "ACPT","Reviewed By","Audit Type", "Auditor Type", "Voc","Overall Score", "Possible Score", "Earned Score","Leave complete documentation in the notes field","Refrain from any negative or derogatory comments about customers fellow employees or services within their case notes" ,"Associate the call to the right ticket","Post notes on the correct platforms","Verify if LCON/Site contact receives the email regarding the AMP & VOLTE task","Offer to resend the email for the AMP & VOLTE task","Verify the site and discusse the details of the project","Escalate the ticket correctly","Review the ticket and provide accurate details within the scope of support","Execute the opening spiel clearly and correctly","Deliver ghost call spiel","Recap the details of the task","Follow proper hold procedures and mute expectations","Call the correct technicians number",	"Acknowledge and respond to the callers emotional statements or tone while actively controlling the interaction",	"Maintain a friendly confident and professional tone of voice throughout the interaction","Listen actively during the interaction","Advise customer accurately about ticket status next steps and relevant time frames","Move tasks to the correct stage after calling the client location","Send project task to QA GC prior to making the call","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['csr'].'",';
				$row .= '"'.$user['team_manager'].'",';
				$row .= '"'.$user['case_topic'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['documentation1'].'",';
				$row .= '"'.$user['documentation2'].'",';
				$row .= '"'.$user['documentation3'].'",';
				$row .= '"'.$user['documentation4'].'",';
				$row .= '"'.$user['process1'].'",';
				$row .= '"'.$user['process2'].'",';
				$row .= '"'.$user['process3'].'",';
				$row .= '"'.$user['process4'].'",';
				$row .= '"'.$user['support1'].'",';
				$row .= '"'.$user['call_handling1'].'",';
				$row .= '"'.$user['call_handling2'].'",';
				$row .= '"'.$user['call_handling3'].'",';
				$row .= '"'.$user['call_handling4'].'",';
				$row .= '"'.$user['call_handling5'].'",';
				$row .= '"'.$user['active_listening1'].'",';
				$row .= '"'.$user['active_listening2'].'",';
				$row .= '"'.$user['active_listening3'].'",';
				$row .= '"'.$user['interaction1'].'",';
				$row .= '"'.$user['interaction2'].'",';
				$row .= '"'.$user['interaction3'].'",';
				
                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


        }
// public function create_qa_telaidqa_CSV($rr,$campaign)
// 	{
// 		$currDate=date("Y-m-d");
// 		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
// 		$fopen = fopen($filename,"w+");

// 			$header = array("Auditor Name",
// 			"Audit Date",
// 			"Agent",
// 			"Fusion ID",
// 			"L1 Supervisor",
// 			"Call Date",
// 			"Call Duration",
// 			"Audit Type",
// 			"Auditor Type",
// 			"week",
// 			"voc",
// 			"Case Number",
// 			"Case Topic",
// 			"ACPT",
// 			"QA Score",
// 			"Complete documentation on the note field",
// 			"Refrain from negative or derogatory comments about customers fellow employees or services within their case notes",
// 			"Notes were visible on ServiceNow",
// 			"Call associated with the ticket",
// 			"Notes were not posted on labor platform",
// 			"Verify if LCON/Site contact receives the email regarding the AMP & VOLTE task",
// 			"Offers to resend the email of the AMP & VOLTE task",
// 			"Discusses the details of the project - ETA SOW techs name",
// 			"Reach out to PM for reschedule request",
// 			"Accurately provides any information within the task scope",
// 			"Offers any additional assistance",
// 			"Mentions the brand Telaid together with the recommended spiels during opening",
// 			"Follow the recommended scripts for specific task/project",
// 			"Redials the number immediately if no one answers within 4mins",
// 			"Delivers ghost call spiel",
// 			"Attempt to call for the 3rd time across multiple days before placing the status to PM Action Required",
// 			"Matches style and pace and put caller at ease",
// 			"Recaps the details of the task",
// 			"Immediately and appropriately acknowledges and responds to the callers emotional statements or tone while actively controls the interaction",
// 			"Maintains a friendly confident and professional voice tone throughout the interaction",
// 			"Demonstrates active listening by not ignoring callers information or interrupting without a courteous attempt to yield the conversation",
// 			"Appropriately advises of ticket status next steps and relevant time frames",
// 			"Tasks are moved to the correct stage after calling from the client location",
// 			"Uses appropriate statements and avoid jargons",
// 			"Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13",
// 			"Remark 14","Remark 15","Remark 16","Remark 17","Remark 18","Remark 19","Remark 20","Remark 21","Remark 22","Remark 23","Remark 24",
// 			"Call Summary",
// 			"Feedback",
// 			"Audit Start Time",
// 			"Agent review date",
// 			"Agent review note",
// 			"Mgnt review date",
// 			"Mgnt review by",
// 			"Mgnt review note",);

// 		$row = "";
// 		foreach($header as $data) $row .= ''.$data.',';
// 		fwrite($fopen,rtrim($row,",")."\r\n");
// 		$searches = array("\r", "\n", "\r\n");

// 			foreach($rr as $user){
// 				if($user['entry_by']!=''){
// 					$auditorName = $user['auditor_name'];
// 				}else{
// 					$auditorName = $user['client_name'];
// 				}

// 				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
// 					$interval1 = '---';
// 				}else{
// 					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
// 				}

// 				$row = '"'.$auditorName.'",';
// 				$row .= '"'.$user['audit_date'].'",';
// 				$row .= '"'.$user['fname']." ".$user['lname'].'",';
// 				$row .= '"'.$user['fusion_id'].'",';
// 				$row .= '"'.$user['tl_name'].'",';
// 				$row .= '"'.$user['call_date'].'",';
// 				$row .= '"'.$user['csr'].'",';
// 				$row .= '"'.$user['team_manager'].'",';
// 				$row .= '"'.$user['case_topic'].'",';
// 				$row .= '"'.$user['acpt'].'",';
// 				$row .= '"'.$user['reviewed'].'",';
// 				$row .= '"'.$user['audit_type'].'",';
// 				$row .= '"'.$user['auditor_type'].'",';
// 				$row .= '"'.$user['voc'].'",';
// 				$row .= '"'.$user['overall_score'].'",';
// 				$row .= '"'.$user['possible_score'].'",';
// 				$row .= '"'.$user['earned_score'].'",';

// 				$row .= '"'.$user['necessary'].'",';
// 				$row .= '"'.$user['request'].'",';
// 				$row .= '"'.$user['follow_up'].'",';
// 				$row .= '"'.$user['field'].'",';
// 				$row .= '"'.$user['ticket'].'",';
// 				$row .= '"'.$user['callbacks'].'",';
// 				$row .= '"'.$user['notes'].'",';
// 				$row .= '"'.$user['Leave'].'",';
// 				$row .= '"'.$user['Review'].'",';
// 				$row .= '"'.$user['completion'].'",';
// 				$row .= '"'.$user['CALL1'].'",';
// 				$row .= '"'.$user['CALL2'].'",';
// 				$row .= '"'.$user['CALL3'].'",';
// 				$row .= '"'.$user['SUPPORT1'].'",';
// 				$row .= '"'.$user['SUPPORT2'].'",';
// 				$row .= '"'.$user['SUPPORT3'].'",';
// 				$row .= '"'.$user['LISTENING1'].'",';
// 				$row .= '"'.$user['LISTENING2'].'",';
// 				$row .= '"'.$user['LISTENING3'].'",';
// 				$row .= '"'.$user['INTERACTION1'].'",';
// 				$row .= '"'.$user['INTERACTION2'].'",';


//                 $row .= '"'.$user['cmt1'].'",';
//                 $row .= '"'.$user['cmt2'].'",';
//                 $row .= '"'.$user['cmt3'].'",';
//                 $row .= '"'.$user['cmt4'].'",';
//                 $row .= '"'.$user['cmt5'].'",';
//                 $row .= '"'.$user['cmt6'].'",';
//                 $row .= '"'.$user['cmt7'].'",';
//                 $row .= '"'.$user['cmt8'].'",';
//                 $row .= '"'.$user['cmt9'].'",';
//                 $row .= '"'.$user['cmt10'].'",';
//                 $row .= '"'.$user['cmt11'].'",';
//                 $row .= '"'.$user['cmt12'].'",';
//                 $row .= '"'.$user['cmt13'].'",';
//                 $row .= '"'.$user['cmt14'].'",';
//                 $row .= '"'.$user['cmt15'].'",';
//                 $row .= '"'.$user['cmt16'].'",';
//                 $row .= '"'.$user['cmt17'].'",';
//                 $row .= '"'.$user['cmt18'].'",';
//                 $row .= '"'.$user['cmt19'].'",';
//                 $row .= '"'.$user['cmt20'].'",';


//                 $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
// 				$row .= '"'.$user['agnt_fd_acpt'].'",';
// 				$row .= '"'.$user['agent_rvw_date'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
// 				$row .= '"'.$user['mgnt_rvw_date'].'",';
// 				$row .= '"'.$user['mgnt_rvw_name'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

// 				fwrite($fopen,$row."\r\n");
// 			}
// 			fclose($fopen);


//         }
	//TelAid SA OB Header
	public function telaidsaobHeader(){
		return array(
			"Auditor Name",
			"Audit Date",
			"Agent",
			"Fusion ID",
			"L1 Supervisor",
			"Call Date",
			"Call Duration",
			"Audit Type",
			"Auditor Type",
			"week",
			"voc",
			"Audit Link",
			"Case Number",
			"Case Topic",
			"ACPT",
			"QA Score",
			"Complete documentation on the note field",
			"Refrain from negative or derogatory comments about customers fellow employees or services within their case notes",
			"Notes were visible on ServiceNow",
			"Call associated with the ticket",
			"Notes were not posted on labor platform",
			"Verify if LCON/Site contact receives the email regarding the AMP & VOLTE task",
			"Offers to resend the email of the AMP & VOLTE task",
			"Discusses the details of the project - ETA SOW techs name",
			"Reach out to PM for reschedule request",
			"Accurately provides any information within the task scope",
			"Offers any additional assistance",
			"Mentions the brand Telaid together with the recommended spiels during opening",
			"Follow the recommended scripts for specific task/project",
			"Redials the number immediately if no one answers within 4mins",
			"Delivers ghost call spiel",
			"Attempt to call for the 3rd time across multiple days before placing the status to PM Action Required",
			"Matches style and pace and put caller at ease",
			"Recaps the details of the task",
			"Immediately and appropriately acknowledges and responds to the callers emotional statements or tone while actively controls the interaction",
			"Maintains a friendly confident and professional voice tone throughout the interaction",
			"Demonstrates active listening by not ignoring callers information or interrupting without a courteous attempt to yield the conversation",
			"Appropriately advises of ticket status next steps and relevant time frames",
			"Tasks are moved to the correct stage after calling from the client location",
			"Uses appropriate statements and avoid jargons",
			"Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13",
			"Remark 14","Remark 15","Remark 16","Remark 17","Remark 18","Remark 19","Remark 20","Remark 21","Remark 22","Remark 23","Remark 24",
			"Call Summary",
			"Feedback",
			"Audit Start Time",
			"Agent review date",
			"Agent review note",
			"Mgnt review date",
			"Mgnt review by",
			"Mgnt review note",
		);
	}
	//Common Yes No
	public function common_yes_no(){
		return array("1"=>"Yes","2"=>"No","3"=>"N/A");
	}
	//Create TelAid SA OB CSV
	public function create_qa_telaidsaob_CSV($rr, $header, $table){
		$common_yes_no=$this->common_yes_no();
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_telaid";
		$edit_url = "process/mgnt_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'].'/telaidsaob';
			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['case_number'].'",';
			$row .= '"'.$user['case_topic'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['qa_score'].'%",';
			$row .= '"'.$common_yes_no[$user['complete_documentation']].'",';
			$row .= '"'.$common_yes_no[$user['refrain_negative']].'",';
			$row .= '"'.$common_yes_no[$user['notes_visible']].'",';
			$row .= '"'.$common_yes_no[$user['call_assoc_ticket']].'",';
			$row .= '"'.$common_yes_no[$user['notes_posted_labor']].'",';
			$row .= '"'.$common_yes_no[$user['verify_amp_volte']].'",';
			$row .= '"'.$common_yes_no[$user['offers_resend_email']].'",';
			$row .= '"'.$common_yes_no[$user['discuss_detail']].'",';
			$row .= '"'.$common_yes_no[$user['reach_out_pm']].'",';
			$row .= '"'.$common_yes_no[$user['accur_prov_info']].'",';
			$row .= '"'.$common_yes_no[$user['additional_assistance']].'",';
			$row .= '"'.$common_yes_no[$user['mention_brand']].'",';
			$row .= '"'.$common_yes_no[$user['recommended_scripts']].'",';
			$row .= '"'.$common_yes_no[$user['redial_number']].'",';
			$row .= '"'.$common_yes_no[$user['ghost_call_spiel']].'",';
			$row .= '"'.$common_yes_no[$user['attempt_3rd']].'",';
			$row .= '"'.$common_yes_no[$user['match_style_pace']].'",';
			$row .= '"'.$common_yes_no[$user['recap_details']].'",';
			$row .= '"'.$common_yes_no[$user['immediate_acknowledge']].'",';
			$row .= '"'.$common_yes_no[$user['maintain_friendly']].'",';
			$row .= '"'.$common_yes_no[$user['active_listening']].'",';
			$row .= '"'.$common_yes_no[$user['advise_ticket_status']].'",';
			$row .= '"'.$common_yes_no[$user['task_correct_stage']].'",';
			$row .= '"'.$common_yes_no[$user['avoid_jargons']].'",';
			$row .= '"'.$user['complete_documentation_remarks'].'",';
			$row .= '"'.$user['refrain_negative_remarks'].'",';
			$row .= '"'.$user['notes_visible_remarks'].'",';
			$row .= '"'.$user['call_assoc_ticket_remarks'].'",';
			$row .= '"'.$user['notes_posted_labor_remarks'].'",';
			$row .= '"'.$user['verify_amp_volte_remarks'].'",';
			$row .= '"'.$user['offers_resend_email_remarks'].'",';
			$row .= '"'.$user['discuss_detail_remarks'].'",';
			$row .= '"'.$user['reach_out_pm_remarks'].'",';
			$row .= '"'.$user['accur_prov_info_remarks'].'",';
			$row .= '"'.$user['additional_assistance_remarks'].'",';
			$row .= '"'.$user['mention_brand_remarks'].'",';
			$row .= '"'.$user['recommended_scripts_remarks'].'",';
			$row .= '"'.$user['redial_number_remarks'].'",';
			$row .= '"'.$user['ghost_call_spiel_remarks'].'",';
			$row .= '"'.$user['attempt_3rd_remarks'].'",';
			$row .= '"'.$user['match_style_pace_remarks'].'",';
			$row .= '"'.$user['recap_details_remarks'].'",';
			$row .= '"'.$user['immediate_acknowledge_remarks'].'",';
			$row .= '"'.$user['maintain_friendly_remarks'].'",';
			$row .= '"'.$user['active_listening_remarks'].'",';
			$row .= '"'.$user['advise_ticket_status_remarks'].'",';
			$row .= '"'.$user['task_correct_stage_remarks'].'",';
			$row .= '"'.$user['avoid_jargons_remarks'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}



	public function indiamart_blHeader()
	{
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Partner_name","Offer_ID","Approved_By ","Approved_id ","Tenure ","MCAT ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Details missing from call ","Existing ISQ details missing ","Existing Enrichment details missing ","Formatting error in description ","Formatting error in ISQ ","Formatting error in Lead title ","Selling requirement ","Duplicate requirement ","Approved without consent ","Wrong contact person ","Grossly different requirement ","Unnecessary Lead creation ","Single Buylead approved for diffferent requirement ","Requirement was not clear ","Wrong BuyLead Title ","Wrong supplier selected ","Right supplier deselected ","Wrong keyword used for search ","Wrong MCAT mapped ","Relevant MCAT not mapped ","Wrong Prime MCAT selected ","ISQ not probed ","Enrichment details not probed ","Greetings not done on call ","Introduction / Call Purpose not shared ","Expectation setting missing ","Hold procedure not followed ","Rate of Speech ","Language Expertise error ","Call closing error ","Associate Inactive on call ","Call Ettiquettes error ","Associate noise ","Tech noise ","Dead air observed ","Abusive Language ","Rude/Sarcastic on call ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Comments 24 ","Comments 25 ","Comments 26 ","Comments 27 ","Comments 28 ","Comments 29 ","Comments 30 ","Comments 31 ","Comments 32 ","Comments 33 ","Comments 34 ","Comments 35 ","Comments 36 ","Comments 37 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Interval(In Second)","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function final_pmoHeader()
	{
		return $arrayName = array ("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Review Date","CSR Name", "Team Manager", "Case Topic", "ACPT","Reviewed By","Audit Type", "Auditor Type", "Voc","Overall Score", "Possible Score", "Earned Score","Initial call to the Field Technician","Field Technicians assigned to the job: Names and cell numbers" ,"Review tools and equipment needed for the task to be performed","Review the MS Shredd Document","Verify the technician on site and quantity of techs","Verify Field tech has the scope all documents needed to complete the task","Quick overview of Scope and tools scanner excel laptop camera (cell) post-it notes sharpie","Provide proper expectations of the task to technicians","Ensure the technician has the Zoom Meeting information","Relay that an option to use the MS Guest Wi-Fi is available if cell signal is an issue Report out to MS if assistance is needed for access.","Deliverables","Field techs will need to make a final sweep of the Branch","ALL assets will need to be stored in the Comm Room or a locked room","Verify final resting place of all assets inventoried- DNR tags are correct and in place",	"Email notification to MS and the Telaid team",	"Ensure the technicians information","Keep in contact with the MS PM","Ensure you are receiving the pictures required for the task","Ensure the number reference is clearly visible in the picture and is not on any label tag or writing on the device","All devices need to be clear in the picture and the entire piece of equipment visible","Upload pictures in the MS Box", "Ensure the number sequence is followed when uploading and labeling is accurate","There should never be a long pause receiving pictures from the Field", "Notify MS for resolution if MS controls. Internal if it is something Telaid controls","Understand the timing of the scope/task","Telaid rep populate a draft shred document ","Check all pictures against the shredd document	","Doublecheck the desktop computers along with the hard drives or SSDs","Verify all number references and pictures match",	"Upload all pictures in a timely manner","Double-check all SN in the cells ","Final Telaid document will be uploaded after the MS review ","Follow the scope protocols when saving the final shredd","Ask LCON sign your work order and check out","Ask tech to check in with Telaid PM and look for the LCON","Check tools needed //COC boxes box cutter sharpie -bubble wrap -as per sow","Agent confirm if the tech receive an email notification ","Verify tech if the box contains the necessary materials for the task", "Review all pictures/documents prior to finalizing with MS","Send the bottom/top picture of the first box and send it to MS for approval","Verify the COC to ensure all recorded info is accurate","Working with the LCON to ensure the review is accurate","Place the Security serialized seals","Tech must ask approval to PM for boxes to be sealed", "Chain of Custody form - must be reviewed before and after",	"Deliverables",	"Contact the technician 24 to 48 hours prior to being scheduled to be onsite","Discuss the SOW (Review prior to arriving on site the toolds needed i.e. wood titanium drill bits bucket clamps and safety glasses and gloves as per the scope of work","Review again once the tech arrives on site	","Ensure the techs arrive with the required tools.","Verify information on the COC with the tech","Confirm the tech has the correct zoom bridge info","Review wat is expected on zoom and ensure there is an understanding of proper protoclols","Drill technician SOW","Provided disclaimers in accordance with program requirements","Responded in a way that is limited to the caller's inquiry","Appropriately greeted caller and identified self and organization","Verify if tech receives the email regarding the SOW","Asked relevant clarifying questions to accurately identify caller's inquiry","Took the lead used ownership phrases and promoted confidence in resolving the inquiry","Handled callers needs in a clear and organized manner", "Listened actively and limited need to ask caller to repeat information","Used appropriate volume pace and voice tone. Words were clearly enunciated and properly pronounced.",	"Demonstrated empathy and diffused angry callers when appropriate","Maintained business professional relationship", "Avoided interrupting caller","Asked if caller had additional inquiries prior to call completion","Agent mentions the brand Telaid together with the recommended spiels during opening","Pre Calls : Survey Remark 1","Pre Calls : Survey Remark 2","Pre Calls : Survey Remark 3","Pre Calls : Survey Remark 4","Field technician arrival Remark 1","Field technician arrival Remark 2","Field technician arrival Remark 3","Field technician arrival Remark 4","Field technician arrival Remark 5","Field technician arrival Remark 6","Field Technician Completion/Departure Remark 1","Field Technician Completion/Departure Remark 2","Field Technician Completion/Departure Remark 3","Field Technician Completion/Departure Remark 4","TELAID COORDINATOR / PM Remark 1","TELAID COORDINATOR / PM Remark 2","TELAID COORDINATOR / PM Remark 3","TELAID COORDINATOR / PM Remark 4","TELAID COORDINATOR / PM Remark 5","TELAID COORDINATOR / PM Remark 6","TELAID COORDINATOR / PM Remark 7","TELAID COORDINATOR / PM Remark 8","TELAID COORDINATOR / PM Remark 9","TELAID COORDINATOR / PM Remark 10","TELAID COORDINATOR / PM Remark 11","TELAID COORDINATOR / PM Remark 12","TELAID COORDINATOR / PM Remark 13","TELAID COORDINATOR / PM Remark 14","TELAID COORDINATOR / PM Remark 15","TELAID COORDINATOR / PM Remark 16","TELAID COORDINATOR / PM Remark 17","TELAID COORDINATOR / PM Remark 18","TELAID COORDINATOR / PM Remark 19","TELAID COORDINATOR / PM Remark 20","Packing Remark 1","Packing Remark 2","Packing Remark 3","Packing Remark 4","Packing Remark 5","Packing Remark 6","Packing Remark 7","Packing Remark 8","Packing Remark 9","Packing Remark 10","Packing Remark 11","Packing Remark 12","Drilling Remark 1","Drilling Remark 2","Drilling Remark 3","Drilling Remark 4","Drilling Remark 5","Drilling Remark 6","Drilling Remark 7","Drilling Remark 8","Compliance Remark 1","Compliance Remark 2","Soft Skills Remark 1","Soft Skills Remark 2","Identifying and Meetings Needs Remark 1","Identifying and Meetings Needs Remark 2","Identifying and Meetings Needs Remark 3","Identifying and Meetings Needs Remark 4","Communication Skills Remark 1","Communication Skills Remark 2","Communication Skills Remark 3","Communication Skills Remark 4","Closing Remark 1","Closing Remark 2","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
	}
	public function telaidstarbucksHeader()
	{
		return $arrayName = array ("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Review Date","CSR Name", "Team Manager", "Case Topic", "ACPT","Reviewed By","Audit Type", "Auditor Type", "Voc","Overall Score", "Possible Score", "Earned Score","Leave complete documentation in the notes field","Refrain from any negative or derogatory comments about customers fellow employees or services within their case notes" ,"Associate the call to the right ticket","Post notes on the correct platforms","Verify if LCON/Site contact receives the email regarding the AMP & VOLTE task","Offer to resend the email for the AMP & VOLTE task","Verify the site and discusse the details of the project","Escalate the ticket correctly","Review the ticket and provide accurate details within the scope of support","Execute the opening spiel clearly and correctly","Deliver ghost call spiel","Recap the details of the task","Follow proper hold procedures and mute expectations","Call the correct technicians number",	"Acknowledge and respond to the callers emotional statements or tone while actively controlling the interaction",	"Maintain a friendly confident and professional tone of voice throughout the interaction","Listen actively during the interaction","Advise customer accurately about ticket status next steps and relevant time frames","Move tasks to the correct stage after calling the client location","Send project task to QA GC prior to making the call","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
	}

	public function indiamart_nonblHeader()
	{
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Call_status","Call_id","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Fail Greetings ","Fail Self and Company Introduction ","Fail Right Party Confirmation ","Fail Purpose of Call ","Fail Rate of Speech ","Fail Active Listening ","Fail Poor Language Expertise ","Fail Active Listening ","Fail Poor Language Expertise ","Fail Abusive Rude Sarcastic ZTP ","Fail Did not probe buyer Requirement properly ","Fail Did not use BL conversion Script ","Fail Reason why call landed on Indiamart not properly communicated ","Fail After Call Expectation Setting ","Fail Thanking Buyer ","Fail Near By Noise ","Wrong Disposition ","Wrong Deletion ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Interval(In Second)","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function indiamart_deletionHeader()
	{
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Partner_name","Tenure","Disposition_audit ","Offer_ID ","Deleted_By ","Deleted_id ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Wrong Deletion Dispostion Selection ","Phone Etiquette Error ","Error Found ","Wrong Deletion ","Others ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Interval(In Second)","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function sales_carpartHeader()
	{
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","QA Sampling ","Order Number ","NPS","CSAT","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Auto Fail ","Sales Call Type ","Non-Sale ","Introduction ","Active Listening ","Questioning ","Presentation ","Closing the Sale ","CPP ","Related Parts ","Shipping Options ","Shipping and Billing ","YMMSE ","Part Name(s) ","Total Price of the order ","Rebranding ","Tracking Email ","Overcoming Objections ","Discount Rules ","My Account Utilization", "Documentation ", "Data Gathering Compliance","Account Verification Accuracy","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ", "Comments 19", "Comments 20", "Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function inboundHeader()
	{
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","QA Sampling ","Order Number ","NPS","CSAT","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Auto Fail ","Sales Call Type ","Non-Sale ","Introduction ","Active Listening ","Questioning ","Presentation ","Closing the Sale ","CPP ","Related Parts ","Shipping Options ","Shipping and Billing ","YMMSE ","Part Name(s) ","Total Price of the order ","Rebranding ","Tracking Email ","Overcoming Objections ","Discount Rules ","My Account Utilization", "Documentation ", "Data Gathering Compliance","Account Verification Accuracy","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ", "Comments 19", "Comments 20", "Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function sontiqHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","CASE_ID","CALL_ID","CALL_TYPE ","WRAP_TYPE ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Procedural Execution ","Information Accuracy and Relevancy ","Service Level Adherence ","Activity Accuracy ","Records and Documentation ","Survey Completion ","Interaction and Engagement ","Security ","Professionalism ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function appleSortantsHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","1 Presentation Respect for the Reception Charter","2 Objective of the call Nature of the call campaign","3 Client Authentication","4 Identification of needs","6 Collection of essential elements for understanding the need","7 Rationale for rating","8 Note Taking","9 Taking leave","10 Line resumption","11 Ease of expression or Speech Vocabulary or Rhythm Flow","12 Directivity","13 Language Positivism","14 Dynamism Rhythm of the voice","15 Courtesy or Friendliness of the interview","16 Sense of service or Involvement","17 Ability to defuse dissatisfaction or Handling objections","18 Your smile","19 Directivity on the subject or Audited task","20 Compliance with procedure","21 Clarity of explanations provided","22 Tracing the compliant call (COM message Mail etc.)","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function collecteHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type","Auditor Type","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation - Respect of the welcome charter ","Identification of the interlocutor ","Compliance with the script: mail reception / presentation subject of the call ","Listen to customer needs ","Collection of essential elements for processing: validation of clt coordinates ","Personalized leave ","Ease of expression / Speech - Vocabulary ","Directivity ","Voice rate ","Courtesy ","Active / attentive listening ","Smile ","Compliance with the procedure ","Clarity of the explanations provided ","Call qualification ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function schoolonlineHeader(){
		return Array (" Auditor Name"," Audit Date"," Fusion Id"," Agent"," L1 Super"," Call Date"," Call Duration"," Audit Type"," Auditor Type"," VOC "," Overall Score "," Possible Score "," Earned Score "," Presentation: Welcome Pharse "," Learn research "," Client authentication "," Product mastery "," Treatment of the objection "," Active / attentive listening "," Level of language & expression "," Voice rate "," Courtesy "," Smile "," The directivity "," Validation of understanding "," Validation of the customer agreement "," Taking the appointment "," Call history "," Personalized leave "," Comments 1 "," Comments 2 "," Comments 3 "," Comments 4 "," Comments 5 "," Comments 6 "," Comments 7 "," Comments 8 "," Comments 9 "," Comments 10 "," Comments 11 "," Comments 12 "," Comments 13 "," Comments 14 "," Comments 15 "," Comments 16 "," Call Summary "," Feedback "," Entry By "," Entry Date "," Audit Start Time "," Client entry by "," Mgnt review by "," Mgnt review note "," Mgnt review date "," Agent review note "," Agent Feedback Acceptance "," Agent review date "," Client review by "," Client review note "," Client_rvw_date ");
	}

	/* public function phsHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Channel","File_number","Acpt ","Ztp ","Member_id ","Audit Type ","Auditor Type ","VOC ","Call Type","Caller Type","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Did the CSR adhere to all Authentication and Security Policies of the account member? ","Did the agent provide information to a provider about the status of the members account? ","Did the agent able to handle a credit card information correctly? ","For account closure did the agent follow cancellation process? ","Did the agent submit or process all eligible refund requests in accordance with the Refund Policy. ","Did the agent properly change the payment method? ","Did the agent properly discussed member benefits? ","Did the agent able to properly provide the claims phone number and PO box? ","Did the agent inform the customer that the calls may be recorded for security purposes during callback? ","Was all product information provided accurately? ","Did the agent locate the information in a timely manner? ","Did the agent execute properly any of the Escalation? ","Did the agent properly execute any of the process for DOCUMENTATION Were Case Comments Complete and Accurate? ","Did the agent followed proper call handling? ","Maintains a friendly confident and professional voice tone throughout interaction. ","Accurately communicate during the interaction? ","Did the agent meet the expectations they set during the interaction? ","Going above and beyond or doing the extra mile. ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	} */

	public function chariotHeader(){
		return Array ("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Type","Call Duration","Customer Name","Account/REP","CSN","Analyst","Call Recording","Score Pattern","Auto Fail","Coaching Pattern","Chariot(Call Type)","Audit Type", "Auditor Type", "Voc","Overall Score","Answered call promptly","Used appropriate answer phrase","Spoke clearly and enthusiastically","Agent did not interrupt/over talking the customer","Acknowledged customer statements(Finesse)","The customer did not have to repeat themselves","Empathy/Sympathy","Utilizes resources","Explained rate plan accurately and completely","Disclosures read accurately and appropriately","Properly verified account","Complete and Accurate Information","Documentation","Enters promo code when appropriate","Overcomes objections/Stresses benefits","Asks for sale","Used proper hold procedure","Speaks well of the company systems and tools","Jargon","Courtesy (Finesse)","Call control (Finesse)","Call tone/Pace (Finesse)","Build Rapport/Address Caller by name (Finesse)","Professionalism (Finesse)","Offers further assistance","Used appropriate branding statement","Transferred call appropriately","Possitive","Negetive","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
	}

	public function catiHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type","Auditor Type","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation of the agent & the Company","Presentation of the subject of the call","Validation of the interlocutor's availability","Authentication of the interlocutor","Active & Attentive Listening","Questioning","Compliance with the Questionnaire","The directivity & structure of the call","smile","Courtesy","Putting on hold","The waiting time","Validation of the Questionnaire","Taking leave","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function flv_venteHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type","Auditor Type","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation (name first name sponsor) ","Presentation of the partnership ","search for the interlocutor ","Respect of the sentence of the CNIL ","Presentation of the subject of the call ","Treatment refusal to answer ","Making appointments ","Situation ","Presentation of 'how it works' ","Knowledge of the product ","Knowledge of processes and code of conduct ","Half pension ","Discovery of the need ","Ability to establish dialogue ","Active listening ","Ability to rebound ","Validation of the customer's understanding ","Validation of interest ","Respect of the refusal sending of documents and proposal to visit the website ","Proposal phrase ","UPSELL Additional sale ","Understanding the objection ","Rewording ","Questioning or discovery ","Treatment of the objection ","Verification of address or mobile & email ","Respect of the validation sentences of the script ","Smile or dynamism ","Directivity ","Speech rate ","Verb in the present tense or clear concise speech or positive wording ","Empathy ","Silence management ","Personalized leave courtesy ","Call history ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Comments 24 ","Comments 25 ","Comments 26 ","Comments 27 ","Comments 28 ","Comments 29 ","Comments 30 ","Comments 31 ","Comments 32 ","Comments 33 ","Comments 34 ","Comments 35 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function magnilifeHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Disposition","Wrong_disposition","UCID ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","The agent adhered to suggested greeting and sounds friendly ","The agent uses customers name at least 3 time in the call ","The agent used please and thank you when appropiate ","The agent sound willing to help ","The agent sounds clear and professional ","The agents does not interrumpt the caller when speaking ","The agent showed appreciation when applicable ","The agent showed empathy when applicable ","The agent addressed properly when placing the caller on mute ","The agent keeps the control of the call ","The agent makes good use of FAQ to rebuttal any possible sale when applicable ","The agent reads offer properly includes prices and mentions 'plus shipping and handling' ","The agent answers product related questions properly ","The agent works efficiently to complete the purpose of the call ","The agent answers company related questions properly ","The agent confirms the billing information ","The agent read summary of the order properly including prices ","The agent provides order number before ending the call ","The agent asked if there was anything else he or she can help with ","The agent adhered to suggested closing ","Call Summary ","Feedback ","Entry By ","Audit End Date Time","Audit Start Time ","Interval(In Second)","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function fiberconnectHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Phone","Audit Type","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Opening ","Greeting ","Owner Discovery ","Professionalism ","Hold Procedure ","Acknowledgement ","Dead Air ","Rebuttals ","Urgency ","Education regarding Change and improvement customer would get ","Resolution or assistance if customer use any other provider ","Discovery Probing ","Product Knowledge ","Correct Information ","On call resolution addressed all query of customer before taking authorization ","Authorization 'Customer said clear yes' ","Closing ","Call Summary ","Feedback ","Entry By ","Audit End Date Time","Audit Start Time ","Interval(In Second)","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function arabophoneHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type","Auditor Type","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation of the company and the agent","Identification and authentication of the client","Ease of expression / Speech - Vocabulary","Directivity","Courtesy / Friendliness of the interview","Sense of service / Involvement","Your smile","Product mastery","Questioning","Confirmation of the type of 'water heater'","Putting on hold","The waiting time","Active / attentive listening","Personalization","Validation of understanding","Validation of satisfaction","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function flv_rcHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type","Auditor Type","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation with the bond requested by the client ","Customer identification ","Active listening ","Acknowledge ","Questioning ","Relevance of the answer ","Courtesy ","Personalization ","Smile ","Voice rate ","Level of language & expression ","Empathy ","The directivity and structure of the call ","Putting on hold ","The waiting time ","Additional Sale ","Validation of the customer's understanding ","Call history ","Personalized leave ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	/* public function virtuoxHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Recording_id","Issue_type","Issue ","Audit Type ","Auditor Type ","VOC ","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Greet the customer by thanking them for answering the call. ","Confirm the customer's identity? ","Ask Confirm the customer's Company Name? ","Confirm the customer's fax number. ","Listen actively and respond appropriately ","Collabarating with the customer to thoroughly define the opportunity issue and identify the best solution. ","Identifying the company and stating the reason of the call to the authorized person. ","Maintain control of the call? ","Words and tone of voice communicates confidence and assurance? ","Treat the caller with care respect and professionalism? ","Follow the correct procedures for telephone handling? ","Accurately communicate during the interaction? ","Provide correct complete information based on policies and procedures? ","Accurately document the call? ","Resolve the reason for calling to the extent possible during the interaction? ","Setting clear expectations. ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	} */

	public function awareness_chatHeader1(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Channel","CaseTicket","Product ","Acpt ","Cust_rate ","Call_id ","Call_type ","Audit Type ","Auditor Type ","VOC ","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Agent verify Username / Email Address for correct account. ","Setting proper expectation to the customer. ","Did the agent ask if there is anything that they can do to enhance customer experience before interaction ends? ","Did the agent follow correct / proper procedure? ","Giving accurate information. ","Did the agent create a case and document properly. ","No Case Created ","Incomplete notes ","Others ","The agent greet and identified themselves to the customer. ","The agent showed politeness courtesy and professionalism throughout interaction. ","Stays focus and concise with directions and allows customers to complete tasks prior to moving to next steps. ","Accurately communicates to the customer. ","Perform logical troubleshooting steps and uses targeted probing questions. ","The agent follow correct procedures for placing the customer on hold ","Before Resolution ","During Resolution ","After Resolution ","IEAT ","The agent must thank the customer for contacting at the end of every chat session. ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	/* public function alphaHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Recording","Issue ","Audit Type ","Auditor Type ","VOC ","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Did the agent properly execute the opening of the call? ","Did the agent  enthusiastically welcomes or greet the caller? ","Did the agent able to introduce AGE as the brand name? ","Did the agent properly execute the verification process? ","Did the agent able to verify customers information? ","Did the agent follow the protocol in verifying the authorized person? ","Did the agent properly interact with the customer? ","Did the agent used active listening skills /probe to correctly diagnose caller issue(s)/ concern(s)?","Did the agent treat the customer/caller with care respect and professionalism? ","Did the customer understands the offers of Alpha Gas and Elec?","Did the agent properly execute the resolution of the call? ","Did the agent summarizes the actions/accomplishments within the conversation? ","Provide correct / complete information based on policies and procedures? ","Did the agent properly documented the call?Was the call dispositioned properly? ","Did the agent properly ended the call? ","Did the agent used an effective rebuttal statement to overcome objections and move customer for enrollment? ","Did the agent ask and address the concern of the customer? ","Did the agent offered an option to the customer to prevent cancellation? ","Did the agent able to verify and ask a consent from the customer to enroll/retain the account? ","Did the agent understands buying signals or concerns to avoid cancellation? ","Did the agent asked appropriate questions when transitioning to offer(s)? ","Did the agent gave the relevant features benefits and results to the customer? ","Did the agent able to verify if the customer is atleast 18 years old and not part of the HEAP when they enroll? ","Did the agent used a correct script when giving calls? ","Did the agent followed the correct script? ","Did the agent capture the correct information from the US rep? ","i Agent captured the correct 'Rep ID' in recording and CRM ","ii Agent captured the correct device used in recording and CRM ","Did the agent captured the correct information from the customer? ","i Agent captured the correct address city state and zip code in recording and CRM ","ii Agent captured the correct phone number in recording and CRM ","iii Agent captured the correct utility in recording and CRM ","iv Agent captured the correct first name and last name in recording and CRM ","v Agent captured the correct account number in recording and CRM ","vi Agent captured the correct language in recording and CRM ","Did the customer understands the TPV question properly ","Did the agent able to ask and complete all qualifying questions? ","Did the agent selected the correct call source in CRM? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Comments 24 ","Comments 25 ","Comments 26 ","Comments 27 ","Comments 28 ","Comments 29 ","Comments 30 ","Comments 31 ","Comments 32 ","Comments 33 ","Comments 34 ","Comments 35 ","Comments 36 ","Comments 37 ","Comments 38 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time", "Interval(In Second)","Client entry by [","Mgnt review by","Mgnt review note","Mgnt review date ","Agent review note","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	} */

	public function keeperHeader(){
		return Array ("Auditor Name","Audit Link","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Email","Issue","Autofail","Audit Type ","Auditor Type ","VOC ","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Greetings Closing Personalize ","Treat the customer with care and professionalism ","Identified the exact reason for contacting. ","Adhere to the chat and email response time. ","Did the TSR adhere to all Authentication and Security Policies? ","Tool Utilization ","Adhere to Account Processes Compliance ","Perform necessary and relevant troubleshooting steps ","Probing Question ","Incorrect Steps Provided ","Upsell ","Email tagging and Case Status ","Was the issue resolved? was all the questions answered? Offer alternative? Forwarded to the correct dept? ","Did the TSR use proper spelling punctuation and grammar for all written customer-facing communication? ","Whitespacing ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function itel_inbHeader()
	{
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","ACPT ","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Did the agent use the right opening spiel? ","Did the agent open it in a lively manner? ","Was the call answered within 5 seconds? ","Did the agent sound enthusiastic on the call? ","Was the agent clear and can be easily understood? ","Was the agent attentively listened to the caller? ","Was the agent confident in delivering the information? ","Did the agent avoid interrupting the customer? ","Did the agent empathized on the call? ","Was there dead air in any part of the call? ","Did the agent followed the hold guideliness? ","Did the agent use courteous and polite words when talking to the customer? ","Did the agent escalated the concern of the customer (Only applicable if the customer asked for a supervisor) ","Did the agent have full control over the call? ","Is this a First Call Resolution call? (If applicable) ","Was the tracker Updated? ","Did the agent use the right disposition on the tracker? ","Did the agent give complete and accurate information? ","Did the agent asked for further assistance? ","Did the agent use the right closing script? ","Is the agent rude on the call? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function alterasHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Call_id","Call_type","Audit Type ","Auditor Type ","VOC ","Audit Link","Overall Score ","Possible Score ","Earned Score ","Company and agent presentation ","Presentation of the subject of the call ","Search for the right contact person ","Treatment of the objection ","Name First name Function and E-mail ","Smile ","Active / attentive listening ","Courtesy ","Voice rate ","Level of language & expression ","The directivity and structure of the call ","Compliance with the maintenance guide ","Personalized leave ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function itel_obHeader()
	{
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Audit Link","ACPT ","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Did the agent do the right opening spiel and looked for the actual customer? ","Did the agent ask if the customer is available to take the survey? ","Did the delivered the disclaimer spiel? ","Did the agent politely ask what is the best time for her to call back? (if Applicable) ","Did the agent sound enthusiastic on the call? ","Was the agent s rate of speech just right? ","Was the agent actively listening to the caller? ","Was the agent polite on the call? ","Did the agent avoid interrupting the customer? ","Did the agent empathized to the customer? (If applicable) ","Did the agent escalated the concern of the customer? (Only applicable if the customer asked for a supervisor) ","Were all applicable questions on the survey asked? ","Did the agent tag all questions correctly? ","Did the agent ask if they want a call back from CarlCare? ","Did the agent give out closing disclaimer? ","Did the agent use the right closing spiel? ","Is the agent rude on the call? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function trapolloHeader(){

	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","Audit Type","Auditor Type","VOC","File No.", "Overall Score","Possible Score","Earned Score","1.1 Did the rep greet the caller promptly and properly? ","1.2 Did the rep ask if it is a good time to talk? ","1.3 Did the rep advise that the call is recorded? ","2.1 Did the rep try all phone numbers on file prior to reaching back out to the customer? ","2.2 Did the rep verify the member correctly? ","2.3 Did the agent correctly check availability of box? ","2.4 Did the rep correctly check availability of tape? ","2.5 Did the rep refer the caller to the instructions in the box? ","2.6 Did the rep confirm the address? ","2.7 Was the correct call tag initiated and pick up by date specified? ","3.1 Did the agent reassure the caller that everything would be handled effectively? ","3.3 Did the agent address the member by name at least once? ","3.4 Did the agent use 'please' and 'thank you' throughout the call? ","3.5 Did the agent minimize extended silences throughout the call? ","3.6 Did the agent speak with sincere warmth in his/her voice? (empathy) ","3.7 Did the agent speak clearly? ","4.1 Did the rep repeat or reiterate the instructions so that they are clear? ","4.2 Did the rep ask if the member had any questions or was clear on the process? ","4.3 Did the rep ask if there was anything else we could help with? ","4.4 Did the rep collect a good call back number? ","4.5 Did the rep leave complete detailed notes in documentation in TMC following the 5 'w s?' ","4.1 Did the rep have all information updated correctly in the ticket note? ","4.2 If a callback was promised was this done on time? ","4.3 Did the rep treat the customer with both empathy and respect and behave professionally? ","4.4 Did the rep call the correct member? ","4.5 Did the rep initiate the call tag as promised? ","4.6 Did the agent confirm the address? ","4.7 Did the agent use the proper greeting? ","4.8 Did the agent advise that the call was recorded? ","4.9 Did the agent document using the 4 'w s?' ","4.10 Did the rep initiate the call tag as promised? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Comments 24 ","Comments 25 ","Comments 26 ","Comments 27 ","Comments 28 ","Comments 29 ","Comments 30 ","Comments 31 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");

	}

	public function ubpHeader(){

	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","Audit Type","Auditor Type","VOC","File No.", "Overall Score","Possible Score","Earned Score","1.1 Did the rep ask for the individual by name?","1.2 If the person is no longer with the company did the rep ask to speak with  the current shipping manager?","1.3 Did the rep introduce him or herself and advise they were from UBP?","2.1 Did the rep explain the reason for the call and ask if we could prepare a quote for them?","2.2 If yes did the rep verify the types of freight being moved?","2.3 If no did the rep provide a rebuttal stating that we understand however we would like to provide a quote for comparision for them?follows the scripting","2.4 Did the rep gather time and date from the shipper within 3 days of this call that we can call back with a quote?","2.5 Did the rep collect  Name Title Phone Number and Appointment Time for Quote?","2.6 Did the rep verify the type of freight and if it is on a palllet? ","2.7 Did the rep verify the estimated weight of the freight and the location (city and state) where it will be going? (Preferably the address)","2.8 If the rep left a voicemail was the script followed?","2.8 If the rep provided an email only quote did they follow all appropriate procedures? ","3.1 Did the rep sound confident in our ability to solve problems for the person on the phone?","3.3 Did the agent address the member by name at least once?","3.4 Did the agent use 'please' and 'thank you' throughout the call?","3.5 Did the agent minimize extended silences throughout the call?","3.7 Did the agent speak clearly?","4.1 Did the rep verify all information given was correct?","4.2 Did the rep ask if the member had any questions or was clear on the process?","4.3 Did the rep finalize the date for the quote?","4.5 Did the rep take complete detailed notes?","4.1 Did the rep treat the caller with respect?","4.2 Did the rep provide accurate information?","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");

	}

	public function awareness_callHeader1(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","ACPT","Channel","Call Duration ","Call Type ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Agent verify Username / Email Address for correct account. ","Setting proper expectation to the customer. ","Did the agent ask if there is anything that they can do to enhance customer experience before interaction ends? ","Did the agent follow correct / proper procedure based on company policy and/or mandated guidelines? ","Provided accurate and complete information. This could be about the product functionality pricing services offered and etc. ","The agent greet and identified themselves to the customer. Warm and genuine tone of voice must be displayed to show willingness to assist. ","Ask customer name and use it appropriately. ","Paraphrase demonstrate active listening and acknowledge all statements / concerns. ","Agent should paced match that of the customer. ","The agent refrains from negative or derogatory comments about customers fellow employees or products and services. ","Must display confidence and act professional throughout the call. ","Acknowledges and responds to the customers emotional statements. Expresses empathy appropriately. ","Stays focus and concise with directions and allows customers to complete tasks prior to moving to next steps. ","Accurately communicates to the customer. Thought and sentence construction must be understandable enough not to confuse the customer. ","Perform logical troubleshooting steps and uses targeted probing questions. Pays attention to key words and phrases to quickly determine the issue and all questions are tailored fit to the customer. ","Refrain from an excessive dead air or awkward silence. ","The agent must thank the customer for contacting to properly end the call. ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Call Summary ","Feedback ","Agent Feedback","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function carddataHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation ","search for the interlocutor ","Product mastery ","Handling objections ","Validation of the customer agreement ","Call history ","Active / attentive listening ","Level of language & expression ","Voice rate ","Courtesy ","Smile ","Directivity ","Validation of understanding ","Personalized leave ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function creditsafeHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation of the company and the agent ","Identification of the decision-maker ","Product mastery ","Objection handling ","Discovery phase questioning ","Validation of the customer agreement ","Call history ","Active / attentive listening ","Level of language & expression ","Voice rate ","Courtesy ","Smile ","Directivity ","Personalization ","Personalized leave ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function soluciaHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Presentation ","search for the interlocutor ","Validation of entry to the home ","Presentation of the subject of the call ","Treatment refusal to answer ","Making appointments ","Personalization of maintenance ","Situation ","Knowledge of the product ","Knowledge of the insurance industry and administrations ","Highlighting product advantages ","Discovery of the need ","Ability to establish dialogue ","Active listening ","Ability to rebound ","Validation of the customer understanding ","Validation of interest ","Validation of the client budget ","Proposal phrase ","Do not sell the withdrawal period ","Understanding the objection ","Rewording ","Questioning / discovery ","Treatment of the objection ","Verification of address / mobile & email ","Respect of the validation sentences of the script ","validation of the commercial IN opt ","Smile / dynamism ","Directivity ","Speech rate ","Verb in the present tense / clear concise speech / positive wording ","Empathy ","Silence management ","Personalized leave courtesy ","Proposition to visit the website ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Comments 24 ","Comments 25 ","Comments 26 ","Comments 27 ","Comments 28 ","Comments 29 ","Comments 30 ","Comments 31 ","Comments 32 ","Comments 33 ","Comments 34 ","Comments 35 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function awareness_emailHeader1(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","ACPT","Channel","Case/Ticket ","Product ","Cust Rate ","Call Duration ","Call Type ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Setting proper expectation to the customer. ","Did the agent tag the interaction accordingly? ","Did the agent ask if there is anything that they can do to enhance customer experience before interaction ends? ","Did the agent follow correct / proper procedure? ","Provide accurate information. ","The agent showed politeness courtesy and professionalism throughout interaction. ","Acknowledges and responds to the customers emotional statements. Expresses empathy appropriately. ","Response time must be within 6 hours from the last time the agent grab the ticket. ","Must address all concern in an interaction if already provided by the customer without letting them to repeat it. ","Accurately communicates to the customer. Thought and sentence construction must be understandable enough not to confuse the customer. ","Perform logical troubleshooting steps and uses targeted probing questions. Pays attention to key words and phrases to quickly determine the issue and all questions are tailored fit to the customer. ","Refrains from using language that could be interpreted as offensive or controversial to a customer. ","Did the agent comply with agreed upon follow-up when scheduled. ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Call Summary ","Feedback ","Agent Feedback","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function nordnetHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Audit Type","Auditor Type","VOC ","Overall Score ","Possible Score ","Earned Score ","Customer welcome ","Smile and courtesy of the advisor ","French expression of the counselor ","Put on hold ","Inappropriate hold? ","Taking leave ","Identification of the client and his request ","Is the answer the one expected? ","Quality of explanations and customer support ","Use of tool ","ATTITUDE TOUS VENDEURS","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function freedom_financialHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Business Score ","Customer Score ","Compliance Score ","Overall Score ","Possible Score ","Earned Score ","Intro/Opening ","Account Balance/Payments ","System Knowledge ","Notes/NLS Updates ","Summary/Closing ","Reason for delinquency ","Negotiation ","Ask probing/ open ended questions ","Questions or objections appropriately addressed. ","Disparaging comments about partners or internal 5 departments avoided. ","ACH Payment ","Contact Info V 15 erificatio ","Acknowledgement empathy or empathetic tone used as necessary. ","Language or tone used that prevented a negative perception. ","Concern/Reason for Call Addressed ","Demonstrates professional call etiquette ","Expectations set for follow up actions/next interaction. ","Manages hold time & dead air ","Respectfully attempt to re-engage borrower if 0 questioning overall ","Call Recorded Disclosure ","Unfair 0 Deceptive Misleading or Inaccurate Information ","Call Time ","Collection Disclosures ","Locate Borrower (applicable for calls to third parties) ","Detect/Respond to SCRA ","Verify Identity ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Comments 24 ","Comments 25 ","Comments 26 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

public function grilleHeader(){
	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","1 - Accueil ","2 - Ecoute du besoin client ","3 - Prsentation - Respect de la charte d'accueil ","4 - Authentification du client ","5. Reformulation de la demande ","6 -Recueil des lments essentiels au traitement de la demande ","7. Recueil des lments complmentaires ","8. Consultation du dossier client ","9. Prise de cong ","10. Reprise de ligne ","11. Aisance de l'expression / locution - Vocabulaire ","12. Directivit ","13. Positivisme du langage ","14. Dynamisme - Rythme de la voix ","15. Courtoisie / Convivialit de l'entretien ","16. Sens du service / Implication ","17. Capacit  dsamorcer l'insatisfaction ","18. Ton sourire ","19. Recherche de la procdure approprie ","20. Respect de la procdure ","21. Clart des explications fournies ","22. Traage de l'appel conforme (Message COM Mail etc) ","23. Transfert conforme ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
}
public function grille_morecoHeader(){
 return Array ("Auditor Name","Audit Date","Agent","Fusion ID","L1 Supervisor","Call Date","Audit Type","Auditor Type","VOC","Earned Score","Possible Score","Overall Score","Prsentation de lentreprise et de lagent","Identification du client","Questionnement & dcouverte des besoins","Reformulation","Presentation de l'offre et mise en avant de ses avantages","Validation de la comprehension","Traitement d'objections","Conformit des informations communiques ", "Verrouillage ( validation Intrt/Voicelog )", "Ecoute active & attentive","Aisance de l'expression / debit de parole","Amabilit - Dynamisme", "Directivit","Prise de cong","Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13","Remark 14","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
}


public function grille_cashCollectionHeader(){
	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Company and agent presentation","Client identification","Call object","Process control","Product mastery","Validation Promise and or Invoice Sending","Listen","Speech","Smile","Directivity","Taking leave","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
}

public function grille_serviceCommercialHeader(){
	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Company and agent presentation","Client identification","Questioning & discovery of needs","Rewording","Presentation of the offer and highlighting its advantages","Validation of understanding","Handling of objections","Product product knowledge","Lock (interest validation + reminder appointment)","Active & attentive listening","Speech ","Friendliness courtesy smile and dynamism","Directivity","Taking leave","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
}

public function telaidsaHeader(){
	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Did the agent execute properly any of the Escalation? ","Documentation: Properly filled case fields ","Did the agent follow proper call handling? ","Product Information and Scope of Support ","Soft Skills: courtesy positive tone and active listening ","Soft Skills: Setting expectations during the interaction ","Soft Skills: Communication ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date") ;
}

public function cis_contractsHeader(){
	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Block Code ","Channel ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Did the agent check that we have all sufficient information to send out a contract? ","Did the agent check the function diary ensure that we still have the meeting space available? ","Did the agent change the Status on S&C to PRO? ","Did the agent complete the contract with all the correct contact property and date information? ","Did the agent ensure that the correct main meeting room syndicates layout and attendees were stated? ","Was the Packages Description section correctly filled with the appropriate information? (If applicable) ","Was the Catering section correctly filled with the appropriate information? (If applicable) ","Was the Equipment section correctly filled with the appropriate information? (If applicable) ","Was the Additional Info section correctly filled with the appropriate information? (If applicable) ","Was the Accommodation section correctly filled with the appropriate information? (If applicable) ","Did the agent ensure that the Rate Description Rate Amount Days and Delegates added up correctly for the total amount payable? ","Did the agent state their name and date at the bottom of the contract? ","Did the agent use the correct template for sending out contracts? ","Did the agent attached the contract and meeting T&Cs? ","Did the agent use their signature at the end of the email? ","If non-live property did the agent email the hotel asking them to place the space on hold and then proceed with the contract? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","comments 8 ","comments 9 ","comments 10 ","comments 11 ","comments 12 ","comments 13 ","comments 14 ","comments 15 ","comments 16 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
}

public function cis_proposalHeader(){
	return Array ("Auditor Name999","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Block Code ","Channel ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Did the agent check that the enquiry has all details? (such as correct meeting date delegates and layout) ","Did the agent check the caps and dims to ensure that we have a suitable room type to offer? ","Did the agent load the block for the correct property and dates? ","Was the function diary checked before loading the block? ","Did the agent choose the correct profile/email profiles if a profile doesnt exist? ","Is the market segments correctly inputted? (Status Market Source Origin Type) ","Did the agent load bedrooms on the grid correctly? (If applicable) ","Did the agent load the meeting block correctly? (Separate Charges / DDR) ","Did the agent add block notes to what was offered? ","Did the agent add a trace to the block with the correct chase date? ","Did the agent check smart space and quote to the appropriate demand? ","Did the agent compose the proposal in the correct formant font and colour? ","Did the Contact and Meeting information table have all the correct detail on? ","Was the rate section correct and simple to read for the client? ","Did the agent amend the subject line accordingly? ","Did the the agent quote in the correct currency? ","Did the agent send it from the meet Inbox? ","Did the agent use their signature at the end of the email? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
}

public function telaidtaHeader(){
	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Did the agent execute properly any of the Escalation? ","Documentation: Properly filled case fields ","Documentation: Complete and Accurate case comments ","Did the agent followed proper call handling? ","Product Information and Scope of Support ","Soft Skills: courtesy positive tone and active listening ","Soft Skills: Setting expectations during the interaction ","Soft Skills: Communication ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date")  ;
}


// public function telaidqaHeader(){
// 	return Array ("Auditor Name",
// 			"Audit Date",
// 			"Call Date",
// 			"Agent",
// 			// "Fusion ID",
// 			"L1 Supervisor",
// 			"CSR Name:",
// 			"Team Manager:",
// 			"Case Topic:",
// 			"Reviewed By:",
// 			"ACPT",
// 			"Call Duration",
// 			"Audit Type",
// 			"Auditor Type",
// 			"VOC",
// 			"QA Score",
// 			"Escalate ticket to the correct level Notify PM via email if necessary",
// 			"Direct the technician to previous Service Analyst/Technical Analyst upon request.",
// 			"Send a message to SDMGC for any notification and request follow-up.",
// 			"Make complete and concise documentation on the note field.",
// 			"Properly tie the correct PRJ ID to its parent ticket.",
// 			"Make a separate documentation segment for disconnected calls and callbacks.",
// 			"Refrain from any negative or derogatory comments about customers fellow employees or services within their case notes.",
// 			"Leave notes in the ticket.",
// 			"Review previous ticket notes",
// 			"Provide closure notes survey and close task upon completion.",
// 			"Mention TelAid in the recommended spiels during opening and closing of the call.",
// 			"Deliver ghost spiel",
// 			"Verify the caller's name location (city state and store type) and contact information (callback number).",
// 			"Provide accurate information from PRJ/SOW in ticket.",
// 			"Employ accurate and logical probing questions to uncover call drivers.",
// 			"Offer additional assistance",
// 			"Acknowledge and respond to the callers emotional statements or tone while actively controlling the interaction.",
// 			"Maintain a friendly, confident and professional tone of voice throughout the interaction.",
// 			"Listen actively during the interaction.",
// 			"MAdvise caller accurately about ticket status next steps and relevant time frames.",
// 			"Follow proper hold procedures and mute expectations.",
// 			"Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13",
// 			"Remark 14","Remark 15","Remark 16","Remark 17","Remark 18","Remark 19","Remark 20",
// 			"Call Summary",
// 			"Feedback",
// 			"Audit Start Time",
// 			"Agent review date",
// 			"Agent review note",
// 			"Mgnt review date",
// 			"Mgnt review by",
// 			"Mgnt review note",)  ;
// }

/////////////// Awareness Tech Header /////////////////////////////////

public function awarenessHeader(){
	return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","ACPT","Channel","Case/Ticket ","Product ","Cust Rate ","Call Duration ","Call Type ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Agent verify Username / Email Address for correct account. ","Setting proper expectation to the customer. ","Did the agent ask if there is anything that they can do to enhance customer experience before interaction ends? ","Did the agent follow correct / proper procedure? ","Giving accurate information. ","Did the agent create a case and document properly. Agent put appropriate tagging to every interaction? ","The agent greet and identified themselves to the customer. ","The agent showed politeness courtesy and professionalism throughout interaction. Showed empathy as appropriate. ","Stays focus and concise with directions and allows customers to complete tasks prior to moving to next steps. ","Accurately communicates to the customer. ","Perform logical troubleshooting steps and uses targeted probing questions. ","The agent follow correct procedures for placing the customer on hold ","The agent must thank the customer for contacting at the end of every chat session. ","Others ","Incomplete notes ","No Case Created ","Before Resolution ","During Resolution ","After Resolution ","IEAT ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
}

// // /////////////////// combine carparts NEW /////////////////////

	public function serviceHeader(){
		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","QA Sampling ","MC Disposition ","Order Number ","Sub Category ","NPS","CSAT","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Auto Fail ","Call Opening ","Account Verification ","Concern and Assurance ","Pace Tone and Energy ","Rapport and Empathy ","Probing ","Conveyance and Resolution ","Proper Hold Procedure ","Recap and Closing Statement ","Objections Handling ","Returns Tagging ","Documentation ","Actions Taken","Self Service Option Offered?","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Call Summary ","Feedback ","Entry Date ","Audit Start Time ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Agent Feedback Acceptance");
	}

// 	public function deltaHeader(){

// 		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type","Auditor Type","VOC","Overall Score","Possible Score","Earned Score","Did CER appropriately greet the caller?","Did CER use a pleasant respectful tone and use the caller's name at least once during the call?","Did CER answer in a timely manner?","Did CER obtain 3 pieces of PHI?","Did CER obtain member's information first and then provider's if on provider call?","If Non-Covered Parent did the caller answer yes to all 3 questions on Guidelines tab?","Did CER ask appropriate questions to determine the purpose of the call?","Did CER assess all information before responding to the caller? (BVN)","Did CER pose appropriate questions to clarify the caller's issue? (Restate Issue)","Did CER utilize active listening skills throughout the inquiry?","Did CER demonstrate use of call control techniques?","Did CER refrain from interrupting the caller?","Did CER speak clearly and concisely and at an appropriate pace?","Did CER avoid use of internal terms technical terms slang and jargon?","Did CER demonstrate confidence in responses?","Did CER minimize silences and use fillers to obtain additional information?","Did CER provide accurate information and/or demonstrate knowledge of client's benefit programs?","Did CER take correct action to resolve the caller's issues?","Did CER promote self-service options where appropriate?","Did CER answer questions clearly and completely?","Was CER proactive by anticipating additional needs of the caller?","Did CER accurately and completely document the call's outcome?","Did the CER document the callers phone number name call type CITS code etc?","Did CER close CITS if it did not require a follow up?","Did CER confirm resolution of the caller's question?","Did CER ask if any additional information could be provided?","Did CER thank the individual for calling and release the call within 5 seconds","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25","Comments 26","Comments 27","Call Summary","Feedback","Entry By","Entry Date","Audit Start Time","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
// 	}

	public function create_qa_process_new_CSV($rr,$header,$table)
	{
		$currentURL = base_url();
		if($table == 'keeper'){
			$controller = "Qa_keeper";
		}
		if($table == 'itel_inb' || $table == 'itel_ob'){
			$controller = "qa_itel";
		}

		$edit_url = "process/mgnt_rvw";
		$aded_url= $table;
		$table_final = '';
		$table_final = $table;
		// echo"<br>";
		// echo $table;
		// echo"<br>";
		//die();
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		//print_r($rr);
		if(!$table='final_pmo')
		{

			//die();
         	$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['csr'].'",';
				$row .= '"'.$user['team_manager'].'",';
				$row .= '"'.$user['case_topic'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['initial_call_to'].'",';
				$row .= '"'.$user['field_technicians'].'",';
				$row .= '"'.$user['review_tools_and'].'",';
				$row .= '"'.$user['review_the_ms'].'",';
				$row .= '"'.$user['verify_the_technician'].'",';
				$row .= '"'.$user['verify_field_tech'].'",';
				$row .= '"'.$user['quick_overview_of'].'",';
				$row .= '"'.$user['provide_proper'].'",';
				$row .= '"'.$user['ensure_the_technician'].'",';
				$row .= '"'.$user['relay_that_an_option'].'",';
				$row .= '"'.$user['deliverables'].'",';
				$row .= '"'.$user['field_techs_will'].'",';
				$row .= '"'.$user['all_assets_will'].'",';
				$row .= '"'.$user['verify_final_resting'].'",';
				$row .= '"'.$user['email_notification'].'",';
				$row .= '"'.$user['ensure_the_technician_info'].'",';
				$row .= '"'.$user['keep_in_contact'].'",';
				$row .= '"'.$user['ensure_you_are'].'",';
				$row .= '"'.$user['ensure_the_number'].'",';
				$row .= '"'.$user['all_devices_need'].'",';
				$row .= '"'.$user['upload_pictures'].'",';
				$row .= '"'.$user['ensure_the_number_sequence'].'",';
				$row .= '"'.$user['there_should_never'].'",';
				$row .= '"'.$user['notify_ms_for'].'",';
				$row .= '"'.$user['understand_the_timing'].'",';
				$row .= '"'.$user['telaid_rep_populate'].'",';
				$row .= '"'.$user['check_all_pictures'].'",';
				$row .= '"'.$user['doublecheck_the_desktop'].'",';
				$row .= '"'.$user['verify_all_number'].'",';
				$row .= '"'.$user['upload_all_pictures'].'",';
				$row .= '"'.$user['double_check_all'].'",';
				$row .= '"'.$user['final_telaid_document'].'",';
				$row .= '"'.$user['follow_the_scope'].'",';
				$row .= '"'.$user['ask_lcon_sign'].'",';
				$row .= '"'.$user['ask_all_tech_to'].'",';
				$row .= '"'.$user['check_tools_needed'].'",';
				$row .= '"'.$user['agent_confirm_if'].'",';
				$row .= '"'.$user['veerify_tech_if_the'].'",';
				$row .= '"'.$user['review_all_pictures'].'",';
				$row .= '"'.$user['send_the_bottom'].'",';
				$row .= '"'.$user['verify_the_coc'].'",';
				$row .= '"'.$user['working_with_the'].'",';
				$row .= '"'.$user['place_the_security'].'",';
				$row .= '"'.$user['tech_must_ask'].'",';
				$row .= '"'.$user['chain_of_custody'].'",';
				$row .= '"'.$user['deliverables2'].'",';
				$row .= '"'.$user['contact_the_technician'].'",';
				$row .= '"'.$user['discuss_the_sow'].'",';
				$row .= '"'.$user['review_again_once'].'",';
				$row .= '"'.$user['ensure_the_techs'].'",';
				$row .= '"'.$user['verify_information'].'",';
				$row .= '"'.$user['confirm_the_tech'].'",';
				$row .= '"'.$user['review_wat_is_expected'].'",';
				$row .= '"'.$user['drill_technician'].'",';
				$row .= '"'.$user['provided_disclaimers_in'].'",';
				$row .= '"'.$user['responded_in_way'].'",';
				$row .= '"'.$user['appropriately_greeted'].'",';
				$row .= '"'.$user['verify_if_tech'].'",';
				$row .= '"'.$user['asked_relevant_clarifying'].'",';
				$row .= '"'.$user['took_the_lead'].'",';
				$row .= '"'.$user['handled_callers'].'",';
				$row .= '"'.$user['listened_actively'].'",';
				$row .= '"'.$user['used_appropriate_volume'].'",';
				$row .= '"'.$user['demonstrated_empathy'].'",';
				$row .= '"'.$user['maintained_business'].'",';
				$row .= '"'.$user['avoided_interrupting'].'",';
				$row .= '"'.$user['asked_if_caller_had'].'",';
				$row .= '"'.$user['agent_mentions_the_brand'].'",';

                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';
                $row .= '"'.$user['cmt22'].'",';
                $row .= '"'.$user['cmt23'].'",';
                $row .= '"'.$user['cmt24'].'",';
                $row .= '"'.$user['cmt25'].'",';
                $row .= '"'.$user['cmt26'].'",';
                $row .= '"'.$user['cmt27'].'",';
                $row .= '"'.$user['cmt28'].'",';
                $row .= '"'.$user['cmt29'].'",';
                $row .= '"'.$user['cmt30'].'",';
                $row .= '"'.$user['cmt31'].'",';
                $row .= '"'.$user['cmt32'].'",';
                $row .= '"'.$user['cmt33'].'",';
                $row .= '"'.$user['cmt34'].'",';
                $row .= '"'.$user['cmt35'].'",';
                $row .= '"'.$user['cmt36'].'",';
                $row .= '"'.$user['cmt37'].'",';
                $row .= '"'.$user['cmt38'].'",';
                $row .= '"'.$user['cmt39'].'",';
                $row .= '"'.$user['cmt40'].'",';
                $row .= '"'.$user['cmt41'].'",';
                $row .= '"'.$user['cmt42'].'",';
                $row .= '"'.$user['cmt43'].'",';
                $row .= '"'.$user['cmt44'].'",';
                $row .= '"'.$user['cmt45'].'",';
                $row .= '"'.$user['cmt46'].'",';
                $row .= '"'.$user['cmt47'].'",';
                $row .= '"'.$user['cmt48'].'",';
                $row .= '"'.$user['cmt49'].'",';
                $row .= '"'.$user['cmt50'].'",';
                $row .= '"'.$user['cmt51'].'",';
                $row .= '"'.$user['cmt52'].'",';
                $row .= '"'.$user['cmt53'].'",';
                $row .= '"'.$user['cmt54'].'",';
                $row .= '"'.$user['cmt55'].'",';
                $row .= '"'.$user['cmt56'].'",';
                $row .= '"'.$user['cmt57'].'",';
                $row .= '"'.$user['cmt58'].'",';
                $row .= '"'.$user['cmt59'].'",';
                $row .= '"'.$user['cmt60'].'",';
                $row .= '"'.$user['cmt61'].'",';
                $row .= '"'.$user['cmt62'].'",';
                $row .= '"'.$user['cmt63'].'",';
                $row .= '"'.$user['cmt64'].'",';
                $row .= '"'.$user['cmt65'].'",';
                $row .= '"'.$user['cmt66'].'",';
                $row .= '"'.$user['cmt67'].'",';
                $row .= '"'.$user['cmt68'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
           //end
		} else if(!$table='telaidstarbucks')
		{

			//die();
         	$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['csr'].'",';
				$row .= '"'.$user['team_manager'].'",';
				$row .= '"'.$user['case_topic'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['documentation1'].'",';
				$row .= '"'.$user['documentation2'].'",';
				$row .= '"'.$user['documentation3'].'",';
				$row .= '"'.$user['documentation4'].'",';
				$row .= '"'.$user['process1'].'",';
				$row .= '"'.$user['process2'].'",';
				$row .= '"'.$user['process3'].'",';
				$row .= '"'.$user['process4'].'",';
				$row .= '"'.$user['support1'].'",';
				$row .= '"'.$user['call_handling1'].'",';
				$row .= '"'.$user['call_handling2'].'",';
				$row .= '"'.$user['call_handling3'].'",';
				$row .= '"'.$user['call_handling4'].'",';
				$row .= '"'.$user['call_handling5'].'",';
				$row .= '"'.$user['active_listening1'].'",';
				$row .= '"'.$user['active_listening2'].'",';
				$row .= '"'.$user['active_listening3'].'",';
				$row .= '"'.$user['interaction1'].'",';
				$row .= '"'.$user['interaction2'].'",';
				$row .= '"'.$user['interaction3'].'",';
				
                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
           //end
		} 
		else{
			
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		 $field_name="SHOW FULL COLUMNS FROM qa_".$table_final."_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }
		//array_unshift($field_val ,"audio_link");
		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		//$key2 = array_search ('auditor_name', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		//array_splice($field_val, $key2, 0, 'audio_link');
		if(in_array($table_final,array('fiberconnect','magnilife','alpha',"indiamart_bl","indiamart_nonbl","indiamart_deletion"))){
			$key1 = array_search ('client_entryby', $field_val);
			array_splice($field_val, $key1, 0, 'interval');
		}
		$field_val=array_values($field_val);
		// echo  $table_final;
		// echo"<br>";
		// print_r($field_val);
		// echo"<br>";
		// die;

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			$main_urls = $main_url.'/'.$user['id'].'/'.$aded_url;
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}
				// else if($field_val[$z]==="audio_link"){
				// 	$row .= '"'.$main_urls.'",';
				// }
				else if($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}else if($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}else if($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}else if($field_val[$z]==="interval"){
					if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
			                $row .= '---';
			            }else{
			            	$interval=strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			                $row .= '"'.$interval.'",';
			            }
				}else if(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);

	  }
	}

	/******************** END CARPARTS SALES Report Section *******************/




		/******************** Report Section *******************/

	public function qa_welcome_pickup_report()
	{
		if(check_logged_in()){
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_welcome_pickup_reports.php";
			$from_date="";
			$to_date="";
			$action="";
			$form_type ="";
			$dn_link="";
			$welcome_pickup_data = array();

			if($this->input->get('show')=='Show')
			{
				$from_date = $this->input->get('start_date');
				$to_date = $this->input->get('end_date');
				$form_type = $this->input->get('type');
				if($from_date!="" && $to_date!="")
				{
					$welcome_pickup_data =	$this->Qa_welcomepickup_model->qa_welcome_pickup_report_model($form_type,mmddyy2mysql($from_date),mmddyy2mysql($to_date));
				}
				$this->create_qa_welcome_pickup_CSV($welcome_pickup_data,$form_type);
				$dn_link = base_url()."reports_qa/download_qa_welcome_pickup_CSV/".$form_type;
			}
			$data["start_date"] = $from_date;
            $data["end_date"] = $to_date;
			$data['type'] = $form_type;
			$data['welcome_pickup_data'] =	$welcome_pickup_data;
			$data['download_link']=$dn_link;
			$this->load->view("dashboard",$data);
		}
	}
	/****************QA Welcome pickup CSV Generator*****************/
	public function create_qa_welcome_pickup_CSV($rr,$form_type)
	{
		if($form_type == 1)
			$type = "Ticket";
		elseif($form_type == 2)
			$type = "Call";
		$filename = "./qa_files/qa_reports_data/qa_welcome_pickup_report-".$type."-".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		if($form_type == 1)
		{
			$header = array("Auditor Name", "Audit Date","Audit Time","Agent Name","Ticket No","Order No","Caller Title","Caller Name","Caller Date","Audit Type","VOC","Overall Score","Greeting - Followed proper greeting","Realistic Acknowledgment - Provided appropriate responses and timely acknowledgment","Empathy - Used appropriate empathy statement","Comprehension - Understood the customers questions and answered it thoroughly","Probing - Made appropriate use of probing questions","Order Verification - Asked and verified at least one or two customers data points (email address or order no etc.)","Tools and Resources - Used all the resources available to determine the root cause of the problem/possible resolution and sought assistance from others as needed when unsure","Resolution and Processes/Guidelines - Used good judgment and decision making while resolving the issue conveyed every detail of the process clearly and accurately","Usage of Macro - Used the correct macro if there's one applicable and modified it appropriately","Ticket Status and Tagging- Used the correct ticket status and tagging","Documentation - Documented the necessary information during the email interaction if needed","Grammar - Used grammatically correct English","Look back and Learn - Proactive and offered additional assistance","Call Summary","Feedback","Form Type","Created On","Greeting - Followed proper greeting Comment","Realistic Acknowledgment - Provided appropriate responses and timely acknowledgment Comment","Empathy - Used appropriate empathy statement Comment","Comprehension - Understood the customers questions and answered it thoroughly Comment","Probing - Made appropriate use of probing questions Comment","Order Verification - Asked and verified at least one or two customers data points (email address or order no etc.) Comment","Tools and Resources - Used all the resources available to determine the root cause of the problem/possible resolution and sought assistance from others as needed when unsure Comment","Resolution and Processes/Guidelines - Used good judgment and decision making while resolving the issue conveyed every detail of the process clearly and accurately Comment","Usage of Macro - Used the correct macro if there's one applicable and modified it appropriately Comment","Ticket Status and Tagging- Used the correct ticket status and tagging Comment","Documentation - Documented the necessary information during the email interaction if needed Comment","Grammar - Used grammatically correct English Comment","Look back and Learn - Proactive and offered additional assistance Comment");
		}
		elseif($form_type == 2)
		{
			$header = array("Auditor Name", "Audit Date","Audit Time","Agent Name","Ticket No","Order No","Caller Title","Caller Name","Caller Date","Audit Type","VOC","Overall Score","Greeting - Followed proper greeting","Assistance - Offered sincere and immediate assistance and let the customer feel important","Pace - Adapted to caller's style and pace and put the customer at ease","Empathy - Used empathy statement in a timely manner","Active Listening - Actively listened to the customer and responded appropriately","Paraphrasing and Probing - Paraphrased the concern and made appropriate use of probing questions","Comprehension - Understand the customers' questions and answered it thoroughly","Order Verification - Asked and verified at least one or two customers' data points (email address or order no etc.)","Tools and Resources - Used all the resources available to determine the root cause of the problem/possible resolution and sought assistance from others as needed when unsure","Resolution and Processes/Guidelines - Used good judgment and decision making while resolving the issue conveyed every detail of the process clearly and accurately","Documentation - Documented the necessary information during the interaction if needed","GDPR Compliance - Delivered the GDPR Script onset of the call","Pronunciation and Right Verbiage - Spoke to the customer using correct English grammar","Look back and Learn - Proactive and offered additional assistance","Closing Spiel- Thanked the customer for calling","Call Summary","Feedback","Form Type","Created On","Greeting - Followed proper greeting Comment","Assistance - Offered sincere and immediate assistance and let the customer feel important Comment","Pace - Adapted to caller's style and pace and put the customer at ease Comment","Empathy - Used empathy statement in a timely manner Comment","Active Listening - Actively listened to the customer and responded appropriately Comment","Paraphrasing and Probing - Paraphrased the concern and made appropriate use of probing questions Comment","Comprehension - Understand the customers' questions and answered it thoroughly Comment","Order Verification - Asked and verified at least one or two customers data points (email address or order no etc.) Comment","Tools and Resources - Used all the resources available to determine the root cause of the problem/possible resolution and sought assistance from others as needed when unsure Comment","Resolution and Processes/Guidelines - Used good judgment and decision making while resolving the issue conveyed every detail of the process clearly and accurately Comment","Documentation - Documented the necessary information during the interaction if needed Comment","GDPR Compliance - Delivered the GDPR Script onset of the call Comment","Pronunciation and Right Verbiage - Spoke to the customer using correct English grammar Comment","Look back and Learn - Proactive and offered additional assistance Comment","Closing Spiel- Thanked the customer for calling Comment");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		if($form_type == 1)
		{
			foreach($rr as $rdata)
			{

				$row = '"'.$rdata['auditor_name'].'",';
				$row .= '"'.$rdata['audit_date'].'",';
				$row .= '"'.$rdata['audit_time'].'",';
				$row .= '"'.$rdata['agent_name'].'",';
				$row .= '"'.$rdata['ticket_no'].'",';
				$row .= '"'.$rdata['order_no'].'",';
				$row .= '"'.$rdata['caller_title'].'",';
				$row .= '"'.$rdata['caller_name'].'",';
				$row .= '"'.$rdata['caller_date'].'",';
				$row .= '"'.$rdata['audit_type'].'",';
				$row .= '"'.$rdata['voc'].'",';
				$row .= '"'.$rdata['overall_score'].'",';

				$row .= '"'.$rdata['approach_greeting_1'].'",';
				$row .= '"'.$rdata['approach_greeting_2'].'",';
				$row .= '"'.$rdata['approach_greeting_3'].'",';
				$row .= '"'.$rdata['discovery_1'].'",';
				$row .= '"'.$rdata['discovery_2'].'",';
				$row .= '"'.$rdata['verification'].'",';
				$row .= '"'.$rdata['process_1'].'",';
				$row .= '"'.$rdata['process_2'].'",';
				$row .= '"'.$rdata['process_3'].'",';
				$row .= '"'.$rdata['process_4'].'",';
				$row .= '"'.$rdata['process_5'].'",';
				$row .= '"'.$rdata['communication_1'].'",';
				$row .= '"'.$rdata['closing_1'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['feedback'])).'",';
				$row .= '"'.$form_type.'",';
				$row .= '"'.$rdata['entry_date'].'",';

				$row .= '"'.$rdata['approach_greeting_1_cmt'].'",';
				$row .= '"'.$rdata['approach_greeting_2_cmt'].'",';
				$row .= '"'.$rdata['approach_greeting_3_cmt'].'",';
				$row .= '"'.$rdata['discovery_1_cmt'].'",';
				$row .= '"'.$rdata['discovery_2_cmt'].'",';
				$row .= '"'.$rdata['verification_cmt'].'",';
				$row .= '"'.$rdata['process_1_cmt'].'",';
				$row .= '"'.$rdata['process_2_cmt'].'",';
				$row .= '"'.$rdata['process_3_cmt'].'",';
				$row .= '"'.$rdata['process_4_cmt'].'",';
				$row .= '"'.$rdata['process_5_cmt'].'",';
				$row .= '"'.$rdata['communication_1_cmt'].'",';
				$row .= '"'.$rdata['closing_1_cmt'].'"';

				fwrite($fopen,$row."\r\n");
			}

			fclose($fopen);
		}
		elseif($form_type == 2)
		{	foreach($rr as $rdata)
			{

				$row = '"'.$rdata['auditor_name'].'",';
				$row .= '"'.$rdata['audit_date'].'",';
				$row .= '"'.$rdata['audit_time'].'",';
				$row .= '"'.$rdata['agent_name'].'",';
				$row .= '"'.$rdata['ticket_no'].'",';
				$row .= '"'.$rdata['order_no'].'",';
				$row .= '"'.$rdata['caller_title'].'",';
				$row .= '"'.$rdata['caller_name'].'",';
				$row .= '"'.$rdata['caller_date'].'",';
				$row .= '"'.$rdata['audit_type'].'",';
				$row .= '"'.$rdata['voc'].'",';
				$row .= '"'.$rdata['overall_score'].'",';

				$row .= '"'.$rdata['approach_greeting_1'].'",';
				$row .= '"'.$rdata['approach_greeting_2'].'",';
				$row .= '"'.$rdata['approach_greeting_3'].'",';
				$row .= '"'.$rdata['approach_greeting_4'].'",';
				$row .= '"'.$rdata['discovery_1'].'",';
				$row .= '"'.$rdata['discovery_2'].'",';
				$row .= '"'.$rdata['discovery_3'].'",';
				$row .= '"'.$rdata['verification'].'",';
				$row .= '"'.$rdata['process_1'].'",';
				$row .= '"'.$rdata['process_2'].'",';
				$row .= '"'.$rdata['process_3'].'",';
				$row .= '"'.$rdata['process_4'].'",';
				$row .= '"'.$rdata['communication_1'].'",';
				$row .= '"'.$rdata['closing_1'].'",';
				$row .= '"'.$rdata['closing_2'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $rdata['feedback'])).'",';
				$row .= '"'.$form_type.'",';
				$row .= '"'.$rdata['entry_date'].'"';

				$row .= '"'.$rdata['approach_greeting_1_cmt'].'",';
				$row .= '"'.$rdata['approach_greeting_2_cmt'].'",';
				$row .= '"'.$rdata['approach_greeting_3_cmt'].'",';
				$row .= '"'.$rdata['approach_greeting_4_cmt'].'",';
				$row .= '"'.$rdata['discovery_1_cmt'].'",';
				$row .= '"'.$rdata['discovery_2_cmt'].'",';
				$row .= '"'.$rdata['discovery_3_cmt'].'",';
				$row .= '"'.$rdata['verification_cmt'].'",';
				$row .= '"'.$rdata['process_1_cmt'].'",';
				$row .= '"'.$rdata['process_2_cmt'].'",';
				$row .= '"'.$rdata['process_3_cmt'].'",';
				$row .= '"'.$rdata['process_4_cmt'].'",';
				$row .= '"'.$rdata['communication_1_cmt'].'",';
				$row .= '"'.$rdata['closing_1_cmt'].'",';
				$row .= '"'.$rdata['closing_2_cmt'].'",';

				fwrite($fopen,$row."\r\n");
			}

			fclose($fopen);
		}

	}
	public function download_qa_welcome_pickup_CSV($form_type)
	{
		if($form_type == 1)
			$type = "Ticket";
		elseif($form_type == 2)
			$type = "Call";
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/qa_welcome_pickup_report-".$type."-".get_user_id().".csv";
		$newfile="QA Welcome Pickup ".$type." List-".$currDate.".csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA VRS REPORT //////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_vrs_report(){
		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			/* $office_id = $this->input->get('office_id');
			if($office_id=="")  $office_id=$user_office_id; */


			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_vrs_report.php";


			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';

			/* $cValue = trim($this->input->post('client_id'));
			if($cValue=="") $cValue = trim($this->input->get('client_id')); */

			$pValue = trim($this->input->post('process_id'));
			if($pValue=="") $pValue = trim($this->input->get('process_id'));

			//$data['cValue']=$cValue;
			$data['pValue']=$pValue;



			$data["qa_vrs_list"] = array();
			$data["qa_vrs_cpta_data"] = array();

			if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			}else{
				$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			}


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				//$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				$field_array = array(
					"date_from"=>$date_from,
					"date_to" => $date_to,
					//"office_id" => $office_id,
					"process_id" => $pValue,
					"current_user" => $current_user
				);

				if($pValue=='Right Party'){

					$fullAray = $this->Qa_vrs_model->qa_vrs_report_model($field_array);
					$data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_rp_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vrs_rp_CSV";

				}else if($pValue=='Left Message'){

					$fullAray = $this->Qa_vrs_model->qa_vrs_report_model($field_array);
				    $data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_lm_CSV($fullAray);
					$dn_link = base_url()."qa_vrs/download_qa_vrs_lm_CSV";

				}else if($pValue=='Cavalry'){
					$fullAray = $this->Qa_vrs_model->qa_vrs_report_model($field_array);
					$data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_cav_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vrs_cav_CSV";

				}else if($pValue=='CPTA'){
					$fullAray = $this->Qa_vrs_model->qa_vrs_report_model($field_array);
					$data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_cpta_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vrs_cpta_CSV";
				///////////
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_vrs_cpta_feedback $cond1) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_vrs_cpta_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) order by audit_date";
					$fullAray1 = $this->Common_model->get_query_result_array($qSql);
					$data["qa_vrs_cpta_data"] = $fullAray1;
					$this->create_qa_vrs_cptaAll_CSV($fullAray1);
					$dn_link1 = base_url()."reports_qa/download_qa_vrs_cptaAll_CSV";

				}else if($pValue=='JRPA'){
					$fullAray = $this->Qa_vrs_model->qa_vrs_report_model($field_array);
					$data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_jrpa_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vrs_jrpa_CSV";

				}elseif($pValue=='Analysis'){
					$fullAray = $this->Qa_vrs_model->qa_vrs_report_model($field_array);
					$data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_rp_anslysis_right_party_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vrs_rp_analysis_CSV";

				}elseif($pValue=='VRS New'){
					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_vrs_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vrs_new_CSV";
				}elseif($pValue=='VRS Thirdparty'){
					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_vrs_thirdparty_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_vrs_list"] = $fullAray;
					$this->create_qa_vrs_thirdparty_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vrs_thirdparty_CSV";
				}
			}

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			//$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


//////////////////Right Party///////////////////
	public function download_qa_vrs_rp_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS RP Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_rp_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Phone", "Contact Date", "Contact Duration", "VSI Account", "ACPT", "ACPT Option", "ACPT Others", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Identify himself/herself by first and last name at the beginning of the call?", "Provide the Quality Assurance Statement verbatim", "State Vital Recovery Services with no deviation?", "Verify that he/she was speaking to a right party according to the client requirements?", "Verify two pieces of demographics information on an outbound call", "Provide the Mini Miranda disclosure verbatim?", "State the client name and the purpose of the communication?", "Sate/Ask for balance due?", "Ask about consumers employment status and POE Information?", "Ask about income sources?", "Ask if the consumer rents or owns his/her home?", "Ask if the consumer a valid checking account or credit/debit card?", "Ask for a reason for delinquence/intention to resolve the account?", "Negotiate in order with discussion of each option?", "Offer a balance over time?", "Offer a one payment lump sum settlement appropriately?", "Offer a 3 to 12 month settlement appropriately?", "Offer a payment plan with significant down payment?", "Offer a small good faith payment?", "Recoment an urgency payment as the first payment option?", "Advise of the payment processing fee before the payment was taken", "Attempt to negotiate the first payment within 10 days?", "Demonstrate Active Listening?", "Anticipate and overcome objections?", "Ask open ended questions when appropriate?", "Establish a sence of urgency?", "Set appropriate timelines and expectations for follow up?", "Keep the call on task?", "Represent the company and the client in a positive manner?", "Escalate the call to a supervisor upon the first request of a consumer?", "Misrepresent their identity or authorization?", "Threaten to take actions that VRS or the client cannot legally take?", "Misrepresent the status of the consumers account?", "Make any faulse representations regarding the nature of the communication?", "Contact the consumer at any unusual times (sate regulations) or outside the hours of 8:00 am and 9:00 pm at the consumers location?", "Communicate with the consumer at work if it is known or there is reason to know that such calls are prohibited?", "Communicate with the consumer after learning the consumer is represented by an attorney?", "Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers via cell?", "Adhere to policy regarding third parties for the sole purpose of obtaining location information for the consumer?", "Enter dialer disposition codes correctly to ensure that inappropriate dialing does not take place?", "Make any statement that could constitute unfair?", "Communicate or threaten to communicate false credit information or information which should be known to be false?", "Handle the consumer's dispute correctly and take appropriate action including providing the consumer with the correct contact information to submit?", "Obtain permission from the consumer to initiate electronic checking or credit /debit card transactions AND get supervisor verification if needed?", "Discuss or imply that any type of legal actions will be taken or property repossessed?", "Discuss legal action on time barred accounts?", "Make the required statement on time barred accounts", "Fully comply with any additional FDCPA requirements?", "Make any statement that could be considered discriminatory towards a consumer or a violation of VRS ECOA policy?", "Did the collectors adhere to the State Restrictions?", "Summarize the call?", "Restate the payment arrangement to the consumer?", "Educate the consumer about correspondence being sent?", "Close the call Professionally?", "Use the proper action code?", "Use the proper result code?", "Document thoroughly the context of the conversation?", "Remove any phone numbers known to be incorrect?", "Update address information if appropriate?", "Change the status of the account if appropriate?", "Escalate the account to a supervisor for handling?", "Opening Score", "Opening Possible Score", "Effort Score", "Effort Possible Score", "Call Control Score", "Call Control Possible Score", "Compliance Score", "Compliance Possible Score", "Closing Score", "Closing Possible Score", "Document Score", "Document Possible Score", "Overall Score", "Point Earned", "Call Summary", "Feedback", "Audit Time", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['opening_call']==10) $opening_call='Yes';
			else if($user['opening_call']==-10) $opening_call='No';
			else $opening_call='N/A';

			if($user['opening_verbatim']==10) $opening_verbatim='Yes';
			else if($user['opening_verbatim']==-10) $opening_verbatim='No';
			else $opening_verbatim='N/A';

			if($user['opening_vrs']==10) $opening_vrs='Yes';
			else if($user['opening_vrs']==-10) $opening_vrs='No';
			else $opening_vrs='N/A';

			if($user['opening_rightparty']==10) $opening_rightparty='Yes';
			else if($user['opening_rightparty']==0) $opening_rightparty='No';
			else $opening_rightparty='N/A';

			if($user['opening_demographics']==10) $opening_demographics='Yes';
			else if($user['opening_demographics']==0) $opening_demographics='No';
			else $opening_demographics='N/A';

			if($user['opening_miranda']==10) $opening_miranda='Yes';
			else if($user['opening_miranda']==-10) $opening_miranda='No';
			else $opening_miranda='N/A';

			if($user['opening_communication']==10) $opening_communication='Yes';
			else if($user['opening_communication']==0) $opening_communication='No';
			else $opening_communication='N/A';

			if($user['effort_balance']==10) $effort_balance='Yes';
			else if($user['effort_balance']==0) $effort_balance='No';
			else $effort_balance='N/A';

			if($user['effort_poe']==10) $effort_poe='Yes';
			else if($user['effort_poe']==0) $effort_poe='No';
			else $effort_poe='N/A';

			if($user['effort_income']==10) $effort_income='Yes';
			else if($user['effort_income']==0) $effort_income='No';
			else $effort_income='N/A';

			if($user['effort_rent']==10) $effort_rent='Yes';
			else if($user['effort_rent']==0) $effort_rent='No';
			else $effort_rent='N/A';

			if($user['effort_account']==10) $effort_account='Yes';
			else if($user['effort_account']==0) $effort_account='No';
			else $effort_account='N/A';

			if($user['effort_intension']==10) $effort_intension='Yes';
			else if($user['effort_intension']==0) $effort_intension='No';
			else $effort_intension='N/A';

			if($user['effort_payment']==10) $effort_payment='Yes';
			else if($user['effort_payment']==0) $effort_payment='No';
			else $effort_payment='N/A';

			if($user['effort_offer']==10) $effort_offer='Yes';
			else if($user['effort_offer']==0) $effort_offer='No';
			else $effort_offer='N/A';

			if($user['effort_lump']==10) $effort_lump='Yes';
			else if($user['effort_lump']==0) $effort_lump='No';
			else $effort_lump='N/A';

			if($user['effort_settlement']==10) $effort_settlement='Yes';
			else if($user['effort_settlement']==0) $effort_settlement='No';
			else $effort_settlement='N/A';

			if($user['effort_significant']==10) $effort_significant='Yes';
			else if($user['effort_significant']==0) $effort_significant='No';
			else $effort_significant='N/A';

			if($user['effort_good']==10) $effort_good='Yes';
			else if($user['effort_good']==0) $effort_good='No';
			else $effort_good='N/A';

			if($user['effort_recoment']==10) $effort_recoment='Yes';
			else if($user['effort_recoment']==0) $effort_recoment='No';
			else $effort_recoment='N/A';

			if($user['effort_advise']==10) $effort_advise='Yes';
			else if($user['effort_advise']==-10) $effort_advise='No';
			else $effort_advise='N/A';

			if($user['effort_negotiate']==10) $effort_negotiate='Yes';
			else if($user['effort_negotiate']==0) $effort_negotiate='No';
			else $effort_negotiate='N/A';

			if($user['callcontrol_demo']==10) $callcontrol_demo='Yes';
			else if($user['callcontrol_demo']==0) $callcontrol_demo='No';
			else $callcontrol_demo='N/A';

			if($user['callcontrol_anticipate']==10) $callcontrol_anticipate='Yes';
			else if($user['callcontrol_anticipate']==0) $callcontrol_anticipate='No';
			else $callcontrol_anticipate='N/A';

			if($user['callcontrol_question']==10) $callcontrol_question='Yes';
			else if($user['callcontrol_question']==0) $callcontrol_question='No';
			else $callcontrol_question='N/A';

			if($user['callcontrol_establist']==10) $callcontrol_establist='Yes';
			else if($user['callcontrol_establist']==0) $callcontrol_establist='No';
			else $callcontrol_establist='N/A';

			if($user['callcontrol_timelines']==10) $callcontrol_timelines='Yes';
			else if($user['callcontrol_timelines']==0) $callcontrol_timelines='No';
			else $callcontrol_timelines='N/A';

			if($user['callcontrol_task']==10) $callcontrol_task='Yes';
			else if($user['callcontrol_task']==0) $callcontrol_task='No';
			else $callcontrol_task='N/A';

			if($user['callcontrol_company']==10) $callcontrol_company='Yes';
			else if($user['callcontrol_company']==0) $callcontrol_company='No';
			else $callcontrol_company='N/A';

			if($user['callcontrol_escalate']==10) $callcontrol_escalate='Yes';
			else if($user['callcontrol_escalate']==0) $callcontrol_escalate='No';
			else $callcontrol_escalate='N/A';

			if($user['compliance_mispresent']==10) $compliance_mispresent='No';
			else if($user['compliance_mispresent']==-10) $compliance_mispresent='Yes';
			else $compliance_mispresent='N/A';

			if($user['compliance_threaten']==10) $compliance_threaten='No';
			else if($user['compliance_threaten']==-10) $compliance_threaten='Yes';
			else $compliance_threaten='N/A';

			if($user['compliance_account']==10) $compliance_account='No';
			else if($user['compliance_account']==-10) $compliance_account='Yes';
			else $compliance_account='N/A';

			if($user['compliance_faulse']==10) $compliance_faulse='No';
			else if($user['compliance_faulse']==-10) $compliance_faulse='Yes';
			else $compliance_faulse='N/A';

			if($user['compliance_contact']==10) $compliance_contact='No';
			else if($user['compliance_contact']==-10) $compliance_contact='Yes';
			else $compliance_contact='N/A';

			if($user['compliance_communicate']==10) $compliance_communicate='No';
			else if($user['compliance_contact']==-10) $compliance_communicate='Yes';
			else $compliance_communicate='N/A';

			if($user['compliance_consumer']==10) $compliance_consumer='No';
			else if($user['compliance_consumer']==-10) $compliance_consumer='Yes';
			else $compliance_consumer='N/A';

			if($user['compliance_policy']==10) $compliance_policy='No';
			else if($user['compliance_policy']==-10) $compliance_policy='Yes';
			else $compliance_policy='N/A';

			if($user['compliance_location']==10) $compliance_location='No';
			else if($user['compliance_location']==-10) $compliance_location='Yes';
			else $compliance_location='N/A';

			if($user['compliance_dialer']==10) $compliance_dialer='No';
			else if($user['compliance_dialer']==-10) $compliance_dialer='Yes';
			else $compliance_dialer='N/A';

			if($user['compliance_unfair']==10) $compliance_unfair='Yes';
			else if($user['compliance_unfair']==-10) $compliance_unfair='No';
			else $compliance_unfair='N/A';

			if($user['compliance_credit']==10) $compliance_credit='No';
			else if($user['compliance_credit']==-10) $compliance_credit='Yes';
			else $compliance_credit='N/A';

			if($user['compliance_disput']==10) $compliance_disput='Yes';
			else if($user['compliance_disput']==-10) $compliance_disput='No';
			else $compliance_disput='N/A';

			if($user['compliance_obtain']==10) $compliance_obtain='Yes';
			else if($user['compliance_obtain']==-10) $compliance_obtain='No';
			else $compliance_obtain='N/A';

			if($user['compliance_imply']==10) $compliance_imply='Yes';
			else if($user['compliance_imply']==-10) $compliance_imply='No';
			else $compliance_imply='N/A';

			if($user['compliance_legal']==10) $compliance_legal='Yes';
			else if($user['compliance_legal']==-10) $compliance_legal='No';
			else $compliance_legal='N/A';

			if($user['compliance_barred']==10) $compliance_barred='Yes';
			else if($user['compliance_barred']==-10) $compliance_barred='No';
			else $compliance_barred='N/A';

			if($user['compliance_fdcpa']==10) $compliance_fdcpa='Yes';
			else if($user['compliance_fdcpa']==-10) $compliance_fdcpa='No';
			else $compliance_fdcpa='N/A';

			if($user['compliance_consider']==10) $compliance_consider='No';
			else if($user['compliance_consider']==-10) $compliance_consider='Yes';
			else $compliance_consider='N/A';

			if($user['compliance_collector']==10) $compliance_collector='Yes';
			else if($user['compliance_collector']==-10) $compliance_collector='No';
			else $compliance_collector='N/A';

			if($user['closing_call']==10) $closing_call='Yes';
			else if($user['closing_call']==0) $closing_call='No';
			else $closing_call='N/A';

			if($user['closing_restate']==10) $closing_restate='Yes';
			else if($user['closing_restate']==0) $closing_restate='No';
			else $closing_restate='N/A';

			if($user['closing_educate']==10) $closing_educate='Yes';
			else if($user['closing_educate']==0) $closing_educate='No';
			else $closing_educate='N/A';

			if($user['closing_profession']==10) $closing_profession='Yes';
			else if($user['closing_profession']==0) $closing_profession='No';
			else $closing_profession='N/A';

			if($user['document_action']==10) $document_action='Yes';
			else if($user['document_action']==-10) $document_action='No';
			else $document_action='N/A';

			if($user['document_result']==10) $document_result='Yes';
			else if($user['document_result']==-10) $document_result='No';
			else $document_result='N/A';

			if($user['document_context']==10) $document_context='Yes';
			else if($user['document_context']==0) $document_context='No';
			else $document_context='N/A';

			if($user['document_remove']==10) $document_remove='Yes';
			else if($user['document_remove']==-10) $document_remove='No';
			else $document_remove='N/A';

			if($user['document_update']==10) $document_update='Yes';
			else if($user['document_update']==-10) $document_update='No';
			else $document_update='N/A';

			if($user['document_change']==10) $document_change='Yes';
			else if($user['document_change']==-10) $document_change='No';
			else $document_change='N/A';

			if($user['document_escalate']==10) $document_escalate='Yes';
			else if($user['document_escalate']==0) $document_escalate='No';
			else $document_escalate='N/A';


			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}


			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['contact_date'].'",';
			$row .= '"'.$user['contact_duration'].'",';
			$row .= '"'.$user['vsi_account'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['acpt_option'].'",';
			$row .= '"'.$user['acpt_other'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$opening_call.'",';
			$row .= '"'.$opening_verbatim.'",';
			$row .= '"'.$opening_vrs.'",';
			$row .= '"'.$opening_rightparty.'",';
			$row .= '"'.$opening_demographics.'",';
			$row .= '"'.$opening_miranda.'",';
			$row .= '"'.$opening_communication.'",';
			$row .= '"'.$effort_balance.'",';
			$row .= '"'.$effort_poe.'",';
			$row .= '"'.$effort_income.'",';
			$row .= '"'.$effort_rent.'",';
			$row .= '"'.$effort_account.'",';
			$row .= '"'.$effort_intension.'",';
			$row .= '"'.$effort_payment.'",';
			$row .= '"'.$effort_offer.'",';
			$row .= '"'.$effort_lump.'",';
			$row .= '"'.$effort_settlement.'",';
			$row .= '"'.$effort_significant.'",';
			$row .= '"'.$effort_good.'",';
			$row .= '"'.$effort_recoment.'",';
			$row .= '"'.$effort_advise.'",';
			$row .= '"'.$effort_negotiate.'",';
			$row .= '"'.$callcontrol_demo.'",';
			$row .= '"'.$callcontrol_anticipate.'",';
			$row .= '"'.$callcontrol_question.'",';
			$row .= '"'.$callcontrol_establist.'",';
			$row .= '"'.$callcontrol_timelines.'",';
			$row .= '"'.$callcontrol_task.'",';
			$row .= '"'.$callcontrol_company.'",';
			$row .= '"'.$callcontrol_escalate.'",';
			$row .= '"'.$compliance_mispresent.'",';
			$row .= '"'.$compliance_threaten.'",';
			$row .= '"'.$compliance_account.'",';
			$row .= '"'.$compliance_faulse.'",';
			$row .= '"'.$compliance_contact.'",';
			$row .= '"'.$compliance_communicate.'",';
			$row .= '"'.$compliance_consumer.'",';
			$row .= '"'.$compliance_policy.'",';
			$row .= '"'.$compliance_location.'",';
			$row .= '"'.$compliance_dialer.'",';
			$row .= '"'.$compliance_unfair.'",';
			$row .= '"'.$compliance_credit.'",';
			$row .= '"'.$compliance_disput.'",';
			$row .= '"'.$compliance_obtain.'",';
			$row .= '"'.$compliance_imply.'",';
			$row .= '"'.$compliance_legal.'",';
			$row .= '"'.$compliance_barred.'",';
			$row .= '"'.$compliance_fdcpa.'",';
			$row .= '"'.$compliance_consider.'",';
			$row .= '"'.$compliance_collector.'",';
			$row .= '"'.$closing_call.'",';
			$row .= '"'.$closing_restate.'",';
			$row .= '"'.$closing_educate.'",';
			$row .= '"'.$closing_profession.'",';
			$row .= '"'.$document_action.'",';
			$row .= '"'.$document_result.'",';
			$row .= '"'.$document_context.'",';
			$row .= '"'.$document_remove.'",';
			$row .= '"'.$document_update.'",';
			$row .= '"'.$document_change.'",';
			$row .= '"'.$document_escalate.'",';
			$row .= '"'.$user['opening_score'].'",';
			$row .= '"'.$user['opening_possible_scr'].'",';
			$row .= '"'.$user['effort_score'].'",';
			$row .= '"'.$user['effort_possible_scr'].'",';
			$row .= '"'.$user['callcontrol_score'].'",';
			$row .= '"'.$user['callcontrol_possible_scr'].'",';
			$row .= '"'.$user['compliance_score'].'",';
			$row .= '"'.$user['compliance_possible_scr'].'",';
			$row .= '"'.$user['closing_score'].'",';
			$row .= '"'.$user['closing_possible_scr'].'",';
			$row .= '"'.$user['document_score'].'",';
			$row .= '"'.$user['document_possible_scr'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['point_earned'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['entry_time'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/////////////////// VRS NEW /////////////////////
	public function download_qa_vrs_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Phone", "Fusion ID", "Agent Name", "L1 Super", "Client Name", "Contact Date", "Contact Duration", "VSI Account", "ACPT", "ACPT Option", "ACPT Others", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "QA Type", "Call ID", "Overall Score", "Identify himself/herself by first and last name at the beginning of the call?", "Provide the Quality Assurance Statement verbatim before any specific account information was discussed?", "State VRS with no deviation?", "Verify that he/she was speaking to a right party according to the client requirements?", "Verify one/two pieces of demographics information on an outbound call and one/two pieces on an inbound call? 1) must abide by client requirements 2) Must be completed before disclosures 3) Exception on consumer fail to verify two pieces of demographics information/fail to verify complete address (missing street number etc). ** Exception for GMF - Collector must receive information from Consumer avoiding proactive verification. ", "Provide the Mini Miranda disclosure verbatim before any specific account information was discussed?", "State the client name and the purpose of the communication?","Did the rep ask for callback permission as per Reg F policy?","Sate/Ask for balance due?", "Ask for a reason for delinquency/intention to resolve the account?", "Full and Complete information taken?", "Ask for the payment over the phone?", "Ask for a post dated payment?", "Followed the previous conversations on the account for the follow-up call", "Able to take a promise to pay on the account?", "Offer to split the balance in part?", "Offer a one/three/lump sum settlement appropriately?", "Offer a payment plan with significant down payment?", "Did Collector follow proper negotiation sequence to provide settelment options?", "Did Collector try to negotiate effectively to convince the customer for payment?", "Offer a small good faith payment?", "Did not Misrepresent their identity or authorization and status of the consumers account?", "Did not Discuss or imply that any type of legal actions - will be taken or property repossessed?", "Did not Make any false representations regarding the nature of the communication?", "Did not Contact the consumer at any unusual times?", "Did not Communicate with the consumer at work if it is known or there is reason to know that such calls are prohibited?", "Did not Communicate with the consumer after learning the consumer is represented by an attorney?", "Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers via cell phone email and fax?", "Adhere to policy regarding third parties for the sole purpose of obtaining location information for the consumer?", "Enter Status code/disposition codes correctly to ensure that inappropriate dialing does not take place?", "Did not Make any statement that could constitute unfair deceptive or abusive acts?", "Did not Communicate or threaten to communicate false credit information or information which should be known to be false?", "Handle the consumers dispute correctly and take appropriate action", "Did not Make the required statement on time barred accounts?", "Adhere to FDCPA laws?", "Did not Make any statement that could be considered discriminatory towards a consumer?", "Did the collectors adhere to the State Restrictions?", "Confirm with consumer if he/she is the authorized user of the debit or credit card/checking account?", "Recap the call by verifying consumers Name Address CC/AP information?", "Stated the proper payment script before processing payment?", "Advise of the payment processing fee before the payment was taken?", "Obtain permission from the consumer to initiate electronic credit /debit card transactions?", "Educate the consumer about correspondence being sent?", "Provide the consumer with the confirmation code?", "Demonstrate Active Listening?", "Represent the company and the client in a positive manner?", "Anticipate and overcome objections?", "Summarize the call?", "Provided VRS call back number?", "Set appropriate timelines and expectations for follow up?", "Close the call Professionally?", "Use the proper action code?", "Use the proper result code?", "Document thoroughly the context of the conversation?", "Remove any phone numbers known to be incorrect?", "Update address information if appropriate?", "Change the status of the account if appropriate?", "Escalate the account to a supervisor for handling if appropriate?","Did the Collector update Consumer on payment reminder BIF / SIF Letters?", "In case of PDCs did the Collector asks for permission to call the Consumer back if it is declined or there is an issue with the payment?", "Did the Collector ask for permission to call Consumers back if they do not hear from the Consumers by that specific date and time for PTPs?","Did the rep document the callback permission on the account as per Reg F policy?","Opening Score", "Effort Score","Negotiation Score", "Compliance Score", "Payment Script Score", "Call Control Score", "Closing Score", "Documentation Score", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['c_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['vsi_account'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['acpt_option'].'",';
			$row .= '"'.$user['acpt_other'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['qa_type'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['identifynameatbeginning'].'",';
			$row .= '"'.$user['assurancetsatementverbatim'].'",';
			$row .= '"'.$user['VRSwithnodeviation'].'",';
			$row .= '"'.$user['speakingtorightparty'].'",';
			$row .= '"'.$user['demographicsinformation'].'",';
			$row .= '"'.$user['minimirandadisclosure'].'",';
			$row .= '"'.$user['statetheclientname'].'",';
			$row .= '"'.$user['for_callback_permission'].'",';
			$row .= '"'.$user['askforbalancedue'].'",';
			$row .= '"'.$user['reasonfordelinquency'].'",';
			$row .= '"'.$user['completeinformationtaken'].'",';
			$row .= '"'.$user['askforpaymentonphone'].'",';
			$row .= '"'.$user['askforpostdelaypayment'].'",';
			$row .= '"'.$user['accountforfollowupcall'].'",';
			$row .= '"'.$user['promisetopayaccount'].'",';
			$row .= '"'.$user['splitbalanceinpart'].'",';
			$row .= '"'.$user['offersumsettlement'].'",';
			$row .= '"'.$user['paymentplanwithpayment'].'",';
			$row .= '"'.$user['collectorfollowpropernegotiation'].'",';
			$row .= '"'.$user['collectortrynegotiatepayment'].'",';
			$row .= '"'.$user['offergoodfaithpayment'].'",';
			$row .= '"'.$user['misrepresentidentity'].'",';
			$row .= '"'.$user['discussoflegalaction'].'",';
			$row .= '"'.$user['makeanyfalserepresentation'].'",';
			$row .= '"'.$user['contactcustomerusualtime'].'",';
			$row .= '"'.$user['communicateconsumeratwork'].'",';
			$row .= '"'.$user['communicateconsumeranattorney'].'",';
			$row .= '"'.$user['adheretocellphonepolicy'].'",';
			$row .= '"'.$user['adhereto3rdpartypolicy'].'",';
			$row .= '"'.$user['enterstatuscodecorrectly'].'",';
			$row .= '"'.$user['raiseUDAAPconcerns'].'",';
			$row .= '"'.$user['communicatefalsecreditinformation'].'",';
			$row .= '"'.$user['handleconsumerdispute'].'",';
			$row .= '"'.$user['maketimebarredaccounts'].'",';
			$row .= '"'.$user['adhereFDCPAlaws'].'",';
			$row .= '"'.$user['discriminatoryECOApolicy'].'",';
			$row .= '"'.$user['adherestaterestriction'].'",';
			$row .= '"'.$user['confirmauthoriseduser'].'",';
			$row .= '"'.$user['recapthecallverify'].'",';
			$row .= '"'.$user['properpaymentscript'].'",';
			$row .= '"'.$user['paymentprocessingfee'].'",';
			$row .= '"'.$user['obtainpermissionfromconsumer'].'",';
			$row .= '"'.$user['educatetheconsumer'].'",';
			$row .= '"'.$user['consumerconfirmationcode'].'",';
			$row .= '"'.$user['demonstrateactivelistening'].'",';
			$row .= '"'.$user['representclientandcompany'].'",';
			$row .= '"'.$user['anticipateovercomeobjection'].'",';
			$row .= '"'.$user['summarizethecall'].'",';
			$row .= '"'.$user['provideVRScallbacknumber'].'",';
			$row .= '"'.$user['setappropiatetimeline'].'",';
			$row .= '"'.$user['closecallprofessionally'].'",';
			$row .= '"'.$user['useproperactioncode'].'",';
			$row .= '"'.$user['useproperresultcode'].'",';
			$row .= '"'.$user['contextoftheconversation'].'",';
			$row .= '"'.$user['removeanyphonenumber'].'",';
			$row .= '"'.$user['updateaddressinformation'].'",';
			$row .= '"'.$user['changestateofAccount'].'",';
			$row .= '"'.$user['superviserforhandle'].'",';
			$row .= '"'.$user['update_consumer_on_payment'].'",';
			$row .= '"'.$user['in_case_of_pdcs'].'",';
			$row .= '"'.$user['collector_ask_for_permission'].'",';
			$row .= '"'.$user['document_the_callback'].'",';
			$row .= '"'.$user['openingscore'].'",';
			$row .= '"'.$user['effortscore'].'",';
			$row .= '"'.$user['negotiationscore'].'",';
			$row .= '"'.$user['compliancescore'].'",';
			$row .= '"'.$user['paymentscriptscore'].'",';
			$row .= '"'.$user['callcontrolscore'].'",';
			$row .= '"'.$user['closingscore'].'",';
			$row .= '"'.$user['documentationscore'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/////////////////// VRS Third Party /////////////////////
	public function download_qa_vrs_thirdparty_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS Third Party Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_thirdparty_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Phone", "Contact Date", "Contact Duration", "VSI Account", "QA Type", "Call ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the Collector identify themselves?", "Did the Quality Assurance Statement given on call?", "Did the Collector confirm that he/she is speaking with a Third Party?", "Did the Collector state Vital Recovery Services proactively on the call?", "Did the Collector provide any account related information to the Third Party or state on call regarding Consumer owes a Debt?", "Did the Collector confirm any location information", "Did the Collector Left Zortman Message with the Third Party?", "In case the Third Party wanted to make any payment did the collector disclose any account information?", "Did the collector follow payment processing script before processing the payment?", "Did the Collector make any statement that could constitute unfair?", "Enter Status code/disposition codes correctly to ensure that inappropriate dialing does not take place?", "Did not Contact the consumer at any unusual times?", "Did not discuss or imply that any type of legal actions will be taken also did not threaten to take actions that VRS or the client cannot legally take?", "Did not Misrepresent their identity or authorization as well as did not make any false representations?", "Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers?", "Adhere to FDCPA laws?", "Did not Make any statement that could be considered discriminatory towards a consumer?", "Did the collectors adhere to the State Restrictions?", "Did proper action code notated on the account?", "Did proper result code notated on the account?", "Did proper documentation done on the account?", "Did the Collector remove any phone numbers known to be incorrect?", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['vsi_account'].'",';
			$row .= '"'.$user['qa_type'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['collector_indentify_themselve'].'",';
			$row .= '"'.$user['quality_assurance_on_call'].'",';
			$row .= '"'.$user['collector_confirm_speaking_thirdparty'].'",';
			$row .= '"'.$user['collector_state_VRS_proactively'].'",';
			$row .= '"'.$user['collector_provide_account_info'].'",';
			$row .= '"'.$user['collector_confirm_location_info'].'",';
			$row .= '"'.$user['collector_left_zortman_message'].'",';
			$row .= '"'.$user['thirdparty_make_payment'].'",';
			$row .= '"'.$user['payment_made_on_account'].'",';
			$row .= '"'.$user['constitude_unfair_deceptive'].'",';
			$row .= '"'.$user['enter_state_code_correctly'].'",';
			$row .= '"'.$user['contact_customer_unusual_time'].'",';
			$row .= '"'.$user['discuss_legal_action'].'",';
			$row .= '"'.$user['misrepresent_identity'].'",';
			$row .= '"'.$user['adhere_cell_phone_policy'].'",';
			$row .= '"'.$user['adhere_FDCPA_law'].'",';
			$row .= '"'.$user['consider_customer_discriminatory'].'",';
			$row .= '"'.$user['adhere_state_restriction'].'",';
			$row .= '"'.$user['proper_action_code_noted'].'",';
			$row .= '"'.$user['proper_result_code_noted'].'",';
			$row .= '"'.$user['proper_documentation_done'].'",';
			$row .= '"'.$user['collector_remove_incorrect_number'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}

////////////////////////////////////////////////////////////////////////////////////////////////////
// VRS RP ANALYSIS RIGHT PARTY //////////////////////////////////////////////////////

	//////////////////Right Party///////////////////
	public function download_qa_vrs_rp_analysis_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS RP Analysis Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_rp_anslysis_right_party_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Phone", "Contact Date", "Contact Duration", "VSI Account", "ACPT", "ACPT Option", "ACPT Others", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Identify himself/herself by first and last name at the beginning of the call?", "Provide the Quality Assurance Statement verbatim", "State Vital Recovery Services with no deviation?", "Verify that he/she was speaking to a right party according to the client requirements?", "Verify two pieces of demographics information on an outbound call", "Provide the Mini Miranda disclosure verbatim?", "State the client name and the purpose of the communication?", "Sate/Ask for balance due?", "Ask about consumers employment status and POE Information?", "Ask about income sources?", "Ask if the consumer rents or owns his/her home?", "Ask if the consumer a valid checking account or credit/debit card?", "Ask for a reason for delinquence/intention to resolve the account?", "Negotiate in order with discussion of each option?", "Offer a balance over time?", "Offer a one payment lump sum settlement appropriately?", "Offer a 3 to 12 month settlement appropriately?", "Offer a payment plan with significant down payment?", "Offer a small good faith payment?", "Recoment an urgency payment as the first payment option?", "Advise of the payment processing fee before the payment was taken", "Attempt to negotiate the first payment within 10 days?", "Demonstrate Active Listening?", "Anticipate and overcome objections?", "Ask open ended questions when appropriate?", "Establish a sence of urgency?", "Set appropriate timelines and expectations for follow up?", "Keep the call on task?", "Represent the company and the client in a positive manner?", "Escalate the call to a supervisor upon the first request of a consumer?", "Misrepresent their identity or authorization?", "Threaten to take actions that VRS or the client cannot legally take?", "Misrepresent the status of the consumers account?", "Make any faulse representations regarding the nature of the communication?", "Contact the consumer at any unusual times (sate regulations) or outside the hours of 8:00 am and 9:00 pm at the consumers location?", "Communicate with the consumer at work if it is known or there is reason to know that such calls are prohibited?", "Communicate with the consumer after learning the consumer is represented by an attorney?", "Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers via cell?", "Adhere to policy regarding third parties for the sole purpose of obtaining location information for the consumer?", "Enter dialer disposition codes correctly to ensure that inappropriate dialing does not take place?", "Make any statement that could constitute unfair?", "Communicate or threaten to communicate false credit information or information which should be known to be false?", "Handle the consumer's dispute correctly and take appropriate action including providing the consumer with the correct contact information to submit?", "Obtain permission from the consumer to initiate electronic checking or credit /debit card transactions AND get supervisor verification if needed?", "Discuss or imply that any type of legal actions will be taken or property repossessed?", "Discuss legal action on time barred accounts?", "Make the required statement on time barred accounts", "Fully comply with any additional FDCPA requirements?", "Make any statement that could be considered discriminatory towards a consumer or a violation of VRS ECOA policy?", "Did the collectors adhere to the State Restrictions?", "Summarize the call?", "Restate the payment arrangement to the consumer?", "Educate the consumer about correspondence being sent?", "Close the call Professionally?", "Use the proper action code?", "Use the proper result code?", "Document thoroughly the context of the conversation?", "Remove any phone numbers known to be incorrect?", "Update address information if appropriate?", "Change the status of the account if appropriate?", "Escalate the account to a supervisor for handling?", "Opening Score", "Opening Possible Score", "Effort Score", "Effort Possible Score", "Call Control Score", "Call Control Possible Score", "Compliance Score", "Compliance Possible Score", "Closing Score", "Closing Possible Score", "Document Score", "Document Possible Score", "Overall Score", "Point Earned", "Call Summary", "Feedback", "Audit Time", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['opening_call']==10) $opening_call='Yes';
			else if($user['opening_call']==-10) $opening_call='No';
			else $opening_call='N/A';

			if($user['opening_verbatim']==10) $opening_verbatim='Yes';
			else if($user['opening_verbatim']==-10) $opening_verbatim='No';
			else $opening_verbatim='N/A';

			if($user['opening_vrs']==10) $opening_vrs='Yes';
			else if($user['opening_vrs']==-10) $opening_vrs='No';
			else $opening_vrs='N/A';

			if($user['opening_rightparty']==10) $opening_rightparty='Yes';
			else if($user['opening_rightparty']==0) $opening_rightparty='No';
			else $opening_rightparty='N/A';

			if($user['opening_demographics']==10) $opening_demographics='Yes';
			else if($user['opening_demographics']==0) $opening_demographics='No';
			else $opening_demographics='N/A';

			if($user['opening_miranda']==10) $opening_miranda='Yes';
			else if($user['opening_miranda']==-10) $opening_miranda='No';
			else $opening_miranda='N/A';

			if($user['opening_communication']==10) $opening_communication='Yes';
			else if($user['opening_communication']==0) $opening_communication='No';
			else $opening_communication='N/A';

			if($user['effort_balance']==10) $effort_balance='Yes';
			else if($user['effort_balance']==0) $effort_balance='No';
			else $effort_balance='N/A';

			if($user['effort_poe']==10) $effort_poe='Yes';
			else if($user['effort_poe']==0) $effort_poe='No';
			else $effort_poe='N/A';

			if($user['effort_income']==10) $effort_income='Yes';
			else if($user['effort_income']==0) $effort_income='No';
			else $effort_income='N/A';

			if($user['effort_rent']==10) $effort_rent='Yes';
			else if($user['effort_rent']==0) $effort_rent='No';
			else $effort_rent='N/A';

			if($user['effort_account']==10) $effort_account='Yes';
			else if($user['effort_account']==0) $effort_account='No';
			else $effort_account='N/A';

			if($user['effort_intension']==10) $effort_intension='Yes';
			else if($user['effort_intension']==0) $effort_intension='No';
			else $effort_intension='N/A';

			if($user['effort_payment']==10) $effort_payment='Yes';
			else if($user['effort_payment']==0) $effort_payment='No';
			else $effort_payment='N/A';

			if($user['effort_offer']==10) $effort_offer='Yes';
			else if($user['effort_offer']==0) $effort_offer='No';
			else $effort_offer='N/A';

			if($user['effort_lump']==10) $effort_lump='Yes';
			else if($user['effort_lump']==0) $effort_lump='No';
			else $effort_lump='N/A';

			if($user['effort_settlement']==10) $effort_settlement='Yes';
			else if($user['effort_settlement']==0) $effort_settlement='No';
			else $effort_settlement='N/A';

			if($user['effort_significant']==10) $effort_significant='Yes';
			else if($user['effort_significant']==0) $effort_significant='No';
			else $effort_significant='N/A';

			if($user['effort_good']==10) $effort_good='Yes';
			else if($user['effort_good']==0) $effort_good='No';
			else $effort_good='N/A';

			if($user['effort_recoment']==10) $effort_recoment='Yes';
			else if($user['effort_recoment']==0) $effort_recoment='No';
			else $effort_recoment='N/A';

			if($user['effort_advise']==10) $effort_advise='Yes';
			else if($user['effort_advise']==-10) $effort_advise='No';
			else $effort_advise='N/A';

			if($user['effort_negotiate']==10) $effort_negotiate='Yes';
			else if($user['effort_negotiate']==0) $effort_negotiate='No';
			else $effort_negotiate='N/A';

			if($user['callcontrol_demo']==10) $callcontrol_demo='Yes';
			else if($user['callcontrol_demo']==0) $callcontrol_demo='No';
			else $callcontrol_demo='N/A';

			if($user['callcontrol_anticipate']==10) $callcontrol_anticipate='Yes';
			else if($user['callcontrol_anticipate']==0) $callcontrol_anticipate='No';
			else $callcontrol_anticipate='N/A';

			if($user['callcontrol_question']==10) $callcontrol_question='Yes';
			else if($user['callcontrol_question']==0) $callcontrol_question='No';
			else $callcontrol_question='N/A';

			if($user['callcontrol_establist']==10) $callcontrol_establist='Yes';
			else if($user['callcontrol_establist']==0) $callcontrol_establist='No';
			else $callcontrol_establist='N/A';

			if($user['callcontrol_timelines']==10) $callcontrol_timelines='Yes';
			else if($user['callcontrol_timelines']==0) $callcontrol_timelines='No';
			else $callcontrol_timelines='N/A';

			if($user['callcontrol_task']==10) $callcontrol_task='Yes';
			else if($user['callcontrol_task']==0) $callcontrol_task='No';
			else $callcontrol_task='N/A';

			if($user['callcontrol_company']==10) $callcontrol_company='Yes';
			else if($user['callcontrol_company']==0) $callcontrol_company='No';
			else $callcontrol_company='N/A';

			if($user['callcontrol_escalate']==10) $callcontrol_escalate='Yes';
			else if($user['callcontrol_escalate']==0) $callcontrol_escalate='No';
			else $callcontrol_escalate='N/A';

			if($user['compliance_mispresent']==10) $compliance_mispresent='No';
			else if($user['compliance_mispresent']==-10) $compliance_mispresent='Yes';
			else $compliance_mispresent='N/A';

			if($user['compliance_threaten']==10) $compliance_threaten='No';
			else if($user['compliance_threaten']==-10) $compliance_threaten='Yes';
			else $compliance_threaten='N/A';

			if($user['compliance_account']==10) $compliance_account='No';
			else if($user['compliance_account']==-10) $compliance_account='Yes';
			else $compliance_account='N/A';

			if($user['compliance_faulse']==10) $compliance_faulse='No';
			else if($user['compliance_faulse']==-10) $compliance_faulse='Yes';
			else $compliance_faulse='N/A';

			if($user['compliance_contact']==10) $compliance_contact='No';
			else if($user['compliance_contact']==-10) $compliance_contact='Yes';
			else $compliance_contact='N/A';

			if($user['compliance_communicate']==10) $compliance_communicate='No';
			else if($user['compliance_contact']==-10) $compliance_communicate='Yes';
			else $compliance_communicate='N/A';

			if($user['compliance_consumer']==10) $compliance_consumer='No';
			else if($user['compliance_consumer']==-10) $compliance_consumer='Yes';
			else $compliance_consumer='N/A';

			if($user['compliance_policy']==10) $compliance_policy='No';
			else if($user['compliance_policy']==-10) $compliance_policy='Yes';
			else $compliance_policy='N/A';

			if($user['compliance_location']==10) $compliance_location='No';
			else if($user['compliance_location']==-10) $compliance_location='Yes';
			else $compliance_location='N/A';

			if($user['compliance_dialer']==10) $compliance_dialer='No';
			else if($user['compliance_dialer']==-10) $compliance_dialer='Yes';
			else $compliance_dialer='N/A';

			if($user['compliance_unfair']==10) $compliance_unfair='Yes';
			else if($user['compliance_unfair']==-10) $compliance_unfair='No';
			else $compliance_unfair='N/A';

			if($user['compliance_credit']==10) $compliance_credit='No';
			else if($user['compliance_credit']==-10) $compliance_credit='Yes';
			else $compliance_credit='N/A';

			if($user['compliance_disput']==10) $compliance_disput='Yes';
			else if($user['compliance_disput']==-10) $compliance_disput='No';
			else $compliance_disput='N/A';

			if($user['compliance_obtain']==10) $compliance_obtain='Yes';
			else if($user['compliance_obtain']==-10) $compliance_obtain='No';
			else $compliance_obtain='N/A';

			if($user['compliance_imply']==10) $compliance_imply='Yes';
			else if($user['compliance_imply']==-10) $compliance_imply='No';
			else $compliance_imply='N/A';

			if($user['compliance_legal']==10) $compliance_legal='Yes';
			else if($user['compliance_legal']==-10) $compliance_legal='No';
			else $compliance_legal='N/A';

			if($user['compliance_barred']==10) $compliance_barred='Yes';
			else if($user['compliance_barred']==-10) $compliance_barred='No';
			else $compliance_barred='N/A';

			if($user['compliance_fdcpa']==10) $compliance_fdcpa='Yes';
			else if($user['compliance_fdcpa']==-10) $compliance_fdcpa='No';
			else $compliance_fdcpa='N/A';

			if($user['compliance_consider']==10) $compliance_consider='No';
			else if($user['compliance_consider']==-10) $compliance_consider='Yes';
			else $compliance_consider='N/A';

			if($user['compliance_collector']==10) $compliance_collector='Yes';
			else if($user['compliance_collector']==-10) $compliance_collector='No';
			else $compliance_collector='N/A';

			if($user['closing_call']==10) $closing_call='Yes';
			else if($user['closing_call']==0) $closing_call='No';
			else $closing_call='N/A';

			if($user['closing_restate']==10) $closing_restate='Yes';
			else if($user['closing_restate']==0) $closing_restate='No';
			else $closing_restate='N/A';

			if($user['closing_educate']==10) $closing_educate='Yes';
			else if($user['closing_educate']==0) $closing_educate='No';
			else $closing_educate='N/A';

			if($user['closing_profession']==10) $closing_profession='Yes';
			else if($user['closing_profession']==0) $closing_profession='No';
			else $closing_profession='N/A';

			if($user['document_action']==10) $document_action='Yes';
			else if($user['document_action']==-10) $document_action='No';
			else $document_action='N/A';

			if($user['document_result']==10) $document_result='Yes';
			else if($user['document_result']==-10) $document_result='No';
			else $document_result='N/A';

			if($user['document_context']==10) $document_context='Yes';
			else if($user['document_context']==0) $document_context='No';
			else $document_context='N/A';

			if($user['document_remove']==10) $document_remove='Yes';
			else if($user['document_remove']==-10) $document_remove='No';
			else $document_remove='N/A';

			if($user['document_update']==10) $document_update='Yes';
			else if($user['document_update']==-10) $document_update='No';
			else $document_update='N/A';

			if($user['document_change']==10) $document_change='Yes';
			else if($user['document_change']==-10) $document_change='No';
			else $document_change='N/A';

			if($user['document_escalate']==10) $document_escalate='Yes';
			else if($user['document_escalate']==0) $document_escalate='No';
			else $document_escalate='N/A';


			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['contact_date'].'",';
			$row .= '"'.$user['contact_duration'].'",';
			$row .= '"'.$user['vsi_account'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['acpt_option'].'",';
			$row .= '"'.$user['acpt_other'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$opening_call.'",';
			$row .= '"'.$opening_verbatim.'",';
			$row .= '"'.$opening_vrs.'",';
			$row .= '"'.$opening_rightparty.'",';
			$row .= '"'.$opening_demographics.'",';
			$row .= '"'.$opening_miranda.'",';
			$row .= '"'.$opening_communication.'",';
			$row .= '"'.$effort_balance.'",';
			$row .= '"'.$effort_poe.'",';
			$row .= '"'.$effort_income.'",';
			$row .= '"'.$effort_rent.'",';
			$row .= '"'.$effort_account.'",';
			$row .= '"'.$effort_intension.'",';
			$row .= '"'.$effort_payment.'",';
			$row .= '"'.$effort_offer.'",';
			$row .= '"'.$effort_lump.'",';
			$row .= '"'.$effort_settlement.'",';
			$row .= '"'.$effort_significant.'",';
			$row .= '"'.$effort_good.'",';
			$row .= '"'.$effort_recoment.'",';
			$row .= '"'.$effort_advise.'",';
			$row .= '"'.$effort_negotiate.'",';
			$row .= '"'.$callcontrol_demo.'",';
			$row .= '"'.$callcontrol_anticipate.'",';
			$row .= '"'.$callcontrol_question.'",';
			$row .= '"'.$callcontrol_establist.'",';
			$row .= '"'.$callcontrol_timelines.'",';
			$row .= '"'.$callcontrol_task.'",';
			$row .= '"'.$callcontrol_company.'",';
			$row .= '"'.$callcontrol_escalate.'",';
			$row .= '"'.$compliance_mispresent.'",';
			$row .= '"'.$compliance_threaten.'",';
			$row .= '"'.$compliance_account.'",';
			$row .= '"'.$compliance_faulse.'",';
			$row .= '"'.$compliance_contact.'",';
			$row .= '"'.$compliance_communicate.'",';
			$row .= '"'.$compliance_consumer.'",';
			$row .= '"'.$compliance_policy.'",';
			$row .= '"'.$compliance_location.'",';
			$row .= '"'.$compliance_dialer.'",';
			$row .= '"'.$compliance_unfair.'",';
			$row .= '"'.$compliance_credit.'",';
			$row .= '"'.$compliance_disput.'",';
			$row .= '"'.$compliance_obtain.'",';
			$row .= '"'.$compliance_imply.'",';
			$row .= '"'.$compliance_legal.'",';
			$row .= '"'.$compliance_barred.'",';
			$row .= '"'.$compliance_fdcpa.'",';
			$row .= '"'.$compliance_consider.'",';
			$row .= '"'.$compliance_collector.'",';
			$row .= '"'.$closing_call.'",';
			$row .= '"'.$closing_restate.'",';
			$row .= '"'.$closing_educate.'",';
			$row .= '"'.$closing_profession.'",';
			$row .= '"'.$document_action.'",';
			$row .= '"'.$document_result.'",';
			$row .= '"'.$document_context.'",';
			$row .= '"'.$document_remove.'",';
			$row .= '"'.$document_update.'",';
			$row .= '"'.$document_change.'",';
			$row .= '"'.$document_escalate.'",';
			$row .= '"'.$user['opening_score'].'",';
			$row .= '"'.$user['opening_possible_scr'].'",';
			$row .= '"'.$user['effort_score'].'",';
			$row .= '"'.$user['effort_possible_scr'].'",';
			$row .= '"'.$user['callcontrol_score'].'",';
			$row .= '"'.$user['callcontrol_possible_scr'].'",';
			$row .= '"'.$user['compliance_score'].'",';
			$row .= '"'.$user['compliance_possible_scr'].'",';
			$row .= '"'.$user['closing_score'].'",';
			$row .= '"'.$user['closing_possible_scr'].'",';
			$row .= '"'.$user['document_score'].'",';
			$row .= '"'.$user['document_possible_scr'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['point_earned'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


//////////////////VRS Left Message///////////////////
	public function download_qa_vrs_lm_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS LM Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_lm_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Contact Date", "Contact Duration", "Client Name", "Phone", "VRS Account", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Overall Score", "Did the collector greet and open the call properly?", "Did the collector state his/her full name (first and last name) on the call?", "Did the collector state Vital recovery Services LLC with no deviation?", "Did the collector state the time [Eastern Time] of the call correctly?", "Did the collector state the date of the call correctly? ", "Did the collector state any of our customer service representatives correctly?", "Did the collector provided the call back number of the Consumer? ", "Did the collector advise of the office working hours as per eastern time correctly? ", "Did the collector left message with a Third Party?", "Did the collector left message at the POE of Consumer? ", "Did the collector Leave Message if voicemail has someone else name in it?", "Enter Status code/disposition codes correctly to ensure that inappropriate dialing does not take place? ", "Did collector use the proper Action Code? ","Did collector use the proper Result Code? ", "Did Collector document the account thoroughly?", "Call Summary", "Feedback", "Agent Review Date", "Agent Review Notes", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['client'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['vrs_account'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['open_the_call_properly'].'",';
			$row .= '"'.$user['her_full_name'].'",';
			$row .= '"'.$user['vital_recovery_services'].'",';
			$row .= '"'.$user['the_call_correctly'].'",';
			$row .= '"'.$user['date_the_call_correctly'].'",';
			$row .= '"'.$user['customer_service_representatives'].'",';
			$row .= '"'.$user['all_back_number_of'].'",';
			$row .= '"'.$user['working_hours_as_per'].'",';
			$row .= '"'.$user['left_message_with'].'",';
			$row .= '"'.$user['the_poe_of_consumer'].'",';
			$row .= '"'.$user['voicemail_has_someone'].'",';
			$row .= '"'.$user['inappropriate_dialing'].'",';
			$row .= '"'.$user['proper_action_code'].'",';
			$row .= '"'.$user['proper_result_code'].'",';
			$row .= '"'.$user['account_thoroughly'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

//////////////////VRS Cavalry///////////////////////////////////////////
	public function download_qa_vrs_cav_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS Cavalry Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_cav_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date", "Call Length", "ACPT", "ACPT Option", "ACPT Others", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Point Earned", "Customer Service / Treated customer with courtesy and respect","Avoided third party disclosure/ properly verified identity","Gave all required disclosures effectively","Followed state or local requirements","Commented account according to call","Avoided making misleading or deceptive statements","Avoided improper credit report discussion","Avoided improper 3rd party communication","Avoided not honoring dispute or attorney representation","Avoided improper legal talk off or legal threats","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['customer_service_with_respect']==10) $customer_service_with_respect='Yes';
			else if($user['customer_service_with_respect']==0) $customer_service_with_respect='No';
			else $customer_service_with_respect='N/A';
			if($user['avoided_third_party_disclosure']==10) $avoided_third_party_disclosure='Yes';
			else if($user['avoided_third_party_disclosure']==0) $avoided_third_party_disclosure='No';
			else $avoided_third_party_disclosure='N/A';
			if($user['gave_all_required_disclosures']==10) $gave_all_required_disclosures='Yes';
			else if($user['gave_all_required_disclosures']==0) $gave_all_required_disclosures='No';
			else $gave_all_required_disclosures='N/A';
			if($user['followed_local_requirement']==10) $followed_local_requirement='Yes';
			else if($user['followed_local_requirement']==0) $followed_local_requirement='No';
			else $followed_local_requirement='N/A';
			if($user['commented_account']==10) $commented_account='Yes';
			else if($user['commented_account']==0) $commented_account='No';
			else $commented_account='N/A';
			if($user['avoided_making_misleading']==10) $avoided_making_misleading='Yes';
			else if($user['avoided_making_misleading']==0) $avoided_making_misleading='No';
			else $avoided_making_misleading='N/A';
			if($user['avoided_improper_credit']==10) $avoided_improper_credit='Yes';
			else if($user['avoided_improper_credit']==0) $avoided_improper_credit='No';
			else $avoided_improper_credit='N/A';
			if($user['avoided_improper_3rd_party']==10) $avoided_improper_3rd_party='Yes';
			else if($user['avoided_improper_3rd_party']==0) $avoided_improper_3rd_party='No';
			else $avoided_improper_3rd_party='N/A';
			if($user['avoided_not_honoring']==10) $avoided_not_honoring='Yes';
			else if($user['avoided_not_honoring']==0) $avoided_not_honoring='No';
			else $avoided_not_honoring='N/A';
			if($user['avoided_improper_legal_talk']==10) $avoided_improper_legal_talk='Yes';
			else if($user['avoided_improper_legal_talk']==0) $avoided_improper_legal_talk='No';
			else $avoided_improper_legal_talk='N/A';


			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_length'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['acpt_option'].'",';
			$row .= '"'.$user['acpt_other'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['point_earned'].'",';
			$row .= '"'.$customer_service_with_respect.'",';
			$row .= '"'.$avoided_third_party_disclosure.'",';
			$row .= '"'.$gave_all_required_disclosures.'",';
			$row .= '"'.$followed_local_requirement.'",';
			$row .= '"'.$commented_account.'",';
			$row .= '"'.$avoided_making_misleading.'",';
			$row .= '"'.$avoided_improper_credit.'",';
			$row .= '"'.$avoided_improper_3rd_party.'",';
			$row .= '"'.$avoided_not_honoring.'",';
			$row .= '"'.$avoided_improper_legal_talk.'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
			$row = "";
		}

		fclose($fopen);
	}

//////////////////////VRS CPTA//////////////////////////////////////////
	public function download_qa_vrs_cpta_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS CPTA Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_cpta_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Audit Date", "Agent Audited", "Total Audit", "No. of Connect", "No. of Transfer", "Right Party Contact", "No of Correct Verbatim Given", "% of Correct Verbatim", "No of Incorrect Verbatim Given", "% of Incorrect Verbatim", "No. of Correct Transfer", "No. of Incorrect Transfer", "No. of Warm Transfer", "% of Warm Transfer", "No. of Cold Transfer", "% of Cold Transfer");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$correctVerbatim=round(($user['correct_verbatim'] / $user['total_audit']) * 100, 2);
			$incorrectVerbatim=round(($user['incorrect_verbatim'] / $user['total_audit']) * 100, 2);
			$warmTransfer=round(($user['warm_transfer'] / $user['total_audit']) * 100, 2);
			$coldTransfer=round(($user['cold_transfer'] / $user['total_audit']) * 100, 2);

			$row = '"'.$user['audit_date'].'",';
			$row .= '"'.$user['agent_audited'].'",';
			$row .= '"'.$user['total_audit'].'",';
			$row .= '"'.$user['no_connect'].'",';
			$row .= '"'.$user['no_transfer'].'",';
			$row .= '"'.$user['rp_contact'].'",';
			$row .= '"'.$user['correct_verbatim'].'",';
			$row .= '"'.$correctVerbatim.'%'.'",';
			$row .= '"'.$user['incorrect_verbatim'].'",';
			$row .= '"'.$incorrectVerbatim.'%'.'",';
			$row .= '"'.$user['correct_transfer'].'",';
			$row .= '"'.$user['incorrect_transfer'].'",';
			$row .= '"'.$user['warm_transfer'].'",';
			$row .= '"'.$warmTransfer.'%'.'",';
			$row .= '"'.$user['cold_transfer'].'",';
			$row .= '"'.$coldTransfer.'%'.'"';

			fwrite($fopen,$row."\r\n");
			$row = "";
		}

		fclose($fopen);
	}

//////////////////////VRS CPTA ALL Data//////////////////////////////////////////
	public function download_qa_vrs_cptaAll_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS CPTA All Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_cptaAll_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Audit Date", "Auditor Name", "Agent", "L1Super", "Call Date", "Customer Name", "Phone", "Call Duration", "Connect Type", "Correct Verbatim Given", "Correct/Incorrect Transfer", "Transfer Type", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "QA Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['audit_date'].'",';
			$row .= '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['customer'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['connect_type'].'",';
			$row .= '"'.$user['verbatim'].'",';
			$row .= '"'.$user['transfer'].'",';
			$row .= '"'.$user['transfer_type'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['qa_comment'].'",';

			fwrite($fopen,$row."\r\n");
			$row = "";
		}

		fclose($fopen);
	}

//////////////////JRPA Right Party///////////////////
	public function download_qa_vrs_jrpa_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA VRS JRPA Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vrs_jrpa_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Phone", "Contact Date", "Contact Duration", "VSI Account", "ACPT", "ACPT Option", "ACPT Others", "Call Type", "Can be Automated", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Identify himself/herself by first and last name at the beginning of the call?","Provide the Quality Assurance Statement verbatim before any specific account information was discussed?","State Vital Recovery Services with no deviation?","Verify that he/she was speaking to a right party according to the client requirements (First and Last Name) and before providing the disclosures?","Verify two pieces of demographics information on an outbound call and two pieces on an inbound call? 1) must abide by client requirements and 2) Consumer must provide information unless there is a resistance. 3)Must be completed before disclosures.","Provide the Mini Miranda disclosure verbatim before any specific account information was discussed?","State the client name and the purpose of the communication?","Sate/Ask for balance due?","Ask for a reason for delinquency/intention to resolve the account?","Full and Complete information taken?","Ask for the payment over the phone?","Ask for a post dated payment?","Able to take a promise to pay on the account?","Offer to split the balance in part?", "Offer a one/three/monthly payment lump sum settlement appropriately?", "Offer a payment plan with significant down payment?", "Offer a small good faith payment?","Did not  Misrepresent their identity or authorization?","Did not Threaten to take actions that VRS or the client cannot legally take?","Did not Misrepresent the status of the consumer's account?","Did not Make any faulse representations regarding the nature of the communication?","Did not Contact the consumer at any unusual times (sate regulations) or outside the hours of 8:00 am and 9:00 pm at the consumer's location?","Did not Communicate with the consumer at work if it is known or there is reason to know that such calls are prohibited?","Did not Communicate with the consumer after learning the consumer is represented by an attorney unless a permissible reason exists?","Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers via cell phone email and fax?","Adhere to policy regarding third parties for the sole purpose of obtaining location information for the consumer?","Enter dialer disposition codes correctly to ensure that inappropriate dialing does not take place?","Did not Make any statement that could constitute unfair deceptive or abusive acts or practices that may raise UDAAP concerns?","Did not Communicate or threaten to communicate false credit information or information which should be known to be false?","Handle the consumer's dispute correctly and take appropriate action including providing the consumer with the correct contact information to submit a written dispute or complaint or offer to escalate the call?","Did not Discuss or imply that any type of legal actions will be taken or property repossessed?","Did not Discuss legal action on time barred accounts?","Did not Make the required statement on time barred accounts indicating that the consumer cannot be pursued with legal action?","Adhere to FDCPA  laws?","Make any statement that could be considered discriminatory towards a consumer or a violation of VRS ECOA policy?","Did the collectors adhere to the State Restrictions?","Recap the call by verifying Name Address CC/AP information?", "Followed the proper authorization script before processing payment?", "Advise of the payment processing fee before the payment was taken and take appropriate steps if the consumer pushed back?", "Educate the consumer about correspondence being sent (Receipts PIF SIF Confirmations etc)?", "Provide the consumer with the confirmation code?","Demonstrate Active Listening?","Anticipate and overcome objections?","Summarize the call?","Provided VRS call back number?", "Set appropriate timelines and expectations for follow up?","Close the call Professionally?", "Use the proper action code?","Use the proper result code?","Document thoroughly the context of the conversation?", "Remove any phone numbers known to be incorrect?","Update address information if appropriate?","Change the status of the account if appropriate?" , "Escalate the account to a supervisor for handling if appropriate?/ Escalate the account to a supervisor for handling if appropriate?", "Opening Score", "Opening Possible Score", "Effort Score", "Effort Possible Score", "Negotiation Score", "Negotiation Possible Score", "Compliance Score", "Compliance Possible Score", "Payment Script Score" , "Payment Script Possible" , "Call Control Score", "Call Control Possible Score", "Closing Score", "Closing Possible Score", "Document Score", "Document Possible Score", "Overall Score", "Point Earned", "Call Summary", "Feedback", "Audit Time", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['opening_call']==1.25) $opening_call='Yes';
			else if($user['opening_call']==0) $opening_call='No';
			else $opening_call='N/A';

			if($user['opening_verbatim']==1.25) $opening_verbatim='Yes';
			else if($user['opening_verbatim']==0) $opening_verbatim='No';
			else $opening_verbatim='N/A';

			if($user['opening_vrs']==1.25) $opening_vrs='Yes';
			else if($user['opening_vrs']==0) $opening_vrs='No';
			else $opening_vrs='N/A';

			if($user['opening_rightparty']==1.25) $opening_rightparty='Yes';
			else if($user['opening_rightparty']==0) $opening_rightparty='No';
			else $opening_rightparty='N/A';

			if($user['opening_demographics']==1.25) $opening_demographics='Yes';
			else if($user['opening_demographics']==0) $opening_demographics='No';
			else $opening_demographics='N/A';

			if($user['opening_miranda']==1.25) $opening_miranda='Yes';
			else if($user['opening_miranda']==0) $opening_miranda='No';
			else $opening_miranda='N/A';

			if($user['opening_communication']==1.25) $opening_communication='Yes';
			else if($user['opening_communication']==0) $opening_communication='No';
			else $opening_communication='N/A';

			if($user['opening_balance_due']==1.25) $opening_balance_due='Yes';
			else if($user['opening_balance_due']==0) $opening_balance_due='No';
			else $opening_balance_due='N/A';

			if($user['effort_delinquency']==5) $effort_delinquency='Yes';
			else if($user['effort_delinquency']==0) $effort_delinquency='No';
			else $effort_delinquency='N/A';

			if($user['effort_complete_information']==5) $effort_complete_information='Yes';
			else if($user['effort_complete_information']==0) $effort_complete_information='No';
			else $effort_complete_information='N/A';

			if($user['effort_payment_over_phone']==5) $effort_payment_over_phone='Yes';
			else if($user['effort_payment_over_phone']==0) $effort_payment_over_phone='No';
			else $effort_payment_over_phone='N/A';

			if($user['effort_post_dated_payment']==5) $effort_post_dated_payment='Yes';
			else if($user['effort_post_dated_payment']==0) $effort_post_dated_payment='No';
			else $effort_post_dated_payment='N/A';

			if($user['effort_promise_to_pay']==5) $effort_promise_to_pay='Yes';
			else if($user['effort_promise_to_pay']==0) $effort_promise_to_pay='No';
			else $effort_promise_to_pay='N/A';

			if($user['negotiation_split_balance']==5) $negotiation_split_balance='Yes';
			else if($user['negotiation_split_balance']==0) $negotiation_split_balance='No';
			else $negotiation_split_balance='N/A';

			if($user['negotiation_monthly_payment']==5) $negotiation_monthly_payment='Yes';
			else if($user['negotiation_monthly_payment']==0) $negotiation_monthly_payment='No';
			else $negotiation_monthly_payment='N/A';

			if($user['negotiation_payment_plan']==5) $negotiation_payment_plan='Yes';
			else if($user['negotiation_payment_plan']==0) $negotiation_payment_plan='No';
			else $negotiation_payment_plan='N/A';

			if($user['negotiation_faith_payment']==5) $negotiation_faith_payment='Yes';
			else if($user['negotiation_faith_payment']==0) $negotiation_faith_payment='No';
			else $negotiation_faith_payment='N/A';


			if($user['compliance_mispresent']==0.52) $compliance_mispresent='Yes';
			else if($user['compliance_mispresent']==0) $compliance_mispresent='No';
			else $compliance_mispresent='N/A';

			if($user['compliance_threaten']==0.52) $compliance_threaten='Yes';
			else if($user['compliance_threaten']==0) $compliance_threaten='No';
			else $compliance_threaten='N/A';

			if($user['compliance_faulse']==0.52) $compliance_faulse='Yes';
			else if($user['compliance_faulse']==0) $compliance_faulse='No';
			else $compliance_faulse='N/A';

			if($user['compliance_account']==0.52) $compliance_account='Yes';
			else if($user['compliance_account']==0) $compliance_account='No';
			else $compliance_account='N/A';

			if($user['compliance_contact']==0.52) $compliance_contact='Yes';
			else if($user['compliance_contact']==0) $compliance_contact='No';
			else $compliance_contact='N/A';

			if($user['compliance_communicate']==0.52) $compliance_communicate='Yes';
			else if($user['compliance_contact']==0) $compliance_communicate='No';
			else $compliance_communicate='N/A';

			if($user['compliance_consumer']==0.52) $compliance_consumer='Yes';
			else if($user['compliance_consumer']==0) $compliance_consumer='No';
			else $compliance_consumer='N/A';

			if($user['compliance_policy']==0.52) $compliance_policy='Yes';
			else if($user['compliance_policy']==0) $compliance_policy='No';
			else $compliance_policy='N/A';

			if($user['compliance_location']==0.52) $compliance_location='Yes';
			else if($user['compliance_location']==0) $compliance_location='No';
			else $compliance_location='N/A';

			if($user['compliance_dialer']==0.52) $compliance_dialer='Yes';
			else if($user['compliance_dialer']==0) $compliance_dialer='No';
			else $compliance_dialer='N/A';

			if($user['compliance_unfair']==0.52) $compliance_unfair='No';
			else if($user['compliance_unfair']==0) $compliance_unfair='Yes';
			else $compliance_unfair='N/A';

			if($user['compliance_credit']==0.52) $compliance_credit='Yes';
			else if($user['compliance_credit']==0) $compliance_credit='No';
			else $compliance_credit='N/A';

			if($user['compliance_disput']==0.52) $compliance_disput='Yes';
			else if($user['compliance_disput']==0) $compliance_disput='No';
			else $compliance_disput='N/A';

			if($user['compliance_obtain']==0.52) $compliance_obtain='Yes';
			else if($user['compliance_obtain']==0) $compliance_obtain='No';
			else $compliance_obtain='N/A';

			if($user['compliance_imply']==0.52) $compliance_imply='Yes';
			else if($user['compliance_imply']==0) $compliance_imply='No';
			else $compliance_imply='N/A';

			if($user['compliance_legal']==0.52) $compliance_legal='Yes';
			else if($user['compliance_legal']==0) $compliance_legal='No';
			else $compliance_legal='N/A';

			if($user['compliance_barred']==0.52) $compliance_barred='Yes';
			else if($user['compliance_barred']==0) $compliance_barred='No';
			else $compliance_barred='N/A';

			if($user['compliance_fdcpa']==0.52) $compliance_fdcpa='Yes';
			else if($user['compliance_fdcpa']==0) $compliance_fdcpa='No';
			else $compliance_fdcpa='N/A';

			if($user['compliance_consider']==0.52) $compliance_consider='Yes';
			else if($user['compliance_consider']==0) $compliance_consider='No';
			else $compliance_consider='N/A';

		/* 	if($user['compliance_collector']==0.52) $compliance_collector='No';
			else if($user['compliance_collector']==0) $compliance_collector='Yes';
			else $compliance_collector='N/A';  */

			if($user['payment_script_recap']==2) $payment_script_recap='No';
			else if($user['payment_script_recap']==0) $payment_script_recap='Yes';
			else $payment_script_recap='N/A';

			if($user['payment_script_authorization']==2) $payment_script_authorization='Yes';
			else if($user['payment_script_authorization']==0) $payment_script_authorization='No';
			else $payment_script_authorization='N/A';

			if($user['payment_script_advice']==2) $payment_script_advice='Yes';
			else if($user['payment_script_advice']==0) $payment_script_advice='No';
			else $payment_script_advice='N/A';

			if($user['payment_script_educate']==2) $payment_script_educate='Yes';
			else if($user['payment_script_educate']==0) $payment_script_educate='No';
			else $payment_script_educate='N/A';

			if($user['payment_script_confirmation_code']==2) $payment_script_confirmation_code='Yes';
			else if($user['payment_script_confirmation_code']==0) $payment_script_confirmation_code='No';
			else $payment_script_confirmation_code='N/A';


			if($user['callcontrol_demo']==2.5) $callcontrol_demo='No';
			else if($user['callcontrol_demo']==0) $callcontrol_demo='Yes';
			else $callcontrol_demo='N/A';

			if($user['callcontrol_anticipate']==2.5) $callcontrol_anticipate='Yes';
			else if($user['callcontrol_anticipate']==0) $callcontrol_anticipate='No';
			else $callcontrol_anticipate='N/A';



			if($user['closing_call']==1.25) $closing_call='Yes';
			else if($user['closing_call']==0) $closing_call='No';
			else $closing_call='N/A';

			if($user['closing_restate']==1.25) $closing_restate='Yes';
			else if($user['closing_restate']==0) $closing_restate='No';
			else $closing_restate='N/A';

			if($user['closing_educate']==1.25) $closing_educate='Yes';
			else if($user['closing_educate']==0) $closing_educate='No';
			else $closing_educate='N/A';

			if($user['closing_profession']==1.25) $closing_profession='Yes';
			else if($user['closing_profession']==0) $closing_profession='No';
			else $closing_profession='N/A';


			if($user['document_action']==1.42) $document_action='Yes';
			else if($user['document_action']==0) $document_action='No';
			else $document_action='N/A';

			if($user['document_result']==1.42) $document_result='Yes';
			else if($user['document_result']==0) $document_result='No';
			else $document_result='N/A';

			if($user['document_context']==1.42) $document_context='Yes';
			else if($user['document_context']==0) $document_context='No';
			else $document_context='N/A';

			if($user['document_remove']==1.42) $document_remove='Yes';
			else if($user['document_remove']==0) $document_remove='No';
			else $document_remove='N/A';

			if($user['document_update']==1.42) $document_update='Yes';
			else if($user['document_update']==0) $document_update='No';
			else $document_update='N/A';

			if($user['document_change']==1.42) $document_change='Yes';
			else if($user['document_change']==0) $document_change='No';
			else $document_change='N/A';

			if($user['document_escalate']==1.42) $document_escalate='Yes';
			else if($user['document_escalate']==0) $document_escalate='No';
			else $document_escalate='N/A';



			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['contact_date'].'",';
			$row .= '"'.$user['contact_duration'].'",';
			$row .= '"'.$user['vsi_account'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['acpt_option'].'",';
			$row .= '"'.$user['acpt_other'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['can_automated'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$opening_call.'",';
			$row .= '"'.$opening_verbatim.'",';
			$row .= '"'.$opening_vrs.'",';
			$row .= '"'.$opening_rightparty.'",';
			$row .= '"'.$opening_demographics.'",';
			$row .= '"'.$opening_miranda.'",';
			$row .= '"'.$opening_communication.'",';
			$row .= '"'.$opening_balance_due.'",';
			$row .= '"'.$effort_delinquency.'",';
			$row .= '"'.$effort_complete_information.'",';
			$row .= '"'.$effort_payment_over_phone.'",';
			$row .= '"'.$effort_post_dated_payment.'",';
			$row .= '"'.$effort_promise_to_pay.'",';
			$row .= '"'.$negotiation_split_balance.'",';
			$row .= '"'.$negotiation_monthly_payment.'",';
			$row .= '"'.$negotiation_payment_plan.'",';
			$row .= '"'.$negotiation_faith_payment.'",';
			$row .= '"'.$compliance_mispresent.'",';
			$row .= '"'.$compliance_threaten.'",';
			$row .= '"'.$compliance_account.'",';
			$row .= '"'.$compliance_faulse.'",';
			$row .= '"'.$compliance_contact.'",';
			$row .= '"'.$compliance_communicate.'",';
			$row .= '"'.$compliance_consumer.'",';
			$row .= '"'.$compliance_policy.'",';
			$row .= '"'.$compliance_location.'",';
			$row .= '"'.$compliance_dialer.'",';
			$row .= '"'.$compliance_unfair.'",';
			$row .= '"'.$compliance_credit.'",';
			$row .= '"'.$compliance_disput.'",';
			$row .= '"'.$compliance_obtain.'",';
			$row .= '"'.$compliance_imply.'",';
			$row .= '"'.$compliance_legal.'",';
			$row .= '"'.$compliance_barred.'",';
			$row .= '"'.$compliance_fdcpa.'",';
			$row .= '"'.$compliance_consider.'",';
			/*$row .= '"'.$compliance_collector.'",'; */
			$row .= '"'.$payment_script_recap.'",';
			$row .= '"'.$payment_script_authorization.'",';
			$row .= '"'.$payment_script_advice.'",';
			$row .= '"'.$payment_script_educate.'",';
			$row .= '"'.$payment_script_confirmation_code.'",';
			$row .= '"'.$callcontrol_demo.'",';
			$row .= '"'.$callcontrol_anticipate.'",';
			$row .= '"'.$closing_call.'",';
			$row .= '"'.$closing_restate.'",';
			$row .= '"'.$closing_educate.'",';
			$row .= '"'.$closing_profession.'",';
			$row .= '"'.$document_action.'",';
			$row .= '"'.$document_result.'",';
			$row .= '"'.$document_context.'",';
			$row .= '"'.$document_remove.'",';
			$row .= '"'.$document_update.'",';
			$row .= '"'.$document_change.'",';
			$row .= '"'.$document_escalate.'",';
			$row .= '"'.$user['opening_score'].'",';
			$row .= '"'.$user['opening_possible_scr'].'",';
			$row .= '"'.$user['effort_score'].'",';
			$row .= '"'.$user['effort_possible_scr'].'",';
			$row .= '"'.$user['negotiation_score'].'",';
			$row .= '"'.$user['negotiation_possible_score'].'",';
			$row .= '"'.$user['payment_script_score'].'",';
			$row .= '"'.$user['payment_script_possible_score'].'",';
			$row .= '"'.$user['compliance_score'].'",';
			$row .= '"'.$user['compliance_possible_scr'].'",';
			$row .= '"'.$user['callcontrol_score'].'",';
			$row .= '"'.$user['callcontrol_possible_scr'].'",';
			$row .= '"'.$user['closing_score'].'",';
			$row .= '"'.$user['closing_possible_scr'].'",';
			$row .= '"'.$user['document_score'].'",';
			$row .= '"'.$user['document_possible_scr'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['point_earned'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['entry_time'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


///////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////// Viberides REPORT //////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////
	public function qa_viberides_report(){
		if(check_logged_in()){
			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_viberides_report.php";
			$data["content_js"] = "qa_viberides_js.php";

			$date_from="";
			$date_to="";
			$office_id="";
			$campaign="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';

			$campaign = $this->input->get('campaign');

			$data["qa_viberides_list"] = array();

			if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			}else{
				$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			}


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($office_id != "") $cond1 .= " and office_id='$office_id'";

				if($campaign=='vibe_old'){
					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_viberides_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_viberides_list"] = $fullAray;
					$this->create_qa_viberides_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_viberides_new_CSV";
				}else if($campaign=='vibe'){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_rvw_by) as client_rvw_name from qa_viberides_new_feedback) xx Left Join
					(Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_viberides_list"] = $fullAray;
					$this->create_qa_vibe_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_vibe_new_CSV";
				}

			}

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id'] = $office_id;
			$data['campaign'] = $campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_viberides_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Viberides New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function viberides_headerDetails(){
		return $arrayName = array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Audit Type","Auditor Type","VOC","Call Type","Overall Score","Used Customer's Name in Opening","Thank Customer for Contacting","Took Ownership & Assured Resolution","Restated the Customer's Issue","Provided Step-by-Step Resolution","Use of Proper Verbiage","Resolution Provided is Best Resolution","Uses Please and Thank You in response","If follow up needed set appropriate customer expectations","Took Ownership of Ticket and provided First Contact Resolution","Apologized when necessary","Used appropriate verbiage","Referenced KB article or Terms and Conditions","Reviewed Next Steps","Used Correct Closing","Comprehensive Notes","Verify Profile Picture","Verify email address and phone number","Verify and classify car information and pictures","Verify driver's license front/back picture","Verify Insurance Information","Verify State inspection","Verify Vibe Inspection","Dispositioning Background check","Review note on approved profiles before making changes","Detailed notes once entering a driver profile","Marking tickets as resolved/closed incorrectly","Responding with canned response that does not answer/address questions","Not getting clarity from ticket/question from driver/rider before responding","All drivers must be reviewed","Profanity","Dishonesty","Disconnected Without Reason","Incorrect information in ticket response","Not following updates and instructions","Incorrect/Not Filling Property Box","Incomplete answers for questions","Address driver by his/her name/Vibedriver or Viberider","Approving/Declining driver before verified regarding BGC","Changing/Deleting information without authority or justification e.g. Profile Approvals","Not Including KB Link","Not removing watermark in email","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25","Comments 26","Comments 27","Comments 28","Comments 29","Comments 30","Comments 31","Comments 32","Comments 33","Comments 34","Comments 35","Comments 36","Comments 37","Comments 38","Comments 39","Comments 40","Comments 41","Comments 42","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	public function create_qa_viberides_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header=$this->viberides_headerDetails();
		$field_name="SHOW FULL COLUMNS FROM qa_viberides_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}

/*--------- NEW Viberides Report ----------*/
	public function download_qa_vibe_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Viberides Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_vibe_new_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Type", "Call ID", "Contact Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "Used Customers Name in Opening", "Thank Customer for Contacting", "Took Ownership & Assured Resolution", "Follow-up questions to ensure they understood the problem", "Provided Step-by-Step Resolution", "Information provided is correct", "Use of proper verbiage spelling and grammar", "Reviewed Next Steps", "Used Correct Closing", "Comprehensive Notes", "Verify Profile Picture email address and phone number", "Verify and classify vehicle information and documentation", "Verify drivers license", "Verify vehicle pictures", "Verify Background Check", "Detailed notes once entering a driver profile", "Marking tickets as resolved/closed incorrectly", "Review note on approved profiles before making changes", "Profanity", "Dishonesty", "Disconnected Without Reason", "Incorrect information in ticket response", "Not following updates and instructions", "Incorrect/Not Filling Property Box", "Incomplete answers for questions", "Address driver by his/her nickname/Vibedriver or Viberider", "Approving/Declining driver before verified", "Changing/Deleting information without authority or justification", "Not Including KB Link", "Not removing watermark in email", "GREETING Comment 1", "GREETING Comment 2", "GREETING Comment 3", "SOFT SKILL Comment 1", "SOFT SKILL Comment 2", "SOFT SKILL Comment 3", "SOFT SKILL Comment 4", "SOFT SKILL Comment 5", "SOFT SKILL Comment 6", "SOFT SKILL Comment 7", "BACKOFFICE Comment 1", "BACKOFFICE Comment 2", "BACKOFFICE Comment 3", "BACKOFFICE Comment 4", "BACKOFFICE Comment 5", "BACKOFFICE Comment 6", "BACKOFFICE Comment 7", "BACKOFFICE Comment 8", "AUTOFAILS Comment 1", "AUTOFAILS Comment 2", "AUTOFAILS Comment 3", "AUTOFAILS Comment 4", "AUTOFAILS Comment 5", "AUTOFAILS Comment 6", "AUTOFAILS Comment 7", "AUTOFAILS Comment 8", "AUTOFAILS Comment 9", "AUTOFAILS Comment 10", "AUTOFAILS Comment 11", "AUTOFAILS Comment 12", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['use_customer_name'].'",';
			$row .= '"'.$user['customer_contacting'].'",';
			$row .= '"'.$user['took_ownership'].'",';
			$row .= '"'.$user['followup_question'].'",';
			$row .= '"'.$user['provide_resolution'].'",';
			$row .= '"'.$user['correct_information_provide'].'",';
			$row .= '"'.$user['use_proper_verbiage'].'",';
			$row .= '"'.$user['review_next_step'].'",';
			$row .= '"'.$user['use_correct_closing'].'",';
			$row .= '"'.$user['comprehensive_note'].'",';
			$row .= '"'.$user['verify_profile_picture'].'",';
			$row .= '"'.$user['classify_vehicle'].'",';
			$row .= '"'.$user['verify_driver_license'].'",';
			$row .= '"'.$user['verify_vehicle_picture'].'",';
			$row .= '"'.$user['verify_background_check'].'",';
			$row .= '"'.$user['driver_profile_details'].'",';
			$row .= '"'.$user['making_resolved_ticket'].'",';
			$row .= '"'.$user['approve_changes_profile'].'",';
			$row .= '"'.$user['profanity'].'",';
			$row .= '"'.$user['dishonesty'].'",';
			$row .= '"'.$user['disconected_without_reason'].'",';
			$row .= '"'.$user['incorrect_information'].'",';
			$row .= '"'.$user['not_following_update'].'",';
			$row .= '"'.$user['not_filling_property_box'].'",';
			$row .= '"'.$user['incomplete_answer'].'",';
			$row .= '"'.$user['viberider_driver_address'].'",';
			$row .= '"'.$user['driver_verify_approve_decline'].'",';
			$row .= '"'.$user['changing_information_without_authority'].'",';
			$row .= '"'.$user['not_include_KB_link'].'",';
			$row .= '"'.$user['not_remove_email_watermark'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}


///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA VERSO REPORT ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_verso_report(){
		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			/* $office_id = $this->input->get('office_id');
			if($office_id=="")  $office_id=$user_office_id; */


			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_verso_report.php";


			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";

			/* $cValue = trim($this->input->post('client_id'));
			if($cValue=="") $cValue = trim($this->input->get('client_id')); */

			$pValue = trim($this->input->post('process_id'));
			if($pValue=="") $pValue = trim($this->input->get('process_id'));

			//$data['cValue']=$cValue;
			$data['pValue']=$pValue;



			$data["qa_verso_list"] = array();

			if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			}else{
				$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			}


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				$field_array = array(
						"date_from"=>$date_from,
						"date_to" => $date_to,
						//"office_id" => $office_id,
						"process_id" => $pValue,
						"current_user" => $current_user
					);


				if($pValue=='Customer Care'){

					$fullAray = $this->Qa_verso_model->qa_verso_report_model($field_array);
					$data["qa_verso_list"] = $fullAray;
					$this->create_qa_verso_inbound_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_verso_inbound_CSV";

				}else if($pValue=='Full Call'){

					$fullAray = $this->Qa_verso_model->qa_verso_report_model($field_array);
					$data["qa_verso_list"] = $fullAray;
					$this->create_qa_verso_ob_fca_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_verso_ob_fca_CSV";

				}else if($pValue=='India Moe'){

					$fullAray = $this->Qa_verso_model->qa_verso_report_model($field_array);
					$data["qa_verso_list"] = $fullAray;
					$this->create_qa_india_moe_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_india_moe_CSV";

				}else{

					$fullAray = $this->Qa_verso_model->qa_verso_report_model($field_array);
					$data["qa_verso_list"] = $fullAray;
					$this->create_qa_verso_ob_sca_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_verso_ob_sca_CSV";

				}
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}

/*------VERSO Customer Care Audit(Inbound)-------*/
	public function download_qa_verso_inbound_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Verso Customer Care Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_verso_inbound_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Phone", "Campaign", "Audit Type", "VOC", "Agent CRM ID", "Site", "Call ID", "Call Date", "Call Opening", "Apology/ Empathy", "Enthusiasm", "Politeness and Courtesy", "Fluency", "Complete & Accurate Resolution", "Correct CRM Entry/CRM Accuracy", "Closing", "Active Listening", "Hold Protocol", "Effective Probing", "Overall Score", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Management Review Date", "Management Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['call_opening']==10) $call_opening='Yes';
			else if($user['call_opening']==10.1) $call_opening='N/A';
			else $call_opening='No';

			if($user['apology_empathy']==10) $apology_empathy='Yes';
			else if($user['apology_empathy']==10.1) $apology_empathy='N/A';
			else $apology_empathy='No';

			if($user['enthusiasm']==10) $enthusiasm='Yes';
			else if($user['enthusiasm']==10.1) $enthusiasm='N/A';
			else $enthusiasm='No';

			if($user['politeness_courtesy']==10) $politeness_courtesy='Yes';
			else if($user['politeness_courtesy']==10.1) $politeness_courtesy='N/A';
			else $politeness_courtesy='No';

			if($user['fluency']==10) $fluency='Yes';
			else if($user['fluency']==10.1) $fluency='N/A';
			else $fluency='No';

			if($user['accurate_resolution']==10) $accurate_resolution='Yes';
			else if($user['accurate_resolution']==10.1) $accurate_resolution='N/A';
			else $accurate_resolution='No';

			if($user['crm_accuracy']==10) $crm_accuracy='Yes';
			else if($user['crm_accuracy ']==10.1) $crm_accuracy='N/A';
			else $crm_accuracy='No';

			if($user['closing']==10) $closing='Yes';
			else if($user['closing']==10.1) $closing='N/A';
			else $closing='No';

			if($user['active_listening']==10) $active_listening='Yes';
			else if($user['active_listening']==10.1) $active_listening='N/A';
			else $active_listening='No';

			if($user['hold_protocol']==5) $hold_protocol='Yes';
			else if($user['hold_protocol']==5.1) $hold_protocol='N/A';
			else $hold_protocol='No';

			if($user['effective_probing']==5) $effective_probing='Yes';
			else if($user['effective_probing']==5.1) $effective_probing='N/A';
			else $effective_probing='No';


			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['agent_crm_id'].'",';
			$row .= '"'.$user['site'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$call_opening.'",';
			$row .= '"'.$apology_empathy.'",';
			$row .= '"'.$enthusiasm.'",';
			$row .= '"'.$politeness_courtesy.'",';
			$row .= '"'.$fluency.'",';
			$row .= '"'.$accurate_resolution.'",';
			$row .= '"'.$crm_accuracy.'",';
			$row .= '"'.$closing.'",';
			$row .= '"'.$active_listening.'",';
			$row .= '"'.$hold_protocol.'",';
			$row .= '"'.$effective_probing.'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/*------VERSO Full Call Audit(Outbound)-------*/
	public function download_qa_verso_ob_fca_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Verso Full Call Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_verso_ob_fca_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Agent CRM ID", "Phone", "Campaign", "Audit Type", "VOC", "Site", "Revenue", "Tag Error", "Probing Error", "Other Error", "Fallout", "Fallout Comment", "Overall Score", "ZTP", "Call Status", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Management Review Date", "Management Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['tag_error']==40) $tag_error='No';
			else $call_opening='Yes';

			if($user['probing_error']==40) $probing_error='No';
			else $probing_error='Yes';

			if($user['other_error']==10) $other_error='No';
			else $other_error='Yes';

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['agent_crm_id'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['site'].'",';
			$row .= '"'.$user['revenue'].'",';
			$row .= '"'.$tag_error.'",';
			$row .= '"'.$probing_error.'",';
			$row .= '"'.$other_error.'",';
			$row .= '"'.$user['fallout'].'",';
			$row .= '"'.$user['fallout_comment'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['ztp'].'",';
			$row .= '"'.$user['call_status'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/*------VERSO Special Call Audit(Outbound)-------*/
	public function download_qa_verso_ob_sca_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Verso Special Call Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_verso_ob_sca_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Agent CRM ID", "Phone", "Campaign", "Audit Type", "VOC", "Site", "Question Code", "Call Status", "Reject Reason", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Management Review Date", "Management Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['agent_crm_id'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['site'].'",';
			$row .= '"'.$user['question_code'].'",';
			$row .= '"'.$user['call_status'].'",';
			$row .= '"'.$user['reject_reason'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

	////////////////////////////////////////////// VFS Report //////////////////////////////////////////////////

	public function qa_us_da_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_usda_report.php";
			$data["content_js"] = "qa_od_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_usda_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_us_da_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_usda_list"] = $fullAray;
				$this->create_qa_usda_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_usda_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_usda_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA US DA Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_usda_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_us_da";
		$edit_url = "add_edit_usda";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Opening", "Listening", "Search", "Fulfillment", "Closing", "Attitude", "Professionalism", "Call Summary", "Feedback", "Agent Review Status", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['opening'].'",';
			$row .= '"'.$user['listening'].'",';
			$row .= '"'.$user['search'].'",';
			$row .= '"'.$user['fulfillment'].'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'.$user['attitude'].'",';
			$row .= '"'.$user['professionalism'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}

	/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////// QA SXC REPORT ////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_sxc_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_sxc_report.php";
			$data["content_js"] = "qa_metropolis_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_sxc_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_sxc_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_sxc_list"] = $fullAray;
				$this->create_qa_sxc_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_sxc_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_sxc_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA SXC Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_sxc_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Date of Evaluation", "Agent", "Fusion ID", "L1 Super", "Date/Time of Response", "Ticket Number", "Issue/Concern", "Audit Type", "VOC", "Overall Score", "Asking probing questions to assist", "Accuracy and appropriateness of information", "Did the agent review the previous conversation?", "Empathy and Enthusiasm (offer apology only when needed)", "Simplicity and Politeness", "Grammar and Punctuation", "Are the thoughts and instructions on the email properly organized?", "Salutation", "Closing", "Did the agent respond or acknowledge the customers issue?", "Did the agent follow through with concerned channels or dept to resolve the issue?", "Did the agent follow up with customer within the agreed timeline?", "Did the agent properly reassign or tag the ticket?", "Did the agent properly document important information on the ticket?", "Did the agent adequately resolved the customers issue or provided a timeframe for resolution?", "BODY OF THE EMAIL Comment1", "BODY OF THE EMAIL Comment2", "BODY OF THE EMAIL Comment3", "FORMAT AND TONE Comment1", "FORMAT AND TONE Comment2", "FORMAT AND TONE Comment3", "FORMAT AND TONE Comment4", "FORMAT AND TONE Comment5", "FORMAT AND TONE Comment6", "FOLLOW-UP OR ACTIONS TAKEN Comment1", "FOLLOW-UP OR ACTIONS TAKEN Comment2", "FOLLOW-UP OR ACTIONS TAKEN Comment3", "FOLLOW-UP OR ACTIONS TAKEN Comment4", "FOLLOW-UP OR ACTIONS TAKEN Comment5", "FOLLOW-UP OR ACTIONS TAKEN Comment6", "Call Summary", "Feedback", "Agent Review Date", "Agent cmtent", "Mgnt Review Date","Mgnt Review By", "Mgnt cmtent", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['ticket_no'].'",';
			$row .= '"'.$user['issue_concern'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['askingProbingQuestion'].'",';
			$row .= '"'.$user['accuracyandAppropiateness'].'",';
			$row .= '"'.$user['agentReviewPreviousConversation'].'",';
			$row .= '"'.$user['empathyandEnthusiasm'].'",';
			$row .= '"'.$user['simplycityandPoliteness'].'",';
			$row .= '"'.$user['grammerandPunctuation'].'",';
			$row .= '"'.$user['instructionEmailProperly'].'",';
			$row .= '"'.$user['salutation'].'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'.$user['agentRespondCustomer'].'",';
			$row .= '"'.$user['agentFollowConcernChannel'].'",';
			$row .= '"'.$user['agentFollowUpCustomer'].'",';
			$row .= '"'.$user['agentProperlyReassign'].'",';
			$row .= '"'.$user['agentProperlyDocument'].'",';
			$row .= '"'.$user['agentAdequatelyResolved'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

	/////////////////////////////////////// Swiggy Report /////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////
	public function qa_swiggy_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_swiggy_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_swiggy_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (date(audit_date) >= '$date_from' and date(audit_date) <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_swiggy_omt_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_swiggy_omt_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_swiggy_omt_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_swiggy_list"] = $fullAray;
				$this->create_qa_swiggy_omt_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_swiggy_omt_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_swiggy_omt_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Swiggy OMT Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_swiggy_omt_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date", "Monitoring Type", "Order ID", "Call ID", "Call Duration", "Disposition", "Category", "Call Party", "Language", "Audit Type", "VOC", "Greeting", "Greeting Reason If Rated No/Fatal", "Greeting Reason", "Greeting - What went well?", "Greeting - What could have been better?", "Identification", "Identification Reason If Rated No/Fatal", "Identification Reason", "Identification - What went well?", "Identification - What could have been better?", "Call Intro", "Call Intro Reason If Rated No/Fatal", "Call Intro Reason", "Call Intro - What went well?", "Call Intro - What could have been better?", "Language Adher", "Language Adher Reason If Rated No/Fatal", "Language Adher Reason", "Language Adher - What went well?", "Language Adher - What could have been better?", "Confirm", "Confirm Reason If Rated No/Fatal", "Confirm Reason", "Confirm - What went well?", "Confirm - What could have been better?", "System Valid", "System Valid Reason If Rated No/Fatal", "System Valid Reason", "System Valid - What went well?", "System Valid - What could have been better?", "Probing", "Probing Reason If Rated No/Fatal", "Probing Reason", "Probing - What went well?", "Probing - What could have been better?", "Taking Owner", "Taking Owner Reason If Rated No/Fatal", "Taking Owner Reason", "Taking Owner - What went well?", "Taking Owner - What could have been better?", "Information Sharing", "Information Sharing Reason If Rated No/Fatal", "Information Sharing Reason", "Information Sharing - What went well?", "Information Sharing - What could have been better?", "Right Action", "Right Action Reason If Rated No/Fatal", "Right Action Reason", "Right Action - What went well?", "Right Action - What could have been better?", "Call Control", "Call Control Reason If Rated No/Fatal", "Call Control Reason", "Call Control - What went well?", "Call Control - What could have been better?", "Soft Skill", "Soft Skill Reason If Rated No/Fatal", "Soft Skill Reason", "Soft Skill - What went well?", "Soft Skill - What could have been better?", "Hold Procedure", "Hold Procedure Reason If Rated No/Fatal", "Hold Procedure Reason", "Hold Procedure - What went well?", "Hold Procedure - What could have been better?", "Language Switch", "Language Switch Reason If Rated No/Fatal", "Language Switch Reason", "Language Switch - What went well?", "Language Switch - What could have been better?", "Active Listening", "Active Listening Reason If Rated No/Fatal", "Active Listening Reason", "Active Listening - What went well?", "Active Listening - What could have been better?", "Right Fit", "Right Fit Reason If Rated No/Fatal", "Right Fit Reason", "Right Fit - What went well?", "Right Fit - What could have been better?", "Further Assist", "Further Assist Reason If Rated No/Fatal", "Further Assist Reason", "Further Assist - What went well?", "Further Assist - What could have been better?", "Call Close", "Call Close Reason If Rated No/Fatal", "Call Close Reason", "Call Close - What went well?", "Call Close - What could have been better?", "ZTP", "ZTP Reason If Rated No/Fatal", "ZTP Reason", "ZTP - What went well?", "ZTP - What could have been better?", "Overall Score", "Was the Agent able to resolve the breakage in order Life Cycle", "Order Fulfillment - ACPT", "Order Fulfillment - RCA", "Order Fulfillment -  Remarks", "Call Category", "High Background Noice evident in the call", "Opportunity for AHT Reduction", "AHT - ACPT", "AHT - Remarks", "Will this call lead to repeat?", "Repeat Call - ACPT", "Repeat Call - Remarks", "Was the call transferred to IVR?", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['greeting']==3) $greeting='Yes';
			else $greeting='No';
			if($user['identification']==3) $identification='Yes';
			else $identification='No';
			if($user['callintro']==3) $callintro='Yes';
			else $callintro='No';
			if($user['languageadher']==3) $languageadher='Yes';
			else $languageadher='No';
			if($user['confirm']==3) $confirm='Yes';
			else $confirm='No';
			if($user['systemvalid']==6) $systemvalid='Yes';
			else $systemvalid='No';
			if($user['probing']==6) $probing='Yes';
			else $probing='No';
			if($user['takingowner']==8) $takingowner='Yes';
			else if($user['takingowner']==0) $takingowner='No';
			else $takingowner='Fatal';
			if($user['infosharing']==23) $infosharing='Yes';
			else $infosharing='Fatal';
			if($user['rightaction']==12) $rightaction='Yes';
			else if($user['rightaction']==0) $rightaction='No';
			else $rightaction='Fatal';
			if($user['callcontrol']==4) $callcontrol='Yes';
			else $callcontrol='No';
			if($user['softskill']==4) $softskill='Yes';
			else $softskill='No';
			if($user['holdprocedure']==2) $holdprocedure='Yes';
			else $holdprocedure='No';
			if($user['languageswitch']==2) $languageswitch='Yes';
			else $languageswitch='No';
			if($user['activelisten']==4) $activelisten='Yes';
			else $activelisten='No';
			if($user['rightfit']==4) $rightfit='Yes';
			else if($user['rightfit']==0) $rightfit='No';
			else $rightfit='Fatal';
			if($user['furtherassist']==5) $furtherassist='Yes';
			else $furtherassist='No';
			if($user['callclose']==5) $callclose='Yes';
			else $callclose='No';


			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['monitoring_type'].'",';
			$row .= '"'.$user['order_id'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['category'].'",';
			$row .= '"'.$user['call_party'].'",';
			$row .= '"'.$user['language'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$greeting.'",';
			$row .= '"'.$user['greeting_reason'].'",';
			$row .= '"'.$user['greeting_reason2'].'",';
			$row .= '"'.$user['greeting_www'].'",';
			$row .= '"'.$user['greeting_wcb'].'",';
			$row .= '"'.$identification.'",';
			$row .= '"'.$user['identification_reason'].'",';
			$row .= '"'.$user['identification_reason2'].'",';
			$row .= '"'.$user['identification_www'].'",';
			$row .= '"'.$user['identification_wcb'].'",';
			$row .= '"'.$callintro.'",';
			$row .= '"'.$user['callintro_reason'].'",';
			$row .= '"'.$user['callintro_reason2'].'",';
			$row .= '"'.$user['callintro_www'].'",';
			$row .= '"'.$user['callintro_wcb'].'",';
			$row .= '"'.$languageadher.'",';
			$row .= '"'.$user['languageadher_reason'].'",';
			$row .= '"'.$user['languageadher_reason2'].'",';
			$row .= '"'.$user['languageadher_www'].'",';
			$row .= '"'.$user['languageadher_wcb'].'",';
			$row .= '"'.$confirm.'",';
			$row .= '"'.$user['confirm_reason'].'",';
			$row .= '"'.$user['confirm_reason2'].'",';
			$row .= '"'.$user['confirm_www'].'",';
			$row .= '"'.$user['confirm_wcb'].'",';
			$row .= '"'.$systemvalid.'",';
			$row .= '"'.$user['systemvalid_reason'].'",';
			$row .= '"'.$user['systemvalid_reason2'].'",';
			$row .= '"'.$user['systemvalid_www'].'",';
			$row .= '"'.$user['systemvalid_wcb'].'",';
			$row .= '"'.$probing.'",';
			$row .= '"'.$user['probing_reason'].'",';
			$row .= '"'.$user['probing_reason2'].'",';
			$row .= '"'.$user['probing_www'].'",';
			$row .= '"'.$user['probing_wcb'].'",';
			$row .= '"'.$takingowner.'",';
			$row .= '"'.$user['takingowner_reason'].'",';
			$row .= '"'.$user['takingowner_reason2'].'",';
			$row .= '"'.$user['takingowner_www'].'",';
			$row .= '"'.$user['takingowner_wcb'].'",';
			$row .= '"'.$infosharing.'",';
			$row .= '"'.$user['infosharing_reason'].'",';
			$row .= '"'.$user['infosharing_reason2'].'",';
			$row .= '"'.$user['infosharing_www'].'",';
			$row .= '"'.$user['infosharing_wcb'].'",';
			$row .= '"'.$rightaction.'",';
			$row .= '"'.$user['rightaction_reason'].'",';
			$row .= '"'.$user['rightaction_reason2'].'",';
			$row .= '"'.$user['rightaction_www'].'",';
			$row .= '"'.$user['rightaction_wcb'].'",';
			$row .= '"'.$callcontrol.'",';
			$row .= '"'.$user['callcontrol_reason'].'",';
			$row .= '"'.$user['callcontrol_reason2'].'",';
			$row .= '"'.$user['callcontrol_www'].'",';
			$row .= '"'.$user['callcontrol_wcb'].'",';
			$row .= '"'.$softskill.'",';
			$row .= '"'.$user['softskill_reason'].'",';
			$row .= '"'.$user['softskill_reason2'].'",';
			$row .= '"'.$user['softskill_www'].'",';
			$row .= '"'.$user['softskill_wcb'].'",';
			$row .= '"'.$holdprocedure.'",';
			$row .= '"'.$user['holdprocedure_reason'].'",';
			$row .= '"'.$user['holdprocedure_reason2'].'",';
			$row .= '"'.$user['holdprocedure_www'].'",';
			$row .= '"'.$user['holdprocedure_wcb'].'",';
			$row .= '"'.$languageswitch.'",';
			$row .= '"'.$user['languageswitch_reason'].'",';
			$row .= '"'.$user['languageswitch_reason2'].'",';
			$row .= '"'.$user['languageswitch_www'].'",';
			$row .= '"'.$user['languageswitch_wcb'].'",';
			$row .= '"'.$activelisten.'",';
			$row .= '"'.$user['activelisten_reason'].'",';
			$row .= '"'.$user['activelisten_reason2'].'",';
			$row .= '"'.$user['activelisten_www'].'",';
			$row .= '"'.$user['activelisten_wcb'].'",';
			$row .= '"'.$rightfit.'",';
			$row .= '"'.$user['rightfit_reason'].'",';
			$row .= '"'.$user['rightfit_reason2'].'",';
			$row .= '"'.$user['rightfit_www'].'",';
			$row .= '"'.$user['rightfit_wcb'].'",';
			$row .= '"'.$furtherassist.'",';
			$row .= '"'.$user['furtherassist_reason'].'",';
			$row .= '"'.$user['furtherassist_reason2'].'",';
			$row .= '"'.$user['furtherassist_www'].'",';
			$row .= '"'.$user['furtherassist_wcb'].'",';
			$row .= '"'.$callclose.'",';
			$row .= '"'.$user['callclose_reason'].'",';
			$row .= '"'.$user['callclose_reason2'].'",';
			$row .= '"'.$user['callclose_www'].'",';
			$row .= '"'.$user['callclose_wcb'].'",';
			$row .= '"'.$user['ztp'].'",';
			$row .= '"'.$user['ztp_reason'].'",';
			$row .= '"'.$user['ztp_reason2'].'",';
			$row .= '"'.$user['ztp_www'].'",';
			$row .= '"'.$user['ztp_wcb'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['was_agent_resolve'].'",';
			$row .= '"'.$user['order_acpt'].'",';
			$row .= '"'.$user['order_rca'].'",';
			$row .= '"'.$user['order_remarks'].'",';
			$row .= '"'.$user['call_category'].'",';
			$row .= '"'.$user['high_background'].'",';
			$row .= '"'.$user['aht_reduction'].'",';
			$row .= '"'.$user['aht_acpt'].'",';
			$row .= '"'.$user['aht_remarks'].'",';
			$row .= '"'.$user['will_call_lead'].'",';
			$row .= '"'.$user['repeat_call_acpt'].'",';
			$row .= '"'.$user['repeat_call_remarks'].'",';
			$row .= '"'.$user['ivr_call_transfer'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////// QA Super Daily REPORT ////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_superdaily_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_superdaily_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_superdaily_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All") $cond .= "";
				else $cond .=" and audit_type='$audit_type'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else if(get_login_type()=="client"){
					$cond1 .=" And audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond1 .="";
				}

				//$table=($this->input->get('department_id')=='sd_audit')?"qa_superdaily_feedback":"qa_superdaily_call_feedback";
				if($this->input->get('department_id')=='sd_audit'){
					$table='qa_superdaily_feedback';
				}else if($this->input->get('department_id')=='sd_call_audit'){
					$table='qa_superdaily_call_new_feedback';
				}else if($this->input->get('department_id')=='sd_new_audit'){
					$table='qa_superdaily_new_feedback';
				}else if($this->input->get('department_id')=='spdl_imgval'){
					$table='qa_superdaily_image_validate_new';
				}else if($this->input->get('department_id')=='spdl_imgval_old'){
					$table='qa_superdaily_image_validate';
				}else if($this->input->get('department_id')=='spdl_reso'){
					$table='qa_superdaily_complaint_resolution';
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from $table) xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_superdaily_list"] = $fullAray;
				$data['dep_id']=$this->input->get('department_id');

				if($this->input->get('department_id')=='sd_audit'){
					$this->create_qa_superdaily_CSV($fullAray);
				}else if($this->input->get('department_id')=='sd_call_audit'){
					$this->create_qa_superdaily_call_CSV($fullAray);
				}else if($this->input->get('department_id')=='sd_new_audit'){
					$this->create_qa_superdaily_new_CSV($fullAray);
				}else if($this->input->get('department_id')=='spdl_imgval'){
					$this->create_qa_superdaily_imgval_new_CSV($fullAray);
				}else if($this->input->get('department_id')=='spdl_imgval_old'){
					$this->create_qa_superdaily_imgval_CSV($fullAray);
				}else if($this->input->get('department_id')=='spdl_reso'){
					$this->create_qa_superdaily_reso_CSV($fullAray);
				}

				$dn_link = base_url()."reports_qa/download_qa_superdaily_CSV";


			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_superdaily_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Super Daily Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_superdaily_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Chat Date", "Contact No", "Customer ID", "Chat Weblink", "Chat Type", "Chat Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Communication", "Resolution", "Chat Opening", "Chat Opening Comment", "Chat Closure", "Chat Closure Comment", "Acknowledgement Comprehension", "Acknowledgement Comprehension Comment", "Rapport buliding and Empathy", "Rapport buliding and Empathy Comment", "Probing", "Probing Comment", "Grammar and Choice of Words", "Grammar and Choice of Words Comment", "Problem Solving Abilities", "Problem Solving Abilities Comment", "Providing complete and accurate information", "Providing complete and accurate information Comment", "Ownership", "Ownership Comment", "Incorrect Labelling", "Incorrect Labelling Comment", "Raised relevant complaint", "Raised relevant complaint Comment", "ZTP", "ZTP Comment", "Callback Offered/Required", "Callback Offered/Required Comment", "Retool Accuracy", "Retool Accuracy Comment", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['chat_date'].'",';
			$row .= '"'.$user['contact_no'].'",';
			$row .= '"'.$user['customer_id'].'",';
			$row .= '"'.$user['chat_weblink'].'",';
			$row .= '"'.$user['chat_type'].'",';
			$row .= '"'.$user['chat_dispo'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['communication_score'].'%'.'",';
			$row .= '"'.$user['resolution_score'].'%'.'",';
			$row .= '"'.$user['communicationchatopening'].'",';
			$row .= '"'.$user['comm1'].'",';
			$row .= '"'.$user['communicationchatclose'].'",';
			$row .= '"'.$user['comm2'].'",';
			$row .= '"'.$user['communicationcomprehension'].'",';
			$row .= '"'.$user['comm3'].'",';
			$row .= '"'.$user['communicationrapportbuild'].'",';
			$row .= '"'.$user['comm4'].'",';
			$row .= '"'.$user['communicationprobing'].'",';
			$row .= '"'.$user['comm5'].'",';
			$row .= '"'.$user['communicationgrammer'].'",';
			$row .= '"'.$user['comm6'].'",';
			$row .= '"'.$user['resolutionproblemsolving'].'",';
			$row .= '"'.$user['reso1'].'",';
			$row .= '"'.$user['resolutioncustomerinformation'].'",';
			$row .= '"'.$user['reso2'].'",';
			$row .= '"'.$user['resolutionowenership'].'",';
			$row .= '"'.$user['reso3'].'",';
			$row .= '"'.$user['resolutionincorrectlebel'].'",';
			$row .= '"'.$user['reso4'].'",';
			$row .= '"'.$user['resolutionraisedtool'].'",';
			$row .= '"'.$user['reso5'].'",';
			$row .= '"'.$user['resolutionztp'].'",';
			$row .= '"'.$user['reso6'].'",';
			$row .= '"'.$user['resolutioncallbackoffer'].'",';
			$row .= '"'.$user['reso7'].'",';
			$row .= '"'.$user['resolutionretoolaccuracy'].'",';
			$row .= '"'.$user['reso8'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

	public function create_qa_superdaily_call_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Evaluator Name", "Audit Date", "Fusion ID", "Agent", "TL/AM Name", "Call Date/Time","Customer No", "Channel", "Call Type", "Chat Link", "Actual Disposition", "Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Understood Customer Problem", "Took necessary action to solve problem", "Customer understood what is being done", "Was helpful to customer", "1.1 Interruption", "1.1 Comment", "1.2 Listening Comprehension", "1.2 Comment", "1.3 Made the customer repeat unnecessarily", "1.3 Comment", "1.4 Asked necessary questions", "1.4 Comment", "1.5 Acknowledge where necessary", "1.5 Comment", "2.1 Complaint created or Updated", "2.1 Comment", "2.2 Complaint creation post call or chat", "2.2 Comment", "2.3 Escalation", "2.3 Comment", "2.4 Entry into any sheets", "2.4 Comment", "2.5 Follow-up", "2.5 Comment", "2.6 Hold used", "2.6 Comment", "2.7 Correct or complete information given", "2.7 Comment", "2.8 Hold time in secs", "2.8 Comment", "2.9 Dead air in sec", "2.9 Comment", "2.10 Possibility Customer calling back", "2.10 Comment", "3.1 Explained what is the current situation", "3.1 Comment", "3.2 Informed customer what we have now done", "3.2 Comment", "3.3 Follow-up done", "3.3 Comment", "3.4 Spoke or chatted to the Customer", "3.4 Comment", "3.5 Asked permission for hold", "3.5 Comment", "4.1 Answered any other questions patiently", "4.1 Comment", "4.2 Asked for further assistance if relevant", "4.2 Comment", "4.3 Eager to wrap up call or chat", "4.3 Comment", "4.4 Polite", "4.4 Comment", "4.5 Empathetic", "4.5 Comment", "4.6 Tone", "4.6 Comment", "*** 5.1 Rude", "5.1 Comment", "*** 5.2 Sarcastic", "5.1 Comment", "*** 5.3 Deliberate Disconnect", "5.3 Comment", "*** 6.1 Abusive", "6.1 Comment", "*** 6.2 Inappropriate language", "6.2 Comment", "Agent did not action as required", "Comment", "Product Quality damage expired quantity mismatch", "Comment", "SOP followed - to be explained in brief", "Comment", "Customer Expecting more than what can be done", "Comment", "Technology App issues like app does not load", "Comment", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['contact_no'].'",';
			$row .= '"'.$user['channel'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['customer_id'].'",';
			$row .= '"'.$user['actual_dispo'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['ucp_score'].'%'.'",';
			$row .= '"'.$user['tna_score'].'%'.'",';
			$row .= '"'.$user['cu_score'].'%'.'",';
			$row .= '"'.$user['hc_score'].'%'.'",';
			$row .= '"'.$user['interruption'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'.$user['listening_comprehension'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'.$user['repeat_customer_unnecessary'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'.$user['asked_necessary_question'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'.$user['necessary_acknowledge'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'.$user['complaint_created'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'.$user['complaint_post_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'.$user['escalation'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'.$user['entry_into_sheet'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'.$user['follow_up'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'.$user['hold_used'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'.$user['complete_information'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'.$user['hold_time_in_sec'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'.$user['dead_air'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'.$user['customer_calling_back'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'.$user['explain_current_situation'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'.$user['informed_customer'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'.$user['follow_up_done'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'.$user['spoke_chatted'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'.$user['ask_hold_permission'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
			$row .= '"'.$user['answer_any_question'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
			$row .= '"'.$user['ask_further_assistance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
			$row .= '"'.$user['wrap_up_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
			$row .= '"'.$user['polite'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
			$row .= '"'.$user['emphathetic'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
			$row .= '"'.$user['tone'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
			$row .= '"'.$user['rude'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
			$row .= '"'.$user['sarcastic'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
			$row .= '"'.$user['deliberate_disconnect'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
			$row .= '"'.$user['abusive'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
			$row .= '"'.$user['inappropiate_language'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
			$row .= '"'.$user['agent_not_action'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';
			$row .= '"'.$user['product_damage'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
			$row .= '"'.$user['policy_process'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
			$row .= '"'.$user['customer_fraud'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt35'])).'",';
			$row .= '"'.$user['not_recieve_OTP'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt36'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
			// echo $row;
			// die;
			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

///////////////// Superdaily New (main QA sheet)//////////////////////
	public function create_qa_superdaily_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Evaluator Name", "Audit Date", "Fusion ID", "Agent", "TL/AM Name", "Call Date/Time", "Customer No", "Chat Link", "Audit Category", "Disposition", "Actual Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Understood Customers Problem", "Took necessary action to solve problem", "Customer understood what is being done", "Was helpful to customer", "Overall Score", "1.1 Interruption", "1.1 Comment", "1.2 Listening Comprehension", "1.2 Comment", "1.3 Made the customer repeat unnecessarily", "1.3 Comment", "1.4 Asked necessary questions", "1.4 Comment", "1.5 Acknowledge where necessary", "1.5 Comment", "1.6 Personalization", "1.6 Comment", "2.1 Complaint created or Updated", "2.1 Comment", "2.2 Retool comments (customer VOC)", "2.2 Comment", "2.3 Escalation", "2.3 Comment", "2.4 Entry into any sheets", "2.4 Comment", "2.5 Follow-up", "2.5 Comment", "2.6 Hold used", "2.6 Comment", "2.7 Correct or complete information given", "2.7 Comment", "2.8 Hold time in secs", "2.8 Comment", "2.9 Dead air in sec", "2.9 Comment", "2.10 Possibility Customer calling back", "2.10 Comment", "3.1 Explained what is the current situation", "3.1 Comment", "3.2 Informed customer what we have now done", "3.2 Comment", "3.3 Follow-up done", "3.3 Comment", "3.4 Spoke or chatted to the Customer", "3.4 Comment", "3.5 Asked permission for hold", "3.5 Comment", "4.1 Answered any other questions patiently", "4.1 Comment", "4.2 Asked for further assistance if relevant", "4.2 Comment", "4.3 Eager to wrap up call or chat", "4.3 Comment", "4.4 Polite", "4.4 Comment", "4.5 Empathetic", "4.5 Comment", "4.6 Tone", "4.6 Comment", "*** 5.1 Fatal", "5.1 Comment", "*** 5.2 ZTP", "5.2 Comment", "ACPT", "WHY1", "WHY2", "Classify the Audit", "Call Summary", "Feedback", "Agent_Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['contact_no'].'",';
			$row .= '"'.$user['chat_link'].'",';
			$row .= '"'.$user['audit_category'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['actual_dispo'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['ucp_score'].'%'.'",';
			$row .= '"'.$user['tna_score'].'%'.'",';
			$row .= '"'.$user['cu_score'].'%'.'",';
			$row .= '"'.$user['hc_score'].'%'.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['interruption'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'.$user['listening_comprehension'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'.$user['repeat_customer_unnecessary'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'.$user['asked_necessary_question'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'.$user['necessary_acknowledge'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'.$user['personalization'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'.$user['complaint_created'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'.$user['retool_comment'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'.$user['escalation'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'.$user['entry_into_sheet'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'.$user['follow_up'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'.$user['hold_used'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'.$user['complete_information'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'.$user['hold_time_in_sec'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'.$user['dead_air'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'.$user['customer_calling_back'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'.$user['explain_current_situation'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'.$user['informed_customer'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'.$user['follow_up_done'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'.$user['spoke_chatted'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
			$row .= '"'.$user['ask_hold_permission'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
			$row .= '"'.$user['answer_any_question'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
			$row .= '"'.$user['ask_further_assistance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
			$row .= '"'.$user['wrap_up_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
			$row .= '"'.$user['polite'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
			$row .= '"'.$user['emphathetic'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
			$row .= '"'.$user['tone'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
			$row .= '"'.$user['Fatal'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
			$row .= '"'.$user['ZTP'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['acpt'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['why1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['why2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['classify_audit'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
			// echo $row;
			// die;
			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

///////////////// Superdaily Image Validation //////////////////////
	public function create_qa_superdaily_imgval_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "TL/AM Name", "Call Date/Time", "Contact No", "Chat Link", "Audit Category", "Disposition", "Actual Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Understood Customers Problem", "Took necessary action to solve problem", "Understood what is being done", "Overall Score", "1.1 Was agent able to identify the validity of image properly?", "1.2 If NO what should be the actual status of image?", "2.1 Was call Required in this case?", "2.2 Was call attempt made?", "2.3 POD Check done", "2.4 Have we refunded/credit amount given for the exact quantity", "3.1 Are retool comments clear", "**4.1 Fatal", "**4.2 ZTP", "1.1 Reason", "1.2 Reason", "2.1 Reason", "2.2 Reason", "2.3 Reason", "2.4 Reason", "3.1 Reason", "4.1 Reason", "4.2 Reason", "Call Summary", "Feedback", "Agent_Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['contact_no'].'",';
			$row .= '"'.$user['chat_link'].'",';
			$row .= '"'.$user['audit_category'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['actual_dispo'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['ucp_score'].'%'.'",';
			$row .= '"'.$user['tna_score'].'%'.'",';
			$row .= '"'.$user['uwbd_score'].'%'.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['identify_image_validity'].'",';
			$row .= '"'.$user['actual_image_status'].'",';
			$row .= '"'.$user['was_call_required'].'",';
			$row .= '"'.$user['was_call_attempt'].'",';
			$row .= '"'.$user['POD_check_done'].'",';
			$row .= '"'.$user['credit_amount_given'].'",';
			$row .= '"'.$user['retool_comment_clear'].'",';
			$row .= '"'.$user['fatal'].'",';
			$row .= '"'.$user['ztp'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

///////////////// Superdaily Image Validation (NEW) //////////////////////
	public function create_qa_superdaily_imgval_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "TL/AM Name", "Call Date/Time", "Customer No", "Complaint ID", "Audit Category", "RCA", "Accurate RCA", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Understood customers problem", "Took necessary action to solve problem", "Customer understood what is being done", "Agent validated the image properly", "1.1 Reason", "Correct complaint status updated by the agent", "2.1 Reason", "Valid call attempts", "2.2 Reason", "Proof of delivery check done for QED and WOD", "2.3 Reason", "Refunded as per the SOP/exact amount", "2.4 Reason", "Guided the customer properly for the invalid and rejected complaints", "3.1 Reason", "If the call went unanswered notification sent to the customer", "3.2 Reason", "Accurate retool comments", "3.3 Reason", "Fatal", "4.1 Reason", "ZTP", "4.2 Reason", "ACPT", "WHY1", "WHY2", "Classify Audit", "Call Summary", "Feedback", "Agent_Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['contact_no'].'",';
			$row .= '"'.$user['complaint_id'].'",';
			$row .= '"'.$user['audit_category'].'",';
			$row .= '"'.$user['rca'].'",';
			$row .= '"'.$user['accurate_rca'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['ucp_score'].'%'.'",';
			$row .= '"'.$user['tna_score'].'%'.'",';
			$row .= '"'.$user['uwbd_score'].'%'.'",';
			$row .= '"'.$user['agent_validate_image'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'.$user['correct_complaint_status'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'.$user['valid_call_attempt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'.$user['delivary_check_proof'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'.$user['refunded_SOP'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'.$user['customer_guided_properly'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'.$user['call_notification_sent'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'.$user['acurate_retool_comment'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'.$user['fatal'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'.$user['ztp'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['why1'].'",';
			$row .= '"'.$user['why2'].'",';
			$row .= '"'.$user['classify_audit'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

///////////////// Superdaily Complaint Resolution //////////////////////
	public function create_qa_superdaily_reso_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "TL/AM Name", "Call Date/Time", "Customer No", "Complaint ID", "Audit Category", "RCA", "Accurate RCA", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Understood Customers Problem", "Took necessary action to solve problem", "Customer understood what is being done", "Was helpful to customer", "1.1 Interruption", "1.1 Reason", "1.2 Listening Comprehension", "1.2 Comment", "1.3 Asked necessary questions", "1.3 Reason", "1.4 Acknowledge where necessary", "1.4 Reason", "1.5 Personalization", "1.5 Reason", "2.1 Complaint created/Updated", "2.1 Reason", "2.2 Retool comments", "2.2 Reason", "2.3 Correct RCA updated", "2.3 Reason", "2.4 Correct Proof of delivery feedback", "2.4 Reason", "2.5 DE call attempt", "2.5 Reason", "2.6 Customer call attempt", "2.6 Reason", "2.7 Correct/complete information given", "2.7 Reason", "2.8 Correct Refund Processed", "2.8 Reason", "2.9 Possibility Customer calling back", "2.9 Reason", "3.1 Explained what is the current situation", "3.1 Reason", "3.2 Informed customer what we have now done", "3.2 Reason", "3.3 Spoke/chatted in a way that is understandable to the custome", "3.3 Reason", "3.4 Asked permission for hold/mute etc", "3.4 Reason", "4.1 Answered any other questions patiently", "4.1 Reason", "4.2 Asked for further assistance if relevant", "4.2 Reason", "4.3 Eager to wrap up call/chat", "4.3 Reason", "4.4 Polite", "4.4 Reason", "4.5 Empathetic", "4.5 Reason", "4.6 Tone", "4.6 Reason", "5.1 FATAL", "5.1 Reason", "5.2 ZTP", "5.2 Reason", "ACPT", "WHY1", "WHY2", "Classify Audit", "Call Summary", "Feedback", "Agent_Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['contact_no'].'",';
			$row .= '"'.$user['complaint_id'].'",';
			$row .= '"'.$user['audit_category'].'",';
			$row .= '"'.$user['rca'].'",';
			$row .= '"'.$user['accurate_rca'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['ucp_score'].'%'.'",';
			$row .= '"'.$user['tna_score'].'%'.'",';
			$row .= '"'.$user['cu_score'].'%'.'",';
			$row .= '"'.$user['hc_score'].'%'.'",';
			$row .= '"'.$user['interruption'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'.$user['listening_comprehension'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'.$user['asked_necessary_question'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'.$user['necessary_acknowledge'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'.$user['personalization'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'.$user['complaint_created'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'.$user['retool_comment'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'.$user['correct_RCA_update'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'.$user['proof_of_delivery'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'.$user['DE_call_attempt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'.$user['customer_call_attempt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'.$user['correct_information'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'.$user['correct_refund'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'.$user['cutomer_call_back'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'.$user['current_situation_explain'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'.$user['inform_customer_what_we_done'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'.$user['spoke_chatted'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'.$user['ask_hold_permission'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'.$user['answer_any_question'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'.$user['ask_further_assistance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
			$row .= '"'.$user['wrap_up_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
			$row .= '"'.$user['polite'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
			$row .= '"'.$user['emphathetic'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
			$row .= '"'.$user['tone'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
			$row .= '"'.$user['Fatal'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
			$row .= '"'.$user['ZTP'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['why1'].'",';
			$row .= '"'.$user['why2'].'",';
			$row .= '"'.$user['classify_audit'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

///////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Outsource Order ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////

	public function qa_outsource_order_report(){

		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_outsource_order_report.php";
			$data["content_js"] = "qa_outsource_order_js.php";

			$date_from="";
			$date_to="";
			$office_id="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';

			$data["qa_outsource_order_list"] = array();

			// if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			// }else{
			// 	$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			// }


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($office_id != "") $cond1 .= " and office_id='$office_id'";

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_outsource_order_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_outsource_order_list"] = $fullAray;
					$this->create_qa_outsource_order_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_outsource_order_new_CSV";
			}

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id'] = $office_id;

			$this->load->view('dashboard',$data);
		}
	}


///////////////////// MSB NEW ///////////////////////
	public function download_qa_outsource_order_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Outsource Order New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function headerDetails1(){
		return $arrayName = array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Id","Record ID","ANI Number","Customer Name","Audit Type","Auditor Type","VOC","Call Type","Overall Score","Greeting Statement","Item Description","Item Reservation Pricing and Payment Terms","Pop-Up and Promos","Additional Items","Closing Statement","Phone Number","Name","Address","E-Mail","Credit Card","Customer Rapport","Professional Telephone Etiquette","Pronunciation & Grammar","Call Control","Order Summary","One Call Resolution","Comments 1","Comments 2","Comments 3","Comments 4","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	public function create_qa_outsource_order_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header=$this->headerDetails1();
		$field_name="SHOW FULL COLUMNS FROM qa_outsource_order_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}


////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// Office Depot ////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
	public function qaod_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qaod_report.php";
			$data["content_js"] = "qa_od_js.php";

			$data["get_agent_id_list"] = $this->Qa_od_model->get_agent_id(42);
			$data['location_list'] = $this->Common_model->get_office_location_list();
			$lob="";
			$office_id = "";
			$agent_id="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$date_from=$this->input->get('date_from');
			$date_to=$this->input->get('date_to');
            $campaign = $this->input->get('process');
			if($date_from==""){
				$date_from=CurrDate();
			}else{
				$date_from = mmddyy2mysql($date_from);
			}

			if($date_to==""){
				$date_to=CurrDate();
			}else{
				$date_to = mmddyy2mysql($date_to);
			}

			$data["qa_od_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = $date_from;
				$date_to = $date_to;
				$office_id = $this->input->get('office_id');
				$agent_id = $this->input->get('agent_id');
				$audit_type = $this->input->get('audit_type');
				$lob = $this->input->get('lob');


				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($agent_id!="") $cond .=" and agent_id='$agent_id'";
				if($audit_type!="")	$cond .=" and audit_type='$audit_type'";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if($campaign=='od_voice'){
                 $qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_od_voice_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				} else if($campaign=='od_ecommerce'){
					$qSql="SELECT * from
				   (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				   (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				   (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				   (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				   (select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_od_ecommerce_feedback) xx Left Join
				   (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				} else if($campaign=='od_nps'){
					$qSql="SELECT * from
				   (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				   (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				   (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				   (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				   (select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_od_npsACPT_feedback) xx Left Join
				   (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				} else if($campaign=='chat'){
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_od_chat_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				} else if($campaign=='od_chat'){
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=(select assigned_to from signin where id=agent_id)) as tl_name from qa_od_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, batch_code, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note,agent_fd_acpt, date(entry_date) as agent_rvw_date from qa_od_agent_review) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_od_mgnt_review) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";
			    }else if($campaign=='od_nps_coaching'){
			    $qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_agent_coaching_office_depot_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
			    }

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_od_list"] = $fullAray;
				$this->create_qaod_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qaod_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['agent_id']=$agent_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_qaod_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Office Depot Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qaod_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "qa_od";

		$fopen = fopen($filename,"w+");

		if($campaign =='od_voice'){
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date","Call Duration","ANI","Reviewed By","Review Date", "Customer ID", "Session ID","LOB", "Disposition Category", "Disposition Sub Category", "Audit Type", "Workgroup","VOC","Audit Link", "Call Pass/Fail", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score",
		"Acknowledge the caller matched style and pace/put customer at ease","Remarks1","Check_list1-Acknowledge the caller matched style and pace/put customer at ease","Made the customer feel important and top priority","Remarks2","Appropriate and sincere use of empathy","Remarks3","Check_list2-Appropriate and sincere use of empathy","Customer clearly understood the CSR agent used proper English (no OD jargon)",	"Remarks4","CCP recognized Customer contacted us multiple times regarding the same issue and escalated to Supervisor/Team Lead as appropriate?","Remarks5","Verified line item quantity price total and delivery info AS NEEDED to place the order/return","Remarks6","Followed SOP/iDepot article and account level pop up box instructions while maintaining control of the call? ","Remarks7","Check_list3-Followed SOP/iDepot article and account level pop up box instructions while maintaining control of the call?","CCP noted appropriately? (Transaction History Special Instructions etc.)","Remarks8","Check_list4-CCP noted appropriately? Transaction History Special Instructions etc","Listened and paraphrased identified wants/needs and gained agreement by asking open-ended follow up questions.","Remarks9","Verified information as appropriate to the call proactively utilized CTI","Remarks10","Did the CCP submit the proper forms based on the resolution needed and summarize the resolutions steps? ","Remarks11","Was the proper dispostion code used on the call","Remarks12","Check_list5-Was the proper dispostion code used on the call","Please provide the type of call (Sales or Service)","Remarks13",
		"Compliance Score Percent","Customer Score Percent","Business Score Percent","Acknowledge RCAL1","Acknowledge RCAL2","Acknowledge RCAL3","Acknowledge RCAL Cmnt","Customer RCAL1","Customer RCAL2","Customer RCAL3","Customer RCAL Cmnt","Appropriate RCAL1","Appropriate RCAL2","Appropriate RCAL3","Appropriate RCAL Cmnt","Understood RCAL1","Understood RCAL2","Understood RCAL3","Understood RCAL Cmnt","Recognized RCAL1","Recognized RCAL2","Recognized RCAL3","Recognized RCAL Cmnt",
		"Verified RCAL1","Verified RCAL2","Verified RCAL3","Verified RCAL Cmnt","Idepot RCAL1","Idepot RCAL2","Idepot RCAL3","Idepot RCAL Cmnt","Appropriately RCAL1","Appropriately RCAL2","Appropriately RCAL3","Appropriately RCAL Cmnt","Paraphrased RCAL1","Paraphrased RCAL2","Paraphrased RCAL3","Paraphrased RCAL Cmnt","Information RCAL1","Information RCAL2","Information RCAL3","Information RCAL Cmnt","Submit RCAL1","Submit RCAL2","Submit RCAL3","Submit RCAL Cmnt","Dispostion RCAL1","Dispostion RCAL2","Dispostion RCAL3","Dispostion RCAL Cmnt","Please RCAL1","Please RCAL2","Please RCAL3","Please RCAL Cmnt",
		"Call Summary", "Feedback","Agent Review Status","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		}else if($campaign =='od_ecommerce'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date","Call Duration","ANI","Reviewed By","Review Date", "Customer ID", "Session ID","LOB", "Disposition Category", "Disposition Sub Category", "Audit Type", "Workgroup","VOC","Audit Link", "Call Pass/Fail", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score",
			"Acknowledged the caller match style and pace put customer at ease.","Remarks1","Properly identified customer and/or account.","Remarks2","Appropriate and sincere use of empathy.","Remarks3","Made the customer feel important and top priority.","Remarks4","Followed processing guidelines for ECOM/ODR.","Remarks5","Did agent utilize all available resources/Did agent escalate the issue appropriately?","Remarks6","CCP noted appropriately? Transaction History Special Instructions etc","Remarks7","Agent maintained control of the call (kept call on track).","Remarks8","Listened and paraphrased identified wants needs and gained agreement by asking open-ended follow up questions.","Remarks9","Verified information as appropriate to the call proactively utilized CTI.","Remarks10","Was the proper disposition code used on the call?","Remarks11",
			"Call Summary", "Feedback","Agent Review Status","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($campaign =='od_nps'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date","Call Duration","Survey Date", "Number of contacts", "Session ID","NPS Rating","NPS Type","Connect","Resolve","Make Easy", "Disposition Category", "Sub Category", "Audit Type", "VOC","Audit Link", "Customer Survey Comment", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", 
			"Customer pain point is at what phase in the Customer Journey?","Remarks1","Is it Controllable by Fusion?","Remarks2","Can the survey be turned to Promoter easily if someone calls back?","Remarks3","Level 1","Remarks4","Level 2","Remarks5",
			"Call Summary", "Feedback","Agent Review Status","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");	
        } else if($campaign =='chat') {
         $header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date","Call Duration","ANI","Reviewed By","Review Date", "Customer ID", "Session ID", "Disposition Category", "Disposition Sub Category", "Audit Type", "VOC", "Call Pass/Fail", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score",
		 "Acknowledge the caller matched style and pace/put customer at ease","Made the customer feel important and top priority","Appropriate and sincere use of empathy","Customer clearly understood the CSR agent used proper English (no OD jargon)","CCP recognized Customer contacted us multiple times regarding the same issue and escalated to Supervisor/Team Lead as appropriate?","Listened and paraphrased identified wants/needs and gained agreement by asking open-ended follow up questions.","Followed SOP/iDepot article and account level pop up box instructions?","CCP noted appropriately? (Transaction History Special Instructions etc.)","Agent maintained control of the chat (kept chat on track).","Verified information as appropriate to the call proactively utilized CTI","Did the CCP submit the proper forms based on the resolution needed and summarize the resolutions steps? ","Was the proper dispostion code used on the call","Please provide the type of call (Sales or Service)",
		 "Remarks1","Remarks2","Remarks3","Remarks4","Remarks5","Remarks6","Remarks7","Remarks8","Remarks9","Remarks10","Remarks11","Remarks12","Remarks13",
		 "Call Summary", "Feedback","Agent Review Status","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		} else if($campaign =='od_chat') {
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "WAVE", "Session ID/ANI", "Chat Date", "Customer ID", "Audit Type", "VOC","Audit Link", "Call Pass/Fail", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "Acknowledged the chat customer", "Made the customer feel important", "Appropriate and sincere use of empathy", "Customer clearly understood the CSR", "The CCP must ASK FOR THE SALE", "Read acknowledged and understood the customer", "Used proper guidelines followed account level", "Noted appropriately", "Agent maintained control of the chat", "Verified information as appropriate to the chat", "Was the offer micro-conversion accepted", "Was the proper disposition code used on the chat", "Call Summary", "Feedback","Agent Review Status","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
	   }else if($campaign =='od_nps_coaching'){
	   		$header = array("Auditor Name","Audit Date","Fusion ID", "Agent", "L1 Super","Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Audit Type","Auditor Type","VOC","Audit Link","callout_date","coaching_age","call_date","client_id","process_id","Session ID","NPS Score","NPS Comments","category1","sub_Category","RCA L1","RCA L2","Queue Name","Month","Tenurity","Controllable/Uncontrollable","RCA Details","Recommendation","Agent Review Status","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
	   }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			if($campaign =='od_voice'){
				$edit_url = "add_edit_od_voice";
		        $main_url =  $currentURL.''.$controller.'/'.$edit_url;
		        $main_urls = $main_url.'/'.$user['id'];
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['ani'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['review_date'].'",';
				$row .= '"'.$user['customer_id'].'",';
				$row .= '"'.$user['session_id'].'",';
				$row .= '"'.$user['lob'].'",';
				$row .= '"'.$user['disposition_cate'].'",';
				$row .= '"'.$user['disposition_sub_cate'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['workgroup'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['division_status'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['acknowledge_the_caller'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['check_list1'].'",';
				$row .= '"'.$user['made_the_customer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['appropriate_and_sincere'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['check_list2'].'",';
				$row .= '"'.$user['customer_clearly_understood'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['recognized_customer_contacted'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['verified_line_item'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['idepot_article_and'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['check_list3'].'",';
				$row .= '"'.$user['noted_appropriately'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['check_list4'].'",';
				$row .= '"'.$user['listened_and_paraphrased'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['verified_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['submit_the_proper_forms'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['proper_dispostion_code'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'.$user['check_list5'].'",';
				$row .= '"'.$user['please_provide_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'.$user['acknowledge_rcal1'].'",';
				$row .= '"'.$user['acknowledge_rcal2'].'",';
				$row .= '"'.$user['acknowledge_rcal3'].'",';
				$row .= '"'.$user['acknowledge_rcal_cmt'].'",';
				$row .= '"'.$user['customer_rcal1'].'",';
				$row .= '"'.$user['customer_rcal2'].'",';
				$row .= '"'.$user['customer_rcal3'].'",';
				$row .= '"'.$user['customer_rcal_cmt'].'",';
				$row .= '"'.$user['appropriate_rcal1'].'",';
				$row .= '"'.$user['appropriate_rcal2'].'",';
				$row .= '"'.$user['appropriate_rcal3'].'",';
				$row .= '"'.$user['appropriate_rcal_cmt'].'",';
				$row .= '"'.$user['understood_rcal1'].'",';
				$row .= '"'.$user['understood_rcal2'].'",';
				$row .= '"'.$user['understood_rcal3'].'",';
				$row .= '"'.$user['understood_rcal_cmt'].'",';
				$row .= '"'.$user['recognized_rcal1'].'",';
				$row .= '"'.$user['recognized_rcal2'].'",';
				$row .= '"'.$user['recognized_rcal3'].'",';
				$row .= '"'.$user['recognized_rcal_cmt'].'",';
				$row .= '"'.$user['verified_rcal1'].'",';
				$row .= '"'.$user['verified_rcal2'].'",';
				$row .= '"'.$user['verified_rcal3'].'",';
				$row .= '"'.$user['verified_rcal_cmt'].'",';
				$row .= '"'.$user['idepot_rcal1'].'",';
				$row .= '"'.$user['idepot_rcal2'].'",';
				$row .= '"'.$user['idepot_rcal3'].'",';
				$row .= '"'.$user['idepot_rcal_cmt'].'",';
				$row .= '"'.$user['appropriately_rcal1'].'",';
				$row .= '"'.$user['appropriately_rcal2'].'",';
				$row .= '"'.$user['appropriately_rcal3'].'",';
				$row .= '"'.$user['appropriately_rcal_cmt'].'",';
				$row .= '"'.$user['paraphrased_rcal1'].'",';
				$row .= '"'.$user['paraphrased_rcal2'].'",';
				$row .= '"'.$user['paraphrased_rcal3'].'",';
				$row .= '"'.$user['paraphrased_rcal_cmt'].'",';
				$row .= '"'.$user['information_rcal1'].'",';
				$row .= '"'.$user['information_rcal2'].'",';
				$row .= '"'.$user['information_rcal3'].'",';
				$row .= '"'.$user['information_rcal_cmt'].'",';
				$row .= '"'.$user['submit_rcal1'].'",';
				$row .= '"'.$user['submit_rcal2'].'",';
				$row .= '"'.$user['submit_rcal3'].'",';
				$row .= '"'.$user['submit_rcal_cmt'].'",';
				$row .= '"'.$user['dispostion_rcal1'].'",';
				$row .= '"'.$user['dispostion_rcal2'].'",';
				$row .= '"'.$user['dispostion_rcal3'].'",';
				$row .= '"'.$user['dispostion_rcal_cmt'].'",';
				$row .= '"'.$user['please_rcal1'].'",';
				$row .= '"'.$user['please_rcal2'].'",';
				$row .= '"'.$user['please_rcal3'].'",';
				$row .= '"'.$user['please_rcal_cmt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			}else if($campaign == 'od_ecommerce'){
				$edit_url = "add_edit_od_ecommerce";
		        $main_url =  $currentURL.''.$controller.'/'.$edit_url;
		        $main_urls = $main_url.'/'.$user['id'];
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['ani'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['review_date'].'",';
				$row .= '"'.$user['customer_id'].'",';
				$row .= '"'.$user['session_id'].'",';
				$row .= '"'.$user['lob'].'",';
				$row .= '"'.$user['disposition_cate'].'",';
				$row .= '"'.$user['disposition_sub_cate'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['workgroup'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['division_status'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['acknowledge_the_caller'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['made_the_customer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['appropriate_and_sincere'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['customer_clearly_understood'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['recognized_customer_contacted'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['verified_line_item'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['idepot_article_and'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['noted_appropriately'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['listened_and_paraphrased'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['verified_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['submit_the_proper_forms'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			
			}else if($campaign == 'od_nps'){
				$edit_url = "add_edit_od_npsACPT";
		        $main_url =  $currentURL.''.$controller.'/'.$edit_url;
		        $main_urls = $main_url.'/'.$user['id'];
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['review_date'].'",';
				$row .= '"'.$user['contacts'].'",';
				$row .= '"'.$user['session_id'].'",';
				$row .= '"'.$user['nps_rating'].'",';
				$row .= '"'.$user['nps_type'].'",';
				$row .= '"'.$user['connect'].'",';
				$row .= '"'.$user['resolve'].'",';
				$row .= '"'.$user['make_easy'].'",';
				$row .= '"'.$user['disposition_cate'].'",';
				$row .= '"'.$user['sub_cate'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['customer_survey'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['customer_journey'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['controllable'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['call_servey'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['level1'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['level2'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';	

			}else if($campaign == 'chat') {
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['ani'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['review_date'].'",';
				$row .= '"'.$user['customer_id'].'",';
				$row .= '"'.$user['session_id'].'",';
				$row .= '"'.$user['disposition_cate'].'",';
				$row .= '"'.$user['disposition_sub_cate'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['division_status'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['acknowledge_the_caller'].'",';
				$row .= '"'.$user['made_the_customer'].'",';
				$row .= '"'.$user['appropriate_and_sincere'].'",';
				$row .= '"'.$user['customer_clearly_understood'].'",';
				$row .= '"'.$user['recognized_customer_contacted'].'",';
				$row .= '"'.$user['verified_line_item'].'",';
				$row .= '"'.$user['idepot_article_and'].'",';
				$row .= '"'.$user['noted_appropriately'].'",';
				$row .= '"'.$user['listened_and_paraphrased'].'",';
				$row .= '"'.$user['verified_information'].'",';
				$row .= '"'.$user['submit_the_proper_forms'].'",';
				$row .= '"'.$user['proper_dispostion_code'].'",';
				$row .= '"'.$user['please_provide_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

		    }else if($campaign =='od_chat') {
		    	$edit_url = "add_edit_od_chat";
		        $main_url =  $currentURL.''.$controller.'/'.$edit_url;
		        $main_urls = $main_url.'/'.$user['id'];
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['batch_code'].'",';
				$row .= '"'.$user['ani'].'",';
				$row .= '"'.$user['chat_date'].'",';
				$row .= '"'.$user['customer_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['call_pass_fail'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['ack_chat_cust'].'",';
				$row .= '"'.$user['made_cust_feel_imp'].'",';
				$row .= '"'.$user['appro_sin_empathy'].'",';
				$row .= '"'.$user['cust_clr_understood_crs'].'",';
				$row .= '"'.$user['ccp_ask_sale'].'",';
				$row .= '"'.$user['read_ack_understood_cust'].'",';
				$row .= '"'.$user['used_proper_guidelines'].'",';
				$row .= '"'.$user['noted_appropriately'].'",';
				$row .= '"'.$user['agent_maintained_control_chat'].'",';
				$row .= '"'.$user['verified_info_appropriate_chat'].'",';
				$row .= '"'.$user['was_the_offer'].'",';
				$row .= '"'.$user['was_the_proper_dispo'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';
		    }else if($campaign =='od_nps_coaching'){
		    	$controller = "Qa_agent_coaching_upload";
		    	$edit_url = "mgnt_coaching_feedback_rvw";
		        $main_url =  $currentURL.''.$controller.'/'.$edit_url;
		        $main_urls = $main_url.'/'.$user['id'];
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['callout_date'].'",';
				$row .= '"'.$user['coaching_age'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['client_id'].'",';
				$row .= '"'.$user['process_id'].'",';
				$row .= '"'.$user['session_id'].'",';
				$row .= '"'.$user['nps_score'].'",';
				$row .= '"'.$user['nps_comment'].'",';
				$row .= '"'.$user['category1'].'",';
				$row .= '"'.$user['sub_Category'].'",';
				$row .= '"'.$user['rca_level1'].'",';
				$row .= '"'.$user['rca_level2'].'",';
				$row .= '"'.$user['queue_name'].'",';
				$row .= '"'.$user['month'].'",';
				$row .= '"'.$user['tenuarity'].'",';
				$row .= '"'.$user['controllable_uncontrollable'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['rca_details'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['recommendation'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';	

		    }
			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////// QA NOVASOM REPORT /////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_novasom_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_novasom_report.php";

			$office_id = $this->input->get('office_id');
			if($office_id=="")  $office_id=$user_office_id;

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign=$this->input->get('campaign');

			$data["qa_novasom_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($audit_type=="All") $cond .= "";
				else $cond .=" and audit_type='$audit_type'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else if(get_login_type()=="client"){
					$cond1 .=" And audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond1 .="";
				}

				if($campaign=='bioserenity'){
				$qSql = "SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name
					from qa_bioserenity_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($campaign=='novasom'){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, DATE_FORMAT(entry_date,'%m-%Y') AS m_Y from qa_novasom_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_novasom_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_novasom_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";
				}

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_novasom_list"] = $fullAray;
				$this->create_qa_novasom_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_novasom_CSV/".$campaign;

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['campaign']=$campaign;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_qa_novasom_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_novasom_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_novasom";

		$fopen = fopen($filename,"w+");

		if($campaign=='novasom'){
			$header = array("Auditor Name","Audit Date","Agent","Customer Name","Order Number","Evaluation Date","Audit Type","VOC","Earned Score","Total Score","Incorrect entry/Did not add patient's phone # alternate phone #s employment phone #/work phone #/emergency contact #","Incorrect entry/Did not add patient's street address apartment # city state and zip code","Incorrect entry of patient's first and last name","Incorrect entry of patient's date of birth","Incorrect entry of patient's gender","Incorrect entry of patient's language","Failure to update physician status in their profile (from pending to active)","Wrong physician selected","Did not update physicians practice address phone # and fax #/wrong physician's office selected","Order was flagged for Missing Physician even if the physician was in the attachment","DME not entered/DME fax number selected did not match on the order form","Wrong order type selected/did not update order type","Placed the order into Sales Follow-up but the order wasnt missing anything","Failure to uncheck Missing Info after attaching MR (MI)","Attached medical records/keyed in an order that includes MR but did not flag order for MR review (did not check off Medical Record for Internal Review) even if theres form error Medical Records Needed from Dr","Did not flag the order for attestation (did not check off Accept Medical Judgment or did not check off Missing Physician Signed order)","Accepted attestation/Checked off Accept Medical Judgment on an unsigned order form","Order was placed into Sales Follow-up even if the missing info such as insurance info address etc are found on the previous order","Unable to add available symptoms/diagnosis","Epworth score was not added","Failure to add needed ICD 10 code","Incorrect entry of patient's height and weight","Did not select No for CPAP and No for Oxygen even if its indicated on the attachment","Unable to add/update insurance info to the order","Insurance info was added but order was not marked for Insurance Verification","Order was flagged for Insurance Verification. Failed to uncheck Needs Insurance Verification when theres missing insurance info","Failure to mark of Offer Cash Price for Self-Pay order","Failure to uncheck Needs Insurance Verification for Self-Pay order","Did not add secondary insurance info","Unchecked Needs Insurance Verification even if the order has never got verified for insurance","Referral flag was removed when it should not have been","Changed the insurance info even if the insurance is already verified e.g. changed the carrier name and subscriber id #","Failure to send physician fax confirmation","Wrong fax attachment disposition","Wrong attachment to order belonging to another patient","Creation of duplicate order","Creation of new order for a patient but the attached order form is for a different patient","New referral attached to old order but did not key in new order","HIPAA violation  rep mistakenly fax document to incorrect physician or practice address","Failure to attach the records/documents needed for each order worked out","Failure to save the orders in the Shared Drive","Putting faxes on non-order but not working on it","Unworked assigned pods that are 3 days old","Cherry picking/Processing on faxes with unapproved receiving date","Putting notes on the order that refaxing was done but none was actually faxed","Call Summary","Feedback","Agent Review Date","Agent Note","Management Review Date","Management Name","Management Note");
		}else if($campaign=='bioserenity'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "TL Name", "Customer Name", "Order Number", "Evaluation Date", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Earned Score", "Possible Score", "Total Score", "1)PATIENT INFORMATION", "Q1 - Comment1", "Q1 - Comment2", "Q1 - Comment3", "Q1 - Comment4", "Q1 - Comment5", "Q1 - Comment6", "Q1 - Comment7", "2)PHYSICIAN", "Q2 - Comment1", "Q2 - Comment2", "Q2 - Comment3", "Q2 - Comment4", "Q2 - Comment5", "Q2 - Comment6", "3)ORDER INFORMATION", "Q3 - Comment1", "Q3 - Comment2", "Q3 - Comment3", "Q3 - Comment4", "Q3 - Comment5", "Q3 - Comment6", "Q3 - Comment7", "Q3 - Comment8", "4)DIAGNOSTIC", "Q4 - Comment1", "Q4 - Comment2", "Q4 - Comment3", "Q4 - Comment4", "Q4 - Comment5", "Q4 - Comment6", "5)INSURANCE", "Q5 - Comment1", "Q5 - Comment2", "Q5 - Comment3", "Q5 - Comment4", "Q5 - Comment5", "Q5 - Comment6", "Q5 - Comment7", "Q5 - Comment8", "Q5 - Comment9", "6)ORDER HISTORY", "Q6 - Comment", "7)ATTACHMENT", "Q7 - Comment1", "Q7 - Comment2", "8)ORDER CREATION", "Q8 - Comment1", "Q8 - Comment2", "Q8 - Comment3", "** 9)MAJOR ERRORS", "Q9 - Comment1", "Q9 - Comment2", "Q9 - Comment3", "Q9 - Comment4", "Q9 - Comment5", "Q9 - Comment6", "Q9 - Comment7", "Q9 - Comment8", "Call Summary", "Feedback", "Agent Review Date", "Agent Note", "Management Rerview By", "Management Review Date", "Management Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row	=	"";

		if($campaign=='novasom'){

			foreach($rr as $user){
				$row .= '"'.$user["auditor_name"].'",';
				$row .= '"'.$user["audit_date"].'",';
				$row .= '"'.$user["fname"]." ".$user["lname"].'",';
				$row .= '"'.$user["customer_name"].'",';
				$row .= '"'.$user["order_number"].'",';
				$row .= '"'.$user["evaluation_date"].'",';
				$row .= '"'.$user["audit_type"].'",';
				$row .= '"'.$user["voc"].'",';
				$row .= '"'.$user["earned_score"].'",';
				$row .= '"'.$user["overall_score"].'",';
				$row .= '"'.$user["incorrect_entry_contact"].'",';
				$row .= '"'.$user["incorrect_entry_address"].'",';
				$row .= '"'.$user["incorrect_entry_name"].'",';
				$row .= '"'.$user["incorrect_entry_dob"].'",';
				$row .= '"'.$user["incorrect_entry_gender"].'",';
				$row .= '"'.$user["incorrect_entry_lang"].'",';
				$row .= '"'.$user["physician_update"].'",';
				$row .= '"'.$user["wrong_physician"].'",';
				$row .= '"'.$user["physician_address"].'",';
				$row .= '"'.$user["physician_attachment"].'",';
				$row .= '"'.$user["dme_fax_mismatch"].'",';
				$row .= '"'.$user["wrong_order_type"].'",';
				$row .= '"'.$user["order_was_not_missing"].'",';
				$row .= '"'.$user["failure_uncheck"].'",';
				$row .= '"'.$user["mr_flag"].'",';
				$row .= '"'.$user["did_not_flag_attestation"].'",';
				$row .= '"'.$user["attestation_accepted"].'",';
				$row .= '"'.$user["placed_order_missing_info"].'",';
				$row .= '"'.$user["unable_to_add_symptom"].'",';
				$row .= '"'.$user["epworth_score"].'",';
				$row .= '"'.$user["failure_to_add_icd"].'",';
				$row .= '"'.$user["incorrect_entry_height_weight"].'",';
				$row .= '"'.$user["no_cpap_oxygen"].'",';
				$row .= '"'.$user["unable_to_update_insurance"].'",';
				$row .= '"'.$user["insurance_not_marked"].'",';
				$row .= '"'.$user["insurance_uncheck"].'",';
				$row .= '"'.$user["failure_self_pay"].'",';
				$row .= '"'.$user["self_pay_uncheck"].'",';
				$row .= '"'.$user["secondary_insurance"].'",';
				$row .= '"'.$user["uncheck_insurance_verification"].'",';
				$row .= '"'.$user["referral_flag_removed"].'",';
				$row .= '"'.$user["changed_verified_insurance_info"].'",';
				$row .= '"'.$user["confirm_fax_failure_physician"].'",';
				$row .= '"'.$user["wrong_fax_disposition"].'",';
				$row .= '"'.$user["wrong_attachment_another_patient"].'",';
				$row .= '"'.$user["creation_duplicate_order"].'",';
				$row .= '"'.$user["wrong_attachment_different_patient"].'",';
				$row .= '"'.$user["new_referrel_to_old_order"].'",';
				$row .= '"'.$user["hipaa_violation"].'",';
				$row .= '"'.$user["failure_to_attach_workout"].'",';
				$row .= '"'.$user["failure_to_save_shared_drive"].'",';
				$row .= '"'.$user["putting_faxes_not_working"].'",';
				$row .= '"'.$user["unworked_assigned_three_days_old"].'",';
				$row .= '"'.$user["cherry_picking_unapproved_date"].'",';
				$row .= '"'.$user["refaxing"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';
				fwrite($fopen,$row."\r\n");
				$row	=	"";
			}
			fclose($fopen);

		}else if($campaign=='bioserenity'){
		$edit_url = "add_edit_bioserenity";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row .= '"'.$user["auditor_name"].'",';
				$row .= '"'.$user["audit_date"].'",';
				$row .= '"'.$user["fusion_id"].'",';
				$row .= '"'.$user["fname"]." ".$user["lname"].'",';
				$row .= '"'.$user["tl_name"].'",';
				$row .= '"'.$user["customer_name"].'",';
				$row .= '"'.$user["order_number"].'",';
				$row .= '"'.$user["call_date"].'",';
				$row .= '"'.$user["audit_type"].'",';
				$row .= '"'.$user["voc"].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user["earned_score"].'",';
				$row .= '"'.$user["possible_score"].'",';
				$row .= '"'.$user["overall_score"].'%'.'",';
				$row .= '"'.$user["patient_information"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user["physician"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user["order_information"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'.$user["diagnostic"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'.$user["insurance"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt35'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt36'])).'",';
				$row .= '"'.$user["order_history"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt37'])).'",';
				$row .= '"'.$user["attachment"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt38'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt39'])).'",';
				$row .= '"'.$user["order_creation"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt40'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt41'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt42'])).'",';
				$row .= '"'.$user["major_errors"].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt43'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt44'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt45'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt46'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt47'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt48'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt49'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt50'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
				$row	=	"";
			}
			fclose($fopen);

		}

	}



////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////// QA MSB REPORT /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

	public function getval($arrs, $k) {
    foreach($arrs as $key=>$val) {
        if( $key === $k ) {
            return $val;
        }
        else {
            if(is_array($val)) {
                $ret = $this->getval($val, $k);
                if($ret !== NULL) {
                    return $ret;
                }
            }
        }
    }
    return NULL;
	}


	public function qa_msb_report(){

		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_msb_report.php";

			$date_from="";
			$date_to="";
			$office_id="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';

			$data["qa_msb_list"] = array();

			if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			}else{
				$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			}


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($office_id != "") $cond1 .= " and office_id='$office_id'";

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_msb_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_msb_list"] = $fullAray;
					// $header_arr=$this->Common_model->get_query_result_array("SELECT column_comment FROM information_schema.COLUMNS WHERE table_name = 'qa_msb_feedback'");
					// $cnt=count($header_arr);

					//  for($i=0;$i<$cnt;$i++){
					// 	$val=$this->getval($header_arr[$i],'column_comment');
					// 	if($val!=""){
					// 		$header[]=$val;
					// 	}
					//  }
					// array_unshift($header ,"Auditor Name");
					// $key = array_search ('Agent', $header);
					// array_splice($header, $key, 0, 'Fusion Id');
					// print_r($header);
					// die;
					$this->create_qa_msb_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_msb_new_CSV";
			}

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id'] = $office_id;

			$this->load->view('dashboard',$data);
		}
	}


// /////////////////// MSB NEW /////////////////////
	public function download_qa_msb_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA MSB New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_msb_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header=array ( "Auditor Name ","Audit Date ","Fusion Id ","Agent ","L1 Super ","Phone ","Call Date ","Call Duration ","ACPT ","ACPT Option ","ACPT Others ","QA Type ","Audit Type ","Auditor Type ","VOC ","Client Name ","Overall Score ","Identify himself/herself by first and last name at the beginning of the call? **SQ** ","Provide the Quality Assurance Statement verbatim before any specific account information was discussed?**SQ** ","State 'MSB Financial' with no deviation? **SQ** ","Verify that he/she was speaking to a right party according to the client requirements (First and Last Name) and before providing the disclosures? ","Verify one/two pieces of demographics information on an outbound call ","Provide the Mini Miranda disclosure verbatim ","State the client name and the purpose of the communication? ","Sate/Ask for balance due? ","Opening Score ","Full and Complete information taken? ","Ask for the payment over the phone? ","Ask for a post dated payment (except for the states MA or RI)? ","Followed the previous conversations on the account for the follow-up call ","Able to take a promise to pay on the account? ","Effort Score ","Offer to split the balance in part? ","Offer a one/three/lump sum settlement appropriately? ","Offer a payment plan with significant down payment? ","Did Collector follow proper negotiation sequence to provide settelment options? ","Did Collector try to negotiate effectively to convince the customer for payment? ","Offer a small good faith payment? ","Negotiation Score ","Did not Misrepresent their identity or authorization and status of the consumer's account? ","Did not Discuss or imply that any type of legal actions ","Did not Make any false representations regarding the nature of the communication? ","Did not Contact the consumer at any unusual times (sate regulations) or outside the hours of 8:00 am and 9:00 pm at the consumer's location? ","Did not Communicate with the consumer at work if it is known or there is reason to know that such calls are prohibited? ","Did not Communicate with the consumer after learning the consumer is represented by an attorney ","Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers via cell phone email and fax? ","Adhere to policy regarding third parties for the sole purpose of obtaining location information for the consumer? ","Enter Status code/disposition codes correctly to ensure that inappropriate dialing does not take place? ","Did not Make any statement that could constitute unfair ","Did not Communicate or threaten to communicate false credit information or information which should be known to be false and utilized the proper CBR script whenever a consumer enquires about that? ","Handle the consumer's dispute correctly and take appropriate action including providing the consumer with the correct contact information to submit a written dispute or complaint ","Did not Make the required statement on time barred accounts ","Adhere to FDCPA laws? ","Did not Make any statement that could be considered discriminatory towards a consumer? ","Did collector stated state compliance disclosures (ex. OOS) ","Did the collectors adhere to the State Restrictions? ","Compliance Score ","Confirm with consumer if he/she is the authorized user of the debit or credit card / checking account? ","Recap the call by verifying consumer's Name ","Stated the proper payment script before processing payment? ","Advise of the payment processing fee before the payment was taken ","Obtain permission from the consumer to initiate electronic credit /debit card transactions or through checking account and get supervisor verification if needed?**SQ** ","Educate the consumer about correspondence being sent (Receipts ","Provide the consumer with the confirmation code? ","Payment Script Score ","Demonstrate Active Listening? ","Represent the company and the client in a positive manner? ","Anticipate and overcome objections? ","Call Control Score ","Summarize the call? ","Provide our Toll free number ","Set appropriate timelines and expectations for follow up? ","Did collector follow proper hold and transfer procedure? ","Close the call Professionally? ","Closing Score ","Use the proper action code? ","Use the proper result code? ","Document thoroughly the context of the conversation? ","Remove any phone numbers known to be incorrect?**SQ** ","Update address information ","Change the status of the account ","Escalate the account to a supervisor for handling if appropriate?/ Escalate the account to a supervisor for handling if appropriate? ","Documentation Score ","Call Summary ","Feedback ","Entry By ","Entry Date ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
		$field_name="SHOW FULL COLUMNS FROM qa_msb_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}


	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA Metropolis REPORT //////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_metropolis_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_metropolis_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_metropolis_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select disposition from qa_metropolis_disposition as agntdisp where agntdisp.id=agent_dispo) as agentDispo, (select disposition from qa_metropolis_disposition as actldisp where actldisp.id=actual_dispo) as actualDispo from qa_metropolis_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_metropolis_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_metropolis_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_metropolis_list"] = $fullAray;
				$this->create_qa_metropolis_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_metropolis_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_metropolis_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Metropolis Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_metropolis_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time", "Call Duration", "Phone", "Campaign", "Audit Type", "VOC", "Agent Disposition", "Actual Disposition", "Customer Voice", "Welcome the Customer", "Know the Customer", "Effective Communication", "Building Rapport", "Maintain Courtesy", "Probing Assistance", "Significance of Information", "Action for Solution", "Proper Documentation", "ZTP", "Welcome the Customer Comment", "Know the Customer Comment", "Effective Communication Comment", "Building Rapport Comment", "Maintain Courtesy Comment", "Probing Assistance Comment", "Significance of Information Comment", "Action for Solution Comment", "Proper Documentation Comment", "ZTP Comment", "Overall Score", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['welcome_customer']==5) $welcome_customer='100%';
			else $welcome_customer='0%';

			if($user['know_customer']==5) $know_customer='100%';
			else $know_customer='0%';

			if($user['effective_communication']==10) $effective_communication='100%';
			else $effective_communication='0%';

			if($user['building_rapport']==15) $building_rapport='100%';
			else $building_rapport='0%';

			if($user['maintain_courtesy']==10) $maintain_courtesy='100%';
			else $maintain_courtesy='0%';

			if($user['probing_assistance']==10) $probing_assistance='100%';
			else $probing_assistance='0%';

			if($user['significance_info']==20) $significance_info='100%';
			else $significance_info='0%';

			if($user['action_solution']==15) $action_solution='100%';
			else $action_solution='0%';

			if($user['proper_docu']==10) $proper_docu='100%';
			else $proper_docu='0%';


			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date_time'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['agentDispo'].'",';
			$row .= '"'.$user['actualDispo'].'",';
			$row .= '"'.$user['customer_voice'].'",';
			$row .= '"'.$welcome_customer.'",';
			$row .= '"'.$know_customer.'",';
			$row .= '"'.$effective_communication.'",';
			$row .= '"'.$building_rapport.'",';
			$row .= '"'.$maintain_courtesy.'",';
			$row .= '"'.$probing_assistance.'",';
			$row .= '"'.$significance_info.'",';
			$row .= '"'.$action_solution.'",';
			$row .= '"'.$proper_docu.'",';
			$row .= '"'.$user['zero_tolerance'].'",';
			$row .= '"'.$user['welcome_customer_comment'].'",';
			$row .= '"'.$user['know_customer_comment'].'",';
			$row .= '"'.$user['effective_communi_comment'].'",';
			$row .= '"'.$user['building_rapport_comment'].'",';
			$row .= '"'.$user['maintain_curtsey_comment'].'",';
			$row .= '"'.$user['probing_assistance_comment'].'",';
			$row .= '"'.$user['significance_info_comment'].'",';
			$row .= '"'.$user['action_solution_comment'].'",';
			$row .= '"'.$user['proper_docu_comment'].'",';
			$row .= '"'.$user['zero_tolerance_comment'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// QA MEESHO REPORT ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_meesho_report(){
		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_meesho_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond='';
			$cond1='';
			$camp_cond='';

			$pValue = $this->input->get('process_id');
			$data['pValue']=$pValue;

			$data["qa_meesho_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (date(audit_date) >= '$date_from' and date(audit_date) <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All") $cond .= "";
				else $cond .=" and audit_type='$audit_type'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else if(get_login_type()=="client"){
					$cond1 .=" And audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond1 .="";
				}

				if($pValue=='Inbound'){
					$camp_cond='qa_meesho_inbound_feedback';
				}else if($pValue=='Supplier_Support_new'){
					$camp_cond='qa_meesho_supplier_support_feedback';
				}else if($pValue=='Supplier_Support'){
					$camp_cond='qa_meesho_supplier_feedback';
				}else if($pValue=='Supplier_Support_CMB'){
					$camp_cond='qa_meesho_supplier_cmb_feedback';
				}else if($pValue=='Supplier_Support_Onboarding'){
					$camp_cond='qa_meesho_supplier_onboarding_feedback';
				}else if($pValue=='Email'){
					$camp_cond='qa_meesho_email_feedback';
				}else if($pValue=='Pop Shop'){
					$camp_cond='qa_meesho_popshop_feedback';
				}else if($pValue=='Pop Shop Email'){
					$camp_cond='qa_meesho_popshop_email_feedback';
				}

				$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select email_id_off from info_personal ip where ip.user_id=entry_by) as auditor_email,
				(select email_id from signin_client sce where sce.id=client_entryby) as client_email,
				(select email_id_off from info_personal ips where ips.user_id=agent_id) as agent_email,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from $camp_cond) xx Left Join
				(Select id as sid, concat(fname, ' ', lname) as agent_name, fusion_id, doj, office_id, assigned_to, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 ";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_meesho_list"] = $fullAray;
				$this->create_qa_meesho_CSV($fullAray,$pValue);
				$dn_link = base_url()."reports_qa/download_qa_meesho_CSV/".$pValue;

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_meesho_CSV($pid)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Meesho ".$pid." List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_meesho_CSV($rr,$pid)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($pid=='Inbound'){
			$header = array("Auditor Name", "Auditor Email", "Audit Date/Time", "Agent Name", "L1 Super", "Tenure", "Agent Status", "Record No", "Order No", "Phone", "Campaign", "Audit Center", "Agent Center", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Language", "Recording ID", "Call Date/Time",  "Week", "Contact Audit", "Satisfaction QA Rating", "AHT in secs", "Agent Disposition", "Correct Disposition", "Call Opening", "Call Opening Comment", "Identification", "Identification Comment", "Security Check", "Security Check Comment", "Hold Procedure", "Hold Procedure Comment", "Closing Script", "Closing Script Comment", "Active Listening", "Active Listening Comment", "Effective Probing", "Effective Probing Comment", "Accurate Resolution Process", "Accurate Resolution Process Comment", "Politeness Courtesy", "Politeness Courtesy Comment", "Apology Empathy", "Apology Empathy Comment", "Enthusiasm", "Enthusiasm Comment", "CRM accuracy", "CRM accuracy Comment", "Additional Info", "Additional Info Comment", "Total Score", "AHT Duration Reduction", "Will this Lead to Repeat Call for same Order", "ZTP", "Voice of customer any", "Resolution Requires an outbound call", "Call Summary", "Feedback", "Satisfaction level of the customer with resolution", "Will the customer call for the same issue again ?", "What would be the reason for repeat ?", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Commnet", "Client Review Date");
		}else if($pid=='Email'){
			$header = array("Auditor Name", "Auditor Email", "Audit Date", "Agent Name", "L1 Super", "Tenure", "Agent Status", "Order No", "Phone", "Campaign", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Language", "Email Date/Time", "Week", "Audit Center", "Agent Center", "Contact Audit", "ZD Ticket ID", "Satisfaction rating", "Agent Disposition", "Correct Disposition", "ZTP", "Opening Personalization", "Opening Personalization Comment", "Validation Customer info", "Validation Customer info Comment", "Acknowledge Assure", "Acknowledge Assure Comment", "Effective Probing", "Effective Probing Comment", "Accurate Resolution", "Accurate Resolution Comment", "Managed delayed with grace", "Managed delayed with grace Comment", "Provided Additional Info", "Provided Additional Info Comment", "Used Templates correctly", "Used Templates correctly Comment", "Used Customization Templates", "Used Customization Templates Comment", "Use Correct Spelling", "Use Correct Spelling Comment", "CRM accuracy", "CRM accuracy Comment", "Closing Statement", "Closing Statement Comment", "Total Score", "Voice of Customer any", "Resolution Requires an outbound call", "Call Summary", "Feedback", "Satisfaction level of the customer with resolution", "Will the customer call for the same issue again ?", "What would be the reason for repeat ?", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Commnet", "Client Review Date");
		}else if($pid=='Supplier_Support'){
			$header = array("Edit Audits", "QA name", "Process", "Agent Name", "TL Name", "Agent Status", "Tenurity", "Quality Score", "PreFatal Score", "Fatal", "Week", "Audit Center", "Agent Center", "Audit Date", "Employee ID", "Email Address", "Type of Contact Audit", "Email Date & Time", "Ticket ID", "Agent Selected Disposition", "Correct Disposition", "Call Summary", "Score", "Mobile No", "Language", "Order No", "Q1- Opening/Personalization", "Q1- Remarks", "Q2- Validation of customer information", "Q2- Reamarks", "Q3- Acknowledge", "Q3- Remarks", "Q4- Effecting Probing", "Q4- Remarks", "Q5- Accurate Resolution", "Q5- Remarks", "Q6- Managed delays with grace", "Q6- Remarks", "Q7- Provided self help", "Q7- Remarks", "Q8- Leverage System Tools", "Q8- Remarks", "Q9- Accurate Follow up", "Q9- Remarks", "Q10- Use correct spelling", "Q10- Remarks", "Q11- CRM accuracy", "Q11- Remarks", "Q12- Closing Statement", "Q12- Remarks", "Q13- Professionalism", "Q13- Remarks", "Voice of customer any", "Resolution Requires an outbound call", "Satisfaction level of the customer", "Will the customer call for the same issue again ?", "Remarks yes for repeat call", "What would be the reason for repeat ?", "ACPT", "L2", "L3", "L4", "Edit Audit", "Blank", "Blank", "Blank", "Blank", "Audit Date", "Tenurity(Date of certification)", "Tenure Days", "Fatal Count", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Commnet", "Client Review Date", "Record No", "FCR", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Feedback");
		}else if($pid=='Supplier_Support_new'){
			$header = array("Edit Links", "QA name", "Agent Name", "TL Name", "Agent Status", "Tenure", "Quality Score", "PreFatal Score", "Fatals", "Week", "Audit Center", "Agent Center", "Audit Date", "Email Address", "Score", "Type of Contact Audit", "Employee ID of Agent", "Agent Select Disposition", "Correct Disposition", "Ticket ID", "Email Date & Time", "Order ID", "Satisfaction rating", "Q1 - Opening /Personalization(5)", "Q1- Remarks", "Q2 - Validation of customer information(5)", "Q2- Reamarks", "Q3 - Acknowledge Align & Assure(5)", "Q3- Remarks", "Q4 - Effective Probing(5)", "Q4- Remarks", "Q5 - Accurate Resolution(F)(10)", "Q5- Remarks", "Q6 - Managed delays with grace(5)", "Q6- Remarks", "Q7 - Additional information provided/ Self help(10)", "Q7- Remarks", "Q8 - Used templates correctly(F)(10)", "Q8- Remarks", "Q9 - Used necessary customization of Templates(F)(15)", "Q9- Remarks", "Q10 - Use correct spelling grammar and punctuation(15)", "Q10- Remarks", "Q11 - CRM accuracy(F)(10)", "Q11- Remarks", "Q12 - Closing Statement & Further help(5)", "Macro available in Zendesk", "Observations for feedback", "ZTP", "No of Queries", "Agent issues for D-SAT", "D-SAT Reason", "FATAL Reason", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Agent Review Date", "Agent Feedback Acceptance Status", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Date", "Client Review Comment", "Fatal Count", "Type of Contact Audit 2", "Q12- Remarks");
		}else if($pid=='Supplier_Support_CMB'){
			$header = array("Edit Audits", "QA name", "Process", "Agent Name", "TL Name", "Agent Status", "Tenurity", "Quality Score", "PreFatal Score", "Fatal", "Week", "Audit Center", "Agent Center", "Audit Date", "Employee ID", "Email Address", "Type of Contact Audit", "Email Date & Time", "Mobile No", "Agent Selected Disposition", "Correct Disposition", "Call Summary", "Score", "Recording ID", "Language", "AHT", "Q1- Appropriate call opening", "Q1- Remarks", "Q2- Rate of speech/Grammar", "Q2- Remarks", "Q3- Avoid Interruption", "Q3- Remarks", "Q4- Hold Procedure", "Q4- Remarks", "Q5- Dead Air", "Q5- Remarks", "Q6- Casual on the call or not", "Q6- Remarks", "Q7 - Empathy", "Q7- Remarks", "Q8- Accurate Resolution as per the SOP", "Q8- Remarks", "Q9- comments/cases uses properly", "Q9- Remarks", "Q10- Updating forms in trackers", "Q10- Remarks", "Q11- Provide Proactive Information", "Q11- Remarks", "Q12- Survey pitch for solved cases", "Q12- Remarks", "Q13- Additional Information", "Q13- Remarks", "Voice of customer any", "Resolution Requires an outbound call", "Satisfaction level of the customer", "Will the customer call for the same issue again ?", "Remarks yes for repeat call", "What would be the reason for repeat ?", "ACPT", "L2", "L3", "L4", "Edit Audit", "Blank", "Blank", "Blank", "Blank", "Audit Date", "Tenurity(Date of certification)", "Tenure Days", "Fatal Count", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Commnet", "Client Review Date", "Ticket ID", "Order No", "FCR", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Feedback");
		}else if($pid=='Supplier_Support_Onboarding'){
			$header = array("Edit Audits", "QA name", "Process", "Agent Name", "TL Name", "Agent Status", "Tenurity", "Quality Score", "PreFatal Score", "Fatal", "Week", "Audit Center", "Agent Center", "Audit Date", "Employee ID", "Email Address", "Type of Contact Audit", "Email Date & Time", "Supplier ID", "Agent Selected Disposition", "Correct Disposition", "Call Summary", "Score", "Recording ID", "Language", "Order No", "Q1- Call Opening", "Q1- Remarks", "Q2- Identification", "Q2- Remarks", "Q3- Active listening", "Q3- Remarks", "Q4- Patience", "Q4- Remarks", "Q5- Supplier Info", "Q5- Remarks", "Q6 - Catalog Creation and stock", "Q6- Remarks", "Q7 - Order management", "Q7- Remarks", "Q8 - Logistic Process", "Q8- Remarks", "Q9 - Return related issues and dashboard", "Q9- Remarks", "Q10 - Payments and penalties", "Q10- Remarks", "Q11 - Closing Statement", "Q11- Remarks", "Q12-Apology/Empathy", "Q12- Remarks", "Voice of customer any", "Resolution Requires an outbound call", "Satisfaction level of the customer", "Will the customer call for the same issue again ?", "Remarks yes for repeat call", "What would be the reason for repeat ?", "Blank", "Blank", "Blank", "Blank", "Blank", "Edit Audit", "Blank", "Blank", "Blank", "Blank", "Audit Date", "Tenurity(Date of certification)", "Tenure Days", "Fatal Count", "ACPT", "L2", "L3", "L4", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Commnet", "Client Review Date", "Mobile No", "FCR", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Feedback");
		}else if($pid=='Pop Shop'){
			$header = array("Auditor Name", "Audit Date", "Agent Name", "L1 Super", "Phone", "Record No", "Order No", "Ticket ID", "Advisor Tagging", "Correct Tagging", "ACPT", "ACPT Reason", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Opening", "Identification", "Security check", "Hold Procedure", "Closing Script", "Active Listening", "Effective Probing", "**Accurate Resolution as per the SOP", "Professionalism", "Apology/Empathy", "**Politeness & Courtesy", "CRM accuracy", "Additional Information", "Opening Remarks", "Identification Remarks", "Security check Remarks", "Hold Procedure Remarks", "Closing Script Remarks", "Active Listening Remarks", "Effective Probing Remarks", "**Accurate Resolution as per the SOP Remarks", "Professionalism Remarks", "Apology/Empathy Remarks", "**Politeness & Courtesy Remarks", "CRM accuracy Remarks", "Additional Information Remarks", "Call Summary", "Feedback", "Fatal Reason", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Commnet", "Client Review Date");
		}else if($pid=='Pop Shop Email'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Email Date", "Correct Disposition", "Order No", "Ticket No", "ACPT", "ACPT L2 Reason", "Case Type", "Language", "Satus", "Disposition", "No of Queries", "Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Opening /Personalization", "Validation of customer information", "Acknowledge Align & Assure", "Effective Probing", "Accurate Resolution", "Managed delays with grace", "Additional information provided/ Self help", "**Used templates correctly", "**Used necessary customization of Templates", "Use correct spelling grammar and punctuation", "CRM accuracy", "Closing Statement & Further help", "Opening Remarks", "Validation of customer information Remarks", "Acknowledge Remarks", "Effective Probing Remarks", "Accurate Resolution Remarks", "Managed delays with grace Remarks", "Additional information provided Remarks", "Used templates correctly Remarks", "Used necessary customization of Templates Remarks", "Use correct spelling Remarks", "CRM accuracy Remarks", "Closing Statement & Further help Remarks", "Voice of customer any", "Resolution Requires an outbound call", "Summary of the Call", "Satisfaction level of the customer with resolution", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Management Review By", "Management Review Date", "Management Comment", "Client Review By", "Client Review Commnet", "Client Review Date");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");


		if($pid=='Inbound'){

			foreach($rr as $user){

				if($user['call_opening']==5) $call_opening='Yes';
				else if($user['call_opening']==5.1) $call_opening='N/A';
				else $call_opening='No';

				if($user['identification']==5) $identification='Yes';
				else if($user['identification']==5.1) $identification='N/A';
				else $identification='No';

				if($user['security_check']==5) $security_check='Yes';
				else if($user['security_check']==5.1) $security_check='N/A';
				else $security_check='No';

				if($user['hold_procedure']==10) $hold_procedure='Yes';
				else if($user['hold_procedure']==10.1) $hold_procedure='N/A';
				else $hold_procedure='No';

				if($user['closing_script']==5) $closing_script='Yes';
				else if($user['closing_script']==5.1) $closing_script='N/A';
				else $closing_script='No';

				if($user['active_listening']==8) $active_listening='Yes';
				else if($user['active_listening']==8.1) $active_listening='N/A';
				else $active_listening='No';

				if($user['effective_probing']==5) $effective_probing='Yes';
				else if($user['effective_probing']==5.1) $effective_probing='N/A';
				else $effective_probing='No';

				if($user['accurate_resolution_process']==15) $accurate_resolution_process='Yes';
				else if($user['accurate_resolution_process']==15.1) $accurate_resolution_process='N/A';
				else $accurate_resolution_process='No';

				if($user['politeness_courtesy']==10) $politeness_courtesy='Yes';
				else if($user['politeness_courtesy']==10.1) $politeness_courtesy='N/A';
				else $politeness_courtesy='No';

				if($user['apology_empathy']==8) $apology_empathy='Yes';
				else if($user['apology_empathy']==8.1) $apology_empathy='N/A';
				else $apology_empathy='No';

				if($user['enthusiasm']==12) $enthusiasm='Yes';
				else if($user['enthusiasm']==12.1) $enthusiasm='N/A';
				else $enthusiasm='No';

				/* if($user['fluency_structure']==5) $fluency_structure='Yes';
				else if($user['fluency_structure']==5.1) $fluency_structure='N/A';
				else $fluency_structure='No';

				if($user['mentorship_pitch']==5) $mentorship_pitch='Yes';
				else if($user['mentorship_pitch']==5.1) $mentorship_pitch='N/A';
				else $mentorship_pitch='No'; */

				if($user['crm_accuracy']==10) $crm_accuracy='Yes';
				else if($user['crm_accuracy']==10.1) $crm_accuracy='N/A';
				else $crm_accuracy='No';

				if($user['addition_info']==2) $addition_info='Yes';
				else if($user['addition_info']==2.1) $addition_info='N/A';
				else $addition_info='No';

				if($user['tenure']>='30'){
					$agentStatus='BAU';
				}else{
					$agentStatus='OJT';
				}

				if($user['entry_by']!=''){
					$name_audt = $user['auditor_name'];
					$email_audt = $user['auditor_email'];
				}else{
					$name_audt = $user['client_name'].' [Client]';
					$email_audt = $user['client_email'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$name_audt.'",';
				$row .= '"'.$email_audt.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$agentStatus.'",';
				$row .= '"'.$user['record_no'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['audit_center'].'",';
				$row .= '"'.$user['agent_center'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['recording_id'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['contact_audit'].'",';
				$row .= '"'.$user['satis_rating'].'",';
				$row .= '"'.$user['aht_sec'].'",';
				$row .= '"'.$user['agent_dispo'].'",';
				$row .= '"'.$user['correct_dispo'].'",';
				$row .= '"'.$call_opening.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_opening_comment'])).'",';
				$row .= '"'.$identification.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['identification_comment'])).'",';
				$row .= '"'.$security_check.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['security_check_comment'])).'",';
				$row .= '"'.$hold_procedure.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['hold_procedure_comment'])).'",';
				$row .= '"'.$closing_script.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['closing_script_comment'])).'",';
				$row .= '"'.$active_listening.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['active_listening_comment'])).'",';
				$row .= '"'.$effective_probing.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['effective_probing_comment'])).'",';
				$row .= '"'.$accurate_resolution_process.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['accurate_resolution_process_comment'])).'",';
				$row .= '"'.$politeness_courtesy.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['politeness_courtesy_comment'])).'",';
				$row .= '"'.$apology_empathy.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['apology_empathy_comment'])).'",';
				$row .= '"'.$enthusiasm.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['enthusiasm_comment'])).'",';
				/* $row .= '"'.$fluency_structure.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['fluency_structure_comment'])).'",';
				$row .= '"'.$mentorship_pitch.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mentorship_pitch_comment'])).'",'; */
				$row .= '"'.$crm_accuracy.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['crm_accuracy_comment'])).'",';
				$row .= '"'.$addition_info.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['addition_info_comment'])).'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['aht_duration'].'",';
				$row .= '"'.$user['lead_repeat_call'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['voice_of_customer'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['resolution_required_ob_call'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_satisfaction'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_issue_again'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_repeat'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';


				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='Email'){

			foreach($rr as $user){

				if($user['oprning_personalization']==5) $oprning_personalization='Yes';
				else if($user['oprning_personalization']==5.1) $oprning_personalization='N/A';
				else $oprning_personalization='No';

				if($user['validation_customer_info']==5) $validation_customer_info='Yes';
				else if($user['validation_customer_info']==5.1) $validation_customer_info='N/A';
				else $validation_customer_info='No';

				if($user['acknowledge_align_assure']==5) $acknowledge_align_assure='Yes';
				else if($user['acknowledge_align_assure']==5.1) $acknowledge_align_assure='N/A';
				else $acknowledge_align_assure='No';

				if($user['effective_probing']==5) $effective_probing='Yes';
				else if($user['effective_probing']==5.1) $effective_probing='N/A';
				else $effective_probing='No';

				if($user['accurate_resolution']==10) $accurate_resolution='Yes';
				else if($user['accurate_resolution']==10.1) $accurate_resolution='N/A';
				else $accurate_resolution='No';

				if($user['manage_delay_grace']==5) $manage_delay_grace='Yes';
				else if($user['manage_delay_grace']==5.1) $manage_delay_grace='N/A';
				else $manage_delay_grace='No';

				if($user['provide_self_help']==10) $provide_self_help='Yes';
				else if($user['provide_self_help']==10.1) $provide_self_help='N/A';
				else $provide_self_help='No';

				if($user['used_template_correctly']==10) $used_template_correctly='Yes';
				else if($user['used_template_correctly']==10.1) $used_template_correctly='N/A';
				else $used_template_correctly='No';

				if($user['used_necessary_custom']==15) $used_necessary_custom='Yes';
				else if($user['used_necessary_custom']==15.1) $used_necessary_custom='N/A';
				else $used_necessary_custom='No';

				if($user['used_correct_spelling']==15) $used_correct_spelling='Yes';
				else if($user['used_correct_spelling']==15.1) $used_correct_spelling='N/A';
				else $used_correct_spelling='No';

				if($user['crm_accuracy']==10) $crm_accuracy='Yes';
				else if($user['crm_accuracy']==10.1) $crm_accuracy='N/A';
				else $crm_accuracy='No';

				if($user['closing_statement']==5) $closing_statement='Yes';
				else if($user['closing_statement']==5.1) $closing_statement='N/A';
				else $closing_statement='No';

				/* if($user['agent_write_brand_voice']==7) $agent_write_brand_voice='Yes';
				else if($user['agent_write_brand_voice']==7.1) $agent_write_brand_voice='N/A';
				else $agent_write_brand_voice='No'; */

				if($user['tenure']>='30'){
					$agentStatus='BAU';
				}else{
					$agentStatus='OJT';
				}

				if($user['entry_by']!=''){
					$name_audt = $user['auditor_name'];
					$email_audt = $user['auditor_email'];
				}else{
					$email_audt = $user['client_email'];
					$name_audt = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$name_audt.'",';
				$row .= '"'.$email_audt.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$agentStatus.'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_center'].'",';
				$row .= '"'.$user['agent_center'].'",';
				$row .= '"'.$user['contact_audit'].'",';
				$row .= '"'.$user['zd_id'].'",';
				$row .= '"'.$user['satis_rating'].'",';
				$row .= '"'.$user['agent_dispo'].'",';
				$row .= '"'.$user['correct_dispo'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$oprning_personalization.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['oprning_personalization_comment'])).'",';
				$row .= '"'.$validation_customer_info.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['validation_customer_info_comment'])).'",';
				$row .= '"'.$acknowledge_align_assure.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['acknowledge_align_assure_comment'])).'",';
				$row .= '"'.$effective_probing.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['effective_probing_comment'])).'",';
				$row .= '"'.$accurate_resolution.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['accurate_resolution_comment'])).'",';
				$row .= '"'.$manage_delay_grace.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['manage_delay_grace_comment'])).'",';
				$row .= '"'.$provide_self_help.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['provide_self_help_comment'])).'",';
				$row .= '"'.$used_template_correctly.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['used_template_correctly_comment'])).'",';
				$row .= '"'.$used_necessary_custom.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['used_necessary_custom_comment'])).'",';
				$row .= '"'.$used_correct_spelling.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['used_correct_spelling_comment'])).'",';
				$row .= '"'.$crm_accuracy.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['crm_accuracy_comment'])).'",';
				$row .= '"'.$closing_statement.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['closing_statement_comment'])).'",';
				//$row .= '"'.$agent_write_brand_voice.'",';
				//$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_write_brand_voice_comment'])).'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['voice_of_customer'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['resolution_required_ob_call'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_satisfaction'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_issue_again'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_for_repeat'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';


				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='Supplier_Support'){

			foreach($rr as $user){
				$blank='';

				if($user['mgnt_rvw_by']!=''){
					$edit_audit='Edited';
				}else{
					$edit_audit='';
				}

				if($user['tenure']>='30'){
					$agentStatus='BAU';
				}else{
					$agentStatus='OJT';
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['overall_score']==0){
					$fatal=100;
				}else{
					$fatal=0;
				}

				$row = '"'.$edit_audit.'",';
				$row .= '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$agentStatus.'",';
				$row .= '"'.$user['tenure'].' Days'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['pre_fatal_score'].'%'.'",';
				$row .= '"'.$fatal.'%'.'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_center'].'",';
				$row .= '"'.$user['agent_center'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['agent_email'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['case_type'].'",';
				$row .= '"'.$user['sub_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['opening'].'",';
				$row .= '"'.$user['comm1'].'",';
				$row .= '"'.$user['validateinfo'].'",';
				$row .= '"'.$user['comm2'].'",';
				$row .= '"'.$user['acknowledge'].'",';
				$row .= '"'.$user['comm3'].'",';
				$row .= '"'.$user['effectiveprobing'].'",';
				$row .= '"'.$user['comm4'].'",';
				$row .= '"'.$user['accurateresolution'].'",';
				$row .= '"'.$user['comm5'].'",';
				$row .= '"'.$user['managedelay'].'",';
				$row .= '"'.$user['comm6'].'",';
				$row .= '"'.$user['provideselfhelp'].'",';
				$row .= '"'.$user['comm7'].'",';
				$row .= '"'.$user['leveragesystem'].'",';
				$row .= '"'.$user['comm8'].'",';
				$row .= '"'.$user['accurateowenship'].'",';
				$row .= '"'.$user['comm9'].'",';
				$row .= '"'.$user['correctspelling'].'",';
				$row .= '"'.$user['comm10'].'",';
				$row .= '"'.$user['crmaccuracy'].'",';
				$row .= '"'.$user['comm11'].'",';
				$row .= '"'.$user['closingstatement'].'",';
				$row .= '"'.$user['comm12'].'",';
				$row .= '"'.$user['professionalism'].'",';
				$row .= '"'.$user['comm13'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_voice'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['outbound_call'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['satisfaction_level'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_callissue'])).'",';
				$row .= '"'.$user['remarks_yes_repeat_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['repeat_reason'])).'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['l2_acpt'].'",';
				$row .= '"'.$user['l3_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['l4_acpt'])).'",';
				$row .= '"'.$edit_audit.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['doj'].'",';
				$row .= '"'.$user['tenure'].' Days'.'",';
				$row .= '"'.$user['fatal_count'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'",';
				$row .= '"'.$user['record_no'].'",';
				$row .= '"'.$user['fcr'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='Supplier_Support_new'){

			foreach($rr as $user){
				$blank='';

				if($user['mgnt_rvw_by']!=''){
					$edit_audit='Edited';
				}else{
					$edit_audit='';
				}

				if($user['tenure']>='30'){
					$agentStatus='BAU';
				}else{
					$agentStatus='OJT';
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['overall_score']==0){
					$fatal=100;
				}else{
					$fatal=0;
				}

				$row = '"'.$edit_audit.'",';
				$row .= '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$agentStatus.'",';
				$row .= '"'.$user['tenure'].' Days'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['pre_fatal_score'].'%'.'",';
				$row .= '"'.$fatal.'%'.'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['agent_center'].'",';
				$row .= '"'.$user['agent_center'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['agent_email'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['order_id'].'",';
				$row .= '"'.$user['satisfaction_rating'].'",';
				$row .= '"'.$user['opening'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm1'])).'",';
				$row .= '"'.$user['validate_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm2'])).'",';
				$row .= '"'.$user['acknowledge'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm3'])).'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm4'])).'",';
				$row .= '"'.$user['accurate_resolution'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm5'])).'",';
				$row .= '"'.$user['manage_delay_grace'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm6'])).'",';
				$row .= '"'.$user['provide_self_help'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm7'])).'",';
				$row .= '"'.$user['use_correct_template'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm8'])).'",';
				$row .= '"'.$user['use_necessary_template'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm9'])).'",';
				$row .= '"'.$user['use_correct_spelling'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm10'])).'",';
				$row .= '"'.$user['crm_accuracy'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm11'])).'",';
				$row .= '"'.$user['closing_statement'].'",';
				$row .= '"'.$user['zendesk_macro'].'",';
				$row .= '"'.$user['observation_feedback'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['queries_no'].'",';
				$row .= '"'.$user['agent_dsat_issue'].'",';
				$row .= '"'.$user['dsat_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['fatal_reason'])).'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'",';
				$row .= '"'.$user['fatal_count'].'",';
				$row .= '"'.$user['contact_audit_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comm12'])).'",';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='Supplier_Support_CMB'){

			foreach($rr as $user){
				$blank='';

				if($user['mgnt_rvw_by']!=''){
					$edit_audit='Edited';
				}else{
					$edit_audit='';
				}

				if($user['tenure']>='30'){
					$agentStatus='BAU';
				}else{
					$agentStatus='OJT';
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['overall_score']==0){
					$fatal=100;
				}else{
					$fatal=0;
				}

				$row = '"'.$edit_audit.'",';
				$row .= '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$agentStatus.'",';
				$row .= '"'.$user['tenure'].' Days'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['pre_fatal_score'].'%'.'",';
				$row .= '"'.$fatal.'%'.'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_center'].'",';
				$row .= '"'.$user['agent_center'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['agent_email'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['case_type'].'",';
				$row .= '"'.$user['sub_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['record_no'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['comm1'].'",';
				$row .= '"'.$user['rate_of_speech'].'",';
				$row .= '"'.$user['comm2'].'",';
				$row .= '"'.$user['avoid_interruption'].'",';
				$row .= '"'.$user['comm3'].'",';
				$row .= '"'.$user['hold_procedure_follow'].'",';
				$row .= '"'.$user['comm4'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['comm5'].'",';
				$row .= '"'.$user['casual_on_the_call'].'",';
				$row .= '"'.$user['comm6'].'",';
				$row .= '"'.$user['empathy_rude'].'",';
				$row .= '"'.$user['comm7'].'",';
				$row .= '"'.$user['provide_accrurate'].'",';
				$row .= '"'.$user['comm8'].'",';
				$row .= '"'.$user['cases_properly'].'",';
				$row .= '"'.$user['comm9'].'",';
				$row .= '"'.$user['updating_forms'].'",';
				$row .= '"'.$user['comm10'].'",';
				$row .= '"'.$user['proactive_information'].'",';
				$row .= '"'.$user['comm11'].'",';
				$row .= '"'.$user['survey_pitch'].'",';
				$row .= '"'.$user['comm12'].'",';
				$row .= '"'.$user['call_closing'].'",';
				$row .= '"'.$user['comm13'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_voice'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['outbound_call'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['satisfaction_level'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_callissue'])).'",';
				$row .= '"'.$user['remarks_yes_repeat_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['repeat_reason'])).'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['l2_acpt'].'",';
				$row .= '"'.$user['l3_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['l4_acpt'])).'",';
				$row .= '"'.$edit_audit.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['doj'].'",';
				$row .= '"'.$user['tenure'].' Days'.'",';
				$row .= '"'.$user['fatal_count'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['fcr'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='Supplier_Support_Onboarding'){

			foreach($rr as $user){
				$blank='';

				if($user['mgnt_rvw_by']!=''){
					$edit_audit='Edited';
				}else{
					$edit_audit='';
				}

				if($user['tenure']>='30'){
					$agentStatus='BAU';
				}else{
					$agentStatus='OJT';
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['overall_score']==0){
					$fatal=100;
				}else{
					$fatal=0;
				}

				$row = '"'.$edit_audit.'",';
				$row .= '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$agentStatus.'",';
				$row .= '"'.$user['tenure'].' Days'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['pre_fatal_score'].'%'.'",';
				$row .= '"'.$fatal.'%'.'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_center'].'",';
				$row .= '"'.$user['agent_center'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['agent_email'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['case_type'].'",';
				$row .= '"'.$user['sub_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['record_no'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['comm1'].'",';
				$row .= '"'.$user['identification'].'",';
				$row .= '"'.$user['comm2'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['comm3'].'",';
				$row .= '"'.$user['patience'].'",';
				$row .= '"'.$user['comm4'].'",';
				$row .= '"'.$user['supplier_info'].'",';
				$row .= '"'.$user['comm6'].'",';
				$row .= '"'.$user['catalog_creation'].'",';
				$row .= '"'.$user['comm7'].'",';
				$row .= '"'.$user['order_management'].'",';
				$row .= '"'.$user['comm8'].'",';
				$row .= '"'.$user['logistic_process'].'",';
				$row .= '"'.$user['comm9'].'",';
				$row .= '"'.$user['return_issue'].'",';
				$row .= '"'.$user['comm10'].'",';
				$row .= '"'.$user['payment'].'",';
				$row .= '"'.$user['comm11'].'",';
				$row .= '"'.$user['closing_statement'].'",';
				$row .= '"'.$user['comm12'].'",';
				$row .= '"'.$user['apology_empathy'].'",';
				$row .= '"'.$user['comm5'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_voice'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['outbound_call'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['satisfaction_level'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_callissue'])).'",';
				$row .= '"'.$user['remarks_yes_repeat_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['repeat_reason'])).'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$edit_audit.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$blank.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['doj'].'",';
				$row .= '"'.$user['tenure'].' Days'.'",';
				$row .= '"'.$user['fatal_count'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['l2_acpt'].'",';
				$row .= '"'.$user['l3_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['l4_acpt'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['fcr'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='Pop Shop'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['record_no'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['advisor_tagging'].'",';
				$row .= '"'.$user['correct_tagging'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['acpt_reason'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['opening'].'",';
				$row .= '"'.$user['identification'].'",';
				$row .= '"'.$user['security_check'].'",';
				$row .= '"'.$user['hold_procedure'].'",';
				$row .= '"'.$user['closing_script'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'.$user['accurate_resolution'].'",';
				$row .= '"'.$user['professionalism'].'",';
				$row .= '"'.$user['apology_empathy'].'",';
				$row .= '"'.$user['politeness_courtesy'].'",';
				$row .= '"'.$user['CRM_accuracy'].'",';
				$row .= '"'.$user['additional_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['fatal_reason'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='Pop Shop Email'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['agent_name'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['acpt_l2_reason'].'",';
				$row .= '"'.$user['case_type'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['status'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['no_queries'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['opening'].'",';
				$row .= '"'.$user['customer_validation'].'",';
				$row .= '"'.$user['acknowledge_align'].'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'.$user['accurate_resolution'].'",';
				$row .= '"'.$user['manage_delays'].'",';
				$row .= '"'.$user['additional_information'].'",';
				$row .= '"'.$user['use_template'].'",';
				$row .= '"'.$user['use_necessary_customization'].'",';
				$row .= '"'.$user['use_correct_spelling'].'",';
				$row .= '"'.$user['crm_accurecy'].'",';
				$row .= '"'.$user['closing_statement'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_voice'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['required_resolution'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['satisfaction_level'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}

	}

//////////////////////////////////////////////////////////////////////////////////////////////
// ////////////////////////////////////// QA MSB REPORT //////////////////////////////////////
// ///////////////////////////////////////////////////////////////////////////////////////////


	public function qa_layway_report(){

		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_layway_report.php";
			$data["content_js"] = "qa_layway_js.php";

			$date_from="";
			$date_to="";
			$office_id="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';

			$data["qa_layway_list"] = array();

			if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			}else{
				$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			}


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($office_id != "") $cond1 .= " and office_id='$office_id'";

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_layway_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_layway_list"] = $fullAray;
					$this->create_qa_layway_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_layway_new_CSV";
			}

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id'] = $office_id;

			$this->load->view('dashboard',$data);
		}
	}


// /////////////////// MSB NEW /////////////////////
	public function download_qa_layway_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA LayaWay Depot New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function headerDetails2(){
		return $arrayName = array ( "Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Audit Type","Auditor Type","VOC","Call Type","Overall Score","1. Agent answered the call within 6 secs and follow opening spiel","2. Agent delivered either empathy or assurance statement","3. Agent followed complete verification spiel","1. Agent was easy to understand?","2. Caller did not asked for a different operator because of agent's communication skills?","3. Agent used appropriate rate of speech?","1. Agent empathize in a timely manner or able to deliver assurance statement","2. Agent did not interrupted the caller and/or asked for an apology if there is an instance?","3. Agent's tone was pleasant /not weary/showed enthusiasm all throughout the call","4. Agent acknowledged the information provided by the caller?","5. Agent asked caller's permission before placing the call on hold","6. Agent waited for caller's confirmation before putting the call on hold","7. Hold time was less than 120 seconds","8. No Dead air of more than 20 seconds or multiple dead airs","1. Agent provided complete and accurate information","2. Agent write complete and accurate Notes","3. Agent updates the account if request was approved (For Follow up)","4. Agent disposed the call correctly","1. Agent ask additional assistance","2. Agent deliver closing spiel","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date" );
	}

	public function create_qa_layway_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header=$this->headerDetails2();
		$field_name="SHOW FULL COLUMNS FROM qa_layway_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}


	public function qa_kabbage_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_kabbage_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_kabbage_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$campaign = $this->input->get('campaign');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_kabbage_list"] = $fullAray;
				$this->create_qa_kabbage_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_kabbage_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	 public function kabbage_new_twoHeader(){
	 	return Array ("Fusion Id","Auditor Name","Audit Date","AGENT","TL","CALL DATE","CALL DURATION","AUDIT TYPE","AUDITOR TYPE","VOC ","CALL TYPE ","KUSER ID ","TICKET ID ","OVERALL SCORE ","POSSIBLE SCORE ","EARNED SCORE ","Did the agent execute the opening spiel properly? ","Did the agent ask the correct probing questions ","Did the agent show empathy and maintain a friendly ","Did the agent keep holds and distractions to a minimum level? ","Did the agent execute the closing spiel properly? ","Did the agent request all appropriate documents from the caller? ","Did the agent verify all information is good? ","Did the agent refrain from disclosing account specific information ","Did the agent abide all Legal and Regulatory Requirements? - Auto Zero ","Did the agent give Correct and Complete Information? ","Did the agent documented the call properly? ","Did the agent apply the necessary information to create a single contact ","AUTO FAIL ","COMMENT 1 ","COMMENT 2 ","COMMENT 3 ","COMMENT 4 ","COMMENT 5 ","COMMENT 6 ","COMMENT 7 ","COMMENT 8 ","COMMENT 9 ","COMMENT 10 ","COMMENT 11 ","COMMENT 12 ","CALL SUM ","FEEDBACK ","ENTRY BY ","ENTRY DATE ","AUDIT START TIME ","CLIENT ","MGNT RVW ","MGNT RVW NOTE ","MGNT RVW DATE ","AGENT RVW NOTE ","AGNT FD ACPT ","AGENT RVW DATE ","CLIENT RVW BY ","CLIENT RVW NOTE ","CLIENT RVW DATE");
	 }

	public function download_qa_kabbage_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Kabbage Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_kabbage_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$fopen = fopen($filename,"w+");

		if($campaign=='kabbage'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Event", "Call Duration", "Audit Type", "VOC", "Call Type", "KUSERID", "Ticket ID", "Auto Fail", "Overall Score", "1) Did the agent answer the call with their name?", "2) Did the agent request all appropriate documents from the caller", "3) Did the agent document all systems appropriately?", "4) Did the agent ask how they could help the customer?", "5) Did the agent verify all information is good?", "Procedural Earned Score", "Procedural Possible Score", "Procedural Score", "6) Did the agent ask the caller for their Kabbage User Name?", "7) Did the agent ask the caller for the last four digits of their Social Security Number?", "8) Did the agent refrain from disclosing account specific information", "9) Did the agent abide by all legal and regulatory requirements?", "Compliance Earned Score", "Compliance Possible Score", "Compliance Score", "10) Did the agent provide the caller with accurate information", "11) Did the agent do everything necessary and reasonable to create a single contact", "12) Was the agent engaged in the call with the caller in an effort to resolve the callers issue?", "13) Did the agent maintain a friendly professional tone?", "14) Did the agent keep holds and distractions to a minimum?", "15) Did the agent ask the caller if all their issues were resolved prior to ending the call?", "16) Did the agent thank the caller for choosing Kabbage?", "Customer Experience Earned Score", "Customer Experience Possible Score", "Customer Experience Score", "Procedural Comment1", "Procedural Comment2", "Procedural Comment3", "Procedural Comment4", "Procedural Comment5", "Compliance Comment1", "Compliance Comment2", "Compliance Comment3", "Compliance Comment4", "Customer Experience Comment1", "Customer Experience Comment2", "Customer Experience Comment3", "Customer Experience Comment4", "Customer Experience Comment5", "Customer Experience Comment6", "Customer Experience Comment7", "Customer Experience Comment8", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=='kabbage_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Event", "Call Duration", "Audit Type", "VOC","Audit Link", "Call Type", "KUSERID", "Ticket ID", "Auto Fail", "Overall Score", "1) Did the agent answer the call with their name and the name of the product?", "2) Identified the correct reason for calling", "3) Did the agent show empathy and maintain professional tone", "4) Did the agent ask how they could help the customer?", "5) Did the agent keep holds and distractions to a minimum?", "5) Checkbox 1", "5) Checkbox 2", "5) Checkbox 3", "6) Demonstrated Active Listening", "7) Did the agent thank the caller for choosing Kabbage?", "8) Did the agent request all appropriate documents from the caller?", "9) Did the agent verify all information is good?", "9) Checkbox 1", "9) Checkbox 2", "9) Checkbox 3", "9) Checkbox 4", "9) Checkbox 5", "10) Refrain from disclosing account specific information", "11) Abide By All Legal and Regulatory Requirements", "12) Gave Correct and Complete Information", "13) Documented the call properly", "13) Checkbox 1", "13) Checkbox 2", "13) Checkbox 3", "13) Checkbox 4", "13) Checkbox 5", "13) Checkbox 6", "13) Checkbox 7", "14) Did the agent do everything necessary and reasonable to create a single contact", "15) Asked for Other Concerns", "Connect Overall(%)", "Resolve Overall(%)", "Made Easy Overall(%)", "Connect Comment1", "Connect Comment2", "Connect Comment3", "Connect Comment4", "Connect Comment5", "Connect Comment6", "Connect Comment7", "Resolve Comment8", "Resolve Comment9", "Resolve Comment10", "Resolve Comment11", "Resolve Comment12", "Resolve Comment13", "Made it easy Comment14", "Made it easy Comment15", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=='kabbage_new_two'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Event", "Call Duration", "Audit Type", "VOC","Audit Link". "Call Type", "KUSERID", "Ticket ID", "Auto Fail", "Overall Score", "1) Did the agent execute the opening spiel properly?", "2) Did the agent ask the correct probing questions and identify the correct reason for calling?", "3) Did the agent show empathy and maintain a friendly confident professional tone and demonstrated Active Listening during the entire conversation?", "4) Did the agent keep holds and distractions to a minimum level?", "5) Did the agent execute the closing spiel properly?", "6) Did the agent request all appropriate documents from the caller?", "7) Did the agent verify all information is good?", "8) Did the agent refrain from disclosing account specific information without proper account verification?", "9) Did the agent abide all Legal and Regulatory Requirements?", "10) Did the agent give Correct and Complete Information?", "11) Did the agent documented the call properly?", "12) Did the agent apply the necessary information to create a single contact or one-touch resolution?", "Connect Overall(%)", "Resolve Overall(%)", "Made Easy Overall(%)", "Connect Comment1", "Connect Comment2", "Connect Comment3", "Connect Comment4", "Connect Comment5", "Resolve Comment6", "Resolve Comment7", "Resolve Comment8", "Resolve Comment9", "Resolve Comment10", "Resolve Comment11", "Made it easy Comment12", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='kabbage'){

			// $controller = "Qa_kabbage";
			// $edit_url = "mgnt_hcci_feedback";
			// $main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['event'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['kuserid'].'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['auto_fail'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentanswerthecall'].'",';
				$row .= '"'.$user['agentrequestdocuments'].'",';
				$row .= '"'.$user['documentallsystem'].'",';
				$row .= '"'.$user['agentasktohelpcustomer'].'",';
				$row .= '"'.$user['agentverifyallinformation'].'",';
				$row .= '"'.$user['procedural_possible'].'",';
				$row .= '"'.$user['procedural_earned'].'",';
				$row .= '"'.$user['procedural_score'].'%'.'",';
				$row .= '"'.$user['agentaskkabbagename'].'",';
				$row .= '"'.$user['agentaskcallerforSSnumber'].'",';
				$row .= '"'.$user['agentrefraindisclosingAccount'].'",';
				$row .= '"'.$user['agentabideallrequirement'].'",';
				$row .= '"'.$user['compliance_possible'].'",';
				$row .= '"'.$user['compliance_earned'].'",';
				$row .= '"'.$user['compliance_score'].'%'.'",';
				$row .= '"'.$user['agentprovideaccurateinformation'].'",';
				$row .= '"'.$user['agentcreatesinglecontact'].'",';
				$row .= '"'.$user['agentengagedincall'].'",';
				$row .= '"'.$user['agentmaintainfriendlytone'].'",';
				$row .= '"'.$user['agentkeepdistractions'].'",';
				$row .= '"'.$user['agentasktoendcall'].'",';
				$row .= '"'.$user['agentthankthecaller'].'",';
				//$row .= '"'.$user['agentencouragetotalecash'].'",';
				$row .= '"'.$user['customerexp_possible'].'",';
				$row .= '"'.$user['customerexp_earned'].'",';
				$row .= '"'.$user['customerexp_score'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='kabbage_new'){
			$controller = "Qa_kabbage";
			$edit_url = "add_new_feedback";
			$main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['event'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['kuserid'].'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['auto_fail'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['answer_the_call'].'",';
				$row .= '"'.$user['reason_for_calling'].'",';
				$row .= '"'.$user['show_empathy'].'",';
				$row .= '"'.$user['how_help_customer'].'",';
				$row .= '"'.$user['hold_distraction'].'",';
				$row .= '"'.$user['hold_distraction_chk1'].'",';
				$row .= '"'.$user['hold_distraction_chk2'].'",';
				$row .= '"'.$user['hold_distraction_chk3'].'",';
				$row .= '"'.$user['demonstrate_active_listening'].'",';
				$row .= '"'.$user['thank_caller_choosing_Kabbage'].'",';
				$row .= '"'.$user['request_appropiate_document'].'",';
				$row .= '"'.$user['verify_information'].'",';
				$row .= '"'.$user['verify_information_chk1'].'",';
				$row .= '"'.$user['verify_information_chk2'].'",';
				$row .= '"'.$user['verify_information_chk3'].'",';
				$row .= '"'.$user['verify_information_chk4'].'",';
				$row .= '"'.$user['verify_information_chk5'].'",';
				$row .= '"'.$user['disclosing_account'].'",';
				$row .= '"'.$user['abide_legal_reruirement'].'",';
				$row .= '"'.$user['gave_correct_information'].'",';
				$row .= '"'.$user['documented_call'].'",';
				$row .= '"'.$user['documented_call_chk1'].'",';
				$row .= '"'.$user['documented_call_chk2'].'",';
				$row .= '"'.$user['documented_call_chk3'].'",';
				$row .= '"'.$user['documented_call_chk4'].'",';
				$row .= '"'.$user['documented_call_chk5'].'",';
				$row .= '"'.$user['documented_call_chk6'].'",';
				$row .= '"'.$user['documented_call_chk7'].'",';
				$row .= '"'.$user['necessary_single_contact'].'",';
				$row .= '"'.$user['ask_other_concern'].'",';
				$row .= '"'.$user['connect_overall'].'",';
				$row .= '"'.$user['resolve_overall'].'",';
				$row .= '"'.$user['madeeasy_overall'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

			}else if($campaign=='kabbage_new_two'){
			$controller = "Qa_kabbage";
			$edit_url = "add_new_two_feedback";
			$main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['event'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['kuserid'].'",';
				$row .= '"'.$user['ticket_id'].'",';
				$row .= '"'.$user['auto_fail'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['opening_spiel'].'",';
				$row .= '"'.$user['identify_correct'].'",';
				$row .= '"'.$user['maintain_friendly'].'",';
				$row .= '"'.$user['distraction_minimum'].'",';
				$row .= '"'.$user['closing_spiel'].'",';
				$row .= '"'.$user['appropriate_documents'].'",';
				$row .= '"'.$user['all_info'].'",';

				$row .= '"'.$user['specific_info'].'",';
				$row .= '"'.$user['regulatory_requirements'].'",';

				$row .= '"'.$user['correct_complete'].'",';
				$row .= '"'.$user['auto_zero'].'",';
				$row .= '"'.$user['one_touch'].'",';
				$row .= '"'.$user['connect_overall'].'",';
				$row .= '"'.$user['resolve_overall'].'",';
				$row .= '"'.$user['madeeasy_overall'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}
	}



/////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////// QA Jurys Inn REPORT ///////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_jurys_inn_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_jurys_inn_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$lob="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_jurys_inn_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$lob = $this->input->get('lob');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if($lob=="cis"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurys_inn_feedback) xx Left Join
						(Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($lob=="email_cis"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_email_feedback) xx Left Join
						(Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($lob=="me_cis"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_me_cis_feedback) xx Left Join
						(Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($lob=="cis_contracts"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_cis_contracts_feedback) xx Left Join
						(Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($lob=="cis_proposal"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_cis_proposal_feedback) xx Left Join
						(Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($lob=="me_call"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_me_call_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($lob=="stag_hen"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_stag_hen_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				}else if($lob=="stag_hen_cis"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_staghen_cis_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				}else if($lob=="stag_hen_emails"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_staghen_email_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				} else if($lob=="stag_hen_esc"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_staghen_esc_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				} else if($lob=="cis_gds"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_input_cis_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}else if($lob=="gds_prearrival"){
					$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_jurysinn_gds_prearrival_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				}

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_jurys_inn_list"] = $fullAray;

				// if(in_array($lob,array("cis_contracts"))){
        //
				// 	$header=$lob."Header";
				// 	$header=$this->$header();
        //
				// 	$this->create_qa_process_new_CSV($fullAray,$header,$lob);
				// 	$dn_link = base_url()."reports_qa/download_qa_process_new_CSV/".$lob;
				// }else{
				// 	$this->create_qa_jurys_inn_CSV($fullAray,$lob);
				// 	$dn_link = base_url()."reports_qa/download_qa_jurys_inn_CSV/".$lob;
				// }
        $this->create_qa_jurys_inn_CSV($fullAray,$lob);
        $dn_link = base_url()."reports_qa/download_qa_jurys_inn_CSV/".$lob;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['lob']=$lob;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_jurys_inn_CSV($lob){
		if($lob=="cis"){
			$campaign="Reservation CIS";
		}else if($lob=="cis_proposal"){
			$campaign="M&E Proposal";
		}else if($lob=="email_cis"){
			$campaign="Email Reservation CIS";
		}else if($lob=="me_cis"){
			$campaign="M&E CIS Reservation";
		}else if($lob=="me_call"){
			$campaign="M&E CALL Reservation";
		}else if($lob=="stag_hen"){
			$campaign="Jurys Inn Stag and Hen";
		}else if($lob=="stag_hen_emails"){
			$campaign="Jurys Inn Stag and Hen Emails";
		}else if($lob=="stag_hen_esc"){
			$campaign="Jurys Inn Stag and Hen Escalation";
		}else if($lob=="stag_hen_cis"){
			$campaign="Jurys Inn Stag and Hen CIS Evaluation";
		}else if($lob=="cis_gds"){
			$campaign="Inputting CIS Evaluation";
		}else if($lob=="gds_prearrival"){
			$campaign="GDS Pre Arrival";
		}else if($lob=="cis_contracts"){
      $campaign="M&E Contracts";
    }

		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_jurys_inn_CSV($rr,$lob)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_jurys_inn";

		$fopen = fopen($filename,"w+");

		if($lob=="cis"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC","Audit Link", "Overall Score", "Earned Score", "Possible Score", "Pass Count", "Fail Count", "N/A Count", "Customer Score", "Business Score", "Compliance Score", "Did the agent Greet the Customer appropriately?", "Comment", "Did the agent offer his/her name?", "Comment", "Did the agent ascertain the customer name and use conversationally?", "Comment", "Did the agent ask an Open Question?", "Comment", "Did the agent utilise all resources available?", "Comment", "Did the agent determine if the call was for business?", "Comment", "Did the agent reconfirm to caller when the customer wants to stay?", "Comment", "Did the agent reconfirm to caller where the customer wants to stay?", "Comment", "Did the agent ask and reconfirm the number of rooms and guests?", "Comment", "Did the agent determine if the guest has stayed with us before?", "Comment", "Did the agent take relevant caller and profile information", "Comment", "Did the agent conform to GDPR requirements during the call?", "Comment", "Did the agent determine if the guest was a Jurys Rewards member?", "Comment", "Did the agent recommend the benefits of the Jurys Rewards programme?", "Comment", "Did the agent offer to enrol the guest on Jurys Rewards?", "Comment", "Did the agent upsell the room type and offer the benefits?", "Comment", "Did the agent offer Room Only and Bed & Breakfast?", "Comment", "Did the agent offer alternates positively", "Comment", "Did the agent present terms and conditions positively at the time of quoting?", "Comment","Did the agent offer the caller to contact the hotel for the correct reason?","Comment", "Did the agent ask for the business?", "Comment", "Did the agent reconfirm all booking details?", "Comment", "Did the agent follow the correct process?", "Comment", "Did the agent offer to send a confirmation email?", "Comment", "Did the agent advise that directions and parking information?", "Comment", "Did the agent ask if there was anything else?", "Comment", "Did the agent avoid long silences during the call?", "Comment", "Did the agent display a professional manner throughout the call?", "Comment", "Did the agent pro-actively volunteer additional info throughout the call?", "Comment", "Did the agent sound clear and confident throughout the call?", "Comment", "Did the agent refrain from using jargon throughout the call?", "Comment", "Did the agent sound polite and welcoming?", "Comment", "Did the agent use effective questioning skills?", "Comment", "Did the agent demonstrate active listening?", "Comment", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			/* "Did the agent apply the correct call tag?","Comment" */
		}else if($lob=="cis_proposal"){
		$header = array("Auditor Name777","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Block Code ","Channel ","Overall Score ","Possible Score ","Earned Score ","Customer Score ","Business Score ","Compliance Score ","Did the agent check that the enquiry has all details? (such as correct meeting date delegates and layout) ","Did the agent check the caps and dims to ensure that we have a suitable room type to offer? ","Did the agent load the block for the correct property and dates? ","Was the function diary checked before loading the block? ","Did the agent choose the correct profile/email profiles if a profile doesnt exist? ","Is the market segments correctly inputted? (Status Market Source Origin Type) ","Did the agent load bedrooms on the grid correctly? (If applicable) ","Did the agent load the meeting block correctly? (Separate Charges / DDR) ","Did the agent add block notes to what was offered? ","Did the agent add a trace to the block with the correct chase date? ","Did the agent check smart space and quote to the appropriate demand? ","Did the agent compose the proposal in the correct formant font and colour? ","Did the Contact and Meeting information table have all the correct detail on? ","Was the rate section correct and simple to read for the client? ","Did the agent amend the subject line accordingly? ","Did the the agent quote in the correct currency? ","Did the agent send it from the meet Inbox? ","Did the agent use their signature at the end of the email? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Call Summary ","Feedback ","Agent review date","Agent review note ","Mgnt review date ","Mgnt review Name ","Mgnt review note ","Client Review date","Client review by ","Client review note");
		}else if($lob=="stag_hen_emails"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Date email was sent", "Name","Email Type(availability check amendments traces final handover)", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score","Did the agent determine if the customer had an allocation/corporate/agreed rate?","Was the blackout document checked before quoting?", "Did the agent quote in the correct currency?","Did the agent use the correct template with the correct cancellation policy?", "Did the agent update the block notes correctly?", "Did the agent select/add the correct trace date?","Did the agent maximise resources?","Did the agent send from the S&H inbox and copy the Stag group for relevant emails?","Did the agent use their signature at the end of the email?", "Did the agent save to the Backup Drive correctly?","Comment 1", "Comment 2", "Comment 3", "Comment 4", "Comment 5", "Comment 6", "Comment 7", "Comment 8", "Comment 9", "Comment 10","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="stag_hen_esc"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Date email was sent", "Name","Email Type(availability check amendments traces final handover)", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score","Did the agent Greet the Customer appropriately?","Did the agent offer his/her name?", "Did the agent ascertain the customer name and use conversationally?"," Did the agent ask an Open Question?", "Did the agent reconfirm to caller when the customer wants to stay?", "Did the agent reconfirm to caller where the customer wants to stay?","Did the agent determine the number of rooms and guests?","Did the agent determine if the customer had a allocation/corporate/agreed rate?","Did the agent build or use an already existing rapport?", "Did the agent quote the rate without being prompted by the caller was it clear and was the tone encouraging?","Did the agent offer to place the bedrooms on hold?","Did the agent offer alternates positively","Did the agent present terms and conditions positively (Cancellation Policy)","Did the agent ask if there were any other reservations or if there was anything else?","Did the agent follow the correct SOP?","Did the agent close the call in an appropriate manner","Did the agent offer to send the quote by email?","Did the agent avoid long silences during the call?","Did the agent display a professional manner throughout the call?","Did the agent sound clear and confident throughout the call?","Did the agent refrain from using jargon throughout the call?","Did the agent sound friendly polite and welcoming?","Did the agent use effective questioning skills?","Did the agent demonstrate active listening?","Did the agent determine if the customer had an allocation/corporate/agreed rate?","Did the agent load the block for the correct property and dates?","Was the blackout document checked before loading the block?","Did the agent created/ choose the correct contact profile for this booking with contact details stated?","Is the market segments correctly inputted? ","Did the agent load bedrooms on the grid correctly?","Did the agent add block notes to what was offered?","Did the agent add the trace to the block with the correct trace date?","Did the agent respond in the correct format? ","If rooms were taken from allocation was the allocation deducted from the master block?","Did the the agent quote in the correct currency?","Did the agent send it from the S&H Inbox?","Did the agent determine if the customer had an allocation/corporate/agreed rate?","Was the blackout document checked before quoting?","Did the agent quote in the correct currency?","Did the agent use the correct template with the correct cancellation policy?","Did the agent update the block notes correctly?","Did the agent select/add the correct trace date?","Did the agent maximise resources?","Did the agent send from the S&H inbox and copy the Stag group for relevant emails?","Did the agent use their signature at the end of the email?","Did the agent save to the Backup Drive correctly?","Comment 1", "Comment 2", "Comment 3", "Comment 4", "Comment 5", "Comment 6", "Comment 7", "Comment 8", "Comment 9", "Comment 10","Comment 11","Comment 12","Comment 13","Comment 14","Comment 15","Comment 16","Comment 17","Comment 18","Comment 19","Comment 20","Comment 21","Comment 22","Comment 23","Comment 24","Comment 25","Comment 26","Comment 27","Comment 28","Comment 29","Comment 30","Comment 31","Comment 32","Comment 33","Comment 34","Comment 35","Comment 36","Comment 37","Comment 38","Comment 39","Comment 40","Comment 41","Comment 42","Comment 43","Comment 44","Comment 45","Comment 46","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="email_cis"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Email Date", "Reference ID", "Query Type", "Sub Query Type", "Assessment Type", "Transaction Status", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "Customer Score", "Business Score", "Compliance Score", "Did the agent use an appropriate opening line at the beginning of the email?", "Did the agent use the guests name?", "Did the agent use the appropriate template? (If applicable)", "Was the email formatted correctly and consistently? (Same font and colour)", "Did the agent use their signature?", "Did the agent offer add on to maximise revenue? (Offer Breakfast and Superior Rooms)", "Did the agent close the email in a appropriate manner?", "Did the agent use all available information", "Did the agent reconfirm all details including terms and conditions?", "Did the agent follow the correct SOP?", "Did the agent state if there was anything else they could help the guest with?", "Did the agent offer any alternatives? (if applicable)", "Did the agent answer all the guests questions fully?", "Has the agent amended the subject line appropriately?", "Did the agent check if preferential rates were available? (If applicable)", "Did the agent send the email from the correct cluster?", "Did the agent ensure correct spelling on his/her response?", "Did the agent select the correct property?", "Did the agent select the correct date?", "Did the agent select correct amount of rooms booked?", "Did the agent use proper rate code?", "Did the agent use proper guarantee type?", "Did the agent use correct payment option?", "Did the agent avoid making a duplicate?", "Did the agent avoid booking over the leisure / business group threshold?", "Did the agent mark the email complete correctly?", "Did the agent make the correct changes to the booking? (If applicable)", "Did the agent ensure that this email will not lead to an escalation?","GREET & ENGAGE Comment1", "GREET & ENGAGE Comment2", "GREET & ENGAGE Comment3", "GREET & ENGAGE Comment4", "GREET & ENGAGE Comment5", "QUALIFICATION Comment1", "QUALIFICATION Comment2", "QUALIFICATION Comment3", "QUALIFICATION Comment4", "DILIGENCE Comment1", "DILIGENCE Comment2", "DILIGENCE Comment3", "DETAIL Comment1", "DETAIL Comment2", "DETAIL Comment3", "DETAIL Comment4", "DETAIL Comment5", "DETAIL Comment6", "DETAIL Comment7", "DETAIL Comment8", "DETAIL Comment9", "DETAIL Comment10", "DETAIL Comment11", "DETAIL Comment12", "DETAIL Comment13", "DETAIL Comment14", "DETAIL Comment15", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="me_cis"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Audit Type", "VOC","Overall Score", "Earned Score", "Possible Score", "Did the agent Greet the Customer appropriately?", "Did the agent offer his/her name?", "Did the agent ascertain the customer name and use conversationally?", "Did the agent clarify if the caller is from a company or agency?", "Did the agent take down the callers contact details?", "Did the agent establish how the caller had heard of the hotel AND give an upbeat response?", "Did the agent adopt an open approach initially in order to establish the callers requirements?", "Did the agent establish the type purpose of the event?", "Did the agent confirm to the caller what location they are requesting?", "Did the agent confirm to caller dates days and times of the meeting?", "Were the following also clearly discussed?", "Did the agent determine if accommodation was required?", "Did the agent reconfirm delegate numbers & room layout?", "Did the agent determine if the company agency had a specific price range?", "Did the agent determine if the caller has been quoted by any competitors?", "Did the agent establish the most important factors in the choice of venue?", "Did the agent quote the rate without being prompted by the caller", "Were the key package features highlighted when the price was quoted?", "Did the agent offer to place the meeting space on hold?", "Did the agent offer alternates positively?", "Did the agent ask if there were any other meeting requests or if there was anything else?", "Did the agent close the call in an appropriate manner", "Did the agent reconfirm all booking details?", "Did the agent offer send a proposal via email?", "Did the agent avoid long silences during the call?", "Did the agent display a professional manner throughout the call?", "Did the agent sound clear and confident throughout the call?", "Did the agent sound friendly polite and welcoming?", "Did the agent use effective questioning skills?", "Did the agent demonstrate active listening?", "Did the agent ask the caller to complete the CCC Survey?", "GREET & ENGAGE Comment1", "GREET & ENGAGE Comment2", "GREET & ENGAGE Comment3", "GREET & ENGAGE Comment4", "GREET & ENGAGE Comment5", "GREET & ENGAGE Comment6", "QUALIFICATION Comment1", "QUALIFICATION Comment2", "QUALIFICATION Comment3", "QUALIFICATION Comment4", "QUALIFICATION Comment5", "QUALIFICATION Comment6", "QUALIFICATION Comment7", "RECOGNIZE Comment1", "RECOGNIZE Comment2", "RECOGNIZE Comment3", "RECOMMEND Comment1", "RECOMMEND Comment2", "OVERCOME OBJECTIONS Comment1", "OVERCOME OBJECTIONS Comment2", "APPROPRIATE CLOSURE Comment1", "APPROPRIATE CLOSURE Comment2", "APPROPRIATE CLOSURE Comment3", "APPROPRIATE CLOSURE Comment4", "SOFT SKILLS Comment1", "SOFT SKILLS Comment2", "SOFT SKILLS Comment3", "SOFT SKILLS Comment4", "SOFT SKILLS Comment5", "SOFT SKILLS Comment6", "SOFT SKILLS Comment7", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="me_call"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Audit Type", "VOC", "Overall Score", "Earned Score", "Possible Score", "Did the agent Greet the Customer appropriately?", "Did the agent offer his/her name?", "Did the agent ascertain the customer name and use conversationally?", "Did the agent clarify if the caller is from a company or agency?", "Did the agent ask an Open Question?", "Did the agent establish the type / purpose of the event?", "Did the agent reconfirm to the caller the location the caller is requesting?", "Did the agent reconfirm the meeting dates the caller is requesting?", "Did the agent reconfirm the timings of the meeting?", "Did the agent reconfirm delegate numbers & room layout?", "Did the agent discuss Catering AV and Breakout areas clearly?", "Did the agent determine if the customer had booked with us before?", "Did the agent determine if the customer had a specific price range?", "Did the agent offer add ons  upsell?", "Did the agent quote the rate without being prompted by the caller was it clear and was the tone encouraging?", "Did the agent explain the key package features highlighted when the price was quoted?", "Did the agent offer alternatives positively?", "Did the agent offer to place to meeting space on hold?", "Did the agent recap all the discussed details?", "Did the agent close the call in an appropriate manner?", "Did the agent ask if there was anything else?", "Did the agent avoid long silences during the call?", "Did the agent display a professional manner throughout the call?", "Did the agent refrain from using jargon throughout the call?", "Did the agent sound clear and confident throughout the call?", "Did the agent sound friendly polite and welcoming?", "Did the agent use effective questioning skills?", "Did the agent demonstrate active listening?", "GREET & ENGAGE Comment1", "GREET & ENGAGE Comment2", "GREET & ENGAGE Comment3", "GREET & ENGAGE Comment4", "GREET & ENGAGE Comment5", "QUALIFICATION Comment1", "QUALIFICATION Comment2", "QUALIFICATION Comment3", "QUALIFICATION Comment4", "QUALIFICATION Comment5", "QUALIFICATION Comment6", "RECOGNIZE Comment1", "RECOGNIZE Comment2",  "RECOMMEND Comment1", "RECOMMEND Comment2","RECOMMEND Comment3", "OVERCOME OBJECTIONS Comment1", "OVERCOME OBJECTIONS Comment2", "APPROPRIATE CLOSURE Comment1", "APPROPRIATE CLOSURE Comment2", "APPROPRIATE CLOSURE Comment3", "SOFT SKILLS Comment1", "SOFT SKILLS Comment2", "SOFT SKILLS Comment3", "SOFT SKILLS Comment4", "SOFT SKILLS Comment5", "SOFT SKILLS Comment6", "SOFT SKILLS Comment7", "Compliance Score","Customer Score","Business Score","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="stag_hen"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Block Code", "Call Type", "Sub Call Type", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "Did the agent Greet the Customer appropriately?", "Did the agent offer his/her name?", "Did the agent ascertain the customer name and use conversationally?", "Did the agent ask an Open Question?", "Did the agent reconfirm to caller when the customer wants to stay?", "Did the agent reconfirm to caller where the customer wants to stay?", "Did the agent determine the number of rooms and guests?", "Did the agent determine if the customer had an allocation/corporate/agreed rate?", "Did the agent build or use an already existing rapport?", "Did the agent quote the rate without being prompted by the caller? Was it clear and was the tone encouraging?", "Did the agent offer to place the bedrooms on hold?", "Did the agent offer alternates positively", "**Did the agent present terms and conditions positively (Cancellation Policy)", "Did the agent ask if there were any other reservations or if there was anything else?", "Did the agent follow the correct SOP?", "Did the agent close the call in an appropriate manner", "Did the agent offer to send the quote by email?", "Did the agent avoid long silences during the call?", "Did the agent display a professional manner throughout the call?", "Did the agent sound clear and confident throughout the call?", "Did the agent refrain from using jargon throughout the call?", "Did the agent sound friendly polite and welcoming?", "Did the agent use effective questioning skills?", "Did the agent demonstrate active listening?", "Greet & Engage Comment1", "Greet & Engage Comment2", "Greet & Engage Comment3", "Greet & Engage Comment4", "Qualification Comment1", "Qualification Comment2", "Qualification Comment3", "Qualification Comment4", "Recognise Comment1", "Recognise Comment2", "Overcome Objections Comment1", "Overcome Objections Comment2", "Overcome Objections Comment3", "Appropriate Closure Comment1", "Appropriate Closure Comment2", "Appropriate Closure Comment3", "Appropriate Closure Comment4", "Soft skills Comment1", "Soft skills Comment2", "Soft skills Comment3", "Soft skills Comment4", "Soft skills Comment5", "Soft skills Comment6", "Soft skills Comment7", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="stag_hen_cis"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Block Code", "Call Type", "Sub Call Type", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "1. Did the agent check if allocation was available?", "2. Did the agent load the block for the correct property and dates?", "3. Was the blackout document checked before loading the block?", "4. Did the agent created/ choose the correct contact profile for this booking with contact details stated?", "5. Is the market segments correctly inputted?", "6. Did the agent load bedrooms on the grid correctly?", "7. Did the agent add block notes to what was offered?", "8. Did the agent add the trace to the block with the correct trace date?", "9. Did the agent respond in the correct format?", "10. If rooms were taken from allocation was the allocation deducted from the master block?", "11. Did the the agent quote in the correct currency?", "12. Did the agent send it from the S and H Inbox?", "13. Did the agent use their signature at the end of the email?", "Comment 1", "Comment 2", "Comment 3", "Comment 4", "Comment 5", "Comment 6", "Comment 7", "Comment 8", "Comment 9", "Comment 10", "Comment 11", "Comment 12", "Comment 13", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="cis_gds"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Query Type", "Confirmation Number", "Audit Type", "VOC", "Audit Link","Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "1. Did the agent check that the reservation was not already in the system?", "2. Did the agent offer availability from freesale grid?", "3. Did the agent book under the correct agency profile?", "4. Did the agent ensure that the negotiated rates were picked up from the availability screen?", "5. Did the agent take the room from allocation if stated?", "6. Did the agent book the correct hotel?","7. Did the agent book the correct arrival date?", "8. Did the agent book the correct the number of nights?", "9. Did the agent book the correct number of guests?", "10. Did the agent book the correct number of rooms?", "11. Did the agent enter the guest details correctly?", "12. Are the market source and origin segments correct?", "13. Are the billing instructions correct?", "14. Did the agent put the reference in the correct fields?","15. Was the freesale grid checked before offering?","16.Did the agent respond to the TA confirming the reservation?", "COMMENT 1", "COMMENT 2", "COMMENT 3", "COMMENT 4", "COMMENT 5", "COMMENT 6", "COMMENT 7", "COMMENT 8", "COMMENT 9", "COMMENT 10", "COMMENT 11", "COMMENT 12", "COMMENT 13", "COMMENT 14", "COMMENT 15", "COMMENT 16","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="gds_prearrival"){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Query Type", "Query Sub Type", "Reference ID", "Total Opportunity", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "Backups filtered into the correct folders?", "Guest Profile Correct?", "Reference numbers added?", "Arrival/Departure Dates Correct?", "Comments Updated Correctly?", "Hotel Alignment Correct?", "Travel Agent Profile Correct?", "Company Profile Correct?", "Routed Correctly?", "Room Type Correct?", "Correct Number of Rooms Checked?", "Occupancy Correct?", "Rate Correct?", "Market Segments Correct?", "Dinner Allowance Added?", "Check Symbol Added?", "Guest Profile Correct?", "Reference Numbers added?", "Arrival/Departure Dates Correct?", "Comments Updated Correctly?", "Travel Agent Profile Correct?", "Hotel Alignment Correct?", "Routed Correctly?", "Room Type Correct?", "Correct Number of Rooms Checked?", "Occupancy Correct?", "Rate Correct?", "Market Segments Correct?", "Breakfast Package Added?", "Dinner Allowance Added?", "Check Symbol Added?", "Card Details Added?", "Saved to Backup?", "Cancelled the correct number of rooms?", "JI Bookings - Changed to DPG?", "Email Sent in accordance to JI Standards?", "No Breach of Data Protection?", "Signature Added?", "Sent from AdminRes?", "No Abbrevations Used?", "Query Sent to Backups on time?", "Query Form sent as Copy & Paste NOT Snip?", "Stag & Hen/Groups Checked with Full Complete Handover?", "Occupancy / Rooming List Correct?", "Check Symbol Added?", "Payment / Confirmation of payment type received?", "Correct Rates?", "Arrival/Departure Dates Correct?", "Comments Updated Correctly?", "Is the Bookings Checked in the Correct Format?", "Guest Names in accordance to Brand Standards?", "Comments Updated with Appropriate Actions?", "COMMENT 1", "COMMENT 2", "COMMENT 3", "COMMENT 4", "COMMENT 5", "COMMENT 6", "COMMENT 7", "COMMENT 8", "COMMENT 9", "COMMENT 10", "COMMENT 11", "COMMENT 12", "COMMENT 13", "COMMENT 14", "COMMENT 15", "COMMENT 16", "COMMENT 17", "COMMENT 18", "COMMENT 19", "COMMENT 20", "COMMENT 21", "COMMENT 22", "COMMENT 23", "COMMENT 24", "COMMENT 25", "COMMENT 26", "COMMENT 27", "COMMENT 28", "COMMENT 29", "COMMENT 30", "COMMENT 31", "COMMENT 32", "COMMENT 33", "COMMENT 34", "COMMENT 35", "COMMENT 36", "COMMENT 37", "COMMENT 38", "COMMENT 39", "COMMENT 40", "COMMENT 41", "COMMENT 42", "COMMENT 43", "COMMENT 44", "COMMENT 45", "COMMENT 46", "COMMENT 47", "COMMENT 48", "COMMENT 49", "COMMENT 50", "COMMENT 51", "COMMENT 52", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($lob=="cis_contracts"){
      $header=array(
        "Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Supervisor", "Call Date", "Call ID", "Call Type", "Call Duration", "Audit Type", "Auditor Type", "VOC","Block Code", "Channel",
        "Overall Score", "Possible Score", "Earned Score", "Customer Score", "Business Score", "Compliance Score", "Did the agent check that we have all sufficient information to send out a contract?",
        "Did the agent check the function diary ensure that we still have the meeting space available?", "Did the agent change the Status on S&C to PRO?","Did the agent update the trace date on S&C?",
        "Did the agent complete the contract with all the correct contact property and date information?", "Did the agent ensure that the correct main meeting room syndicates layout and attendees were stated?",
        "Was the Packages Description section correctly filled with the appropriate information? (If applicable)", "Was the Catering section correctly filled with the appropriate information? (If applicable)",
        "Was the Equipment section correctly filled with the appropriate information? (If applicable)", "	Was the Additional Info section correctly filled with the appropriate information? (If applicable)",
        "Was the Accommodation section correctly filled with the appropriate information? (If applicable)", "Did the agent ensure that the Rate Description Rate Amount Days and Delegates added up correctly for the total amount payable?",
        "	Did the agent state their name and date at the bottom of the contract?", "Did the agent use the correct template for sending out contracts?", "Did the agent attached the contract and meeting T&Cs?",
        "Did the agent use their signature at the end of the email?", "If non-live property did the agent email the hotel asking them to place the space on hold and then proceed with the contract?", "Comments 1",
        "Comments 2", "Comments 3", "Comments 4", "Comments 5", "Comments 6", "Comments 7", "Comments 8", "Comments 9", "Comments 10", "Comments 11", "Comments 12", "Comments 13", "Comments 14", "Comments 15",
        "Comments 16","Call Summary ","Feedback ","Agent review date","Agent review note ","Mgnt review date ","Mgnt review Name ","Mgnt review note ","Client Review date","Client review by ","Client review note"
      );
    }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($lob=="cis"){
		$edit_url = "mgnt_jurys_inn_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['pass_count'].'",';
				$row .= '"'.$user['fail_count'].'",';
				$row .= '"'.$user['na_count'].'",';
				$row .= '"'.$user['customer_score'].'%'.'",';
				$row .= '"'.$user['business_score'].'%'.'",';
				$row .= '"'.$user['compliance_score'].'%'.'",';
				$row .= '"'.$user['greet_customer'].'",';
				$row .= '"'.$user['greet1_comm'].'",';
				$row .= '"'.$user['greet_name'].'",';
				$row .= '"'.$user['greet2_comm'].'",';
				$row .= '"'.$user['greet_conversation'].'",';
				$row .= '"'.$user['greet3_comm'].'",';
				$row .= '"'.$user['greet_question'].'",';
				$row .= '"'.$user['greet4_comm'].'",';
				$row .= '"'.$user['greet_utilise'].'",';
				$row .= '"'.$user['greet5_comm'].'",';
				$row .= '"'.$user['qualifi_determine'].'",';
				$row .= '"'.$user['qualifi1_comm'].'",';
				$row .= '"'.$user['qualifi_reconfirm'].'",';
				$row .= '"'.$user['qualifi2_comm'].'",';
				$row .= '"'.$user['qualifi_customer'].'",';
				$row .= '"'.$user['qualifi3_comm'].'",';
				$row .= '"'.$user['qualifi_guest'].'",';
				$row .= '"'.$user['qualifi4_comm'].'",';
				$row .= '"'.$user['recognise_agent'].'",';
				$row .= '"'.$user['recognise1_comm'].'",';
				$row .= '"'.$user['recognise_caller'].'",';
				$row .= '"'.$user['recognise2_comm'].'",';
				$row .= '"'.$user['recognise_gdpr'].'",';
				$row .= '"'.$user['recognise3_comm'].'",';
				$row .= '"'.$user['recomend_guest'].'",';
				$row .= '"'.$user['recomend1_comm'].'",';
				$row .= '"'.$user['recomend_benefit'].'",';
				$row .= '"'.$user['recomend2_comm'].'",';
				$row .= '"'.$user['recomend_offer'].'",';
				$row .= '"'.$user['recomend3_comm'].'",';
				$row .= '"'.$user['recomend_upsell'].'",';
				$row .= '"'.$user['recomend4_comm'].'",';
				$row .= '"'.$user['recomend_room'].'",';
				$row .= '"'.$user['recomend5_comm'].'",';
				$row .= '"'.$user['overcome_positive'].'",';
				$row .= '"'.$user['overcome1_comm'].'",';
				$row .= '"'.$user['overcome_terms'].'",';
				$row .= '"'.$user['overcome2_comm'].'",';
				$row .= '"'.$user['correct_reason'].'",';
				$row .= '"'.$user['correct_reason_comm'].'",';
				$row .= '"'.$user['sale_business'].'",';
				$row .= '"'.$user['sale1_comm'].'",';
				$row .= '"'.$user['closure_booking'].'",';
				$row .= '"'.$user['closure1_comm'].'",';
				$row .= '"'.$user['follow_SOP'].'",';
				$row .= '"'.$user['closure5_comm'].'",';
				$row .= '"'.$user['closure_email'].'",';
				$row .= '"'.$user['closure2_comm'].'",';
				$row .= '"'.$user['closure_advise'].'",';
				$row .= '"'.$user['closure3_comm'].'",';
				$row .= '"'.$user['closure_ask'].'",';
				$row .= '"'.$user['closure4_comm'].'",';
				//$row .= '"'.$user['correct_call'].'",';
				//$row .= '"'.$user['cmt_comm'].'",';
				$row .= '"'.$user['ss_avoid'].'",';
				$row .= '"'.$user['ss1_comm'].'",';
				$row .= '"'.$user['ss_display'].'",';
				$row .= '"'.$user['ss2_comm'].'",';
				$row .= '"'.$user['ss_volunteer'].'",';
				$row .= '"'.$user['ss3_comm'].'",';
				$row .= '"'.$user['ss_sound'].'",';
				$row .= '"'.$user['ss4_comm'].'",';
				$row .= '"'.$user['ss_refrain'].'",';
				$row .= '"'.$user['ss5_comm'].'",';
				$row .= '"'.$user['ss_welcome'].'",';
				$row .= '"'.$user['ss6_comm'].'",';
				$row .= '"'.$user['ss_question'].'",';
				$row .= '"'.$user['ss7_comm'].'",';
				$row .= '"'.$user['ss_demonstrate'].'",';
				$row .= '"'.$user['ss8_comm'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($lob=="cis_proposal"){

		foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';

                $row .= '"'.$user['block_code'].'",';
                $row .= '"'.$user['channel'].'",';

				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['cust_score'].'",';
				$row .= '"'.$user['busi_score'].'",';
				$row .= '"'.$user['comp_score'].'",';

				$row .= '"'.$user['agent_check'].'",';
				$row .= '"'.$user['agent_check_caps'].'",';
				$row .= '"'.$user['agent_load'].'",';
				$row .= '"'.$user['function_diary'].'",';
				$row .= '"'.$user['agent_choose'].'",';
				$row .= '"'.$user['market_segment'].'",';
				$row .= '"'.$user['agent_load_bedrooms'].'",';
				$row .= '"'.$user['agent_load_meeting'].'",';
				$row .= '"'.$user['agent_add_block'].'",';
				$row .= '"'.$user['agent_add_trace'].'",';

				$row .= '"'.$user['agent_check_smart'].'",';
				$row .= '"'.$user['agent_compose'].'",';
				$row .= '"'.$user['contact_meeting'].'",';
				$row .= '"'.$user['rate_section'].'",';
				$row .= '"'.$user['agent_amend'].'",';
				$row .= '"'.$user['agent_quote'].'",';
				$row .= '"'.$user['agent_send'].'",';
				$row .= '"'.$user['agent_use_signature'].'",';

				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


		} else if($lob=="email_cis"){
		$edit_url = "mgnt_jurysinn_email_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['ref_id'].'",';
				$row .= '"'.$user['query_type'].'",';
				$row .= '"'.$user['query_sub_type'].'",';
				$row .= '"'.$user['asmnt_type'].'",';
				$row .= '"'.$user['tran_status'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['customer_score'].'%'.'",';
				$row .= '"'.$user['business_score'].'%'.'",';
				$row .= '"'.$user['compliance_score'].'%'.'",';
				$row .= '"'.$user['agentuseopening'].'",';
				$row .= '"'.$user['agentuseguestname'].'",';
				$row .= '"'.$user['agentusetemplate'].'",';
				$row .= '"'.$user['emailformatedcorrectly'].'",';
				$row .= '"'.$user['agentusesignature'].'",';
				$row .= '"'.$user['agentofferrevenue'].'",';
				$row .= '"'.$user['agentcloseemail'].'",';
				$row .= '"'.$user['agentuseinformation'].'",';
				$row .= '"'.$user['agentreconfirmterms'].'",';
				//$row .= '"'.$user['agentGDPRconfirm'].'",';
				//$row .= '"'.$user['agentfollowSOPcorrect'].'",';
				$row .= '"'.$user['agentstateguesthelp'].'",';
				$row .= '"'.$user['agentofferalternative'].'",';
				$row .= '"'.$user['agentanswerguestquestion'].'",';
				$row .= '"'.$user['agentamendedsubjectline'].'",';
				$row .= '"'.$user['agentcheckprefererate'].'",';
				$row .= '"'.$user['agentsendemailcluster'].'",';
				$row .= '"'.$user['agentensurespelling'].'",';
				$row .= '"'.$user['agnetselectcorrectproperty'].'",';
				$row .= '"'.$user['agentselectcorrectdate'].'",';
				$row .= '"'.$user['agentselectcorrectroombook'].'",';
				$row .= '"'.$user['agentuseproperratecode'].'",';
				$row .= '"'.$user['agentusepropergurantee'].'",';
				$row .= '"'.$user['agentusecorrectpayment'].'",';
				$row .= '"'.$user['agentmadeduplicatereservation'].'",';
				$row .= '"'.$user['bookingmadeoverbusiness'].'",';
				$row .= '"'.$user['agentmarkemailcorrectly'].'",';
				$row .= '"'.$user['incorrectbookingchange'].'",';
				$row .= '"'.$user['escalationagainstemail'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				//$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				//$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($lob=="stag_hen_emails"){
			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['name'].'",';
				$row .= '"'.$user['email_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['the_agent_determine'].'",';
				$row .= '"'.$user['the_blackout_document'].'",';
				$row .= '"'.$user['the_agent_quote'].'",';
				$row .= '"'.$user['agent_use_the_correct'].'",';
				$row .= '"'.$user['the_agent_update'].'",';
				$row .= '"'.$user['agent_select_add'].'",';
				$row .= '"'.$user['agent_maximise_resources'].'",';
				$row .= '"'.$user['agent_send_from'].'",';
				$row .= '"'.$user['agent_use_their'].'",';
				$row .= '"'.$user['agent_save_to'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		} else if($lob=="stag_hen_esc"){

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

								$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['name'].'",';
				$row .= '"'.$user['email_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['Engage1'].'",';
				$row .= '"'.$user['Engage2'].'",';
				$row .= '"'.$user['Engage3'].'",';
				$row .= '"'.$user['Engage4'].'",';
				$row .= '"'.$user['Qualification1'].'",';
				$row .= '"'.$user['Qualification2'].'",';
				$row .= '"'.$user['Qualification3'].'",';
				$row .= '"'.$user['Recognise1'].'",';
				$row .= '"'.$user['Recognise2'].'",';
				//$row .= '"'.$user['agentGDPRconfirm'].'",';
				//$row .= '"'.$user['agentfollowSOPcorrect'].'",';
				$row .= '"'.$user['Recommend1'].'",';
				$row .= '"'.$user['Objections1'].'",';
				$row .= '"'.$user['Objections2'].'",';
				$row .= '"'.$user['Objections3'].'",';
				$row .= '"'.$user['Closure1'].'",';
				$row .= '"'.$user['Closure2'].'",';
				$row .= '"'.$user['Closure3'].'",';
				$row .= '"'.$user['Closure4'].'",';
				$row .= '"'.$user['skills1'].'",';
				$row .= '"'.$user['skills2'].'",';
				$row .= '"'.$user['skills3'].'",';
				$row .= '"'.$user['skills4'].'",';
				$row .= '"'.$user['skills5'].'",';
				$row .= '"'.$user['skills6'].'",';
				$row .= '"'.$user['skills7'].'",';
				$row .= '"'.$user['Evaluation1'].'",';
				$row .= '"'.$user['Evaluation2'].'",';
				$row .= '"'.$user['Evaluation3'].'",';
				$row .= '"'.$user['Evaluation4'].'",';
				$row .= '"'.$user['Evaluation5'].'",';
				$row .= '"'.$user['Evaluation6'].'",';
				$row .= '"'.$user['Evaluation7'].'",';
				$row .= '"'.$user['Evaluation8'].'",';
				$row .= '"'.$user['Evaluation9'].'",';
				$row .= '"'.$user['Evaluation10'].'",';
				$row .= '"'.$user['Evaluation11'].'",';
				$row .= '"'.$user['Evaluation12'].'",';
				$row .= '"'.$user['Email1'].'",';
				$row .= '"'.$user['Email2'].'",';
				$row .= '"'.$user['Email3'].'",';
				$row .= '"'.$user['Email4'].'",';
				$row .= '"'.$user['Email5'].'",';
				$row .= '"'.$user['Email6'].'",';
				$row .= '"'.$user['Email7'].'",';
				$row .= '"'.$user['Email8'].'",';
				$row .= '"'.$user['Email9'].'",';
				$row .= '"'.$user['Email10'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt35'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt36'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt37'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt38'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt39'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt40'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt41'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt42'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt43'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt44'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt45'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt46'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($lob=="me_cis"){

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['greetcustomerapprox'].'",';
				$row .= '"'.$user['agentoffername'].'",';
				$row .= '"'.$user['ascertaincustomername'].'",';
				$row .= '"'.$user['clarifycallerfromcompany'].'",';
				$row .= '"'.$user['takedowncallercontact'].'",';
				$row .= '"'.$user['callerheardthehotel'].'",';
				$row .= '"'.$user['adoptOpenapproach'].'",';
				$row .= '"'.$user['establishedEventType'].'",';
				$row .= '"'.$user['callerRequestLocation'].'",';
				$row .= '"'.$user['callerMeetingtimedate'].'",';
				$row .= '"'.$user['clearlydiscussAVCatering'].'",';
				$row .= '"'.$user['determineaccomodationrequired'].'",';
				$row .= '"'.$user['reconfirmdelegatenumber'].'",';
				$row .= '"'.$user['determineagencyspecificprice'].'",';
				$row .= '"'.$user['callerquotedcompetetion'].'",';
				$row .= '"'.$user['establishchoiceofVenue'].'",';
				$row .= '"'.$user['promptedbythecaller'].'",';
				$row .= '"'.$user['keypackagefeatures'].'",';
				$row .= '"'.$user['offertoplacemeeting'].'",';
				$row .= '"'.$user['offeralternatepositively'].'",';
				$row .= '"'.$user['agentaskmeetingrequest'].'",';
				$row .= '"'.$user['agentclosetheCall'].'",';
				$row .= '"'.$user['reconfirmallbookingdetails'].'",';
				$row .= '"'.$user['offersendproposalviaEmail'].'",';
				$row .= '"'.$user['avoidsilencesduringCall'].'",';
				$row .= '"'.$user['displayprofessionalcall'].'",';
				$row .= '"'.$user['soundclearthroughCall'].'",';
				$row .= '"'.$user['soundFriendlyPoliteWelcome'].'",';
				$row .= '"'.$user['useeffectivequestionSkills'].'",';
				$row .= '"'.$user['demonstrateactivelistening'].'",';
				$row .= '"'.$user['callercompleteCCCSurvey'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($lob=="me_call"){

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['greetcustomerapprox'].'",';
				$row .= '"'.$user['agentoffername'].'",';
				$row .= '"'.$user['ascertaincustomername'].'",';
				$row .= '"'.$user['company_agency'].'",';
				$row .= '"'.$user['open_question'].'",';
				$row .= '"'.$user['purpose_event'].'",';
				$row .= '"'.$user['location_requesting'].'",';
				$row .= '"'.$user['caller_requesting'].'",';
				$row .= '"'.$user['timings_meeting'].'",';
				$row .= '"'.$user['room_layout'].'",';
				$row .= '"'.$user['breakout_areas'].'",';
				$row .= '"'.$user['customer_booked'].'",';
				$row .= '"'.$user['specific_price'].'",';
				$row .= '"'.$user['addons_upsell'].'",';
				$row .= '"'.$user['tone_encouraging'].'",';
				$row .= '"'.$user['features_highlighted'].'",';
				$row .= '"'.$user['alternativespositively'].'",';
				$row .= '"'.$user['meeting_space'].'",';
				$row .= '"'.$user['discussed_details'].'",';
				$row .= '"'.$user['appropriate_manner'].'",';
				$row .= '"'.$user['anything_else'].'",';
				$row .= '"'.$user['avoidsilencesduringCall'].'",';
				$row .= '"'.$user['displayprofessionalcall'].'",';
				$row .= '"'.$user['jargon_throughout'].'",';
				$row .= '"'.$user['soundclearthroughCall'].'",';
				$row .= '"'.$user['soundFriendlyPoliteWelcome'].'",';
				$row .= '"'.$user['useeffectivequestionSkills'].'",';
				$row .= '"'.$user['demonstrateactivelistening'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($lob=="stag_hen"){

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['block_code'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['sub_call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['greet_customer_appropiately'].'",';
				$row .= '"'.$user['agent_offer_name'].'",';
				$row .= '"'.$user['agent_ascertain_customer'].'",';
				$row .= '"'.$user['agent_ask_open_question'].'",';
				$row .= '"'.$user['when_customer_stay'].'",';
				$row .= '"'.$user['where_customer_stay'].'",';
				$row .= '"'.$user['agent_determine_room_guest'].'",';
				$row .= '"'.$user['determine_customer_allocation'].'",';
				$row .= '"'.$user['build_existing_rapport'].'",';
        $row .= '"'.$user['prompt_quote_rate'].'",';
				$row .= '"'.$user['agent_offer_bedrrom_onhold'].'",';
				$row .= '"'.$user['agent_offer_alternate_possiblities'].'",';
				$row .= '"'.$user['agent_present_terms'].'",';
				$row .= '"'.$user['agent_ask_reservation'].'",';
				$row .= '"'.$user['agent_follow_correct_SOP'].'",';
				$row .= '"'.$user['close_call_appropiate_manner'].'",';
				$row .= '"'.$user['send_quote_by_email'].'",';
				$row .= '"'.$user['agent_avoid_long_silence'].'",';
				$row .= '"'.$user['agent_display_call'].'",';
				$row .= '"'.$user['agent_sound_clear'].'",';
				$row .= '"'.$user['agnet_reframe_using_jargon'].'",';
				$row .= '"'.$user['agent_sound_friendly'].'",';
				$row .= '"'.$user['agent_use_effective_question'].'",';
				$row .= '"'.$user['agent_demonstrate_active_listening'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($lob=="stag_hen_cis"){

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['block_code'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['sub_call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['agent_check_available_location'].'",';
				$row .= '"'.$user['agent_block_correct_property'].'",';
				$row .= '"'.$user['agent_block_correct_property'].'",';
				$row .= '"'.$user['agent_choose_correct_profile'].'",';
				$row .= '"'.$user['correct_input_market_segment'].'",';
				$row .= '"'.$user['agent_load_bedroom_grid'].'",';
				$row .= '"'.$user['agent_add_block_note'].'",';
				$row .= '"'.$user['agent_trace_correct_date'].'",';
				$row .= '"'.$user['agent_responce_email_format'].'",';
				$row .= '"'.$user['room_allocation'].'",';
				$row .= '"'.$user['agent_quote_correct_currency'].'",';
				$row .= '"'.$user['agent_send_SH_inbox'].'",';
				$row .= '"'.$user['agent_use_signature_in_email'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($lob=="cis_gds"){
			$edit_url = "add_edit_jurysinn_input_cis_gds";
			$main_url =  $currentURL.''.$controller.'/'.$edit_url;
			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['query_type'].'",';
				$row .= '"'.$user['confirmation_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['check_reservation_in_system'].'",';
				$row .= '"'.$user['availability_from_freesale'].'",';
				$row .= '"'.$user['book_under_correct_agency'].'",';
				$row .= '"'.$user['negociate_rate_picked_up'].'",';
				$row .= '"'.$user['take_room_from_allocation'].'",';
				$row .= '"'.$user['book_correct_hotel'].'",';
				$row .= '"'.$user['book_correct_arrival_date'].'",';
				$row .= '"'.$user['book_correct_night_number'].'",';
				$row .= '"'.$user['book_correct_guest_number'].'",';
				$row .= '"'.$user['book_correct_room_number'].'",';
				$row .= '"'.$user['enter_guest_details_correctly'].'",';
				$row .= '"'.$user['correct_origin_segment'].'",';
				$row .= '"'.$user['correct_billing_instructions'].'",';
				$row .= '"'.$user['put_reference_in_correct_fields'].'",';
				$row .= '"'.$user['freesale_grid_checked'].'",';
				$row .= '"'.$user['confirming_the_reservation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($lob=="gds_prearrival"){

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['query_type'].'",';
				$row .= '"'.$user['query_sub_type'].'",';
				$row .= '"'.$user['reference_id'].'",';
				$row .= '"'.$user['total_opportunity'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['backup_filter'].'",';
				$row .= '"'.$user['backup_guest_profile'].'",';
				$row .= '"'.$user['backup_reference_number'].'",';
				$row .= '"'.$user['backup_arrival_departure_date'].'",';
				$row .= '"'.$user['backup_comment_updated'].'",';
				$row .= '"'.$user['backup_hotel_alignment'].'",';
				$row .= '"'.$user['backup_travel_agent_profile'].'",';
				$row .= '"'.$user['backup_company_profile'].'",';
				$row .= '"'.$user['backup_routed_correctly'].'",';
				$row .= '"'.$user['backup_room_type'].'",';
				$row .= '"'.$user['backup_correct_room_number'].'",';
				$row .= '"'.$user['backup_correct_occupency'].'",';
				$row .= '"'.$user['backup_correct_rate'].'",';
				$row .= '"'.$user['backup_market_segment'].'",';
				$row .= '"'.$user['backup_dinner_allowences'].'",';
				$row .= '"'.$user['backup_symbol_check'].'",';
				$row .= '"'.$user['extranet_guest_profile'].'",';
				$row .= '"'.$user['extranet_reference_number'].'",';
				$row .= '"'.$user['extranet_arrival_departure_date'].'",';
				$row .= '"'.$user['extranet_comment_update'].'",';
				$row .= '"'.$user['extranet_travel_agent'].'",';
				$row .= '"'.$user['extranet_hotel_alignment'].'",';
				$row .= '"'.$user['extranet_routed_correctly'].'",';
				$row .= '"'.$user['extranet_correct_room_type'].'",';
				$row .= '"'.$user['extranet_correct_number'].'",';
				$row .= '"'.$user['extranet_occupency_correct'].'",';
				$row .= '"'.$user['extranet_correct_rate'].'",';
				$row .= '"'.$user['extranet_market_segment'].'",';
				$row .= '"'.$user['extranet_breakfast_package'].'",';
				$row .= '"'.$user['extranet_dinner_allowances'].'",';
				$row .= '"'.$user['extranet_check_symbol'].'",';
				$row .= '"'.$user['extranet_card_details'].'",';
				$row .= '"'.$user['extranet_backup_saved'].'",';
				$row .= '"'.$user['extranet_cancel_correct_room'].'",';
				$row .= '"'.$user['extranet_ji_booking'].'",';
				$row .= '"'.$user['email_send_ji_standard'].'",';
				$row .= '"'.$user['no_breach_data_protection'].'",';
				$row .= '"'.$user['signature_added'].'",';
				$row .= '"'.$user['send_AdminRes'].'",';
				$row .= '"'.$user['no_abbreviation_used'].'",';
				$row .= '"'.$user['query_sent_backup_time'].'",';
				$row .= '"'.$user['query_sent_not_snip'].'",';
				$row .= '"'.$user['stag_hen_group_check'].'",';
				$row .= '"'.$user['rooming_list_correct'].'",';
				$row .= '"'.$user['check_symbol_added'].'",';
				$row .= '"'.$user['payment_type_received'].'",';
				$row .= '"'.$user['groups_correct_rate'].'",';
				$row .= '"'.$user['groups_arrival_departure_date'].'",';
				$row .= '"'.$user['groups_comments_updated'].'",';
				$row .= '"'.$user['booking_check_correct_format'].'",';
				$row .= '"'.$user['guest_name_brand_standart'].'",';
				$row .= '"'.$user['comment_update_appropiate_standart'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt35'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt36'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt37'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt38'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt39'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt40'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt41'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt42'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt43'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt44'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt45'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt46'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt47'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt48'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt49'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt50'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt51'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt52'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($lob=="cis_contracts"){
      foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_id'].'",';
        $row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';

        $row .= '"'.$user['block_code'].'",';
        $row .= '"'.$user['channel'].'",';

				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['cust_score'].'",';
				$row .= '"'.$user['busi_score'].'",';
				$row .= '"'.$user['comp_score'].'",';

        $row .= '"'.$user['sufficient_info_contract'].'",';
				$row .= '"'.$user['agent_check'].'",';
				$row .= '"'.$user['agent_change'].'",';
				$row .= '"'.$user['agent_update'].'",';
				$row .= '"'.$user['agent_complete'].'",';
				$row .= '"'.$user['agent_ensure'].'",';
				$row .= '"'.$user['packages_description'].'",';
				$row .= '"'.$user['catering_section'].'",';
				$row .= '"'.$user['equipment_section'].'",';
				$row .= '"'.$user['additional_info'].'",';
				$row .= '"'.$user['accommodation_section'].'",';
				$row .= '"'.$user['description_rate'].'",';

				$row .= '"'.$user['agent_state'].'",';
				$row .= '"'.$user['agent_use'].'",';
				$row .= '"'.$user['agent_attached'].'",';
				$row .= '"'.$user['agent_signature'].'",';
				$row .= '"'.$user['agent_email'].'",';

				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

	}

///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// QA Indiabulls REPORT ////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_indiabulls_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_indiabulls_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = $this->input->get('campaign');


			$data["qa_indiabulls_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_indiabulls_list"] = $fullAray;
				$this->create_qa_indiabulls_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_indiabulls_CSV/".$campaign;

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_indiabulls_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		if($campaign=="indiabulls"){
			$cmpgn='Indiabulls';
		}if($campaign=="indiabulls_new"){
			$cmpgn='Indiabulls_new';
		}else if($campaign=="indiabulls_nas_hygn"){
			$cmpgn='Indiabulls New Audit Sheet';
		}else if($campaign=="indiabulls_sa_hygn"){
			$cmpgn='Indiabulls Super Audit';
		}
		$newfile="QA ".$cmpgn." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_indiabulls_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=='indiabulls'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time", "Call Duration", "Outgoing Number", "Campaign", "Register No", "Call Link", "Agent Tagging", "Actual Tagging", "Type Of Call", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "IB_Disposition", "IB_Sub-Disposition", "Greeting", "Closing", "Coprehending", "Customer Ownership For Payment", "Hold", "Behavior", "Language", "Proactive Information", "Disposition", "Overall Score", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review By", "Mgnt Review Date", "Mgnt Comment", "Client Reviw By", "Client Reviw Date", "Client Reviw Note");
		    }else if($campaign=='indiabulls_new'){
			$header = array("Timestamp","Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date", "Call Duration", "Process", "Mobile Number", "ACPT", "L2 agent Gap", "L2 Customer Gap and Process & Technical Gap", "AON","Dead Air on call","Was Agent Dull on Call","Agreement ID","Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Call Rating", "VOC Of Customer", "Fatal", "Was agent Behavior good on call", "If No what was the Reason", "Was Complete & Correct information given", "if No what was the Reason", "Was Effort & Urgency Created", "If No what was the Reason", "Was Tagged Correct or not", "Reason for wrong tagging","Feedback Shared with agents in front of TL","IF No What is the Reason","Was Opening Given As process","Was Closing Given on call as per Process","Audit Type","Campaign","Overall Score", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review By", "Mgnt Review Date", "Mgnt Comment", "Client Reviw By", "Client Reviw Date", "Client Reviw Note");
		   }else if($campaign=='indiabulls_nas_hygn'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date", "Call Duration", "Phone", "Lan ID", "Week", "Disposition", "Sub Disposition", "Actual Disposition", "Actual Sub Disposition", "Compliance / Non compliance", "Call Observation", "Non Compliance Reason", "Payment Status", "Urgency Create by agents", "AOI", "BOD", "Feedback reason", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review By", "Mgnt Review Date", "Mgnt Comment", "Client Reviw By", "Client Reviw Date", "Client Reviw Note");
		}else if($campaign=='indiabulls_sa_hygn'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date", "Call Duration", "Phone", "Call Completed By", "Audit Observations", "Status", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review By", "Mgnt Review Date", "Mgnt Comment", "Client Reviw By", "Client Reviw Date", "Client Reviw Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='indiabulls'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['outgoing_no'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['agent_tagging'].'",';
				$row .= '"'.$user['actual_tagging'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['ib_dispo'].'",';
				$row .= '"'.$user['ib_subdispo'].'",';
				$row .= '"'.$user['greeting'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['coprehending'].'",';
				$row .= '"'.$user['ownership'].'",';
				$row .= '"'.$user['hold'].'",';
				$row .= '"'.$user['behaviour'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['proactive'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		  } else if($campaign=='indiabulls_new'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['timestamp'].'",';
				$row .= '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['mobile_number'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['agent_gap'].'",';
				$row .= '"'.$user['customer_gap'].'",';
				$row .= '"'.$user['aon'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['was_agent_dull'].'",';
				$row .= '"'.$user['agreement_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';

				$row .= '"'.$user['call_rating'].'",';
				$row .= '"'.$user['voc_of_customer'].'",';
				$row .= '"'.$user['fatal'].'",';
				$row .= '"'.$user['was_agent_behavior'].'",';
				$row .= '"'.$user['if_no_what_was1'].'",';
				$row .= '"'.$user['was_complete_correct'].'",';
				$row .= '"'.$user['if_no_what_was2'].'",';
				$row .= '"'.$user['was_effort_urgency'].'",';
				$row .= '"'.$user['if_no_what_was3'].'",';
				$row .= '"'.$user['was_tagged_correct'].'",';
				$row .= '"'.$user['reason_for_wrong'].'",';
				$row .= '"'.$user['feedback_shared'].'",';
				$row .= '"'.$user['if_of_what'].'",';
				$row .= '"'.$user['was_opening_given'].'",';
				$row .= '"'.$user['was_closing_given'].'",';
				$row .= '"'.$user['audit_type_para'].'",';
				$row .= '"'.$user['campaign'].'",';

				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		} else if($campaign=='indiabulls_nas_hygn'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['lan_id'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['sub_disposition'].'",';
				$row .= '"'.$user['actual_disposition'].'",';
				$row .= '"'.$user['actual_sub_disposition'].'",';
				$row .= '"'.$user['compliance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_observation'])).'",';
				$row .= '"'.$user['non_compliance_reason'].'",';
				$row .= '"'.$user['payment_status'].'",';
				$row .= '"'.$user['urgent_create_agent'].'",';
				$row .= '"'.$user['aoi'].'",';
				$row .= '"'.$user['bod'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback_reason'])).'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='indiabulls_sa_hygn'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['call_completed_by'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['observation'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['status'])).'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}
	}


/////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////// QA IDFC REPORT ////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

public function qa_idfc_report(){
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_idfc_report.php";
		$data["content_js"] = "qa_metropolis_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$campaign="";
		$audit_type="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";


		$data["qa_idfc_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$campaign = $this->input->get('campaign');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All") $cond .= "";
			else $cond .=" and audit_type='$audit_type'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else if(get_login_type()=="client"){
				$cond1 .=" And audit_type not in ('Operation Audit','Trainer Audit')";
			}else{
				$cond1 .="";
			}

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_idfc_list"] = $fullAray;
			$this->create_qa_idfc_CSV($fullAray,$campaign);
			$dn_link = base_url()."reports_qa/download_qa_idfc_CSV";
		}

		$data['download_link']=$dn_link;
		$data["action"] = $action;
		$data['date_from'] = $date_from;
		$data['date_to'] = $date_to;
		$data['office_id']=$office_id;
		$data['campaign']=$campaign;
		$data['audit_type']=$audit_type;

		$this->load->view('dashboard',$data);
	}
}


public function download_qa_idfc_CSV(){
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA IDFC Audit List-'".$currDate."'.csv";

	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_idfc_CSV($rr,$campaign){
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	if($campaign=='idfc_new'){
		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date Time", "Week", "Cycle Date", "Phone", "Customer Name", "Disposition", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Earned Score","Possible Score", "Overall Score", "Agent opened the call with the desired enthusiasm in 3 seconds", "Agent clearly introduced himself/herself to the customer", "Agent introduced the company he/she is calling from", "Agent used the prescribed script as per previous disposition", "Agent clearly explained the objective of calling the customer", "Agent quoted the previous call commitment made my the customer", "Agent reminds and gets agreement of a customer on number of broken PTP or Already Paid as applicable", "Agent created the urgency in the call to collect the payment", "Agent reiterated the impact due to delay in payment like cibil adhar etc", "Agent gave appropriate and effective rebuttal when the payment was delayed or being differed", "Agent promoted paid C modes to the customer", "Agent did the right probing to gather information from the customer in case of already paid", "Agent checked relevent tools notes details and historry before call back", "Third party disclosure", "Agent updated correct time for call back customer details updated accurately in COSMOS and VICI dial", "Agent used verbal nods to display interest in customers avoids dead-air", "Agent avoided speaking over or interrupt the customer and apologized if interrupted", "Agent acknowledged and/or empathized where appropriate", "Agent sounded confident and showed no sign of hesitancy to convey information", "Clear Explanations - Articulation sentence construction grammar etc", "Agents rate of speech was moderate", "Agent sounded courteous and energetic", "Listening and comprehension", "Agent did not provide/ confirm Incorrect/ incomplete information", "Agent did not follow Incorrect procedure followed to resolve an issue raised by the customer or made No promise", "Agent responded on question or query raised by the customer", "Agent followed the correct Hold procedure", "Agent followed the correct transfer procedure", "Agent did not Disconnect call before the customer or hung up on customer", "Agent was not abusive during the call", "Agent was not side-talking or speaking to another colleague while customer on line", "Agent complied to the call closure script", "Agents tone was appropriate while closing the call", "Follow-up call and appointment fixed as agreed with the customer", "Greeting Score", "Purpose Call Score", "Collection Technique Score", "Communicatio Skill Score", "Telephone Etiquette Score", "Call Closing Score", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
	}else if($campaign=='idfc'){
		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date Time", "Week", "Customer Phone", "Customer Name", "Loan ID", "Product Name", "Customer VOC", "Customer Sub VOC", "Campaign Name", "Objections", "Call Duration", "Agent Disposition", "QA Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Earned Score","Possible Score", "Overall Score",
		"Greeting & Customer Identification","Remarks", "Self Introduction & Reaching RPC","Remarks", "Purpose of call","Remarks", "Complete & Correct information Minor Impact","Remarks", "** Incomplete or Incorrect information","Remarks", "** Incomplete or Wrong Information","Remarks", "Confirmed PU and PTP details","Remarks", "Referred the Trail remarks in CRM","Remarks", "Referred customers Payment history","Remarks", "** Use convincing skills for early payment","Remarks", "Follow appropriate and relevant probing as per the process","Remarks", "Identify accurate reasons of payment delay","Remarks", "Objection Handing","Remarks", "Online payment effectively pitched","Remarks", "Active Listening","Remarks", "Clarity of Speech & Rate of Speech","Remarks", "Tone and Voice Modulation","Remarks", "Empathy","Remarks", "Confidence","Remarks", "Language and Grammar","Remarks", "Telephone Etiquettes & Hold Procedure","Remarks", "** Rudeness or Unprofessionalism","Remarks", "CRM protocol","Remarks", "Capture Alternate number","Remarks", "CRM protocol - Field and Remark Updation","Remarks", "CRM protocol - Disposition","Remarks", "Summarization","Remarks", "Strong assurance on PU PTP","Remarks", "Closing","Remarks",
		"Call Summary", "Feedback", "Agent Feedback Acceptance Status", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
	}else if($campaign=='idfc_loan'){
		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date Time", "Week", "Customer Phone", "Customer Name", "Loan ID", "Product Name", "Customer VOC", "Customer Sub VOC", "Campaign Name", "Objections", "Call Duration", "Agent Disposition", "QA Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Earned Score","Possible Score", "Overall Score",
		"Greeting & Customer Identification", "Call Opening Commt","Self Introduction & Reaching RPC", "Call Opening2 Commt","Purpose of call","Call Opening3 Commt", "Complete & Correct information Minor Impact", "Information Commt","** Incomplete or Incorrect information", "Information2 Commt", "** Incomplete or Wrong Information", "Information Commt3","Confirmed PU and PTP details","Information4 Commt", "Referred the Trail remarks in CRM", "CRM Commt","Referred customers Payment history","CRM2 Commt", "** Use convincing skills for early payment","Urgency Commt", "Follow appropriate and relevant probing as per the process","Effective Commt", "Identify accurate reasons of payment delay","Reason Commt", "Objection Handing","Objection Commt", "Online payment effectively pitched","Appropriate Commt", "Active Listening", "Soft Skill Commt", "Clarity of Speech & Rate of Speech", "Soft Skill2 Commt", "Tone and Voice Modulation", "Soft Skill3 Commt", "Empathy", "Soft Skill4 Commt", "Confidence", "Soft Skill5 Commt", "Language and Grammar", "Soft Skill6 Commt", "Telephone Etiquettes & Hold Procedure", "Soft Skill7 Commt", "** Rudeness or Unprofessionalism","Soft Skill8 Commt", "CRM protocol", "Protocol Commt", "Capture Alternate number", "Protocol2 Commt", "CRM protocol - Field and Remark Updation", "Protocol3 Commt", "CRM protocol - Disposition","Protocol4 Commt", "Summarization", "Call Closing Commt", "Strong assurance on PU PTP", "Call Closing2 Commt", "Closing","Call Closing3 Commt",
		"Call Summary", "Feedback", "Agent Feedback Acceptance Status", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
	}

	$row = "";
	foreach($header as $data) $row .= ''.$data.',';
	fwrite($fopen,rtrim($row,",")."\r\n");
	$searches = array("\r", "\n", "\r\n");

	if($campaign=='idfc_new'){

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date_time'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['cycle_date'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['customer_name'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['agentopencallin3sec'].'",';
			$row .= '"'.$user['agentintroducehimself'].'",';
			$row .= '"'.$user['agentintroducecompany'].'",';
			$row .= '"'.$user['agentusedprescribedscript'].'",';
			$row .= '"'.$user['agentclearlyexplained'].'",';
			$row .= '"'.$user['agentquotedpreviouscall'].'",';
			$row .= '"'.$user['agentgetsagreement'].'",';
			$row .= '"'.$user['agentcreateurjency'].'",';
			$row .= '"'.$user['agentreiteratedtheimpact'].'",';
			$row .= '"'.$user['agentgaveeffectiverebruttal'].'",';
			$row .= '"'.$user['agentpromotedpaidC'].'",';
			$row .= '"'.$user['agentdidrightprobing'].'",';
			$row .= '"'.$user['agentcheckrelevanttool'].'",';
			$row .= '"'.$user['3rdpartydisclosure'].'",';
			$row .= '"'.$user['agentupdatedcalltime'].'",';
			$row .= '"'.$user['agentusedverbalnods'].'",';
			$row .= '"'.$user['agentavoidspeakingover'].'",';
			$row .= '"'.$user['agentemphathizedappropiate'].'",';
			$row .= '"'.$user['agentsoundedconfident'].'",';
			$row .= '"'.$user['clearexpansion'].'",';
			$row .= '"'.$user['agentrateofspeech'].'",';
			$row .= '"'.$user['agentsoundedenergetic'].'",';
			$row .= '"'.$user['listeningandcomprehensive'].'",';
			$row .= '"'.$user['agentnotprovideinfo'].'",';
			$row .= '"'.$user['agentnotfollowincorrectprocedure'].'",';
			$row .= '"'.$user['agentresponceonquestion'].'",';
			$row .= '"'.$user['agentfollowHoldprocedure'].'",';
			$row .= '"'.$user['agentfollowtransferprocedure'].'",';
			$row .= '"'.$user['agentnotDisconnectcall'].'",';
			$row .= '"'.$user['agentwasnotabuseonCall'].'",';
			$row .= '"'.$user['agentnotSitetakingonCall'].'",';
			$row .= '"'.$user['agentcompiledoncall'].'",';
			$row .= '"'.$user['agenttoneappropiateonCall'].'",';
			$row .= '"'.$user['followupcallwiththeCustomer'].'",';
			$row .= '"'.$user['greetingscore'].'",';
			$row .= '"'.$user['purposecallscore'].'",';
			$row .= '"'.$user['collectiontechniquescore'].'",';
			$row .= '"'.$user['communicatioskillscore'].'",';
			$row .= '"'.$user['telephoneetiquettescore'].'",';
			$row .= '"'.$user['callclosingscore'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.ConvServerToLocal($user['agent_rvw_date']).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.ConvServerToLocal($user['mgnt_rvw_date']).'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.ConvServerToLocal($user['client_rvw_date']).'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}else if($campaign=='idfc'){

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			if($user['agent_rvw_date']!="") $agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
			else $agent_rvw_date="";

			if($user['mgnt_rvw_date']!="") $mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
			else $mgnt_rvw_date="";

			if($user['client_rvw_date']!="") $client_rvw_date=ConvServerToLocal($user['client_rvw_date']);
			else $client_rvw_date="";

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['customer_phone'].'",';
			$row .= '"'.$user['customer_name'].'",';
			$row .= '"'.$user['loan_id'].'",';
			$row .= '"'.$user['product_name'].'",';
			$row .= '"'.$user['customer_voc'].'",';
			$row .= '"'.$user['customer_sub_voc'].'",';
			$row .= '"'.$user['campaign_name'].'",';
			$row .= '"'.$user['objections'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['agent_disposition'].'",';
			$row .= '"'.$user['qa_disposition'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
			$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['customer_identification'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'.$user['self_introduction'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'.$user['purpose_of_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'.$user['complete_correct'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'.$user['incomplete_incorrect'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'.$user['incomplete_wrong'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'.$user['confirmed_pu'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'.$user['referred_the_trail'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'.$user['referred_customers_payment'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'.$user['use_convincing_skills'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'.$user['follow_appropriate'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'.$user['identify_accurate_reasons'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'.$user['objection_handling'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'.$user['online_payment'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'.$user['clarity_speech'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'.$user['tone_and_voice'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'.$user['confidence'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'.$user['language_and_grammar'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
			$row .= '"'.$user['telephone_etiquettes'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
			$row .= '"'.$user['rudeness_unprofessionalism'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
			$row .= '"'.$user['crm_protocol'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
			$row .= '"'.$user['capture_alternate'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
			$row .= '"'.$user['field_and_remark'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
			$row .= '"'.$user['crm_protocol_disposition'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
			$row .= '"'.$user['summarization'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
			$row .= '"'.$user['strong_assurance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$agent_rvw_date.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$mgnt_rvw_date.'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$client_rvw_date.'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}else if($campaign=='idfc_loan'){

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			if($user['agent_rvw_date']!="") $agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
			else $agent_rvw_date="";

			if($user['mgnt_rvw_date']!="") $mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
			else $mgnt_rvw_date="";

			if($user['client_rvw_date']!="") $client_rvw_date=ConvServerToLocal($user['client_rvw_date']);
			else $client_rvw_date="";

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['customer_phone'].'",';
			$row .= '"'.$user['customer_name'].'",';
			$row .= '"'.$user['loan_id'].'",';
			$row .= '"'.$user['product_name'].'",';
			$row .= '"'.$user['customer_voc'].'",';
			$row .= '"'.$user['customer_sub_voc'].'",';
			$row .= '"'.$user['campaign_name'].'",';
			$row .= '"'.$user['objections'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['agent_disposition'].'",';
			$row .= '"'.$user['qa_disposition'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
			$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['customer_identification'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_opening_cmt'])).'",';
			$row .= '"'.$user['self_introduction'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_opening2_cmt'])).'",';
			$row .= '"'.$user['purpose_of_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_opening3_cmt'])).'",';
			$row .= '"'.$user['complete_correct'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['information_cmt'])).'",';
			$row .= '"'.$user['incomplete_incorrect'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['information2_cmt'])).'",';
			$row .= '"'.$user['incomplete_wrong'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['information3_cmt'])).'",';
			$row .= '"'.$user['confirmed_pu'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['information4_cmt'])).'",';
			$row .= '"'.$user['referred_the_trail'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['crm_cmt'])).'",';
			$row .= '"'.$user['referred_customers_payment'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['crm2_cmt'])).'",';
			$row .= '"'.$user['use_convincing_skills'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['urgency_cmt'])).'",';
			$row .= '"'.$user['follow_appropriate'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['effective_cmt'])).'",';
			$row .= '"'.$user['identify_accurate_reasons'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reason_cmt'])).'",';
			$row .= '"'.$user['objection_handling'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['objection_cmt'])).'",';
			$row .= '"'.$user['online_payment'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['appropriate_cmt'])).'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill_cmt'])).'",';
			$row .= '"'.$user['clarity_speech'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill2_cmt'])).'",';
			$row .= '"'.$user['tone_and_voice'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill3_cmt'])).'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill4_cmt'])).'",';
			$row .= '"'.$user['confidence'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill5_cmt'])).'",';
			$row .= '"'.$user['language_and_grammar'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill6_cmt'])).'",';
			$row .= '"'.$user['telephone_etiquettes'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill7_cmt'])).'",';
			$row .= '"'.$user['rudeness_unprofessionalism'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['soft_skill8_cmt'])).'",';
			$row .= '"'.$user['crm_protocol'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['protocol_cmt'])).'",';
			$row .= '"'.$user['capture_alternate'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['protocol2_cmt'])).'",';
			$row .= '"'.$user['field_and_remark'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['protocol3_cmt'])).'",';
			$row .= '"'.$user['crm_protocol_disposition'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['protocol4_cmt'])).'",';
			$row .= '"'.$user['summarization'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_closing_cmt'])).'",';
			$row .= '"'.$user['strong_assurance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_closing2_cmt'])).'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_closing3_cmt'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$agent_rvw_date.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$mgnt_rvw_date.'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$client_rvw_date.'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}


}


/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////// QA Ideal Living REPORT //////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_il_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_il_report.php";
			$data["content_js"] = "qa_metropolis_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$process="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$process = $this->input->get('process');

			$data["qa_il_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}
				if($process == 'verification'){
					$table = 'qa_il_sales_'.$process.'_feedback';
				}else if($process == 'mercy'){
					$table = 'qa_'.$process.'_feedback';
				}else{
					$table = 'qa_ideal_living_'.$process.'_feedback';
				}
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from $table) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";



				// $qSql="SELECT * from
				// (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				// (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				// (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				// (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				// (select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_ideal_living_".$process."_feedback) xx Left Join
				// (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_il_list"] = $fullAray;
				$this->create_qa_il_CSV($fullAray,$process);
				$dn_link = base_url()."reports_qa/download_qa_il_CSV/".$process;

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['process']=$process;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_il_CSV($process)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$process." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_il_CSV($rr,$process)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_ideal_living";

		$fopen = fopen($filename,"w+");

		if($process=='sales'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "TL", "Call Date", "Call Duration", "Call Type", "Can be Automated", "Product", "QA Type", "Disposition", "Recording ID", "Audit Type", "VOC","Audit Link","Correct Disposition","Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Auto Fail", "Overall Score", "Greeting", "Probing Question", "Product Benefit", "Closing the Sales", "Rebuttals", "Rapport Empathy", "Product Knowledge", "Speed Clarity", "Professional ethics Emotional Intelligence", "Enthusiasm Passion About Selling", "Main Offers Compliance", "Upsells Compliance", "E-Mail Compliance", "Legal Terms Confirmation Compliance", "Third party separation Compliance", "Acknowledge", "Build Value", "Close the Sale", "Call Summary", "Feedback", "Agent Review Date", "Agent Feedback Acceptance", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($process=='cs_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "TL", "Call Date", "Call Duration", "Product", "Call Type", "Can be Automated", "QA Type", "Disposition", "Recording ID", "Order/Acct Number", "Audit Type", "VOC", "Correct Disposition","Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Geography","Auto Fail", "Overall Score","The agent greets the customer with a happy and friendly tone of voice mentions his name the name of the company and offers his help.","The agent verified the customers account using the appropriate information (name and surname address city state and zip code)","The agent understands perfectly the reason for the call. The agent summarized the main points of the client before solving problems or offering a solution listens to the customer issue this is done in a tone of Helpful voice without sounding rude.","Agent is attentive to callers questions or queries and shows understanding of the matter mentioned by caller.","The agent ends the call confirming the final Status of his call. The agent offers further assistance before finalizing the call. The agent thanks the customer for communicating. The agent mentions the companys name. The agent does everything with a good and understandable tone of voice and attitude of service.","Agent builds a personal relationship with the caller like talking to a friend creates interest and trust. And provides and emotional connection by letting the caller know they understand the callers feelings","The agent is an expert with the product knowledge and FAQ. Answers all questions accurately and educates the caller.","The agent speaks with a strong steady speed or pace. Not to Fast and Not to Slow and The agent voice is clear and can be understood throughout the call.","The agent always respects and listens to the caller and does not interrupt the caller. The agent is honest and ethical. Controls their emotions and is not rude to the caller.","The agent sounds happy and excited and has energy when speaking to the caller. It is easy to see they love their job.","Agents chooses correct call disposition.","The agent correctly performs the process of making new orders and/or warranty replacement orders. The agent is NOT too pushy to try to make a sell. The agent makes the properly wrap up for the new order/warranty replacement.","The agent properly gives all the return instructions as they were instructed. The agent properly cancel the acc and saves all the changes on the customer account. The agent confirms the amount to be reimbursed and to which card the reimbursement would be made (last 4 digits) and explains that the time for a refund is between 24 to 48 hours. explains to the client that it is not necessary to contact the bank and if he has any questions and he can contact us back.","The agent is an expert with the processes and the system use and shows knowledge and confidence during the call","The agent solved the customer issue on a timely manner and with a positive attitude and avoiding any unnecessary call back for the same situation. The agent followed the correct procedure and made all proper changes and comments on the customer account.","Agent asks the correct questions to understand callers reasons to cancel or return.","Agents explains product benefits and shows knowledge of use and its features.","Agents makes offers to save the sales accordingly.","Call Summary", "Feedback", "Agent Review Date", "Agent Feedback Acceptance", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($process == 'verification'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "TL", "Call Date", "Call Duration", "Product", "Disposition", "Recorded Id",  "Wrong Disposition", "Correct Disposition" , "Audit Type", "QA Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greeting", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($process=='mercy'){
			$header = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","Disposition ","CDRID ","Agent Assessment Request History as Requested by Client or AMD ","Overall Score ","Possible Score ","Earned Score ","Greeting / Closing ","Smile / Enthusiasm ","Info Capture / Verification ","Accuracy of Data Entry in ACDD CRM & Qgiv Payment Processing Page ","Acknowledgement or Empathy ","Appreciation (Donor Services Desire to Volunteer Etc.) ","Tone / Pace ","Positive Phrasing ","Script Adherence ","Active Listening ","Proper Use of Navigational Tools / Help Buttons / FAQs ","Disposition of Call ","Redirect/Rebuttals ","Agent Engagement ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date" );
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($process=='sales'){
			$edit_url = "add_edit_sales";
		    $main_url =  $currentURL.''.$controller.'/'.$edit_url;
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['can_automated'].'",';
				$row .= '"'.$user['product'].'",';
				$row .= '"'.$user['qa_type'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['recording_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['auto_fail'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greeting'].'",';
				$row .= '"'.$user['probing_question'].'",';
				$row .= '"'.$user['product_benefit'].'",';
				$row .= '"'.$user['close_the_sale'].'",';
				$row .= '"'.$user['rebuttals'].'",';
				$row .= '"'.$user['rapport'].'",';
				$row .= '"'.$user['product_knowledge'].'",';
				$row .= '"'.$user['speed_clarity'].'",';
				$row .= '"'.$user['professional_ethics'].'",';
				$row .= '"'.$user['passion_selling'].'",';
				$row .= '"'.$user['main_offers'].'",';
				$row .= '"'.$user['upsell_compliance'].'",';
				$row .= '"'.$user['prepays_compliance'].'",';
				$row .= '"'.$user['legal_terms'].'",';
				$row .= '"'.$user['third_party_separation'].'",';
				$row .= '"'.$user['acknowledge'].'",';
				$row .= '"'.$user['build_value'].'",';
				$row .= '"'.$user['sale_close'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($process=='cs_new'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['product'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['can_automated'].'",';
				$row .= '"'.$user['qa_type'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['recording_id'].'",';
				$row .= '"'.$user['order_accnt'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['geography'].'",';
				$row .= '"'.$user['autofail'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_greets_the_customer'].'",';
				$row .= '"'.$user['the_agent_verified'].'",';
				$row .= '"'.$user['the_agent_understands'].'",';
				$row .= '"'.$user['agent_is_attentive'].'",';
				$row .= '"'.$user['agent_ends_the_call'].'",';
				$row .= '"'.$user['agent_builds_personal'].'",';
				$row .= '"'.$user['agent_an_expert'].'",';
				$row .= '"'.$user['agent_speaks_with'].'",';
				$row .= '"'.$user['agent_always_respects'].'",';
				$row .= '"'.$user['agent_sounds_happy'].'",';
				$row .= '"'.$user['agents_chooses_correct'].'",';
				$row .= '"'.$user['agent_correctly_performs'].'",';
				$row .= '"'.$user['agent_properly_gives'].'",';
				$row .= '"'.$user['agent_an_expert_processes'].'",';
				$row .= '"'.$user['agent_solved_customer'].'",';
				$row .= '"'.$user['agent_asks_the_correct'].'",';
				$row .= '"'.$user['agents_explains_product'].'",';
				$row .= '"'.$user['agents_makes_offers'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($process == 'verification'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['product'].'",';
				// $row .= '"'.$user['qa_type'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['recorded_id'].'",';
				$row .= '"'.$user['wrong_disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greeting'].'",';
				// $row .= '"'.$user['professionalism'].'",';
				// $row .= '"'.$user['empathy'].'",';
				// $row .= '"'.$user['closure'].'",';
				// $row .= '"'.$user['problem_solving_skill'].'",';
				// $row .= '"'.$user['solve_problem'].'",';
				// $row .= '"'.$user['save_the_sale'].'",';
				// $row .= '"'.$user['new_order'].'",';
				// $row .= '"'.$user['return_instruction'].'",';
				// $row .= '"'.$user['account_verification'].'",';
				// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($process == 'mercy'){

				$field_name="SHOW FULL COLUMNS FROM qa_".$process."_feedback WHERE Comment!=''";
				$field_name=$this->Common_model->get_query_result_array($field_name);
				$fld_cnt=count($field_name);
				for($i=0;$i<$fld_cnt;$i++){
								$val=$field_name[$i]['Field'];
								if($val!=""){
									$field_val[]=$val;
								}
							 }

				array_unshift($field_val ,"auditor_name");
				$key = array_search ('agent_id', $field_val);
				array_splice($field_val, $key, 0, 'fusion_id');
				$field_val=array_values($field_val);

				$count_for_field=count($field_val);

				// print_r($rr);
				// die;
				foreach($rr as $user)
				{
					for($z=0;$z<$count_for_field;$z++){

						if($field_val[$z]==="auditor_name"){
							$row = '"'.$user['auditor_name'].'",';
						}elseif($field_val[$z]==="fusion_id"){
							$row .= '"'.$user['fusion_id'].'",';
						}elseif($field_val[$z]==="agent_id"){
							$row .= '"'.$user['fname']." ".$user['lname'].'",';
						}elseif($field_val[$z]==="tl_id"){
							$row .= '"'.$user['tl_name'].'",';
						}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

		    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

						}else{
							$row .= '"'.$user[$field_val[$z]].'",';
						}

					}

						fwrite($fopen,$row."\r\n");
						$row = "";
				}

				fclose($fopen);
		}

	}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////



//////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////Romtech///////////////////////////////////////////////////


public function qa_romtech_report() // working


	{
		if(check_logged_in()){





			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_romtech_report.php";

				$data["content_js"] = "qa_romtech_js.php";// js file for this page


			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$campaign="";
			$campaign = $this->input->get('campaign');

		//	$data["qa_ajio_list"] = array();


				if($this->input->get('show')=='Show')
				{
					$date_from = mmddyy2mysql($this->input->get('date_from'));
					$date_to = mmddyy2mysql($this->input->get('date_to'));
					$office_id = $this->input->get('office_id');

					if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
					}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
						$cond1 .=" And assigned_to='$current_user'";
					}else{
						$cond1 .="";
					}


					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
					(select d.description from department d left join signin sd on d.id=sd.dept_id where sd.id=entry_by) as auditor_dept,
					(select r.name from role r left join signin sr on r.id=sr.role_id where sr.id=entry_by) as auditor_role,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx
					Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);

					$data["qa_romtech_list"]=$fullAray;



					$this->create_qa_romtech_CSV($fullAray,$campaign);
					$dn_link = base_url()."qa_romtech/download_qa_romtech_CSV/".$campaign;
				}



			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['campaign']=$campaign;




			//$data['office_id']=$office_id;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}



	public  function download_qa_romtech_CSV($campaign) // testing sougata
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_romtech/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_romtech_CSV($rr,$campaign)
 	{

		$currDate=date("Y-m-d");


 		$filename = FCPATH . "qa_files/qa_romtech/Report".get_user_id().".csv";
 		$fopen = fopen($filename,"w+");

		if($campaign == 'romtech'){

 		$header = array("Auditor Name", "Audit Date ", "Agent Name "," AHT RCA   ", "Fusion ID ", "L1 Supervisor ", "Call Date ", "Audit Type ", "Type of Auditor ","Call ID ", "Earned Score ", "Possible Score ", "Overall Score % ",  "VOC","L1 ","L2","Phone No ","Customer Call Out ","Hold Exceeded", "Used standard ROMTech greeting message (Hello  My name is xxxxx calling from the ROMTech customer service team Is XXXXX available)","Used standard ROMTech greeting message (Hello  My name is xxxxx calling from the ROMTech customer service team Is XXXXX available) Reason", "Consistent pleasantries used throughout the entire call (Please thank you Excuse me You're Welcome  May I) ","Consistent pleasantries used throughout the entire call (Please thank you Excuse me You're Welcome  May I) Reason", "All call notes documented in Odoo with the correct taxonomy", "All call notes documented in Odoo with the correct taxonomy Reason","The agent followed all company process and policies to resolve the problem","The agent followed all company process and policies to resolve the problem Reason","All internal resources (tools  managers) used to resolve the problem", "All internal resources (tools  managers) used to resolve the problem  Reason", "Overall Call Flow (Long hold times  Dead air)","Overall Call Flow (Long hold times  Dead air) Reason ",  "ROMTech knowledge","ROMTech knowledge Reason ", "Provide clear follow-up instructions (If applicable)","Provide clear follow-up instructions (If applicable) Reason ", "Verify if the patient has any other questions or concerns","Verify if the patient has any other questions or concerns Reason ","Used standard ROMTech closing message (Thank you for contacting ROMTech customer service department)","Used standard ROMTech closing message (Thank you for contacting ROMTech customer service department) Reason ", "Audit Start date and  Time ", "Audit End Date and  Time"," Audit Interval in Seconds",  "Call Summary ","Feedback ","Agent Feedback Status ", "Feedback Acceptance","Agent Review Date","Management Review Date ", "Management Review Name ","Management Review Note", "Client Review Name","Client Review Note","Client Review Date " );




 		$row = "";
 		foreach($header as $data) $row .= ''.$data.',';
 		fwrite($fopen,rtrim($row,",")."\r\n");
 		$searches = array("\r", "\n", "\r\n");



 			foreach($rr as $user)
 			{
 				if($user['entry_by']!=''){
 					$auditorName = $user['auditor_name'];
 				}else{
 					$auditorName = $user['client_name'];
 				}

 				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
 					$interval1 = '---';
 				}else{
 					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
 				}

 				$row = '"'.$auditorName.'",';
 				$row .= '"'.$user['audit_date'].'",';
 				$row .= '"'.$user['fname']." ".$user['lname'].'",';
 				$row .= '"'.$user['aht_rca'].'",';
         
 				$row .= '"'.$user['fusion_id'].'",';
 				$row .= '"'.$user['tl_name'].'",';
 				$row .= '"'.$user['call_date'].'",';
 				$row .= '"'.$user['audit_type'].'",';
 				$row .= '"'.$user['auditor_type'].'",';

 				$row .= '"'.$user['call_id'].'",';
 				$row .= '"'.$user['earned_score'].'",';
 				$row .= '"'.$user['possible_score'].'",';

 				$row .= '"'.$user['overall_score'].'"% ,';

 				$row .= '"'.$user['voc'].'",';

				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				$row .= '"'.$user['phone_no'].'",';
				$row .= '"'.$user['customer_call_out'].'",';
				$row .= '"'.$user['hold_exceeded'].'",';

				$row .= '"'.$user['greeting_message'].'",';
				$row .= '"'.$user['greeting_message_reason'].'",';
				$row .= '"'.$user['pleasantries'].'",';
						$row .= '"'.$user['pleasantries_reason'].'",';
				$row .= '"'.$user['documented'].'",';
				$row .= '"'.$user['documented_reason'].'",';
				$row .= '"'.$user['resolve'].'",';
				$row .= '"'.$user['resolve_reason'].'",';
				$row .= '"'.$user['internal_resources'].'",';
				$row .= '"'.$user['internal_resources_reason'].'",';
				$row .= '"'.$user['call_flow'].'",';
				$row .= '"'.$user['call_flow_reason'].'",';



				$row .= '"'.$user['knowledge'].'",';
				$row .= '"'.$user['knowledge_reason'].'",';
						$row .= '"'.$user['follow_up'].'",';
				$row .= '"'.$user['follow_up_reason'].'",';
				$row .= '"'.$user['questions'].'",';
				$row .= '"'.$user['questions_reason'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['closing_reason'].'",';
 				$row .= '"'.$user['audit_start_time'].'",';
 				$row .= '"'.$user['entry_date'].'",';
 				$row .= '"'.$interval1.'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
 				$row .= '"'.$user['agnt_fd_acpt'].'",';

 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
 				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
 				$row .= '"'.$user['mgnt_rvw_name'].'",';

 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';




 				$row .= '"'.$user['client_rvw_name'].'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'",';

 				$row .= '"'.$user['client_rvw_date'].'"';




 				fwrite($fopen,$row."\r\n");
 			}
 			fclose($fopen);

		}else if($campaign == 'romtech_csat'){

				$header = array("Auditor Name", "Audit Date ", "Agent Name "," AHT RCA   ", "Fusion ID ", "L1 Supervisor ", "Call Date ", "Audit Type ", "Type of Auditor ","Call ID ", "Earned Score ", "Possible Score ", "Overall Score % ",  "VOC","L1 ","L2","Phone No ","Customer Call Out ","Hold Exceeded", "Used standard ROMTech greeting message (Hello xxxxxx My name is xxxxxxx Im calling from ROMTech Customer Care the manufacture of the PortableConnect. Do you have a few minutes to speak with me today regarding your experience with the Portable Connect? )","Remarks 1","Consistent pleasantries used throughout the entire call (Please thank you Excuse me You are Welcome & May I)","Remarks 2", "Ensuring all call notes are documented within ROMTechs CRM system ","Remarks 3","Ensured all satisfaction questions are covered", "Remarks 4","Ensure all internal processes are followed throughout the call.", "Remarks 5","Overall Call Flow (Long hold times & Dead air)","Remarks 6","ROMTech knowledge","Remarks 7","Provide clear follow-up instructions (If applicable)","Remarks 8","Verify if the patinet had any other areas of feedback they wanted to provide", "Remarks 9","Used standard ROMTech closing message (Thank you for taking the time to speak with me today. If you have any questions moving forward feel free to contact our ROMTech customer service line at 888-457-6430.)", "Remarks 10","Audit Start date and  Time ", "Audit End Date and  Time"," Audit Interval in Seconds",  "Call Summary ","Feedback ","Agent Feedback Status ", "Feedback Acceptance","Agent Review Date","Management Review Date ", "Management Review Name ","Management Review Note", "Client Review Name","Client Review Note","Client Review Date " );




 		$row = "";
 		foreach($header as $data) $row .= ''.$data.',';
 		fwrite($fopen,rtrim($row,",")."\r\n");
 		$searches = array("\r", "\n", "\r\n");



 			foreach($rr as $user)
 			{
 				if($user['entry_by']!=''){
 					$auditorName = $user['auditor_name'];
 				}else{
 					$auditorName = $user['client_name'];
 				}

 				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
 					$interval1 = '---';
 				}else{
 					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
 				}

 				$row = '"'.$auditorName.'",';
 				$row .= '"'.$user['audit_date'].'",';
 				$row .= '"'.$user['fname']." ".$user['lname'].'",';
 				$row .= '"'.$user['aht_rca'].'",';
         
 				$row .= '"'.$user['fusion_id'].'",';
 				$row .= '"'.$user['tl_name'].'",';
 				$row .= '"'.$user['call_date'].'",';
 				$row .= '"'.$user['audit_type'].'",';
 				$row .= '"'.$user['auditor_type'].'",';

 				$row .= '"'.$user['call_id'].'",';
 				$row .= '"'.$user['earned_score'].'",';
 				$row .= '"'.$user['possible_score'].'",';

 				$row .= '"'.$user['overall_score'].'"% ,';

 				$row .= '"'.$user['voc'].'",';

				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				$row .= '"'.$user['phone_no'].'",';
				$row .= '"'.$user['customer_call_out'].'",';
				$row .= '"'.$user['hold_exceeded'].'",';

				$row .= '"'.$user['greeting_message'].'",';
				$row .= '"'.$user['greeting_message_reason'].'",';
				$row .= '"'.$user['pleasantries'].'",';
				$row .= '"'.$user['pleasantries_reason'].'",';
				$row .= '"'.$user['documented'].'",';
				$row .= '"'.$user['documented_reason'].'",';
				$row .= '"'.$user['resolve'].'",';
				$row .= '"'.$user['resolve_reason'].'",';
				$row .= '"'.$user['internal_resources'].'",';
				$row .= '"'.$user['internal_resources_reason'].'",';
				$row .= '"'.$user['call_flow'].'",';
				$row .= '"'.$user['call_flow_reason'].'",';



				$row .= '"'.$user['knowledge'].'",';
				$row .= '"'.$user['knowledge_reason'].'",';
				$row .= '"'.$user['follow_up'].'",';
				$row .= '"'.$user['follow_up_reason'].'",';
				$row .= '"'.$user['questions'].'",';
				$row .= '"'.$user['questions_reason'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['closing_reason'].'",';
 				$row .= '"'.$user['audit_start_time'].'",';
 				$row .= '"'.$user['entry_date'].'",';
 				$row .= '"'.$interval1.'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
 				$row .= '"'.$user['agnt_fd_acpt'].'",';

 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
 				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
 				$row .= '"'.$user['mgnt_rvw_name'].'",';

 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';




 				$row .= '"'.$user['client_rvw_name'].'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'",';

 				$row .= '"'.$user['client_rvw_date'].'"';




 				fwrite($fopen,$row."\r\n");
 			}
 			fclose($fopen);

 		}else if($campaign == 'romtech_intro'){

			$header = array("Auditor Name", "Audit Date ", "Agent Name "," AHT RCA   ", "Fusion ID ", "L1 Supervisor ", "Call Date ", "Audit Type ", "Type of Auditor ","Call ID ", "Earned Score ", "Possible Score ", "Overall Score % ",  "VOC","L1 ","L2","Phone No ","Customer Call Out ","Hold Exceeded", "Used standard ROMTech greeting message (Hello xxxxxx - my name is xxxxx and Im calling on behalf of your orthopedic surgeon Dr xxxxxx How are you doing today? Can you spare 5 minutes now to discuss your rehab plan after your upcoming knee surgery?)","Remarks 1","Consistent pleasantries used throughout the entire call (Please thank you Excuse me You are Welcome & May I)","Remarks 2", "Ensuring all call notes are documented within ROMTechs CRM system ","Remarks 3","Ensured patient is educated on all areas of the ROMTech order process", "Remarks 4","Ensure all internal processes are followed throughout the call", "Remarks 5","Overall Call Flow (Long hold times & Dead air)","Remarks 6","ROMTech knowledge","Remarks 7","Provide clear follow-up instructions (If applicable)","Remarks 8","Verify if the patinet had any other areas of feedback they wanted to provide", "Remarks 9","Used standard ROMTech closing message (Thank you for contacting ROMTech customer service department)", "Remarks 10","Audit Start date and  Time ", "Audit End Date and  Time"," Audit Interval in Seconds",  "Call Summary ","Feedback ","Agent Feedback Status ", "Feedback Acceptance","Agent Review Date","Management Review Date ", "Management Review Name ","Management Review Note", "Client Review Name","Client Review Note","Client Review Date " );




			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");



 			foreach($rr as $user)
 			{
 				if($user['entry_by']!=''){
 					$auditorName = $user['auditor_name'];
 				}else{
 					$auditorName = $user['client_name'];
 				}

 				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
 					$interval1 = '---';
 				}else{
 					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
 				}

 				$row = '"'.$auditorName.'",';
 				$row .= '"'.$user['audit_date'].'",';
 				$row .= '"'.$user['fname']." ".$user['lname'].'",';
 				$row .= '"'.$user['aht_rca'].'",';
         
 				$row .= '"'.$user['fusion_id'].'",';
 				$row .= '"'.$user['tl_name'].'",';
 				$row .= '"'.$user['call_date'].'",';
 				$row .= '"'.$user['audit_type'].'",';
 				$row .= '"'.$user['auditor_type'].'",';

 				$row .= '"'.$user['call_id'].'",';
 				$row .= '"'.$user['earned_score'].'",';
 				$row .= '"'.$user['possible_score'].'",';

 				$row .= '"'.$user['overall_score'].'"% ,';

 				$row .= '"'.$user['voc'].'",';

				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				$row .= '"'.$user['phone_no'].'",';
				$row .= '"'.$user['customer_call_out'].'",';
				$row .= '"'.$user['hold_exceeded'].'",';

				$row .= '"'.$user['greeting_message'].'",';
				$row .= '"'.$user['greeting_message_reason'].'",';
				$row .= '"'.$user['pleasantries'].'",';
				$row .= '"'.$user['pleasantries_reason'].'",';
				$row .= '"'.$user['documented'].'",';
				$row .= '"'.$user['documented_reason'].'",';
				$row .= '"'.$user['resolve'].'",';
				$row .= '"'.$user['resolve_reason'].'",';
				$row .= '"'.$user['internal_resources'].'",';
				$row .= '"'.$user['internal_resources_reason'].'",';
				$row .= '"'.$user['call_flow'].'",';
				$row .= '"'.$user['call_flow_reason'].'",';



				$row .= '"'.$user['knowledge'].'",';
				$row .= '"'.$user['knowledge_reason'].'",';
				$row .= '"'.$user['follow_up'].'",';
				$row .= '"'.$user['follow_up_reason'].'",';
				$row .= '"'.$user['questions'].'",';
				$row .= '"'.$user['questions_reason'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['closing_reason'].'",';
 				$row .= '"'.$user['audit_start_time'].'",';
 				$row .= '"'.$user['entry_date'].'",';
 				$row .= '"'.$interval1.'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
 				$row .= '"'.$user['agnt_fd_acpt'].'",';

 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
 				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
 				$row .= '"'.$user['mgnt_rvw_name'].'",';

 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';




 				$row .= '"'.$user['client_rvw_name'].'",';
 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'",';

 				$row .= '"'.$user['client_rvw_date'].'"';




 				fwrite($fopen,$row."\r\n");
 			}
 			fclose($fopen);
		}
	}

//////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////Romtech///////////////////////////////////////////////////
////////////////////////////////////////END///////////////////////////////////////////////////////



//////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// QA IBUUMERANG REPORT //////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////
	public function qa_ibuumerang_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_ibuumerang_report.php";
			$data["content_js"] = "qa_ibuumerang_js.php";

			$date_from="";
			$date_to="";
			$office_id="";
			$campaign="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';

			$campaign = $this->input->get('campaign');

			$data["qa_ibuumerang_list"] = array();

			$data['location_list'] = $this->Common_model->get_office_location_list();


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($office_id != "") $cond1 .= " and office_id='$office_id'";

				if($campaign=='ibmn_old'){
					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_ibuumerang_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_ibuumerang_list"] = $fullAray;
					$this->create_qa_ibuumerang_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_ibuumerang_new_CSV";
				}else if($campaign=='ibmn'){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_rvw_by) as client_rvw_name from qa_ibuumerang_new_feedback) xx Left Join
					(Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_ibuumerang_list"] = $fullAray;
					$this->create_qa_ibmn_new_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_ibmn_new_CSV";
				}
			}

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id'] = $office_id;
			$data['campaign'] = $campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_ibuumerang_new_CSV(){
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Ibuumerang New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function ibmn_headerDetails(){
		return $arrayName = array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Audit Type","Auditor Type","VOC","Call Type","Overall Score","Used First Name in Opening","Thank Customer for Contacting","Took Ownership & Assured Resolution","Restated the Customer's Issue demonstrating complete understanding of TSA request","Provided Step-by-Step Resolution","Resolution Provided is Best Resolution","Uses 'Please and Thank You' in response","If follow up needed set appropriate customer expectations","Took Ownership of Ticket and provided First Contact Resolution","Apologized when necessary","Used appropriate verbiage","Correct grammar use","Reviewed Next Steps","Used Correct Closing","Did representative read the complete TSA request?","Did representative checked all details before answer?","Did representative leave clear internal notes?","Did representative leave IT escalations clear notes?","Did representative check updates?","Did representative use excellent grammar in reply?","Did representative mark tickets as resolved/closed incorrectly?","Did representative respond with canned response that does not answer/address questions?","Did representative get clarity from ticket/question from before responding?","Profanity","Dishonesty","Incorrect information in ticket response","Not following updates and instructions","Incomplete answers to questions","Not using First name to reply back","Entering tickets unnecessarily","Changing/Deleting information without authority or justification","Ticket productivity by time of audit","Inbox checked and clear","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 101","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25","Comments 26","Comments 27","Comments 28","Comments 29","Comments 30","Comments 31","Comments 32","Comments 33","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	public function create_qa_ibuumerang_new_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header=$this->ibmn_headerDetails();
		$field_name="SHOW FULL COLUMNS FROM qa_ibuumerang_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}

//////////////////////////////////////////////
	public function download_qa_ibmn_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Ibuumerang Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_ibmn_new_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Type", "Call ID", "Contact Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score","Email Score","Soft Skill Score","Back Office Score", "Used First Name in Opening ", "Used Correct Opening and Closing", "Used one idea per paragraph", "Email structure", "Did representative personalize the email and respond with canned response that answer/address all questions?", "Used Please and Thank You in response", "Took Ownership & Provided Best Resolution", "Apologized when necessary & Communicated with empathy", "Did representative get clarity from ticket/question from before responding?", "Provided Step-by-Step Resolution", "Used appropriate verbiage & Communicated clearly and professionaly", "Used proper spelling and grammar", "Did representative give a follow up ?", "Offered Additional/Alternate Resolution and Further assistance", "Did representative leave clear notes in Back Office or FreshDesk?", "Did the representative do the due diligence & review previous conversation/tickets?", "Did representative fill out properties & use the correct status of the ticket?","Profanity", "Dishonesty", "Incorrect information in ticket response", "Not following updates and instructions", "Incomplete answers to questions", "Not using First name to reply back", "Changing/Deleting information without authority or justification", "Not removing watermark in email", " Comment 1", " Comment 2", " Comment 3", " Comment 4", " Comment 5", " Comment 6", " Comment 7", " Comment 8", " Comment 9", " Comment 10", " Comment 11", " Comment 12", " Comment 13", " Comment 14", " Comment 15", " Comment 16",  " Comment 17", " Comment 18", " Comment 19", " Comment 20", " Comment 21", " Comment 22", " Comment 23", " Comment 24", " Comment 25","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");


		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['email_score'].'",';
			$row .= '"'.$user['softskill_score'].'",';
			$row .= '"'.$user['backoffice_score'].'",';
			$row .= '"'.$user['use_opening_first_name'].'",';
			$row .= '"'.$user['use_correct_closing'].'",';
			$row .= '"'.$user['used_one_idea'].'",';
			$row .= '"'.$user['email_structure'].'",';
			$row .= '"'.$user['representative_responce_question'].'",';
			$row .= '"'.$user['use_please_thankyou'].'",';
			$row .= '"'.$user['took_ownership_resolution'].'",';
			$row .= '"'.$user['necessary_apology'].'",';
			$row .= '"'.$user['representative_get_clarity'].'",';
			$row .= '"'.$user['step_by_step_resolution'].'",';
			$row .= '"'.$user['use_appropiate_veriage'].'",';
			$row .= '"'.$user['use_proper_spelling'].'",';
			$row .= '"'.$user['representative_give_followup'].'",';
			$row .= '"'.$user['offered_additional_alternate_resolution'].'",';
			$row .= '"'.$user['representative_leave_notes'].'",';
			$row .= '"'.$user['representative_due_diligence'].'",';
			$row .= '"'.$user['representative_fillout_property'].'",';
			$row .= '"'.$user['profanity'].'",';
			$row .= '"'.$user['dishonesty'].'",';
			$row .= '"'.$user['incorrect_information'].'",';
			$row .= '"'.$user['not_following_update'].'",';
			$row .= '"'.$user['incomplete_answer'].'",';
			$row .= '"'.$user['not_use_first_name'].'",';
			$row .= '"'.$user['change_delete_information'].'",';
			$row .= '"'.$user['removing_email_watermark'].'",';
			$row .= '"'.$user['cmt1'].'",';
			$row .= '"'.$user['cmt11'].'",';
			$row .= '"'.$user['cmt_used_one_idea'].'",';
			$row .= '"'.$user['cmt_email_structure'].'",';
			$row .= '"'.$user['cmt12'].'",';
			$row .= '"'.$user['cmt4'].'",';
			$row .= '"'.$user['cmt3'].'",';
			$row .= '"'.$user['cmt5'].'",';
			$row .= '"'.$user['cmt6'].'",';
			$row .= '"'.$user['cmt7'].'",';
			$row .= '"'.$user['cmt8'].'",';
			$row .= '"'.$user['cmt9'].'",';
			$row .= '"'.$user['cmt13'].'",';
			$row .= '"'.$user['cmt_offered_additional'].'",';
			$row .= '"'.$user['cmt13'].'",';
			$row .= '"'.$user['cmt_due_diligence'].'",';
			$row .= '"'.$user['cmt14'].'",';
			$row .= '"'.$user['cmt18'].'",';
			$row .= '"'.$user['cmt19'].'",';
			$row .= '"'.$user['cmt20'].'",';
			$row .= '"'.$user['cmt21'].'",';
			$row .= '"'.$user['cmt22'].'",';
			$row .= '"'.$user['cmt23'].'",';
			$row .= '"'.$user['cmt24'].'",';
			$row .= '"'.$user['cmt25'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);


	}


///////////////////////////////////////////////////////////////////////////////////////////
// ////////////////////////////////////// QA HRA REPORT //////////////////////////////////////
// ///////////////////////////////////////////////////////////////////////////////////////////
	public function qa_hra_report(){

		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["download_link1"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_amd_episource_report.php";

			$date_from="";
			$date_to="";
			$office_id="";
			$action="";
			$dn_link="";
			$dn_link1="";
			$cond1='';

			$data["qa_hra_list"] = array();

			if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			}else{
				$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			}


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond1= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";
				if($office_id != "") $cond1 .= " and office_id='$office_id'";

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_episource_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_hra_list"] = $fullAray;
					$header_arr=$this->Common_model->get_query_result_array("SELECT column_comment FROM information_schema.COLUMNS WHERE table_name = 'qa_amd_episource_feedback'");
					$cnt=count($header_arr);

					 for($i=0;$i<$cnt;$i++){
						$val=$this->getval($header_arr[$i],'column_comment');
						if($val!=""){
							$header[]=$val;
						}
					 }
					array_unshift($header ,"Auditor Name");
					$key = array_search ('Agent', $header);
					array_splice($header, $key, 0, 'Fusion Id');
					// print_r($header);
					// die;
					$this->create_qa_hra_new_CSV($header,$fullAray);
					$dn_link = base_url()."reports_qa/download_qa_hra_new_CSV";
			}

			$data['download_link']=$dn_link;
			$data['download_link1']=$dn_link1;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id'] = $office_id;

			$this->load->view('dashboard',$data);
		}
	}


// /////////////////// HRA NEW /////////////////////
	public function download_qa_hra_new_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA HRA New Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_hra_new_CSV($header,$rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$field_name="SHOW FULL COLUMNS FROM qa_amd_episource_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////// HOME ADVISOR ///////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	public function qa_homeadvisor_report(){
		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_homeadvisor_report.php";

			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$cond2="";

			$currentURL = current_url();

			$pValue = trim($this->input->post('process_id'));
			if($pValue=="") $pValue = trim($this->input->get('process_id'));
			$data['pValue']=$pValue;

			$data["qa_homeadvisor_list"] = array();

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$date_from = $this->input->get('date_from');
			$date_to = $this->input->get('date_to');

			if($date_from==""){
				$date_from=CurrDate();
			}else{
				$date_from = mmddyy2mysql($date_from);
			}

			if($date_to==""){
				$date_to=CurrDate();
			}else{
				$date_to = mmddyy2mysql($date_to);
			}

			$office_id = $this->input->get('office_id');

		/////////////////////
			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				if(get_user_fusion_id()=='FELS000025' || get_user_fusion_id()=='FJAM004099' || get_user_fusion_id()=='FJAM004208' || get_user_fusion_id()=='FJAM004102' || get_user_fusion_id()=='FELS001565'){
					$cond1 .="";
				}else{
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
				if(get_user_fusion_id()=='FJAM004099' || get_user_fusion_id()=='FJAM004208' || get_user_fusion_id()=='FJAM004102' || get_user_fusion_id()=='FELS001565'){
					$cond1 .="";
					$cond2 .=" and office_id='JAM'";
				}else{
					$cond1 .=" And assigned_to='$current_user'";
				}
			}else{
				$cond1 .="";
			}

			if($this->input->get('show')=='Show'){

				if($pValue=='Home Advisor'){

					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,(select DATEDIFF(CURDATE(), s.doj) as tenure from signin s where s.id=agent_id) as tenure, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name from qa_homeadvisor_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_homeadvisor_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_homeadvisor_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_homeadvisor_list"] = $fullAray;
					$this->create_qa_homeadvisor_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_homeadvisor_CSV";

				}elseif($pValue=='HCCI'){
					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,(select DATEDIFF(CURDATE(), s.doj) as tenure from signin s where s.id=agent_id) as tenure, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_hcci_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_homeadvisor_list"] = $fullAray;
					// $header_arr=$this->Common_model->get_query_result_array("SELECT column_comment FROM information_schema.COLUMNS WHERE table_name = 'qa_hcci_feedback'");
					// $cnt=count($header_arr);

					//  for($i=0;$i<$cnt;$i++){
					// 	$val=$this->getval($header_arr[$i],'column_comment');
					// 	if($val!=""){
					// 		$header[]=$val;
					// 	}
					//  }
					// array_unshift($header ,"Auditor Name");
					// $key = array_search ('Agent', $header);
					// array_splice($header, $key, 0, 'Fusion Id');
					// print_r($header);
					// die;
					$this->create_qa_hcci_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_hcci_CSV";

				}
				elseif($pValue=='HCCI_new'){
					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,(select DATEDIFF(CURDATE(), s.doj) as tenure from signin s where s.id=agent_id) as tenure, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_hcci_feedback_new) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_homeadvisor_list"] = $fullAray;

					$this->create_qa_hcci_CSV_new($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_hcci_CSV_new";

				}elseif($pValue=='HCCO SR COMPLIANCE'){

					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,(select DATEDIFF(CURDATE(), s.doj) as tenure from signin s where s.id=agent_id) as tenure,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_hcco_sr_feedback) xx Left Join
					(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_homeadvisor_list"] = $fullAray;
					$this->create_qa_hcco_sr_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_hcco_sr_CSV";

				}elseif($pValue=='HCCO FLEX'){

						$qSql="SELECT * from
						(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
						(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
						(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,(select DATEDIFF(CURDATE(), s.doj) as tenure from signin s where s.id=agent_id) as tenure,
						(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
						(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_hcco_flex_feedback) xx Left Join
						(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
						$fullAray = $this->Common_model->get_query_result_array($qSql);
						$data["qa_homeadvisor_list"] = $fullAray;
						$this->create_qa_hcco_flex_CSV($fullAray);
						$dn_link = base_url()."reports_qa/download_qa_hcco_flex_CSV";

				}else if($pValue=="BCCI"){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,(select DATEDIFF(CURDATE(), s.doj) as tenure from signin s where s.id=agent_id) as tenure,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_bcci) xx Left Join
					(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_homeadvisor_list"] = $fullAray;
					$this->create_qa_bcci_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_bcci_CSV";
				}else{

					 $qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,(select DATEDIFF(CURDATE(), s.doj) as tenure from signin s where s.id=agent_id) as tenure, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name from qa_hcco_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_hcco_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_hcco_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 $cond2 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_homeadvisor_list"] = $fullAray;
					$this->create_qa_hcco_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_hcco_CSV";

				}

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}

	// /////////////////// hcci NEW /////////////////////
	public function download_qa_hcci_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA HCCI Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_hcci_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_homeadvisor";
		$edit_url = "mgnt_hcci_feedback";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;

		//$main_url = base_url().'qa_files/qa_homeadvisor/homeadvisor_files/';
		$fopen = fopen($filename,"w+");
		$header=array ( "Auditor Name","Tenure","Audit Link","Audit Date","Fusion Id","Agent","TL Name","Call Date/Time","Call Duration","SR NO.","Consumer No.","Call File","AUDIT TYPE","AUDITOR TYPE","VOC","Overall Score","Introduction must include company name","We attempted to overcome all homeowner objections","Kept call simple and brief by not extending the information provided","We educated homeowner on what will happen after their request is submit","Attempt to gather and accurately submit all SR information for the professional","Do you agree to HomeAdvisor's Terms including that HomeAdvisor","HomeAdvisor and our partners may offer discounts and other offers in the future","Note BETTI if homeowner does not agree to 2nd Consent","Suggestive cross sell offered","Offer contact information and a transfer to pro","Compliance Score","Customer Score","Business Score","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client rvw date");

		$field_name="SHOW FULL COLUMNS FROM qa_hcci_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }
		array_unshift($field_val ,"audio_link");
		array_unshift($field_val ,"tenure");
		array_unshift($field_val ,"auditor_name");


		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);
		// echo"<pre>";
		// print_r($field_val);
		// echo"</pre>";
		//die();
		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		//  print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){
				 $main_urls = $main_url.'/'.$user['id'];
				// echo $field_val[$z];

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}else if($field_val[$z]==="tenure"){
					$row .= '"'.$user['tenure'].'",';
				}else if($field_val[$z]==="audio_link"){
					$row .= '"'.$main_urls.'",';
				}else if($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}else if($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}else if($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}else if(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}
			//die();

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}

/* public function getval($arrs, $k) {
    foreach($arrs as $key=>$val) {
        if( $key === $k ) {
            return $val;
        }
        else {
            if(is_array($val)) {
                $ret = $this->getval($val, $k);
                if($ret !== NULL) {
                    return $ret;
                }
            }
        }
    }
    return NULL;
	} */

// public function download_qa_hcci_CSV_new($campaign)
// 	{
// 		$currDate=date("Y-m-d");
// 		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
// 		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
// 		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
// 		readfile($filename);
// 	}


	// public function create_qa_hcci_CSV_new($rr,$campaign)
	// {
	// 	$currDate=date("Y-m-d");
	// 	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	// 	$fopen = fopen($filename,"w+");

	// 		$header = array("Auditor Name","Audit Date","Fusion Id","Agent","TL Name","Call Date/Time","Call Duration","SR NO.","Consumer No.","Call File","Call scenario","AUDIT TYPE","AUDITOR TYPE","VOC","Overall Score","Use the appropriate HCCI introduction","Demonstrate a willingness to help throughout the call","Use RRA (Repeat, Rephrase, and Affirm)","Used empathetic word choices","Feel, felt, found","Thoroughly probed to identify customer needs","Accurately address all questions/issues presented","Set appropriate expectations on policy and next steps","Use appropriate user-facing terms and Book Now acronyms","Warm transferred when required","Thank customer for their business and brand the call","Completed all actions in Dash as communicated to customer","Did not promise or complete an action out of policy","Completed the appropriate documentation and action in Dash","Completed Lead Audit Interview on SR in BETTI","Cursing / Clear Insults","Speaking Negatively of Handy / Users / Partners / CX Agents","Ignored main issue","Excessive Inappropriate Response or Tone of Voice","Excessive Dead Air","Incorrectly using an Other Disposition when there was a better option available","Compliance Score","Customer Score","Business Score","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent review note","Agent review date","Client review by","Client review note","Client rvw date");

	// 	$row = "";
	// 	foreach($header as $data) $row .= ''.$data.',';
	// 	fwrite($fopen,rtrim($row,",")."\r\n");
	// 	$searches = array("\r", "\n", "\r\n");

	// 		foreach($rr as $user){
	// 			if($user['entry_by']!=''){
	// 				$auditorName = $user['auditor_name'];
	// 			}else{
	// 				$auditorName = $user['client_name'];
	// 			}

	// 			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
	// 				$interval1 = '---';
	// 			}else{
	// 				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
	// 			}

	// 			$row = '"'.$auditorName.'",';
	// 			$row .= '"'.$user['audit_date'].'",';
	// 			$row .= '"'.$user['fusion_id'].'",';
	// 			$row .= '"'.$user['fname']." ".$user['lname'].'",';
	// 			$row .= '"'.$user['tl_name'].'",';
	// 			$row .= '"'.$user['call_date'].'",';
	// 			$row .= '"'.$user['call_duration'].'",';
	// 			$row .= '"'.$user['sr_no'].'",';
	// 			$row .= '"'.$user['consumer_no'].'",';
	// 			$row .= '"'.$user['call_file'].'",';
	// 			$row .= '"'.$user['call_scenario'].'",';
	// 			$row .= '"'.$user['audit_type'].'",';
	// 			$row .= '"'.$user['auditor_type'].'",';
	// 			$row .= '"'.$user['voc'].'",';
	// 			$row .= '"'.$user['overall_score'].'",';

 //                $row .= '"'.$user['HCCI_introduction'].'",';
	// 			$row .= '"'.$user['use_RRA'].'",';
	// 			$row .= '"'.$user['customer_needs'].'",';
	// 			$row .= '"'.$user['issues_presented'].'",';
	// 			$row .= '"'.$user['next_steps'].'",';
	// 			$row .= '"'.$user['now_acronyms'].'",';
	// 			$row .= '"'.$user['when_required'].'",';
	// 			$row .= '"'.$user['brand_the_call'].'",';
	// 			$row .= '"'.$user['communicated_to_customer'].'",';
	// 			$row .= '"'.$user['out_of_policy'].'",';
	// 			$row .= '"'.$user['action_in_Dash'].'",';
	// 			$row .= '"'.$user['SR_in_BETTI'].'",';
	// 			$row .= '"'.$user['Clear_Insults'].'",';
	// 			$row .= '"'.$user['CX_Agents'].'",';
	// 			$row .= '"'.$user['main_issue'].'",';
	// 			$row .= '"'.$user['tone_of_Voice'].'",';
	// 			$row .= '"'.$user['Dead_Air'].'",';
	// 			$row .= '"'.$user['option_available'].'",';

 //                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
	// 			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
	// 			$row .= '"'.$user['agnt_fd_acpt'].'",';
	// 			$row .= '"'.$user['agent_rvw_date'].'",';
	// 			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
	// 			$row .= '"'.$user['mgnt_rvw_date'].'",';
	// 			$row .= '"'.$user['mgnt_rvw_name'].'",';
	// 			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

	// 			fwrite($fopen,$row."\r\n");
	// 		}
	// 		fclose($fopen);


 //        }





	public function download_qa_hcci_CSV_new()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA HCCI NEW Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_hcci_CSV_new($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_homeadvisor";
		$edit_url = "mgnt_hcci_feedback_new";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header=array("Auditor Name","Audit Date","Fusion Id","Agent","TL Name","Call Date Time","Call Duration","SR NO.","Consumer No.","Call File","Call scenario","Audit Type","Auditor Type","VOC","Tenure","Audit Link","Overall Score",
		"Use the appropriate HCCI introduction","Demonstrate a willingness to help throughout the call","Thoroughly probed to identify customer needs","Accurately address all questions issues presented","Set appropriate expectations on policy and next steps","Use appropriate user facing terms and Book Now acronyms","Warm transferred when required","Thank customer for their business and brand the call","Completed all actions in Dash as communicated to customer","** Did not promise or complete an action out of policy","** Completed the appropriate documentation and action in Dash","Completed Lead Audit Interview on SR in BETTI","Asked a strategic SR question","Cursing Clear Insults","Speaking Negatively of Handy Users Partners CX Agents","Ignored main issue","Excessive Inappropriate Response or Tone of Voice","Excessive Dead Air","Incorrectly using an Other Disposition when there was a better option available",
		"Compliance Score","Customer Score","Business Score",
		"Call Summary","Feedback","Agent Feedback Acceptance Status","Agent review date","Agent review note","Client review by","Client review note","Mgnt review date","Mgnt review by","Mgnt review note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['sr_no'].'",';
			$row .= '"'.$user['consumer_no'].'",';
			$row .= '"'.$user['call_file'].'",';
			$row .= '"'.$user['call_scenario'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['HCCI_introduction'].'",';
			$row .= '"'.$user['throughout_the_call'].'",';
			$row .= '"'.$user['customer_needs'].'",';
			$row .= '"'.$user['issues_presented'].'",';
			$row .= '"'.$user['next_steps'].'",';
			$row .= '"'.$user['now_acronyms'].'",';
			$row .= '"'.$user['when_required'].'",';
			$row .= '"'.$user['brand_the_call'].'",';
			$row .= '"'.$user['communicated_to_customer'].'",';
			$row .= '"'.$user['out_of_policy'].'",';
			$row .= '"'.$user['action_in_Dash'].'",';
			$row .= '"'.$user['SR_in_BETTI'].'",';
			$row .= '"'.$user['SR_question'].'",';
			$row .= '"'.$user['Clear_Insults'].'",';
			$row .= '"'.$user['CX_Agents'].'",';
			$row .= '"'.$user['main_issue'].'",';
			$row .= '"'.$user['tone_of_Voice'].'",';
			$row .= '"'.$user['Dead_Air'].'",';
			$row .= '"'.$user['option_available'].'",';

			$row .= '"'.$user['compliance_score_percent'].'%'.'",';
			$row .= '"'.$user['customer_score_percent'].'%'.'",';
			$row .= '"'.$user['business_score_percent'].'%'.'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}

////////////Home Advisor/////////////
	public function download_qa_homeadvisor_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Home Advisor Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_homeadvisor_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_homeadvisor";
		$edit_url = "mgnt_homeadvisor_feedback_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Call Duration", "Fusion ID", "Agent Name", "L1 Supervisor", "Sale Date", "EXT Number", "Phone", "Sale Confirmation", "Call Type", "Audit Type", "VOC","Tenure","Audit Link", "Audit Start Date/Time", "Audit End Date/Time", "Interval(In Second)", "Call Pass/Fail", "Rep clearly communicated that these are leads and not guaranteed jobs", "Rep explains that  SP is only charged for leads they opt into", "Rep clearly communicates the value of opting into leads as the best way to make money with the service", "Rep clearly communicated that SP will be competing on these leads", "Background: Rep communicated the importance of the background check (for homeowners and HA brand)", "Background: Rep communicated what background check looks for (liens judgements bankruptcies felonies)", "Ratings and Reviews: Rep clearly communicated the importance of ratings and reviews and collecte a reference on the sales call", "Lead Response: Rep communicates that leads will be sent via email text message and via mobile app", "Lead Response: Rep reinforces the importance of responding to leads as quickly as possible", "HA Pro App: Rep clearly communicated the importance of the app as the most effective tool for success with HA", "HA Pro App: Rep sent the link to download the HA Pro app on their phone", "Misconduct: Intentionally skirting the screening process", "Falsifying VL: Pressing 1 without the SP specific consent or request OR intentionally hanging up/dropping VL after pressing 2", "Falsifying VL: Speaking over VL at all", "Falsifying VL: Asking SP to hold questions", "Suggesting or implying the SP sign up for multiple accounts", "Adding tasks outside SP scope of work to circumvent licensing requirements", "Misinterpreting lead quality or lead prices", "Implying that friends and family are acceptable for CVRs", "Referring to leads as guaranteed jobs", "Misleading over uses just the background check today", "POC Implies to SP that sales rep can help in any way with credits", "POC Refers to customer care org in a negative manner", "Overusing the word jobs", "Overall Score", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['product_communicate']==6) $product_communicate='Yes';
			else if($user['product_communicate']==0) $product_communicate='No';
			else $product_communicate='N/A';

			if($user['product_explain']==10) $product_explain='Yes';
			else if($user['product_explain']==0) $product_explain='No';
			else $product_explain='N/A';

			if($user['product_money']==15) $product_money='Yes';
			else if($user['product_money']==0) $product_money='No';
			else $product_money='N/A';

			if($user['product_lead']==6) $product_lead='Yes';
			else if($user['product_lead']==0) $product_lead='No';
			else $product_lead='N/A';

			if($user['product_background']==8) $product_background='Yes';
			else if($user['product_background']==0) $product_background='No';
			else $product_background='N/A';

			if($user['product_look']==10) $product_look='Yes';
			else if($user['product_look']==0) $product_look='No';
			else $product_look='N/A';

			if($user['product_rating']==10) $product_rating='Yes';
			else if($user['product_rating']==0) $product_rating='No';
			else $product_rating='N/A';

			if($user['product_email']==7) $product_email='Yes';
			else if($user['product_email']==0) $product_email='No';
			else $product_email='N/A';

			if($user['product_reinforce']==10) $product_reinforce='Yes';
			else if($user['product_reinforce']==0) $product_reinforce='No';
			else $product_reinforce='N/A';

			if($user['product_tool']==8) $product_tool='Yes';
			else if($user['product_tool']==0) $product_tool='No';
			else $product_tool='N/A';

			if($user['product_download']==10) $product_download='Yes';
			else if($user['product_download']==0) $product_download='No';
			else $product_download='N/A';


			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval = '---';
			}else{
				$interval = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];


			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['sale_date'].'",';
			$row .= '"'.$user['ext_no'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['sale_confirm'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval.'",';
			$row .= '"'.$user['call_pass_fail'].'",';
			$row .= '"'.$product_communicate.'",';
			$row .= '"'.$product_explain.'",';
			$row .= '"'.$product_money.'",';
			$row .= '"'.$product_lead.'",';
			$row .= '"'.$product_background.'",';
			$row .= '"'.$product_look.'",';
			$row .= '"'.$product_rating.'",';
			$row .= '"'.$product_email.'",';
			$row .= '"'.$product_reinforce.'",';
			$row .= '"'.$product_tool.'",';
			$row .= '"'.$product_download.'",';
			$row .= '"'.$user['auto_misconduct'].'",';
			$row .= '"'.$user['auto_hanging'].'",';
			$row .= '"'.$user['auto_speaking'].'",';
			$row .= '"'.$user['auto_asking'].'",';
			$row .= '"'.$user['auto_implying'].'",';
			$row .= '"'.$user['auto_adding'].'",';
			$row .= '"'.$user['auto_quality'].'",';
			$row .= '"'.$user['auto_family'].'",';
			$row .= '"'.$user['auto_lead'].'",';
			$row .= '"'.$user['auto_background'].'",';
			$row .= '"'.$user['auto_poc'].'",';
			$row .= '"'.$user['auto_manner'].'",';
			$row .= '"'.$user['auto_jobs'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

////////////HCCO/////////////
	public function download_qa_hcco_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA HCCO Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_hcco_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$controller = "Qa_homeadvisor";
		$edit_url = "mgnt_hcco_feedback_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Time of Call", "Fusion ID", "Agent Name", "L1 Supervisor", "Call Date", "Call Duration", "Consumer1", "Consumer2 (if applicable)", "Consumer3 (if applicable)", "Call Type", "Can be Automated", "Original SR ID", "New SR ID1", "New SR ID2", "EXT No", "Audit Type", "VOC","Tenure","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Call Pass/Fail", "Overall Score", "Compliance Score", "Customer Score", "Business Score",
		"Verify Address if possible (Address required on IB Appts) Zip code & Email", "The business needs were met", "Offer to transfer the Consumer to the Service Professional", "Informed the consumer of features and benefits of Angi/HA", "Maintain proper tone word choice and rate of speech. Avoid interrupting in a non-collaborative conversation", "Properly presented pros and asked the consumer how many options they want ", "The advisor asked questions about the project and related projects & included detailed descriptions", "Make sure the Consumer knows what to expect after the call and Do what you said you would do. ", "The advisor accurately updated and noted all SRs", "The correct solution was provided", "The advisor asked for a cross sell", "Correct CTT was submitted and included a detailed description of the project", "Brand Angi/HA somewhere other than the Intro", "Your Name/Verify who you are speaking with HA/Angi Branding and stated recorded line", "Recorded line must be stated in the introduction of the call", "All SRs were submitted with the homeowners knowledge and approval ", "5 Star Rating If yes QA score will increase by 5 percent (manager must review and notify QA of 5 star Stella rating)",
		// "Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17",
		"Call Summary", "Feedback", "Agent Review Date","Agent Fd ACPT", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['call_time'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['consumer1'].'",';
			$row .= '"'.$user['consumer2'].'",';
			$row .= '"'.$user['consumer3'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['can_automated'].'",';
			$row .= '"'.$user['original_sr_id'].'",';
			$row .= '"'.$user['new_sr_id1'].'",';
			$row .= '"'.$user['new_sr_id2'].'",';
			$row .= '"'.$user['ext_no'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['call_pass_fail'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['compliance_score_percent'].'%'.'",';
			$row .= '"'.$user['customer_score_percent'].'%'.'",';
			$row .= '"'.$user['business_score_percent'].'%'.'",';
			$row .= '"'.$user['Location_email'].'",';
			$row .= '"'.$user['Business_expectations'].'",';
			$row .= '"'.$user['Transfer'].'",';
			$row .= '"'.$user['educate'].'",';
			$row .= '"'.$user['professionalism'].'",';
			$row .= '"'.$user['Proper_presentation'].'",';
			$row .= '"'.$user['prob'].'",';
			$row .= '"'.$user['Customer_expectations'].'",';
			$row .= '"'.$user['account_accuracy'].'",';
			$row .= '"'.$user['Solution'].'",';
			$row .= '"'.$user['Cross_sell'].'",';
			$row .= '"'.$user['Correct_CTT'].'",';
			$row .= '"'.$user['Branding'].'",';
			$row .= '"'.$user['Introduction'].'",';
			$row .= '"'.$user['recorded_line'].'",';
			$row .= '"'.$user['acknowledgement'].'",';
			$row .= '"'.$user['stella_survey'].'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

	//Edited BY Samrat 27/11/2021 - QA BCCI
	public function download_qa_bcci_CSV(){
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA BCCI Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}
    //Common Pass Fail
    public function common_pass_fail(){
        return array(
            "1"=>"Pass",
            "2"=>"Fail"
        );
    }

	public function create_qa_bcci_CSV($rr){
		$common_yes_no=$this->common_yes_no();
		$common_pass_fail=$this->common_pass_fail();
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$controller = "Qa_homeadvisor";
		$edit_url = "add_edit_bcci_audit";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header=array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Supervisor", "Call Date", "Call Duration", "Week", "Audit Type", "Auditor Type", "VOC","Tenure","Audit Link",
        "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Call QA Score",
        "inContact ID Number",
        "Call File Number",

        "1. You showed willingness to help the customer",
        "2. You used active listening to fully engage and hear the customer out",
        "3. You provided a sincere apology for their pain points",
        "4. You used RRA to isolate and resolve the customers concerns",
        "5. You offered a concise explanation to provide clarity and assurances for the SP",
        "6. You showed appreciation to the professional that was not a part of the call closing",

        "7. You did not interrupt the customer",
        "8. You maintained proper tone word choice and rate of speech during the call",
        "9. You set correct expectations throughout the call",
        "10. You inform the SP of Self Serve options",
        "11. You mentioned all health triggers on the account before the call ended",

        "12. You showed additional willingness to help if the account was 45 days or younger (courtesy credit and/or sought out manager help looked at tenure/ratings/etc.)",

        "13. You informed the customer the call may be monitored or recorded if they did not hear it in the IVR",
        "14. Your notes included the name of whom we spoke with a brief professional and accurate summary of the conversation",
        "15. We verified the account by asking for their phone number personal name and business name",

        "16. Your introduction was pleasant",
        "17. You asked for permission to proceed with questions and make suggestions ",
        "18. You obtained a CRO",
        "19. During the conversation you mentioned any additional programs features or key points on an account to help provide assistance to the SP",
        "20. The closing was proper and included HA Branding",
        "21. If Stella Survey was received for this interaction did you receive a 5 star rating? If yes QA score will increase by 5 points (manager must review and notify QA of 5 star Stella rating)",

        "Call Summary", "Feedback", "Agent Feedback Acceptance",
        "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
            $auditorName=($user['entry_by']!="")?$user['auditor_name']:$user['client_name'];
            if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];
            $row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['week'].'",';
            $row .= '"'.$user['audit_type'].'",';
            $row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
            $row .= '"'.$user['overall_score'].'%'.'",';
            $row .= '"'.$user['incontact_ID'].'",';
			$row .= '"'.$user['call_file_number'].'",';

            //BCCI Emotional Currencies QA
            $row .= '"'.$common_yes_no[$user['willingness_to_help']].'",';
            $row .= '"'.$common_yes_no[$user['active_listening']].'",';
            $row .= '"'.$common_yes_no[$user['sincere_apology']].'",';
            $row .= '"'.$common_yes_no[$user['rra_isolate']].'",';
            $row .= '"'.$common_yes_no[$user['offered_concise']].'",';
            $row .= '"'.$common_yes_no[$user['appreciation_professional']].'",';

            //Engagement
            $row .= '"'.$common_yes_no[$user['interrupt_cust']].'",';
            $row .= '"'.$common_yes_no[$user['maintain_proper_tone']].'",';
            $row .= '"'.$common_yes_no[$user['correct_expect']].'",';
            $row .= '"'.$common_yes_no[$user['inform_sp']].'",';
            $row .= '"'.$common_yes_no[$user['mention_health']].'",';

            //Retention
            $row .= '"'.$common_yes_no[$user['additional_willingness']].'",';

            //Required
            $row .= '"'.$common_pass_fail[$user['informed_cust_call']].'",';
            $row .= '"'.$common_pass_fail[$user['note_incl_name']].'",';
            $row .= '"'.$common_pass_fail[$user['verified_account']].'",';

            //Coaching
            $row .= '"'.$common_pass_fail[$user['intro_pleasant']].'",';
            $row .= '"'.$common_pass_fail[$user['asked_permission']].'",';
            $row .= '"'.$common_pass_fail[$user['obtain_cro']].'",';
            $row .= '"'.$common_pass_fail[$user['mention_additional_programs']].'",';
            $row .= '"'.$common_pass_fail[$user['proper_closing']].'",';
            $row .= '"'.$common_pass_fail[$user['stella_survey']].'",';
            // $row .= '"'.$infraction_type[$user['infraction_type']].'",';
            // $row .= '"'.$aht_acpt[$user['aht_acpt']].'",';
            // $row .= '"'.$user['l1_drill_down'].'",';
            // $row .= '"'.$user['l2_drill_down'].'",';
            // $row .= '"'.$user['observation'].'",';

            $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

            fwrite($fopen,$row."\r\n");
        }
        fclose($fopen);
	}


	public function download_qa_hcco_flex_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA HCCO FLEX Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function download_qa_hcco_sr_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA HCCO SR COMPLIANCE Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_hcco_flex_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$controller = "Qa_homeadvisor";
		$edit_url = "mgnt_hcco_feedback_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor", "Call Date", "Call Duration", "SR Number","Flex Lob", "Audit Type", "VOC","Tenure","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Required all calls - INTRODUCTION", "Required all calls - VERIFICATION", "Required all calls - EXPECTATIONS", "Required all calls - RECORDED LINE", "Required all calls - XM/MMR/IB", "Required Filters - DISPO", "Required Filters - SUBMIT", "Required Filters - PURPOSE", "Required Filters - CROSS SELL", "Required Filters - EDUCATE", "Required Filters - VERIFICATION", "Required Credits - DISPO", "Required Credits - TICKET", "Required Credits - CROSS SELL", "Required Credits - EDUCATE", "Required Credits - PURPOSE", "Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Compliance Score","Customer Score","Business Score", "Call Summary", "Feedback", "Agent Review Date","Agent Feedback Acceptance Status", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['sr_number'].'",';
			$row .= '"'.$user['flex_lob'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['include_ha_branding'].'",';
			$row .= '"'.$user['correct_contact_information'].'",';
			$row .= '"'.$user['consumer_expect_call'].'",';
			$row .= '"'.$user['call_introduction_recorded'].'",';
			$row .= '"'.$user['mmr_submitted'].'",';
			$row .= '"'.$user['filter_call_disposition'].'",';
			$row .= '"'.$user['appropiate_CTT_consumer'].'",';
			$row .= '"'.$user['call_purposr'].'",';
			$row .= '"'.$user['cross_cell_site'].'",';
			$row .= '"'.$user['educate_HA_work'].'",';
			$row .= '"'.$user['details_ensure_accuracy'].'",';
			$row .= '"'.$user['credit_call_appropiately'].'",';
			$row .= '"'.$user['credit_ticket_information'].'",';
			$row .= '"'.$user['cross_cell_project'].'",';
			$row .= '"'.$user['credit_HA_work'].'",';
			$row .= '"'.$user['credit_call_purpose'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'.$user['compliance_score_percent'].'%'.'",';
			$row .= '"'.$user['customer_score_percent'].'%'.'",';
			$row .= '"'.$user['business_score_percent'].'%'.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

	public function create_qa_hcco_sr_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$controller = "Qa_homeadvisor";
		$edit_url = "mgnt_hcco_feedback_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor", "Call Date", "Shift Date","Trigger Point","Call Duration","SR #", "Correct CTT","SR Type", "CTT","If Incorrect CTT what is the correct CCT","Complete Detailed Description?","Correct Addres and Zipcode?","Correct Email Address?","Disposition Used","Correct Disposition?","If Incorrect Disposition what is the correct one?","Unblocked Email?","Opted Out Email?","Possible Stella Manipulation?","Survey Received?	","With Recording?","Recording Link (If Applicable)","State","Restricted State?","Audit Type", "Auditor Type","VOC","Tenure","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)",  "Remarks/Comments", "Agent Review Date","Agent Feedback Acceptance Status", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['shift_date'].'",';
			$row .= '"'.$user['trigger_point'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['sr_number'].'",';
			$row .= '"'.$user['correct_CTT'].'",';
			$row .= '"'.$user['sr_mother'].'",';
			$row .= '"'.$user['ctt'].'",';
			$row .= '"'.$user['incorrect_ctt'].'",';
			$row .= '"'.$user['description'].'",';
			$row .= '"'.$user['addr_zip'].'",';
			$row .= '"'.$user['addr_email'].'",';
			$row .= '"'.$user['dispo'].'",';
			$row .= '"'.$user['crrt_dispo'].'",';
			$row .= '"'.$user['incrrt_dispo'].'",';
			$row .= '"'.$user['unblocked_email'].'",';
			$row .= '"'.$user['opted_email'].'",';
			$row .= '"'.$user['manipulation'].'",';
			$row .= '"'.$user['survey_received'].'",';
			$row .= '"'.$user['recoding'].'",';
			$row .= '"'.$user['record_link'].'",';
			$row .= '"'.$user['state'].'",';
			$row .= '"'.$user['restricted_state'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['tenure'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////// QA Entice Energy REPORT ////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_entice_energy_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_entice_energy_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["entice_energy_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_rvw_by) as client_rvw_name from qa_entice_energy_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["entice_energy_list"] = $fullAray;
				$this->create_qa_entice_energy_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_entice_energy_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_entice_energy_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Entice Energy List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_entice_energy_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Agent", "L1 Super", "Call Date", "Customer Name", "Week End Date", "Call Type", "Customer Phone", "Audit Type", "VOC", "Overall Score", "Earned Score", "Possible Score", "Agent states name", "Confirmation that speaking to DMC", "Golden Account details confirmed Customers", "Customer to provide first line", "Did agent ask if customer takes part in the WHD", "Confirm Single/ Duel Fuel", "Tariff probed 3 times", "Have you asked sufficient questions to accurately", "Does the customer have a Smart Meter?", "Economy 7 checked and caller advised correctly?", "Confirm if customer has any debt?", "Did agent give Entice Energy", "Did agent give current and future spends?", "C3a Daily standing charge & unit rates provided in full", "C3b VAT Statement customer advised comparison", "C4a Customer advised if cancellation fees", "C4b Customer advised of SP cancellation fees", "Verify that the customer is the named bank", "Obtained & reconfirmed the account number", "Advised that they will receive confirmation of payments", "Informed that the direct debit mandate", "T&Cs read correctly?", "Did agent read contact number", "Sign up scripting read and clear", "Was the agent open honest and transparent", "G1a Did the agent recognise signs of potential vulnerability", "G1b Did the agent ask the Vulnerability Priority", "Did the agent take appropriate action act accordingly", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review By", "Client Review Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['customer_name'].'",';
			$row .= '"'.$user['week_end_date'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['customer_phone'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['agentstatesname'].'",';
			$row .= '"'.$user['cofirmspeakingtoDMC'].'",';
			$row .= '"'.$user['goldenaccountdetails'].'",';
			$row .= '"'.$user['customerprovide1stline'].'",';
			$row .= '"'.$user['customertakepartinWHD'].'",';
			$row .= '"'.$user['confirmsigleduelFuel'].'",';
			$row .= '"'.$user['tariffprobed3times'].'",';
			$row .= '"'.$user['askedsufficientquestion'].'",';
			$row .= '"'.$user['customerhaveSmartmeter'].'",';
			$row .= '"'.$user['economy7checked'].'",';
			$row .= '"'.$user['customerhasanydebt'].'",';
			$row .= '"'.$user['agentgavebesttariff'].'",';
			$row .= '"'.$user['agentgavefuturespend'].'",';
			$row .= '"'.$user['dailystandingcharges_C3a'].'",';
			$row .= '"'.$user['VATstatement_C3b'].'",';
			$row .= '"'.$user['cancelletionfees_C4a'].'",';
			$row .= '"'.$user['SPcancelletionfees_C4b'].'",';
			$row .= '"'.$user['verifycustomerbankaccount'].'",';
			$row .= '"'.$user['reconfirmaccountnumber'].'",';
			$row .= '"'.$user['receiveconfirmpayment'].'",';
			$row .= '"'.$user['directdebitmandate'].'",';
			$row .= '"'.$user['correctT&Cneed'].'",';
			$row .= '"'.$user['agentreadcontactnumber'].'",';
			$row .= '"'.$user['signupScriptingread'].'",';
			$row .= '"'.$user['honestwithcustomer'].'",';
			$row .= '"'.$user['potentialVulnerability_G1a'].'",';
			$row .= '"'.$user['priorityVulnerability_G1b'].'",';
			$row .= '"'.$user['takeappropriateaction'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}


	/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// QA Doubtnut REPORT //////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_doubtnut_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_doubtnut_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$process="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$process = $this->input->get('process');
			if($process=="doubtnut"){
				$dn_table="qa_doubtnut_feedback";
			}else if($process=="doubtnut_p2p"){
				$dn_table="qa_doubtnut_p2p_scrubbed";
			}

			$data["qa_doubtnut_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from ".$dn_table.") xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_doubtnut_list"] = $fullAray;
				$this->create_qa_doubtnut_CSV($fullAray,$process);
				$dn_link = base_url()."reports_qa/download_qa_doubtnut_CSV/".$process;

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['process']=$process;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_doubtnut_CSV($process)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		if($process=="doubtnut"){
			$title="Doubtnut";
		}else if($process=="doubtnut_p2p"){
			$title="Doubtnut P2P Scrubbed";
		}
		$newfile="QA ".$title." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_doubtnut_CSV($rr,$process)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($process=='doubtnut'){
			$header = array("Auditor Name", "Evaluation Date", "Fusion ID", "Agent", "TL", "Call Date", "Call Duration", "Partner", "Emp ID", "Disposition", "Sub Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greeting", "Self Introduction", "Customer Introduction", "Reason for Call", "Student Class", "Category of Student", "City of Residence", "Parents Profiling", "Examination Preparing for Future Goal", "Judgemnet Point", "Complete analysis of customer requirements", "VMC Introduction - Not applicable for DN Tutions", "VMC - VOD as a solution - Not applicable for DN Tutions", "DN Tutions - IF student is in 10th or 12th and not preparing JEE NEET", "Offerings", "Product Explanation", "Alternate Contact", "Product Price", "Payee Confirmation", "Probe to connect with Payee", "Student views regarding course", "Buying hesitation", "Urgency Creation", "Approach to close sale", "Segment2 - Urgency Creation", "Segment2 - Student Weaknesses", "Segment2 - Product Explanation", "Segment2 - Product Price", "Segment2 - Payment Options", "Segment2 - Parents views regarding course", "Segment2 - Buying hesitation", "Segment2 - Creating Urgency", "Segment2 - Closing the sale", "Segment2 - Summary", "Introduction Comment1", "Introduction Comment2", "Introduction Comment3", "Introduction Comment4", "Student Qualification Comment1", "Student Qualification Comment2", "Student Qualification Comment3", "Student Qualification Comment4", "Student Qualification Comment5", "Student Qualification Comment6", "Student Qualification Comment7", "Need Analysis Comment", "Product Comment1", "Product Comment2", "Product Comment3", "Product Comment4", "Product Comment5", "Pricing & Payment Comment1", "Pricing & Payment Comment2", "Pricing & Payment Comment3", "Pricing & Payment Comment4", "Objection Handling Comment1", "Objection Handling Comment2", "Closing Urgency Comment1", "Closing Urgency Comment2", "Segment2 Closing Urgency Comment", "Segment2 Product Comment1", "Segment2 Product Comment2", "Segment2 Pricing & Payment Comment1", "Segment2 Pricing & Payment Comment2", "Segment2 Objection Handling Comment1", "Segment2 Objection Handling Comment2", "Segment2 Closing & Summary Comment1", "Segment2 Closing & Summary Comment2", "Segment2 Closing & Summary Comment3", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($process=='doubtnut_p2p'){
			$header = array("Scrubbed By", "Lead Date", "Partner", "Student ID", "Student Name", "L1 Supervisor", "Phone", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "LEVEL1 - P2P Generation Date", "LEVEL1 - P2P Generation TM Name", "LEVEL1 - P2P Promise Date", "LEVEL1 - Cause", "LEVEL1 - SubCause", "LEVEL1 - Remarks", "LEVEL2 - Last Connect Date", "LEVEL2 - Last Promise Date", "LEVEL2 - Last Connect TM Name", "LEVEL2 - Cause", "LEVEL2 - SubCause", "LEVEL2 - Remarks", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($process=='doubtnut'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['partner'].'",';
				$row .= '"'.$user['emp_id'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['sub_disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greeting'].'",';
				$row .= '"'.$user['self_introduction'].'",';
				$row .= '"'.$user['customer_introduction'].'",';
				$row .= '"'.$user['reason_for_call'].'",';
				$row .= '"'.$user['student_class'].'",';
				$row .= '"'.$user['student_catagory'].'",';
				$row .= '"'.$user['medium_schooling'].'",';
				$row .= '"'.$user['city_residence'].'",';
				$row .= '"'.$user['parent_profiling'].'",';
				$row .= '"'.$user['examination_prepare'].'",';
				$row .= '"'.$user['judgement_point'].'",';
				$row .= '"'.$user['customer_analysis'].'",';
				$row .= '"'.$user['VMC_introduction'].'",';
				$row .= '"'.$user['VOD_solution'].'",';
				$row .= '"'.$user['DN_titution'].'",';
				$row .= '"'.$user['offering'].'",';
				$row .= '"'.$user['product_explanation'].'",';
				$row .= '"'.$user['alternate_contact'].'",';
				$row .= '"'.$user['product_price'].'",';
				$row .= '"'.$user['payee_confirmation'].'",';
				$row .= '"'.$user['probe_to_connect'].'",';
				$row .= '"'.$user['student_course_view'].'",';
				$row .= '"'.$user['buying_hesitation'].'",';
				$row .= '"'.$user['urgency_creation'].'",';
				$row .= '"'.$user['approach_close_sale'].'",';
				$row .= '"'.$user['introduction_payee_segment2'].'",';
				$row .= '"'.$user['student_weakness_segment2'].'",';
				$row .= '"'.$user['product_explaination_segment2'].'",';
				$row .= '"'.$user['product_price_segment2'].'",';
				$row .= '"'.$user['payment_option_segment2'].'",';
				$row .= '"'.$user['parent_view_course_segment2'].'",';
				$row .= '"'.$user['buying_hesitation_segment2'].'",';
				$row .= '"'.$user['creating_urgency_segment2'].'",';
				$row .= '"'.$user['closing_sale_segment2'].'",';
				$row .= '"'.$user['summary_segment2'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt35'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($process=='doubtnut_p2p'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['partner'].'",';
				$row .= '"'.$user['student_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['level1generationdate'].'",';
				$row .= '"'.$user['level1generationTMname'].'",';
				$row .= '"'.$user['level1promisedate'].'",';
				$row .= '"'.$user['level1cause'].'",';
				$row .= '"'.$user['level1subcause'].'",';
				$row .= '"'.$user['level1subcausedate'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level1remarks'])).'",';
				$row .= '"'.$user['level2lastconnectdate'].'",';
				$row .= '"'.$user['level2lastpromisedate'].'",';
				$row .= '"'.$user['level2connectTMname'].'",';
				$row .= '"'.$user['level2cause'].'",';
				$row .= '"'.$user['level2subcause'].'",';
				$row .= '"'.$user['level2subcausedate'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['level2remarks'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

	}



	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////// QA DocuSign REPORT ////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_docusign_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$p_id="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$p_id = $this->input->get('p_id');
			if($p_id=='email'){
				$pid='qa_docusign_email_feedback';
			}else if($p_id=='phone_chat'){
				$pid='qa_docusign_phone_chat_feedback';
			}else if($p_id=='dc_new'){
				$pid='qa_docusign_feedback';
			}

			$data["qa_docusign_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from ".$pid.") xx Left Join
				(Select id as sid, fname, lname, fusion_id, assigned_to, office_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_docusign_list"] = $fullAray;
				$this->create_qa_docusign_CSV($fullAray,$p_id);
				$dn_link = base_url()."reports_qa/download_qa_docusign_CSV/".$p_id;

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['p_id']=$p_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_docusign_CSV($p_id)
	{
		$currDate=date("Y-m-d");

		if($p_id=='email'){
			$pname='Email';
		}else if($p_id=='phone_chat'){
			$pname='Phone & Chat';
		}else if($p_id=='dc_new'){
			$pname='New';
		}

		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Docusign ".$pname." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_docusign_CSV($rr,$p_id)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_docusign";
		$fopen = fopen($filename,"w+");

		if($p_id=='email'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Case Number", "Call Duration", "Topic", "Sub-Topic", "Opportunity Area", "Audit Type", "VOC", "Audit Link","Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Properly verifies the admin before making any account changes", "Does not close or cancel any corporate accounts and prior to closing Web accounts advises that documents will be inaccessible upon closure", "Submits all eligible refund requests in accordance with the Refund Policy", "Properly submits ACRs in all applicable scenarios", "Obtains verbal or written permission from an authenticated admin before enabling or disabling any account features", "Verifies the necessary account billing information OR ensures that an email sent by an authenticated Account", "Does not volunteer PII information to the customer If the customer is an admin PII information can only be provided to them", "Requests that a manager deletes all sensitive customer-provided PII", "Informs the customer that the call may be recorded on outbound or Click-to-Call customer engagements", "Does not engage in a reverse screen sharing", "Sends all email communications from within the Salesforce case", "Does not provide their personal work email address in any fashion", "Observes all procedures of unique customer contacts", "Directs the customer to their AM in scenarios listed on the Procedures page linked to in Policy section 4a", "Does not enable a Paid Feature or discuss the price of a feature", "Properly informs the Account Manager of a bug that affects one of their accounts", "Follows this flowchart when working a case for a customer with a TCSM", "Case Subjects are a high-level concise issue descriptor that is appropriately customer facing", "Case Subject and Description fields do not include abbreviations or shorthand", "Taxonomy status fields email alias and product field are accurate and any Case Issues relating to the case are properly linked", "Duplicate cases are properly tied to their parent case and case notes are input on the parent case rather than child", "The Case Description field contains only a concise summary of the problem the customer is having", "Case is tied to the correct Contact and Account records", "The Expert first responds to a Portal-originated case within a Public Case Comment", "The Expert never assigns the case outside of Support", "All information relevant to the interaction is captured", "If it is clearly documented when a call disconnects and the customer has to be called back", "All envelope IDs version numbers browser types and environment information that is required to troubleshoot a specific problem is documented", "The Expert refrains from negative or derogatory comments about customers", "Unresponsive follow up cadence procedure is observed", "Customer replies are responded to within one business day", "Agreed upon follow-ups with the customer occur when scheduled", "The Expert obtain ownership of the case and contacts the customer the same day", "All technical information provided is accurate", "Uses targeted probing questions and pays attention to key words and phrases to quickly determine the issue", "Asks the customer to perform logical and necessary troubleshooting steps throughout the interaction", "Attempts to offer all troubleshooting steps and utilizes their tools", "Immediately and appropriately acknowledges and responds to the customers emotional statements", "Maintains a friendly confident and professional voice tone throughout interaction", "Stays focused and concise with directions and allows customers to complete tasks prior to moving to next steps", "Refrains from using language that could be interpreted as offensive or controversial to a customer", "Demonstrates active listening by not ignoring customer information", "Appropriately advises of case status next steps and relevant time frames", "Follows through with expectations set for the customer", "Appropriately advises the customer that any test files sent to DocuSign Support", "Closes all screen sharing sessions prior to disconnecting the call or chat", "Two or fewer spelling or grammatical mistakes are observed throughout the customer-facing correspondences", "All specialized company branding such as DocuSign PowerForm etc", "Comment1", "Comment2", "Comment3", "Comment4", "Comment5", "Comment6", "Comment7", "Comment8", "Comment9", "Comment10", "Comment11", "Comment12", "Comment13", "Comment14", "Comment15", "Comment16", "Comment17", "Comment18", "Comment19", "Comment20", "Comment21", "Comment22", "Comment23", "Comment24", "Comment25", "Comment26", "Comment27", "Comment28", "Comment29", "Comment30", "Comment31", "Comment32", "Comment33", "Comment34", "Comment35", "Comment36", "Comment37", "Comment38", "Comment39", "Comment40", "Comment41", "Comment42", "Comment43", "Comment44", "Comment45", "Comment46", "Comment47", "Comment48", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($p_id=='phone_chat'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Case Number", "Call Duration", "Topic", "Sub-Topic", "Opportunity Area", "Audit Type", "VOC", "Audit Link","Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Properly verifies the admin before making any account changes", "Does not close or cancel any corporate accounts and prior to closing Web accounts advises that documents will be inaccessible upon closure", "Submits all eligible refund requests in accordance with the Refund Policy", "Properly submits ACRs in all applicable scenarios", "Obtains verbal or written permission from an authenticated admin before enabling or disabling any account features", "Verifies the necessary account billing information OR ensures that an email sent by an authenticated Account", "Does not volunteer PII information to the customer If the customer is an admin PII information can only be provided to them", "Requests that a manager deletes all sensitive customer-provided PII", "Informs the customer that the call may be recorded on outbound or Click-to-Call customer engagements", "Does not engage in a reverse screen sharing", "Sends all email communications from within the Salesforce case", "Does not provide their personal work email address in any fashion", "Observes all procedures of unique customer contacts", "Directs the customer to their AM in scenarios listed on the Procedures page linked to in Policy section 4a", "Does not enable a Paid Feature or discuss the price of a feature", "Properly informs the Account Manager of a bug that affects one of their accounts", "Follows this flowchart when working a case for a customer with a TCSM", "Case Subjects are a high-level concise issue descriptor that is appropriately customer facing", "Case Subject and Description fields do not include abbreviations or shorthand", "Taxonomy status fields email alias and product field are accurate and any Case Issues relating to the case are properly linked", "Duplicate cases are properly tied to their parent case and case notes are input on the parent case rather than child", "The Case Description field contains only a concise summary of the problem the customer is having", "Case is tied to the correct Contact and Account records", "The Expert first responds to a Portal-originated case within a Public Case Comment", "The Expert never assigns the case outside of Support", "All information relevant to the interaction is captured", "If it is clearly documented when a call disconnects and the customer has to be called back", "All envelope IDs version numbers browser types and environment information that is required to troubleshoot a specific problem is documented", "The Expert refrains from negative or derogatory comments about customers", "Unresponsive follow up cadence procedure is observed", "Customer replies are responded to within one business day", "Agreed upon follow-ups with the customer occur when scheduled", "The Expert obtain ownership of the case and contacts the customer the same day", "All technical information provided is accurate", "Uses targeted probing questions and pays attention to key words and phrases to quickly determine the issue", "Asks the customer to perform logical and necessary troubleshooting steps throughout the interaction", "Attempts to offer all troubleshooting steps and utilizes their tools", "Immediately and appropriately acknowledges and responds to the customers emotional statements", "Maintains a friendly confident and professional voice tone throughout interaction", "Stays focused and concise with directions and allows customers to complete tasks prior to moving to next steps", "Refrains from using language that could be interpreted as offensive or controversial to a customer", "Demonstrates active listening by not ignoring customer information", "Appropriately advises of case status next steps and relevant time frames", "Clearly and appropriately sets hold and mute expectations", "Follows through with expectations set for the customer", "Appropriately advises the customer that any test files sent to DocuSign Support", "Closes all screen sharing sessions prior to disconnecting the call or chat", "Two or fewer spelling or grammatical mistakes are observed throughout the customer-facing correspondences", "All specialized company branding such as DocuSign PowerForm etc", "Comment1", "Comment2", "Comment3", "Comment4", "Comment5", "Comment6", "Comment7", "Comment8", "Comment9", "Comment10", "Comment11", "Comment12", "Comment13", "Comment14", "Comment15", "Comment16", "Comment17", "Comment18", "Comment19", "Comment20", "Comment21", "Comment22", "Comment23", "Comment24", "Comment25", "Comment26", "Comment27", "Comment28", "Comment29", "Comment30", "Comment31", "Comment32", "Comment33", "Comment34", "Comment35", "Comment36", "Comment37", "Comment38", "Comment39", "Comment40", "Comment41", "Comment42", "Comment43", "Comment44", "Comment45", "Comment46", "Comment47", "Comment48", "Comment49", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($p_id=='dc_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Case Number", "Call Duration", "Time Stamp", "Case Topic", "Case Sub-Topic", "ACPT", "Industry", "Industry Other", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1) Did the agent execute properly any of these processes and properly verifies the admin", "Qustion1 Checkbox1", "Qustion2 Checkbox2", "2) Did the agent advise the customer that documents will be inaccessible upon closure?", "3) Did the agent properly submit ACRs in all applicable scenarios?", "4) Did the agent execute any of these processes about proper handling of PII information?", "Qustion4 Checkbox1", "Qustion4 Checkbox2", "5) Did the agent inform the customer that the call may be recorded on outbound", "6) Did the agent send all email communications only from within the Salesforce case?", "7) Did the agent not provide their personal work email address in any fashion?", "8) Did the agent appropriately advise the customer that any test files sent to DocuSign", "9) Did the agent execute properly any of the Escalation to Service Management", "Qustion9 Checkbox1", "Qustion9 Checkbox2", "Qustion9 Checkbox3", "10) Did the agent properly execute any of the process for CASE MANAGEMENT & POLICIES: Were all case fields filled out properly?", "Qustion10 Checkbox1", "Qustion10 Checkbox2", "Qustion10 Checkbox3", "Qustion10 Checkbox4", "Qustion10 Checkbox5", "Qustion10 Checkbox6", "Qustion10 Checkbox7", "Qustion10 Checkbox8", "11) Did the agent properly execute any of the process for CASE MANAGEMENT & POLICIES: Were Case Comments Complete and Accurate?", "Qustion11 Checkbox1", "Qustion11 Checkbox2", "Qustion11 Checkbox3", "Qustion11 Checkbox4", "12) Did the agent execute properly any of the cost-affecting process?", "Qustion12 Checkbox1", "Qustion12 Checkbox2", "Qustion12 Checkbox3", "Qustion12 Checkbox4", "Qustion12 Checkbox5", "13) Did the agent execute any of troubleshooting standard procedure and demonstrate logical", "Qustion13 Checkbox1", "Qustion13 Checkbox2", "Qustion13 Checkbox3", "Qustion13 Checkbox4", "14) Did the agent properly execute any of the process for CASE MANAGEMENT & POLICIES: Were all follow up policies observed when appropriate?", "Qustion14 Checkbox1", "Qustion14 Checkbox2", "Qustion14 Checkbox3", "15) Did the agent properly execute any of the process for SOFT SKILLS: Agent display courtesy positive tone and active listening?", "Qustion15 Checkbox1", "Qustion15 Checkbox2", "Qustion15 Checkbox3", "Qustion15 Checkbox4", "Qustion15 Checkbox5", "16) Did the agent properly execute any of the process for SOFT SKILLS and meet the expectations they set during the interactions?", "Qustion16 Checkbox1", "Qustion16 Checkbox2", "Qustion16 Checkbox3", "Qustion16 Checkbox4", "17) Did the agent properly execute any of the process for SOFT SKILLS and use proper spelling and grammar for all written or verbal customer-facing communication?", "Qustion17 Checkbox1", "Qustion17 Checkbox2", "Qustion17 Checkbox3", "Comment1", "Comment2", "Comment3", "Comment4", "Comment5", "Comment6", "Comment7", "Comment8", "Comment9", "Comment10", "Comment11", "Comment12", "Comment13", "Comment14", "Comment15", "Comment16", "Comment17", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($p_id=='email'){

		$edit_url = "mgnt_docusign_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['case_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['topic'].'",';
				$row .= '"'.$user['subtopic'].'",';
				$row .= '"'.$user['oppor_area'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['adminPropertyVerify'].'",';
				$row .= '"'.$user['donotCloseCorporateAccount'].'",';
				$row .= '"'.$user['submitAllEligibleRefund'].'",';
				$row .= '"'.$user['properlySubmitACR'].'",';
				$row .= '"'.$user['obtainRetainPermission'].'",';
				$row .= '"'.$user['verifyAccountBillingInfo'].'",';
				$row .= '"'.$user['volunteerPIIInformation'].'",';
				$row .= '"'.$user['managerDeleteCustomerPII'].'",';
				$row .= '"'.$user['customerCallMaybeRecorded'].'",';
				$row .= '"'.$user['engageReverseScreening'].'",';
				$row .= '"'.$user['sendAllEmailComunication'].'",';
				$row .= '"'.$user['doesnotProvidePersonalEmail'].'",';
				$row .= '"'.$user['observesCustomerContact'].'",';
				$row .= '"'.$user['directCustomerAMScenario'].'",';
				$row .= '"'.$user['doesnotEnablePaidFeature'].'",';
				$row .= '"'.$user['properlyInformAccountManager'].'",';
				$row .= '"'.$user['followstheFlowchart'].'",';
				$row .= '"'.$user['caseSubjectAreHighLevel'].'",';
				$row .= '"'.$user['caseSubjectFieldnotInclude'].'",';
				$row .= '"'.$user['taxonomyStatusFieldAccurate'].'",';
				$row .= '"'.$user['duplicateCaseProperlyTied'].'",';
				$row .= '"'.$user['caseDescriptionFieldContain'].'",';
				$row .= '"'.$user['caseTiedCorrectContact'].'",';
				$row .= '"'.$user['expartFirstRespondtoPortal'].'",';
				$row .= '"'.$user['expertNeverAssign'].'",';
				$row .= '"'.$user['allInformationRelevent'].'",';
				$row .= '"'.$user['clearlyDocumentedCallDisconnect'].'",';
				$row .= '"'.$user['envelopeIDsInformation'].'",';
				$row .= '"'.$user['expertRefrainNegativeComment'].'",';
				$row .= '"'.$user['unresponsiveFollowup'].'",';
				$row .= '"'.$user['customerRepliesBusinessDay'].'",';
				$row .= '"'.$user['agreedUponFollowup'].'",';
				$row .= '"'.$user['expertObtainOwenership'].'",';
				$row .= '"'.$user['technicalInformationAccurate'].'",';
				$row .= '"'.$user['useTargetedProbingQuestion'].'",';
				$row .= '"'.$user['performLogicalTroubleshooting'].'",';
				$row .= '"'.$user['attemptOfferAllTroubleshooting'].'",';
				$row .= '"'.$user['appropiateAcknowledgeResponce'].'",';
				$row .= '"'.$user['maintainFriendlyInteraction'].'",';
				$row .= '"'.$user['stayFocusAndConcise'].'",';
				$row .= '"'.$user['refrainFromUsingLanguage'].'",';
				$row .= '"'.$user['demonstrateActiveListening'].'",';
				$row .= '"'.$user['appropiateAdviseCaseStatus'].'",';
				$row .= '"'.$user['followTroughWithExpectation'].'",';
				$row .= '"'.$user['customerTestFilesSent'].'",';
				$row .= '"'.$user['closeAllScreenSharing'].'",';
				$row .= '"'.$user['toworFewerSpelling'].'",';
				$row .= '"'.$user['allSpecializedCompanyBranding'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt35'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt36'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt37'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt38'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt39'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt40'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt41'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt42'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt43'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt44'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt45'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt46'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt47'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt48'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($p_id=='phone_chat'){
			$edit_url = "mgnt_phonechat_rvw";
		    $main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval2 = '---';
				}else{
					$interval2 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['case_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['topic'].'",';
				$row .= '"'.$user['subtopic'].'",';
				$row .= '"'.$user['oppor_area'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval2.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['adminPropertyVerify'].'",';
				$row .= '"'.$user['donotCloseCorporateAccount'].'",';
				$row .= '"'.$user['submitAllEligibleRefund'].'",';
				$row .= '"'.$user['properlySubmitACR'].'",';
				$row .= '"'.$user['obtainRetainPermission'].'",';
				$row .= '"'.$user['verifyAccountBillingInfo'].'",';
				$row .= '"'.$user['volunteerPIIInformation'].'",';
				$row .= '"'.$user['managerDeleteCustomerPII'].'",';
				$row .= '"'.$user['customerCallMaybeRecorded'].'",';
				$row .= '"'.$user['engageReverseScreening'].'",';
				$row .= '"'.$user['sendAllEmailComunication'].'",';
				$row .= '"'.$user['doesnotProvidePersonalEmail'].'",';
				$row .= '"'.$user['observesCustomerContact'].'",';
				$row .= '"'.$user['directCustomerAMScenario'].'",';
				$row .= '"'.$user['doesnotEnablePaidFeature'].'",';
				$row .= '"'.$user['properlyInformAccountManager'].'",';
				$row .= '"'.$user['followstheFlowchart'].'",';
				$row .= '"'.$user['caseSubjectAreHighLevel'].'",';
				$row .= '"'.$user['caseSubjectFieldnotInclude'].'",';
				$row .= '"'.$user['taxonomyStatusFieldAccurate'].'",';
				$row .= '"'.$user['duplicateCaseProperlyTied'].'",';
				$row .= '"'.$user['caseDescriptionFieldContain'].'",';
				$row .= '"'.$user['caseTiedCorrectContact'].'",';
				$row .= '"'.$user['expartFirstRespondtoPortal'].'",';
				$row .= '"'.$user['expertNeverAssign'].'",';
				$row .= '"'.$user['allInformationRelevent'].'",';
				$row .= '"'.$user['clearlyDocumentedCallDisconnect'].'",';
				$row .= '"'.$user['envelopeIDsInformation'].'",';
				$row .= '"'.$user['expertRefrainNegativeComment'].'",';
				$row .= '"'.$user['unresponsiveFollowup'].'",';
				$row .= '"'.$user['customerRepliesBusinessDay'].'",';
				$row .= '"'.$user['agreedUponFollowup'].'",';
				$row .= '"'.$user['expertObtainOwenership'].'",';
				$row .= '"'.$user['technicalInformationAccurate'].'",';
				$row .= '"'.$user['useTargetedProbingQuestion'].'",';
				$row .= '"'.$user['performLogicalTroubleshooting'].'",';
				$row .= '"'.$user['attemptOfferAllTroubleshooting'].'",';
				$row .= '"'.$user['appropiateAcknowledgeResponce'].'",';
				$row .= '"'.$user['maintainFriendlyInteraction'].'",';
				$row .= '"'.$user['stayFocusAndConcise'].'",';
				$row .= '"'.$user['refrainFromUsingLanguage'].'",';
				$row .= '"'.$user['demonstrateActiveListening'].'",';
				$row .= '"'.$user['appropiateAdviseCaseStatus'].'",';
				$row .= '"'.$user['setHoldMuteExpectation'].'",';
				$row .= '"'.$user['followTroughWithExpectation'].'",';
				$row .= '"'.$user['customerTestFilesSent'].'",';
				$row .= '"'.$user['closeAllScreenSharing'].'",';
				$row .= '"'.$user['toworFewerSpelling'].'",';
				$row .= '"'.$user['allSpecializedCompanyBranding'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt35'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt36'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt37'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt38'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt39'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt40'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt41'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt42'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt43'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt44'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt45'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt46'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt47'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt48'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt49'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($p_id=='dc_new'){
			$edit_url = "add_docusign_new";
			$main_url =  $currentURL.''.$controller.'/'.$edit_url;

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval2 = '---';
				}else{
					$interval2 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['case_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['time_stamp'].'",';
				$row .= '"'.$user['case_topic'].'",';
				$row .= '"'.$user['case_sub_topic'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['industry'].'",';
				$row .= '"'.$user['industry_other'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval2.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['making_account_change'].'",';
				$row .= '"'.$user['compliance1_check1'].'",';
				$row .= '"'.$user['compliance1_check2'].'",';
				$row .= '"'.$user['for_account_closure'].'",';
				$row .= '"'.$user['properly_submit_ACRs'].'",';
				$row .= '"'.$user['proper_handling_PII'].'",';
				$row .= '"'.$user['compliance4_check1'].'",';
				$row .= '"'.$user['compliance4_check2'].'",';
				$row .= '"'.$user['inform_customer_call_record'].'",';
				$row .= '"'.$user['send_email_communication'].'",';
				$row .= '"'.$user['not_provide_personal_eork'].'",';
				$row .= '"'.$user['testfile_sent_to_docusign'].'",';
				$row .= '"'.$user['escalation_service_management'].'",';
				$row .= '"'.$user['business9_check1'].'",';
				$row .= '"'.$user['business9_check2'].'",';
				$row .= '"'.$user['business9_check3'].'",';
				$row .= '"'.$user['process_of_case_management'].'",';
				$row .= '"'.$user['business10_check1'].'",';
				$row .= '"'.$user['business10_check2'].'",';
				$row .= '"'.$user['business10_check3'].'",';
				$row .= '"'.$user['business10_check4'].'",';
				$row .= '"'.$user['business10_check5'].'",';
				$row .= '"'.$user['business10_check6'].'",';
				$row .= '"'.$user['business10_check7'].'",';
				$row .= '"'.$user['business10_check8'].'",';
				$row .= '"'.$user['process_of_case_policies'].'",';
				$row .= '"'.$user['business11_check1'].'",';
				$row .= '"'.$user['business11_check2'].'",';
				$row .= '"'.$user['business11_check3'].'",';
				$row .= '"'.$user['business11_check4'].'",';
				$row .= '"'.$user['cost_affecting_process'].'",';
				$row .= '"'.$user['business12_check1'].'",';
				$row .= '"'.$user['business12_check2'].'",';
				$row .= '"'.$user['business12_check3'].'",';
				$row .= '"'.$user['business12_check4'].'",';
				$row .= '"'.$user['business12_check5'].'",';
				$row .= '"'.$user['troushooting_standard_procedure'].'",';
				$row .= '"'.$user['customer13_check1'].'",';
				$row .= '"'.$user['customer13_check2'].'",';
				$row .= '"'.$user['customer13_check3'].'",';
				$row .= '"'.$user['customer13_check4'].'",';
				$row .= '"'.$user['observe_policies_appropiately'].'",';
				$row .= '"'.$user['customer14_check1'].'",';
				$row .= '"'.$user['customer14_check2'].'",';
				$row .= '"'.$user['customer14_check3'].'",';
				$row .= '"'.$user['process_of_soft_skill'].'",';
				$row .= '"'.$user['customer15_check1'].'",';
				$row .= '"'.$user['customer15_check2'].'",';
				$row .= '"'.$user['customer15_check3'].'",';
				$row .= '"'.$user['customer15_check4'].'",';
				$row .= '"'.$user['customer15_check5'].'",';
				$row .= '"'.$user['expectation_during_interaction'].'",';
				$row .= '"'.$user['customer16_check1'].'",';
				$row .= '"'.$user['customer16_check2'].'",';
				$row .= '"'.$user['customer16_check3'].'",';
				$row .= '"'.$user['customer16_check4'].'",';
				$row .= '"'.$user['use_proper_spelling'].'",';
				$row .= '"'.$user['customer17_check1'].'",';
				$row .= '"'.$user['customer17_check2'].'",';
				$row .= '"'.$user['customer17_check3'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}

	}





///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// Craftjack All ////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
public function qa_craftjack_report(){
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_craftjack_report.php";
		$data["content_js"] = "qa_loanxm_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		$data["qa_craftjack_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from 	= mmddyy2mysql($this->input->get('date_from'));
			$date_to 	= mmddyy2mysql($this->input->get('date_to'));
			$office_id 	= $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');
			$campaign 	= $this->input->get('campaign');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				//$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
		
			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_craftjack_list"] = $fullAray;
			$this->create_qa_craftjack_CSV($fullAray,$campaign);
			$dn_link = base_url()."reports_qa/download_qa_craftjack_CSV/";
		}

		$data['download_link']=$dn_link;
		$data["action"] = $action;
		$data['date_from'] = $date_from;
		$data['date_to'] = $date_to;
		$data['office_id']=$office_id;
		$data['audit_type']=$audit_type;
		$data['campaign']=$campaign;
		$this->load->view('dashboard',$data);
	}
}


public function download_qa_craftjack_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Craftjack farms Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_craftjack_CSV($rr,$campaign)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	if($campaign == 'craftjack_new')
	{
		////////////////////////////////////////////////////////
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor", "Customer Name", "Customer Phone", "Call Date", "Call Duration", "Service Request","Factor","L1 Analysis","AHT RCA","L1","L2","Call Type","Fatal Erro","Audit Type","Auditor Type", "VOC","Tenure","Audit Link", "Call Pass/Fail",
		"Opened call Properly (did the agent mentioned about Recorded Line)","Comment 1",
		"Confirmed Requested Job","Comment 2",
		"Probed Job done","Comment 3",
		"Job done by suggested company","Comment 4",
		"Probed Experience","Comment 5",
		"Offered Upsell","Comment 6",
		"Authorised to Send Details","Comment 7",
		"Gather Contact Details (email/phone/address)","Comment 8",
		"Read Contact Verbatim","Comment 9",
		"Active Listening","Comment 15",
		"Informed Contact procedure","Comment 10",
		"Interrupted customer","Comment 11",
		"Call Etiquette","Comment 16",
		"Rate of speech / Clarity","Comment 12",
		"Ownership of call","Comment 13",
		"Closing","Comment 14",
		"Positive",
		"Negative",
    	
		"Possible Score", "Earned Score", "Overall Score","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			$call_summary = '';
			$aoi = '';
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['service_request'].'",';
				$row .= '"'.$user['factor'].'",';
				$row .= '"'.$user['analysis'].'",';
				$row .= '"'.$user['aht_rca'].'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				//$row .= '"'.$user['interaction_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['ftl_error'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['pass_fail'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['opened_call_properly'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['confirmed_requested'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['probed_job'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['suggested_company'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['probed_experience'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['offered_upsell'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['authorised_to'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['gather_contact'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['contact_verbatim'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['informed_contact'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['interrupted_customer'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['call_etiquette'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['rate_of_speech'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['ownership_of_call'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['positive'].'",';
				$row .= '"'.$user['negative'].'",';
				
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
		////////////////////////////////////////////////////////
	}else{
			////////////////////////////////////////////////////////
			$header = array("Auditor Name", "Audit Date", "Call Duration", "Fusion ID", "Agent Name", "Customer Name", "Call Date", "Call Type", "Audit Type", "VOC","Tenure","Audit Link", "Overall Score","Did the agententhusiastically welcome or greet the caller/customer?","Did the agent mentioned her name?","Did the agent ask the caller's name?","Did the agent understand the correct project Request?","Did the agent ask probing questions?","Did the agent select the correct panel?","Did the agent follow the questions to  the panel?","Did the agent ask for brief description about the project?","Did the agent get all of the information? (Email- Optional)","Did the agent mention this statement Do you agree to Improvenet terms including that Improvenet our service professionals partners will reach out to you via automated call text at the phone number you provided this project before submitting the SR","Active Listening Skills","Did the agent sound conversational?","Did the agent use proper tone and speed?","Did the agent avoid dead air?","Was the agent polite?","Did the agent ended the call with the closure greeting?Thank you for calling improvenet" ,"Comment1","Comment2","Comment3","Comment4","Comment5","Comment6","Comment7","Comment8","Comment9","Comment10","Comment11","Comment12","Comment13","Comment14","Comment15","Comment16","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );
		}
	$row = "";
	foreach($header as $data) $row .= ''.$data.',';
	fwrite($fopen,rtrim($row,",")."\r\n");
	$searches = array("\r", "\n", "\r\n");

	foreach($rr as $user){
		$call_summary = '';
		$aoi = '';
		if($user['entry_by']!=''){
			$auditorName = $user['auditor_name'];
		}else{
			$auditorName = $user['client_name'];
		}

		if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
			$interval1 = '---';
		}else{
			$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
		}

		$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['did_agent_enthusiastically'].'",';
				$row .= '"'.$user['did_agent_mention'].'",';
				$row .= '"'.$user['did_agent_ask'].'",';
				$row .= '"'.$user['did_agent_understand'].'",';
				$row .= '"'.$user['did_agent_ask_probing'].'",';
				$row .= '"'.$user['did_agent_select'].'",';
				$row .= '"'.$user['did_agent_follow'].'",';
				$row .= '"'.$user['did_agent_brief_description'].'",';
				$row .= '"'.$user['did_agent_get_all'].'",';
				$row .= '"'.$user['did_agent_mention_statement'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['did_agent_sound_conversational'].'",';
				$row .= '"'.$user['did_agent_use_propertone'].'",';
				$row .= '"'.$user['did_agent_deadair'].'",';
				$row .= '"'.$user['was_the_agent_polite'].'",';
				$row .= '"'.$user['did_agent_ended_call'].'",';
		        $row .= '"'.$user['cmt1'].'",';
		        $row .= '"'.$user['cmt2'].'",';
		        $row .= '"'.$user['cmt3'].'",';
		        $row .= '"'.$user['cmt4'].'",';
		        $row .= '"'.$user['cmt5'].'",';
		        $row .= '"'.$user['cmt6'].'",';
		        $row .= '"'.$user['cmt7'].'",';
		        $row .= '"'.$user['cmt8'].'",';
		        $row .= '"'.$user['cmt9'].'",';
		        $row .= '"'.$user['cmt10'].'",';
		        $row .= '"'.$user['cmt11'].'",';
		        $row .= '"'.$user['cmt12'].'",';
		        $row .= '"'.$user['cmt13'].'",';
		        $row .= '"'.$user['cmt14'].'",';
		        $row .= '"'.$user['cmt15'].'",';
		        $row .= '"'.$user['cmt16'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

		fwrite($fopen,$row."\r\n");
	}
	fclose($fopen);
	////////////////////////////////////////////////////////
}


///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA craftjack REPORT ////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

// 	public function qa_craftjack_report(){
// 		if(check_logged_in()){

// 			$office_id = "";
// 			$user_office_id=get_user_office_id();
// 			$current_user = get_user_id();
// 			$is_global_access=get_global_access();
// 			$role_dir=get_role_dir();
// 			$data["show_download"] = false;
// 			$data["download_link"] = "";
// 			$data["show_table"] = false;
// 			$data["show_table"] = false;

// 			$data["aside_template"] = "reports_qa/aside.php";
// 			$data["content_template"] = "reports_qa/qa_craftjack_report.php";

// 			$date_from="";
// 			$date_to="";
// 			$action="";
// 			$dn_link="";
// 			$cond="";
// 			$offcond="";
// 			$cond1="";

// 			$data["qa_craftjack_list"] = array();

// 			if($this->input->get('show')=='Show')
// 			{
// 				$campaign = $this->input->get('campaign');
// 				$office_id = $this->input->get('office_id');
// 				$date_from = mmddyy2mysql($this->input->get('date_from'));
// 				$date_to = mmddyy2mysql($this->input->get('date_to'));

// 				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

// 				if($office_id=="ALL")
// 				{
// 					$offcond="";
// 				}else{
// 					$offcond .=" and office_id='$office_id'";
// 				}

// 				// if($office_id=="All") $offcond .= "";
// 				// else $offcond .=" and office_id='$office_id'";

// 				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
// 					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
// 				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
// 					$cond1 .=" And assigned_to='$current_user'";
// 				}else{
// 					$cond1 .="";
// 				}



// 				if($campaign=='craftjack_new'){
// 					$tbl='qa_craftjack_new_feedback';
// 				}else if($campaign=='craftjack_cebu'){
// 					$tbl='qa_craftjack_cebu_feedback';
// 				}

// 				$qSql="SELECT * from
// 				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
// 				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
// 				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
// 				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
// 				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from $tbl) xx Left Join
// 				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $offcond $cond1 order by audit_date";

// 				$fullAray = $this->Common_model->get_query_result_array($qSql);
// 				$data["qa_craftjack_list"] = $fullAray;
// 				$this->create_qa_craftjack_CSV($fullAray,$campaign);
// 				$dn_link = base_url()."reports_qa/download_qa_craftjack_CSV";

// 			}
// 				$data['location_list'] = $this->Common_model->get_office_location_list();
// 				$data['download_link']=$dn_link;
// 				$data["action"] = $action;
// 				$data['date_from'] = $date_from;
// 				$data['date_to'] = $date_to;
// 				$data['office_id']=$office_id;
// 				$data['campaign']=$campaign;

// 			$this->load->view('dashboard',$data);
// 		}
// 	}

// ////////////Craftjack ///////////////////////////////
// 	public function download_qa_craftjack_CSV()
// 	{
// 		$currDate=date("Y-m-d");
// 		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
// 		$newfile="QA Craftjack Audit List-'".$currDate."'.csv";

// 		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
// 		readfile($filename);
// 	}

// 	public function create_qa_craftjack_CSV($rr,$campaign)
// 	{
// 		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
// 		$currentURL = base_url();
// 		$controller = "Qa_craftjack";

// 		$fopen = fopen($filename,"w+");
// 		if($campaign=='craftjack_new'){
// 		$edit_url = "add_edit_craftjack";
// 		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
// 		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor", "Customer Name", "Customer Phone", "Call Date", "Call Duration", "Service Request","Factor","L1 Analysis","AHT RCA","L1","L2","Call Type","Fatal Erro","Audit Type","Auditor Type", "VOC","Tenure","Audit Link", "Call Pass/Fail",
// 		"Opened call Properly (did the agent mentioned about Recorded Line)","Comment 1",
// 		"Confirmed Requested Job","Comment 2",
// 		"Probed Job done","Comment 3",
// 		"Job done by suggested company","Comment 4",
// 		"Probed Experience","Comment 5",
// 		"Offered Upsell","Comment 6",
// 		"Authorised to Send Details","Comment 7",
// 		"Gather Contact Details (email/phone/address)","Comment 8",
// 		"Read Contact Verbatim","Comment 9",
// 		"Active Listening","Comment 15",
// 		"Informed Contact procedure","Comment 10",
// 		"Interrupted customer","Comment 11",
// 		"Call Etiquette","Comment 16",
// 		"Rate of speech / Clarity","Comment 12",
// 		"Ownership of call","Comment 13",
// 		"Closing","Comment 14",
// 		"Positive",
// 		"Negative",
    	
// 		"Possible Score", "Earned Score", "Overall Score","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );

// 		// } else if($campaign=='craftjack'){

// 		// $header = array("Auditor Name", "Audit Date", "Call Duration", "Fusion ID", "Agent Name", "L1 Supervisor", "Call Date", "EXT Number", "Call Type", "Recording ID", "Audit Type", "VOC", "Call Pass/Fail", "Introduction - Your Name/Verify who you are speaking with/HomeAdvisor Branding","Educate -  Explain how Craft jack Project Advisor works","Solution -  You explained and offered appropriate solutions based on the consumer?s needs and the conversation","Location & Email - Verify Address if possible (Address required on IB Appts)- Zip code & Email","XM/MMR/IB -  Properly presented all XM/MMR/IB options","Expectations -  Make sure the Consumer knows what to expect after the call and Do what you said you would do","Professionalism -  Maintain proper tone - word choice and rate of speech. Avoid interrupting in a non collaborative conversation","Transfer -  Offer to transfer the Consumer to the Service Professional","Correct/Valid CTT -  Correct CTT was submitted and included a detailed description of the project","Correct Dispo -  Accurately updated and noted every SR submitted within the last 14 days","Displayed a Polite - positive & professional attitude ? does not interrupt","Displayed -Ownership/Decisiveness/Call Control","Listened with interest and acknowledged statements","Verbal Skills (volume/pitch/tone/jargon/slang & avoided dead air)","Customer's Card details captured without repeating","Used proper closing","Purpose -  The advisor stated their purpose for calling","Probe -  The advisor asked questions about the project and related projects & included detailed descriptions","Cross Sell -  The advisor asked for a cross sell","Branding -  Brand HomeAdvisor somewhere other than the Intro", "Overall Score","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );
// 	   }else if($campaign=='craftjack_cebu'){
// 	   	$edit_url = "add_edit_craftjack_cebu";
// 		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
// 		$header = array("Auditor Name", "Audit Date", "Call Duration", "Fusion ID", "Agent Name", "Customer Name", "Call Date", "Call Type", "Audit Type", "VOC","Tenure","Audit Link", "Overall Score","Did the agententhusiastically welcome or greet the caller/customer?","Did the agent mentioned her name?","Did the agent ask the caller's name?","Did the agent understand the correct project Request?","Did the agent ask probing questions?","Did the agent select the correct panel?","Did the agent follow the questions to  the panel?","Did the agent ask for brief description about the project?","Did the agent get all of the information? (Email- Optional)","Did the agent mention this statement Do you agree to Improvenet terms including that Improvenet our service professionals partners will reach out to you via automated call text at the phone number you provided this project before submitting the SR","Active Listening Skills","Did the agent sound conversational?","Did the agent use proper tone and speed?","Did the agent avoid dead air?","Was the agent polite?","Did the agent ended the call with the closure greeting?Thank you for calling improvenet" ,"Comment1","Comment2","Comment3","Comment4","Comment5","Comment6","Comment7","Comment8","Comment9","Comment10","Comment11","Comment12","Comment13","Comment14","Comment15","Comment16","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );
// 	   }


// 		$row = "";
// 		foreach($header as $data) $row .= ''.$data.',';
// 		fwrite($fopen,rtrim($row,",")."\r\n");
// 		$searches = array("\r", "\n", "\r\n");

// 		if($campaign=='craftjack_new'){

// 			foreach($rr as $user){
// 				 if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
// 				 	$interval1 = '---';
// 				 }else{
// 				 	$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
// 				 }
// 				 $main_urls = $main_url.'/'.$user['id'];

// 				$row = '"'.$user['auditor_name'].'",';
// 				$row .= '"'.$user['audit_date'].'",';
// 				$row .= '"'.$user['fusion_id'].'",';
// 				$row .= '"'.$user['fname']." ".$user['lname'].'",';
// 				$row .= '"'.$user['tl_name'].'",';
// 				$row .= '"'.$user['customer'].'",';
// 				$row .= '"'.$user['customer_phone'].'",';
// 				$row .= '"'.$user['call_date'].'",';
// 				$row .= '"'.$user['call_duration'].'",';
// 				$row .= '"'.$user['service_request'].'",';
// 				$row .= '"'.$user['factor'].'",';
// 				$row .= '"'.$user['analysis'].'",';
// 				//$row .= '"'.$user['interaction_id'].'",';
// 				$row .= '"'.$user['call_type'].'",';
// 				$row .= '"'.$user['audit_type'].'",';
// 				$row .= '"'.$user['auditor_type'].'",';
// 				$row .= '"'.$user['voc'].'",';
// 				$row .= '"'.$user['tenure'].'",';
// 				$row .= '"'.$main_urls.'",';
// 				$row .= '"'.$user['pass_fail'].'",';
// 				$row .= '"'.$user['opened_call_properly'].'",';
// 				$row .= '"'.$user['confirmed_requested'].'",';
// 				$row .= '"'.$user['probed_job'].'",';
// 				$row .= '"'.$user['suggested_company'].'",';
// 				$row .= '"'.$user['probed_experience'].'",';
// 				$row .= '"'.$user['offered_upsell'].'",';
// 				$row .= '"'.$user['authorised_to'].'",';
// 				$row .= '"'.$user['gather_contact'].'",';
// 				$row .= '"'.$user['contact_verbatim'].'",';
// 				$row .= '"'.$user['informed_contact'].'",';
// 				$row .= '"'.$user['interrupted_customer'].'",';
// 				$row .= '"'.$user['rate_of_speech'].'",';
// 				$row .= '"'.$user['ownership_of_call'].'",';
// 				$row .= '"'.$user['closing'].'",';
// 				$row .= '"'.$user['positive'].'",';
// 				$row .= '"'.$user['negative'].'",';
// 				$row .= '"'.$user['cmt1'].'",';
// 				$row .= '"'.$user['cmt2'].'",';
// 				$row .= '"'.$user['cmt3'].'",';
// 				$row .= '"'.$user['cmt4'].'",';
// 				$row .= '"'.$user['cmt5'].'",';
// 				$row .= '"'.$user['cmt6'].'",';
// 				$row .= '"'.$user['cmt7'].'",';
// 				$row .= '"'.$user['cmt8'].'",';
// 				$row .= '"'.$user['cmt9'].'",';
// 				$row .= '"'.$user['cmt10'].'",';
// 				$row .= '"'.$user['cmt11'].'",';
// 				$row .= '"'.$user['cmt12'].'",';
// 				$row .= '"'.$user['cmt13'].'",';
// 				$row .= '"'.$user['cmt14'].'",';
// 				$row .= '"'.$user['cmt15'].'",';
// 				$row .= '"'.$user['cmt16'].'",';

// 				$row .= '"'.$user['possible_score'].'",';
// 				$row .= '"'.$user['earned_score'].'",';
// 				$row .= '"'.$user['overall_score'].'",';


// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
// 				$row .= '"'.$user['agent_rvw_date'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
// 				$row .= '"'.$user['mgnt_rvw_date'].'",';
// 				$row .= '"'.$user['mgnt_rvw_name'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';


// 				fwrite($fopen,$row."\r\n");
// 			}
// 			fclose($fopen);

// 		// } else if($campaign=='craftjack'){

// 		// foreach($rr as $user)
// 		// {

// 		// 	if($user['introduction']==8) $introduction='Yes';
// 		// 	else if($user['introduction']==0) $introduction='No';
// 		// 	else if($user['introduction']==8.1) $introduction='N/A';

// 		// 	if($user['educate']==4) $educate='Yes';
// 		// 	else if($user['educate']==0) $educate='No';
// 		// 	else if($user['educate']==4.1) $educate='N/A';

// 		// 	if($user['solution']==10) $solution='Yes';
// 		// 	else if($user['solution']==0) $solution='No';
// 		// 	else if($user['solution']==10.1) $solution='N/A';

// 		// 	if($user['email_zip_code']==10) $email_zip_code='Yes';
// 		// 	else if($user['email_zip_code']==0) $email_zip_code='No';
// 		// 	else if($user['email_zip_code']==10.1) $email_zip_code='N/A';

// 		// 	if($user['xm_mmr_ib']==4) $xm_mmr_ib='Yes';
// 		// 	else if($user['xm_mmr_ib']==0) $xm_mmr_ib='No';
// 		// 	else if($user['xm_mmr_ib']==4.1) $xm_mmr_ib='N/A';
// 		// 	else $xm_mmr_ib='N/A';

// 		// 	if($user['expectation']==4) $expectation='Yes';
// 		// 	else if($user['expectation']==0) $expectation='No';
// 		// 	else if($user['expectation']==4.1) $expectation='N/A';
// 		// 	else $expectation='N/A';

// 		// 	if($user['professionalism']==4) $professionalism='Yes';
// 		// 	else if($user['professionalism']==0) $professionalism='No';
// 		// 	else if($user['professionalism']==4.1) $professionalism='N/A';
// 		// 	else $professionalism='N/A';

// 		// 	if($user['transfer']==4) $transfer='Yes';
// 		// 	else if($user['transfer']==0) $transfer='No';
// 		// 	else if($user['transfer']==4.1) $transfer='N/A';
// 		// 	else $transfer='N/A';

// 		// 	if($user['valid_ctt']==4) $valid_ctt='Yes';
// 		// 	else if($user['valid_ctt']==0) $valid_ctt='No';
// 		// 	else if($user['valid_ctt']==4.1) $valid_ctt='N/A';
// 		// 	else $valid_ctt='N/A';

// 		// 	if($user['correct_dispo']==4) $correct_dispo='Yes';
// 		// 	else if($user['correct_dispo']==0) $correct_dispo='No';
// 		// 	else if($user['correct_dispo']==4.1) $correct_dispo='N/A';
// 		// 	else $correct_dispo='N/A';

// 		// 	if($user['attitude']==8) $attitude='Yes';
// 		// 	else if($user['attitude']==0) $attitude='No';
// 		// 	else if($user['attitude']==8.1) $attitude='N/A';
// 		// 	else $attitude='N/A';

// 		// 	if($user['ownership']==4) $ownership='Yes';
// 		// 	else if($user['ownership']==0) $ownership='No';
// 		// 	else if($user['ownership']==4.1) $ownership='N/A';
// 		// 	else $ownership='N/A';

// 		// 	if($user['acknowledged']==10) $acknowledged='Yes';
// 		// 	else if($user['acknowledged']==0) $acknowledged='No';
// 		// 	else if($user['acknowledged']==10.1) $acknowledged='N/A';
// 		// 	else $acknowledged='N/A';

// 		// 	if($user['verbal_skill']==10) $verbal_skill='Yes';
// 		// 	else if($user['verbal_skill']==0) $verbal_skill='No';
// 		// 	else if($user['verbal_skill']==10.1) $verbal_skill='N/A';
// 		// 	else $verbal_skill='N/A';

// 		// 	if($user['card_detail']==10) $card_detail='Yes';
// 		// 	else if($user['card_detail']==0) $card_detail='No';
// 		// 	else if($user['card_detail']==10.1) $card_detail='N/A';
// 		// 	else $card_detail='N/A';

// 		// 	if($user['proper_closing']==8) $proper_closing='Yes';
// 		// 	else if($user['proper_closing']==0) $proper_closing='No';
// 		// 	else if($user['proper_closing']==8.1) $proper_closing='N/A';
// 		// 	else $proper_closing='N/A';

// 		// 	$row = '"'.$user['auditor_name'].'",';
// 		// 	$row .= '"'.$user['audit_date'].'",';
// 		// 	$row .= '"'.$user['call_duration'].'",';
// 		// 	$row .= '"'.$user['fusion_id'].'",';
// 		// 	$row .= '"'.$user['fname']." ".$user['lname'].'",';
// 		// 	$row .= '"'.$user['tl_name'].'",';
// 		// 	$row .= '"'.$user['call_date'].'",';
// 		// 	$row .= '"'.$user['ext_no'].'",';
// 		// 	$row .= '"'.$user['call_type'].'",';
// 		// 	$row .= '"'.$user['recording_id'].'",';
// 		// 	$row .= '"'.$user['audit_type'].'",';
// 		// 	$row .= '"'.$user['voc'].'",';
// 		// 	$row .= '"'.$user['call_pass_fail'].'",';
// 		// 	$row .= '"'.$introduction.'",';
// 		// 	$row .= '"'.$educate.'",';
// 		// 	$row .= '"'.$solution.'",';
// 		// 	$row .= '"'.$email_zip_code.'",';
// 		// 	$row .= '"'.$xm_mmr_ib.'",';
// 		// 	$row .= '"'.$expectation.'",';
// 		// 	$row .= '"'.$professionalism.'",';
// 		// 	$row .= '"'.$transfer.'",';
// 		// 	$row .= '"'.$valid_ctt.'",';
// 		// 	$row .= '"'.$correct_dispo.'",';
// 		// 	$row .= '"'.$attitude.'",';
// 		// 	$row .= '"'.$ownership.'",';
// 		// 	$row .= '"'.$acknowledged.'",';
// 		// 	$row .= '"'.$verbal_skill.'",';
// 		// 	$row .= '"'.$card_detail.'",';
// 		// 	$row .= '"'.$proper_closing.'",';
// 		// 	$row .= '"'.$user['purpose_for_calling'].'",';
// 		// 	$row .= '"'.$user['probe'].'",';
// 		// 	$row .= '"'.$user['cross_sell'].'",';
// 		// 	$row .= '"'.$user['branding'].'",';
// 		// 	$row .= '"'.$user['overall_score'].'",';
// 		// 	$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
// 		// 	$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
// 		// 	$row .= '"'.$user['agent_rvw_date'].'",';
// 		// 	$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
// 		// 	$row .= '"'.$user['mgnt_rvw_date'].'",';
// 		// 	$row .= '"'.$user['mgnt_name'].'",';
// 		// 	$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

// 		// 	fwrite($fopen,$row."\r\n");
// 		// }

// 		// fclose($fopen);
// 	   }else if($campaign=='craftjack_cebu'){

// 			foreach($rr as $user){
// 				 if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
// 				 	$interval1 = '---';
// 				 }else{
// 				 	$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
// 				 }

// 				$main_urls = $main_url.'/'.$user['id'];
// 				$row = '"'.$user['auditor_name'].'",';
// 				$row .= '"'.$user['audit_date'].'",';
// 				$row .= '"'.$user['call_duration'].'",';
// 				$row .= '"'.$user['fusion_id'].'",';
// 				$row .= '"'.$user['fname']." ".$user['lname'].'",';
// 				$row .= '"'.$user['customer'].'",';
// 				$row .= '"'.$user['customer_phone'].'",';
// 				$row .= '"'.$user['call_date'].'",';
// 				$row .= '"'.$user['call_type'].'",';
// 				$row .= '"'.$user['audit_type'].'",';
// 				$row .= '"'.$user['voc'].'",';
// 				$row .= '"'.$user['tenure'].'",';
// 				$row .= '"'.$main_urls.'",';
// 				$row .= '"'.$user['overall_score'].'",';
// 				$row .= '"'.$user['did_agent_enthusiastically'].'",';
// 				$row .= '"'.$user['did_agent_mention'].'",';
// 				$row .= '"'.$user['did_agent_ask'].'",';
// 				$row .= '"'.$user['did_agent_understand'].'",';
// 				$row .= '"'.$user['did_agent_ask_probing'].'",';
// 				$row .= '"'.$user['did_agent_select'].'",';
// 				$row .= '"'.$user['did_agent_follow'].'",';
// 				$row .= '"'.$user['did_agent_brief_description'].'",';
// 				$row .= '"'.$user['did_agent_get_all'].'",';
// 				$row .= '"'.$user['did_agent_mention_statement'].'",';
// 				$row .= '"'.$user['active_listening'].'",';
// 				$row .= '"'.$user['did_agent_sound_conversational'].'",';
// 				$row .= '"'.$user['did_agent_use_propertone'].'",';
// 				$row .= '"'.$user['did_agent_deadair'].'",';
// 				$row .= '"'.$user['was_the_agent_polite'].'",';
// 				$row .= '"'.$user['did_agent_ended_call'].'",';
// 		        $row .= '"'.$user['cmt1'].'",';
// 		        $row .= '"'.$user['cmt2'].'",';
// 		        $row .= '"'.$user['cmt3'].'",';
// 		        $row .= '"'.$user['cmt4'].'",';
// 		        $row .= '"'.$user['cmt5'].'",';
// 		        $row .= '"'.$user['cmt6'].'",';
// 		        $row .= '"'.$user['cmt7'].'",';
// 		        $row .= '"'.$user['cmt8'].'",';
// 		        $row .= '"'.$user['cmt9'].'",';
// 		        $row .= '"'.$user['cmt10'].'",';
// 		        $row .= '"'.$user['cmt11'].'",';
// 		        $row .= '"'.$user['cmt12'].'",';
// 		        $row .= '"'.$user['cmt13'].'",';
// 		        $row .= '"'.$user['cmt14'].'",';
// 		        $row .= '"'.$user['cmt15'].'",';
// 		        $row .= '"'.$user['cmt16'].'",';

// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
// 				$row .= '"'.$user['agent_rvw_date'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
// 				$row .= '"'.$user['mgnt_rvw_date'].'",';
// 				$row .= '"'.$user['mgnt_rvw_name'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';


// 				fwrite($fopen,$row."\r\n");
// 			}
// 			fclose($fopen);

// 		}
// 	}



/////////////////////////////////////////////inbound carparts//////////////////////////////////////////
public function qa_sales_carpart_inbound_report(){
		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_sales_carpart_inbound_report.php";
			$data["content_js"] = "qa_sales_carpart_js.php";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$offcond="";
			$cond1="";

			$data["qa_inbound_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$campaign = $this->input->get('campaign');
				$office_id = $this->input->get('office_id');
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All"){
					$offcond="";
				}else{
					$offcond .=" and office_id='$office_id'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT id, concat(fname, ' ', lname) as name, assigned_to, fusion_id FROM `signin` where role_id in (select id from role where folder ='agent') and dept_id=6 and is_assign_client (id,54) and status=1  order by name";
			/* and is_assign_process (id,124) */
			$data["agentName"] = $this->Common_model->get_query_result_array($qSql);

				if($campaign=='inbound'){
					$tbl='qa_sales_carpart_inbound_feedback';
				}else if($campaign=='sales'){
					$tbl='qa_sales_carpart__feedback';
				}else if($campaign=='inbound2'){
					$tbl='qa_sales_carpart_inbound2_feedback';
				}

				 $qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from $tbl) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $offcond $cond1 order by audit_date";



				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_inbound_list"] = $fullAray;
				$this->create_qa_carpart_inbound_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_carpart_inbound_CSV";

			}
			$data['location_list'] = $this->Common_model->get_office_location_list();
			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_carpart_inbound_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Carpart Inbound Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_carpart_inbound_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		if($campaign=='inbound'){
		$header = array("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","QA Sampling ","Order Number ","NPS","CSAT","Overall Score ","Possible Score ","Earned Score ","Auto Fail ","Sales Call Type ","Introduction ","Obtaining Customer' Needs","Questioning ","Presentation ","Closing the Sale ","CPP ","Related Parts / Parts Tray","RepairPal","Shipping Options / Shipping Details","Shipping & Billing / YMMSE / Part Name(s)","Tracking Email ","Asking / Offering for additional assistance","CSAT / NPS Survey","Rebranding ","Discount Rules","MyAccount utilization","Data Gathering Compliance","Accuracy", "Documentation ", "Hold Time","Overcoming Objections","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ", "Comments 19", "Comments 20","Comments 21", "Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date" );

		} else if($campaign=='sales'){
		$header = array("Auditor Name", "Audit Date", "Call Duration", "Fusion ID", "Agent Name", "Customer Name", "Call Date", "Call Type", "Audit Type", "VOC", "Overall Score","Did the agententhusiastically welcome or greet the caller/customer?","Did the agent mentioned her name?","Did the agent ask the caller's name?","Did the agent understand the correct project Request?","Did the agent ask probing questions?","Did the agent select the correct panel?","Did the agent follow the questions to  the panel?","Did the agent ask for brief description about the project?","Did the agent get all of the information? (Email- Optional)","Did the agent mention this statement Do you agree to Improvenet terms including that Improvenet our service professionals partners will reach out to you via automated call text at the phone number you provided this project before submitting the SR","Active Listening Skills","Did the agent sound conversational?","Did the agent use proper tone and speed?","Did the agent avoid dead air?","Was the agent polite?","Did the agent ended the call with the closure greeting?Thank you for calling improvenet" ,"Comment1","Comment2","Comment3","Comment4","Comment5","Comment6","Comment7","Comment8","Comment9","Comment10","Comment11","Comment12","Comment13","Comment14","Comment15","Comment16","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );
	   }else if($campaign=='inbound2'){
		$header = array("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Id","Call Date","Call Duration","Call Type","Audit Type ","Auditor Type ","VOC ","QA Sampling ","Order Number ","NPS","CSAT","Overall Score ","Possible Score ","Earned Score ","Auto Fail ","Sales Call Type ","Introduction ","Obtaining Customer' Needs","Questioning ","Presentation ","Closing the Sale ","CPP ","Related Parts / Parts Tray","RepairPal","Shipping Options / Shipping Details","Shipping & Billing / YMMSE / Part Name(s)","Tracking Email ","Asking / Offering for additional assistance","CSAT / NPS Survey","Rebranding ","Discount Rules","Data Gathering Compliance","Accuracy", "Documentation ", "Hold Time","Overcoming Objections","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ", "Comments 19", "Comments 20","Comments 21", "Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date" );
	   }


		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='inbound'){

			foreach($rr as $user){
				 if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				 	$interval1 = '---';
				 }else{
				 	$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				 }
				 if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['qa_sampling'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['nps'].'",';
				$row .= '"'.$user['csat'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['auto_fail'].'",';
				$row .= '"'.$user['sales_call_type'].'",';

                $row .= '"'.$user['Introduction'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['questioning'].'",';
				$row .= '"'.$user['presentation'].'",';
				$row .= '"'.$user['closing_sale'].'",';
				$row .= '"'.$user['add_cpp'].'",';
				$row .= '"'.$user['add_parts'].'",';
				$row .= '"'.$user['RepairPal'].'",';
				$row .= '"'.$user['shipping_options'].'",';
				$row .= '"'.$user['shipping_billing'].'",';
				$row .= '"'.$user['tracking_email_recap'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['NPS_survey'].'",';
				$row .= '"'.$user['rebranding_new'].'",';
				$row .= '"'.$user['discount_rules'].'",';
				$row .= '"'.$user['account_verification'].'",';
				$row .= '"'.$user['data_gathering'].'",';
				$row .= '"'.$user['account_accuracy'].'",';
				$row .= '"'.$user['documentation'].'",';
				$row .= '"'.$user['hold_time'].'",';
				$row .= '"'.$user['Overcoming_Objections'].'",';


                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';


				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		} else if($campaign=='inbound2'){

			foreach($rr as $user){
				 if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				 	$interval1 = '---';
				 }else{
				 	$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				 }
				 if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['qa_sampling'].'",';
				$row .= '"'.$user['order_no'].'",';
				$row .= '"'.$user['nps'].'",';
				$row .= '"'.$user['csat'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['auto_fail'].'",';
				$row .= '"'.$user['sales_call_type'].'",';

                $row .= '"'.$user['Introduction'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['questioning'].'",';
				$row .= '"'.$user['presentation'].'",';
				$row .= '"'.$user['closing_sale'].'",';
				$row .= '"'.$user['add_cpp'].'",';
				$row .= '"'.$user['add_parts'].'",';
				$row .= '"'.$user['RepairPal'].'",';
				$row .= '"'.$user['shipping_options'].'",';
				$row .= '"'.$user['shipping_billing'].'",';
				$row .= '"'.$user['tracking_email_recap'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['NPS_survey'].'",';
				$row .= '"'.$user['rebranding_new'].'",';
				$row .= '"'.$user['discount_rules'].'",';
				// $row .= '"'.$user['account_verification'].'",';
				$row .= '"'.$user['data_gathering'].'",';
				$row .= '"'.$user['account_accuracy'].'",';
				$row .= '"'.$user['documentation'].'",';
				$row .= '"'.$user['hold_time'].'",';
				$row .= '"'.$user['Overcoming_Objections'].'",';


                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';


				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}
	}






//////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA PuppySpot REPORT ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_puppyspot_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports/aside.php";
			$data["content_template"] = "reports_qa/qa_puppyspot_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			$campaign = $this->input->get('campaign');
			$data["qa_puppyspot_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}
				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}
                if($campaign=='puppyspot'){
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_puppyspot_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin $user) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
                 } else {
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_puppyspot_pa_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_puppyspot_pa_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_puppyspot_pa_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";
				}

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_puppyspot_list"] = $fullAray;
				$this->create_qa_puppyspot_pa_CSV($fullAray,$campaign);
				//$this->create_qa_puppyspot_pa_CSV($fullAray);
				$dn_link = base_url()."qa_puppyspot/download_qa_puppyspot_pa_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


//////////////////PuppySpot PA///////////////////
	public function download_qa_puppyspot_pa_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA PuppySpot Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_puppyspot_pa_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
        if($campaign=='puppyspot'){
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Customer ID", "Call Date", "Call ID", "Audit Type", "VOC", "Evaluation Date", "Call URL", "Earned Score", "Possible Score", "Overall Score", "Did the PC use correct greeting?", "Did the PC ask the customer for their name?","Did the PC asked if customer has already spoken to someone from PuppySpot?","Did the PC establish rapport by asking questions?","Did the PC ask the customer to visit our web site?","Did the PC ask for the puppy of choice or recommend a puppy?","Did the PC refer to the puppy by name rather than puppy?","Did the PC build excitement?","Did the PC ask a minimum of 3 discovery questions (pre-screening)?","Did the PC discover why now?","Did the PC overcome any customer objection(s)?","Did the PC create urgency (FOMO)?","Did the PC avoid long silences during the call?","Did the PC display a professional manner throughout the call?","Did the PC sound clear and confident throughout the call?","Did the PC demonstrate active listening?","Did the PC ask for the sale?","Did the PC set proper travel expectations without a guaranteed date?","Was the customer made aware we cannot guarantee the dogs adult weight?","Did the PC ask all screening questions?","Is this a closing call?","Did the PC offer/explain the value of the Pup Pack with $179  and 7 to 10 business days?","Did the PC explain our Special Offers?","Did the PC ask the customer to review the Financing T&C before signing?","Did the PC review final cost?","Did the PC complete the sales recap and next steps? (If Q55 = YES)","If no sale did the PC define the next steps? (If Q55 = NO)","Was the $495 cancellation fee explained to the customer?","Was the Health Certificate and Travel Cost Cancellation Fee discussed? (extended cancellation fee)","Was the $200 change fee discussed?","Did the PC disclose the health condition(s) of the puppy?","Did the PC summarize ALL details of the call in the Notes section?", "Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13","Remark 14","Remark 15","Remark 16","Remark 17","Remark 18","Remark 19","Remark 20","Remark 21","Remark 22","Remark 23","Remark 24","Remark 25","Remark 26","Remark 27","Remark 28","Remark 29","Remark 30","Remark 31","Remark 32", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Reason for the call", "Positives", "Opportunities", "Were there any violations during the call? If yes please explain", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
	     } else {
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Customer ID", "Call Date", "Call ID", "Phone", "Campaign", "Audit Type", "VOC", "Did the PA use correct greeting?", "Did the PA ask the customer for their name?", "Did the PA establish rapport by asking questions?", "Did the PA ask the customer to visit our website?", "Did the PA ask for the puppy of choice and/or recommend a puppy?", "Did the PA build excitement?", "Did the PA offer overcome customers objection?", "Did the PA avoid long silences during the call?", "Did the PA display a professional manner throughout the call?", "Did the PA sounded clear and confident throughout the call?", "Did the PA demonstrate active listening?", "Did the PA set an appointment? Did the PA transferred the call?", "Did the PA confirm the final cost?", "Did the PA complete the Sales recap?", "Did the PA set proper Travel expectations?", "Did the PA ask all screening questions?", "If no sale did the PA define the next steps?", "Did the PA effectively notate the contact?", "Overall Score", "Call Summary", "Opportunities", "Were there any violations in the call?If yes please explain", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
	    }


		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		 if($campaign=='puppyspot'){
		foreach($rr as $user)
		{

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['customer_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['evaluation_date'].'",';
			$row .= '"'.$user['call_url'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['earned_score'].'",';
            $row .= '"'.$user['overall_score'].'",';

			$row .= '"'.$user['use_correct_greeting'].'",';
			$row .= '"'.$user['ask_the_customer'].'",';
			$row .= '"'.$user['customer_already_spoken'].'",';
			$row .= '"'.$user['establish_rapport'].'",';
			$row .= '"'.$user['customer_visit_our_web'].'",';
			$row .= '"'.$user['ask_puppy_choice'].'",';
			$row .= '"'.$user['refer_the_puppy_name'].'",';
			$row .= '"'.$user['pc_build_excitement'].'",';
			$row .= '"'.$user['minimum_discovery_questions'].'",';
			$row .= '"'.$user['pc_discover'].'",';
			$row .= '"'.$user['pc_overcome'].'",';
			$row .= '"'.$user['pc_create_urgency'].'",';
			$row .= '"'.$user['avoid_long_silences'].'",';
			$row .= '"'.$user['pc_display_professional'].'",';
			$row .= '"'.$user['pc_sound_clear'].'",';
			$row .= '"'.$user['pc_demonstrate_active'].'",';
			$row .= '"'.$user['pc_ask_for_sale'].'",';
			$row .= '"'.$user['set_proper_travel_expectations'].'",';
			$row .= '"'.$user['the_customer_made'].'",';
			$row .= '"'.$user['all_screening_questions'].'",';
			$row .= '"'.$user['closing_call'].'",';
			$row .= '"'.$user['pc_offer_explain'].'",';
			$row .= '"'.$user['explain_special_offers'].'",';
			$row .= '"'.$user['ask_customer_review'].'",';
			$row .= '"'.$user['review_final_cost'].'",';
			$row .= '"'.$user['complete_sales_recap'].'",';
			$row .= '"'.$user['pc_define_next'].'",';
			$row .= '"'.$user['cancellation_fee_explained'].'",';
			$row .= '"'.$user['health_certificate'].'",';
			$row .= '"'.$user['change_fee_discussed'].'",';
			$row .= '"'.$user['disclose_the_health'].'",';
			$row .= '"'.$user['pc_summarize_all_details'].'",';
			$row .= '"'.$user['cmt1'].'",';
			$row .= '"'.$user['cmt2'].'",';
			$row .= '"'.$user['cmt3'].'",';
			$row .= '"'.$user['cmt4'].'",';
			$row .= '"'.$user['cmt5'].'",';
			$row .= '"'.$user['cmt6'].'",';
			$row .= '"'.$user['cmt7'].'",';
			$row .= '"'.$user['cmt8'].'",';
			$row .= '"'.$user['cmt9'].'",';
			$row .= '"'.$user['cmt10'].'",';
			$row .= '"'.$user['cmt11'].'",';
			$row .= '"'.$user['cmt12'].'",';
			$row .= '"'.$user['cmt13'].'",';
			$row .= '"'.$user['cmt14'].'",';
			$row .= '"'.$user['cmt15'].'",';
			$row .= '"'.$user['cmt16'].'",';
			$row .= '"'.$user['cmt17'].'",';
			$row .= '"'.$user['cmt18'].'",';
			$row .= '"'.$user['cmt19'].'",';
			$row .= '"'.$user['cmt20'].'",';
			$row .= '"'.$user['cmt21'].'",';
			$row .= '"'.$user['cmt22'].'",';
			$row .= '"'.$user['cmt23'].'",';
			$row .= '"'.$user['cmt24'].'",';
			$row .= '"'.$user['cmt25'].'",';
			$row .= '"'.$user['cmt26'].'",';
			$row .= '"'.$user['cmt27'].'",';
			$row .= '"'.$user['cmt28'].'",';
			$row .= '"'.$user['cmt29'].'",';
			$row .= '"'.$user['cmt30'].'",';
			$row .= '"'.$user['cmt31'].'",';
			$row .= '"'.$user['cmt32'].'",';


			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['reason_for_the_call'].'",';
			$row .= '"'.$user['positives'].'",';
			$row .= '"'.$user['opportunities'].'",';
			$row .= '"'.$user['any_violations'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		   }
		   fclose($fopen);
	     } else {
	     	foreach($rr as $user)
		     {

			if($user['correct_greeting']==2.1) $correct_greeting='N/A';
			else $correct_greeting=$user['correct_greeting'];

			if($user['customer_greeting']==3.1) $customer_greeting='N/A';
			else $customer_greeting=$user['customer_greeting'];

			if($user['rapport_greeting']==10.1) $rapport_greeting='N/A';
			else $rapport_greeting=$user['rapport_greeting'];

			if($user['website_greeting']==10.1) $website_greeting='N/A';
			else $website_greeting=$user['website_greeting'];

			if($user['puppy_greeting']==10.1) $puppy_greeting='N/A';
			else $puppy_greeting=$user['puppy_greeting'];

			if($user['excitement_sale']==3.1) $excitement_sale='N/A';
			else $excitement_sale=$user['excitement_sale'];

			if($user['objection_sale']==7.1) $objection_sale='N/A';
			else $objection_sale=$user['objection_sale'];

			if($user['silence_sale']==3.1) $silence_sale='N/A';
			else $silence_sale=$user['silence_sale'];

			if($user['professional_sale']==3.1) $professional_sale='N/A';
			else $professional_sale=$user['professional_sale'];

			if($user['sound_sale']==3.1) $sound_sale='N/A';
			else $sound_sale=$user['sound_sale'];

			if($user['listening_sale']==5.1) $listening_sale='N/A';
			else $listening_sale=$user['listening_sale'];

			if($user['transfer_closing']==10.1) $transfer_closing='N/A';
			else $transfer_closing=$user['transfer_closing'];

			if($user['cost_closing']==3.1) $cost_closing='N/A';
			else $cost_closing=$user['cost_closing'];

			if($user['sales_closing']==3.1) $sales_closing='N/A';
			else $sales_closing=$user['sales_closing'];

			if($user['travel_closing']==5.1) $travel_closing='N/A';
			else $travel_closing=$user['travel_closing'];

			if($user['screening_closing']==5.1) $screening_closing='N/A';
			else $screening_closing=$user['screening_closing'];

			if($user['step_closing']==5.1) $step_closing='N/A';
			else $step_closing=$user['step_closing'];

			if($user['contact_notation']==10.1) $contact_notation='N/A';
			else $contact_notation=$user['contact_notation'];

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['customer_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$correct_greeting.'",';
			$row .= '"'.$customer_greeting.'",';
			$row .= '"'.$rapport_greeting.'",';
			$row .= '"'.$website_greeting.'",';
			$row .= '"'.$puppy_greeting.'",';
			$row .= '"'.$excitement_sale.'",';
			$row .= '"'.$objection_sale.'",';
			$row .= '"'.$silence_sale.'",';
			$row .= '"'.$professional_sale.'",';
			$row .= '"'.$sound_sale.'",';
			$row .= '"'.$listening_sale.'",';
			$row .= '"'.$transfer_closing.'",';
			$row .= '"'.$cost_closing.'",';
			$row .= '"'.$sales_closing.'",';
			$row .= '"'.$travel_closing.'",';
			$row .= '"'.$screening_closing.'",';
			$row .= '"'.$step_closing.'",';
			$row .= '"'.$contact_notation.'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['opportunity'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['violation_explain'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';
			fwrite($fopen,$row."\r\n");
		  }
		fclose($fopen);
	  }
	}


	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA CheckPoint REPORT ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_checkpoint_report(){
		if(check_logged_in()){

			$office_id = "";
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;

			/* $office_id = $this->input->get('office_id');
			if($office_id=="")  $office_id=$user_office_id; */


			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_checkpoint_report.php";


			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";

			/* $cValue = trim($this->input->post('client_id'));
			if($cValue=="") $cValue = trim($this->input->get('client_id')); */

			$pValue = trim($this->input->post('process_id'));
			if($pValue=="") $pValue = trim($this->input->get('process_id'));

			//$data['cValue']=$cValue;
			$data['pValue']=$pValue;



			$data["qa_checkpoint_list"] = array();

			if(get_role_dir()=="super" || $is_global_access==1){
				$data['location_list'] = $this->Common_model->get_office_location_list();
			}else{
				$data['location_list'] = $this->Common_model->get_office_location_session_all($current_user);
			}


			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				//$office_id = $this->input->get('office_id');

				$field_array = array(
						"date_from"=>$date_from,
						"date_to" => $date_to,
						//"office_id" => $office_id,
						"process_id" => $pValue,
						"current_user" => $current_user
					);


				if($pValue=='Checkpoint Email'){

					$fullAray = $this->Qa_checkpoint_model->qa_checkpoint_report_model($field_array);
					$data["qa_checkpoint_list"] = $fullAray;
					$this->create_qa_checkpoint_email_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_checkpoint_Email_CSV";

				}else if($pValue=='Checkpoint Chat'){

					$fullAray = $this->Qa_checkpoint_model->qa_checkpoint_report_model($field_array);
					$data["qa_checkpoint_list"] = $fullAray;
					$this->create_qa_checkpoint_chat_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_Checkpoint_Chat_CSV";

				}else{

					$fullAray = $this->Qa_checkpoint_model->qa_checkpoint_report_model($field_array);
					$data["qa_checkpoint_list"] = $fullAray;
					$this->create_qa_checkpoint_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_Checkpoint_CSV";

				}
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			//$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


//////////////////CheckPoint///////////////////
	public function download_qa_checkpoint_email_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Checkpoint email -'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_checkpoint_email_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_checkpoint_email";
		$edit_url = "mgnt_checkpoint_email_feedback_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Customer ID", "Call Date", "Call ID", "Phone", "Campaign", "Audit Type", "VOC","Audit Link",
		"Probing Question (to assist)", "Probing Question (to tag ticket)", "Accuracy and appropriateness of information", "Does the customer have more than 2 concerns / questions?", "Did the rep review previous conversation?", "Resolution", "Offer Additional/Alternate Resolution", "Empathy and Enthusiasm (apologize when needed only)", "Simplicity and Politeness", "Grammar", "Are the thoughts and instruction on the email properly organized?", "Salutation", "Closing", "Escalation / Asked for proper assistance", "Use of Proper Tools:", "Proper Tags were used on the ticket", "Other notes", "Timeliness of response", "Status",
		"Probing Question (to assist) Remarks", "Probing Question (to tag ticket) Remarks", "Accuracy and appropriateness of information Remarks", "Does the customer have more than 2 concerns / questions? Remarks", "Did the rep review previous conversation? Remarks", "Resolution Remarks", "Offer Additional/Alternate Resolution Remarks", "Empathy and Enthusiasm (apologize when needed only) Remarks", "Simplicity and Politeness Remarks", "Grammar Remarks", "Are the thoughts and instruction on the email properly organized? Remarks", "Salutation Remarks", "Closing Remarks", "Escalation / Asked for proper assistance Remarks", "Use of Proper Tools: Remarks", "Proper Tags were used on the ticket Remarks", "Other notes Remarks", "Timeliness of response Remarks", "Status Remarks",
		"Overall Score","Custiomer Score","Business Score","Compliance Score", "Recommendations", "Feedback",
		"Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");


		foreach($rr as $user)
		{
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['customer_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';

			if($user['probing_que_assist'] == '0') $probing_que_assist = "No";
			else if($user['probing_que_assist'] == '-1') $probing_que_assist = "NA";
			else $probing_que_assist = "Yes";
			$row .= '"'.$probing_que_assist.'",';

			if($user['probing_que_ticket'] == '0') $probing_que_ticket = "No";
			else if($user['probing_que_ticket'] == '-1') $probing_que_ticket = "NA";
			else $probing_que_ticket = "Yes";
			$row .= '"'.$probing_que_ticket.'",';

			if($user['accuracy_info'] == '0') $accuracy_info = "No";
			else if($user['accuracy_info'] == '-1') $accuracy_info = "NA";
			else $accuracy_info = "Yes";
			$row .= '"'.$accuracy_info.'",';

			if($user['more_concerns'] == '0') $more_concerns = "No";
			else if($user['more_concerns'] == '-1') $more_concerns = "NA";
			else $more_concerns = "Yes";
			$row .= '"'.$more_concerns.'",';

			if($user['review_conversation'] == '0') $review_conversation = "No";
			else if($user['review_conversation'] == '-1') $review_conversation = "NA";
			else $review_conversation = "Yes";
			$row .= '"'.$review_conversation.'",';

			if($user['resolution'] == '0') $resolution = "No";
			else if($user['resolution'] == '-1') $resolution = "NA";
			else $resolution = "Yes";
			$row .= '"'.$resolution.'",';

			if($user['offer_additional'] == '0') $offer_additional = "No";
			else if($user['offer_additional'] == '-1') $offer_additional = "NA";
			else $offer_additional = "Yes";
			$row .= '"'.$offer_additional.'",';

			if($user['empathy_enthusiasm'] == '0') $empathy_enthusiasm = "No";
			else if($user['empathy_enthusiasm'] == '-1') $empathy_enthusiasm = "NA";
			else $empathy_enthusiasm = "Yes";
			$row .= '"'.$empathy_enthusiasm.'",';

			if($user['simplicity_politeness'] == '0') $simplicity_politeness = "No";
			else if($user['simplicity_politeness'] == '-1') $simplicity_politeness = "NA";
			else $simplicity_politeness = "Yes";
			$row .= '"'.$simplicity_politeness.'",';

			if($user['grammar'] == '0') $grammar = "No";
			else if($user['grammar'] == '-1') $grammar = "NA";
			else $grammar = "Yes";
			$row .= '"'.$grammar.'",';

			if($user['instruction_email'] == '0') $instruction_email = "No";
			else if($user['instruction_email'] == '-1') $instruction_email = "NA";
			else $instruction_email = "Yes";
			$row .= '"'.$instruction_email.'",';

			if($user['salutation'] == '0') $salutation = "No";
			else if($user['salutation'] == '-1') $salutation = "NA";
			else $salutation = "Yes";
			$row .= '"'.$salutation.'",';

			if($user['closing'] == '0') $closing = "No";
			else if($user['closing'] == '-1') $closing = "NA";
			else $closing = "Yes";
			$row .= '"'.$closing.'",';

			if($user['escalation'] == '0') $escalation = "No";
			else if($user['escalation'] == '-1') $escalation = "NA";
			else $escalation = "Yes";
			$row .= '"'.$escalation.'",';

			if($user['proper_tools'] == '0') $proper_tools = "No";
			else if($user['proper_tools'] == '-1') $proper_tools = "NA";
			else $proper_tools = "Yes";
			$row .= '"'.$proper_tools.'",';

			if($user['proper_tags'] == '0') $proper_tags = "No";
			else if($user['proper_tags'] == '-1') $proper_tags = "NA";
			else $proper_tags = "Yes";
			$row .= '"'.$proper_tags.'",';

			if($user['other_notes'] == '0') $other_notes = "No";
			else if($user['other_notes'] == '-1') $other_notes = "NA";
			else $other_notes = "Yes";
			$row .= '"'.$other_notes.'",';

			if($user['timeliness_response'] == '0') $timeliness_response = "No";
			else if($user['timeliness_response'] == '-1') $timeliness_response = "NA";
			else $timeliness_response = "Yes";
			$row .= '"'.$timeliness_response.'",';

			if($user['status'] == '0') $status = "No";
			else if($user['status'] == '-1') $status = "NA";
			else $status = "Yes";
			$row .= '"'.$status.'",';
			/*$row .= '"'.$user['probing_que_assist'].'",';
			$row .= '"'.$user['probing_que_ticket'].'",';
			$row .= '"'.$user['accuracy_info'].'",';
			$row .= '"'.$user['more_concerns'].'",';
			$row .= '"'.$user['review_conversation'].'",';
			$row .= '"'.$user['resolution'].'",';
			$row .= '"'.$user['offer_additional'].'",';
			$row .= '"'.$user['empathy_enthusiasm'].'",';
			$row .= '"'.$user['simplicity_politeness'].'",';
			$row .= '"'.$user['grammar'].'",';
			$row .= '"'.$user['instruction_email'].'",';
			$row .= '"'.$user['salutation'].'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'.$user['escalation'].'",';
			$row .= '"'.$user['proper_tools'].'",';
			$row .= '"'.$user['proper_tags'].'",';
			$row .= '"'.$user['other_notes'].'",';
			$row .= '"'.$user['timeliness_response'].'",';
			$row .= '"'.$user['status'].'",';*/

			$row .= '"'.$user['probing_que_assist_rmk'].'",';
			$row .= '"'.$user['probing_que_ticket_rmk'].'",';
			$row .= '"'.$user['accuracy_info_rmk'].'",';
			$row .= '"'.$user['more_concerns_rmk'].'",';
			$row .= '"'.$user['review_conversation_rmk'].'",';
			$row .= '"'.$user['resolution_rmk'].'",';
			$row .= '"'.$user['offer_additional_rmk'].'",';
			$row .= '"'.$user['empathy_enthusiasm_rmk'].'",';
			$row .= '"'.$user['simplicity_politeness_rmk'].'",';
			$row .= '"'.$user['grammar_rmk'].'",';
			$row .= '"'.$user['instruction_email_rmk'].'",';
			$row .= '"'.$user['salutation_rmk'].'",';
			$row .= '"'.$user['closing_rmk'].'",';
			$row .= '"'.$user['escalation_rmk'].'",';
			$row .= '"'.$user['proper_tools_rmk'].'",';
			$row .= '"'.$user['proper_tags_rmk'].'",';
			$row .= '"'.$user['other_notes_rmk'].'",';
			$row .= '"'.$user['timeliness_response_rmk'].'",';
			$row .= '"'.$user['status_rmk'].'",';

			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['cust_score'].'",';
			$row .= '"'.$user['busi_score'].'",';
			$row .= '"'.$user['comp_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['recommendations'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

	public function download_qa_checkpoint_chat_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Checkpoint Chat -'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_checkpoint_chat_CSV($rr)
	{
		$currentURL = base_url();
		$controller = "Qa_checkpoint";
		$edit_url = "mgnt_checkpoint_feedback_rvw";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;

		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Customer ID", "Call Date", "Call ID", "Phone", "Campaign", "Audit Type", "VOC","Audit Link",
		"Opening Spiel", "Offered Assistance", "Empathy", "Being Polite and Courteous", "PETA (Permission/ Explanation/ Time Frame/ Acknowledgment)", "Reduced Response Time (Quick/Timely Response)", "Chat Flow based on service SOPs and Protocols", "Understanding the issue", "Proper Probing", "Accuracy", "Product Service Information", "Technical Procedures", "Case Logs/Documentation", "Actions Taken (FF up email/ Escalation/ Etc.)", "Correct Grammar/ Spelling/ Punctuation and Verbiage", "Proper Use of Canned Messages", "Customer Satisfaction",
		"Opening Spiel Remarks", "Offered Assistance Remarks", "Empathy Remarks", "Being Polite and Courteous Remarks", "PETA (Permission/ Explanation Remarks/ Time Frame/ Acknowledgment) Remarks", "Reduced Response Time (Quick/Timely Response) Remarks", "Chat Flow based on service SOPs and Protocols Remarks", "Understanding the issue Remarks", "Proper Probing Remarks", "Accuracy Remarks", "Product Service Information Remarks", "Technical Procedures Remarks", "Case Logs/Documentation Remarks", "Actions Taken (FF up email/ Escalation/ Etc.) Remarks", "Correct Grammar/ Spelling/ Punctuation and Verbiage Remarks", "Proper Use of Canned Messages Remarks", "Customer Satisfaction Remarks",
		"Overall Score","Custiomer Score","Business Score","Compliance Score", "Recommendations", "Call Summary",
		"Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$main_urls = $main_url.'/'.$user['id'];
			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['customer_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['opening_spiel'].'",';
			$row .= '"'.$user['offered_assistance'].'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'.$user['being_polite'].'",';
			$row .= '"'.$user['peta'].'",';
			$row .= '"'.$user['reduced_response_time'].'",';
			$row .= '"'.$user['chat_flow'].'",';
			$row .= '"'.$user['understanding_issue'].'",';
			$row .= '"'.$user['proper_probing'].'",';
			$row .= '"'.$user['accuracy'].'",';
			$row .= '"'.$user['product_service_info'].'",';
			$row .= '"'.$user['technical_procedures'].'",';
			$row .= '"'.$user['case_logs'].'",';
			$row .= '"'.$user['actions_taken'].'",';
			$row .= '"'.$user['correct_grammar'].'",';
			$row .= '"'.$user['proper_use_msg'].'",';
			$row .= '"'.$user['cust_satisfaction'].'",';


			$row .= '"'.$user['opening_spiel_rmk'].'",';
			$row .= '"'.$user['offered_assistance_rmk'].'",';
			$row .= '"'.$user['empathy_rmk'].'",';
			$row .= '"'.$user['being_polite_rmk'].'",';
			$row .= '"'.$user['peta_rmk'].'",';
			$row .= '"'.$user['reduced_response_time_rmk'].'",';
			$row .= '"'.$user['chat_flow_rmk'].'",';
			$row .= '"'.$user['understanding_issue_rmk'].'",';
			$row .= '"'.$user['proper_probing_rmk'].'",';
			$row .= '"'.$user['accuracy_rmk'].'",';
			$row .= '"'.$user['product_service_info_rmk'].'",';
			$row .= '"'.$user['technical_procedures_rmk'].'",';
			$row .= '"'.$user['case_logs_rmk'].'",';
			$row .= '"'.$user['actions_taken_rmk'].'",';
			$row .= '"'.$user['correct_grammar_rmk'].'",';
			$row .= '"'.$user['proper_use_msg_rmk'].'",';
			$row .= '"'.$user['cust_satisfaction_rmk'].'",';

			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['cust_score'].'",';
			$row .= '"'.$user['busi_score'].'",';
			$row .= '"'.$user['comp_score'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['recommendations'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';

			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


//////////////////CheckPoint///////////////////
	public function download_qa_checkpoint_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Checkpoint Chat -'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_checkpoint_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Customer ID", "Call Date", "Call ID", "Phone", "Campaign", "Audit Type", "VOC",
		"Greetings and closing", "Identify the correct reason for chatting", "Made the customer feel important and top priority", "Grammar. Thoughts are organized. Handles the customers multiple concerns one at a time", "Does the customer have more than 1 concern?", "Dead Air / Long Periods of Silence", "Gives correct information", "Probing Questions (to Assist)", "Probing Questions (to Tag)", "Gives correct and appropriate instruction (TS)", "Documents chat on Agent Prod Tracker", "Uses the correct Tags in Zendesk", "Demonstrates correct use of system tools (client or internal) to help the customer", "Sends an email for Escalation/ Suggestion/ Feedback/ Comment/ Asking for further assistance", "Greetings and closing Remarks", "Identify the correct reason for chatting Remarks", "Made the customer feel important and top priority Remarks", "Grammar. Thoughts are organized. Handles the customers multiple concerns one at a time Remarks", "Does the customer have more than 1 concern? Remarks", "Dead Air / Long Periods of Silence Remarks", "Gives correct information Remarks", "Probing Questions (to Assist) Remarks", "Probing Questions (to Tag) Remarks", "Gives correct and appropriate instruction (TS) Remarks", "Documents chat on Agent Prod Tracker Remarks", "Uses the correct Tags in Zendesk Remarks", "Demonstrates correct use of system tools (client or internal) to help the customer Remarks", "Sends an email for Escalation/ Suggestion/ Feedback/ Comment/ Asking for further assistance Remarks",
		"Overall Score", "Custiomer Score","Business Score","Compliance Score", "Call Summary", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['customer_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';

			$row .= '"'.$user['greetings_closing'].'",';
			$row .= '"'.$user['identify_reason_chatting'].'",';
			$row .= '"'.$user['made_customer_feel'].'",';
			$row .= '"'.$user['customers_multiple_concerns'].'",';
			if($user['customer_more_concern'] == '1.1')
				$row .= '"N/A",';
			else
				$row .= '"'.$user['customer_more_concern'].'",';
			$row .= '"'.$user['dead_air'].'",';
			$row .= '"'.$user['correct_information'].'",';
			$row .= '"'.$user['probing_assist'].'",';
			$row .= '"'.$user['probing_tag'].'",';
			$row .= '"'.$user['appropriate_instruction'].'",';
			$row .= '"'.$user['documents_chat'].'",';
			$row .= '"'.$user['tags_zendesk'].'",';
			$row .= '"'.$user['help_customer'].'",';
			$row .= '"'.$user['further_assistance'].'",';

			$row .= '"'.$user['greetings_closing_rmk'].'",';
			$row .= '"'.$user['identify_reason_chatting_rmk'].'",';
			$row .= '"'.$user['made_customer_feel_rmk'].'",';
			$row .= '"'.$user['customers_multiple_concerns_rmk'].'",';
			$row .= '"'.$user['customer_more_concern_rmk'].'",';
			$row .= '"'.$user['dead_air_rmk'].'",';
			$row .= '"'.$user['correct_information_rmk'].'",';
			$row .= '"'.$user['probing_assist_rmk'].'",';
			$row .= '"'.$user['probing_tag_rmk'].'",';
			$row .= '"'.$user['appropriate_instruction_rmk'].'",';
			$row .= '"'.$user['documents_chat_rmk'].'",';
			$row .= '"'.$user['tags_zendesk_rmk'].'",';
			$row .= '"'.$user['help_customer_rmk'].'",';
			$row .= '"'.$user['further_assistance_rmk'].'",';

			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['cust_score'].'",';
			$row .= '"'.$user['busi_score'].'",';
			$row .= '"'.$user['comp_score'].'",';
			//$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			//$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['violation_explain'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';

			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


		public function qa_araca_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_araca_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_araca_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_araca_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_araca_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_araca_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_araca_list"] = $fullAray;
				$this->create_qa_araca_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_araca_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_araca_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA araca Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_araca_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date", "Call Duration", "UCID/REC ID(Uptivity/OC Tool)", "Campaign", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Identifying Himself/Herself", "Verify account information", "Communicates", "Active Listening Skills", "Professionalism", "Call Control/Hold Techniques", "Answers questions accurately", "Reason for the call", "Effective Value Building", "Effective Single Call Resolution Attempt", "Product Terms & Conditions Disclosed", "Closed Call Properly", "Overall Score", "QA Comment", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['uc_id'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['identifying'].'",';
			$row .= '"'.$user['accinfo'].'",';
			$row .= '"'.$user['communicate'].'",';
			$row .= '"'.$user['listeningskill'].'",';
			$row .= '"'.$user['professional'].'",';
			$row .= '"'.$user['callcontrol'].'",';
			$row .= '"'.$user['answerquestion'].'",';
			$row .= '"'.$user['reasoncall'].'",';
			$row .= '"'.$user['valuebuilding'].'",';
			$row .= '"'.$user['callresolution'].'",';
			$row .= '"'.$user['termcondition'].'",';
			$row .= '"'.$user['closecall'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['qa_comment'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


///////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////// AMERIDIAL ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////

	public function qa_ameridial_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_ameridial_report.php";
			$audit_type = $this->input->get('audit_type');
			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$process_id="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$cond2="";
			$cmp1='';

			 $process_id = $this->input->get('p_id');

			if($process_id=='fortunebuilder'){
				$process_id="fortunebuilder";
			}else if($process_id=='hoveround'){
				$process_id="hoveround";
			}else if($process_id=='ncpssm'){
				$process_id="ncpssm";
			}else if($process_id=='stc'){
				$process_id="stc";
			}else if($process_id=='touchfuse'){
				$process_id="touchfuse";
			}else if($process_id=='touchfuse_new'){
				$process_id="touchfuse_new";
			}else if($process_id=='tbn'){
				$process_id="tbn";
			}else if($process_id=='275'){
				$process_id="purity_free_bottle";
			}else if($process_id=='280'){
				$process_id="purity_catalog";
			}else if($process_id=='273'){
				$process_id="puritycare_new";
			}else if($process_id=='261'){
				$process_id="conduent";
			}else if($process_id=='jfmi'){
				$process_id="jfmi";
			}else if($process_id=='tpm'){
				$process_id="tpm";
			}else if($process_id=='patchology'){
				$process_id="patchology";
			}else if($process_id=='heatsurge'){
				$process_id="heatsurge";
			}else if($process_id=='aspca'){
				$process_id="aspca";
			}else if($process_id=='lifi'){
				$process_id="lifi";
			}else if($process_id=='stauers_sales'){
				$process_id="stauers_sales";
			}else if($process_id=='operation_smile'){
				$process_id="operation_smile";
			}else if($process_id=='5_11_tactical'){
				$process_id="5_11_tactical";
			}else if($process_id=='jmmi'){
				$process_id="jmmi";
			}else if($process_id=='non_profit'){
				$process_id="non_profit";
			}else if($process_id=='revel'){
				$process_id="revel";
			}else if($process_id=='303'){
				$process_id="revel_new";
			}
			else if($process_id=='icario'){
				$process_id="icario";
			}
			else if($process_id=='ica_latest'){
				$process_id="ica_latest";
			}
			else if($process_id=='ica'){
				$process_id="ica";
			}
			else if($process_id=='272'){
				$process_id="qpc";
			}else if($process_id=='ancient_nutrition'){
				$process_id="ancient_nutrition";
			}else if($process_id=='powerfan'){
				$process_id="powerfan";
			}else if($process_id=='sabal'){
				$process_id="sabal";
			}else if($process_id=='302'){
				$process_id="curative";
			}else if($process_id=='episource'){
				$process_id="episource";
			}else if($process_id=='blains'){
				$process_id="blains";
			}
			else if($process_id=='413'){
				$process_id="pajamagram";
			}
			else if($process_id=='377.1'){
				$process_id="brightway_prescreen";
			}else if($process_id=='377.2'){
				$process_id="brightway_prescreen_new";
			}else if($process_id=='377.4'){
				$process_id="brightway_evaluation_new";
			}else if($process_id=='377.3'){
				$process_id="brightway_evaluation";
			}else if($process_id=='377.5'){
				$process_id='brightway_ib_bank';
			}else if($process_id=='offline'){
				$process_id='offline';
			}else if($process_id=='phone_inbound'){
				$process_id='phone_inbound';
			}else if($process_id=='phone_inbound_new'){
				$process_id='phone_inbound_new';
			}else if($process_id=='processing'){
				$process_id='processing';
			}else if($process_id=='processing_new'){
				$process_id='processing_new';
			}else if($process_id=='262'){
				$process_id="delta";
			}else if($process_id=='delta_iowa'){
				$process_id="delta_iowa";
			}else if($process_id=='443'){
				$process_id="trapollo";
			}else if($process_id=='465'){
				$process_id="sontiq";
			}else if($process_id=='airmethod'){
				$process_id="airmethod";
			}else if($process_id=='airmethod_email'){
				$process_id="airmethod_email";
			}else if($process_id=='affinity'){
				$process_id="affinity";
			}else if($process_id=='affinity_pro'){
				$process_id="affinity_pro";
			}else if($process_id=='cci_medicare'){
				$process_id="cci_medicare";
			}else if($process_id=='cci_commercial'){
				$process_id="cci_commercial";
			}else if($process_id=='lockheed'){
				$process_id="lockheed";
			}else if($process_id=='foodsaver'){
				$process_id="foodsaver";
			}else if($process_id=='ubp'){
				$process_id="ubp";
			}else if($process_id=='471'){
				$process_id="sas";
			}else if($process_id=='473'){
				$process_id="gap";
			}else if($process_id=='488'){
				$process_id="sfe";
			}else if($process_id=='qpc_esal'){
				$process_id='qpc_esal';
			}else if($process_id=='mpc'){
				$process_id='mpc';
			}else if($pid=='ab_commercial'){
  			$pname='AB Commercial Offline';
			}else if($process_id=='754'){
				$process_id='homeward_health';
			}else if($process_id=='756'){
				$process_id='kenny_u_pull';
			}else if($process_id=='755'){
				$process_id='ways2well';
			}

			$data["qa_ameridial_list"] = array();

			if($process_id!=""){

				if($this->input->get('show')=='Show')
				{
					$from_date = mmddyy2mysql($this->input->get('from_date'));
					$to_date = mmddyy2mysql($this->input->get('to_date'));
					$office_id = $this->input->get('office_id');
					$office_id='All';
					$lob = $this->input->get('lob');


					if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if($audit_type=="All"){
						if(get_login_type()=="client"){
							$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
						}else{
							$cond .= "";
						}
					}else{
						$cond .=" and audit_type='$audit_type'";
					}

					
					if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
						$ops_cond="";
					}else{
						if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
							$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
						}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
							$ops_cond=" Where assigned_to='$current_user'";
						}else{
							$ops_cond="";
						}
					}

					if($process_id=='pcare_cs'){
						$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_purity_consciuos_selling_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					}else if($process_id == 'homeward_health'){
							$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_".$process_id."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					}else if($process_id == 'kenny_u_pull'){
							$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_".$process_id."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					}
					else{
						$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_amd_".$process_id."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
					}

					$fullAray = $this->Common_model->get_query_result_array($qSql);

					$data["qa_ameridial_list"] = $fullAray;

					if(!in_array($process_id,array('episource','magnilife','blains','pajamagram','delta','brightway_prescreen','brightway_evaluation','trapollo','ubp','sontiq'))){

						$this->create_qa_ameridial_CSV($fullAray,$process_id);


					}else if(in_array($process_id,array('homeward_health'))){
						$this->create_qa_ameridial_CSV($fullAray,$process_id);
					}else if(in_array($process_id,array('kenny_u_pull'))){
						$this->create_qa_ameridial_CSV($fullAray,$process_id);
					}
					else{

						$header=$process_id."Header";
						$header=$this->$header();

						$this->create_qa_amd_common_new_CSV($header,$fullAray,$process_id);

					}

					$dn_link = base_url()."reports_qa/download_qa_ameridial_CSV/".$process_id;


				}

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['from_date'] = $from_date;
			$data['to_date'] = $to_date;
			$data['office_id']=$office_id;
			$data['process_id']=$process_id;
			$data['audit_type']=$audit_type;
			//$data['lob']=$lob;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_ameridial_CSV($pid)
	{
		if($pid=='fortunebuilder'){
			$pname='Fortune Biulder';
		}else if($pid=='hoveround'){
			$pname='Hoveround';
		}else if($pid=='ncpssm'){
			$pname='NCPSSM';
		}else if($pid=='stc'){
			$pname='STC Scoresheet';
		}else if($pid=='touchfuse'){
			$pname='TouchFuse';
		}else if($pid=='touchfuse_new'){
			$pname='TouchFuse_new';
		}else if($pid=='tbn'){
			$pname='TBN Scoresheet';
		}else if($pid=='purity_free_bottle'){
			$pname='Purity Free Bottle';
		}else if($pid=='purity_catalog'){
			$pname='Purity Catalog';
		}else if($pid=='purity_care'){
			$pname='Purity Care';
		}else if($pid=='puritycare_new'){
			$pname='Purity Care New';
		}else if($pid=='conduent'){
			$pname='Conduent';
		}else if($pid=='jfmi'){
			$pname='JFMI';
		}else if($pid=='tpm'){
			$pname='TPM Scoresheet';
		}else if($pid=='patchology'){
			$pname='Patchology Agent Improvement';
		}else if($pid=='aspca'){
			$pname='ASPCA Scoresheet';
		}else if($pid=='ffai'){
			$pname='FilterFast Agent Improvement Scoresheet';
		}else if($pid=='lifi'){
			$pname='LIFI Improvement Scoresheet';
		}else if($pid=='heatsurge'){
			$pname='Heat Surge';
		}else if($pid=='stauers_sales'){
			$pname='Stauers Sales';
		}else if($pid=='operation_smile'){
			$pname='Operation Smile';
		}else if($pid=='5_11_tactical'){
			$pname='5-11 Tactical';
		}else if($pid=='jmmi'){
			$pname='JMMI';
		}else if($pid=='non_profit'){
			$pname='Non-Profit';
		}else if($pid=='revel_new'){
			$pname='Icario';
		}
		else if($pid=='icario'){
			$pname='Icario New';
		}
		else if($pid=='ica'){
			$pname='Icario New';
		}
		else if($pid=='qpc'){
			$pname='QPC';
		}else if($pid=='ancient_nutrition'){
			$pname='Ancient Nutrition';
		}else if($pid=='powerfan'){
			$pname='Power Fan';
		}else if($pid=='nuwave'){
			$pname='NuWave';
		}else if($pid=='sabal'){
			$pname='SABAL';
		}else if($pid=='curative'){
			$pname='CURATIVE';
		}else if($pid=='episource'){
			$pname='EPISOURCE';
		}else if($pid=='magnilife'){
			$pname='MAGNILIFE';
		}else if($pid=='blains'){
			$pname='BLAINS';
		}
		else if($pid=='pajamagram'){
			$pname='PAJAMAGRAM';
		}
		else if($pid=='delta'){
			$pname='DELTA DENTAL [ILLINOIS]';
		}else if($pid=='delta_iowa'){
			$pname='DELTA DENTAL [IOWA]';
		}else if($pid=='brightway_prescreen'){
			$pname='Brightway Prescreen(Old)';
		}else if($pid=='brightway_prescreen_new'){
			$pname='Brightway Prescreen';
		}else if($pid=='brightway_evaluation'){
			$pname='Brightway Evaluation(Old)';
		}else if($pid=='brightway_evaluation_new'){
			$pname='Brightway Evaluation';
		}else if($pid=='brightway_ib_bank'){
			$pname='IB BANKS AND CANCELLATION';
		}else if($pid=='offline'){
			$pname='Offline Qa';
		}else if($pid=='phone_inbound'){
			$pname='Phone Inbound Qa';
		}else if($pid=='phone_inbound_new'){
			$pname='Phone Inbound Qa New';
		}else if($pid=='processing'){
			$pname='Processing Qa';
		}else if($process_id=='processing_new'){
				$process_id='processing Qa New';
		}else if($pid=='trapollo'){
			$pname='TRAPOLLO';
		}else if($pid=='airmethod'){
			$pname='Air Method';
		}else if($pid=='airmethod_email'){
			$pname='Air Method';
		}else if($pid=='foodsaver'){
			$pname='Food Saver';
		}else if($pid=='ubp'){
			$pname='UBP';
		}else if($pid=='sontiq'){
			$pname='SONTIQ';
		}else if($pid=='sas'){
			$pname='SAS';
		}else if($pid=='gap'){
			$pname='GAP';
		}else if($pid=='suarez'){
			$pname='Suarez';
		}else if($pid=='sfe'){
			$pname='SFE';
		}else if($pid=='qpc_esal'){
			$pname='QPC ESAL';
		}else if($pid=='pcare_cs'){
			$pname='Purity [Conscious Selling]';
		}else if($pid=='mpc'){
			$pname='Maryland Physicians Care';
		}else if($pid=='ab_commercial'){
			$pname='AB Commercial Offline';
		}else if($pid=="empire"){
		  $pname="Empire";
		}else if($pid=="hcpss"){
		  $pname="HCPSS";
		}else if($pid=="cmn"){
		  $pname="CMN";
		}else if($pid=="pilgrim"){
		  $pname="Pilgrim";
		}else if($pid=="bluebenefits"){
		  $pname="Blue Benefits";
		}else if($pid=="healthbridge"){
		  $pname="Health Bridge";
		}else if($pid=="healthbridgenew"){
			$pname="Health Bridge New";
		}else if($pid=="compliance"){
		  $pname="Compliance";
		}else if($pid=="mcKinsey"){
		  $pname="mcKinsey";
		}else if($pid=="affinity"){
		  $pname="affinity";
		}else if($pid=="affinity_pro"){
		  $pname="affinity_pro";
		}else if($pid=="cci_medicare"){
		  $pname="cci_medicare";
		}else if($pid=="cci_commercial"){
		  $pname="cci_commercial";
		}else if($pid=="lockheed"){
		  $pname="lockheed";
		}else if($pid=="754"){
		  $pname="Homeward Health";
		}else if($pid=="756"){
		  $pname="Kenny U Pull";
		}else if($pid=="ica_latest"){
		  $pname="Icario Latest";
		}else if($pid=="ways2well"){
		  $pname="Ways-2-Well";
		}



		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Ameridial ".$pname." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

//////////// qa_amd_report_header///////////////////////////////////

	function episourceHeader(){

		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Call Reference","Call Status","System","Site","Call Duration","File No.","Audit Type","Auditor Type","VOC", "Overall Score","Did the agent provide the appropriate introduction? ","Did the agent provide a clear reason for the call?","Did the agent accurately respond to the members questions?","Did the agent allow the member to speak uninterrupted?","Did the agent avoid long periods of silence?","Did the agent ask to schedule the visit.","Did the agent verify the member?","Did the agent include all relevant details for the appointment?","Did the agent verify the full address?","Did the agent advise member to take note of all confirmation details?","Did the agent accurately document notes to NP?","Did the agent provide two response?","Did the agent advise of a reminder call?","Did the agent provide a fitting  closing for each call?","Did the agent status and document Salesforce correctly?","Did the agent advise the member he/she was on a recorded line?","Did the agent follow verification requirements for the script?","Did the agent maintain security of PHI and abide by HIPAA requirements?","Did the agent Inappropriately release the call prior ot providing an approptiate closing?","Did the agent perform any unauthorized action on a member profile","Did the agent knowingly providing false information?","Did the agent place blame?","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");

	}

	///////////////////////Magnilife/////////////////////////////////////

	// function magnilifeHeader(){
	// 	return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","File No","Call Date","Call Duration","Audit Type","Auditor Type","VOC", "disposition","Overall Score","Possible Score","Earned Score","Greeting (Agent complied with greeting mentioned Brand and call reason )","Enthusiasm (Agent sounds with enthusiasm good energy when speaking)","Clarity (Agent demonstrate a good level of grammar pronunciation pace and confidence at the time of speaking)","Professionalism (listening skills phone etiquette maintain call control and ethics agent's ethics)","Product knowledge (Agent answers product questions sounds as a product expert)","Accuracy (Agent provides accurate product information to the customer avoid providing false expectation/information to the customer)","Efficiency (Agent works effectively during the call to complete the purpose of the call )","System Knowledge (Agent demonstrates program knowledge)","Offer Information (Agents read offer information to the customer including price and features with good and clear pace)","Purchase confirmation (Agent confirms purchase information including prices provides confirmation number to the customer)","Call Summary","Feedback","Entry By","Entry Date","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date" );
	// }

	///////////////////////Blains/////////////////////////////////////

	function blainsHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","Filler 2","Area Code","Site","Call Duration","File No","Audit Type","Auditor Type","VOC", "Possible Score","Earned Score","Overall Score","Customer Score","Business Score","Compliance Score","Call opening with Brand Name (5 secs)","Personalize the call (Address the customer by their name at least once during the call)","Verified the customer's name address email and phone number","Correct use of Flagging & Notating","Transfer to store if required","Did the agent follow training docs along with ACP and Blains Website","Integrity Accountability Teamwork and Results","Demonstrates an attitude with every customer encounter through words and actions to show the customer respect and recgnition","Did the agent avoid dead air did the agent avoid unnecessary hold?","Tone Over talking and pacing","Active Listening to the words a customer is speaking and understanding the request and avoid the customer repeating him/herself.","Empathized with customer","Offering more items to the customer when an order is placed or signing up for newsletter when the time is right","Did the agent close the call properly (with Branding Blains Farms and Fleet)","Did the agent dispose the call properly?","Rude remarks ","Call Avoidance",
			"Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Call Summary","Feedback","Entry By","Entry Date","Audit Start Time","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	function brightway_evaluation_newHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","File No. ","Filler","Campaign Code","Area Code","Call Duration ","Audit Type ","Auditor Type ","VOC ", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score ","Earned Score ","Overall Score ","1.1 Did the CSR use the appropriate greeting including Brightway branding their own name and ask how he/she can assist?","1.2 Did the CSR confirm and capture all necessary information? (name of caller name of insured policy # coverage location & callback #)","1.3 If outbound did the CSP advise they were on a recorded line?","2.1 Was the CSR professional and use appropriate tone and pace on the call?","2.2 Did the CSR demonstrate emapthy or sympathy as needed?","2.3 Did the CSR actively listen to understand the needs of the customer?","2.4 Did the CSR use probing questions and verbally verify the information obtained and processed?","2.5 Did the CSR follow appropriate hold procedure?","2.6 Did the CSR maintain call control and avoid dead air?","2.7  Did the CSR provide accurate information both verbally and in writing?","3.1  If call was transferred was correct transfer process used?","3.2  Did the CSR attempt a callback if the call was disconnected?","3.3  Did the CSR connect activities to the current/correct policy?","3.4 Did the CSR document correctly in all areas (notes activities templates etc.)","3.5 Did CSR include all attachments including emails fax confirmation documents sent etc.","3.6 Did the CSR successfully resolve all issues and concerns? (If not did the CSR correctly document status?)","3.7 Did the CSR access and effectively utilize all available systems/resources?","3.8  If a renewal payment was processed and there is an open renewal suspense was the suspense updated and closed?","3.9 Did the agent experience any audio issues? (For Tracking Purposes Only)","4.1 Did CSR offer additional assistance and thank the customer?","4.2 Did the CSR offer additional assistance before concluding the call?","5.1 Was the customer adversely impacted in any way?","5.2 Were there any additional adverse impacts?","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	function brightway_evaluationHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","Audit Type","Auditor Type ","VOC ","Enter Policy Information ","Skill - Select all the Apply ","File No. ", "Overall Score ","Possible Score ","Earned Score ","Did the CSR use the approved greeting ","Did rep advise they were on a recorded line ","Did the associate use the appropriate tone pace and professionalism while avoidinginsurance jargon? ","Did the associate demonstrate the right level of empathy or sympathy? ","Did the associate listen carefully to understand and address the customers needs askingprobing questions and verbally verify the information obtained and processed? ","Did the CSR follow the appropriate hold procedure and provide a wrap-up summary ","The associate maintained call control throughout the call by guiding the conversation ","All verbal and written information provided by associate to insured and other parties wasclear ","If call was transferred was the appropriate transfer process followed? ","Did the CSR attempt to contact the callerback to complete the call? ","Worked correct policy. ","Created all activities corresponding with the interaction with clear ","Were the correct interaction templates used? ","Attached all emails fax confirmations and other documents as needed ","Was the issue or request resolved/completed? ","Effectively accessed and utilized all appropriate systems and resources to obtaininformation ","If a renewal payment was processed and there is an open renewal suspense was thesuspense updated and closed? ","Did the associate offer additional assistance thanked the customer? ","Was the customer adversely impacted? ","Were there any additional adverse impacts? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	function brightway_prescreenHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","Filler 2","Area Code","Site ","Call Duration ","File No. ","Audit Type ","Auditor Type ","VOC ", "Possible Score ","Earned Score ","Overall Score ","Transfer to ","Did the associate use the appropriate greeting? ","Was the Pre-Screen template completed correctly? ","Did the associate disposition the call correctly? ","Did the associate use the appropriate verbiage tone pace and professionalism? ","Did the associate transfer to the correct skill based on the decision flow diagram? ","Was the caller appropriately authenticated? ","If verified and change needed was AMS updated? ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	function brightway_prescreen_newHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","File No. ","Filler","Campaign Code","Area Code","Call Duration ","Audit Type ","Auditor Type ","VOC ", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score ","Earned Score ","Overall Score ","Transfer to ","Did the CSR Transfer to:","1.1 Did the CSR use the appropriate greeting? ","1.2 Was the Pre-Screen template completed correctly?","1.3 Did the CSR disposition the call correctly?","1.4 Did the agent use appropriate soft skills no overtalk and demonstrated professionalism?","1.5 Did the CSR use the proper hold procedure?","1.6  Did the CSR transfer to the correct skill based on the decision flow diagram?","1.7  Was the caller appropriately authenticated?","1.8  Did the CSR experience any audio issues? (For Tracking Puposes Only)","1.9  If verified and change necessary was AMS updated correctly?" ,"Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent Feedback Acceptance","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	function pajamagramHeader(){
		return Array ("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","Call Duration","File No","Audit Type","Auditor Type","VOC","Campaign", "Possible Score","Earned Score","Overall Score","Compliance Score","Customer Score","Business Score","Agent is ready and logged in to website to handle call","Greet caller and Thank them for calling Pajamagram or Vermont Teddy Bear","Ask caller what can we order for them today","Verify all  caller and product information","Assist search if caller doesnt know specific item","Offer personalization if available","Offer Upsell","Ask for additional items","Confirm email and phone number","Offer Delivery Option","Energy/enthusiasm","Proper pace","Maintained control of the conversation/Minimal Dead Air","Spoke clearly/utilized proper grammar (NO SLANG)","Good listening skills/Does not interrupt","Empathized with caller","Overall professionalism","Ask for Priority code if caller has catalog","Enter advertising source from CRM screen or ask caller for it","Summarize the order","Close call with order confirmaiton and Thank caller for their order","Did the agent correctly disposition the call?","False/inappropriate information","Hung up inappropriately","Unprofessional or rude behavior","Inappropriate language","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25","Comments 26","Call Summary","Feedback","Entry By","Entry Date","Audit Start Time","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	public function deltaHeader(){

		return $arrayName = Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","Audit Type","Auditor Type","VOC","File No.", "Overall Score","Possible Score","Earned Score","Did CER appropriately greet the caller?","Did CER use a pleasant respectful tone and use the caller's name at least once during the call?","Did CER answer in a timely manner?","Did CER obtain 3 pieces of PHI?","Did CER obtain member's information first and then provider's if on provider call?","If Non-Covered Parent did the caller answer yes to all 3 questions on Guidelines tab?","Did CER ask appropriate questions to determine the purpose of the call?","Did CER assess all information before responding to the caller? (BVN)","Did CER pose appropriate questions to clarify the caller's issue? (Restate Issue)","Did CER utilize active listening skills throughout the inquiry?","Did CER demonstrate use of call control techniques?","Did CER refrain from interrupting the caller?","Did CER use proper etiquitte Please and Thank you after caller provided CER with requested info?","Did CER avoid use of internal terms technical terms slang and jargon?/speak clearly and concisely at an appropriate pace?","Did CER demonstrate confidence in responses?","Did CER minimize silences and use fillers to obtain additional information?","Did CER provide accurate information and/or demonstrate knowledge of client's benefit programs?","Did CER take correct action to resolve the caller's issues?","Did CER promote self-service options where appropriate?","Did CER answer questions clearly and completely?","Was CER proactive by anticipating additional needs of the caller?","Did CER accurately and completely document the call's outcome?","Did the CER document the callers phone number name call type CITS code etc?","Did CER close CITS if it did not require a follow up?","Did CER confirm resolution of the caller's question?","Did CER ask if any additional information could be provided?","Did CER thank the individual for calling and release the call within 5 seconds","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Comments 25","Comments 26","Comments 27","Call Summary","Feedback","Entry By","Entry Date","Audit Start Time","Client entry by","Mgnt review by","Mgnt review note","Mgnt review date","Agent Feedback Acceptance","Agent review note","Agent review date","Client review by","Client review note","Client_rvw_date");
	}

	////////////////////support function for Report///////////////////////

	public function getval1($arrs, $k) {
    foreach($arrs as $key=>$val) {
        if( $key === $k ) {
            return $val;
        }
        else {
            if(is_array($val)) {
                $ret = $this->getval1($val, $k);
                if($ret !== NULL) {
                    return $ret;
                }
            }
        }
    }
    return NULL;
	}


	// function abc(){

	// 	echo "work please";

	// 	// $this->db->query("create table xyz1 as SELECT phno as phone1,concat(fname,' ',lname) as name,email_id as email FROM `signin` WHERE 1");


	// 	$field_name=$this->Common_model->get_query_result_array("SELECT phno as phone1,concat(fname,' ',lname) as name,email_id as email FROM `signin` WHERE 1");
	// 	// print_r($field_name);
	// 	$this->create_qa_ameridial_CSV($field_name,"xyz");
	// 	$dn_link = base_url()."qa_ameridial/download_qa_ameridial_CSV/"."Full User Details";



	// }

	////////////////Dynamic function for automatic report generation//////////////

	public function create_qa_amd_common_new_CSV($header,$rr,$pid)
	{

		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$field_name="SHOW FULL COLUMNS FROM qa_amd_".$pid."_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		//print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}

	public function create_qa_paynearby_common_new_CSV($header,$rr,$pid)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$field_name="SHOW FULL COLUMNS FROM qa_paynearby_".$pid."_feedback WHERE Comment!=''";
		$field_name=$this->Common_model->get_query_result_array($field_name);
		$fld_cnt=count($field_name);
		for($i=0;$i<$fld_cnt;$i++){
						$val=$field_name[$i]['Field'];
						if($val!=""){
							$field_val[]=$val;
						}
					 }

		array_unshift($field_val ,"auditor_name");
		$key = array_search ('agent_id', $field_val);
		array_splice($field_val, $key, 0, 'fusion_id');
		$field_val=array_values($field_val);

		$count_for_field=count($field_val);

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		$row = "";
		// print_r($rr);
		// die;
		foreach($rr as $user)
		{
			for($z=0;$z<$count_for_field;$z++){

				if($field_val[$z]==="auditor_name"){
					$row = '"'.$user['auditor_name'].'",';
				}elseif($field_val[$z]==="fusion_id"){
					$row .= '"'.$user['fusion_id'].'",';
				}elseif($field_val[$z]==="agent_id"){
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
				}elseif($field_val[$z]==="tl_id"){
					$row .= '"'.$user['tl_name'].'",';
				}elseif(in_array($field_val[$z], array('call_summary','feedback','agent_rvw_note','mgnt_rvw_note'))) {

    			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user[$field_val[$z]])).'",';

				}else{
					$row .= '"'.$user[$field_val[$z]].'",';
				}

			}

				fwrite($fopen,$row."\r\n");
				$row = "";
		}

		fclose($fopen);
	}

	public function closeloopHeader(){
		return Array ("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Campaign","Incoming_No","Register_No ","Call_Link ","Ticket_No ","Call_Disconnect ","Tagging_Disposition ","Query_Service ","Type_Call ","Audit Type ","Auditor Type ","VOC ","Overall Score ","Possible Score ","Earned Score ","Opening With Greeting (Incl Late Opening/Name Confirmation) ","Did Agent Understood The Query & Necessary Probing Done ","Followed Proper Telephone Etiquettes (Mute Hold Transfer) ","Good In Listening/Repetition Not Happened Due To Lack In Listening Skills/Attentive ","Was ticket closed with in TAT by BO Team ","Did The Agent Was Polite On Call/Not Done Arguments/Professional ","Did The Agent Have Patience ","Correct and complete resolution provided on call ","Tagging and Dispositions ","Feedback on PNB service ","BO Provide correct Resolution or not ","Was customer proper SR raised or not ","Proper Empathy Done Whenever Required ","Did The Agent Maintained Proper Pace/Tone Modulation/Clarity In Speech ","Was Correct Tagging Done/Raised Proper Ticket when ever required ","Effective Rebuttals On Objection Handling/Convincing Skills ","Was Exact Tat Informed by agent ","Did The Agent Followed Proper Call Closing Script As Per Process ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Call Summary ","Feedback ","Entry By ","Entry Date ","Audit Start Time ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent Feedback Acceptance ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
	}

	public function create_qa_ameridial_CSV($rr,$pid)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($pid=='brightway_prescreen_new'){
			$header = array("Auditor Name22","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","File No. ","Filler","Campaign Code","Area Code","Call Duration ","Audit Type ","Auditor Type ","VOC ", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score ","Earned Score ","Overall Score ","1.1 Did the CSR use the appropriate greeting? ","1.2 Was the Pre-Screen template completed correctly?","1.3 Did the CSR disposition the call correctly?","1.4 Did the agent use appropriate soft skills no overtalk and demonstrated professionalism?","1.5 Did the CSR use the proper hold procedure?","1.6  Did the CSR transfer to the correct skill based on the decision flow diagram?","1.7  Was the caller appropriately authenticated?","1.8  Did the CSR experience any audio issues? (For Tracking Puposes Only)","1.9  If verified and change necessary was AMS updated correctly?" ,"Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9","Call Summary ","Feedback ","Agent Feedback Acceptance","Agent review date ","Agent review note ","Mgnt review date ","Management Review By","Mgnt review note");
	        } else if($pid=='brightway_evaluation_new'){
			$header = array("Auditor Name","Audit Date","Call Date","Fusion Id","Agent","L1 Super","Phone","File No. ","Filler","Campaign Code","Area Code","Call Duration ","Audit Type ","Auditor Type ","VOC ", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score ","Earned Score ","Overall Score ","1.1 Did the CSR use the appropriate greeting including Brightway branding their own name and ask how he/she can assist?","1.2 Did the CSR confirm and capture all necessary information? (name of caller name of insured policy # coverage location & callback #)","1.3 If outbound did the CSP advise they were on a recorded line?","2.1 Was the CSR professional and use appropriate tone and pace on the call?","2.2 Did the CSR demonstrate emapthy or sympathy as needed?","2.3 Did the CSR actively listen to understand the needs of the customer?","2.4 Did the CSR use probing questions and verbally verify the information obtained and processed?","2.5 Did the CSR follow appropriate hold procedure?","2.6 Did the CSR maintain call control and avoid dead air?","2.7  Did the CSR provide accurate information both verbally and in writing?","3.1  If call was transferred was correct transfer process used?","3.2  Did the CSR attempt a callback if the call was disconnected?","3.3  Did the CSR connect activities to the current/correct policy?","3.4 Did the CSR document correctly in all areas (notes activities templates etc.)","3.5 Did CSR include all attachments including emails fax confirmation documents sent etc.","3.6 Did the CSR successfully resolve all issues and concerns? (If not did the CSR correctly document status?)","3.7 Did the CSR access and effectively utilize all available systems/resources?","3.8  If a renewal payment was processed and there is an open renewal suspense was the suspense updated and closed?","3.9 Did the agent experience any audio issues? (For Tracking Purposes Only)","4.1 Did CSR offer additional assistance and thank the customer?","4.2 Did the CSR offer additional assistance before concluding the call?","5.1 Was the customer adversely impacted in any way?","5.2 Were there any additional adverse impacts?","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Comments 22 ","Comments 23 ","Call Summary ","Feedback ","Agent Feedback Acceptance","Agent review note ","Mgnt review date ","Mgnt review name","Mgnt review note");
	    }
	    else if ($pid=='fortunebuilder'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the call answered within 5 seconds?", "Did the agent introduce him/herself to the caller?", "Did the agent advise the call is being recorded?", "Did the agent use the standard greeting?", "Did the agent ask for the zip code?", "Did the agent verify callers first and last name and complete address?", "Did the agent ask for and verify the caller's email address", "Did the agent correctly offer the seminars?", "Did the agent correctly ask for and verify the phone number?", "Did the agent inform the caller about the text reminders he/she will receive?", "Did the agent summarize the call with relevant details?", "Did the agent offer to register a guest?", "Did the agents collect and verify the guests email address?", "Did the agent demonstrate knowledge of Fortune Builders?", "Did the agent use appropriate grammar and pronunciation?", "Did the agent use good pacing and tone?", "Did the agent display professionalism and handle difficult callers appropriately?", "Did the agent maintain call control throughout the call?", "Did the agent use the appropriate Closing?", "Did the agent correctly disposition the call?", "Call Summary", "Feedback", "Agent Feedback Acceptance","Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='xyz'){
			$header=array("phone1","Name","Email");
	}else if($pid=='purity_free_bottle'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Call Type", "Call Duration", "File No", "Call Type/LOB", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Earned Score", "Possible Score", "Did the rep greet the customer promptly and properly?", "Did the rep use their soft skills appropriately?", "Did the rep collect and verify the customers information appropriately?", "Did the rep cover the super saver offer appropriately?", "Did the rep cover the upsell appropriately?", "Did the rep cover the payment procedures appropriately?", "Did the rep demonstrate knowledge of the product/program?", "Did the rep maintain call control?", "Did the rep use the tools/FAQ's appropriately?", "Did the rep use the appropriate objection responses?", "Did the rep use the callers last name to personalize the call at least once per section?", "Did the rep complete the correct confirmation and closing?", "Did the rep cover the frequency and cost of each delivery when applicable?", "Did the rep have any misrepresentation?", "Did the rep response appropriately to a DNC response?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='purity_catalog'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Proper Greeting", "Customer First Name and Address Verification", "Identifies Type of Account Properly", "Properly transfers the Account", "Accurate Notes Taken/Info Verified Appropriately", "Correct Information Given", "Proper Terminology/Use of Disc Names, etc", "Free Gift Scripting", "Bulk Offer", "Promotions Offered Correctly", "Super Saver Offered and Explained Properly", "Additional Product Offered", "Order Placed Properly/Cancelled Properly", "Order Confirmation", "Uses Tools and FAQ", "Address Verification at Confirmation", "Credit Card Verification/Charged Correct Information", "Attempt to Gather CVV Code", "Daily Special Offer", "Product/Benefits Offered with Daily Special", "Thank You Statement", "Maintained Call Control/Call Flow", "Response Time/Minimal Dead Air", "Used Proper Hold Techniques", "Good Attitude/Maintained Composure", "Energy/Enthusiasm/Attentiveness", "Context Related Responses", "Empathy/Respectfulness/Courteous", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid =='purity_care'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date",
			"Call 1 Call Duration", "Call 1 File No","Call 2 Call Duration", "Call 2 File No","Call 3 Call Duration", "Call 3 File No", "Audit Type", "VOC","Overall Score","Proper Introduction Call 1","Proper Introduction Call 2","Proper Introduction Call 3","Proper Introduction Review","Proper Introduction Score","Customer First Name and Address Verification Call 1","Customer First Name and Address Verification Call 2","Customer First Name and Address Verification Call 3","Customer First Name and Address Verification Review","Customer First Name and Address Verification Score", "Opening Question Call 1","Opening Question Call 2","Opening Question Call 3","Opening Question Review"
			,"Opening Question Score","Accurate Notes Taken Call 1","Accurate Notes Taken Call 2","Accurate Notes Taken Call 3","Accurate Notes Taken Review","Accurate Notes Taken Score","Correct Reason Code Call 1","Correct Reason Code Call 2","Correct Reason Code Call 3","Correct Reason Code Review","Correct Reason Code Score","Correct Information Given Call 1","Correct Information Given Call 2","Correct Information Given Call 3","Correct Information Given Review","Correct Information Given Score","Proper Terminology/use of disc names. etc. Call 1","Proper Terminology/use of disc names. etc. Call 2","Proper Terminology/use of disc names. etc. Call 3","Proper Terminology/use of disc names. etc. Review","Proper Terminology/use of disc names. etc. Score","Proper Inquiry Call 1","Proper Inquiry Call 2","Proper Inquiry Call 3","Proper Inquiry Review","Proper Inquiry Score","Company Promotion Call 1","Company Promotion Call 2","Company Promotion Call 3","Company Promotion Review","Company Promotion Score","Correct Use of Actions Call 1","Correct Use of Actions Call 2","Correct Use of Actions 3","Correct Use of Actions Review","Correct Use of Actions Score","Database Follow Up Call 1","Database Follow Up Call 2","Database Follow Up Call 3","Database Follow Up Review","Database Follow Up Score","Product Promotion Call 1","Product Promotion Call 2","Product Promotion Call 3","Product Promotion Review","Product Promotion Score","Reason for Cancel Call 1","Reason for Cancel Call 2","Reason for Cancel Call 3","Reason for Cancel Review","Reason for Cancel Score","Legitimate Offers/Sequence of Offers Call 1","Legitimate Offers/Sequence of Offers Call 2","Legitimate Offers/Sequence of Offers Call 3","Legitimate Offers/Sequence of Offers Review","Legitimate Offers/Sequence of Offers Score","1st Retention Offer Call 1","1st Retention Offer Call 2","1st Retention Offer Call 3","1st Retention Offer Review","1st Retention Offer Score","2nd Retention Offer Call 1","2nd Retention Offer Call 2","2nd Retention Offer Call 3","2nd Retention Offer Review","2nd Retention Offer Score","Valid Delay Call 1","Valid Delay Call 2","Valid Delay Call 3","Valid Delay Review","Valid Delay Score","Preserved Avg # Units/Shipment Call 1","Preserved Avg # Units/Shipment Call 2","Preserved Avg # Units/Shipment Call 3","Preserved Avg # Units/Shipment Review","Preserved Avg # Units/Shipment Score","Proper Confirmation Call 1","Proper Confirmation Call 2","Proper Confirmation Call 3","Proper Confirmation Review","Proper Confirmation Score","Daily Special Offer Call 1","Daily Special Offer Call 2","Daily Special Offer Call 3","Daily Special Offer Review","Daily Special Offer Score","Anything Else Statement Call 1","Anything Else Statement Call 2","Anything Else Statement Call 3","Anything Else Statement Review","Anything Else Statement Score","Thank You Statement Call 1","Thank You Statement Call 2","Thank You Statement Call 3","Thank You Statement Review","Thank You Statement Score","Maintained call control Call 1","Maintained call control Call 2","Maintained call control Call 3","Maintained call control Review","Maintained call control Score","Response Time/Minimal dead air Call 1","Response Time/Minimal dead air Call 2","Response Time/Minimal dead air Call 3","Response Time/Minimal dead air Review","Response Time/Minimal dead air Score","Uses proper hold techniques Call 1","Uses proper hold techniques Call 2","Uses proper hold techniques Call 3","Uses proper hold techniques Review","Uses proper hold techniques Score","Good Attitude/Maintained Composure Call 1","Good Attitude/Maintained Composure Call 2","Good Attitude/Maintained Composure Call 3","Good Attitude/Maintained Composure Review","Good Attitude/Maintained Composure Score","Energy/Enthusiasm/Attentiveness Call 1","Energy/Enthusiasm/Attentiveness Call 2","Energy/Enthusiasm/Attentiveness Call 3","Energy/Enthusiasm/Attentiveness Review","Energy/Enthusiasm/Attentiveness Score","Context Related Responses Call 1","Context Related Responses Call 2","Context Related Responses Call 3","Context Related Responses Review","Context Related Responses Score","Empathy/Respectfulness/Courteous Call 1","Empathy/Respectfulness/Courteous Call 2","Empathy/Respectfulness/Courteous Call 3","Empathy/Respectfulness/Courteous Review","Empathy/Respectfulness/Courteous Score","Badgering Call 1","Badgering Call 2","Badgering Call 3","Badgering Review","Badgering Score","Average Calls Per Hour/4 or More Call 1","Average Calls Per Hour/4 or More Call 2","Average Calls Per Hour/4 or More Call 3","Average Calls Per Hour/4 or More Review","Average Calls Per Hour/4 or More Score","Average Save % Above 44% Call 1","Average Save % Above 44% Call 2","Average Save % Above 44% Call 3","Average Save % Above 44% Review","Average Save % Above 44% Score","Average Call Length Does Not Exceed 8 min. Call 1","Average Call Length Does Not Exceed 8 min. Call 2","Average Call Length Does Not Exceed 8 min. Call 3","Average Call Length Does Not Exceed 8 min. Review","Average Call Length Does Not Exceed 8 min. Score","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid =='puritycare_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "Call1 Date", "Call2 Date", "Call3 Date", "Call4 Date", "Call5 Date", "Customer Number1", "Customer Number2", "Customer Number3", "Customer Number4", "Customer Number5", "Call1 Duration", "Call2 Duration", "Call3 Duration", "Call4 Duration", "Call5 Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Call VOC1", "Call VOC2", "Call VOC3", "Call VOC4", "Call VOC5", "Overall Score", "Identification of Agent Call1", "Identification of Agent Call2", "Identification of Agent Call3", "Identification of Agent Call4", "Identification of Agent Call5", "Customer Identification Call1", "Customer Identification Call2", "Customer Identification Call3", "Customer Identification Call4", "Customer Identification Call5", "Customer Verification Call1", "Customer Verification Call2", "Customer Verification Call3", "Customer Verification Call4", "Customer Verification Call5", "Opening question Call1", "Opening question Call2", "Opening question Call3", "Opening question Call4", "Opening question Call5", "Identify Reason for Discovery Call1", "Identify Reason for Discovery Call2", "Identify Reason for Discovery Call3", "Identify Reason for Discovery Call4", "Identify Reason for Discovery Call5", "Acknowledge Response Call1", "Acknowledge Response Call2", "Acknowledge Response Call3", "Acknowledge Response Call4", "Acknowledge Response Call5", "Inquiry Probing Call1", "Inquiry Probing Call2", "Inquiry Probing Call3", "Inquiry Probing Call4", "Inquiry Probing Call5", "Value Proposition Call1", "Value Proposition Call2", "Value Proposition Call3", "Value Proposition Call4", "Value Proposition Call5", "1st Retention Attempt Call1", "1st Retention Attempt Call2", "1st Retention Attempt Call3", "1st Retention Attempt Call4", "1st Retention Attempt Call5", "Tactical Hold Call1", "Tactical Hold Call2", "Tactical Hold Call3", "Tactical Hold Call4", "Tactical Hold Call5", "2nd Retention Attempt Call1", "2nd Retention Attempt Call2", "2nd Retention Attempt Call3", "2nd Retention Attempt Call4", "2nd Retention Attempt Call5", "Correct Delay Length Call1", "Correct Delay Length Call2", "Correct Delay Length Call3", "Correct Delay Length Call4", "Correct Delay Length Call5", "Supersaver Confirmation Call1", "Supersaver Confirmation Call2", "Supersaver Confirmation Call3", "Supersaver Confirmation Call4", "Supersaver Confirmation Call5", "Daily Special Call1", "Daily Special Call2", "Daily Special Call3", "Daily Special Call4", "Daily Special Call5", "Thank you Closing Statement Call1", "Thank you Closing Statement Call2", "Thank you Closing Statement Call3", "Thank you Closing Statement Call4", "Thank you Closing Statement Call5", "Full Conf & Cst Acknowledgement Call1", "Full Conf & Cst Acknowledgement Call2", "Full Conf & Cst Acknowledgement Call3", "Full Conf & Cst Acknowledgement Call4", "Full Conf & Cst Acknowledgement Call5", "Made offer to save package Call1", "Made offer to save package Call2", "Made offer to save package Call3", "Made offer to save package Call4", "Made offer to save package Call5",  "Web Login-if applicable Call1", "Web Login-if applicable Call2", "Web Login-if applicable Call3", "Web Login-if applicable Call4", "Web Login-if applicable Call5", "Email Capture-if applicable Call1", "Email Capture-if applicable Call2", "Email Capture-if applicable Call3", "Email Capture-if applicable Call4", "Email Capture-if applicable Call5", "SMS Opt-In-if applicable Call1", "SMS Opt-In-if applicable Call2", "SMS Opt-In-if applicable Call3", "SMS Opt-In-if applicable Call4", "SMS Opt-In-if applicable Call5", "Proper Reason Code Call1", "Proper Reason Code Call2", "Proper Reason Code Call3", "Proper Reason Code Call4", "Proper Reason Code Call5", "Correctly Used Purity Points Call1", "Correctly Used Purity Points Call2", "Correctly Used Purity Points Call3", "Correctly Used Purity Points Call4", "Correctly Used Purity Points Call5", "Agent provided correct information Call1", "Agent provided correct information Call2", "Agent provided correct information Call3", "Agent provided correct information Call4", "Agent provided correct information Call5", "Soft Skills Call1", "Soft Skills Call2", "Soft Skills Call3", "Soft Skills Call4", "Soft Skills Call5", "Rapport Call1", "Rapport Call2", "Rapport Call3", "Rapport Call4", "Rapport Call5", "Maintaining Call Control Call1", "Maintaining Call Control Call2", "Maintaining Call Control Call3", "Maintaining Call Control Call4", "Maintaining Call Control Call5", "***Unauthorized Shipments Call1", "***Unauthorized Shipments Call2", "***Unauthorized Shipments Call3", "***Unauthorized Shipments Call4", "***Unauthorized Shipments Call5", "***Inappropriate Language Call1", "***Inappropriate Language Call2", "***Inappropriate Language Call3", "***Inappropriate Language Call4", "***Inappropriate Language Call5", "***Badgering Call1", "***Badgering Call2", "***Badgering Call3", "***Badgering Call4", "***Badgering Call5", "***Incorrect use of actions Autofail Call1", "***Incorrect use of actions Autofail Call2", "***Incorrect use of actions Autofail Call3", "***Incorrect use of actions Autofail Call4", "***Incorrect use of actions Autofail Call5", "***Making Health Claims Call1", "***Making Health Claims Call2", "***Making Health Claims Call3", "***Making Health Claims Call4", "***Making Health Claims Call5", "***No Confirmation Call1", "***No Confirmation Call2", "***No Confirmation Call3", "***No Confirmation Call4", "***No Confirmation Call5", "***No Retention Call1", "***No Retention Call2", "***No Retention Call3", "***No Retention Call4", "***No Retention Call5", "Call Summary / Feedback #1", "Call Summary / Feedback #2", "Call Summary / Feedback #3", "Call Summary / Feedback #4", "Call Summary / Feedback #5", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");
			/* "***Hanging up on Customer Call1", "***Hanging up on Customer Call2", "***Hanging up on Customer Call3", "***Hanging up on Customer Call4", "***Hanging up on Customer Call5", */
		}else if($pid=='conduent'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration","Site", "Phone","Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Clearly gave name and Branded", "DDid CSP demonstrate a good tone of voice throughout the call", "Did CSP properly verify account & make appropriate updates if necessary", "Did CSP deliver assurance statement after purpose", "Did CSP refer to customer by last name at least once through the call", "Did CSP maintain control of call", "Did CSP follow appropriate Hold/Wait process & avoid DEAD AIR", "Did CSP use soft skills", "Did CSP demonstrate active listening skills", "Proper use of probing questions", "Did CSP use all available systems and tools towards a One Call Resolution", "Did CSP provide complete and accurate information", "Did CSP meet documentation expectations", "Did CSP select the correct disposition", "Did the CSP close the call properly", "CSP released account information or made changes to an unverified Cardholder", "CSP did not resolve the Customers issue and did not demonstrate willingness to assist", "CSP hang up on customer","CSP gives blatant incorrect information to Cardholder","CSP used inappropriate condescending /argumentative language or tone during the call","CSP did not successfully complete transaction process","CSP did not leave any memos on accessed account","Call Avoidance", "Courtesy Comment","Throughout Comment", "Product Comment", "Closing Comment","Auto Failure Comment","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='touchfuse'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Call Status", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the call answered promptly?", "Did the agent answer with thank you for calling", "Did the agent ask for the zip code?", "Did the agent correctly offer the seminars?", "Did the caller wish to cancel the seminar?", "Did the agent confirm the callers first and last name?", "Did the agent confirm the callers address?", "Did the agent ask for and correctly verify the email phonetically?", "Did the agent correctly ask for and verify the phone number", "Did the agent summarize the call with relevant detail?", "Did the agent offer to register a guest and attempt to collect and verify guests email address phonetically?", "Did the agent correctly disposition the call?", "Did the agent use the appropriate closing?", "Did the agent use appropriate tone/pacing/grammar/pronunciation?", "Did the agent use active listening throughout the call?", "Was the agent professional throughout the call?", "Did the agent show knowledge of TouchFuse throughout the call?", "Did the agent maintain call control throughout the call?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='touchfuse_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Call Status", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Customer Score","Business Score","Compliance Score", "Overall Score",
			"Was the call answered promptly?", "Did the agent answer with thank you for calling", "Did the agent use appropriate tone/pacing/grammar/pronunciation?", "Did the agent use active listening throughout the call?", "Was the agent professional throughout the call?", "Did the agent maintain call control throughout the call?", "Did the agent show knowledge of TouchFuse throughout the call?", "Did the agent ask for the zip code?", "Did the agent correctly offer the seminars?", "Did the caller wish to cancel the seminar?", "Did the agent confirm the callers address?", "Did the agent correctly ask for and verify the phone number", "Did the agent summarize the call with relevant detail?", "Did the agent correctly disposition the call?", "Did the agent use the appropriate closing?", "Did the agent spell back the customers first and last name?", "Did the agent ask for and correctly verify the email phonetically", "Rude Remarks", "Security Breach/Call Dumping/Avoidance",
			"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='tbn'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Call ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Full Recording Between Communicator and Caller is Captured", "Communicator Properly Prepared for Call", "Communicator Gave Her/His First Name", "Stated-This Call May Be Recorded For Training Purposes", "Stated Offer Title as Scripted", "Stated No Offer Disclosure (if applicable)", "Spelled Donors Full Name Back on ALL CALLS", "EXISTING File - Communicator Verified Address", "IF NEW ADDRESS - Communicator Spelled Address", "IF No Existing Email - Asked for Email", "Spelled Back Email", "Asked for Phone Number", "Confirmed Phone Number", "Verified Phone Number Type", "IF Cell Asked for Consent", "Asked for Alternate Phone Number", "Verified Alternate Phone Number", "Verified Alternate Number Type", "IF Alternate Phone Number is Cell - Asked for Consent", "Read First Request as Scripted", "Appropriately Presented Higher Tier Offers (if applicable )", "Read Monthly Ask As Scripted (if applicable)", "Navigates Script With Ease", "Displays TBN Knowledge and Answers Questions Appropriately", "Correctly Pronounces Speaker/Author Name and Title of Offer", "Overall Script Adherence", "Verified Donation Frequency (One-Time/Monthly)", "Verified Donation Amount", "Verified Monthly Donation Beginning and End Date (if applicable)", "Verified Resource Donor Will Be Receiving (if applicable)", "Read Close as Scripted", "Speaks Clearly with Proper Articulation (no slang)", "Pleasant Demeanor", "Speaks at an Appropriate Pace", "Actively Listens and Responds Appropriately", "Exhibits Empathy (if appropriate)", "Communicator Shows Sincere Appreciation for Donor and Donations", "Maintained Control of the Conversation and Talk Time", "Autofail - False and/or Inappropriate Information", "Autofail - Inappropriately Ended Call", "Autofail - Rudeness/Unprofessional Behavior", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='offline'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Phone","Rep","Enter Policy Information","Florida or National?","Type of Policy","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","Overall Score", "Possible Score", "Earned Score","Did the associate handle the request according to Brightways standards?","Did the associate handle the request according to the carriers standards?","Did the associate process the change correctly?","Did the associate use the appropriate verbiage tone pace and professionalism?","All verbal and written information provided by associate to insured and other parties was clear accurate and included all relevant information","Was the customer adversely impacted?","Were there any additional adverse impacts?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
        }else if($pid=='phone_inbound'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Evaluator Name","ANI","DNIS","Contact Id","Direction Type Description","Skill Name","Segment Duration","Audit Type","Voc","Audit Start Time","Entry Date","Interval","Earn Score","Possible Score","Overall Score","Line of Business", "State of Policy", "Comment","Did the CSR complete the correct caller verification for either a first-party or a third-party caller?", "During the authentication process if any new contact information was provided was this captured?","Did the CSR demonstrate soft skills effectively throughout the call?","Did the CSR provide empathy or sympathy if applicable?","Did the CSR demonstrate call control effectively throughout the call?","Did the CSR provide the proper Brightway-approved greeting?","Did the CSR advise the caller that the call will be recorded?","Did the CSR follow the proper hold process if applicable?","Did the CSR follow the proper transfer process if applicable?","If the call disconnected did the CSR attempt to call back?","Did the CSR use the proper closing?","Did the CSR use the necessary tools and resources to effectively and accurately assist the customer?","Did the CSR demonstrate knowledge of Brightways carriers and lines of business when relaying information to the caller?","Did the CSR accurately document the interaction from start to finish?","Did the CSR provide clear notes that provide clarity and understanding of what happened during the interaction","Did the CSR properly advise the caller of any follow-up expectations and set for themselves?","Did the CSR clearly explain options or solutions to the customer and focus on an end solution?","Were all necessary policies updated in AMS and the carrier website?","Did the CSR offer helpful options as applicable such as webforms etc.?","Was CSR able to retain a customer who had considered cancelling a policy with Brightway?","Did the CSR identify a cross-sell opportunity and put the customer in touch with their agent of record?","Did the CSR receive a kudos for this interaction due to Unchecked exemplary performance?","Did CSR demonstrate behavior that is considered offensive by using unprofessional language tone or any other action that impacted the customer experience?","Did CSR provide information or complete a transaction that could lead to an Errors and Omissions claim or impact the customer in a negative manner?","Authentication: Comment 1","Authentication: Comment 2","Professionalism: Comment 1","Professionalism: Comment 2","Professionalism: Comment 3","Call Handling Skills Comment 1","Call Handling Skills Comment 2","Call Handling Skills Comment 3","Call Handling Skills Comment 4","Call Handling Skills Comment 5","Call Handling Skills Comment 6","Use of Appropriate Resources and Tools/ Brightway Knowledge Comment 1","Use of Appropriate Resources and Tools/ Brightway Knowledge Comment 2","Documentation Comment 1","Documentation Comment 2","Contact Resolution Comment 1","Contact Resolution Comment 2","Contact Resolution Comment 3","Contact Resolution Comment 4","Bonus Questions Comment 1","Bonus Questions Comment 2","Bonus Questions Comment 3","Penalty Questions Comment 1","Penalty Questions Comment 2","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
        }else if($pid=='phone_inbound_new'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Duration","State","Policy Number","Line of Business","Overview","Carrier","Master ID","Rate of Call","Audit Type","Voc","Earn Score","Possible Score","Overall Score","Completed the correct caller verification for either a first-party or a third-party caller", "New contact information was captured","Empathy/ Sympathy was provided on the call","Demonstrated call control effectively throughout the call by listening and acknowledging","Followed a common-sense approach to placing a caller on hold or transferring them","If the call disconnected the customer was called back","Additional assistance offered if applicable","Use the necessary resources to assist the customer effectively and accurately","Accurately document the interaction from start to finish","Properly advised the caller of any follow-up expectations and set a follow-up for themselves if applicable","Clearly explained options or solutions to the customer and focus on an end solution","Properly update necessary policies / information in AMS and the carrier website if applicable","Received kudos for this interaction due to exemplary performance","Did CSR demonstrate behavior that is considered offensive by using unprofessional language tone or any other action that impacted the customer experience?","Did CSR provide information or complete a transaction that could lead to an Errors and Omissions claim or impact the customer in a negative manner?","Comment 1","Comment 2","Comment 3","Comment 4","Comment 5","Comment 6","Comment 7","Comment 8","Comment 9","Comment 10","Comment 11","Comment 12","Comment 13","Comment 14","Comment 15", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
        }else if($pid=='processing'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Evaluator Name","ANI","DNIS","Contact Id","Direction Type Description","Skill Name","Segment Duration","Audit Type","Voc","Earn Score","Possible Score","Overall Score","Audit Start Time","Entry Date","Interval","Line of Business", "State of Policy", "Comment","2.a. Did the CSR complete the correct caller verification for either a first-party or a third-party caller?","2.b. Was new contact information captured?","3.a. Did the CSR demonstrate soft skills effectively throughout the call?","3.b. Did the CSR provide empathy or sympathy if applicable ?","3.c. Did the CSR demonstrate call control effectively throughout the call?","4.a. Did the CSR provide the proper Brightway-approved greeting?","4.b. Did the CSR advise the caller that the call will be recorded?","4.c. Did the CSR follow the proper hold process if applicable?","4.d. Did the CSR follow the proper transfer process if applicable?","4.e. If the call disconnected did the CSR attempt to call back?","4.f. Did the CSR use the proper closing?","5.a. Did the CSR use the necessary tools and resources to effectively and accurately assist the customer?","5.b. Did the CSR demonstrate knowledge of Brightways carriers and lines of business when relaying information to the caller?","6.a. Did the CSR accurately document the interaction from start to finish?","6.b. Did the CSR provide clear notes that fully captures their whole interaction ?","7.a. Did the CSR use proper spelling grammar and punctuation throughout the whole email interaction?","7.b. Did the CSR personalize the email ensuring the customers name policy information and any other information was mentioned?","8.a. Did the CSR properly advise the caller of any follow-up expectations and set for themselves?","8.b. Did the CSR clearly explain options or solutions to the customer and focus on an end solution?","8.c. Were all necessary policies updated in AMS and the carrier website?","8.d. Did the CSR leave a message with a clear reason for the call along with contact information?","8.e. Did the CSR offer helpful options as applicable such as webforms etc.?","Was CSR able to retain a customer who had considered cancelling a policy with Brightway?","Did the CSR identify a cross-sell opportunity and put the customer in touch with their agent of record?","Did the CSR receive a kudos for this interaction due to exemplary performance?","Did CSR demonstrate behavior that is considered offensive by using unprofessional language tone or any other action that impacted the customer experience?","Did CSR provide information or complete a transaction that could lead to an Errors and Omissions claim or impact the customer in a negative manner?","Authentication: Comment 1","Authentication: Comment 2","Professionalism: Comment 1","Professionalism: Comment 2","Professionalism: Comment 3","Call Handling Skills Comment 1","Call Handling Skills Comment 2","Call Handling Skills Comment 3","Call Handling Skills Comment 4","Call Handling Skills Comment 5","Call Handling Skills Comment 6","Use of Appropriate Resources and Tools/ Brightway Knowledge Comment 1","Use of Appropriate Resources and Tools/ Brightway Knowledge Comment 2","Documentation Comment 1","Documentation Comment 2","Email Writing Skills Comment 1","Email Writing Skills Comment 2","Contact Resolution Comment 1","Contact Resolution Comment 2","Contact Resolution Comment 3","Contact Resolution Comment 4","Contact Resolution Comment 5","Bonus Questions Comment 1","Bonus Questions Comment 2","Bonus Questions Comment 3","Penalty Questions Comment 1","Penalty Questions Comment 2","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='processing_new'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Evaluator Name","ANI","DNIS","Contact Id","Direction Type Description","Skill Name","Segment Duration","Audit Type","Voc","Earn Score","Possible Score","Overall Score","Audit Start Time","Entry Date","Interval","Completed the correct caller verification for either a first-party or a third-party caller", "New contact information was captured", "Authenticated the information/ documented that was received (correct document to suffice policy) prior to taking actions with the carrier or other","Confirmed the correct policy and eligibility to service prior to taking action","Empathy/ Sympathy was provided on the call","Demonstrated call control effectively throughout the call by listening and acknowledging","Followed a common-sense approach to placing a caller on hold or transferring them","If the call disconnected the customer was called back","Additional assistance offered if applicable","Written communication follows a common sense approach (template standards) or was the applicable template used","Use the necessary resources to assist the customer effectively and accurately","Accurately document the interaction from start to finish"," Properly advised the caller of any follow-up expectations and set a follow-up for themselves if applicable","Clearly explained options or solutions to the customer and focus on an end solution","Properly update necessary policies / information in AMS and the carrier website if applicable","Received kudos for this interaction due to exemplary performance","Did CSR demonstrate behavior that is considered offensive by using unprofessional language tone or any other action that impacted the customer experience?","Did CSR provide information or complete a transaction that could lead to an Errors and Omissions claim or impact the customer in a negative manner?","Comment 1","Comment 2","Comment 3","Comment 4","Comment 5","Comment 6","Comment 7","Comment 8","Comment 9","Comment 10","Comment 11","Comment 12","Comment 13","Comment 14","Comment 15","Comment 16","Comment 17","Comment 18","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='jfmi'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Greets the customer promptly and properly","Uses professionalism/courtesy/enthusiasm/proper grammar/no jargon","Shows gratitude throughout the call","Collects and verifies all customer information/uses phonetic when applicable","Follows correct Scripting Path","Collects information to provide to Partner Relations if necessary","Covers all payment scripting and responses properly","Maintains call control","Keeps dead air to a minimum","Uses FAQ's/Agent notes to answer questions properly","Brands the call with proper close", "Not stopping the recording for credit card capture", "Agent read legal scripting to the caller", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='hoveround'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Customer Score","Business Score","Compliance Score","Was the agent ready for the call (no dead air)?", "Did the agent give the proper introduction including company name?", "Did the agent correctly probe and transfer if applicable?", "Did the agent close the call with proper branding?", "Did the agent disposition the call properly?","Did the agent maintain call control No dead air?", "Was the agent polite and courteous?", "Did the agent show energy empathy and enthusiasm?", "Did the agent have good tone grammer?", "Did the agent give accurate information and show a complete grasp of information?","Did the agent spell back of email address (NATO)?","Did the agent gather the lead properly","Rude Remarks","Call Dumping /Avoidance", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='ncpssm'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Thanks caller for calling NCPSSM", "Verified opening info", "Gathered and spelled back all necessary information", "Verified/Asked for Email Address", "Makes thank you/supporting statements", "Familiarity with FAQ -Organization", "Personalized call (Mr./Mrs etc)", "Thanked Caller for being a member/previous support", "Energy/enthusiasm", "Proper pace", "Maintained control of the conversation/Minimal Dead Air", "Spoke clearly/utilized proper grammar (NO SLANG)", "Good listening skills/Does not interrupt", "Empathized with caller", "Overall professionalism", "Proper thanks at call conclusion", "Provided correct and appropriate information", "Confirmed caller has no further questions", "False/inappropriate information", "Hung up inappropriately", "Unprofessional behavior", "Inappropriate language", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='stc'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the agent use proper introduction?", "Did the agent correctly capture and verify donor name?", "Did the agent read first request as scripted?", "Did the agent cover second monthly request (if applicable)?", "Did the agent correctly capture and verify donation amount?", "Did the agent offer payment types?", "Did the agent correctly capture and verify donor address?", "Did the agent correctly capture and verify donor phone number?", "Did the agent correctly capture and verify donor email address?", "Did the agent properly present rebuttals (if applicable)?", "Did the agent follow overall script adherence?", "Did the agent show familiarity with Save the Children?", "Did the agent use appropriate script navigation and proper disposition?", "Did the agent follow proper close?", "Did the agent use effective communication?", "Did the agent maintain control of the conversation and talk time?", " Did the agent show appreciation for donor and donations?", "Did the agent give false or inappropriate information?", "Did the agent hang up inappropriately?", "Did the agent show any rudeness or unprofessional behavior?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='tpm'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Read Call Opening as Scripted", "Are You Calling From the US or Canada", "Verify Form of Payment", "Communicator Asked for Name", "Communicator Spelled Name", "Communicator Asked for Address", "Communicator Spelled Address", "Communicator Asked for Phone Number", "Communicator Verified Phone Number", "Communicator Verified Landline or Cell", "Communicator Read Consent to Call Verbatim", "Communicator Read Consent to Text Verbatim", "Communicator Asked for Email", "Communicator Spelled Email", "Overall Script Adherence", "Appropriately Presented higher Tier Offers (If applicable)", "Navigates Script with Ease", "Displays TPM Knowledge and Answers Questions Appropriately", "Verified Contents of the Cart", "Monthly Ask Presented (If Applicable)", "Reviewed Shipping Time Frame", "Provided Cart Total Including Shipping (If Applicable)", "Read Close As Scripted", "Speaks Clearly and Articulately", "Pleasant Demeanor", "Professionalism", "Speaks at an Appropriate Pace", "Listens and Responds Approriately", "Exibits Empathy If Applicable", "Communicator Shows Sincere Appreciation for Donor and Donations", "Maintained Control of the Conversation and Talk Time", "Blatantly False/Inappropriate Information", "Rudely Hung up on Donor", "Rude/Hostile/Uses Profanity", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='patchology'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the agent open the call using their name and the appropriate branding for the call?", "Did the agent close the call using the appropriate branding?", "Remarks1", "Did the agent verify/confirm all necessary information?", "Did agent provide consistent/accurate information regarding products and availability?", "Did agent provide/confirm shipping information/next steps/resolution of issue?", "Remarks2", "Was call answered in a timely manner?", "Was agent engaged/helpful with customer?", "Was customer satisfied/fulfilled?", "If escalated were all resources explored before sending escalation form?", "Remarks3", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='aspca'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greets the customer promptly and properly","Remark1", "Uses professionalism/courtesy/enthusiasm/proper grammar/no jargon","Remark2",  "Shows gratitude throughout the call","Remark3","Collects and verifies all customer information/ uses phonetic when applicable","Remark4", "Asks if they are calling to join ASPCA guardians program","Remark5",  "Covered one time gift scripting (when applicable)", "Remark6","Covered all payment scripting and responses properly", "Remark7","Offers the Animal Champion T-Shirt", "Remark8","Covers donation processing script",  "Remark9","Covers pet insurance / proper close", "Remark10","Followed correct script path/followed transfer procedures and scripting","Remark11", "Maintains call control", "Remark12","Keeps dead air to a minimum", "Remark13","Uses FAQ's/KB's to answer questions properly","Remark14","Personalizes the call","Remark15","Agent correctly disposed the call","Remark16","Covered monthly guardian/roundup upsell $25","Remark17", "Covers additional one time donation","Remark18","Rude Remarks","Remark19","Call Avoidance","Remark20","Compliance Score","Customer Score","Business Score", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='ffai'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Customer Score", "Business Score", "Compliance Score",
			"Did the agent open the call using their name and the appropriate branding for the call?", "Did the agent close the call using the appropriate branding?", "Did the agent verify/confirm all necessary information and spell back email address using NATO?", "Did agent provide consistent/accurate information regarding products and availability?", "Did agent provide confirm shipping information/next steps/resolution of issue to ensure one call resolution?", "Did agent accurately and clearly fill out pulse on Monday.com?", "Was agent engaged/empathetic with customer?", "Did agent offer membership in the Home Filter Club (if applicable)?", "Did agent offer donation to Wine to Water?", "Was customer satisfied/fulfilled?", "Did agent offer the survey?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='lifi'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Life Quotes Greeting & Introduction", "Did the agent give positive response to the caller", "Customer Name Capture", "Did the agent capture the address of the customer", "Phone Number confirmation", "Email address", "Customer's DOB", "Overall Script Adherence", "Did the agent ask for coverage amount of the Insurance", "Confirmation of Tobacco or smoking", "Did the agent ask for Height & Weight of the customer", "Did the agent mention about price comparison report", "Overall confidence level professionalism & tone", "Call closing", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='heatsurge'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Compliance Score","Customer Score","Business Score", "Was the agent Prepared for call or answer within 5 seconds","Remark1", "Did the agent use inbound or outbound greeting","Remark2", "Accesses customers accounts or any reports needed", "Remark3","Agent verifies cst name address phone and TPA if needed","Remark4", "Verifies or Asks for email address spelling and gave email disclaimer","Remark5", "Reads mini Miranda and or Recording statement on outbound calls","Remark6", "Gives accurate pricing or refund or return information","Remark7", "Gives accurate shipping or delivery information","Remark8", "Accurately describes product or promo or answers questions","Remark9", "Asks for Upsell or add on product where appropriate","Remark10", "Provides appropriate solution or alternatives","Remark11", "Keyed or coded order correctly and corrected info as needed","Remark12", "Asks for cancelation reason","Remark13", "1st save attempt did agent use PK key buying factors","Remark14", "2nd save attempt used appropriately and per guidelines","Remark15", "Asks for billing Name as it appears on cc or check","Remark16", "agent verified caller is an authorized user of the cc or check","Remark17", "Asks for billing address for payment method used","Remark18", "Asks for permission to authorize payment (cc or check)", "Remark19","Agent verifies shipping address","Remark20", "Notates account with issue or resolution","Remark21", "Did the agent dispose the call correctly?","Remark22","Summarizes and reviews call or appropriate closure to call","Remark23", "Maintains call control","Remark24","Uses hold and transfers properly","Remark25", "Gave CS hours of operation and CS phone number","Remark26", "Was the agent polite courteous and patient","Remark27","Hung up inappropriately (Call Avoidance)","Remark28","Agent refrained from using inappropriate comments/presentation","Remark29", "**Automatic Zero","Remark30", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='stauers_sales'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Possible Score","Earned Score","Customer Score","Business Score","Compliance Score", "Was the call answered within 5 seconds?","Did the agent verify the customer's name and address on the account?","Did the agent capture the correct offer code?","Did the agent verify the phone number with the customer?","Did the agent verify the customer's email address?","Did the agent compliment the caller's purchase choice?","Did the agent recap the item?","Did the agent cover atleast one upsell ( ask if the customer would be interested in any other products)?","Did the agent recap the item and ask if the customer would be interested in any other product(s)?","Did the agent cover at least one upsell?","Did the agent cover the replacement guarantee pitch?","Did the agent use an appropriate rebuttal if the replacement guarantee was declined?","Did the agent cover the membership pitch?","Did the agent use an appropriate rebuttal if the membership pitch was declined?","Did the agent offer the membership accurately?","Did the agent cover the auto-renew offer correctly?","Was the shipping address verified?","Did the agent quote the correct delivery time?","Did the agent give a total product quote appropriately?","Did the agent quote shipping & taxes correctly?","Did the agent give the total to be charged and verify the credit card to be charged correctly?","Did the agent provide the order number correctly?","Did the agent close the call with the brand correctly?","Did the agent disposition the call correctly?","Did the agent maintain call control? No dead air for more than 15 secs?","Was the customer satisfied with his/her experience?","Was the customer dissatisfied with the agent's professionalism and/or tone?","Rude Remarks","Call Avoidance","Was the call answered within 5 seconds? Remarks1","Did the agent verify the customer's name and address on the account? Remarks2","Did the agent capture the correct offer code? Remarks3","Did the agent verify the phone number with the customer? Remarks4","Did the agent verify the customer's email address? Remarks5","Did the agent compliment the caller's purchase choice? Remarks6","Did the agent recap the item? Remarks7","Did the agent cover atleast one upsell ( ask if the customer would be interested in any other products)? Remarks8","Was the shipping address verified? Remarks9","Did the agent quote the correct delivery time? Remarks10","Did the agent give a total product quote appropriately? Remarks11","Did the agent quote shipping & taxes correctly? Remarks12","Did the agent provide the order number correctly? Remarks13","Did the agent close the call with the brand correctly? Remarks14","Did the agent disposition the call correctly? Remarks15","Did the agent maintain call control? No dead air for more than 15 secs? Remarks16","Was the customer satisfied with his/her experience? Remarks17","Was the customer dissatisfied with the agent's professionalism and/or tone? Remarks18"," Did the agent give the total to be charged and verify the credit card to be charged correctly? Remarks19","Rude Remarks Remarks20","Call Avoidance Remarks21",
			  "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='operation_smile'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the agent ready to handle the call promptly and answer properly?", "Did the agent greet the caller read the scripted opening?", "Did the agent confirm all information and utilize phonetic spell back when necessary?", "Does the agent show gratitude and acknowledge callers concerns?", "Did the agent use rebuttals appropriately?", "Did the agent offer the upsell?", "Did the agent follow the script correctly and with confidence?", "Did the agent address questions about the program and utilize the FAQs correctly?", "Did the agent speak with energy and enthusiasm?", "Did the agent use proper pacing?", "Did the agent maintain control of the conversation and minimize dead air?", "Was the agent professional and speak with proper enunciation grammar and tone?", "Did the agent use good listening skills and does not interrupt?", "Did the agent empathize with the caller?", "Did the agent provide a good donor experience and show appropriate appreciation?", "Did the agent ask what prompted them to call today?", "Did the agent thank the caller for their call today and close appropriately?", "***Did the agent give false or inappropriate information?", "***Did the agent hang up inappropriately?", "***Did the agent use inappropriate language?", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='5_11_tactical'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Earn Score","Possible Score","Overall Score",
			"Did the rep greet the customer promptly and properly?","Remark1", "Did the rep confirm the customers item to order (product size colour price)","Remark2", "Did the rep ask is there anything else you would like to add to your order?","Remark3", "Did the rep ask for customer login information or continue as guest appropriately","Remark4", "Did the rep gather/verify the callers information for accuracy","Remark5", "Did the rep cover the final confirmation?","Remark6", "Did the rep give customer their order number?","Remark7", "Did the rep use all applicable search method?","Remark8", "Did the rep cover the returns process appropriately?","Remark9", "Did the rep cover the exchange process appropriately?","Remark10", "Did the rep cover the refund process appropriately?","Remark11", "Did the rep track the package appropriately","Remark12", "Did the agent ask is there anything else I can assist you with today?","Remark13", "Did the agent close and brand the call appropriately?","Remark14", "Did the rep answer questions appropriately","Remark15", "Did the rep maintain call control?","Remark16", "Did the rep properly notate AX?","Remark17", "If an escalation was done was it warranted?","Remark18", "Did the agent disposition the call appropriately?","Remark19", "Did the rep maintain professionalism throughout the call?","Remark20", "If an escalation was done was it warranted?","Remark21","Call dumping or avoidance","Remark22","Rudeness or inappropriate language or behavior","Remark23",
			"Compliance Score","Customer Score","Business Score","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='jmmi'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1) Did the agent give appropriate greeting?",	"2) Did the agent give excellent conversational responses to caller's requests?",	"3) Did the agent verify the opening information (name-zip code-address-phone number)?",	"4) Did the agent follow call flow with caller's initial request (orders what the caller asks for)?",	"5) Did the agent show appropriate gratitude throughout the call?",	"6) Did the agent share upsells when presented?",	"7) Did the agent show familiarity and search all options for offers products?", "8) If partner-did the agent thank the caller specifically?",	"9) Did the agent share HOM/JMM facts as appropriate and make good use of dead air?",	"10) Was the agent professional with communication?",	"11) Did the agent use proper pace energy & enthusiasm?",	"12) Did the agent maintain control of the conversation?",	"13) Did the agent spoke clearly and utilize proper grammar (no slang)?",	"14) Did the agent use good listening skills and appropriate responses?",	"15) Did the agent empathize with the caller and show compassion?",	"16) Did the agent have minimal dead air?",	"17) Did the agent have the caller provide the address if not populated on review screen?",	"18) Did the agent confirm dollar amount and frequency as well as reviewing cart?", "19) Did the agent read shipping information as scripted/share charges as appropriate?", "20) Did the agent ask caller for email and tv information?", "21) Did the agent use proper thanks at the call conclusion?", "22) Did the agent transfer the call to prayer/CS when appropriate?", "23) ***Did the agent follow payment industry compliance policies properly?", "24) ***Did the agent read back the customer's details properly? Like name - phone number etc.", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='non_profit'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Properly prepared to take calls", "Clearly stated paid caller from Donor Care Center/recorded line", "Communicator stated his/her full name", "Pronounced clients name correctly", "Gave a warm friendly greeting", "Followed scripted 1st request as scripted", "1st request Used correct dollar amounts", "1st request Assumptive gift ask", "Showed empathy/Concern", "Repeated the objection", "Personalized the objection", "Attempted to handle objection", "Did not reinforce the negative", "Exited a dead-end call", "Followed scripted 2nd request as scripted", "2nd request Used correct dollar amounts", "2nd request Assumptive gift ask", "Attempted 3rd request as scripted (when applicable)", "3rd request Used correct dollar amounts", "3rd request Assumptive gift ask", "Confirmation question/Confirmed gift amount & waited for response", "Assumed the higher dollar amount", "Showed meaningful gratitude/Thanked the donor or volunteer", "Read credit card/ACH ask verbatim/assumptively asked for credit card", "Confirmed full name and address", "Followed Maybe Close appropriately", "Read close as scripted", "Ended call in a reasonable time", "Sounded conversational used good voice inflection not read or monotone", "Mirrored donor / Used appropriate pace", "Confident presentation w/out hesitation filler words or uptalking", "Did not lose control of the conversation", "Proper personalization", "Utilized proper grammar & pronunciation", "BAILING", "DID NOT ASK FOR A CREDIT CARD/ACH", "GAVE FALSE INFORMATION", "OMITTED PAID CALLER FROM DONOR CARE CENTER STATEMENT", "DID NOT ASK CONFIRMATION QUESTION", "UNSOLID GIFT", "NOT CODING A REFUSAL/CODING A REFUSAL INAPPROPRIATELY", "UNPROFESSIONAL BEHAVIOR/RUDENESS (not extreme)", "IMPROPER PRESENTATION", "OMITTED DNC CODE/USED DNC CODE INCORRECTLY", "FALSIFICATION OF A GIFT", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='revel_new'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Possible Score","Earned Score", "Overall Score","Bonus Overallscore","Agent greeted the member used correct client opening introduced themselves and continued following the basic scripting to open the call", "Agent properly authenticated the member", "Did Agent attempt to update Email/SMS/IVR/Phone Number?", "Agent gave Health Care Activity info Correctly", "Agent collected Health Care Activity information correctly", "Agent gave correct Gift Card information", "Agent offered to provide information on the Health Care Activities that the member has remaining to complete", "Agent provided online self-service information", "Agent used correct transfer procedure", "Agent logged call correctly in all appropriate systems", "Agent followed script guidelines ", "Agent gave correct and complete information", "Agent resolved all questions and concerns", "Agent displayed active listening skills and probed for details effectively","Agent effectively engaged with the caller","Agent displayed a polite/appropriate tone", "Agent sounded confident and knowledgeable", "Agent did not interrupt or talk over the customer","Agent used pleasing words and phrases ","Agent maintained call control","Agent used correct grammar avoided slang", "Agent offered additional assistance", "Agent used correct client closing ", "Agent submitted escalation in system when required (Auto-Fail)", "Agent was not rude or inappropriate? (Auto-Fail)", "Agent used the correct client name during the call (Auto-Fail) ", "Agent did not demonstrate call avoidance (Auto-Fail)", "Agent properly authenticated the member (Auto-Fail)", "The agent received direct appreciation from the member ","Is the recording quality acceptable? (Tracking)","Would play this for the client?(Tracking)","Mechanics Comment 1","Mechanics Comment 2","Mechanics Comment 3","Mechanics Comment 4","Mechanics Comment 5","Mechanics Comment 6","Mechanics Comment 7","Mechanics Comment 8","Mechanics Comment 9","Mechanics Comment 10","Mechanics Comment 11","Mechanics Comment 12","Mechanics Comment 13","Soft Skills Comment 1","Soft Skills Comment 2","Soft Skills Comment 3","Soft Skills Comment 4","Soft Skills Comment 5","Soft Skills Comment 6","Soft Skills Comment 7","Soft Skills Comment 8","Soft Skills Comment 9","Soft Skills Comment 10","Auto-fail Comment 1","Auto-fail Comment 2","Auto-fail Comment 3","Auto-fail Comment 4","Auto-fail Comment 5","Bonus Point Comment","Tracking Comment 1","Tracking Comment 2","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='icario'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Possible Score","Earned Score", "Overall Score","Agent greeted the member used correct client opening introduced themselves and continued following the basic scripting to open the call", "Agent properly authenticated the member", "Agent collected Health Care information/Responses correctly", "Agent gave correct and complete information", "Agent gave correct incentive information", "Agent provided online self-service information", "Agent logged call correctly in all appropriate systems", "Agent followed script guidelines", "Agent resolved all questions and concerns", "Agent displayed active listening skills and probed for details effectively", "Agent effectively engaged with the caller", "Agent maintained appropriate pace with caller", "Agent Displayed a polite and appropriate tone", "Agent sounded confident and knowledgeable","Agent did not interrupt or talk over the member","Agent used pleasing words and phrases between member responses", "Agent used pleasing words and phrases at beginning and end of call", "Agent maintained call control","Agent managed silence/hold times","Agent used correct grammar avoided slang","Agent used correct client closing", "Agent submitted escalation in system when required (Auto-Fail)", "Agent was not rude or inappropriate? (Auto-Fail)", "Agent used incorrect client name during the call (Auto-Fail)", "Agent did not demonstrate call avoidance (Auto-Fail)", "Agent properly authenticated the member (Auto-Fail)", " Comment 1"," Comment 2"," Comment 3"," Comment 4"," Comment 5"," Comment 6"," Comment 7"," Comment 8"," Comment 9"," Comment 10"," Comment 11"," Comment 12"," Comment 13"," Comment 14"," Comment 15"," Comment 16"," Comment 17"," Comment 18"," Comment 19"," Comment 20"," Comment 21"," Comment 22"," Comment 23"," Comment 24"," Comment 25"," Comment 26","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='ica_latest'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC","File No","Process Name", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Possible Score","Earned Score", "Overall Score", "mechanics overall score","soft skills overall_score",
			"Agent greeted the member used correct client opening introduced themselves and continued following the basic scripting to open the call", "Agent properly authenticated the member", "Agent collected Health Care information/Responses correctly", "Agent gave correct and complete information", "Agent gave correct incentive information", "Agent provided online self-service information", "Agent logged call correctly in all appropriate systems", "Agent followed script guidelines", "Agent resolved all questions and concerns", "Agent displayed active listening skills and probed for details effectively", "Agent effectively engaged with the caller", "Agent maintained appropriate pace with caller", "Agent Displayed a polite and appropriate tone", "Agent sounded confident and knowledgeable","Agent did not interrupt or talk over the member","Agent used pleasing words and phrases between member responses", "Agent used pleasing words and phrases at beginning and end of call", "Agent maintained call control","Agent managed silence/hold times","Agent used correct grammar avoided slang","Agent used correct client closing",
			"Agent submitted escalation in system when required (Auto-Fail)","Agent was not rude or inappropriate? (Auto-Fail)", "Agent used incorrect client name during the call (Auto-Fail)","Agent did not demonstrate call avoidance (Auto-Fail)","Agent properly authenticated the member (Auto-Fail)",
			" Comment 1"," Comment 2"," Comment 3"," Comment 4"," Comment 5"," Comment 6"," Comment 7"," Comment 8"," Comment 9"," Comment 10"," Comment 11"," Comment 12"," Comment 13"," Comment 14"," Comment 15"," Comment 16"," Comment 17"," Comment 18"," Comment 19"," Comment 20"," Comment 21"," Comment 22"," Comment 23"," Comment 24"," Comment 25"," Comment 26","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='ica'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "Audit Type", "VOC","File No","Process Name", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Customer Score","Business Score","Compliance Score","Possible Score","Earned Score", "Overall Score",
			"Agent greeted the member used correct client opening introduced themselves and continued following the basic scripting to open the call", "Agent properly authenticated the member", "Did Agent attempt to update Email/SMS/IVR/Phone Number?", "Agent gave Health Care Activity info Correctly", "Agent collected Health Care Activity information correctly", "Agent gave correct Gift Card information", "Agent offered to provide information on the Health Care Activities that the member has remaining to complete", "Agent provided online self-service information", "Agent used correct transfer procedure", "Agent logged call correctly in all appropriate systems", "Agent followed script guidelines", "Agent gave correct and complete information", "Agent resolved all questions and concerns", "Agent displayed active listening skills and probed for details effectively","Agent effectively engaged with the caller","Agent displayed a polite/appropriate tone", "Agent sounded confident and knowledgeable", "Agent did not interrupt or talk over the customer","Agent used pleasing words and phrases","Agent maintained call control","Agent offered additional assistance", "Agent used correct client closing", "Agent used correct grammar avoided slang", "Agent submitted escalation in system when required (Auto-Fail)", "Agent was not rude or inappropriate? (Auto-Fail)", "Agent used the correct client name during the call (Auto-Fail)","Agent did not demonstrate call avoidance (Auto-Fail)","Agent properly authenticated the member","The agent received direct appreciation from the member","Is the recording quality acceptable? (Tracking)" ,"Would play this for the client? (Tracking)",
			"Agent greeted the member used correct client opening introduced themselves and continued following the basic scripting to open the call Comment", "Agent properly authenticated the member Comment", "Did Agent attempt to update Email/SMS/IVR/Phone Number? Comment", "Agent gave Health Care Activity info Correctly Comment", "Agent collected Health Care Activity information correctly Comment", "Agent gave correct Gift Card information Comment", "Agent offered to provide information on the Health Care Activities that the member has remaining to complete Comment", "Agent provided online self-service information Comment", "Agent used correct transfer procedure Comment", "Agent logged call correctly in all appropriate systems Comment", "Agent followed script guidelines Comment", "Agent gave correct and complete information Comment", "Agent resolved all questions and concerns Comment", "Agent displayed active listening skills and probed for details effectively Comment","Agent effectively engaged with the caller Comment","Agent displayed a polite/appropriate tone Comment", "Agent sounded confident and knowledgeable Comment", "Agent did not interrupt or talk over the customer Comment","Agent used pleasing words and phrases Comment","Agent maintained call control Comment","Agent offered additional assistance Comment", "Agent used correct client closing Comment", "Agent used correct grammar avoided slang Comment", "Agent submitted escalation in system when required (Auto-Fail) Comment", "Agent was not rude or inappropriate? (Auto-Fail) Comment", "Agent used the correct client name during the call (Auto-Fail) Comment","Agent did not demonstrate call avoidance (Auto-Fail) Comment","Agent properly authenticated the member Comment","The agent received direct appreciation from the member Comment","Is the recording quality acceptable? (Tracking) Comment" ,"Would play this for the client? (Tracking) Comment",
			"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='qpc'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Unprepared to Introduce Call", "Did Not Use Branding", "Data Not Collected or Collected Incorrectly", "Second Data Occurrence", "Inaccurate Call Result Code", "Inappropriate or Unusable After-Call Comments", "Underutilized Call Narration", "Inappropriate FAQ Responses", "No or Improper Transitions", "Under-Acknowledged Caller's Concerns", "Inappropriate Script Navigation", "Did Not Display Ownership", "Incorrect Transfer or Referral", "***Did the agent abruptly end the call or display any rude behavior?", "***Did the agent answer premium/cover questions?", "***Did the agent give a wrong callback or referral number?", "***Did the agent use an incorrect carrier name?", "Open/Close Comment 1.1", "Open/Close Comment 1.2", "Data Accuracy Comment 2.1", "Data Accuracy Comment 2.2", "Data Accuracy Comment 2.3", "Data Accuracy Comment 2.4", "Active Listening Comment 3.1", "Active Listening Comment 3.2", "Customer Experience Comment 4.1", "Customer Experience Comment 4.2", "Customer Experience Comment 4.3", "Customer Experience Comment 4.4", "Customer Experience Comment 4.5", "Auto-Fail Comment 5.1", "Auto-Fail Comment 5.2", "Auto-Fail Comment 5.3", "Auto-Fail Comment 5.4", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='ancient_nutrition'){
			$controller = "qa_ameridial";
		    $edit_url = "mgnt_ancient_nutrition_rvw";
		    $main_url =  $currentURL.''.$controller.'/'.$edit_url;
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the customer promptly and properly?", "1.2 Did the rep use a pleasant respectful tone and use the callers name at least once?", "1.3 Did the rep answer in a timely manner?", "2.1 Did the rep collect and verify the callers information appropriately and accurately?", "2.2 Did the rep cover the payment procedures appropriately?", "3.1 Did the rep use active listening skills throughout the inquiry so the caller did not have to repeat themselves?", "3.2 Did the rep demonstrate use of call control techniques?", "3.3 Did the rep refrain from interrupting the caller?", "4.1 Did the rep speak clearly and concisely and at an appropriate pace?", "4.2 Did the rep avoid use of internal terms technical terms slang and jargon?", "4.3 Did the rep demonstrate confidence in responses?", "4.4 Did the rep use the callers last name to personalize the call at least once per section?", "4.5 Did the rep minimize silences and use fillers to obtain additional information?", "5.1 Did the rep cover the Auto Shipping appropriately?", "5.2 If rep gathered email did they read the complete email scripting?", "5.3 Did the rep cover the Rush Shipping appropriately?", "5.4 Did the rep complete order confirmation?", "5.5 Did the rep maintain call control?", "5.6 Did the rep use the tools appropriately?", "5.7 Did the rep demonstrate knowledge of the product/program?", "5.8 Did the rep use the appropriate objection responses?", "6.1 Did the rep accurately and completely document the call?", "6.2 Did the rep complete the correct confirmation and closing?", "6.3 Did the rep thank the caller before closing?", "7.1 ***Did the rep attempt give Medical Advice to the caller?", "7.2 ***Did the rep cover the upsell appropriately?", "7.3 ***Did the agent read the confirmation script if email address was obtained?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Authentication Comment 2.1", "Authentication Comment 2.2", "Listening Skills Comment 3.1", "Listening Skills Comment 3.2", "Listening Skills Comment 3.3", "Soft Skills Comment 4.1", "Soft Skills Comment 4.2", "Soft Skills Comment 4.3", "Soft Skills Comment 4.4", "Soft Skills Comment 4.5", "Knowledge Procedure& Call Flow Comment 5.1", "Knowledge Procedure& Call Flow Comment 5.2", "Knowledge Procedure& Call Flow Comment 5.3", "Knowledge Procedure& Call Flow Comment 5.4", "Knowledge Procedure& Call Flow Comment 5.5", "Knowledge Procedure& Call Flow Comment 5.6", "Knowledge Procedure& Call Flow Comment 5.7", "Knowledge Procedure& Call Flow Comment 5.8", "Closing Comment 6.1", "Closing Comment 6.2", "Closing Comment 6.3", "Auto-Fail Comment 7.1", "Auto-Fail Comment 7.2", "Auto-Fail Comment 7.3", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='sabal'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did the agent ask for the individual by Mr. or Mrs. Last Name?", "Did the agent introduce him/herself?", "Did the agent state he/she is a Customer Service Specialist for WellCare?", "Did the agent apologize for the unannounced phone call and state reason for the call?", "Did the agent ask how the individuals Rx plan is currently working for him/her and respond with the appropriate scripted response?", "Did the agent read the listed examples of benefits they could add? Comprehensive Dental i)Complete Vision ii)Extensive Hearing iii)Transportation iv)Free membership to fitness centers and some even come with a free Fitbit!", "Did the agent ask for the individuals red white and blue card and explain why this was needed?", "Did the agent ask for the individuals updated Medicare ID and accurately record the inforamtion?", "Did the agent ask for the individuals Part A effective date and accurately record the information?", "Did the agent use correct rebuttal is individual doesnt want to give ID over the phone?", "Did the agent use scripting if the individual wants to know the cost to him/her?", "Did the agent use correct rebuttal if the agent says he/she is not interested?", "***Did the agent abruptly end the call or display any rude behavior?", "***Did the agent become argumentative with the individual?", "***Did the agent record the incorrect Medicare members information?", "***Did agent provide any false or misleading information?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Call Flow Comment 2.1", "Call Flow Comment 2.2", "Call Flow Comment 2.3", "Data Collection Comment 3.1", "Data Collection Comment 3.2", "Data Collection Comment 3.3", "Rebuttals Comment 4.1", "Rebuttals Comment 4.2", "Rebuttals Comment 4.3", "Auto-Fail Comment 5.1", "Auto-Fail Comment 5.2", "Auto-Fail Comment 5.3", "Auto-Fail Comment 5.4", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='curative'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the customer promptly and properly?", "1.2 Did the rep use a pleasant respectful tone?", "1.3 Did the rep answer in a timely manner? (within 5 seconds)", "2.1 Did the rep collect and verify the customers information appropriately and accurately?", "2.2 Did the rep verify patients PHI (name email phone number address email address DOB) is entered correctly in Patient Portal?", "2.3 Did the agent accurately send the email regarding correct use of all PHI?", "2.4 Did the agent escalate to Tier 2 when necessary? (Helpscout ticket tag Tier 2 Escalation) Test Cancelled", "2.5 Did the agent respect the patients privacy and provide results only to the verified caller?", "2.6 Did the agent ensure the email address was correct prior to sending the email message and only send to the verified caller?", "3.1 Did the agent speak clearly concisely and at an appropriate pace?", "3.2 Did the agent avoid use of internal terms technical terms slang and jargon on the call and in email?", "3.3 Did the agent demonstrate a strong use of empathy in responses where required on the call and in email?", "3.4 Did the agent use please and thank you throughout the call and in email communication?", "3.5 Did the agent minimize extended silences throughout the call?", "3.6 Did the agent speak with sincere warmth in his/her voice?", "3.7 Did the agent use correct sentence structure and grammar in email commumnication?", "3.8 Did the agent demonstrate patience with the caller?", "3.9 Did the caller give the agent a KUDOS or express happiness with the rep?", "4.1 Did the rep accurately and completely document the call?", "4.2 Did the rep complete the correct confirmation and closing?", "4.3 Did the rep thank the caller before closing?", "4.4 Did the agent provide accurate results?", "4.5 Did the rep anticipate the caller's needs?", "4.6 Did the rep do everything possible to assist the caller?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "AutoFail Comment 2.1", "AutoFail Comment 2.2", "AutoFail Comment 2.3", "AutoFail Comment 2.4", "AutoFail Comment 2.5", "AutoFail Comment 2.6", "Soft Skills Comment 3.1", "Soft Skills Comment 3.2", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5", "Soft Skills Comment 3.6", "Soft Skills Comment 3.7", "Soft Skills Comment 3.8", "Soft Skills Comment 3.9", "Closing Comment 4.1", "Closing Comment 4.2", "Closing Comment 4.3", "Closing Comment 4.4", "Closing Comment 4.5", "Closing Comment 4.6", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='powerfan'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Was the agent Prepared for call answer within 5 seconds", "Did the agent identify self and the company?", "Collects intro information Claim code zip code", "Main Sell agent accurately gave terms of offer asks for sale per script quanity", "Did the agent promote upsell downsell asks for sale per script", "Accurately Described Product answered", "Used appropriate Objection Handling", "Asks for billing Name as it appears on cc or check", "If billing name is different than caller agent verified caller is an authorized user of the cc or check", "Asks for billing address for payment method used", "Agent verifies shipping address", "Order was set up and or coded correctly", "Asks for email address spelling and gave email disclaimer", "Gave total amount charged payment information", "Gave correct shipping information", "Gave MBG return info in", "Gave CS phone number", "Asks for permission to authorize payment cc or check", "Was the agent polite courteous and patient", "Agent refrained from using inappropriate comments presentation", "Uses hold and transfers properly", "Auto Fail", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='nuwave'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Order ID", "Call Duration", "Interaction", "Call Type", "Can be Automated", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greeting & Identification: Example Thank you for calling NuWave", "Asked and Verified Customer Information: May I please have your Order ID Primary name or e-mail address?", "Used the Callers Name: CSR should address the customer as he/she addresses him/herself Mr. Mrs. Dr. Rev. etc.", "Active Listening: Doesnt interrupt the customer understands customers frame of reference doesnt anticipate or make assumptions", "Communication Skills: Converses in a clear concise manner", "Professionalism: Avoids the use of slang jargon and acronyms", "Empathy Towards Customer: CSR sounds sincere about helping the customer and apologizes", "Courtesy: CSR sounds helpful upbeat friendly and patient", "Put On Hold: Asked customer May I put you on hold or Could you hold while I research this further please?", "Thanked Customer for Holding: CSR thanked customer for holding upon returning to customers call", "Hold Time/Reason Appropriate/Inappropriate: Was it really necessary for the CSR to put the customer on hold?", "Escalation/Referral Procedures: Utilized established guidelines and procedures policy from the leadership team", "Fact Finding: Used probing questions and resources to identify problem", "Verbally Verified Problem Reported: Clearly defined and restated needs reported by the customer", "Managed Customer Expectations: Regarding the order of the product and the shipping time", "Explained: Reason for troubleshooting for possible resolution", "Used Available Resources Well: Referred to knowledge training or other resource programs for order troubleshooting", "Complete & Accurate Customer Documentation: Complete description of the order and or the troubleshooting steps", "Trial Close: Confirmed customer is comfortable with outcome", "Additional Needs Uncovered: CSR asked Is there anything else that I can assist you with today?", "Upsale: Ask customer if the product completely serves their needs", "Used Correct Closing Gave Customer Order Number: Mr. Ms. Mrs. I would like to thank you for ordering with NuWave", "Infractions", "Sub-Infractions", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='delta_iowa'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call ID", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Answered the call promptly (within 5 seconds)", "1.2 Opens the call properly obtains caller name", "1.3 Verifies all identifying information to continue the call", "2.1 Adhered to HIPAA/PCI guidelines depending on the type of call", "2.2 Adhered to Client Policies & Procedures", "2.3 Performed the correct actions for the caller", "2.4 Set approriate expectations", "2.5 Gave accurate and complete information", "2.6 Routed issue to the appropriate department", "2.7 Completed all necessary documentation", "3.1 Used courtesy phrases like please and thank you throughout the call", "3.2 Used the caller's name at least once during the call", "3.3 Followed acceptable hold and transfer procedures", "3.4 Allowed the caller to state the reason for the call", "3.5 Avoided the use of jargon acronyms and slang", "3.6 Allowed the caller to speak without interruption", "3.7 Explained all positives of the plan-type without pushing the caller to purchase", "3.8 Stated a willingness to help the caller usually at the beginning of the call", "3.9 Gained agreement with the caller on the proposed solution", "3.10 Demonstrated an empathetic manner professional tone", "4.1 Closed call by offering further assistance", "4.2 Resolved and followed through on all actions to resolve the customers issue", "4.3 Assured customer their concern will be handled to resolution when possible", "4.4 Made an effective attempt to handle a difficult situation", "*** Agent disconnects customer inappropriately", "*** Agent transfers customer without notifying customer", "*** Agent uses offensive words or profanity", "*** Agent was antagonistic talked back or talked down to caller", "*** Agent discloses confidential information inappropriately", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Call Handling Comment 2.1", "Call Handling Comment 2.2", "Call Handling Comment 2.3", "Call Handling Comment 2.4", "Call Handling Comment 2.5", "Call Handling Comment 2.6", "Call Handling Comment 2.7", "Soft Skills Comment 3.1", "Soft Skills Comment 3.2", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5", "Soft Skills Comment 3.6", "Soft Skills Comment 3.7", "Soft Skills Comment 3.8", "Soft Skills Comment 3.9", "Soft Skills Comment 3.10", "Closing Comment 4.1", "Closing Comment 4.2", "Closing Comment 4.3", "Closing Comment 4.4", "Auto Fail Comment 1.1", "Auto Fail Comment 1.2", "Auto Fail Comment 1.3", "Auto Fail Comment 1.4", "Auto Fail Comment 1.5", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='airmethod'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the customer promptly and properly?", "1.2 Did the rep use a pleasant respectful tone?", "1.3 Did the rep answer in a timely manner? (within 5 seconds)", "2.1 Did the rep collect and verify the customers information appropriately and accurately?", "2.2 Did the rep correctly collect callers work location and store phone number if available?", "2.3 Did the agent correctly define Type of Case?", "2.4 Did the rep correctly mark the Date of Test and Expected Results?", "2.5 Did the rep Contact Trace and ensure this case was/was not connected to any others?", "3.1 Did the agent speak clearly concisely and at an appropriate pace?", "3.3 Did the agent demonstrate a strong use of empathy in responses where required on the call and in email?", "3.4 Did the agent use please and thank you throughout the call and in email communication?", "3.5 Did the agent minimize extended silences throughout the call?", "3.6 Did the agent speak with sincere warmth in his/her voice?", "3.7 Did the agent use correct sentence structure and grammar in email communication?", "3.8 Did the agent demonstrate patience with the caller on call and in email communication?", "3.9 Did the caller give the agent a KUDOS or express happiness with the rep during this call?", "4.1 Did the rep accurately and completely document the call?", "4.2 Did the rep complete the correct confirmation and closing?", "4.3 Did the rep provide the correct instructions based upon the Type of Case?", "4.4 Did the rep do everything provide clear concise direction on isolation or quarantine?", "4.5 Did the rep make appropriate contact to the individual managers departments and Supervisors when required", "Greeting Comment 1.1", "Greeting Comment 1.2", "Greeting Comment 1.3", "Data Collection/Case Details Comment 2.1", "Data Collection/Case Details Comment 2.2", "Data Collection/Case Details Comment 2.3", "Data Collection/Case Details Comment 2.4", "Data Collection/Case Details Comment 2.5", "Soft Skills Comment 3.1", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5", "Soft Skills Comment 3.6", "Soft Skills Comment 3.7", "Soft Skills Comment 3.8", "Soft Skills Comment 3.9", "Status/Condition Comment 4.1", "Status/Condition Comment 4.2", "Status/Condition Comment 4.3", "Status/Condition Comment 4.4", "Status/Condition Comment 4.5", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='airmethod_email'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the agent use appropriate letter structure for all guidance letters and emails?", "1.2 Did the agent accurately send the email regarding correct use of all client processes (for all situations)?", "1.3 Did the agent verify there are no duplicates in Reliance prior to beginning a case?","1.4 Did the agent enter all details into Reliance thoroughly and accurately?","1.5 Did the agent use an accurate response with correct guidance?","1.6 Did the agent respect the patient's privacy and provide results only to the verified recipient?  (ensure the email was sent only to the correct party)", "2.1 Did the agent avoid use of internal terms, technical terms, slang and jargon on the call and in email?", "2.2 Did the agent demonstrate a strong use of empathy in responses where required on the call and in email (as needed)?", "2.3 Did the agent use please and thank you throughout the email communication?", "2.4 Did the agent use correct sentence structure and grammar in email communication?", "2.5 Did the agent demonstrate patience with the caller in email communication? (is the agent using the correctly provided verbiage)", "3.1 Did the agent email the correct email group on all responses?", "3.2 Did the agent leave the case open until all updates have been received?", "3.3 Did the agent accurately record all data questionnaire feedback into Reliance?", "3.4 Did the agent provide timely feedback to any and all emails received?","Comment1","Comment2","Comment3","Comment4","Comment5","Comment6","Comment7","Comment8","Comment9","Comment10","Comment11","Comment12","Comment13","Comment14","Comment15","Comment16","Comment17","Comment18", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
		}else if($pid=='foodsaver'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the caller promptly and properly with the correct scripted greeting?", "1.2 Did the rep use a pleasant respectful tone?", "2.1 If the caller said no to the initial offer did the rep use the 1st rebuttal", "2.2 Did the rep also include the 2nd and 3rd points to explain how FoodSaver preserves", "2.3 Did the rep ask the question - Which credit or debit card would you like to use?", "2.4 If the caller said no to this first rebuttal did the rep use the 2nd rebuttal advising of the lowered price at just $99.99 with free shipping and handling?", "2.5 If the caller still said no did the rep advise - We appreciate your call and your interest in FoodSaver", "2.6 Did the rep thank the caller for calling today?", "3.1 Did the rep advise of the 2 Pack of 11 x 16 Rolls at $19.99?", "3.3 Did the rep ask - Would you like to add these to your order and confrim how many they want to add?", "3.4 Did the rep offer Auto Delivery at a 20% savings? ", "3.5 Did the rep ask if the caller would like to add another Food Saver as a gift?", "3.6 Did the rep ask for an email address?", "3.7 Did the rep ask which credit card the caller will be using?", "4.1 Did the rep thank the caller for the order?", "4.2 Did the rep review the order summary and total cost?", "4.3 Did the rep ask if there was anything else we could help with?", "4.4 Did the rep end with a positive statement?", "**Did the rep enter an incorrect credit card number?", "**Did the rep speak rudely to the caller in any way?", "**Did the rep badger the caller?", "**Did the rep disconnect the call without reason?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Rebuttals Comment 2.1", "Rebuttals Comment 2.2", "Rebuttals Comment 2.3", "Rebuttals Comment 2.4", "Rebuttals Comment 2.5", "Rebuttals Comment 2.6", "Yes to offer Comment 3.1", " Comment 3.3", "Yes to offer Comment 3.4", "Yes to offer Comment 3.5", "Yes to offer Comment 3.6", "Yes to offer Comment 3.7", "Closure Comment 4.1", "Closure Comment 4.2", "Closure Comment 4.3", "Closure Comment 4.4", "Auto Fail Comment 1.1", "Auto Fail Comment 1.2", "Auto Fail Comment 1.3", "Auto Fail Comment 1.4", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='sas'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Earn Score","Possible Score","Overall Score", "1.1 Did the rep greet the customer promptly?","Greeting Comment 1.1", "1.2 Did the rep use the proper scripting for the Greeting?", "Greeting Comment 1.2","2.1 Did the agent use any inappropriate language?", "Zero Tolerance Violations Comment 2.1","2.2 Did the agent end the call before completing each required step?","Zero Tolerance Violations Comment 2.2", "2.3 Did the agent attempt to give any medical advice?", "Zero Tolerance Violations Comment 2.3","2.4 Did the agent fail to use mute or hold properly? (There should be no background noise)", "Zero Tolerance Violations Comment 2.4","3.1 Did the agent have a pleasant tone?",  "Call Flow & Soft Skills Comment 3.1", "3.2 Did the agent follow all processes and procedures?","Call Flow & Soft Skills Comment 3.2", "3.3 Did the agent use please and thank you throughout the call?",  "Call Flow & Soft Skills Comment 3.3","3.4 Did the agent schedule the appointment correctly if necessary?", "Call Flow & Soft Skills Comment 3.4","3.5 Did the agent minimize extended silences throughout the call?","Call Flow & Soft Skills Comment 3.5", "3.6 Did the agent answer any and all questions the caller had effectively?",  "Call Flow & Soft Skills Comment 3.6","3.7 Did the agent verify the callers information?","Call Flow & Soft Skills Comment 3.7", "3.8 Did the agent use the callers name at least once during the call?", "Call Flow & Soft Skills Comment 3.8","4.1 Did the agent close correctly by thanking the caller?",  "Closing Comment 4.1", "4.2 Did the agent document appropriately?","Closing Comment 4.2", "4.3 Did the agent correctly transfer the call (if necessary)?", "Closing Comment 4.3",
			"4.4 Did the agent correctly dispose the call?","Closing Comment 4.4",
			"Compliance Score","Customer Score","Business Score","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='gap'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the customer promptly and properly?", "1.2 Did the rep use a pleasant respectful tone?", "2.1 Did the agent properly identify themselves GAP and the purpose of the call at the beginning of the phone call?", "2.2 Did the agent make all required disclosures during the sales call?", "2.3 Did the agent attempt to alter any customer information", "2.4 Did the agent attempt to obtain any customer information that is not part of GAP enrollment form", "2.5 Did the agent pose as customers to complete TPV or play recorded responses to complete TPV?", "2.6 Did the agent use any intimidation or undue pressure with the customer?", "2.7 Did the agent contact customers that are on the Internal DNC list?", "2.8 Did the agent fail to disposition a call as Do Not Call when a customer states they do not want to be contacted?", "2.9 Did the agent have any Call Center Violations?", "2.10 Did the agent have any Misrepresentation/Deception?", "2.11 Did the agent suggest that customer is required to choose a competitive energy supplier", "2.12 Did the agent represent that the rate guarantees savings?", "3.1 Did the agent must make clear that he/she does not work for", "3.2 Did the agent properly disclose the rate/kWh and the 0.50 cent daily fee?", "3.3 Did the agent disclose the 36-month term and the term during which the rate/kWh is fixed?", "3.4 Did the agent explain that the customer may rescind the contract within 3 business days of receipt", "3.5 Did the agent minimize extended silences throughout the call?", "3.6 Did the agent explain that the customer may cancel the agreement at any time without penalty by calling Great American Power at 1-877-215-4140?", "3.7 Did the agent explain that after the sales call the customer will be sent an electronic copy of the T&Cs", "3.8 Did the agent demonstrate patience with the caller on call and in email communication?", "4.1 Did the agent advise that the verification representative is NOT AUTHORIZED to answer any questions?", "4.2 Did the agent ask if there were any questions he/she could answer before transferring to the verifier?", "4.3 Did the agent ask if the caller could please hold while he/she gets the verifier on the line?", "4.4 Did the agent correctly transfer the call?", "Greeting Comment 1.1", "Greeting Comment 1.2", "Zero Tolerance Violations Comment 2.1", "Zero Tolerance Violations Comment 2.2", "Zero Tolerance Violations Comment 2.3", "Zero Tolerance Violations Comment 2.4", "Zero Tolerance Violations Comment 2.5", "Zero Tolerance Violations Comment 2.6", "Zero Tolerance Violations Comment 2.7", "Zero Tolerance Violations Comment 2.8", "Zero Tolerance Violations Comment 2.9", "Zero Tolerance Violations Comment 2.10", "Zero Tolerance Violations Comment 2.11", "Zero Tolerance Violations Comment 2.12", "Call Flow & Soft Skills Comment 3.1", "Call Flow & Soft Skills Comment 3.2", "Call Flow & Soft Skills Comment 3.3", "Call Flow & Soft Skills Comment 3.4", "Call Flow & Soft Skills Comment 3.5", "Call Flow & Soft Skills Comment 3.6", "Call Flow & Soft Skills Comment 3.7", "Call Flow & Soft Skills Comment 3.8", "Closing Comment 4.1", "Closing Comment 4.2", "Closing Comment 4.3", "Closing Comment 4.4", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='suarez'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "This call was a/an", "Account Identifiers", "Date of Coaching/Copy Received", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did you answer the call promptly and sound ready to take the call?", "Was your introduction clear and free of excess Unacceptableise and distraction?", "Did you use the correct greeting?", "Did you smile and sound friendly and happy to take the customer call?", "Was the drop code captured correctly?", "Did you adhere to the script correctly and follow the appropriate decision points?", "Did you ask for and verify all information correctly?", "Did you read all disclaimers and special Unacceptabletes offered in the script?", "Did you complete the call properly?", "Did you sound confident about the product and/or offer?", "Were all required upsells offered correctly?", "Did you go above and beyond the requirements to obtain a sale additional units or additional upsell opportunity?", "Additional units or additional upsell opportunity?", "Did you control the call without excessive chatting and Unacceptablen-business conversation?", "Did you lose a sale?", "Did you appropriately answer the customer questions and make every effort to satisfy the customer and the purpose of the call?", "Did the customer have your full attention?/ were you listening while the customer was speaking?", "Were you heard interrupting the customer raising your voice or using an unfriendly or unprofessional tone?", "What is the Specialist impression of customer temperature at the END of the call?", "Was there a Unacceptableticeable change in customer temperature during the call?", "Did you use hold times appropriately in regard to this call?", "Was the order keyed correctly?", "Was there anything regarding this customer account or experience that you missed?", "On this call was it obvious that you use your down time to study products promotions and procedures?", "Were you heard saying anything negative or unprofessional in regard to this call on or off the phone?", "Greeting Comment 1", "Greeting Comment 2", "Greeting Comment 3", "Greeting Comment 4", "Script and Procedure Adherence Comment 1", "Script and Procedure Adherence Comment 2", "Script and Procedure Adherence Comment 3", "Script and Procedure Adherence Comment 4", "Script and Procedure Adherence Comment 5", "Sales Ability Comment 1", "Sales Ability Comment 2", "Sales Ability Comment 3", "Sales Ability Comment 4", "Sales Ability Comment 5", "Sales Ability Comment 6", "Soft Skills Comment 1", "Soft Skills Comment 2", "Soft Skills Comment 3", "Soft Skills Comment 4", "Soft Skills Comment 5", "Additional Details Comment 1", "Additional Details Comment 2", "Additional Details Comment 3", "Additional Details Comment 4", "Additional Details Comment 5", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='sfe'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
				"1.1 Did the agent advise who he/she is who he/she is calling from and who he/she represents?","1.2 Did the agent advise the call is being recorded for quality assurance and training purposes?",
				"2.1 Did the agent provide all program benefits including rates explanation and benefits?","2.2 Did the agent ask if he/she was speaking with the account holder?","2.3 Did the agent ask if the caller was receiving any government assistance?","2.4 Did the agent ask for the address and email?","2.5 Did the agent ask if the caller was 18 years or older?",
				"3.1 Did the rep sound confident and polite to the person on the phone?","3.2 Did the agent address the caller by name at least once?","3.3 Did the agent use 'please' and 'thank you' throughout the call?","3.4 Did the agent minimize extended silences throughout the call?","3.5 Did the agent speak clearly?",
				"4.1 Did the agent use the first rebuttal correctly if the caller was not interested?","4.2 Did the agent use the second rebuttal correctly if the caller was not interested?","4.3 Did the agent provide the phone number for call back it the caller was not interested?",
				"5.1 Did the agent advise of the Welcome Package would be sent including the program details and contact information?","5.2 Did the agent ask for the sale and gain a 'yes' before proceeding?","5.3 Did the rep finalize the date for the quote?","5.4 Did the rep take complete detailed notes?",
				"6.1 Did the rep proceed with the call without a firm 'yes'","6.2 Did the rep provide accurate information?","6.3 Did the rep mislead the caller in any way?","6.4 Did the rep advise that he/she uses this service?","6.5 Did the rep advise that he/she uses this service?(need more detail for this)",
				"Greeting Comment 1.1", "Greeting Comment 1.2","Details Comment 2.1", "Details Comment 2.2", "Details Comment 2.3", "Details Comment 2.4","Details Comment 2.5","Soft Skills Comment 3.1", "Soft Skills Comment 3.2", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5","Rebuttls Comment 4.1", "Rebuttls Comment 4.2", "Rebuttls Comment 4.3","Closure Comment 5.1", "Closure Comment 5.2", "Closure Comment 5.3", "Closure Comment 5.4","Auto Fail Comment 6.1", "Auto Fail Comment 6.2", "Auto Fail Comment 6.3", "Auto Fail Comment 6.4","Auto Fail Comment 6.5",
				"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='brightway_ib_bank'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","Overall Score", "Possible Score", "Earned Score","1.  Did the CSR use the approved greeting including Brightway branding name and customer name and policy number and offer assistance?","2. If applicable did rep advise they were on a recorded line?","3. Verified and captured points of contact according to procedure.","1. Did the associate use the appropriate tone pace and professionalism ?","2. Did the associate avoid insurance jargon and used proper grammar throughout the call?","3. Did the associate demonstrate the right level of empathy or sympathy?","4. Did the associate listen carefully to understand and address the customers needs ?","5. Did the associate ask to place the caller on hold set proper time expectations and thank them when returning?","6. The associate maintained call control throughout the call by guiding the conversation to stay on topic","7. There was not any silence dead air or self talking that had a negative impact on the call.","8. All verbal and written information provided by associate to insured and other parties was clear accurate and included all relevant information. (2pts for each)","1. Did the associate ask probing questions and verbally verify the changes requested and information provided?","2. If applicable was the call warm transferred","3. Expectations provided and time frame for follow up if any was met.","4. If the call was disconnected prior to resolution did the CSR attempt to contact the caller back to complete the call?","5. Documented correct policy is AMS","6. Are the notes clear descriptive and fully capture what occurred on the call so others understand what was discussed and if anything additional is needed?","7. Created all activities corresponding with the interaction","8. Were the correct templates used? ","9. Attached all emails fax confirmations and other documents as needed","10. Was the issue or request resolved/completed?","11. Requested all signed documents/supporting documentation when further action is required from the customer. CSR did not request any unnecessary or incorrect documents.","12. CSR offered any possible alternative options or solutions to callers request.","13. Effectively accessed and utilized all appropriate systems and resources.","14. Were all changes made in AMS and/or carrier site ?","15. All associated policies were updated as needed (for example flood and umbrella).","16. Was the appropriate suspense created for follow up if needed?","17. Addressed any service-related suspense items that were open at the time they spoke with the customer.","18. CSR updated any suspense that was addressed during the call and closed if applicable.","19. Was the correct disposition selected","1. Did the CSR provide a wrap-up summary including the CSRs and callers action items?","2. Did the associate offer additional assistance thanked the customer?","1. Bonus Question","1. Was the call an Auto-Fail?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='qpc_esal'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Call ID", "Call Type", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1. Opens the call with a correct introduction", "2. Accurate translation", "3. Provides correct data", "4. Uses correct grammar", "5. Effective communication", "6. Active listening", "7. Avoids long silence gaps", "8. Communicates in a polite and respectful manner", "9. Correctly indicates cannot translate profanity", "10. Closes the call accordingly", "Comment 1", "Comment 2", "Comment 3", "Comment 4", "Comment 5", "Comment 6", "Comment 7", "Comment 8", "Comment 9", "Comment 10", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='pcare_cs'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Location", "Call Date", "Customer Number", "Call Type", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greeting - Welcome to the Company and Identification of Agent", "Customer Identification", "Identifying customer persona", "Opening Question", "Acknowledge Customer Reason For Call/Assurance of help", "Thank you statements", "Asking Permission to propose an agenda", "Getting Permission to proceed", "Proposing an Agenda", "Presenting a Timeframe for the Call", "Getting Permission to proceed", "Identify Challenges", "Historical Impact", "Future State",  "Value Proposition", "1st Retention Attempt", "Tactical Hold", "2nd Retention Attempt", "Complete Confirmation of SuperSaver", "Confirmation Daily Special", "Made offer to save package", "Addition Offers Daily Special", "Verify Customer Information", "Web Login", "Email Capture", "SMS Opt-In", "Documentation", "Thank you Closing Statement", "Agent provided correct information to caller and did not mislead", "Correct Delay Length", "Correctly Used Purity Points", "Soft Skills", "Rapport Building", "Maintaining Call Control", "Listening Comprehension", "***Unauthorized Shipments/Not following up in the database", "***Inappropriate Language/Unprofessional Behavior", "***Badgering/Arguing with Customer", "***Incorrect use of SS Actions", "***No S.S. Confirmation", "***Making Health Claims", "***No Retention Offers Made", "Call Feedback", "Agent Review Date", "Agent Feedback Acceptance", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='ab_commercial'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super","Call Date","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","Overall Score","Correct Subject line","Correct Signature/Billing/ Docusign/Bank fax sent if necessary","Subjectivities mentioned on email","Coverage changes mentioned on email","Correct invoice included","Quote included","Correct edits made","Application/forms included if necessary","DE suspense sent if necessary","Prem increase suspense sent if necessary","Coverage Change suspense sent if necessary","Suspense status updated","Renewal sheet updated","Correct activity entered into AMS with email attached","Correct requirements via Docusign (if appliable)","Email 40% Comment 1","Email 40% Comment 2","Email 40% Comment 3","Email 40% Comment 4","Packet 20% Comment 1","Packet 20% Comment 2","Packet 20% Comment 3","Packet 20% Comment 4","Requirements Met 20% Comment 1","Requirements Met 20% Comment 2","Requirements Met 20% Comment 3","Status Update 20 % Comment 1","Status Update 20 % Comment 2","Status Update 20 % Comment 3","Status Update 20 % Comment 4","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=='mpc'){
			$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Call Duration", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "1.1 Did the rep greet the customer promptly and properly?", "1.2 Did the rep use a pleasant respectful tone?", "2.1 Did the agent properly identify themselves", "2.2 Did the agent advise that the call is being recorded for quality purposes?", "2.3 Did the agent attempt to alter any customer information", "**2.4 Did the agent violate HIPAA in any way?", "3.1 Did the agent speak clearly concisely and at an appropriate pace?", "3.2 Did the agent avoid use of internal terms", "3.3 Did the agent demonstrate a strong use of empathy in responses", "3.4 Did the agent use please and thank you throughout the call", "3.5 Did the agent minimize extended silences throughout the call?", "3.6 Did the agent speak with sincere warmth in his/her voice?", "3.7 Did the agent use correct sentence structure and grammar in email commumnication?", "3.8 Did the agent demonstrate patience with the caller on call and in email communication?", "4.1 Did the agent advise Maryland Medicaid has recently informed us that your MPC HealthChoice benefits", "4.2 Did the agent ask if the caller has recertified for benefits this year?", "4.3 Did the agent provide the MPC Customer Service phone number", "4.4 Did the agent use please and thank you throughout the call?", "4.5 Did the agent transfer to the MD Health Exchange correctly", "4.6 If caller did not want to be transferred, did the agent advise", "5.1 Did the rep accurately and completely document the call?", "5.2 Did the rep complete the correct confirmation and closing?", "5.3 Did the rep thank the caller before closing?", "5.4 Did the rep do everything possible to assist the caller?", "5.5 Did the rep anticipate the caller's needs?",
			"Greeting Comment 1.1", "Greeting Comment 1.2", "Verification Comment 2.1", "Verification Comment 2.2", "Verification Comment 2.3", "Verification Comment 2.4", "Soft Skills Comment 3.1", "Soft Skills Comment 3.2", "Soft Skills Comment 3.3", "Soft Skills Comment 3.4", "Soft Skills Comment 3.5", "Soft Skills Comment 3.6", "Soft Skills Comment 3.7", "Soft Skills Comment 3.8", "Process Flow Comment 4.1", "Process Flow Comment 4.2", "Process Flow Comment 4.4", "Process Flow Comment 4.5", "Process Flow Comment 4.6", "Closing Comment 5.1", "Closing Comment 5.2", "Closing Comment 5.3", "Closing Comment 5.4", "Closing Comment 5.5",
			"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($pid=="cinemark"){
			  $header= Array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time","Interval","QA Score",
			  "1.1 Did the agent greet the customer appropriately?","1.2 Did the agent provide his/her name?","1.3 Did the agent ask how/he or she could assist the caller?","2.1 Did the agent adhere to the refund rules?",
			  "2.2 If the customer asked to speak to a supervisor did we transfer to an internal supervisor?","2.3 Did the agent fill out a ticket properly?","2.4 Did the agent include the theater number?",
			  "2.5 Did the agent leave a correct note?","2.6 Did the agent leave the confirmation number or order number?","2.7 If a Fandango customer called in did the agent supply the correct information?",
			  "2.8 Was the agent able to access customers past transactions (if applicable)?","3.1 Did the agent have an appropriate tone and use please and thank you throughout the call?",
			  "3.2 Did the agent close the call correctly?","4.1 Did the agent complete all necessary tasks correctly?","4.2 Did the agent use any inappropriate language or demean the caller?",
			  "4.3 Did the agent hang up on the caller?","Remarks 1","Remarks 2","Remarks 3","Remarks 4","Remarks 5","Remarks 6","Remarks 7","Remarks 8","Remarks 9","Remarks 10","Remarks 11",
			  "Remarks 12","Remarks 13","Remarks 14","Remarks 15","Remarks 16","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
			  "Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="empire"){
      $header = array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time","Interval","QA Score","Customer Score","Business Score","Compliance Score",
      "1.1 Greet the customer on time (within 5 secs)","1.2 Use of standard greeting","1.3 Open the call with an enthusiastic pleasant tone of voice","2.1 Use courtesy phrases",
      "2.2 Use of customers name appropriately during the call","2.3  Communication skills accent grammar","2.4 Positively represent Empire","2.5 Active listening","2.6  Maintain Call Control/ Dead air exceeded more than 15secs?",
      "3.1 Probe for accurate understanding of customer need","3.2 Restate customer need correctly","3.3 Set expectations","3.4 Ask customer for appointment","4.1 Verify Customer Account",
      "4.2 Confirm All Data","4.3 Provide accurate and complete information","4.4 Demonstrate confidence in the information being conveyed","4.5 Did the agent dispose the call correctly?","4.6 Overcome objections",
      "5.1 Confirm appointment","5.2 Use standard closing","Rude Remarks / Inappropriate Language","Call Avoidance","Remarks 1","Remarks 2","Remarks 3","Remarks 4","Remarks 5","Remarks 6","Remarks 7","Remarks 8","Remarks 9","Remarks 10","Remarks 11",
      "Remarks 12","Remarks 13","Remarks 14","Remarks 15","Remarks 16","Remarks 17","Remarks 18","Remarks 19","Remarks 20","Remarks 21","Remarks 22","Remarks 23","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }elseif ($pid=="hcpss") {
      $header=array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time", "Interval","QA Score",
      "1.1 Did you answer the call promptly and sound ready to take the call?","1.2 Was your introduction clear and free of excess noise and distraction?","1.3 Did you use the correct greeting?",
      "1.4 Did you smile and sound friendly and happy to take the customers call?","2.1 Was the case captured correctly? Close Contact/ Confirmed Positive","2.2 Did you adhere to the script correctly and Capture all the correct information needed?",
      "2.3 Did you ask for and verify all information correctly?","2.4 Did you add all the appropriate notes on the call?","2.5 Did you complete the call properly?","3.1 Did you sound confident about the process?",
      "3.2 Did you go above and beyond the requirements to assure the caller was taken care of?","4.1 Did you appropriately answer the callers questions and make every effort to satisfy the caller and complete your calls purpose?",
      "4.2 Did the caller have your full attention?/ were you actively listening while the caller was speaking?","4.3 Were you heard interrupting the caller raising your voice or using an unfriendly or unprofessional tone or words/Slang (was your email professional as well)",
      "5.1 Did you use hold times appropriately?","5.2 Was the call handled correctly/dipostioned correctly?","5.3 If confirmed Postive did the agent correctly list all the close contacts.",
      "5.4 Were you heard saying anything negative or unprofessional in regard to this call on or off the phone?","Comment 1","Comment 2","Comment 3","Comment 4","Comment 5","Comment 6","Comment 7","Comment 8","Comment 9","Comment 10","Comment 11",
      "Comment 12","Comment 13","Comment 14","Comment 15","Comment 16","Comment 17","Comment 18","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="cmn"){
      $header=array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time", "Interval","QA Score",
      "Opening","Closing","Empathy/Apology","Ownership/Assurance","Tone / Rate of Speech / Fumbling","Active Listening","Interruption / Parallel Conversation","Issue Identification / Understanding","Probing",
      "Mode of Payment confirmation","Refund Processed Correctly","Email ID Verification","Phone Number Verification","ZTP","Comment 1","Comment 2","Comment 3","Comment 4","Comment 5","Comment 6","Comment 7","Comment 8",
      "Comment 9","Comment 10","Comment 11","Comment 12","Comment 13","Comment 14","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="pilgrim"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "Possible Score",
      "Earned Score",
      "Compliance Score",
      "Customer Score",
      "Business Score",
      "Compliance Score Percentage",
      "Customer Score Percentage",
      "Business Score Percentage",
      "QA Score",
      "Did the agent open the call within 5 seconds?",
      "Did the agent give the proper introduction and include their name?",
      "Did the agent explain the offer and/or products?","Did the agent give customer proper responses?","Did the agent correctly probe?",
      "Did the agent disposition the call properly?",
      "Was the agent polite & courteous?",
      "Was the agent ready for the call (minimal dead air)?","Did the agent show energy empathy and enthusiasm?",
      "Did the agent use appropriate tone pacing grammar & pronunciation?",
      "Did the agent show accurate and complete grasp of information?",
      "Did the agent set up Gold Card correctly-ideology",
      "Did the agent properly disengage disruptive/prank caller",
      "Rude Remarks",
      "Call Avoidance / Dumping",
       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="bluebenefits"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "QA Score",
      "Did the rep greet the customer promptly and properly?",
      "Did the rep use a pleasant respectful tone?",
      "Did the rep correctly verify the callers info prior to proceeding with the call? ",
      "Did the rep offer a willingness statement? I d be happy to help you with that etc",
      "Did the rep display a professional manner and refrain from speaking over or interrupting the caller?",
      "Did the rep have any incomplete provider info?",
      "Did the rep incorrectly quote any benefits? ",
      "Did the rep incorrectly quote any copay or coinsurance? Or did they miss the coinsurance copay?",
      "Did the rep incorrectly give CR RC MAB RAA CY or PY?",
      "Did the rep incorrectly quote the deductible?",
      "Did the rep give any other incorrect information or miss any of the following regarding plan Effective Date Frequency Limitation Network OOP Max Precert Pre-X Term Date",
      "Did the rep provide the correct Claims Address when necessary?",
      "Did the rep include all information necessary regarding Medical Necessity?",
      "Did the rep include all details correctly regarding DME coverage when necessary?",
      "Did the agent speak clearly concisely and at an appropriate pace?",
      "Did the agent avoid use of internal terms technical terms slang and jargon on the call and in email?",
      "Did the agent demonstrate a strong use of empathy in responses where required on the call and in email?",
      "Did the agent use please and thank you throughout the call and in email communication?",
      "Did the agent minimize extended silences throughout the call?",
      "Did the agent speak with sincere warmth in his her voice?",
      "Did the agent use correct sentence structure and grammar in email commumnication?",
      "Did the agent demonstrate patience with the caller on call and in email communication?",
      "Did the rep accurately and completely document the call?",
      "Did the rep complete the correct confirmation and closing?",
      "Did the rep thank the caller before closing?",
      "Did the rep do everything possible to assist the caller?",
      "Did the rep anticipate the callers needs?to avoid unecessary callbacks or confusion",


       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Comment 20",
       "Comment 21",
       "Comment 22",
       "Comment 23",
       "Comment 24",
       "Comment 25",
       "Comment 26",
       "Comment 27",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="healthbridge"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "QA Score",
      "Correct Information provided regarding account details benefit information plan etc",
      "Resolved all member concerns or questions.",
      "Added detailed notes to the member account. ",
      "Disposition the call appropriately.",
      "Verified the member's name last 4 SS# DOB and zipcode. ",
      "Used the verification button. ",
      "Followed all company procedures guidelines and policies.",
      "Informed the member of call recording (OUTBOUND ONLY)",
      "Proper Greeting and Closing was used including name company and name. ",
      "Clear communication active listening call control and efficiency was demonstrated throughout the call. ",
      "Proper expectations were set empathetic pleasant voice tone and positive attitude during the call. ",
      "Avoided industry jargon excessive hold time dead air slang interruptions or self talk.",
      "Verified current address preffered phone number and email address. ",
      "If applicable requested payment from member and other family members.",
      "If applicable the member has outstanding balance after payment ask if they would like us to set up a recurring payment.",
      "Did agent present the authorize payment ask before processing",
      "Did agent offer confirmation number",
      "Adhered to HIPAA regulations throughout the entire call.",
      "Used inappropriate tone and language with the member",
      "Did agent repeat card numbers back. ",
      "Call Avoidance",
       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Comment 20",
       "Comment 21",
       "Comment 22",
       "Comment 23",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
	}else if($pid=="healthbridgenew"){
		$header=array("Auditor Name",
		"Audit Date",
		"Call Date",
		"Fusion ID",
		"Agent",
		"L1 Supervisor",
		"Call Duration",
		"File Number",
		"Audit Type",
		"Auditor Type",
		"VOC",
		"Audit Start Date Time",
		"Audit End Date Time",
		"Interval",
		"Earn Score",
		"Possible Score",
		"QA Score",
		"Resolved all member concerns or questions",
		"Added detailed notes to the member account and Jira ticket if needed",
		"Dispositioned the call appropriately",
		"Use of headset during calls",
		"Used the verification button",
		"Followed all company procedures guidelines and policies",
		"Proper Greeting and Closing was used included company name Offered survey to the member.",
		"Clear communication active listening call control and efficiency was demonstrated throughout the call",
		"Proper expectations were set empathetic pleasant voice tone and positive attitude during the call ",
		"Avoided industry jargon excessive hold time dead air slang interruptions or self talk ",
		"If applicable requested payment from member and other family members",
		"If applicable the member has outstanding balance after payment ask if they would like us to set up a recurring payment",
		"Did agent present the authorize payment ask before processing ",
		"Did agent offer confirmation number",
		"Verified the members name last 4 SS# member number DOB and address",
		"Correct Information provided regarding account details benefit information plan etc",
		"Adhered to HIPAA regulations throughout the entire call",
		"Used inappropriate tone and language with the member",
		"Call Avoidance",
		 "Comment 1",
		 "Comment 2",
		 "Comment 3",
		 "Comment 4",
		 "Comment 5",
		 "Comment 6",
		 "Comment 7",
		 "Comment 8",
		 "Comment 9",
		 "Comment 10",
		 "Comment 11",
		 "Comment 12",
		 "Comment 13",
		 "Comment 14",
		 "Comment 15",
		 "Comment 16",
		 "Comment 17",
		 "Comment 18",
		 "Comment 19",
		 "Comment 20",
		 "Call Summary",
		 "Feedback",
		 "Agent Feedback Acceptance",
		 "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="mcKinsey"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "L1 Supervisor",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "QA Score",
      "Did the rep greet the caller properly? ",
      "Did the rep use a pleasant respectful tone?",
      "Did the rep answer in a timely manner? (within 5 seconds) ",
      "Did the rep collect and verify the customers information appropriately and accurately? ",
      "Did the agent correctly define Type of Case? ",
      "Did the rep correctly mark all required dates and data? ",
      "Did the rep Contact Trace and ensure this case was/was not connected to any others, and report if cleaning was required?",
      "Did the agent speak clearly concisely and at an appropriate pace?",
      "Did the agent demonstrate a strong use of empathy in responses where required on the call and in email? ",
      "Did the agent use please and thank you throughout the call and in email communication? ",
      "Did the agent minimize extended silences throughout the call? ",
      "Did the agent speak with sincere warmth in his/her voice?",
      "Did the agent use correct sentence structure and grammar in email communication? ",
      "Did the agent demonstrate patience with the caller on call and in email communication?",
      "Did the rep accurately and completely document the call?",
      "Did the rep complete the correct confirmation and closing?",
      "Did the rep provide the correct instructions based upon the Type of Case? ",
      "Did the rep do everything provide clear concise direction on isolation or quarantine?",
      "Did the rep make appropriate contact to the individual managers departments and Supervisors when required and/or email any requested files and Guidance Letters?",
       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="compliance"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "L1 Supervisor",
      "Call Duration",
      "File Number",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Interval",
      "QA Score",
      "Compliance Status",
      "Issue Type",
      "Reason",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="affinity"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "QA Score",
      "Did the agent verify the patient's name date of birth and ID number? ",
      "Did the agent verify the Provider's ID number?",
      "Did the agent adhere to the approved call opening greeting ?",
      "Did the agent adhere to the approved call closing script? ",
      "Did the agent adhere to the approved hold script? ",
      "Did the agent adhere to the approved transfer script? ",
      "Did the agent acknowledge the caller and their needs?   ",
      "Did the agent listen to the caller without interruptions?",
      "Did the agent sound clear confident friendly polite and welcoming Displayed empathy?",
      "Did the CRP determine if this was a repeat call and review the history of the issue for the caller? ",
      "Did the agent keep the caller informed of his her actions?",
      "Did the agent refrain from using jargon or acronyms?  ",
      "Did the agent demonstrate control of the call and prevented escalations?",
      "Did the agent use the caller's name at least once during the call? ",
      "Did the agent attempt to resolve the caller's issue without needing to escalate the call?",
      "Did the agent offer the most accurate/up to date information?",
      "Did the agent offer detailed information/all possible solutions?",
      "Did the agent use all available resources/tools to assist the caller? ",
      "Did the agent document the customer/contact information?",
      "Did the agent use the most appropriate subject/category codes?",
      "Did the agent document the call in detail including inquiry details and resolution?",
      "Did the agent accurately route the inquiry to the appropriate party/group?",
      "Did the agent upload the verbal request form in UMK2?",
      "Did the agent take time at the beginning of the call to finish noting the previous call?",
       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Comment 20",
       "Comment 21",
       "Comment 22",
       "Comment 23",
       "Comment 24",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="affinity_pro"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "Actual Disposition",
      "Customer Contact Number","LOB","State","Member/Provider",
      "QA Score",
      "Appropriately allowed customer to express their feelings and expressed sincere and appropriate empathy",
      "Enthusiastic smiled and displayed a positive helpful tone throughout the call",
      "Demonstrated courteous and professional demeanor at all times while personalizing call as appropriate",
      "Displayed a high level of confidence and demonstrated a can do attitude at all times",
      "Actively listened avoided interruptions maintained control acknowledged all of the callers concerns and guided call towards a logical resolution",
      "Spoke clearly at an appropriate pace and was easily understood used appropriate positive word choices phrases and avoided technical jargon",
      "Remained focused and avoided unexplained dead air and was able to multi-task when appropriate",
      "Agent is prepared for the call and followed correct opening",
      "Followed correct closing and exited call in a timely manner",
      "Utilized correct hold and/or mute procedure",
      "Utilized correct transfer procedure",
      "Successfully verified HIPAA and verified caller is authorized",
      "Verified demographic & PCP information on file as appropriate handled HEDIS alert correctly",
      "Promoted Self Service options whenever appropriate",
      "Erroneously referred member to Regulatory Agencies",
      "Avoided assumptions confirmed understanding of the issue by asking open and/or closed questions correctly identified issue to be resolved and reviewed notes/history appropriately",
      "Escalated the call appropriately or as requested by the caller",
      "FCR - Exhausted all available options by utilizing tools/resources/staff effectively to successfully resolve all of the callers concerns",
      "Provided complete and accurate information answered questions directly and set clear expectations on next steps",
      "Clearly and accurately documented account ",
      "Did the agent correctly identify as an Appeal?",
      "Did the agent correctly identify as a Grievance?",
      "Did the agent correctly code the call?",
      "Wow call the agent went the extra step and did the right thing and the call could be used for training",
       "Pharmacy Related Call",
       "DSNP Member",
       "Comment 1",
       "Comment 2",
       "Comment 3",
       "Comment 4",
       "Comment 5",
       "Comment 6",
       "Comment 7",
       "Comment 8",
       "Comment 9",
       "Comment 10",
       "Comment 11",
       "Comment 12",
       "Comment 13",
       "Comment 14",
       "Comment 15",
       "Comment 16",
       "Comment 17",
       "Comment 18",
       "Comment 19",
       "Comment 20",
       "Comment 21",
       "Comment 22",
       "Comment 23",
       "Comment 24",
       "Comment 25",
       "Comment 26",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }
    else if($pid=="cci_medicare"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "Audit Type",
      "Auditor Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "QA Score",
      "Call Opening",
      "Prepared for Call",
      "Serving with Empathy - Active Listening",
      "Serving with Empathy - Empathy",
      "Serving with Empathy - Positive Tone",
      "Serving with Empathy - Positive Language/Speaking Human",
      "Address Caller by Name",
      "Was the Call Documented - Category/Subcategory",
      "Was the Call Documented - Referral Second Case",
      "Documentation-Comments",
      "Entities Linked/Documented",
      "Hold Policy",
      "Dead Air",
      "Hold Verbiage",
      "Appropriate Transfer",
      "Accessed Appropriate Systems  ",
      "Misc. Policies & Procedures",
      "Timeframes ",
      "Offers Internal/External Telephone",
      "Offer Additional Assistance ",
      "Offer Survey Appropriately",
      "Thanks Member for Calling Branded Entity  ",
      "Information Accuracy",
      "Completeness",
      "Actions",
      "Validate for Understanding",
      "Privacy Compliance",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="cci_commercial"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "QA Score",
      "Call Opening",
      "Prepared for Call",
      "Serving with Empathy - Active Listening",
      "Serving with Empathy - Empathy",
      "Serving with Empathy - Positive Tone",
      "Serving with Empathy - Positive Language/Speaking Human",
      "Address Caller by Name",
      "Was the Call Documented - Category/Subcategory",
      "Was the Call Documented - Creating of second case",
      "Documentation-Comments",
      "Entities Linked/Documented",
      "Hold Policy",
      "Dead Air",
      "Hold Verbiage",
      "Appropriate Transfer",
      "Accessed Appropriate Systems  ",
      "Misc. Policies & Procedures",
      "Timeframes ",
      "Offers Internal/External Telephone",
      "Offer Additional Assistance ",
      "Offer Survey Appropriately",
      "Thanks Member for Calling Branded Entity  ",
      "Information Accuracy",
      "Completeness",
      "Actions",
      "Validate for Understanding",
      "Privacy Compliance",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="lockheed"){
      $header=array("Auditor Name",
      "Audit Date",
      "Call Date",
      "Fusion ID",
      "Agent",
      "Call Duration",
      "Audit Type",
      "VOC",
      "Audit Start Date Time",
      "Audit End Date Time",
      "QA Score",
      "Opening Script",
      "Did CSR demonstrate a good tone of voice throughout the call?",
      "Did CSR properly verify account & make appropriate updates if necessary?",
      "Did CSR deliver assurance statement after purpose?",
      "Did CSR followed proper follow up process?",
      "Did CSR followed follow up script?",
      "Personable/friendly/ polite?",
      "Did CSR demonstrate active listening skills?",
      "Proper use of probing questions?",
      "Did CSR validated Close Contacts?",
      "Did CSR initiated cleaning process?",
      "Did CSR Reviewed Vaccination Record?",
      "Did CSR corrected CT Dates?",
      "Did CSR use all available systems and tools?",
      "Did CSR provide complete and accurate information?",
      "Additional Case Mgmt Required?",
      "Did CSR used Template for comments",
      "Did CSR Marked CT Complete?",
       "Call Summary",
       "Feedback",
       "Agent Feedback Acceptance",
      "Agent review note","Agent review date","Mgnt review date","Mgnt review by","Mgnt review note");
    }else if($pid=="ways2well"){
    	$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call ID", "Call Duration", "Campaign", "Phone Number", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Customer score","Business score","Compliance score",
		 "Call Opening: Agent Name and Brand Name", "Confirm the Members First Name", "Use the appropriate scripting", "Greeting for inbound: answered within 5 seconds", "Serving with Empathy - Active Listening", "Serving with Empathy - Positive Tone", "Serving with Empathy - Positive Language/ Rapport Building", "Acknowledgements timely and effectively", "Pace of Speech", "Did the agent used effective engagement", "Address Caller by Name", "Did not Interrupt the caller", "Did the agent used correct USP (unique selling point) for retention", "Asked probing questions effectively or timely", "Hold Policy (60 Seconds)",
		 "Dead Air","Hold Verbiage","Accomplish the resolution accurately and completely","Performed follow-up steps","Answered the caller inquiries","Read out Policies & Procedures","Offers Internal/External Telephone","Verify the Members Full Name/ DOB/ Address/ and Phone Number (All 4)","Offer Additional Assistance","Thanks Member for Calling or taking the time to speak with us","Was the Call Documented appropriately","Unprofessionalism","Critical Error",
		 "Call Opening: Agent Name and Brand Name Remarks", "Confirm the Members First Name Remarks", "Use the appropriate scripting Remarks", "Greeting for inbound: answered within 5 seconds Remarks", "Serving with Empathy - Active Listening Remarks", "Serving with Empathy - Positive Tone Remarks", "Serving with Empathy - Positive Language/ Rapport Building Remarks", "Acknowledgements timely and effectively Remarks", "Pace of Speech Remarks", "Did the agent used effective engagement Remarks", "Address Caller by Name Remarks", "Did not Interrupt the caller Remarks", "Did the agent used correct USP (unique selling point) for retention Remarks", "Asked probing questions effectively or timely Remarks", "Hold Policy (60 Seconds) Remarks",
		 "Dead Air Remarks","Hold Verbiage Remarks","Accomplish the resolution accurately and completely Remarks","Performed follow-up steps Remarks","Answered the caller inquiries Remarks","Read out Policies & Procedures Remarks","Offers Internal/External Telephone Remarks","Verify the Members Full Name/ DOB/Address/ and Phone Number (All 4) Remarks","Offer Additional Assistance Remarks","Thanks Member for Calling or taking the time to speak with us Remarks","Was the Call Documented appropriately Remarks","Unprofessionalism Remarks","Critical Error Remarks",
		 "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
    }else if($pid=="kenny_u_pull"){
    	$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call ID", "Call Duration", "Call Type", "case", "Audit Type", "VOC","Site/Location", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score",
		 "Introducing Self", "Introducing Brand Name", "Greets the customer in a courteous manner", "Is the car complete?", "The Deductions", "Negotiation", "Accessibility  Snow removal (Winter period)", "Expected Price", "Branch Selection", "Phone Number and Postal Code", "File opening", "Vehicle identification Number(NIV  VIN)", "Mileage", "Aesthetic Conditions", "Mechanical Condition", "Towing Address",
		 "Customer Drops off his Vehicle (Drop-Off)","Active Listening","Interruption","Tone of Voice (from greeting to closing)","Hold & Dead air","Ending the call","Confirmation Phone Number","Address Confirmation","Confirmation of the tow date/time","Process after purchase","Process Adherence","Rude Remarks","Call Avoidance",
		  "Introducing Self Remarks", "Introducing Brand-Name Remarks", "Greets the customer in a courteous manner Remarks", "Is the car complete? Remarks", "The Deductions Remarks", "Negotiation Remarks", "Accessibility  Snow removal (Winter period) Remarks", "Expected Price Remarks", "Branch Selection Remarks", "Phone Number and Postal Code Remarks", "File opening Remarks", "Vehicle identification Number(NIV  VIN)Remarks", "Mileage Remarks", "Aesthetic Conditions Remarks", "Mechanical Condition Remarks", "Towing Address Remarks","Customer Drops off his Vehicle (Drop-Off) Remarks","Active Listening Remarks","Interruption Remarks","Tone of Voice (from greeting to closing) Remarks","Hold & Dead air Remarks","Ending the call Remarks","Confirmation Phone Number Remarks","Address Confirmation Remarks","Confirmation of the tow date/time Remarks","Process after purchase Remarks","Process Adherence Remarks","Rude Remarks Remarks","Call Avoidance Remarks",
		 "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
    }


		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($pid=='brightway_prescreen_new'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';


                $row .= '"'.$user['phone'].'",';
                $row .= '"'.$user['file_no'].'",';
                $row .= '"'.$user['filler'].'",';

                $row .= '"'.$user['site'].'",';
                $row .= '"'.$user['area_code'].'",';
                $row .= '"'.$user['call_duration'].'",';

				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';

				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';

				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'",';

                //$row .= '"'.$user['transfer_to'].'",';

                $row .= '"'.$user['appropriate_greeting'].'",';
                $row .= '"'.$user['pre_screen_template'].'",';
                $row .= '"'.$user['csr_disposition'].'",';
                $row .= '"'.$user['appropriate_soft_skills'].'",';
                $row .= '"'.$user['csr_use_the_proper'].'",';
                $row .= '"'.$user['csr_transfer_correct'].'",';
                $row .= '"'.$user['appropriately_authenticated'].'",';
                $row .= '"'.$user['experience_any_audio'].'",';
                $row .= '"'.$user['verified_and_change'].'",';

                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}

			fclose($fopen);

		}else if($pid=='kenny_u_pull'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['case'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['site_location'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['introducing_self'].'",';
				$row .= '"'.$user['brand_name'].'",';
				$row .= '"'.$user['greet_customer'].'",';
				$row .= '"'.$user['car_complete'].'",';
				$row .= '"'.$user['the_deduction'].'",';
				$row .= '"'.$user['negotiation'].'",';
				$row .= '"'.$user['accessibility'].'",';
				$row .= '"'.$user['expected_price'].'",';
				$row .= '"'.$user['branch_selection'].'",';
				$row .= '"'.$user['postal_card'].'",';
				$row .= '"'.$user['file_opening'].'",';
				$row .= '"'.$user['vehicle_identification'].'",';
				$row .= '"'.$user['mileage'].'",';
				$row .= '"'.$user['aesthetic_conditions'].'",';
				$row .= '"'.$user['mechanical_condition'].'",';
				$row .= '"'.$user['towing_address'].'",';
				$row .= '"'.$user['drop_off'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['interruption'].'",';
				$row .= '"'.$user['tone_voice'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['ending_call'].'",';
				$row .= '"'.$user['confirm_phone'].'",';
				$row .= '"'.$user['confirm_address'].'",';
				$row .= '"'.$user['confirm_date_time'].'",';
				$row .= '"'.$user['purchase_process'].'",';
				$row .= '"'.$user['adherence_process'].'",';
				$row .= '"'.$user['rude_behaviour'].'",';
				$row .= '"'.$user['call_avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($pid=='ways2well'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$interrupt_caller =  $user['interrupt_caller'];
				$dead_air = $user['dead_air'];

				if($interrupt_caller== 'Yes'){
					$interrupt_caller = 'No';
				}
				if($interrupt_caller== 'No'){
					$interrupt_caller = 'Yes';
				}

				if($dead_air== 'Yes'){
					$dead_air = 'No';
				}
				if($dead_air== 'No'){
					$dead_air = 'Yes';
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['phone_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['customer_score'].'%'.'",';
				$row .= '"'.$user['business_score'].'%'.'",';
				$row .= '"'.$user['compliance_score'].'%'.'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['confirm_first_name'].'",';
				$row .= '"'.$user['appropriate_scripting'].'",';
				$row .= '"'.$user['greetings_inbound'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['positive_tone'].'",';
				$row .= '"'.$user['positive_language'].'",';
				$row .= '"'.$user['effective_time'].'",';
				$row .= '"'.$user['pace_speech'].'",';
				$row .= '"'.$user['effective_management'].'",';
				$row .= '"'.$user['address_caller'].'",';
				$row .= '"'.$interrupt_caller.'",';
				$row .= '"'.$user['correct_retension'].'",';
				$row .= '"'.$user['probing_questions'].'",';
				$row .= '"'.$user['hold_policy'].'",';
				$row .= '"'.$dead_air.'",';
				$row .= '"'.$user['hold_verbiage'].'",';
				$row .= '"'.$user['accomplish_resolution'].'",';
				$row .= '"'.$user['followup_steps'].'",';
				$row .= '"'.$user['answered_caller'].'",';
				$row .= '"'.$user['policies_procedures'].'",';
				$row .= '"'.$user['offers_telephone'].'",';
				$row .= '"'.$user['verify_members'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['thanks_member'].'",';
				$row .= '"'.$user['call_documentated'].'",';
				$row .= '"'.$user['unprofessionalism'].'",';
				$row .= '"'.$user['critical_error'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($pid=='brightway_evaluation_new') {

            foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
                $row .= '"'.$user['phone'].'",';
                $row .= '"'.$user['file_no'].'",';
                $row .= '"'.$user['filler'].'",';
                $row .= '"'.$user['site'].'",';
                $row .= '"'.$user['area_code'].'",';
                $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'",';

                $row .= '"'.$user['appropriate_greeting_including'].'",';
                $row .= '"'.$user['confirm_and_capture'].'",';
                $row .= '"'.$user['csr_advise_they'].'",';
                $row .= '"'.$user['csr_professional_appropriate'].'",';
                $row .= '"'.$user['csr_demonstrate_emapthy'].'",';
                $row .= '"'.$user['csr_actively_listen'].'",';
                $row .= '"'.$user['csr_probing_questions'].'",';
                $row .= '"'.$user['csr_follow_appropriate'].'",';
                $row .= '"'.$user['csr_maintain_call'].'",';
                $row .= '"'.$user['csr_provide_accurate'].'",';
                $row .= '"'.$user['call_was_transferred'].'",';
                $row .= '"'.$user['csr_attempt_callback'].'",';
                $row .= '"'.$user['csr_connect_activities'].'",';
                $row .= '"'.$user['csr_document_correctly'].'",';
                $row .= '"'.$user['include_all_attachments'].'",';
                $row .= '"'.$user['csr_successfully_resolve'].'",';
                $row .= '"'.$user['csr_access_effectively'].'",';
                $row .= '"'.$user['renewal_payment'].'",';
                $row .= '"'.$user['agent_experience'].'",';
                $row .= '"'.$user['offer_additional_assistance'].'",';
                $row .= '"'.$user['concluding_the_call'].'",';
                $row .= '"'.$user['customer_adversely'].'",';
                $row .= '"'.$user['additional_adverse'].'",';

                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';
                $row .= '"'.$user['cmt22'].'",';
                $row .= '"'.$user['cmt23'].'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='ab_commercial'){
		foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['correct_subject'].'",';
				$row .= '"'.$user['correct_signature'].'",';
				$row .= '"'.$user['subjectivities'].'",';
				$row .= '"'.$user['coverage_changes'].'",';
				$row .= '"'.$user['correct_invoice'].'",';
				$row .= '"'.$user['quote_included'].'",';
				$row .= '"'.$user['correct_edits_made'].'",';
				$row .= '"'.$user['application_forms'].'",';
				$row .= '"'.$user['de_suspense_sent'].'",';
				$row .= '"'.$user['prem_increase_suspense'].'",';
				$row .= '"'.$user['coverage_change'].'",';
				$row .= '"'.$user['suspense_status'].'",';
				$row .= '"'.$user['renewal_sheet'].'",';
				$row .= '"'.$user['correct_activity'].'",';
				$row .= '"'.$user['correct_requirements'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		} else if($pid=='fortunebuilder'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['callans5sec'].'",';
				$row .= '"'.$user['agentintro'].'",';
				$row .= '"'.$user['agentadvise'].'",';
				$row .= '"'.$user['agentgreeting'].'",';
				$row .= '"'.$user['agentzip'].'",';
				$row .= '"'.$user['verifycaller'].'",';
				$row .= '"'.$user['calleremail'].'",';
				$row .= '"'.$user['agentseminar'].'",';
				$row .= '"'.$user['agentphone'].'",';
				$row .= '"'.$user['callerreminder'].'",';
				$row .= '"'.$user['agentsummerize'].'",';
				$row .= '"'.$user['registerguest'].'",';
				$row .= '"'.$user['verifyguest'].'",';
				$row .= '"'.$user['agentdemonstrate'].'",';
				$row .= '"'.$user['appropiategrammer'].'",';
				$row .= '"'.$user['goodpacing'].'",';
				$row .= '"'.$user['agentdisplay'].'",';
				$row .= '"'.$user['callcontrol'].'",';
				$row .= '"'.$user['agentclosing'].'",';
				$row .= '"'.$user['correctdisposition'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='xyz'){
			echo "User";
			foreach($rr as $user){
			$row = '"'.$user['phone1'].'",';
				$row .= '"'.$user['name'].'",';
				$row .= '"'.$user['email'].'",';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='purity_free_bottle'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['can_automated'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_type_lob'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['customer_prompt'].'",';
				$row .= '"'.$user['soft_skills'].'",';
				$row .= '"'.$user['customer_information'].'",';
				$row .= '"'.$user['super_saver_offer'].'",';
				$row .= '"'.$user['upsell'].'",';
				$row .= '"'.$user['payment_procedure'].'",';
				$row .= '"'.$user['knowledge_of_product'].'",';
				$row .= '"'.$user['call_control'].'",';
				$row .= '"'.$user['faq'].'",';
				$row .= '"'.$user['objection_response'].'",';
				$row .= '"'.$user['personalize_the_call'].'",';
				$row .= '"'.$user['correct_confirmation'].'",';
				$row .= '"'.$user['cost_of_delivery'].'",';
				$row .= '"'.$user['misrepresentation'].'",';
				$row .= '"'.$user['dnc_response'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='purity_catalog'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['proper_greeting'].'",';
				$row .= '"'.$user['customer_first_name_address_verification'].'",';
				$row .= '"'.$user['identified_type_of_account'].'",';
				$row .= '"'.$user['properly_transfer_account'].'",';
				$row .= '"'.$user['accurate_note_taken'].'",';
				$row .= '"'.$user['correct_information_given'].'",';
				$row .= '"'.$user['proper_terminology'].'",';
				$row .= '"'.$user['free_gift_scripting'].'",';
				$row .= '"'.$user['bulk_offer'].'",';
				$row .= '"'.$user['super_saver_offer_explained_correctly'].'",';
				$row .= '"'.$user['additional_product_offered'].'",';
				$row .= '"'.$user['order_placed_properly'].'",';
				$row .= '"'.$user['order_confirmation'].'",';
				$row .= '"'.$user['user_tool_faq'].'",';
				$row .= '"'.$user['address_verification_at_confirmation'].'",';
				$row .= '"'.$user['credit_card_verification'].'",';
				$row .= '"'.$user['attemp_to_gather_cvv_code'].'",';
				$row .= '"'.$user['daily_special_offer'].'",';
				$row .= '"'.$user['product_offered_with_daily_special'].'",';
				$row .= '"'.$user['thank_you_statement'].'",';
				$row .= '"'.$user['maintained_call_control'].'",';
				$row .= '"'.$user['response_time'].'",';
				$row .= '"'.$user['used_proper_hold_techniques'].'",';
				$row .= '"'.$user['good_attitude'].'",';
				$row .= '"'.$user['energy_attentiveness'].'",';
				$row .= '"'.$user['context_related_response'].'",';
				$row .= '"'.$user['empathy_respectfulness'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='purity_care'){
			foreach($rr as $user){
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_one_call_duration'].'",';
				$row .= '"'.$user['call_one_file_no'].'",';
				$row .= '"'.$user['call_two_call_duration'].'",';
				$row .= '"'.$user['call_two_file_no'].'",';
				//$row .= '"'.$user['call_two_voc'].'",';
				$row .= '"'.$user['call_three_call_duration'].'",';
				$row .= '"'.$user['call_three_file_no'].'",';
				//$row .= '"'.$user['call_three_voc'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_one_proper_introduction'].'",';
				$row .= '"'.$user['call_two_proper_introduction'].'",';
				$row .= '"'.$user['call_three_proper_introduction'].'",';
				$row .= '"'.$user['review_proper_introduction'].'",';
				$row .= '"'.$user['score_proper_introduction'].'",';
				$row .= '"'.$user['call_one_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['call_two_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['call_three_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['review_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['score_cust_fname_addrs_verification'].'",';
				$row .= '"'.$user['call_one_opening_question'].'",';
				$row .= '"'.$user['call_two_opening_question'].'",';
				$row .= '"'.$user['call_three_opening_question'].'",';
				$row .= '"'.$user['review_opening_question'].'",';
				$row .= '"'.$user['score_opening_question'].'",';
				$row .= '"'.$user['call_one_accurate_note'].'",';
				$row .= '"'.$user['call_two_accurate_note'].'",';
				$row .= '"'.$user['call_three_accurate_note'].'",';
				$row .= '"'.$user['review_accurate_note'].'",';
				$row .= '"'.$user['score_accurate_note'].'",';
				$row .= '"'.$user['call_one_correct_reason'].'",';
				$row .= '"'.$user['call_two_correct_reason'].'",';
				$row .= '"'.$user['call_three_correct_reason'].'",';
				$row .= '"'.$user['review_correct_reason'].'",';
				$row .= '"'.$user['score_correct_reason'].'",';
				$row .= '"'.$user['call_one_correct_information_given'].'",';
				$row .= '"'.$user['call_two_correct_information_given'].'",';
				$row .= '"'.$user['call_three_correct_information_given'].'",';
				$row .= '"'.$user['review_correct_information_given'].'",';
				$row .= '"'.$user['score_correct_information_given'].'",';
				$row .= '"'.$user['call_one_proper_terminology'].'",';
				$row .= '"'.$user['call_two_proper_terminology'].'",';
				$row .= '"'.$user['call_three_proper_terminology'].'",';
				$row .= '"'.$user['review_proper_terminology'].'",';
				$row .= '"'.$user['score_proper_terminology'].'",';
				$row .= '"'.$user['call_one_proper_inquiry'].'",';
				$row .= '"'.$user['call_two_proper_inquiry'].'",';
				$row .= '"'.$user['call_three_proper_inquiry'].'",';
				$row .= '"'.$user['review_proper_inquiry'].'",';
				$row .= '"'.$user['score_company_promotion'].'",';
				$row .= '"'.$user['call_one_company_promotion'].'",';
				$row .= '"'.$user['call_two_company_promotion'].'",';
				$row .= '"'.$user['call_three_company_promotion'].'",';
				$row .= '"'.$user['review_company_promotion'].'",';
				$row .= '"'.$user['score_company_promotion'].'",';
				$row .= '"'.$user['call_one_correct_use_of_action'].'",';
				$row .= '"'.$user['call_two_correct_use_of_action'].'",';
				$row .= '"'.$user['call_three_correct_use_of_action'].'",';
				$row .= '"'.$user['review_correct_use_of_action'].'",';
				$row .= '"'.$user['score_correct_use_of_action'].'",';
				$row .= '"'.$user['call_one_database_follow_up'].'",';
				$row .= '"'.$user['call_two_database_follow_up'].'",';
				$row .= '"'.$user['call_three_database_follow_up'].'",';
				$row .= '"'.$user['review_database_follow_up'].'",';
				$row .= '"'.$user['score_database_follow_up'].'",';
				$row .= '"'.$user['call_one_product_promotion'].'",';
				$row .= '"'.$user['call_two_product_promotion'].'",';
				$row .= '"'.$user['call_three_product_promotion'].'",';
				$row .= '"'.$user['review_product_promotion'].'",';
				$row .= '"'.$user['score_product_promotion'].'",';
				$row .= '"'.$user['call_one_reason_for_cancel'].'",';
				$row .= '"'.$user['call_two_reason_for_cancel'].'",';
				$row .= '"'.$user['call_three_reason_for_cancel'].'",';
				$row .= '"'.$user['review_reason_for_cancel'].'",';
				$row .= '"'.$user['score_reason_for_cancel'].'",';
				$row .= '"'.$user['call_one_legimate_sequence_offer'].'",';
				$row .= '"'.$user['call_two_legimate_sequence_offer'].'",';
				$row .= '"'.$user['call_three_legimate_sequence_offer'].'",';
				$row .= '"'.$user['review_legimate_sequence_offer'].'",';
				$row .= '"'.$user['score_legimate_sequence_offer'].'",';
				$row .= '"'.$user['call_one_first_retention_offer'].'",';
				$row .= '"'.$user['call_two_first_retention_offer'].'",';
				$row .= '"'.$user['call_three_first_retention_offer'].'",';
				$row .= '"'.$user['review_first_retention_offer'].'",';
				$row .= '"'.$user['score_first_retention_offer'].'",';
				$row .= '"'.$user['call_one_second_retention_offer'].'",';
				$row .= '"'.$user['call_two_second_retention_offer'].'",';
				$row .= '"'.$user['call_three_second_retention_offer'].'",';
				$row .= '"'.$user['review_second_retention_offer'].'",';
				$row .= '"'.$user['score_second_retention_offer'].'",';
				$row .= '"'.$user['call_one_valid_delay'].'",';
				$row .= '"'.$user['call_two_valid_delay'].'",';
				$row .= '"'.$user['call_three_valid_delay'].'",';
				$row .= '"'.$user['review_valid_delay'].'",';
				$row .= '"'.$user['score_valid_delay'].'",';
				$row .= '"'.$user['call_one_preserved_avg_unit'].'",';
				$row .= '"'.$user['call_two_preserved_avg_unit'].'",';
				$row .= '"'.$user['call_three_preserved_avg_unit'].'",';
				$row .= '"'.$user['review_preserved_avg_unit'].'",';
				$row .= '"'.$user['score_preserved_avg_unit'].'",';
				$row .= '"'.$user['call_one_proper_confirmation'].'",';
				$row .= '"'.$user['call_two_proper_confirmation'].'",';
				$row .= '"'.$user['call_three_proper_confirmation'].'",';
				$row .= '"'.$user['review_proper_confirmation'].'",';
				$row .= '"'.$user['score_proper_confirmation'].'",';
				$row .= '"'.$user['call_one_daily_special_offer'].'",';
				$row .= '"'.$user['call_two_daily_special_offer'].'",';
				$row .= '"'.$user['call_three_daily_special_offer'].'",';
				$row .= '"'.$user['review_daily_special_offer'].'",';
				$row .= '"'.$user['score_daily_special_offer'].'",';
				$row .= '"'.$user['call_one_anything_else'].'",';
				$row .= '"'.$user['call_two_anything_else'].'",';
				$row .= '"'.$user['call_three_anything_else'].'",';
				$row .= '"'.$user['review_anything_else'].'",';
				$row .= '"'.$user['score_anything_else'].'",';
				$row .= '"'.$user['call_one_thank_you'].'",';
				$row .= '"'.$user['call_two_thank_you'].'",';
				$row .= '"'.$user['call_three_thank_you'].'",';
				$row .= '"'.$user['review_thank_you'].'",';
				$row .= '"'.$user['score_thank_you'].'",';
				$row .= '"'.$user['call_one_mantained_call'].'",';
				$row .= '"'.$user['call_two_mantained_call'].'",';
				$row .= '"'.$user['call_three_mantained_call'].'",';
				$row .= '"'.$user['review_mantained_call'].'",';
				$row .= '"'.$user['score_mantained_call'].'",';
				$row .= '"'.$user['call_one_response_time'].'",';
				$row .= '"'.$user['call_two_response_time'].'",';
				$row .= '"'.$user['call_three_response_time'].'",';
				$row .= '"'.$user['review_response_time'].'",';
				$row .= '"'.$user['score_response_time'].'",';
				$row .= '"'.$user['call_one_proper_hold_technique'].'",';
				$row .= '"'.$user['call_two_proper_hold_technique'].'",';
				$row .= '"'.$user['call_three_proper_hold_technique'].'",';
				$row .= '"'.$user['review_proper_hold_technique'].'",';
				$row .= '"'.$user['score_proper_hold_technique'].'",';
				$row .= '"'.$user['call_one_good_attitude'].'",';
				$row .= '"'.$user['call_two_good_attitude'].'",';
				$row .= '"'.$user['call_three_good_attitude'].'",';
				$row .= '"'.$user['review_good_attitude'].'",';
				$row .= '"'.$user['score_good_attitude'].'",';
				$row .= '"'.$user['call_one_attentiveness'].'",';
				$row .= '"'.$user['call_two_attentiveness'].'",';
				$row .= '"'.$user['call_three_attentiveness'].'",';
				$row .= '"'.$user['review_attentiveness'].'",';
				$row .= '"'.$user['score_attentiveness'].'",';
				$row .= '"'.$user['call_one_context_related_response'].'",';
				$row .= '"'.$user['call_two_context_related_response'].'",';
				$row .= '"'.$user['call_three_context_related_response'].'",';
				$row .= '"'.$user['review_context_related_response'].'",';
				$row .= '"'.$user['score_context_related_response'].'",';
				$row .= '"'.$user['call_one_empathy'].'",';
				$row .= '"'.$user['call_two_empathy'].'",';
				$row .= '"'.$user['call_three_empathy'].'",';
				$row .= '"'.$user['review_empathy'].'",';
				$row .= '"'.$user['score_empathy'].'",';
				$row .= '"'.$user['call_one_badgering'].'",';
				$row .= '"'.$user['call_two_badgering'].'",';
				$row .= '"'.$user['call_three_badgering'].'",';
				$row .= '"'.$user['review_badgering'].'",';
				$row .= '"'.$user['score_badgering'].'",';
				$row .= '"'.$user['call_one_avg_call'].'",';
				$row .= '"'.$user['call_two_avg_call'].'",';
				$row .= '"'.$user['call_three_avg_call'].'",';
				$row .= '"'.$user['review_avg_call'].'",';
				$row .= '"'.$user['score_avg_call'].'",';
				$row .= '"'.$user['call_one_avg_save'].'",';
				$row .= '"'.$user['call_two_avg_save'].'",';
				$row .= '"'.$user['call_three_avg_save'].'",';
				$row .= '"'.$user['review_avg_save'].'",';
				$row .= '"'.$user['score_avg_save'].'",';
				$row .= '"'.$user['call_one_avg_call_length'].'",';
				$row .= '"'.$user['call_two_avg_call_length'].'",';
				$row .= '"'.$user['call_three_avg_call_length'].'",';
				$row .= '"'.$user['review_avg_call_length'].'",';
				$row .= '"'.$user['score_avg_call_length'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='puritycare_new'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['call_date1'].'",';
				$row .= '"'.$user['call_date2'].'",';
				$row .= '"'.$user['call_date3'].'",';
				$row .= '"'.$user['call_date4'].'",';
				$row .= '"'.$user['call_date5'].'",';
				$row .= '"'.$user['file_no1'].'",';
				$row .= '"'.$user['file_no2'].'",';
				$row .= '"'.$user['file_no3'].'",';
				$row .= '"'.$user['file_no4'].'",';
				$row .= '"'.$user['file_no5'].'",';
				$row .= '"'.$user['call_duration1'].'",';
				$row .= '"'.$user['call_duration2'].'",';
				$row .= '"'.$user['call_duration3'].'",';
				$row .= '"'.$user['call_duration4'].'",';
				$row .= '"'.$user['call_duration5'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['voc1'].'",';
				$row .= '"'.$user['voc2'].'",';
				$row .= '"'.$user['voc3'].'",';
				$row .= '"'.$user['voc4'].'",';
				$row .= '"'.$user['voc5'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_identification_call1'].'",';
				$row .= '"'.$user['agent_identification_call2'].'",';
				$row .= '"'.$user['agent_identification_call3'].'",';
				$row .= '"'.$user['agent_identification_call4'].'",';
				$row .= '"'.$user['agent_identification_call5'].'",';
				$row .= '"'.$user['customer_identification_call1'].'",';
				$row .= '"'.$user['customer_identification_call2'].'",';
				$row .= '"'.$user['customer_identification_call3'].'",';
				$row .= '"'.$user['customer_identification_call4'].'",';
				$row .= '"'.$user['customer_identification_call5'].'",';
				$row .= '"'.$user['customer_verification_call1'].'",';
				$row .= '"'.$user['customer_verification_call2'].'",';
				$row .= '"'.$user['customer_verification_call3'].'",';
				$row .= '"'.$user['customer_verification_call4'].'",';
				$row .= '"'.$user['customer_verification_call5'].'",';
				$row .= '"'.$user['opening_question_call1'].'",';
				$row .= '"'.$user['opening_question_call2'].'",';
				$row .= '"'.$user['opening_question_call3'].'",';
				$row .= '"'.$user['opening_question_call4'].'",';
				$row .= '"'.$user['opening_question_call5'].'",';
				$row .= '"'.$user['identify_reason_call1'].'",';
				$row .= '"'.$user['identify_reason_call2'].'",';
				$row .= '"'.$user['identify_reason_call3'].'",';
				$row .= '"'.$user['identify_reason_call4'].'",';
				$row .= '"'.$user['identify_reason_call5'].'",';
				$row .= '"'.$user['acknowledge_responce_call1'].'",';
				$row .= '"'.$user['acknowledge_responce_call2'].'",';
				$row .= '"'.$user['acknowledge_responce_call3'].'",';
				$row .= '"'.$user['acknowledge_responce_call4'].'",';
				$row .= '"'.$user['acknowledge_responce_call5'].'",';
				$row .= '"'.$user['inquiry_probing_call1'].'",';
				$row .= '"'.$user['inquiry_probing_call2'].'",';
				$row .= '"'.$user['inquiry_probing_call3'].'",';
				$row .= '"'.$user['inquiry_probing_call4'].'",';
				$row .= '"'.$user['inquiry_probing_call5'].'",';
				$row .= '"'.$user['value_proposition_call1'].'",';
				$row .= '"'.$user['value_proposition_call2'].'",';
				$row .= '"'.$user['value_proposition_call3'].'",';
				$row .= '"'.$user['value_proposition_call4'].'",';
				$row .= '"'.$user['value_proposition_call5'].'",';
				$row .= '"'.$user['1st_retention_call1'].'",';
				$row .= '"'.$user['1st_retention_call2'].'",';
				$row .= '"'.$user['1st_retention_call3'].'",';
				$row .= '"'.$user['1st_retention_call4'].'",';
				$row .= '"'.$user['1st_retention_call5'].'",';
				$row .= '"'.$user['tactical_hold_call1'].'",';
				$row .= '"'.$user['tactical_hold_call2'].'",';
				$row .= '"'.$user['tactical_hold_call3'].'",';
				$row .= '"'.$user['tactical_hold_call4'].'",';
				$row .= '"'.$user['tactical_hold_call5'].'",';
				$row .= '"'.$user['2nd_retention_call1'].'",';
				$row .= '"'.$user['2nd_retention_call2'].'",';
				$row .= '"'.$user['2nd_retention_call3'].'",';
				$row .= '"'.$user['2nd_retention_call4'].'",';
				$row .= '"'.$user['2nd_retention_call5'].'",';
				$row .= '"'.$user['delay_length_call1'].'",';
				$row .= '"'.$user['delay_length_call2'].'",';
				$row .= '"'.$user['delay_length_call3'].'",';
				$row .= '"'.$user['delay_length_call4'].'",';
				$row .= '"'.$user['delay_length_call5'].'",';
				$row .= '"'.$user['supersaver_call1'].'",';
				$row .= '"'.$user['supersaver_call2'].'",';
				$row .= '"'.$user['supersaver_call3'].'",';
				$row .= '"'.$user['supersaver_call4'].'",';
				$row .= '"'.$user['supersaver_call5'].'",';
				$row .= '"'.$user['daily_special_call1'].'",';
				$row .= '"'.$user['daily_special_call2'].'",';
				$row .= '"'.$user['daily_special_call3'].'",';
				$row .= '"'.$user['daily_special_call4'].'",';
				$row .= '"'.$user['daily_special_call5'].'",';
				$row .= '"'.$user['closing_statement_call1'].'",';
				$row .= '"'.$user['closing_statement_call2'].'",';
				$row .= '"'.$user['closing_statement_call3'].'",';
				$row .= '"'.$user['closing_statement_call4'].'",';
				$row .= '"'.$user['closing_statement_call5'].'",';
				$row .= '"'.$user['full_conf_call1'].'",';
				$row .= '"'.$user['full_conf_call2'].'",';
				$row .= '"'.$user['full_conf_call3'].'",';
				$row .= '"'.$user['full_conf_call4'].'",';
				$row .= '"'.$user['full_conf_call5'].'",';
				$row .= '"'.$user['made_offer_call1'].'",';
				$row .= '"'.$user['made_offer_call2'].'",';
				$row .= '"'.$user['made_offer_call3'].'",';
				$row .= '"'.$user['made_offer_call4'].'",';
				$row .= '"'.$user['made_offer_call5'].'",';
				$row .= '"'.$user['web_login_call1'].'",';
				$row .= '"'.$user['web_login_call2'].'",';
				$row .= '"'.$user['web_login_call3'].'",';
				$row .= '"'.$user['web_login_call4'].'",';
				$row .= '"'.$user['web_login_call5'].'",';
				$row .= '"'.$user['email_capture_call1'].'",';
				$row .= '"'.$user['email_capture_call2'].'",';
				$row .= '"'.$user['email_capture_call3'].'",';
				$row .= '"'.$user['email_capture_call4'].'",';
				$row .= '"'.$user['email_capture_call5'].'",';
				$row .= '"'.$user['sms_opt_call1'].'",';
				$row .= '"'.$user['sms_opt_call2'].'",';
				$row .= '"'.$user['sms_opt_call3'].'",';
				$row .= '"'.$user['sms_opt_call4'].'",';
				$row .= '"'.$user['sms_opt_call5'].'",';
				$row .= '"'.$user['reason_code_call1'].'",';
				$row .= '"'.$user['reason_code_call2'].'",';
				$row .= '"'.$user['reason_code_call3'].'",';
				$row .= '"'.$user['reason_code_call4'].'",';
				$row .= '"'.$user['reason_code_call5'].'",';
				$row .= '"'.$user['used_purity_call1'].'",';
				$row .= '"'.$user['used_purity_call2'].'",';
				$row .= '"'.$user['used_purity_call3'].'",';
				$row .= '"'.$user['used_purity_call4'].'",';
				$row .= '"'.$user['used_purity_call5'].'",';
				$row .= '"'.$user['information_accuracy_call1'].'",';
				$row .= '"'.$user['information_accuracy_call2'].'",';
				$row .= '"'.$user['information_accuracy_call3'].'",';
				$row .= '"'.$user['information_accuracy_call4'].'",';
				$row .= '"'.$user['information_accuracy_call5'].'",';
				$row .= '"'.$user['soft_skill_call1'].'",';
				$row .= '"'.$user['soft_skill_call2'].'",';
				$row .= '"'.$user['soft_skill_call3'].'",';
				$row .= '"'.$user['soft_skill_call4'].'",';
				$row .= '"'.$user['soft_skill_call5'].'",';
				$row .= '"'.$user['rapport_call1'].'",';
				$row .= '"'.$user['rapport_call2'].'",';
				$row .= '"'.$user['rapport_call3'].'",';
				$row .= '"'.$user['rapport_call4'].'",';
				$row .= '"'.$user['rapport_call5'].'",';
				$row .= '"'.$user['call_control_call1'].'",';
				$row .= '"'.$user['call_control_call2'].'",';
				$row .= '"'.$user['call_control_call3'].'",';
				$row .= '"'.$user['call_control_call4'].'",';
				$row .= '"'.$user['call_control_call5'].'",';
				$row .= '"'.$user['unauthorized_shipment_call1'].'",';
				$row .= '"'.$user['unauthorized_shipment_call2'].'",';
				$row .= '"'.$user['unauthorized_shipment_call3'].'",';
				$row .= '"'.$user['unauthorized_shipment_call4'].'",';
				$row .= '"'.$user['unauthorized_shipment_call5'].'",';
				$row .= '"'.$user['inappropiate_language_call1'].'",';
				$row .= '"'.$user['inappropiate_language_call2'].'",';
				$row .= '"'.$user['inappropiate_language_call3'].'",';
				$row .= '"'.$user['inappropiate_language_call4'].'",';
				$row .= '"'.$user['inappropiate_language_call5'].'",';
				/*$row .= '"'.$user['hanging_up_call1'].'",';
				$row .= '"'.$user['hanging_up_call2'].'",';
				$row .= '"'.$user['hanging_up_call3'].'",';
				$row .= '"'.$user['hanging_up_call4'].'",';
				$row .= '"'.$user['hanging_up_call5'].'",'; */
				$row .= '"'.$user['badgering_call1'].'",';
				$row .= '"'.$user['badgering_call2'].'",';
				$row .= '"'.$user['badgering_call3'].'",';
				$row .= '"'.$user['badgering_call4'].'",';
				$row .= '"'.$user['badgering_call5'].'",';
				$row .= '"'.$user['action_autofail_call1'].'",';
				$row .= '"'.$user['action_autofail_call2'].'",';
				$row .= '"'.$user['action_autofail_call3'].'",';
				$row .= '"'.$user['action_autofail_call4'].'",';
				$row .= '"'.$user['action_autofail_call5'].'",';
				$row .= '"'.$user['health_claim_call1'].'",';
				$row .= '"'.$user['health_claim_call2'].'",';
				$row .= '"'.$user['health_claim_call3'].'",';
				$row .= '"'.$user['health_claim_call4'].'",';
				$row .= '"'.$user['health_claim_call5'].'",';
				$row .= '"'.$user['no_confirmation1'].'",';
				$row .= '"'.$user['no_confirmation2'].'",';
				$row .= '"'.$user['no_confirmation3'].'",';
				$row .= '"'.$user['no_confirmation4'].'",';
				$row .= '"'.$user['no_confirmation5'].'",';
				$row .= '"'.$user['no_retention1'].'",';
				$row .= '"'.$user['no_retention2'].'",';
				$row .= '"'.$user['no_retention3'].'",';
				$row .= '"'.$user['no_retention4'].'",';
				$row .= '"'.$user['no_retention5'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary5'])).'",';
				$row .= '"'.$user['agent_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='conduent'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['site_location'].'",';
				$row .= '"'.$user['phone_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['name_branded'].'",';
				$row .= '"'.$user['throughout'].'",';
				$row .= '"'.$user['necessary'].'",';
				$row .= '"'.$user['purpose'].'",';
				$row .= '"'.$user['csp_customer'].'",';
				$row .= '"'.$user['csp_maintain'].'",';
				$row .= '"'.$user['avoid_dead_air'].'",';
				$row .= '"'.$user['soft_skills'].'",';
				$row .= '"'.$user['listening_skills'].'",';
				$row .= '"'.$user['questions'].'",';
				$row .= '"'.$user['resolution'].'",';
				$row .= '"'.$user['information'].'",';
				$row .= '"'.$user['expectations'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['properly'].'",';
				$row .= '"'.$user['cardholder'].'",';
				$row .= '"'.$user['assist'].'",';
				$row .= '"'.$user['customer'].'",';
				$row .= '"'.$user['incorrect_information'].'",';
				$row .= '"'.$user['condescending'].'",';
				$row .= '"'.$user['transaction'].'",';
				$row .= '"'.$user['account'].'",';
				$row .= '"'.$user['avoidance'].'",';
				$row .= '"'.$user['courtesy_comment'].'",';
				$row .= '"'.$user['throughout_comment'].'",';
				$row .= '"'.$user['product_comment'].'",';
				$row .= '"'.$user['closing_comment'].'",';
				$row .= '"'.$user['auto_failure_comment'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='touchfuse'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_status'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['callasnwer'].'",';
				$row .= '"'.$user['agentanswer'].'",';
				$row .= '"'.$user['agentzip'].'",';
				$row .= '"'.$user['agentoffer'].'",';
				$row .= '"'.$user['callerwish'].'",';
				$row .= '"'.$user['agentconfirm'].'",';
				$row .= '"'.$user['calleraddress'].'",';
				$row .= '"'.$user['calleremail'].'",';
				$row .= '"'.$user['agentphone'].'",';
				$row .= '"'.$user['agentsummerize'].'",';
				$row .= '"'.$user['registerguest'].'",';
				$row .= '"'.$user['dispocall'].'",';
				$row .= '"'.$user['agentclosing'].'",';
				$row .= '"'.$user['agenttone'].'",';
				$row .= '"'.$user['activelistening'].'",';
				$row .= '"'.$user['agentprofession'].'",';
				$row .= '"'.$user['agentknowledge'].'",';
				$row .= '"'.$user['callcontrol'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='touchfuse_new'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_status'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['cust_score'].'%'.'",';
				$row .= '"'.$user['busi_score'].'%'.'",';
				$row .= '"'.$user['comp_score'].'%'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['callasnwer'].'",';
				$row .= '"'.$user['agentanswer'].'",';
				$row .= '"'.$user['agentzip'].'",';
				$row .= '"'.$user['agentoffer'].'",';
				$row .= '"'.$user['callerwish'].'",';
				$row .= '"'.$user['agentconfirm'].'",';
				$row .= '"'.$user['calleraddress'].'",';
				$row .= '"'.$user['calleremail'].'",';
				$row .= '"'.$user['agentphone'].'",';
				$row .= '"'.$user['agentsummerize'].'",';
				$row .= '"'.$user['registerguest'].'",';
				$row .= '"'.$user['dispocall'].'",';
				$row .= '"'.$user['agentclosing'].'",';
				$row .= '"'.$user['agenttone'].'",';
				$row .= '"'.$user['activelistening'].'",';
				$row .= '"'.$user['agentprofession'].'",';
				$row .= '"'.$user['agentknowledge'].'",';
				$row .= '"'.$user['callcontrol'].'",';
				$row .= '"'.$user['Avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='tbn'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['introrecord'].'",';
				$row .= '"'.$user['introcall'].'",';
				$row .= '"'.$user['introname'].'",';
				$row .= '"'.$user['introstate'].'",';
				$row .= '"'.$user['introscript'].'",';
				$row .= '"'.$user['introdisclose'].'",';
				$row .= '"'.$user['verifydonor'].'",';
				$row .= '"'.$user['verifyaddress'].'",';
				$row .= '"'.$user['verifyspelled'].'",';
				$row .= '"'.$user['verifyemail'].'",';
				$row .= '"'.$user['verifyback'].'",';
				$row .= '"'.$user['verifyasked'].'",';
				$row .= '"'.$user['verifyconfirm'].'",';
				$row .= '"'.$user['verifytype'].'",';
				$row .= '"'.$user['verifycell'].'",';
				$row .= '"'.$user['verifyaskalterphn'].'",';
				$row .= '"'.$user['verifyalterphn'].'",';
				$row .= '"'.$user['verifyalterno'].'",';
				$row .= '"'.$user['verifyconsent'].'",';
				$row .= '"'.$user['presentrequest'].'",';
				$row .= '"'.$user['presenttieroffer'].'",';
				$row .= '"'.$user['presentmonthask'].'",';
				$row .= '"'.$user['presentnavigate'].'",';
				$row .= '"'.$user['presenttbnknowledge'].'",';
				$row .= '"'.$user['presentauthor'].'",';
				$row .= '"'.$user['presentadherence'].'",';
				$row .= '"'.$user['cartclosedonation'].'",';
				$row .= '"'.$user['cartcloseamount'].'",';
				$row .= '"'.$user['cartclosemonthly'].'",';
				$row .= '"'.$user['cartcloseresource'].'",';
				$row .= '"'.$user['cartclosescript'].'",';
				$row .= '"'.$user['callhandleclearly'].'",';
				$row .= '"'.$user['callhandledemeanor'].'",';
				$row .= '"'.$user['callhandlepace'].'",';
				$row .= '"'.$user['callhandlelisten'].'",';
				$row .= '"'.$user['callhandleexhibit'].'",';
				$row .= '"'.$user['callhandlecommunicate'].'",';
				$row .= '"'.$user['callhandlecontrol'].'",';
				$row .= '"'.$user['autofinfo'].'",';
				$row .= '"'.$user['autofcall'].'",';
				$row .= '"'.$user['autofbehaviour'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='jfmi'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greets_customer_promptly'].'",';
				$row .= '"'.$user['uses_professionalism'].'",';
				$row .= '"'.$user['shows_gratitude'].'",';
				$row .= '"'.$user['collects_and_verifies_customer_information'].'",';
				$row .= '"'.$user['follows_correct_scripting_path'].'",';
				$row .= '"'.$user['collects_information_to_provide_to_partner_relations'].'",';
				$row .= '"'.$user['covers_all_payment_scripting'].'",';
				$row .= '"'.$user['maintains_call_control'].'",';
				$row .= '"'.$user['keeps_dead_air_to_minimum'].'",';
				$row .= '"'.$user['uses_faq_agent_note'].'",';
				$row .= '"'.$user['brands_the_call_with_proper_close'].'",';
				$row .= '"'.$user['stop_recording'].'",';
				$row .= '"'.$user['read_legal_script'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='hoveround'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['cust_score'].'%'.'",';
				$row .= '"'.$user['busi_score'].'%'.'",';
				$row .= '"'.$user['comp_score'].'%'.'",';
				$row .= '"'.$user['agentreadyforcall'].'",';
				$row .= '"'.$user['agentgiveintro'].'",';
				$row .= '"'.$user['agentcorrectprobe'].'",';
				// $row .= '"'.$user['agentverifycustomer'].'",';
				$row .= '"'.$user['agentclosecall'].'",';
				$row .= '"'.$user['agentdisposition'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['agentpolite'].'",';
				$row .= '"'.$user['agentshowenergy'].'",';
				$row .= '"'.$user['agenthavegoodtone'].'",';
				$row .= '"'.$user['agentgiveaccurateinfo'].'",';
				$row .= '"'.$user['email_address'].'",';
				$row .= '"'.$user['lead_properly'].'",';
				$row .= '"'.$user['Rude_Remarks'].'",';
				$row .= '"'.$user['Avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='ncpssm'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['introcaller'].'",';
				$row .= '"'.$user['introopenning'].'",';
				$row .= '"'.$user['scriptgathered'].'",';
				$row .= '"'.$user['scriptemail'].'",';
				$row .= '"'.$user['scriptstatement'].'",';
				$row .= '"'.$user['scriptmedicareissue'].'",';
				$row .= '"'.$user['scriptpersonalizecall'].'",';
				$row .= '"'.$user['scriptcallersupport'].'",';
				$row .= '"'.$user['toneenthusiasm'].'",';
				$row .= '"'.$user['toneproperpace'].'",';
				$row .= '"'.$user['tonecontroldeadair'].'",';
				$row .= '"'.$user['tonespokeclearly'].'",';
				$row .= '"'.$user['tonegoodlistening'].'",';
				$row .= '"'.$user['toneempathized'].'",';
				$row .= '"'.$user['toneprofessionalism'].'",';
				$row .= '"'.$user['closecallconslusion'].'",';
				$row .= '"'.$user['closecorrectinfo'].'",';
				$row .= '"'.$user['closeconfirmcaller'].'",';
				$row .= '"'.$user['autofailinfo'].'",';
				$row .= '"'.$user['autofailhungup'].'",';
				$row .= '"'.$user['autofailbehaviour'].'",';
				$row .= '"'.$user['autofaillanguage'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='stc'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentproperintro'].'",';
				$row .= '"'.$user['agentcapturedonorname'].'",';
				$row .= '"'.$user['agentreadscript'].'",';
				$row .= '"'.$user['agentcovermonthlyrequest'].'",';
				$row .= '"'.$user['agentcapturedonationamount'].'",';
				$row .= '"'.$user['agentofferpayment'].'",';
				$row .= '"'.$user['agentcapturedonoraddress'].'",';
				$row .= '"'.$user['agentcapturedonorphone'].'",';
				$row .= '"'.$user['agentcapturedonoremail'].'",';
				$row .= '"'.$user['agentproperlyrebuttals'].'",';
				$row .= '"'.$user['agentfollowscript'].'",';
				$row .= '"'.$user['agentshowfamiliarity'].'",';
				$row .= '"'.$user['agentusescriptnavigation'].'",';
				$row .= '"'.$user['agentfollowproperclose'].'",';
				$row .= '"'.$user['agentuseeffectivecommunication'].'",';
				$row .= '"'.$user['agentmaintaincontrol'].'",';
				$row .= '"'.$user['agentshowappreciation'].'",';
				$row .= '"'.$user['autofailfalseinfo'].'",';
				$row .= '"'.$user['autofailhungup'].'",';
				$row .= '"'.$user['autofailagentbehaviuor'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='tpm'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['introcall'].'",';
				$row .= '"'.$user['verifycall'].'",';
				$row .= '"'.$user['verifypayment'].'",';
				$row .= '"'.$user['verifycommunicator'].'",';
				$row .= '"'.$user['verifyspelledname'].'",';
				$row .= '"'.$user['verifyaskedaddress'].'",';
				$row .= '"'.$user['verifyspelledaddress'].'",';
				$row .= '"'.$user['verifyaskedphone'].'",';
				$row .= '"'.$user['verifycommunicatorphone'].'",';
				$row .= '"'.$user['verifylandline'].'",';
				$row .= '"'.$user['verifycallverbatim'].'",';
				$row .= '"'.$user['verifytextverbatim'].'",';
				$row .= '"'.$user['verifyaskedemail'].'",';
				$row .= '"'.$user['verifyspelledemail'].'",';
				$row .= '"'.$user['scriptadherence'].'",';
				$row .= '"'.$user['scripthighertier'].'",';
				$row .= '"'.$user['scriptnavigate'].'",';
				$row .= '"'.$user['scriptdisplaytpm'].'",';
				$row .= '"'.$user['closedcontent'].'",';
				$row .= '"'.$user['closedmonthlyask'].'",';
				$row .= '"'.$user['closedshippingtime'].'",';
				$row .= '"'.$user['closedprovidecart'].'",';
				$row .= '"'.$user['closedreadscript'].'",';
				$row .= '"'.$user['callhandlespeakclearly'].'",';
				$row .= '"'.$user['callhandledemeanor'].'",';
				$row .= '"'.$user['callhandleprofesionalism'].'",';
				$row .= '"'.$user['callhandlepace'].'",';
				$row .= '"'.$user['callhandleresponds'].'",';
				$row .= '"'.$user['callhandleemphaty'].'",';
				$row .= '"'.$user['callhandledonor'].'",';
				$row .= '"'.$user['callhandletalktime'].'",';
				$row .= '"'.$user['autofinfo'].'",';
				$row .= '"'.$user['autofhungup'].'",';
				$row .= '"'.$user['autofrude'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='patchology'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentcallopening'].'",';
				$row .= '"'.$user['agentclosecall'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remarks1'])).'",';
				$row .= '"'.$user['agentverifyinformation'].'",';
				$row .= '"'.$user['agentprovideinformation'].'",';
				$row .= '"'.$user['agenthippinginformation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remarks2'])).'",';
				$row .= '"'.$user['callanswertimely'].'",';
				$row .= '"'.$user['agentengagedcustomer'].'",';
				$row .= '"'.$user['customersatisfaction'].'",';
				$row .= '"'.$user['escalatedresources'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['remarks3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='aspca'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['Greet_customer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['Uses_professionalism'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['Shows_gratitude'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['Collects_verifies'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['guardians_program'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['monthly_guardian'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['gift_scripting'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['payment_scripting'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['Animal_champion'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['donation_processing'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['onetime_donation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['pet_insurance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'.$user['correct_script'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user['call_control'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'.$user['min_deadair'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'.$user['call_disposed'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'.$user['faq'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'.$user['personalizes_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'.$user['rude_remarks'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'.$user['call_avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='ffai'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['open_call_appropriate_branding'].'",';
				$row .= '"'.$user['close_call_appropriate_branding'].'",';
				$row .= '"'.$user['address_using_nato'].'",';
				$row .= '"'.$user['products_availability'].'",';
				$row .= '"'.$user['one_call_resolution'].'",';
				$row .= '"'.$user['agent_accurately_clearly'].'",';
				$row .= '"'.$user['agent_engaged_customer'].'",';
				$row .= '"'.$user['membership'].'",';
				$row .= '"'.$user['offer_donation'].'",';
				$row .= '"'.$user['was_cust_sat_fulfilled'].'",';
				$row .= '"'.$user['did_agent_offer_survey'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='lifi'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['life_quotes_greeting'].'",';
				$row .= '"'.$user['agent_positive_response'].'",';
				$row .= '"'.$user['customer_name_capture'].'",';
				$row .= '"'.$user['capture_address'].'",';
				$row .= '"'.$user['phone_number_confirmation'].'",';
				$row .= '"'.$user['email_Address'].'",';
				$row .= '"'.$user['customer_dob'].'",';
				$row .= '"'.$user['script_adherence'].'",';
				$row .= '"'.$user['coverage_amount_insurance'].'",';
				$row .= '"'.$user['tobacco_smoking'].'",';
				$row .= '"'.$user['height_weight_customer'].'",';
				$row .= '"'.$user['mention_price_comparison'].'",';
				$row .= '"'.$user['overall_confidence_level'].'",';
				$row .= '"'.$user['call_closing'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='heatsurge'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'.$user['callprepared5sec'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['useibobgreeting'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['accesscustomeraccount'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['vreifynameaddress'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['askforemail'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['readminiMiranda'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['giveaccuratepricing'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['giveaccurateshiping'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['accuratedescribeproduct'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['askforupsellproduct'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['provideappropiatesolution'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['codedordercorrectly'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'.$user['askforcancelarion'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user['usePKkeybuying'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'.$user['useappropiateguideline'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'.$user['askforbillingname'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'.$user['authorizeuserofcheck'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'.$user['billingaddressforpayment'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'.$user['permissiontoauthorizepayment'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'.$user['vrifyshippingaddress'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'.$user['accountwithissue'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'.$user['summarizesreviewcall'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'.$user['gaveCSphonenumber'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'.$user['wasagentpolite'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'.$user['usinginappropiatecomment'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'.$user['usesholdtrasferproperly'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'.$user['courteous'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'.$user['inappropriately'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'.$user['presentation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'.$user['automaticzero'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='stauers_sales'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['customer_score'].'%'.'",';
				$row .= '"'.$user['business_score'].'%'.'",';
				$row .= '"'.$user['compliance_score'].'%'.'",';
				$row .= '"'.$user['call_answered_5_seconds'].'",';
				$row .= '"'.$user['agent_verify_customer_name_address'].'",';
				$row .= '"'.$user['agent_capture_correct_offer'].'",';
				$row .= '"'.$user['agent_verify_phone_number'].'",';
				$row .= '"'.$user['agent_verify_customer_email'].'",';
				$row .= '"'.$user['agent_compliment_caller_purchase'].'",';
				$row .= '"'.$user['agent_recap'].'",';
				$row .= '"'.$user['agent_cover_upsell'].'",';
				$row .= '"'.$user['agent_recap_item'].'",';
				$row .= '"'.$user['agent_cover_one_upsell'].'",';
				$row .= '"'.$user['agent_cover_replacement'].'",';
				$row .= '"'.$user['agent_appropriate_rebuttal'].'",';
				$row .= '"'.$user['agent_cover_membership'].'",';
				$row .= '"'.$user['agent_appropriate_rebuttal_declined'].'",';
				$row .= '"'.$user['agent_offer_membership'].'",';
				$row .= '"'.$user['agent_cover_autorenew'].'",';
				$row .= '"'.$user['shipping_address_verified'].'",';
				$row .= '"'.$user['quote_correct_delivery_time'].'",';
				$row .= '"'.$user['agent_total_product_appropriately'].'",';
				$row .= '"'.$user['agent_quote_shipping_taxes'].'",';
				$row .= '"'.$user['agent_give_total_charged'].'",';
				$row .= '"'.$user['agent_provide_order_number'].'",';
				$row .= '"'.$user['agent_close_call_brand_correctly'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['customer_satisfied_experience'].'",';
				$row .= '"'.$user['customer_dissatisfied_professionalism'].'",';
				$row .= '"'.$user['rude_remarks'].'",';
				$row .= '"'.$user['call_avoidance'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='operation_smile'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentreadytohandle'].'",';
				$row .= '"'.$user['agentgreetthecaller'].'",';
				$row .= '"'.$user['agentconfirminfo'].'",';
				$row .= '"'.$user['agentshowgraduate'].'",';
				$row .= '"'.$user['agentuserebuttals'].'",';
				$row .= '"'.$user['agentofferupsell'].'",';
				$row .= '"'.$user['agentfollowscript'].'",';
				$row .= '"'.$user['agentaddressquestion'].'",';
				$row .= '"'.$user['agentspeakenergy'].'",';
				$row .= '"'.$user['agentuseproperpacing'].'",';
				$row .= '"'.$user['agentmaintaincontrol'].'",';
				$row .= '"'.$user['agentprofessionalspeak'].'",';
				$row .= '"'.$user['agentgoodlistening'].'",';
				$row .= '"'.$user['agentempathize'].'",';
				$row .= '"'.$user['agentprovidedonor'].'",';
				$row .= '"'.$user['agnetaskprompted'].'",';
				$row .= '"'.$user['agentthankcaller'].'",';
				$row .= '"'.$user['agentgaveinformation'].'",';
				$row .= '"'.$user['agenthangup'].'",';
				$row .= '"'.$user['agentlaguage'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='5_11_tactical'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greetthecustomer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['customeritemtoorder'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['wouldaddyourorder'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['customerlogininformation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['callerinformationaccuracy'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['coverfinalconfirmation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['givecustomerordernumber'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['userapplicablesearch'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['coverreturnprocess'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['coverexchangeprocess'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['coverrefundprocess'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['trackthepackage'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'.$user['agentaskforassist'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user['agentbrandthecall'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'.$user['answerquestions'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'.$user['maintaincallcontrol'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'.$user['properlynotateAX'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'.$user['escalationwaranted'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'.$user['agentdispositioncall'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'.$user['maintainprofessionalism'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'.$user['warranted'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'.$user['avoidance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'.$user['behavior'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='jmmi'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agent_appropriate_greeting'].'",';
				$row .= '"'.$user['agent_excellent_conversational_responses'].'",';
				$row .= '"'.$user['agent_verify_opening_information'].'",';
				$row .= '"'.$user['agent_follow_call_flow'].'",';
				$row .= '"'.$user['agent_appropriate_gratitude'].'",';
				$row .= '"'.$user['agent_share_upsells'].'",';
				$row .= '"'.$user['agent_show_familiarity_search'].'",';
				$row .= '"'.$user['agent_thank_caller_specifically'].'",';
				$row .= '"'.$user['agent_share_facts_appropriate'].'",';
				$row .= '"'.$user['agent_professional_communication'].'",';
				$row .= '"'.$user['agent_proper_enthusiasm'].'",';
				$row .= '"'.$user['agent_maintain_control_conversation'].'",';
				$row .= '"'.$user['agent_spoke_clearly'].'",';
				$row .= '"'.$user['agent_good_listening_skills_responses'].'",';
				$row .= '"'.$user['agent_empathize_caller_and_compassion'].'",';
				$row .= '"'.$user['agent_have_minimal_dead_air'].'",';
				$row .= '"'.$user['agent_have_caller_provide_address'].'",';
				$row .= '"'.$user['agent_confirm_dollar_amount'].'",';
				$row .= '"'.$user['agent_read_shipping_information'].'",';
				$row .= '"'.$user['agent_ask_caller_email_tv_information'].'",';
				$row .= '"'.$user['agent_proper_thanks'].'",';
				$row .= '"'.$user['agent_transfer_call_prayer_appropriate'].'",';
				$row .= '"'.$user['agent_follow_payment'].'",';
				$row .= '"'.$user['agent_read_back_customer_details_properly'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='non_profit'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['preparedtakecall'].'",';
				$row .= '"'.$user['paidcallerfromdonor'].'",';
				$row .= '"'.$user['communicatorstarted'].'",';
				$row .= '"'.$user['pronouncedclients'].'",';
				$row .= '"'.$user['gavewarmgreeting'].'",';
				$row .= '"'.$user['followedscript1stReq'].'",';
				$row .= '"'.$user['usedcorrectdollar'].'",';
				$row .= '"'.$user['assumptivegiftask'].'",';
				$row .= '"'.$user['shownempathy'].'",';
				$row .= '"'.$user['repeatedobjection'].'",';
				$row .= '"'.$user['personalizedobjection'].'",';
				$row .= '"'.$user['attemptedhandleobjection'].'",';
				$row .= '"'.$user['reinforcethenegative'].'",';
				$row .= '"'.$user['deadendcall'].'",';
				$row .= '"'.$user['followed2ndReq'].'",';
				$row .= '"'.$user['usedoller2ndReq'].'",';
				$row .= '"'.$user['assumptive2ndReq'].'",';
				$row .= '"'.$user['attempted3rdReq'].'",';
				$row .= '"'.$user['usedoller3rdReq'].'",';
				$row .= '"'.$user['assumptive3rdReq'].'",';
				$row .= '"'.$user['confirmationgiftamount'].'",';
				$row .= '"'.$user['assumedhigherdoller'].'",';
				$row .= '"'.$user['meaningfulgratitude'].'",';
				$row .= '"'.$user['readcreditcard'].'",';
				$row .= '"'.$user['confirmedfullname'].'",';
				$row .= '"'.$user['followedmaybeclose'].'",';
				$row .= '"'.$user['readclosescript'].'",';
				$row .= '"'.$user['endedcalltime'].'",';
				$row .= '"'.$user['soundedconversational'].'",';
				$row .= '"'.$user['useappropiatepace'].'",';
				$row .= '"'.$user['confidentpresentation'].'",';
				$row .= '"'.$user['didnotlosecontrol'].'",';
				$row .= '"'.$user['properpersonalization'].'",';
				$row .= '"'.$user['utilizedpropergrammer'].'",';
				$row .= '"'.$user['bailing'].'",';
				$row .= '"'.$user['askforcreditcard'].'",';
				$row .= '"'.$user['gavefalseinformation'].'",';
				$row .= '"'.$user['donorcarecenter'].'",';
				$row .= '"'.$user['askconfirmationquestion'].'",';
				$row .= '"'.$user['unsolidgift'].'",';
				$row .= '"'.$user['codingrefusal'].'",';
				$row .= '"'.$user['unprofessionalbehaviour'].'",';
				$row .= '"'.$user['improperpresentation'].'",';
				$row .= '"'.$user['omittedDNCcode'].'",';
				$row .= '"'.$user['falsificationgift'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='revel_new'){
         foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['bonus_overallscore'].'%'.'",';
				$row .= '"'.$user['agent_greeted_the_member'].'",';
				$row .= '"'.$user['agent_properly_authenticated'].'",';
				$row .= '"'.$user['did_agent_attempt'].'",';
				$row .= '"'.$user['agent_gave_health'].'",';
				$row .= '"'.$user['agent_collected_health'].'",';
				$row .= '"'.$user['agent_gave_correct_gift'].'",';
				$row .= '"'.$user['agent_offered_to_provide'].'",';
				$row .= '"'.$user['agent_provided_online'].'",';
				$row .= '"'.$user['agent_used_correct'].'",';
				$row .= '"'.$user['agent_logged_call'].'",';
				$row .= '"'.$user['agent_followed_script'].'",';
				$row .= '"'.$user['agent_gave_correct'].'",';
				$row .= '"'.$user['agent_resolved_all'].'",';
				$row .= '"'.$user['agent_displayed_active'].'",';
				$row .= '"'.$user['agent_effectively_engaged'].'",';
				$row .= '"'.$user['agent_displayed_polite'].'",';
				$row .= '"'.$user['agent_sounded_confident'].'",';
				$row .= '"'.$user['agent_did_not_interrupt'].'",';
				$row .= '"'.$user['agent_used_pleasing'].'",';
				$row .= '"'.$user['agent_maintained_call'].'",';
				$row .= '"'.$user['agent_used_correct_grammer'].'",';
				$row .= '"'.$user['agent_offered_additional'].'",';
				$row .= '"'.$user['agent_used_correct_client'].'",';

				$row .= '"'.$user['agent_submitted_escalation'].'",';
				$row .= '"'.$user['agent_was_not_rude'].'",';
				$row .= '"'.$user['agent_used_the_correct'].'",';
				$row .= '"'.$user['agent_did_not_demonstrate'].'",';
				$row .= '"'.$user['properly_authenticated_member'].'",';

				$row .= '"'.$user['the_agent_received'].'",';
				$row .= '"'.$user['is_the_recording'].'",';
				$row .= '"'.$user['would_play_this'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';



				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='icario'){
         foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['mechanics1'].'",';
				$row .= '"'.$user['mechanics2'].'",';
				$row .= '"'.$user['mechanics3'].'",';
				$row .= '"'.$user['mechanics4'].'",';
				$row .= '"'.$user['mechanics5'].'",';
				$row .= '"'.$user['mechanics6'].'",';
				$row .= '"'.$user['mechanics7'].'",';
				$row .= '"'.$user['mechanics8'].'",';
				$row .= '"'.$user['mechanics9'].'",';
				$row .= '"'.$user['soft_skills1'].'",';
				$row .= '"'.$user['soft_skills2'].'",';
				$row .= '"'.$user['soft_skills3'].'",';
				$row .= '"'.$user['soft_skills4'].'",';
				$row .= '"'.$user['soft_skills5'].'",';
				$row .= '"'.$user['soft_skills6'].'",';
				$row .= '"'.$user['soft_skills7'].'",';
				$row .= '"'.$user['soft_skills8'].'",';
				$row .= '"'.$user['soft_skills9'].'",';
				$row .= '"'.$user['soft_skills10'].'",';
				$row .= '"'.$user['soft_skills11'].'",';
				$row .= '"'.$user['soft_skills12'].'",';
				$row .= '"'.$user['auto_fail1'].'",';
				$row .= '"'.$user['auto_fail2'].'",';
				$row .= '"'.$user['auto_fail3'].'",';
				$row .= '"'.$user['auto_fail4'].'",';
				$row .= '"'.$user['auto_fail5'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';



				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='ica_latest'){
         foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['process_name'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['mechanics_overall_score'].'%'.'",';
				$row .= '"'.$user['soft_skills_overall_score'].'%'.'",';
				$row .= '"'.$user['mechanics1'].'",';
				$row .= '"'.$user['mechanics2'].'",';
				$row .= '"'.$user['mechanics3'].'",';
				$row .= '"'.$user['mechanics4'].'",';
				$row .= '"'.$user['mechanics5'].'",';
				$row .= '"'.$user['mechanics6'].'",';
				$row .= '"'.$user['mechanics7'].'",';
				$row .= '"'.$user['mechanics8'].'",';
				$row .= '"'.$user['mechanics9'].'",';
				$row .= '"'.$user['soft_skills1'].'",';
				$row .= '"'.$user['soft_skills2'].'",';
				$row .= '"'.$user['soft_skills3'].'",';
				$row .= '"'.$user['soft_skills4'].'",';
				$row .= '"'.$user['soft_skills5'].'",';
				$row .= '"'.$user['soft_skills6'].'",';
				$row .= '"'.$user['soft_skills7'].'",';
				$row .= '"'.$user['soft_skills8'].'",';
				$row .= '"'.$user['soft_skills9'].'",';
				$row .= '"'.$user['soft_skills10'].'",';
				$row .= '"'.$user['soft_skills11'].'",';
				$row .= '"'.$user['soft_skills12'].'",';
				$row .= '"'.$user['auto_fail1'].'",';
				$row .= '"'.$user['auto_fail2'].'",';
				$row .= '"'.$user['auto_fail3'].'",';
				$row .= '"'.$user['auto_fail4'].'",';
				$row .= '"'.$user['auto_fail5'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='ica'){
         foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['process_name'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['cust_score'].'%'.'",';
				$row .= '"'.$user['busi_score'].'%'.'",';
				$row .= '"'.$user['comp_score'].'%'.'",';

				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['mechanics1'].'",';
				$row .= '"'.$user['mechanics2'].'",';
				$row .= '"'.$user['mechanics3'].'",';
				$row .= '"'.$user['mechanics4'].'",';
				$row .= '"'.$user['mechanics5'].'",';
				$row .= '"'.$user['mechanics6'].'",';
				$row .= '"'.$user['mechanics7'].'",';
				$row .= '"'.$user['mechanics8'].'",';
				$row .= '"'.$user['mechanics9'].'",';
				$row .= '"'.$user['mechanics10'].'",';
				$row .= '"'.$user['mechanics11'].'",';
				$row .= '"'.$user['mechanics12'].'",';
				$row .= '"'.$user['mechanics13'].'",';
				$row .= '"'.$user['soft_skills1'].'",';
				$row .= '"'.$user['soft_skills2'].'",';
				$row .= '"'.$user['soft_skills3'].'",';
				$row .= '"'.$user['soft_skills4'].'",';
				$row .= '"'.$user['soft_skills5'].'",';
				$row .= '"'.$user['soft_skills6'].'",';
				$row .= '"'.$user['soft_skills7'].'",';
				$row .= '"'.$user['soft_skills8'].'",';
				$row .= '"'.$user['soft_skills9'].'",';
				$row .= '"'.$user['auto_fail1'].'",';
				$row .= '"'.$user['auto_fail2'].'",';
				$row .= '"'.$user['auto_fail3'].'",';
				$row .= '"'.$user['auto_fail4'].'",';
				$row .= '"'.$user['auto_fail5'].'",';
				$row .= '"'.$user['auto_fail6'].'",';
				$row .= '"'.$user['bonus_point'].'",';
				$row .= '"'.$user['tracking1'].'",';
				$row .= '"'.$user['tracking2'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt32'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='qpc'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				//$row .= '"'.$user['csr_id'].'",';
				//$row .= '"'.$user['call_type'].'",';
				//$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['unpreparedCallIntroduce'].'",';
				$row .= '"'.$user['didnotUseBranding'].'",';
				$row .= '"'.$user['dataNotCollected'].'",';
				$row .= '"'.$user['secondDataOccurrence'].'",';
				$row .= '"'.$user['inaccurateCallResult'].'",';
				$row .= '"'.$user['unusableAfterCallComment'].'",';
				$row .= '"'.$user['underutilizedCallNarration'].'",';
				$row .= '"'.$user['inappropiateFAQResponce'].'",';
				$row .= '"'.$user['imprpperTransaction'].'",';
				$row .= '"'.$user['underAcknowledgeCaller'].'",';
				$row .= '"'.$user['inappropiateScript'].'",';
				$row .= '"'.$user['notDisplayOwnership'].'",';
				$row .= '"'.$user['incorrectTransfer'].'",';
				$row .= '"'.$user['didagentabruptendcall'].'",';
				$row .= '"'.$user['didagentanswerpremiumquestion'].'",';
				$row .= '"'.$user['didagentgivewrongcallback'].'",';
				$row .= '"'.$user['didagentuseincorrectname'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='ancient_nutrition'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];
				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['repgreetingcustomer'].'",';
				$row .= '"'.$user['repuserespectfultone'].'",';
				$row .= '"'.$user['repasnwertimelymanner'].'",';
				$row .= '"'.$user['repcollectcustomerinfo'].'",';
				$row .= '"'.$user['repcoverpaymentprocedure'].'",';
				$row .= '"'.$user['repuselisteningskills'].'",';
				$row .= '"'.$user['repdemonstratecalltechnique'].'",';
				$row .= '"'.$user['repreframeinterruptcaller'].'",';
				$row .= '"'.$user['repspeakclearlyatpace'].'",';
				$row .= '"'.$user['repavoiduseinternalterms'].'",';
				$row .= '"'.$user['repconfidentinresponce'].'",';
				$row .= '"'.$user['repusercallerlastname'].'",';
				$row .= '"'.$user['repusefiltertoobtain'].'",';
				$row .= '"'.$user['repcoverautoshipping'].'",';
				$row .= '"'.$user['repgatheredemail'].'",';
				$row .= '"'.$user['repcoverRushshipping'].'",';
				$row .= '"'.$user['repcompleteorderconfirmation'].'",';
				$row .= '"'.$user['repmaintaincallcontrol'].'",';
				$row .= '"'.$user['repusetoolappropiately'].'",';
				$row .= '"'.$user['repdemonstrateproductknowledge'].'",';
				$row .= '"'.$user['repuseappropiateobjection'].'",';
				$row .= '"'.$user['repaccuratelycalldocument'].'",';
				$row .= '"'.$user['repcompletecorrectclosing'].'",';
				$row .= '"'.$user['repthankthecallerbeforeclosing'].'",';
				$row .= '"'.$user['repcoveroffersappropiately'].'",';
				$row .= '"'.$user['repcoverupsellappropiately'].'",';
				$row .= '"'.$user['agentReadConfirmScript'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='sabal'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['agentaskIndividualName'].'",';
				$row .= '"'.$user['agentIntroduceHimHerself'].'",';
				$row .= '"'.$user['agentStateCustomerService'].'",';
				$row .= '"'.$user['agentApologizePhoneCall'].'",';
				$row .= '"'.$user['agentIndividualRXplan'].'",';
				$row .= '"'.$user['agentReadListedExample'].'",';
				$row .= '"'.$user['agentAskIndividualColorCard'].'",';
				$row .= '"'.$user['agentAskIndividualUpdate'].'",';
				$row .= '"'.$user['agentAskIndividualEffectiveDate'].'",';
				$row .= '"'.$user['agentUseCorrectRebuttal'].'",';
				$row .= '"'.$user['agentUseIndividualScript'].'",';
				$row .= '"'.$user['agentSaysHeShenotInterested'].'",';
				$row .= '"'.$user['agentAbruptlyEndCall'].'",';
				$row .= '"'.$user['agentbecomeUrgumentative'].'",';
				$row .= '"'.$user['agentRecordIncirrectMedicare'].'",';
				$row .= '"'.$user['agentProvideFalseInformation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='curative'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greetCustomerProperly'].'",';
				$row .= '"'.$user['useRespectfulTone'].'",';
				$row .= '"'.$user['answerInTimelyManner'].'",';
				$row .= '"'.$user['verifyCustomerInformation'].'",';
				$row .= '"'.$user['verifyPatientPHI'].'",';
				$row .= '"'.$user['accidentalIncorrectInformation'].'",';
				$row .= '"'.$user['agentEscalateTier2Correctly'].'",';
				$row .= '"'.$user['agentEnsureEmailAddress'].'",';
				$row .= '"'.$user['agentRespectPatientPrivacy'].'",';
				$row .= '"'.$user['agentSpeakConcisely'].'",';
				$row .= '"'.$user['agentAvoidInternalTerms'].'",';
				$row .= '"'.$user['agentDemonstrateEmpathyUse'].'",';
				$row .= '"'.$user['agentUsePleaseThankyou'].'",';
				$row .= '"'.$user['agentMinimizeExtendedSilence'].'",';
				$row .= '"'.$user['agentUseCorrectSentence'].'",';
				$row .= '"'.$user['agentSpeakWarmthVoice'].'",';
				$row .= '"'.$user['callerGaveAgentKUDOS'].'",';
				$row .= '"'.$user['agentDemonstrateCallerPatient'].'",';
				$row .= '"'.$user['repCompletlyCallDocument'].'",';
				$row .= '"'.$user['repConfirmCompleteClosing'].'",';
				$row .= '"'.$user['thankCallerBeforeClosing'].'",';
				$row .= '"'.$user['repDoEverythingPossible'].'",';
				$row .= '"'.$user['repAncipateCallerNeed'].'",';
				$row .= '"'.$user['agentProvideAccurateResult'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='powerfan'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['answerCallWithin5sec'].'",';
				$row .= '"'.$user['agentIdentifySelftandCompany'].'",';
				$row .= '"'.$user['collectIntroInformation'].'",';
				$row .= '"'.$user['mainSelftAgentGiveTerms'].'",';
				$row .= '"'.$user['agentPromoteUpsell'].'",';
				$row .= '"'.$user['describedProductAccurately'].'",';
				$row .= '"'.$user['useAppropiateObjection'].'",';
				$row .= '"'.$user['askForBillingNamesOnCheck'].'",';
				$row .= '"'.$user['agentVerifyCallerUseofCheck'].'",';
				$row .= '"'.$user['askForBillingAddressForPayment'].'",';
				$row .= '"'.$user['agentVerifyShippingAddress'].'",';
				$row .= '"'.$user['orderWasSetUpAndCodedCorrectly'].'",';
				$row .= '"'.$user['askForEmailAddress'].'",';
				$row .= '"'.$user['gaveTotalAmountCharged'].'",';
				$row .= '"'.$user['gaveCorrectShippingInfo'].'",';
				$row .= '"'.$user['gaveMBGInfo'].'",';
				$row .= '"'.$user['gaveCSPhoneNumber'].'",';
				$row .= '"'.$user['permissionToAuthorizePayment'].'",';
				$row .= '"'.$user['wasAgentPolite'].'",';
				$row .= '"'.$user['agentUsingAppropiateComment'].'",';
				$row .= '"'.$user['useHoldAndTransferProperly'].'",';
				$row .= '"'.$user['power_fan_autofail'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='nuwave'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['order_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['interaction'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['can_automated'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greeting_identification'].'",';
				$row .= '"'.$user['verified_customer'].'",';
				$row .= '"'.$user['use_caller_CSR_name'].'",';
				$row .= '"'.$user['doesnot_interrupt_customer'].'",';
				$row .= '"'.$user['converses_clear_concise_mannaer'].'",';
				$row .= '"'.$user['avoid_use_slang_jargon'].'",';
				$row .= '"'.$user['empathy_toward_customer'].'",';
				$row .= '"'.$user['CSR_sound_helpful'].'",';
				$row .= '"'.$user['gain_customer_permission'].'",';
				$row .= '"'.$user['thanks_customer_holding'].'",';
				$row .= '"'.$user['hold_time_appropiate'].'",';
				$row .= '"'.$user['utilized_established_guidelines'].'",';
				$row .= '"'.$user['use_probing_question'].'",';
				$row .= '"'.$user['verbally_verfied_problem'].'",';
				$row .= '"'.$user['manage_customer_expectation'].'",';
				$row .= '"'.$user['reason_for_troubleshooting'].'",';
				$row .= '"'.$user['use_available_resources'].'",';
				$row .= '"'.$user['complete_customer_documentation'].'",';
				$row .= '"'.$user['customer_comfortable_with_outcome'].'",';
				$row .= '"'.$user['additional_needs_uncovered'].'",';
				$row .= '"'.$user['product_served_their_needs'].'",';
				$row .= '"'.$user['used_correct_closing'].'",';
				$row .= '"'.$user['infractions'].'",';
				$row .= '"'.$user['sub_infractions'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='delta_iowa'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['answer_call_promptly'].'",';
				$row .= '"'.$user['open_call_property'].'",';
				$row .= '"'.$user['verify_identify_information'].'",';
				$row .= '"'.$user['adhered_HIPAA'].'",';
				$row .= '"'.$user['adhere_client_policies'].'",';
				$row .= '"'.$user['perform_correct_action'].'",';
				$row .= '"'.$user['set_appropiate_expectation'].'",';
				$row .= '"'.$user['gave_accurate_info'].'",';
				$row .= '"'.$user['routed_issue'].'",';
				$row .= '"'.$user['complete_documentation'].'",';
				$row .= '"'.$user['phrases_courtsey'].'",';
				$row .= '"'.$user['use_caller_name'].'",';
				$row .= '"'.$user['hold_and_transfer'].'",';
				$row .= '"'.$user['state_call_reason'].'",';
				$row .= '"'.$user['use_jargon'].'",';
				$row .= '"'.$user['allow_caller_speak'].'",';
				$row .= '"'.$user['positive_plan_type'].'",';
				$row .= '"'.$user['willingness_help_caller'].'",';
				$row .= '"'.$user['gained_agrrement'].'",';
				$row .= '"'.$user['emphathetic_manner'].'",';
				$row .= '"'.$user['closed_call'].'",';
				$row .= '"'.$user['resolved_customer_issue'].'",';
				$row .= '"'.$user['assure_customer_comcern'].'",';
				$row .= '"'.$user['effective_attempt'].'",';
				$row .= '"'.$user['agent_disconnect_customer'].'",';
				$row .= '"'.$user['agent_transfer_customer'].'",';
				$row .= '"'.$user['agent_use_offensive_word'].'",';
				$row .= '"'.$user['agent_talked_down_caller'].'",';
				$row .= '"'.$user['agent_disclosed_info'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt29'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='airmethod'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greet_caller_properly'].'",';
				$row .= '"'.$user['use_respectful_tone'].'",';
				$row .= '"'.$user['answer_timely_manner'].'",';
				$row .= '"'.$user['collect_verify_customer_info'].'",';
				$row .= '"'.$user['collect_caller_work_location'].'",';
				$row .= '"'.$user['correctly_define_case_type'].'",';
				$row .= '"'.$user['correctly_marl_test_date'].'",';
				$row .= '"'.$user['ensure_contact_trace'].'",';
				$row .= '"'.$user['agent_speak_clearly'].'",';
				$row .= '"'.$user['agent_demonstrate_call_email'].'",';
				$row .= '"'.$user['agent_use_please_through_call'].'",';
				$row .= '"'.$user['agent_minimize_silence_on_call'].'",';
				$row .= '"'.$user['agent_speak_sincere_voice'].'",';
				$row .= '"'.$user['agent_use_correct_sentence'].'",';
				$row .= '"'.$user['agent_demonstrate_call_patience'].'",';
				$row .= '"'.$user['caller_give_agnet_KUDOS'].'",';
				$row .= '"'.$user['completely_document_call'].'",';
				$row .= '"'.$user['complete_correct_closing'].'",';
				$row .= '"'.$user['provide_correct_instruction'].'",';
				$row .= '"'.$user['provide_clear_concise_direction'].'",';
				$row .= '"'.$user['make_appropiate_contact'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='airmethod_email'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['appropriate_letter_structure'].'",';
				$row .= '"'.$user['agent_accurately'].'",';
				$row .= '"'.$user['reliance_prior'].'",';
				$row .= '"'.$user['reliance_thoroughly'].'",';
				$row .= '"'.$user['accurate_response'].'",';
				$row .= '"'.$user['verified_recipient'].'",';
				$row .= '"'.$user['internal_terms'].'",';
				$row .= '"'.$user['agent_demonstrate'].'",';
				$row .= '"'.$user['use_please_and_thankyou'].'",';
				$row .= '"'.$user['correct_sentence_structure'].'",';
				$row .= '"'.$user['email_communication'].'",';
				$row .= '"'.$user['email_the_correct'].'",';
				$row .= '"'.$user['leave_the_case'].'",';
				$row .= '"'.$user['accurately_record'].'",';
				$row .= '"'.$user['provide_timely'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='foodsaver'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greet_caller_properly'].'",';
				$row .= '"'.$user['read_entire_script'].'",';
				$row .= '"'.$user['caller_no_initial_offer'].'",';
				$row .= '"'.$user['preserve_highest_quality'].'",';
				$row .= '"'.$user['rep_ask_question'].'",';
				$row .= '"'.$user['caller_no_first_rebuttal'].'",';
				$row .= '"'.$user['caller_no_rep_advise'].'",';
				$row .= '"'.$user['re_thank_caller'].'",';
				$row .= '"'.$user['rep_advise_price_tag'].'",';
				$row .= '"'.$user['rep_ask_order_confirmation'].'",';
				$row .= '"'.$user['rep_offer_auto_delivary'].'",';
				$row .= '"'.$user['ask_caller_foodsaver_gift'].'",';
				$row .= '"'.$user['rep_ask_email_address'].'",';
				$row .= '"'.$user['rep_ask_about_credit_card'].'",';
				$row .= '"'.$user['thank_caller_for_order'].'",';
				$row .= '"'.$user['review_order_summary'].'",';
				$row .= '"'.$user['rep_ask_for_help'].'",';
				$row .= '"'.$user['rep_end_positive_statement'].'",';
				$row .= '"'.$user['enter_incorrect_credit_card'].'",';
				$row .= '"'.$user['rep_speak_rudely'].'",';
				$row .= '"'.$user['rep_badger_caller'].'",';
				$row .= '"'.$user['disconnet_call_without_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='sas'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greet_customer_properly'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['use_respectful_tone'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['use_inappropiate_language'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['end_call_before_complete'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['give_medical_advise'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['did_the_agent_fail'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['agent_have_pleasant_tone'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['agent_follow_all_procedure'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['agent_use_please_thank'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['agent_schedule_appointment'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['agent_minimise_extended_silence'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['agent_answer_all_question'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'.$user['did_the_agent_verify_the_caller'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user['agent_use_the_caller'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'.$user['agent_correct_thinking_caller'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'.$user['agent_document_appropiately'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'.$user['agent_correct_call_transfer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'.$user['agent_correct_dispose_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='gap'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greet_customer_properly'].'",';
				$row .= '"'.$user['use_respectful_tone'].'",';
				$row .= '"'.$user['properly_identify_GAP'].'",';
				$row .= '"'.$user['make_disclosure_during_call'].'",';
				$row .= '"'.$user['alter_customer_information'].'",';
				$row .= '"'.$user['obtain_customer_information'].'",';
				$row .= '"'.$user['pose_customer_to_complete_TPV'].'",';
				$row .= '"'.$user['use_intimidation_to_customer'].'",';
				$row .= '"'.$user['contact_customer_on_internal_DNC'].'",';
				$row .= '"'.$user['call_disposition_fail'].'",';
				$row .= '"'.$user['call_center_violation'].'",';
				$row .= '"'.$user['agent_have_misrepresentation'].'",';
				$row .= '"'.$user['suggest_customer_to_choose_CES'].'",';
				$row .= '"'.$user['represent_rate_guarantees_saving'].'",';
				$row .= '"'.$user['make_clear_not_work_GAP'].'",';
				$row .= '"'.$user['properly_disclose_rate'].'",';
				$row .= '"'.$user['properly_disclose_36month_term'].'",';
				$row .= '"'.$user['explain_customer_rescind_contact'].'",';
				$row .= '"'.$user['extended_silence_through_call'].'",';
				$row .= '"'.$user['explain_customer_agreement_cencel_without_penalty'].'",';
				$row .= '"'.$user['explain_customer_send_electronic_copy_after_call'].'",';
				$row .= '"'.$user['agent_demonstrate_patient_on_call'].'",';
				$row .= '"'.$user['advise_verification_not_authorised'].'",';
				$row .= '"'.$user['answer_question_before_transfering'].'",';
				$row .= '"'.$user['ask_caller_hold_line'].'",';
				$row .= '"'.$user['agent_correctly_transfer_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cm22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='suarez'){

			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_an'].'",';
				$row .= '"'.$user['account_identifiers'].'",';
				$row .= '"'.$user['copy_received'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_promptly_sound_ready'].'",';
				$row .= '"'.$user['introduction_clear_noise'].'",';
				$row .= '"'.$user['correct_greeting'].'",';
				$row .= '"'.$user['friendly_happy'].'",';
				$row .= '"'.$user['captured_correctly'].'",';
				$row .= '"'.$user['script_correctly'].'",';
				$row .= '"'.$user['information_correctly'].'",';
				$row .= '"'.$user['disclaimers_offered'].'",';
				$row .= '"'.$user['call_properly_sale'].'",';
				$row .= '"'.$user['sound_confident'].'",';
				$row .= '"'.$user['upsells_offered_correctly'].'",';
				$row .= '"'.$user['obtain_requirement_scale'].'",';
				$row .= '"'.$user['additional_upsell_opportunity'].'",';
				$row .= '"'.$user['call_without_excessive'].'",';
				$row .= '"'.$user['lose_a_sale'].'",';
				$row .= '"'.$user['appropriately_answer'].'",';
				$row .= '"'.$user['full_attention'].'",';
				$row .= '"'.$user['heard_interrupting'].'",';
				$row .= '"'.$user['impression_of_customer'].'",';
				$row .= '"'.$user['noticeable_change'].'",';
				$row .= '"'.$user['times_appropriately'].'",';
				$row .= '"'.$user['keyed_correctly'].'",';
				$row .= '"'.$user['account_or_experience'].'",';
				$row .= '"'.$user['promotions_and_procedures'].'",';
				$row .= '"'.$user['negative_or_unprofessional'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='sfe'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['is_agent_advice'].'",';
				$row .= '"'.$user['is_agent_advice_record'].'",';
				$row .= '"'.$user['agent_provide_all_program'].'",';
				$row .= '"'.$user['agent_speaking_account_holder'].'",';
				$row .= '"'.$user['agent_ask_caller_receiving_govt_assist'].'",';
				$row .= '"'.$user['do_ask_addr_email'].'",';
				$row .= '"'.$user['is_caller_18_years_old'].'",';
				$row .= '"'.$user['is_rep_sound_confident_polite'].'",';
				$row .= '"'.$user['agent_address_caller'].'",';
				$row .= '"'.$user['is_agent_use_greeting'].'",';
				$row .= '"'.$user['is_agent_extended_silence'].'",';
				$row .= '"'.$user['agent_speak_clearly'].'",';
				$row .= '"'.$user['agent_first_rebuttal_correctly'].'",';
				$row .= '"'.$user['agent_second_rebuttal_correctly'].'",';
				$row .= '"'.$user['agent_provide_phone_call_back'].'",';
				$row .= '"'.$user['agent_advice_welcome_package'].'",';
				$row .= '"'.$user['agent_ask_for_sale'].'",';
				$row .= '"'.$user['rep_finalize_date_for_quote'].'",';
				$row .= '"'.$user['rep_take_complete_notes'].'",';
				$row .= '"'.$user['rep_proceed_call_without_yes'].'",';
				$row .= '"'.$user['rep_provide_accurate_information'].'",';
				$row .= '"'.$user['rep_mislead_caller_any_way'].'",';
				$row .= '"'.$user['rep_advice_to_uses_service'].'",';
				$row .= '"'.$user['do_rep_advice_service'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='brightway_ib_bank'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				if($user['bonus_question']=='AB') $bonus_question='Associate was able to retain customer that indicated they were going to leave Brightway.';
				if($user['bonus_question']=='AS') $bonus_question='Associate identified a cross sell opportunity and was able to refer to agent for additional quotes.';

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['did_csr_use_approved_greeting'].'",';
				$row .= '"'.$user['did_applicable_rep_advice'].'",';
				$row .= '"'.$user['verified_captured_point_contact'].'",';
				$row .= '"'.$user['did_associate_use_tone'].'",';
				$row .= '"'.$user['did_associate_use_tone'].'",';
				$row .= '"'.$user['did_associate_avoid_insurance'].'",';
				$row .= '"'.$user['did_associate_listen_carefully'].'",';
				$row .= '"'.$user['did_associate_ask_place'].'",';
				$row .= '"'.$user['associate_maintained_call'].'",';
				$row .= '"'.$user['not_any_silence_dead_air'].'",';
				$row .= '"'.$user['all_verbal_written_information'].'",';
				$row .= '"'.$user['did_associate_ask_probing'].'",';
				$row .= '"'.$user['applicable_call_warn_transferred'].'",';
				$row .= '"'.$user['expectation_provided'].'",';
				$row .= '"'.$user['if_call_dicconnected_prior'].'",';
				$row .= '"'.$user['documented_correct_policy'].'",';
				$row .= '"'.$user['are_notes_clear'].'",';
				$row .= '"'.$user['created_all_activities'].'",';
				$row .= '"'.$user['do_correct_template_used'].'",';
				$row .= '"'.$user['attached_all_email'].'",';
				$row .= '"'.$user['was_the_issue'].'",';
				$row .= '"'.$user['requested_all_signed_documents'].'",';
				$row .= '"'.$user['csr_offered_any_possible'].'",';
				$row .= '"'.$user['effectively_accessed'].'",';
				$row .= '"'.$user['ware_all_changes_made'].'",';
				$row .= '"'.$user['all_associated_policies'].'",';
				$row .= '"'.$user['was_the_appropriate_suspense'].'",';
				$row .= '"'.$user['address_any_service_related'].'",';
				$row .= '"'.$user['csr_updated_any_suspense'].'",';
				$row .= '"'.$user['was_correct_disposion_selected'].'",';
				$row .= '"'.$user['did_csr_provide_summary'].'",';
				$row .= '"'.$user['did_associate_offer'].'",';
				$row .= '"'.$bonus_question.'",';
				$row .= '"'.$user['do_call_auto_fail'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='offline'){
        foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';

                $row .= '"'.$user['phone'].'",';
                $row .= '"'.$user['rep'].'",';
                $row .= '"'.$user['enter_policy_information'].'",';
                $row .= '"'.$user['florida_or_national'].'",';
                $row .= '"'.$user['type_of_policy'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
                $row .= '"'.$user['associate_handle_request_according_Brightway'].'",';
                $row .= '"'.$user['associate_handle_request_according_carrier'].'",';
                $row .= '"'.$user['associate_process_change'].'",';
                $row .= '"'.$user['associate_use_appropriate_verbiage'].'",';
                $row .= '"'.$user['All_verbal_written_information'].'",';
                $row .= '"'.$user['was_customer_adversely'].'",';
                $row .= '"'.$user['were_there_any_additional'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='phone_inbound'){
        foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
                $row .= '"'.$user['evaluator_name'].'",';
				$row .= '"'.$user['ani'].'",';
				$row .= '"'.$user['dnis'].'",';
				$row .= '"'.$user['contact_id'].'",';
				$row .= '"'.$user['direction_type'].'",';
				$row .= '"'.$user['skill_name'].'",';
				$row .= '"'.$user['segment_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
                $row .= '"'.$user['line_of_business'].'",';
				$row .= '"'.$user['state_of_policy'].'",';
				$row .= '"'.$user['call_information_comment'].'",';
				$row .= '"'.$user['complete_correct_caller'].'",';
				$row .= '"'.$user['authentication_process'].'",';
				$row .= '"'.$user['demonstrate_soft_skills'].'",';
				$row .= '"'.$user['provide_empathy_sympathy'].'",';
				$row .= '"'.$user['demonstrate_call_control'].'",';
				$row .= '"'.$user['provide_the_proper_brightway'].'",';
				$row .= '"'.$user['advise_the_caller_that'].'",';
				$row .= '"'.$user['follow_the_proper_hold'].'",';
				$row .= '"'.$user['follow_the_proper_transfer'].'",';
				$row .= '"'.$user['disconnected_did_the_csr'].'",';
				$row .= '"'.$user['the_proper_closing'].'",';
				$row .= '"'.$user['the_necessary_tools_and'].'",';
				$row .= '"'.$user['demonstrate_knowledge'].'",';
				$row .= '"'.$user['accurately_document'].'",';
				$row .= '"'.$user['provide_clear_notes'].'",';
				$row .= '"'.$user['properly_advise_the_caller'].'",';
				$row .= '"'.$user['clearly_explain_options'].'",';
				$row .= '"'.$user['necessary_policies_updated'].'",';
				$row .= '"'.$user['offer_helpful_options'].'",';
				$row .= '"'.$user['retain_customer_who_had'].'",';
				$row .= '"'.$user['identify_cross_sell'].'",';
				$row .= '"'.$user['kudos_for_this_interaction'].'",';
				$row .= '"'.$user['considered_offensive'].'",';
				$row .= '"'.$user['complete_transaction'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='phone_inbound_new'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
                $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['State'].'",';
				$row .= '"'.$user['Policy_Number'].'",';
				$row .= '"'.$user['LOB'].'",';
				$row .= '"'.$user['Overview'].'",';
				$row .= '"'.$user['Carrier'].'",';
				$row .= '"'.$user['master_id'].'",';
				$row .= '"'.$user['call_rate'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
                $row .= '"'.$user['Verification'].'",';
				$row .= '"'.$user['information'].'",';
				$row .= '"'.$user['Sympathy'].'",';
				$row .= '"'.$user['Control'].'",';
				$row .= '"'.$user['Procedures'].'",';
				$row .= '"'.$user['Call_Back'].'",';
				$row .= '"'.$user['Completion'].'",';
				$row .= '"'.$user['Tools'].'",';
				$row .= '"'.$user['Documentation'].'",';
				$row .= '"'.$user['Follow_Ups'].'",';
				$row .= '"'.$user['End_Solution'].'",';
				$row .= '"'.$user['Necessary_Updates'].'",';
				$row .= '"'.$user['Kudos'].'",';
				$row .= '"'.$user['Interaction'].'",';
				$row .= '"'.$user['Omissions'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='processing'){
        foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
                $row .= '"'.$user['evaluator_name'].'",';
				$row .= '"'.$user['ani'].'",';
				$row .= '"'.$user['dnis'].'",';
				$row .= '"'.$user['contact_id'].'",';
				$row .= '"'.$user['direction_type'].'",';
				$row .= '"'.$user['skill_name'].'",';
				$row .= '"'.$user['segment_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
                $row .= '"'.$user['line_of_business'].'",';
				$row .= '"'.$user['state_of_policy'].'",';
				$row .= '"'.$user['call_information_comment'].'",';
				$row .= '"'.$user['complete_correct_caller'].'",';
				$row .= '"'.$user['authentication_process'].'",';
				$row .= '"'.$user['demonstrate_soft_skills'].'",';
				$row .= '"'.$user['provide_empathy_sympathy'].'",';
				$row .= '"'.$user['demonstrate_call_control'].'",';
				$row .= '"'.$user['provide_the_proper_brightway'].'",';
				$row .= '"'.$user['advise_the_caller_that'].'",';
				$row .= '"'.$user['follow_the_proper_hold'].'",';
				$row .= '"'.$user['follow_the_proper_transfer'].'",';
				$row .= '"'.$user['disconnected_did_the_csr'].'",';
				$row .= '"'.$user['the_proper_closing'].'",';

				$row .= '"'.$user['the_necessary_tools_and'].'",';
				$row .= '"'.$user['demonstrate_knowledge'].'",';


				$row .= '"'.$user['accurately_document'].'",';
				$row .= '"'.$user['provide_clear_notes'].'",';

				$row .= '"'.$user['proper_spelling'].'",';
                $row .= '"'.$user['email_ensuring'].'",';



				$row .= '"'.$user['properly_advise_the_caller'].'",';
				$row .= '"'.$user['clearly_explain_options'].'",';
				$row .= '"'.$user['necessary_policies_updated'].'",';
				$row .= '"'.$user['clear_reason_for_the'].'",';
				$row .= '"'.$user['offer_helpful_options'].'",';


				$row .= '"'.$user['retain_customer_who_had'].'",';
				$row .= '"'.$user['identify_cross_sell'].'",';
				$row .= '"'.$user['kudos_for_this_interaction'].'",';

				$row .= '"'.$user['considered_offensive'].'",';
				$row .= '"'.$user['complete_transaction'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='processing_new'){
        foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
                $row .= '"'.$user['evaluator_name'].'",';
				$row .= '"'.$user['ani'].'",';
				$row .= '"'.$user['dnis'].'",';
				$row .= '"'.$user['contact_id'].'",';
				$row .= '"'.$user['direction_type'].'",';
				$row .= '"'.$user['skill_name'].'",';
				$row .= '"'.$user['segment_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
                $row .= '"'.$user['Verification'].'",';
				$row .= '"'.$user['information'].'",';
				$row .= '"'.$user['Authentication'].'",';
				$row .= '"'.$user['Service'].'",';
				$row .= '"'.$user['Sympathy'].'",';
				$row .= '"'.$user['Control'].'",';
				$row .= '"'.$user['Procedures'].'",';
				$row .= '"'.$user['Back'].'",';
				$row .= '"'.$user['Completion'].'",';
				$row .= '"'.$user['Communication'].'",';
				$row .= '"'.$user['Tools'].'",';
				$row .= '"'.$user['Documentation'].'",';
				$row .= '"'.$user['Follow_Ups'].'",';
				$row .= '"'.$user['Solution'].'",';

				$row .= '"'.$user['Updates'].'",';
				$row .= '"'.$user['Kudos'].'",';


				$row .= '"'.$user['Interaction'].'",';
				$row .= '"'.$user['Omissions'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='qpc_esal'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['open_call_introduction'].'",';
				$row .= '"'.$user['accurate_translation'].'",';
				$row .= '"'.$user['provide_correct_data'].'",';
				$row .= '"'.$user['use_correct_grammar'].'",';
				$row .= '"'.$user['effective_communication'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['avoid_silence_gap'].'",';
				$row .= '"'.$user['communicate_respectful_manner'].'",';
				$row .= '"'.$user['cannot_translet_profanity'].'",';
				$row .= '"'.$user['close_call'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='pcare_cs'){
			foreach($rr as $user){

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['office_id'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['customer_no'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['greeting_to_company'].'",';
				$row .= '"'.$user['customer_identification'].'",';
				$row .= '"'.$user['identify_customer_personal'].'",';
				$row .= '"'.$user['opening_question'].'",';
				$row .= '"'.$user['acknowledge_customer_reason'].'",';
				$row .= '"'.$user['thank_you_statement'].'",';
				$row .= '"'.$user['asking_permission_to_agenda'].'",';
				$row .= '"'.$user['getting_permission_to_proceed'].'",';
				$row .= '"'.$user['proposing_agenda'].'",';
				$row .= '"'.$user['presenting_call_timeframe'].'",';
				$row .= '"'.$user['getting_permission_to_proceed2'].'",';
				$row .= '"'.$user['identify_challenges'].'",';
				$row .= '"'.$user['historical_impact'].'",';
				$row .= '"'.$user['future_state'].'",';
				$row .= '"'.$user['value_proporsion'].'",';
				$row .= '"'.$user['1st_retension_attempt'].'",';
				$row .= '"'.$user['tactical_hold'].'",';
				$row .= '"'.$user['2nd_retension_attempt'].'",';
				$row .= '"'.$user['comfirmation_of_supersaver'].'",';
				$row .= '"'.$user['daily_special_confirmation'].'",';
				$row .= '"'.$user['made_save_package_offer'].'",';
				$row .= '"'.$user['daily_special'].'",';
				$row .= '"'.$user['verify_customer_info'].'",';
				$row .= '"'.$user['web_login'].'",';
				$row .= '"'.$user['email_capture'].'",';
				$row .= '"'.$user['sms_opt_in'].'",';
				$row .= '"'.$user['documentation'].'",';
				$row .= '"'.$user['thankyou_closing_statement'].'",';
				$row .= '"'.$user['correct_information_to_caller'].'",';
				$row .= '"'.$user['correct_delay_length'].'",';
				$row .= '"'.$user['correctly_use_purity_points'].'",';
				$row .= '"'.$user['soft_skill'].'",';
				$row .= '"'.$user['rapport_building'].'",';
				$row .= '"'.$user['maintain_call_control'].'",';
				$row .= '"'.$user['listening_comprehension'].'",';
				$row .= '"'.$user['unauthorized_shipment'].'",';
				$row .= '"'.$user['inappropiate_language'].'",';
				$row .= '"'.$user['arguing_with_customer'].'",';
				$row .= '"'.$user['incorrect_SS_action_use'].'",';
				$row .= '"'.$user['no_SS_confirmation'].'",';
				$row .= '"'.$user['making_helth_claims'].'",';
				$row .= '"'.$user['on_retension_offer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback1'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['agent_fd_acpt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='mpc'){

			foreach($rr as $user)
			{
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greet_customer_properly'].'",';
				$row .= '"'.$user['use_respectful_tone'].'",';
				$row .= '"'.$user['properly_identify_themselve'].'",';
				$row .= '"'.$user['call_being_recorded'].'",';
				$row .= '"'.$user['alter_customer_information'].'",';
				$row .= '"'.$user['agent_violate_HIPAA'].'",';
				$row .= '"'.$user['agtent_speak_clearly'].'",';
				$row .= '"'.$user['agent_avoid_internal_term'].'",';
				$row .= '"'.$user['agent_demonstrate_strong_use'].'",';
				$row .= '"'.$user['agent_use_please_thankyou'].'",';
				$row .= '"'.$user['agent_minimize_extended_silence'].'",';
				$row .= '"'.$user['agent_speak_sincere_warmth'].'",';
				$row .= '"'.$user['agent_use_correct_sentence'].'",';
				$row .= '"'.$user['agent_demonstarte_patient'].'",';
				$row .= '"'.$user['agent_advise_maryland_Medicaid'].'",';
				$row .= '"'.$user['agent_ask_caller_rectified'].'",';
				$row .= '"'.$user['agent_provide_MPC_customer_advise'].'",';
				$row .= '"'.$user['agent_use_please_through_call'].'",';
				$row .= '"'.$user['agent_transfer_MD_helthcare'].'",';
				$row .= '"'.$user['agent_advise_Medicaid_benefit'].'",';
				$row .= '"'.$user['rep_completely_call_document'].'",';
				$row .= '"'.$user['rep_complete_correct_confirmation'].'",';
				$row .= '"'.$user['rep_thank_caller_before_closing'].'",';
				$row .= '"'.$user['rep_assist_the_caller'].'",';
				$row .= '"'.$user['rep_anticipate_caller_need'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($pid=='cinemark'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['greet_customer_appropriately'].'",';
				$row .= '"'.$user['agent_provide_name'].'",';
				$row .= '"'.$user['agent_ask_how_assist'].'",';

				$row .= '"'.$user['adhere_to_refund_rules'].'",';
				$row .= '"'.$user['transfer_to_inter_super'].'",';
				$row .= '"'.$user['agent_fill_ticket'].'",';
				$row .= '"'.$user['agent_include_th_no'].'",';
				$row .= '"'.$user['agent_leave_correct_note'].'",';
				$row .= '"'.$user['agent_leave_conf_no'].'",';
				$row .= '"'.$user['agent_supply_correct_info'].'",';
        $row .= '"'.$user['agent_able_access_cust_past_transacs'].'",';
        $row .= '"'.$user['agent_appropriate_tone'].'",';
        $row .= '"'.$user['agent_close_correctly'].'",';
        $row .= '"'.$user['agent_complete_necessary_task'].'",';
        $row .= '"'.$user['agent_use_inappropriate_lang'].'",';
        $row .= '"'.$user['agent_provide_cinemark_customer_advise'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='empire'){
			foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['cust_score'].'%'.'",';
				$row .= '"'.$user['busi_score'].'%'.'",';
				$row .= '"'.$user['comp_score'].'%'.'",';

				$row .= '"'.$user['prepared_take_call'].'",';
				$row .= '"'.$user['use_standard_greeting'].'",';
				$row .= '"'.$user['open_call_pleasant'].'",';

				$row .= '"'.$user['use_thank_you'].'",';
				$row .= '"'.$user['use_customer_name'].'",';
				$row .= '"'.$user['professional_communication'].'",';
				$row .= '"'.$user['positive_represent_empire'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['maintain_call_control'].'",';
				$row .= '"'.$user['probe_accurate_need'].'",';
        $row .= '"'.$user['restate_cust_need'].'",';
        $row .= '"'.$user['set_expectation'].'",';
        $row .= '"'.$user['ask_cust_appoint'].'",';
        $row .= '"'.$user['verify_cust_account'].'",';
        $row .= '"'.$user['confirm_all_data'].'",';
        $row .= '"'.$user['provide_acurate_comp_info'].'",';
        $row .= '"'.$user['demo_confidence_info'].'",';
        $row .= '"'.$user['call_correctly'].'",';
        $row .= '"'.$user['overcome_objections'].'",';
        $row .= '"'.$user['comfirm_appointment'].'",';
        $row .= '"'.$user['use_standard_closing'].'",';
        $row .= '"'.$user['inappropriate_language'].'",';
        $row .= '"'.$user['call_avoidance'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=='hcpss'){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['answer_call_promptly'].'",';
				$row .= '"'.$user['introduction_clear_noise'].'",';
				$row .= '"'.$user['use_correct_greeting'].'",';

				$row .= '"'.$user['sound_friendly'].'",';
				$row .= '"'.$user['case_captured_correctly'].'",';
				$row .= '"'.$user['capture_correct_info'].'",';
				$row .= '"'.$user['verify_info'].'",';
				$row .= '"'.$user['add_all_app_notes'].'",';
				$row .= '"'.$user['complete_call_prop'].'",';
				$row .= '"'.$user['sound_confident'].'",';
        $row .= '"'.$user['beyond_requrie'].'",';
        $row .= '"'.$user['answer_caller_question'].'",';
        $row .= '"'.$user['caller_have_attention'].'",';
        $row .= '"'.$user['interrupted_caller'].'",';
        $row .= '"'.$user['use_hold_times'].'",';
        $row .= '"'.$user['call_handled_correctly'].'",';
        $row .= '"'.$user['conf_positive_correct_list'].'",';
        $row .= '"'.$user['saying_negative'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="cmn"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['opening'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['empathy_apology'].'",';

				$row .= '"'.$user['owner_assure'].'",';
				$row .= '"'.$user['tone_speech'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['parallel_conversation'].'",';
				$row .= '"'.$user['issue_identification'].'",';
				$row .= '"'.$user['probing'].'",';
				$row .= '"'.$user['pay_conf'].'",';
        $row .= '"'.$user['refund_process'].'",';
        $row .= '"'.$user['email_id_verification'].'",';
        $row .= '"'.$user['phone_no_verification'].'",';
        $row .= '"'.$user['ztp'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="pilgrim"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['compliancescore'].'",';
				$row .= '"'.$user['customerscore'].'",';
				$row .= '"'.$user['businessscore'].'",';
				$row .= '"'.$user['compliance_score_percent'].'%'.'",';
				$row .= '"'.$user['customer_score_percent'].'%'.'",';
				$row .= '"'.$user['business_score_percent'].'%'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['open_call_within_5sec'].'",';
				$row .= '"'.$user['proper_introduction'].'",';
				$row .= '"'.$user['explain_offer'].'",';
				$row .= '"'.$user['proper_response'].'",';

				$row .= '"'.$user['correct_probe'].'",';
				$row .= '"'.$user['proper_disposition'].'",';
				$row .= '"'.$user['polite_agent'].'",';
				$row .= '"'.$user['minimal_dead_air'].'",';
				$row .= '"'.$user['energy'].'",';
				$row .= '"'.$user['tone_pacing'].'",';
				$row .= '"'.$user['acc_comp_info'].'",';
        $row .= '"'.$user['setup_gold_card'].'",';
        $row .= '"'.$user['disengage_prank_call'].'",';
        if($user['rude_remarks'] == "Yes"){
        	$row .= '"Pass",';

        }else if($user['rude_remarks'] == "No"){
        	$row .= '"Fail",';

        }
        if($user['call_avoidance'] == "Yes"){
        	$row .= '"Pass",';

        }else if($user['call_avoidance'] == "No"){
        	$row .= '"Fail",';
        	
        }

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="bluebenefits"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['greet_the_customer'].'",';
				$row .= '"'.$user['respectful_tone'].'",';
				$row .= '"'.$user['correctly_verify_the_caller'].'",';
				$row .= '"'.$user['willingness_statement'].'",';
				$row .= '"'.$user['professional_manner'].'",';

				$row .= '"'.$user['incomplete_provider'].'",';
				$row .= '"'.$user['incorrectly_quote'].'",';
				$row .= '"'.$user['miss_the_coinsurance'].'",';
				$row .= '"'.$user['incorrectly_give_cr'].'",';
				$row .= '"'.$user['incorrectly_deductible'].'",';
				$row .= '"'.$user['incorrect_information'].'",';
				$row .= '"'.$user['correct_claims_address'].'",';
				$row .= '"'.$user['medical_necessity'].'",';
				$row .= '"'.$user['correctly_dme_coverage'].'",';

				$row .= '"'.$user['speak_clearly'].'",';
				$row .= '"'.$user['internal_terms'].'",';
				$row .= '"'.$user['agent_demonstrate'].'",';
				$row .= '"'.$user['email_communication'].'",';
				$row .= '"'.$user['minimize_extended_silences'].'",';
				$row .= '"'.$user['speak_with_sincere_warmth'].'",';
				$row .= '"'.$user['sentence_structure'].'",';
				$row .= '"'.$user['agent_demonstrate_patience'].'",';

				$row .= '"'.$user['accurately_and_completely_document'].'",';
				$row .= '"'.$user['correct_confirmation_and_closing'].'",';
				$row .= '"'.$user['caller_before_closing'].'",';
				$row .= '"'.$user['possible_to_assist_the_caller'].'",';
				$row .= '"'.$user['anticipate_the_caller'].'",';



       			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="healthbridge"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['correct_information'].'",';
				$row .= '"'.$user['resolved_all'].'",';
				$row .= '"'.$user['added_detailed'].'",';
				$row .= '"'.$user['disposition_the'].'",';
				$row .= '"'.$user['verified_the'].'",';
				$row .= '"'.$user['used_the_verification'].'",';
				$row .= '"'.$user['followed_all_company'].'",';
				$row .= '"'.$user['informed_the_member'].'",';
				$row .= '"'.$user['proper_greeting'].'",';
				$row .= '"'.$user['clear_communication'].'",';
				// $row .= '"'.$user['demonstrated'].'",';
				$row .= '"'.$user['proper_expectations'].'",';
				$row .= '"'.$user['avoided_industry'].'",';
				$row .= '"'.$user['verified_current_address'].'",';
				$row .= '"'.$user['if_applicable_requested'].'",';
				$row .= '"'.$user['if_applicable_the_member'].'",';
				$row .= '"'.$user['did_agent_present'].'",';
				$row .= '"'.$user['did_agent_offer'].'",';
				$row .= '"'.$user['adhered_to_HIPAA'].'",';
				$row .= '"'.$user['used_inappropriate'].'",';
				$row .= '"'.$user['did_agent_repeat'].'",';
				$row .= '"'.$user['call_avoidance'].'",';


       			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        		// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
        		// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=="healthbridgenew"){
			foreach($rr as $user){
					  if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
						  $interval1 = '---';
					  }else{
						  $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
					  }

					  $row = '"'.$user['auditor_name'].'",';
					  $row .= '"'.$user['audit_date'].'",';
					  $row .= '"'.$user['call_date'].'",';
					  $row .= '"'.$user['fusion_id'].'",';
					  $row .= '"'.$user['fname']." ".$user['lname'].'",';
					  $row .= '"'.$user['tl_name'].'",';
					  $row .= '"'.$user['call_duration'].'",';
					  $row .= '"'.$user['file_no'].'",';
					  $row .= '"'.$user['audit_type'].'",';
					  $row .= '"'.$user['auditor_type'].'",';
					  $row .= '"'.$user['voc'].'",';
					  $row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
					  $row .= '"'.ConvServerToLocal($user['entry_date']).'",';
					  $row .= '"'.$interval1.'",';
					  $row .= '"'.$user['earned_score'].'",';
					  $row .= '"'.$user['possible_score'].'",';
					  $row .= '"'.$user['overall_score'].'%'.'",';
					  $row .= '"'.$user['resolved_all'].'",';
					  $row .= '"'.$user['added_detailed'].'",';
					  $row .= '"'.$user['dispositioned'].'",';
					  $row .= '"'.$user['headset'].'",';
					  $row .= '"'.$user['used_the_verification'].'",';
					  $row .= '"'.$user['followed_all_company'].'",';
					  $row .= '"'.$user['proper_greeting'].'",';
					  $row .= '"'.$user['clear_communication'].'",';
					  $row .= '"'.$user['proper_expectations'].'",';
					  $row .= '"'.$user['avoided_industry'].'",';
					  $row .= '"'.$user['verified_current_address'].'",';
					  $row .= '"'.$user['if_applicable_requested'].'",';
					  $row .= '"'.$user['if_applicable_the_member'].'",';
					  $row .= '"'.$user['did_agent_present'].'",';
					  $row .= '"'.$user['did_agent_offer'].'",';
					  $row .= '"'.$user['verified_all'].'",';
					  $row .= '"'.$user['correct_information'].'",';
					  $row .= '"'.$user['regulations'].'",';
					  $row .= '"'.$user['inappropriate'].'",';
					  $row .= '"'.$user['call_avoidance'].'",';

					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';

					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
					  $row .= '"'.$user['agnt_fd_acpt'].'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
					  $row .= '"'.$user['agent_rvw_date'].'",';
					  $row .= '"'.$user['mgnt_rvw_date'].'",';
					  $row .= '"'.$user['mgnt_rvw_name'].'",';
					  $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
					  fwrite($fopen,$row."\r\n");
				  }
				  fclose($fopen);
    } else if($pid=="mcKinsey"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['caller_properly'].'",';
				$row .= '"'.$user['respectful_tone'].'",';
				$row .= '"'.$user['timely_manner'].'",';
				$row .= '"'.$user['appropriately_and_accurately'].'",';
				$row .= '"'.$user['type_of_case'].'",';
				$row .= '"'.$user['dates_and_data'].'",';
				$row .= '"'.$user['cleaning_was_required'].'",';
				$row .= '"'.$user['appropriate_pace'].'",';
				$row .= '"'.$user['call_and_in_email'].'",';
				$row .= '"'.$user['email_communication'].'",';
				$row .= '"'.$user['throughout_the_call'].'",';
				$row .= '"'.$user['her_voice'].'",';
				$row .= '"'.$user['structure_and_grammar'].'",';
				$row .= '"'.$user['demonstrate_patience'].'",';
				$row .= '"'.$user['document_the_call'].'",';
				$row .= '"'.$user['confirmation_and_closing'].'",';
				$row .= '"'.$user['correct_instructions'].'",';
				$row .= '"'.$user['isolation_or_quarantine'].'",';
				$row .= '"'.$user['guidance_letters'].'",';
       			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    } else if($pid=="affinity"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['date_of_birth'].'",';
				$row .= '"'.$user['verify_the_provider'].'",';
				$row .= '"'.$user['you_today'].'",';
				$row .= '"'.$user['great_day'].'",';
				$row .= '"'.$user['seconds_of_silence'].'",';
				$row .= '"'.$user['transfer_script'].'",';
				$row .= '"'.$user['their_needs'].'",';
				$row .= '"'.$user['without_interruptions'].'",';
				$row .= '"'.$user['displayed_empathy'].'",';
				$row .= '"'.$user['review_notes'].'",';
				$row .= '"'.$user['30_seconds'].'",';
				$row .= '"'.$user['on_the_call'].'",';
				$row .= '"'.$user['prevented_escalations'].'",';
				$row .= '"'.$user['first_name'].'",';
				$row .= '"'.$user['taken_off'].'",';
				$row .= '"'.$user['date_information'].'",';
				$row .= '"'.$user['possible_solutions'].'",';
				$row .= '"'.$user['assist_the_caller'].'",';
				$row .= '"'.$user['contact_information'].'",';
				$row .= '"'.$user['category_codes'].'",';
				$row .= '"'.$user['details_and_resolution'].'",';
				$row .= '"'.$user['appropriate_party'].'",';
				$row .= '"'.$user['if_applicable'].'",';
				$row .= '"'.$user['previous_call'].'",';
       			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    } else if($pid=="affinity_pro"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['Disposition'].'",';
				$row .= '"'.$user['Contact'].'",';
				$row .= '"'.$user['LOB'].'",';
				$row .= '"'.$user['State'].'",';
				$row .= '"'.$user['Provider'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['Interaction1'].'",';
				$row .= '"'.$user['Interaction2'].'",';
				$row .= '"'.$user['Interaction3'].'",';
				$row .= '"'.$user['Interaction4'].'",';
				$row .= '"'.$user['Interaction5'].'",';
				$row .= '"'.$user['Interaction6'].'",';
				$row .= '"'.$user['Interaction7'].'",';
				$row .= '"'.$user['Adherence1'].'",';
				$row .= '"'.$user['Adherence2'].'",';
				$row .= '"'.$user['Adherence3'].'",';
				$row .= '"'.$user['Adherence4'].'",';
				$row .= '"'.$user['Adherence5'].'",';
				$row .= '"'.$user['Adherence6'].'",';
				$row .= '"'.$user['Adherence7'].'",';
				$row .= '"'.$user['Adherence8'].'",';
				$row .= '"'.$user['Resolution1'].'",';
				$row .= '"'.$user['Resolution2'].'",';
				$row .= '"'.$user['Resolution3'].'",';
				$row .= '"'.$user['Resolution4'].'",';
				$row .= '"'.$user['Resolution5'].'",';
				$row .= '"'.$user['Applicable1'].'",';
				$row .= '"'.$user['Applicable2'].'",';
				$row .= '"'.$user['Applicable3'].'",';
				$row .= '"'.$user['Molina1'].'",';
				$row .= '"'.$user['Data1'].'",';
				$row .= '"'.$user['Data2'].'",';
       			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="cci_medicare"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['prepared_for_cal'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['positive_tone'].'",';
				$row .= '"'.$user['positive_language'].'",';
				$row .= '"'.$user['address_caller_by_name'].'",';
				$row .= '"'.$user['subcategory'].'",';
				$row .= '"'.$user['referral_second_case'].'",';
				$row .= '"'.$user['documentation_comments'].'",';
				$row .= '"'.$user['documented'].'",';
				$row .= '"'.$user['hold_policy'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['hold_verbiage'].'",';
				$row .= '"'.$user['appropriate_transfer'].'",';
				$row .= '"'.$user['accessed_appropriate_systems'].'",';
				$row .= '"'.$user['policies_procedures'].'",';
				$row .= '"'.$user['timeframes'].'",';
				$row .= '"'.$user['external_telephone'].'",';
				$row .= '"'.$user['offer_additional_assistance'].'",';
				$row .= '"'.$user['offer_survey_appropriately'].'",';
				$row .= '"'.$user['calling_branded_entity'].'",';
				$row .= '"'.$user['information_accuracy'].'",';
				$row .= '"'.$user['completeness'].'",';
				$row .= '"'.$user['actions'].'",';
				$row .= '"'.$user['validate_for_understanding'].'",';
				$row .= '"'.$user['privacy_compliance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    } else if($pid=="cci_commercial"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['prepared_for_cal'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['positive_tone'].'",';
				$row .= '"'.$user['positive_language'].'",';
				$row .= '"'.$user['address_caller_by_name'].'",';
				$row .= '"'.$user['subcategory'].'",';
				$row .= '"'.$user['referral_second_case'].'",';
				$row .= '"'.$user['documentation_comments'].'",';
				$row .= '"'.$user['documented'].'",';
				$row .= '"'.$user['hold_policy'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['hold_verbiage'].'",';
				$row .= '"'.$user['appropriate_transfer'].'",';
				$row .= '"'.$user['accessed_appropriate_systems'].'",';
				$row .= '"'.$user['policies_procedures'].'",';
				$row .= '"'.$user['timeframes'].'",';
				$row .= '"'.$user['external_telephone'].'",';
				$row .= '"'.$user['offer_additional_assistance'].'",';
				$row .= '"'.$user['offer_survey_appropriately'].'",';
				$row .= '"'.$user['calling_branded_entity'].'",';
				$row .= '"'.$user['information_accuracy'].'",';
				$row .= '"'.$user['completeness'].'",';
				$row .= '"'.$user['actions'].'",';
				$row .= '"'.$user['validate_for_understanding'].'",';
				$row .= '"'.$user['privacy_compliance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }else if($pid=="lockheed"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				//$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['Opening_Script'].'",';
				$row .= '"'.$user['throughout'].'",';
				$row .= '"'.$user['necessary'].'",';
				$row .= '"'.$user['purpose'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['script'].'",';
				$row .= '"'.$user['polite'].'",';
				$row .= '"'.$user['skills'].'",';
				$row .= '"'.$user['questions'].'",';
				$row .= '"'.$user['Contacts'].'",';
				$row .= '"'.$user['process1'].'",';
				$row .= '"'.$user['Record'].'",';
				$row .= '"'.$user['Dates'].'",';
				$row .= '"'.$user['tools'].'",';
				$row .= '"'.$user['information'].'",';
				$row .= '"'.$user['Required'].'",';
				$row .= '"'.$user['comments'].'",';
				$row .= '"'.$user['Complete'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    } else if($pid=="compliance"){
      foreach($rr as $user){
				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$user['auditor_name'].'",';
				$row .= '"'.$user['audit_date'].'",';
        		$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
        		$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['compliance'].'",';
				$row .= '"'.$user['compliance_issue_type'].'",';
				$row .= '"'.$user['compliance_reason'].'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
        		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
    }
	}


///////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////// QA AGENT COACHING REPORT ////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_agent_coaching_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_agent_coaching_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_agent_coaching_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$from_date = $this->input->get('date_from');
				$to_date = $this->input->get('date_to');
				$office_id = $this->input->get('office_id');
				$cond="";

				if($from_date==""){
					$from_date=CurrDate();
				}else{
					$from_date = mmddyy2mysql($from_date);
				}

				if($to_date==""){
					$to_date=CurrDate();
				}else{
					$to_date = mmddyy2mysql($to_date);
				}

				if($from_date !="" && $to_date!=="" )  $cond= " Where (Q.audit_date >= '$from_date' and Q.audit_date <= '$to_date')";

				if($office_id=="All") $cond .= "";
				else $cond .=" and S.office_id='$office_id'";

				if(get_global_access()=='1' || $client_id==0 || get_user_fusion_id()=='FHIG000001' || get_user_fusion_id()=='FKOL002150'){
					$cond1="";
				}else if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (S.assigned_to='$current_user' OR S.assigned_to in (SELECT id FROM signin where S.assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And S.assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				/* $qSql="SELECT call_date,call_id,
				(select concat(fname, ' ', lname) from signin s where s.id=qa_coaching_mgnt_rvw.entry_by) as mgnt_name,
				qa_coaching_mgnt_rvw.comment as mgnt_note, qa_coaching_mgnt_rvw.entry_date as mgnt_feedback,
				(select office_abbr from site where site.id=(SELECT site_id from signin where id=qa_coaching_feedback.agent_id)) as site_name,
				(select fullname from client c where c.id=(SELECT client_id from info_assign_client where user_id=qa_coaching_feedback.agent_id)) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=qa_coaching_feedback.entry_by) as auditor_name, audit_date,
				(select fusion_id from signin s where s.id=qa_coaching_feedback.agent_id) as fusion_id,
				(select office_id from signin s where s.id=qa_coaching_feedback.agent_id) as office_id,
				(select concat(fname, ' ', lname) from signin s where s.id=qa_coaching_feedback.agent_id) as agent_name,
				(select concat(fname, ' ', lname) from signin s where s.id=(SELECT `assigned_to` FROM `signin` WHERE id=qa_coaching_feedback.agent_id)) as tl_name,
				(select name from process p where p.id=(SELECT `process_id` FROM info_assign_process as iap WHERE iap.user_id=qa_coaching_feedback.agent_id)) as process_name,
				(select entry_date from qa_coaching_agent_rvw qag where qag.cf_id=qa_coaching_feedback.id) as agent_feedback,
				(select comment from qa_coaching_agent_rvw qag where qag.cf_id=qa_coaching_feedback.id) as agent_note from qa_coaching_feedback
				INNER JOIN qa_coaching_mgnt_rvw on qa_coaching_feedback.id=qa_coaching_mgnt_rvw.cf_id $cond $cond1 order by audit_date"; */

				$qSql="SELECT Q.*, S.fusion_id, S.office_id, S.dept_id, CONCAT(S.fname, ' ', S.lname) as agent_name, CONCAT(T.fname, ' ', T.lname) as tl_name, get_process_names(Q.agent_id) AS process_name, D.description as dept_name,
						QC.entry_date as agent_fd_date, QC.comment as agent_feedback, CONCAT(A.fname, ' ', A.lname) AS auditor_name,
						QMC.entry_date as mgnt_fd_date, QMC.comment as mgnt_feedback, CONCAT(CM.fname, ' ', CM.lname) AS mgnt_fd_name
						from qa_coaching_feedback Q
						inner join signin S on Q.agent_id = S.id
						inner join signin T on T.id = S.assigned_to
						inner join signin A on Q.entry_by=A.id
						inner join signin CM on Q.agent_id = CM.id
						left join qa_coaching_agent_rvw QC on QC.cf_id = Q.id
						left join qa_coaching_mgnt_rvw QMC on QMC.cf_id = Q.id
						left join department D on D.id = S.dept_id
						$cond $cond1 group by QMC.cf_id";
        //die;
				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_agent_coaching_list"] = $fullAray;
				$this->create_qa_agent_coaching_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_agent_coaching_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $from_date;
			$data['date_to'] = $to_date;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_agent_coaching_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Agent Coaching List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

  //RCA Level 1
  public function rca_level1(){
    return array("system"=>"System","ability"=>"Ability","will"=>"Will","health"=>"Health","cap_issue"=>"Capacity Issue","environment"=>"Environment");
  }

  //RCA Level 2
  public function rca_level2(){
    return array(
      "system_limitation"=>"System Limitation",
      "system_downtime"=>"System Downtime",
      "know_gap"=>"Knowledge Gap",
      "comm_gap"=>"Communication Gap",
      "skill"=>"Skill",
      "identified_out"=>"Identified Outlier",
      "behavorial_issue"=>"Behavorial Issue",
      "lack_of_motive"=>"Lack of Motivation",
      "attend_issue"=>"Attendance Issue",
      "high_call_volume"=>"High Call Volume",
      "background_noise"=>"Background Noise",
      "location"=>"Location",
      "override_access"=>"Override Access",
      "client_acc_req"=>"Client Access Requirement",
      "internet_issue"=>"Internet Issue",
      "hard_issue"=>"Hardware Issue",
      "soft_inaccess"=>"Tool/Software Inaccessible",
      "ineffect_train"=>"Ineffective Training",
      "poor_retention"=>"Poor Retention",
      "poor_update_cascade"=>"Poor Update Cascade",
      "lang_barrier"=>"Language Barrier",
      "poor_comprehension"=>"Poor Comprehension",
      "poor_multi_task_sill"=>"Poor Multi-Tasking Skill"
    );
  }

  //RCA Level 3
  public function rca_level3(){
    return array(
      "client_acc_req"=>"Client Access Requirement",
      "override_access"=>"Override Access",
      "internet_issue"=>"Internet Issue",
      "hard_issue"=>"Hardware Issue",
      "soft_inaccess"=>"Tool/Software Inaccessible",
      "ineffect_train"=>"Ineffective Training",
      "poor_retention"=>"Poor Retention",
      "poor_update_cascade"=>"Poor Update Cascade",
      "lang_barrier"=>"Language Barrier",
      "poor_comprehension"=>"Poor Comprehension",
      "poor_multi_task_sill"=>"Poor Multi-Tasking Skill",
      "compensation"=>"Compensation",
      "lost_hours"=>"Lost Hours",
      "attrition"=>"Attrition"
    );
  }

	public function create_qa_agent_coaching_CSV($rr){
    $rca_level1=$this->rca_level1();
    $rca_level2=$this->rca_level2();
    $rca_level3=$this->rca_level3();
		// print_r($rr);
		// exit;
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Process","site", "Call ID", "RCA Level 1", "RCA Level 2", "RCA Level 3", "Coaching Reason", "Coaching Department", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['agent_name'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['process_name'].'",';
			$row .= '"'.$user['office_id'].'",';
			$row .= '"'.$user['call_id'].'",';
      $row .= '"'.$rca_level1[$user['rca_level1']].'",';
      $row .= '"'.$rca_level2[$user['rca_level2']].'",';
      $row .= '"'.$rca_level3[$user['rca_level3']].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", strip_tags($user['coaching_reason']))).'",';
			$row .= '"'.$user['dept_name'].'",';
			$row .= '"'.$user['agent_fd_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", strip_tags($user['agent_feedback']))).'",';
			$row .= '"'.$user['mgnt_fd_date'].'",';
			$row .= '"'.$user['mgnt_fd_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", strip_tags($user['mgnt_feedback']))).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////// QA AMAZON REPORT /////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////

	public function qa_amazon_intake_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_amazon_intake_report.php";

			$office_id = $this->input->get('office_id');
			if($office_id=="")  $office_id=$user_office_id;

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$pValue = trim($this->input->post('process_id'));
			if($pValue=="") $pValue = trim($this->input->get('process_id'));
			$data['pValue']=$pValue;

			$data["qa_amazon_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if($pValue=='Intake'){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, DATE_FORMAT(entry_date,'%m-%Y') AS m_Y from qa_amazon_intake_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_amazon_intake_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_amazon_intake_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_amazon_list"] = $fullAray;
					$this->create_qa_amazon_intake_CSV($fullAray,$pValue);
					$dn_link = base_url()."reports_qa/download_qa_amazon_intake_CSV/".$pValue;
				}
				if($pValue=='Question'){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, DATE_FORMAT(entry_date,'%m-%Y') AS m_Y from qa_amazon_question_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_amazon_question_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_amazon_question_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_amazon_list"] = $fullAray;
					$this->create_qa_amazon_intake_CSV($fullAray,$pValue);
					$dn_link = base_url()."reports_qa/download_qa_amazon_intake_CSV/".$pValue;
				}

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


///////////////////////////Amazon Intake///////////////////////////
	public function download_qa_amazon_intake_CSV($type)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		if($type == "Intake")
		{
			$newfile="QA Amazon Intake Audit List-'".$currDate."'.csv";
		}
		else
		{
			$newfile="QA Amazon Question Audit List-'".$currDate."'.csv";
		}


		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_amazon_intake_CSV($rr,$type)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Review week", "Case Number", "Call ID", "Audit Date", "CM/CSR/IA Name", "Agent ID", "Site", "Follow up needed?", "Ops Manager", "Auditor Name", "Employee Status", "Product", "SECTION 1: CALL HANDLING", "SECTION 2: PERSONAL SERVICE", "SECTION 3: KNOWLEDGE", "SECTION 4: IA SPECIFIC", "Asks revelvant probing questions", "Solves problems", "Answers questions", "Addresses concerns within a timely and helpful manner", "Anticipates the callers needs and is proactive", "Informs caller what to expect during the call", "How the CM/CSR handles the call and level sets expectations", "2 min max hold time with reason for hold", "Asks permission to be placed on hold", "Hold not used more than twice", "Listens to caller to determine if referral to vendor partner is required", "Sets appropriate task based on caller need", "Confirm caller email or reg mail preference for correspondence", "Follows outbound call security measures", "Tone", "Exhibits Empathy", "Conversational vs Transactional", "Refrains from use of Jargon", "Uses coherent complete and concise sentences", "Avoids slang and inappropriate topics", "Asks appropriate questions regarding the context of the call", "Anticipates the callers needs and is proactive in handling the situation", "Conversation is solution focused", "Does not hand call off to another care/case manager", "Handles and offers opinions", "Holistic Review", "Reiterates what the call was about and indicates action items", "Confirms EE understanding", "Follows best practice measures for call validation/security", "Did they promote the use of the self service portal on the call?", "Used correct closure script", "Asked if they had other questions", "Thanked caller", "Transfered to call survey if applicable", "Claim notes reflect the content of the converstation", "Provided accurate details about eligibility", "Provider Contact Information documented accurately in 360", "Clinical Information documented accurately in 360", "360 AMZ PTO task was entered when appropriate", "Obtained EE emergency contact information", "Conducted EE Interview in the employee had time", "EE was educated accurately on the RTW process", "360 EE Interview task was thoroughly documented based on the call", "360 was correctly documented if the Provider can be contacted", "360 Work Place Injury indicator selected appropriately", "360 Leave Reason was selected appropriately", "360 was documented with applicable notes related to the case", "360 leave dates were documented correctly based on callers information", "Possible Point", "Correct Point", "Incorrect Point", "Overall Score", "1 Count of Pass", "2 Count of Pass", "3 Count of Pass", "4 Count of Pass", "Review Month/Year", "Call Summary", "Feedback", "Audit Type", "VOC", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{

			if($user['call_probing']==1) $call_probing='Pass';
			else $call_probing=1;
			if($user['call_solve']==1) $call_solve='Pass';
			else $call_solve=1;
			if($user['call_question']==1) $call_question='Pass';
			else $call_question=1;
			if($user['call_address']==1) $call_address='Pass';
			else $call_address=1;
			if($user['call_proactive']==1) $call_proactive='Pass';
			else $call_proactive=1;
			if($user['call_inform']==1) $call_inform='Pass';
			else $call_inform=1;
			if($user['call_csr']==1) $call_csr='Pass';
			else $call_csr=1;
			if($user['call_hold']==1) $call_hold='Pass';
			else $call_hold=1;
			if($user['call_permission']==1) $call_permission='Pass';
			else $call_permission=1;
			if($user['call_twice']==1) $call_twice='Pass';
			else $call_twice=1;
			if($user['call_listen']==1) $call_listen='Pass';
			else $call_listen=1;
			if($user['call_task']==1) $call_task='Pass';
			else $call_task=1;
			if($user['call_email']==1) $call_email='Pass';
			else $call_email=1;
			if($user['call_outbound']==1) $call_outbound='Pass';
			else $call_outbound=1;
			if($user['personal_tone']==1) $personal_tone='Pass';
			else $personal_tone=1;
			if($user['personal_exhibit']==1) $personal_exhibit='Pass';
			else $personal_exhibit=1;
			if($user['personal_conversion']==1) $personal_conversion='Pass';
			else $personal_conversion=1;
			if($user['personal_refrain']==1) $personal_refrain='Pass';
			else $personal_refrain=1;
			if($user['personal_coherent']==1) $personal_coherent='Pass';
			else $personal_coherent=1;
			if($user['personal_avoid']==1) $personal_avoid='Pass';
			else $personal_avoid=1;
			if($user['knowledge_ask']==1) $knowledge_ask='Pass';
			else $knowledge_ask=1;
			if($user['knowledge_anticipate']==1) $knowledge_anticipate='Pass';
			else $knowledge_anticipate=1;
			if($user['knowledge_focus']==1) $knowledge_focus='Pass';
			else $knowledge_focus=1;
			if($user['knowledge_care']==1) $knowledge_care='Pass';
			else $knowledge_care=1;
			if($user['knowledge_handle']==1) $knowledge_handle='Pass';
			else $knowledge_handle=1;
			if($user['knowledge_holistic']==1) $knowledge_holistic='Pass';
			else $knowledge_holistic=1;
			if($user['knowledge_item']==1) $knowledge_item='Pass';
			else $knowledge_item=1;
			if($user['knowledge_confirm']==1) $knowledge_confirm='Pass';
			else $knowledge_confirm=1;
			if($user['knowledge_security']==1) $knowledge_security='Pass';
			else $knowledge_security=1;
			if($user['knowledge_promote']==1) $knowledge_promote='Pass';
			else $knowledge_promote=1;
			if($user['knowledge_script']==1) $knowledge_script='Pass';
			else $knowledge_script=1;
			if($user['knowledge_question']==1) $knowledge_question='Pass';
			else $knowledge_question=1;
			if($user['knowledge_caller']==1) $knowledge_caller='Pass';
			else $knowledge_caller=1;
			if($user['knowledge_survey']==1) $knowledge_survey='Pass';
			else $knowledge_survey=1;
			if($user['knowledge_claim']==1) $knowledge_claim='Pass';
			else $knowledge_claim=1;
			if($user['ia_eligibility']==1) $ia_eligibility='Pass';
			else $ia_eligibility=1;
			if($user['ia_contact']==1) $ia_contact='Pass';
			else $ia_contact=1;
			if($user['ia_clinical']==1) $ia_clinical='Pass';
			else $ia_clinical=1;
			if($user['ia_amz']==1) $ia_amz='Pass';
			else $ia_amz=1;
			if($user['ia_emergency']==1) $ia_emergency='Pass';
			else $ia_emergency=1;
			if($user['ia_interview']==1) $ia_interview='Pass';
			else $ia_interview=1;
			if($user['ia_rtw']==1) $ia_rtw='Pass';
			else $ia_rtw=1;
			if($user['ia_call']==1) $ia_call='Pass';
			else $ia_call=1;
			if($user['ia_provider']==1) $ia_provider='Pass';
			else $ia_provider=1;
			if($user['ia_work']==1) $ia_work='Pass';
			else $ia_work=1;
			if($user['ia_leave']==1) $ia_leave='Pass';
			else $ia_leave=1;
			if($user['ia_note']==1) $ia_note='Pass';
			else $ia_note=1;
			if($user['ia_documentation']==1) $ia_documentation='Pass';
			else $ia_documentation=1;

			$dateString = $user['audit_date'];
			  list($year, $month, $mday) = explode("-", $dateString);
			  $firstWday = date("w",strtotime("$year-$month-1"));
			  $week = floor(($mday + $firstWday - 1)/7) + 1;

			$incorrect_score = ($user['possible_score'] - $user['earned_score']);
			$call_handle = ($user['call_handle_possible'] - $user['call_handle_earned']);
			$personal_service = ($user['personal_service_possible'] - $user['personal_service_earned']);
			$knowledge = ($user['knowledge_possible'] - $user['knowledge_earned']);
			$ia_specific = ($user['ia_specific_possible'] - $user['ia_specific_earned']);

			$row = '"'.$week.'",';
			$row .= '"'.$user['case_no'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['office_id'].'",';
			$row .= '"'.$user['followup_need'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['emp_status'].'",';
			$row .= '"'.$user['product'].'",';
			$row .= '"'.$user['call_handle_score'].'",';
			$row .= '"'.$user['personal_service_score'].'",';
			$row .= '"'.$user['knowledge_score'].'",';
			$row .= '"'.$user['ia_specific_score'].'",';
			$row .= '"'.$call_probing.'",';
			$row .= '"'.$call_solve.'",';
			$row .= '"'.$call_question.'",';
			$row .= '"'.$call_address.'",';
			$row .= '"'.$call_proactive.'",';
			$row .= '"'.$call_inform.'",';
			$row .= '"'.$call_csr.'",';
			$row .= '"'.$call_hold.'",';
			$row .= '"'.$call_permission.'",';
			$row .= '"'.$call_twice.'",';
			$row .= '"'.$call_listen.'",';
			$row .= '"'.$call_task.'",';
			$row .= '"'.$call_email.'",';
			$row .= '"'.$call_outbound.'",';
			$row .= '"'.$personal_tone.'",';
			$row .= '"'.$personal_exhibit.'",';
			$row .= '"'.$personal_conversion.'",';
			$row .= '"'.$personal_refrain.'",';
			$row .= '"'.$personal_coherent.'",';
			$row .= '"'.$personal_avoid.'",';
			$row .= '"'.$knowledge_ask.'",';
			$row .= '"'.$knowledge_anticipate.'",';
			$row .= '"'.$knowledge_focus.'",';
			$row .= '"'.$knowledge_care.'",';
			$row .= '"'.$knowledge_handle.'",';
			$row .= '"'.$knowledge_holistic.'",';
			$row .= '"'.$knowledge_item.'",';
			$row .= '"'.$knowledge_confirm.'",';
			$row .= '"'.$knowledge_security.'",';
			$row .= '"'.$knowledge_promote.'",';
			$row .= '"'.$knowledge_script.'",';
			$row .= '"'.$knowledge_question.'",';
			$row .= '"'.$knowledge_caller.'",';
			$row .= '"'.$knowledge_survey.'",';
			$row .= '"'.$knowledge_claim.'",';
			$row .= '"'.$ia_eligibility.'",';
			$row .= '"'.$ia_contact.'",';
			$row .= '"'.$ia_clinical.'",';
			$row .= '"'.$ia_amz.'",';
			$row .= '"'.$ia_emergency.'",';
			$row .= '"'.$ia_interview.'",';
			$row .= '"'.$ia_rtw.'",';
			$row .= '"'.$ia_call.'",';
			$row .= '"'.$ia_provider.'",';
			$row .= '"'.$ia_work.'",';
			$row .= '"'.$ia_leave.'",';
			$row .= '"'.$ia_note.'",';
			$row .= '"'.$ia_documentation.'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$incorrect_score.'",';
			$row .= '"'.$user['overall_score']."%".'",';
			$row .= '"'.$call_handle.'",';
			$row .= '"'.$personal_service.'",';
			$row .= '"'.$knowledge.'",';
			$row .= '"'.$ia_specific.'",';
			$row .= '"'.$user['m_Y'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

/////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// QA ACM REPORT ////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_acm_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_acm_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_acm_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name from qa_acm_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) Left join (Select fd_id, note as agent_note, date(entry_date) as agent_rvw_date from qa_acm_agent_rvw) zz on (xx.id=zz.fd_id) Left Join (Select fd_id as mgnt_fd_id, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as mgnt_name, note as mgnt_note, date(entry_date) as mgnt_rvw_date from qa_acm_mgnt_rvw) ww on (xx.id=ww.mgnt_fd_id) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_acm_list"] = $fullAray;
				$this->create_qa_acm_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_acm_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_acm_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ACM Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_acm_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call ID", "Call Date", "Call Duration", "Claim/Policy", "Call Type", "Can be Automated", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Customer Score", "Business Score", "Compliance Score", "Openning", "Process and Procedure", "Education", "Closing", "Voice Delivery", "listening Skills", "Communication Skills", "Customer Service", "QA Comments", "Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['claim_policy'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['can_automated'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['customer_score'].'%'.'",';
			$row .= '"'.$user['business_score'].'%'.'",';
			$row .= '"'.$user['compliance_score'].'%'.'",';
			$row .= '"'.$user['scripted_opening'].'",';
			$row .= '"'.$user['call_flow'].'",';
			$row .= '"'.$user['educate_customer'].'",';
			$row .= '"'.$user['close_script'].'",';
			$row .= '"'.$user['evident_smile'].'",';
			$row .= '"'.$user['listening_acknow'].'",';
			$row .= '"'.$user['grammer_pronoun'].'",';
			$row .= '"'.$user['ownership_polite'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['comment'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}


/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// Zovio Follet ////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_zovio_follet_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_zovio_follet_report.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = $this->input->get('campaign');
			if($campaign=="follet"){
				$cmp_tbl="qa_amd_follet_feedback";
			}else if($campaign=="zovio"){
				$cmp_tbl="qa_zovio_feedback";
			}

			$data["qa_zovio_follet_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}


				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from $cmp_tbl) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_zovio_follet_list"] = $fullAray;
				$this->create_qa_zovio_follet_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_zovio_follet_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_zovio_follet_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_zovio_follet_CSV($rr,$campaign)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=='follet'){
			$header = array("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Phone","Call Date","Call Duration","File No","Audit Type","Auditor Type","VOC","Audit Start Time","Audit End Time","Interval (in second)","Overall Score ","Possible Score ","Earned Score ","Did the rep greet the caller promptly and properly? ","Did the rep use a pleasant respectful tone? ","Did the rep answer in a timely manner? ","Did the rep collect and verify the customers information appropriately and accurately? ","Did the rep correctly collect caller's work location and store phone number ","Did the agent correctly define Type of Case? ","Did the rep correctly mark the Date of Test and Expected Results? ","Did the rep correctly idently the Team Member's store location using the provided Excel sheet? ","Did the agent speak clearly concisely and at an appropriate pace? ","Did the agent demonstrate a strong use of empathy in responses where required on the call and in email? ","Did the agent use (please) and (thank you) throughout the call and in email communication? ","Did the agent minimize extended silences throughout the call? ","Did the agent speak with sincere warmth in his/her voice? ","Did the agent use correct sentence structure and grammar in email commumnication? ","Did the agent demonstrate patience with the caller on call and in email communication? ","Did the caller give the agent a KUDOS or express happiness with the rep during this call? ","Did the rep accurately and completely document the call? ","Did the rep complete the correct confirmation and closing? ","Did the rep provide the correct instructions based upon the Type of Case? ","Did the rep do everything possible to assist the caller? ","Did the rep make appropriate phone calls to managers and Health Dept ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Call Summary ","Feedback","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
		}else if($campaign=='zovio'){
			$header = array("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Number","Call Type","Caller Type","Audit Type","Auditor Type", "VOC","Audit Start Time","Audit End Time","Interval (in second)","Overall Score ","Possible Score ","Earned Score ","Did the rep greet the caller promptly and properly? ","Did the rep use a pleasant respectful tone? ","Did the rep answer in a timely manner?","Did the rep collect and verify the customers information appropriately and accurately?","Did the rep correctly collect callers work location and store phone number","Did the agent correctly define Type of Case?","Did the rep correctly mark the Date of Test and Expected Results?","2.5 Did the rep correctly record the callers address?","Did the agent speak clearly concisely and at an appropriate pace?","Did the agent demonstrate a strong use of empathy in responses where required on the call and in email? ","Did the agent use please and thank you throughout the call and in email communication?","Did the agent minimize extended silences throughout the call?","Did the agent speak with sincere warmth in his/her voice? ","Did the agent use correct sentence structure and grammar in email commumnication? ","Did the agent demonstrate patience with the caller on call and in email communication? ","Did the caller give the agent a KUDOS or express happiness with the rep during this call? ","Did the rep accurately and completely document the call? ","Did the rep complete the correct confirmation and closing? ","Did the rep provide the correct instructions based upon the Type of Case? ","Did the rep do everything possible to assist the caller? ","Did the rep make appropriate phone calls to managers and Health Dept ","Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20 ","Comments 21 ","Call Summary ","Feedback ","Client entry by ","Mgnt review by ","Mgnt review note ","Mgnt review date ","Agent review note ","Agent review date ","Client review by ","Client review note ","Client_rvw_date");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='follet'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['identifynameatbeginning'].'",';
				$row .= '"'.$user['assurancetsatementverbatim'].'",';
				$row .= '"'.$user['msbFinancial'].'",';
				$row .= '"'.$user['speakingtorightparty'].'",';
				$row .= '"'.$user['SbSResolution'].'",';
				$row .= '"'.$user['demographicsinformation'].'",';
				$row .= '"'.$user['minimirandadisclosure'].'",';
				$row .= '"'.$user['statetheclientname'].'",';
				$row .= '"'.$user['askforbalancedue'].'",';
				$row .= '"'.$user['completeinformationtaken'].'",';
				$row .= '"'.$user['askforpaymentonphone'].'",';
				$row .= '"'.$user['askforpostdelaypayment'].'",';
				$row .= '"'.$user['accountforfollowupcall'].'",';
				$row .= '"'.$user['promisetopayaccount'].'",';
				$row .= '"'.$user['splitbalanceinpart'].'",';
				$row .= '"'.$user['offersumsettlement'].'",';
				$row .= '"'.$user['paymentplanwithpayment'].'",';
				$row .= '"'.$user['collectorfollowpropernegotiation'].'",';
				$row .= '"'.$user['didcerpromote'].'",';
				$row .= '"'.$user['didceranswer'].'",';
				$row .= '"'.$user['wascerproactive'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='zovio'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_no'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['rep_greet_caller'].'",';
				$row .= '"'.$user['rep_use_pleasant_tone'].'",';
				$row .= '"'.$user['rep_answer_timely'].'",';
				$row .= '"'.$user['rep_collect_customer_info'].'",';
				$row .= '"'.$user['rep_collect_caller_location'].'",';
				$row .= '"'.$user['agent_define_case_type'].'",';
				$row .= '"'.$user['rep_marked_test_date'].'",';
				$row .= '"'.$user['rep_record_caller_address'].'",';
				$row .= '"'.$user['agent_speak_clearly'].'",';
				$row .= '"'.$user['agent_demonstrate_call_email'].'",';
				$row .= '"'.$user['agent_use_please_through_call'].'",';
				$row .= '"'.$user['agent_minimize_silence_on_call'].'",';
				$row .= '"'.$user['agent_speak_sincere_voice'].'",';
				$row .= '"'.$user['agent_use_correct_sentence'].'",';
				$row .= '"'.$user['agent_demonstrate_call_patience'].'",';
				$row .= '"'.$user['caller_give_agnet_KUDOS'].'",';
				$row .= '"'.$user['rep_completely_document_call'].'",';
				$row .= '"'.$user['rep_complete_closing'].'",';
				$row .= '"'.$user['rep_provide_correct_instruction'].'",';
				$row .= '"'.$user['rep_assist_the_caller'].'",';
				$row .= '"'.$user['rep_make_appropiate_contact'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}


	}


/////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// QA Nuwave REPORT ////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_nuwave_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_nuwave_report.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_nuwave_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}


				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_amd_nuwave_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_nuwave_list"] = $fullAray;
				$this->create_qa_nuwave_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_nuwave_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_qa_nuwave_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Nuwave Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_nuwave_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "File No", "Order ID", "Call Duration", "Interaction", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greeting & Identification: Example Thank you for calling NuWave", "Asked and Verified Customer Information: May I please have your Order ID Primary name or e-mail address?", "Used the Callers Name: CSR should address the customer as he/she addresses him/herself Mr. Mrs. Dr. Rev. etc.", "Active Listening: Doesnt interrupt the customer understands customers frame of reference doesnt anticipate or make assumptions", "Communication Skills: Converses in a clear concise manner", "Professionalism: Avoids the use of slang jargon and acronyms", "Empathy Towards Customer: CSR sounds sincere about helping the customer and apologizes", "Courtesy: CSR sounds helpful upbeat friendly and patient", "Put On Hold: Asked customer May I put you on hold or Could you hold while I research this further please?", "Thanked Customer for Holding: CSR thanked customer for holding upon returning to customers call", "Hold Time/Reason Appropriate/Inappropriate: Was it really necessary for the CSR to put the customer on hold?", "Escalation/Referral Procedures: Utilized established guidelines and procedures policy from the leadership team", "Fact Finding: Used probing questions and resources to identify problem", "Verbally Verified Problem Reported: Clearly defined and restated needs reported by the customer", "Managed Customer Expectations: Regarding the order of the product and the shipping time", "Explained: Reason for troubleshooting for possible resolution", "Used Available Resources Well: Referred to knowledge training or other resource programs for order troubleshooting", "Complete & Accurate Customer Documentation: Complete description of the order and or the troubleshooting steps", "Trial Close: Confirmed customer is comfortable with outcome", "Additional Needs Uncovered: CSR asked Is there anything else that I can assist you with today?", "Upsale: Ask customer if the product completely serves their needs", "Used Correct Closing Gave Customer Order Number: Mr. Ms. Mrs. I would like to thank you for ordering with NuWave", "Infractions", "Sub-Infractions", "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval = '---';
			}else{
				$interval = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['file_no'].'",';
			$row .= '"'.$user['order_id'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['interaction'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['greeting_identification'].'",';
			$row .= '"'.$user['verified_customer'].'",';
			$row .= '"'.$user['use_caller_CSR_name'].'",';
			$row .= '"'.$user['doesnot_interrupt_customer'].'",';
			$row .= '"'.$user['converses_clear_concise_mannaer'].'",';
			$row .= '"'.$user['avoid_use_slang_jargon'].'",';
			$row .= '"'.$user['empathy_toward_customer'].'",';
			$row .= '"'.$user['CSR_sound_helpful'].'",';
			$row .= '"'.$user['gain_customer_permission'].'",';
			$row .= '"'.$user['thanks_customer_holding'].'",';
			$row .= '"'.$user['hold_time_appropiate'].'",';
			$row .= '"'.$user['utilized_established_guidelines'].'",';
			$row .= '"'.$user['use_probing_question'].'",';
			$row .= '"'.$user['verbally_verfied_problem'].'",';
			$row .= '"'.$user['manage_customer_expectation'].'",';
			$row .= '"'.$user['reason_for_troubleshooting'].'",';
			$row .= '"'.$user['use_available_resources'].'",';
			$row .= '"'.$user['complete_customer_documentation'].'",';
			$row .= '"'.$user['customer_comfortable_with_outcome'].'",';
			$row .= '"'.$user['additional_needs_uncovered'].'",';
			$row .= '"'.$user['product_served_their_needs'].'",';
			$row .= '"'.$user['used_correct_closing'].'",';
			$row .= '"'.$user['infractions'].'",';
			$row .= '"'.$user['sub_infractions'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}

/////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////// QA Magnilife REPORT ////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
	public function qa_magnilife_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_magnilife_report.php";
			$data["content_js"] = "qa_ameridial_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			$campaign ="magnilife";

			$data["qa_magnilife_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('from_date'));
				$date_to = mmddyy2mysql($this->input->get('to_date'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					//$cond .=" and audit_type='All'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}

                 $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_magnilife_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_magnilife_list"] = $fullAray;
				$this->create_qa_magnilife_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_magnilife_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['process_id']=$campaign;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_qa_magnilife_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_magnilife_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","File No","Call Date","Call Duration","Audit Type","VOC","disposition","Posible Score","Earned Score","Overall Score",
		"The agent adhered to suggested greeting and sounds friendly","The agent uses customers name at least 3 time in the call","The agent used please and thank you when appropiate","The agent sound willing to help good energy when speaking to the customer","The agent sounds clear and professional","The agents does not interrumpt the caller when speaking","The agent showed appreciation when applicable","The agent showed empathy when applicable","The agent addressed properly when placing the caller on mute","The agent keeps the control of the call","The agent makes good use of FAQs to rebuttal any possible sale when applicable","The agent reads offer properly includes prices and mentions plus shipping and handling","The agent answers product related questions properly does not lie to the customer","The agent works efficiently to complete the purpose of the call","The agent answers company related questions properly","The agent confirms the billing information","The agent read summary of the order properly including prices","The agent provides order number before ending the call","The agent asked if there was anything else he/she can help with","The agent adhered to suggested closing",
		"Call Summary","Feedback","Agent Feedback Acceptance","Agent review date","Agent review Note","Mgnt review Date","Mgnt review by","Mgnt review note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['file_no'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['theagentadhered'].'",';
			$row .= '"'.$user['theagenplease'].'",';
			$row .= '"'.$user['theagentused'].'",';
			$row .= '"'.$user['theagen'].'",';
			$row .= '"'.$user['theagentsoundsc'].'",';
			$row .= '"'.$user['theagentsdoesnot'].'",';
			$row .= '"'.$user['theagentshowedappr'].'",';
			$row .= '"'.$user['theagentshowedem'].'",';
			$row .= '"'.$user['theagent'].'",';
			$row .= '"'.$user['theagentkeepst'].'",';
			$row .= '"'.$user['theagentma'].'",';
			$row .= '"'.$user['theagentreadso'].'",';
			$row .= '"'.$user['theagentansw'].'",';
			$row .= '"'.$user['theagentw'].'",';
			$row .= '"'.$user['theage'].'",';
			$row .= '"'.$user['theagentconfirmst'].'",';
			$row .= '"'.$user['theagentr'].'",';
			$row .= '"'.$user['theagecall'].'",';
			$row .= '"'.$user['theagenta'].'",';
			$row .= '"'.$user['theagentadhere'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");

		}
		fclose($fopen);

	}



///////////////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////
////////////////////////// HSDL ////////////////////////////
////////////////////////////////////////////////////////////
	public function qa_hsdl_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_hsdl_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_hsdl_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}


				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_hsdl_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_hsdl_list"] = $fullAray;
				$this->create_qa_hsdl_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_hsdl_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_hsdl_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA HSDL Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_hsdl_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Earned Score", "Possible Score", "Overall Score", "Call opening meets standards of engagement", "Risk Category", "Tier Category", "T&C sent in 3-5 working days", "Risk Category", "Tier Category", "Banned practices are not used", "Risk Category", "Tier Category", "Read Manufacturer Warranty script", "Risk Category", "Tier Category", "Products and services were accurately described", "Risk Category", "Tier Category", "may used for describing replacement", "Risk Category", "Tier Category", "aim used to describe PP and replacement service", "Risk Category", "Tier Category", "Did not use Reinstate or Renew", "Risk Category", "Tier Category", "Identified signs of cover in place", "Risk Category", "Tier Category", "Followed the switch over process", "Risk Category", "Tier Category", "Good working order question asked", "Risk Category", "Tier Category", "Identifying signs of a pre-existing fault", "Risk Category", "Tier Category", "Brand name and the approximate age question asked", "Risk Category", "Tier Category", "If Brand not known asked to call in within 14 days", "Risk Category", "Tier Category", "Banned practices are not used Discount not described", "Risk Category", "Tier Category", "Agent matches product to customer needs", "Risk Category", "Tier Category", "Agent provides accurate savings information", "Risk Category", "Tier Category", "Agent confirms name address", "Risk Category", "Tier Category", "Total Cost Confirmed", "Risk Category", "Tier Category", "Agent confirms the address the card is registered at", "Risk Category", "Tier Category", "Call paused at payment details", "Risk Category", "Tier Category", "Total Cost of plan clear and understood", "Risk Category", "Tier Category", "Payment Frequency confirmed", "Risk Category", "Tier Category", "Frequency of payments clear and understood", "Risk Category", "Tier Category", "DD script read verbatim or customer is referred to a confirmation letter", "Risk Category", "Tier Category", "Payment Unsuccessful Script read", "Risk Category", "Tier Category", "T&C sent in 3-5 working days", "Risk Category", "Tier Category", "Cancellation Rights read", "Risk Category", "Tier Category", "Opt in Question asked and Opt out statement read", "Risk Category", "Tier Category", "Wording of Policy and Premium", "Risk Category", "Tier Category", "Script for limited cover read if Premium plan price declined", "Risk Category", "Tier Category", "Agent is professional throughout the call", "Risk Category", "Tier Category", "Opt in status accurately recorded", "Risk Category", "Tier Category", "Identifying clear signs of vulnerability", "Risk Category", "Tier Category", "Followed procedure for handling vulnerable customers", "Risk Category", "Tier Category", "Made clear its not insurance", "Risk Category", "Tier Category", "Company name stated 3 times in a call", "Risk Category", "Tier Category", "No facts or assumptions about a competitor stated", "Risk Category", "Tier Category", "Did not speak in a negative manor towards a competitor", "Risk Category", "Tier Category", "Sales Score", "Business Score", "Compliance Score", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			//$row .= '"'.$user['customer_no'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['sales_score'].'%'.'",';
			$row .= '"'.$user['business_score'].'%'.'",';
			$row .= '"'.$user['compliance_score'].'%'.'",';
			$row .= '"'.$user['call_opening'].'",';
			$row .= '"'.$user['risk_cat1'].'",';
			$row .= '"'.$user['tier_cat1'].'",';
			$row .= '"'.$user['TC_send'].'",';
			$row .= '"'.$user['risk_cat2'].'",';
			$row .= '"'.$user['tier_cat2'].'",';
			$row .= '"'.$user['banned_practices'].'",';
			$row .= '"'.$user['risk_cat3'].'",';
			$row .= '"'.$user['tier_cat3'].'",';
			$row .= '"'.$user['read_manufacture_warranty'].'",';
			$row .= '"'.$user['risk_cat4'].'",';
			$row .= '"'.$user['tier_cat4'].'",';
			$row .= '"'.$user['product_described'].'",';
			$row .= '"'.$user['risk_cat5'].'",';
			$row .= '"'.$user['tier_cat5'].'",';
			$row .= '"'.$user['describe_replacement'].'",';
			$row .= '"'.$user['risk_cat6'].'",';
			$row .= '"'.$user['tier_cat6'].'",';
			$row .= '"'.$user['describe_PP_replacement'].'",';
			$row .= '"'.$user['risk_cat7'].'",';
			$row .= '"'.$user['tier_cat7'].'",';
			$row .= '"'.$user['not_use_reinstate'].'",';
			$row .= '"'.$user['risk_cat8'].'",';
			$row .= '"'.$user['tier_cat8'].'",';
			$row .= '"'.$user['identified_signs'].'",';
			$row .= '"'.$user['risk_cat9'].'",';
			$row .= '"'.$user['tier_cat9'].'",';
			$row .= '"'.$user['switch_over_process'].'",';
			$row .= '"'.$user['risk_cat10'].'",';
			$row .= '"'.$user['tier_cat10'].'",';
			$row .= '"'.$user['good_working_order'].'",';
			$row .= '"'.$user['risk_cat11'].'",';
			$row .= '"'.$user['tier_cat11'].'",';
			$row .= '"'.$user['preexisting_fault'].'",';
			$row .= '"'.$user['risk_cat12'].'",';
			$row .= '"'.$user['tier_cat12'].'",';
			$row .= '"'.$user['approximate_age_question'].'",';
			$row .= '"'.$user['risk_cat13'].'",';
			$row .= '"'.$user['tier_cat13'].'",';
			$row .= '"'.$user['brand_not_known_asked'].'",';
			$row .= '"'.$user['risk_cat14'].'",';
			$row .= '"'.$user['tier_cat14'].'",';
			$row .= '"'.$user['brand_practice_not_use'].'",';
			$row .= '"'.$user['risk_cat15'].'",';
			$row .= '"'.$user['tier_cat15'].'",';
			$row .= '"'.$user['agent_matches_product'].'",';
			$row .= '"'.$user['risk_cat16'].'",';
			$row .= '"'.$user['tier_cat16'].'",';
			$row .= '"'.$user['agent_provide_saving_info'].'",';
			$row .= '"'.$user['risk_cat17'].'",';
			$row .= '"'.$user['tier_cat17'].'",';
			$row .= '"'.$user['confirm_name_address'].'",';
			$row .= '"'.$user['risk_cat18'].'",';
			$row .= '"'.$user['tier_cat18'].'",';
			$row .= '"'.$user['total_cost_confirm'].'",';
			$row .= '"'.$user['risk_cat19'].'",';
			$row .= '"'.$user['tier_cat19'].'",';
			$row .= '"'.$user['confirm_registered_card'].'",';
			$row .= '"'.$user['risk_cat20'].'",';
			$row .= '"'.$user['tier_cat20'].'",';
			$row .= '"'.$user['call_paused_payment'].'",';
			$row .= '"'.$user['risk_cat21'].'",';
			$row .= '"'.$user['tier_cat21'].'",';
			$row .= '"'.$user['cost_of_plan_clear'].'",';
			$row .= '"'.$user['risk_cat22'].'",';
			$row .= '"'.$user['tier_cat22'].'",';
			$row .= '"'.$user['payment_frequency_confirm'].'",';
			$row .= '"'.$user['risk_cat23'].'",';
			$row .= '"'.$user['tier_cat23'].'",';
			$row .= '"'.$user['payment_frequency_understood'].'",';
			$row .= '"'.$user['risk_cat24'].'",';
			$row .= '"'.$user['tier_cat24'].'",';
			$row .= '"'.$user['DD_script_read_customer'].'",';
			$row .= '"'.$user['risk_cat25'].'",';
			$row .= '"'.$user['tier_cat25'].'",';
			$row .= '"'.$user['payment_unsuccessful'].'",';
			$row .= '"'.$user['risk_cat26'].'",';
			$row .= '"'.$user['tier_cat26'].'",';
			$row .= '"'.$user['TC_sent_in_3_5_days'].'",';
			$row .= '"'.$user['risk_cat27'].'",';
			$row .= '"'.$user['tier_cat27'].'",';
			$row .= '"'.$user['cancellation_rights_read'].'",';
			$row .= '"'.$user['risk_cat28'].'",';
			$row .= '"'.$user['tier_cat28'].'",';
			$row .= '"'.$user['question_asked_statement_read'].'",';
			$row .= '"'.$user['risk_cat29'].'",';
			$row .= '"'.$user['tier_cat29'].'",';
			$row .= '"'.$user['wording_of_policy_premium'].'",';
			$row .= '"'.$user['risk_cat30'].'",';
			$row .= '"'.$user['tier_cat30'].'",';
			$row .= '"'.$user['script_for_limited_cover_read'].'",';
			$row .= '"'.$user['risk_cat31'].'",';
			$row .= '"'.$user['tier_cat31'].'",';
			$row .= '"'.$user['professional_throughout_call'].'",';
			$row .= '"'.$user['risk_cat32'].'",';
			$row .= '"'.$user['tier_cat32'].'",';
			$row .= '"'.$user['status_accurately_recorded'].'",';
			$row .= '"'.$user['risk_cat33'].'",';
			$row .= '"'.$user['tier_cat33'].'",';
			$row .= '"'.$user['identify_clear_sign'].'",';
			$row .= '"'.$user['risk_cat34'].'",';
			$row .= '"'.$user['tier_cat34'].'",';
			$row .= '"'.$user['handle_vulnerable_customer'].'",';
			$row .= '"'.$user['risk_cat35'].'",';
			$row .= '"'.$user['tier_cat35'].'",';
			$row .= '"'.$user['clear_its_not_insurance'].'",';
			$row .= '"'.$user['risk_cat36'].'",';
			$row .= '"'.$user['tier_cat36'].'",';
			$row .= '"'.$user['company_name_stated_3times'].'",';
			$row .= '"'.$user['risk_cat37'].'",';
			$row .= '"'.$user['tier_cat37'].'",';
			$row .= '"'.$user['competitor_stated'].'",';
			$row .= '"'.$user['risk_cat38'].'",';
			$row .= '"'.$user['tier_cat38'].'",';
			$row .= '"'.$user['not_speak_negetive_manner'].'",';
			$row .= '"'.$user['risk_cat39'].'",';
			$row .= '"'.$user['tier_cat39'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}


////////////////////////////////////////////////////////////////////////////
//////////////////////////////// K2 Claims /////////////////////////////////
////////////////////////////////////////////////////////////////////////////
	public function qa_k2_claims_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_k2_claims_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_k2_claims_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}


				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_k2_claims_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_k2_claims_list"] = $fullAray;
				$this->create_qa_k2_claims_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_k2_claims_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_k2_claims_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA K2 Claims Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_k2_claims_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_k2_claims";
		$edit_url = "add_edit_k2_claims";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call ID", "Claim/Policy", "Call Duration", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "OPENING", "LISTENING SKILLS", "COMMUNICATION SKILLS", "VOICE DELIVERY", "CLOSING", "FNOL Form", "CUSTOMER SERVICE", "PROCESS AND PROCEDURE", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_id'].'",';
			$row .= '"'.$user['claim_policy'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['opening'].'",';
			$row .= '"'.$user['listening_skill'].'",';
			$row .= '"'.$user['communication_skill'].'",';
			$row .= '"'.$user['voice_delivary'].'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'.$user['FNOL_from'].'",';
			$row .= '"'.$user['customer_service'].'",';
			$row .= '"'.$user['process_procedure'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);


	}

//////////////////////////////////////////////////////////////////////////
/////////////////////////// SHIP YOUR CAR NOW ////////////////////////////
//////////////////////////////////////////////////////////////////////////
	public function qa_sycn_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_sycn_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_sycn_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}


				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_sycn_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_sycn_list"] = $fullAray;
				$this->create_qa_sycn_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_sycn_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_sycn_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="Ship Your Car Now Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_sycn_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_sycn";
		$edit_url = "add_edit_sycn";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Caller ID", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Autofail", "Overall Score", "Customer Critical", "Business Critical", "Compliance Critical", "Did the agent welcome the carrier with the name and company?", "Did the agent acknowledge empathize and gave assurance?", "Did the agent responded appropriately and in a timely manner?", "Did the agent listen actively and intently to the carrier?", "Did the agent use correct Hold procedure?", "Was the agent polite and professional throughout the interaction and remained courteous and helpful?", "Did the agent thank the carrier and give proper closing?", "Did the agent verify that the caller is associated with the order or the person on record?", "Did the agent convey every detail of the process clearly and accurately?", "Did the agent escalate the concern as needed?", "Did the agent use good judgement and decision making while resolving or assisting the carrier?", "Did the agent leave complete notes and proper documentation?", "Did the agent follow correct or proper procedure based on company policy?", "Did the agent use correct pronunciation and proper diction?", "Was the agent easy to understand grammar?", "Remarks1", "Remarks2", "Remarks3", "Remarks4", "Remarks5", "Remarks6", "Remarks7", "Remarks8", "Remarks9", "Remarks10", "Remarks11", "Remarks12", "Remarks13", "Remarks14", "Remarks15", "Call Summary", "Feedback", "Agent Acceptance Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['caller_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['sycn_autofail'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['customer_score'].'%'.'",';
			$row .= '"'.$user['business_score'].'%'.'",';
			$row .= '"'.$user['compliance_score'].'%'.'",';
			$row .= '"'.$user['agent_welcome_carrier'].'",';
			$row .= '"'.$user['agent_acknowledge'].'",';
			$row .= '"'.$user['agent_responded_appropiately'].'",';
			$row .= '"'.$user['agent_listen_actively'].'",';
			$row .= '"'.$user['agent_use_hold_procedure'].'",';
			$row .= '"'.$user['agent_polite_professional'].'",';
			$row .= '"'.$user['agent_thank_carrier'].'",';
			$row .= '"'.$user['agent_verify_caller'].'",';
			$row .= '"'.$user['agent_convey_every_details'].'",';
			$row .= '"'.$user['agent_escalate_concern'].'",';
			$row .= '"'.$user['agent_use_good_jugment'].'",';
			$row .= '"'.$user['agent_leave_complete_notes'].'",';
			$row .= '"'.$user['agent_follow_correct_procedure'].'",';
			$row .= '"'.$user['agent_use_correct_pronounce'].'",';
			$row .= '"'.$user['agent_understand_grammar'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}
	public function qa_sycn_outbound_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_sycn_outbound_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_sycn_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}


				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_sycn_outbound_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_sycn_list"] = $fullAray;
				$this->create_qa_sycn_outbound_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_sycn_outbound_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_sycn_outbound_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="Ship Your Car Now Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_sycn_outbound_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_sycn";
		$edit_url = "add_edit_sycn_outbound";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Caller ID", "Audit Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Autofail","Possible Score","Earn Score","Overall Score","Customer Critical", "Business Critical", "Compliance Critical", "Did the agent introduce self and company of support to the carrier?", "Remarks1","Did the agent inform the customer that the call may be recorded?","Remarks2", "Did the agent verify order ID to the carrier?", "Remarks3","Did the agent ask who they are speaking with?", "Remarks4","Did the agent acknowledge empathize and give assurance?", "Remarks5","Did the agent demonstrate active listening?","Remarks6", "Avoid long period of silence and long hold during the call?", "Remarks7", "Did the agent leave complete notes and proper documentation?","Remarks8", "Was the agent polite and professional throughout the interaction and remained courteous and helpful?", "Remarks9", "Did the agent thank carrier and give proper closing?","Remarks10", "Call Summary", "Feedback", "Agent Acceptance Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['caller_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['sycn_autofail'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['customer_score'].'%'.'",';
			$row .= '"'.$user['business_score'].'%'.'",';
			$row .= '"'.$user['compliance_score'].'%'.'",';
			$row .= '"'.$user['the_carrier'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'.$user['be_recorded'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'.$user['order_ID'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'.$user['speaking_with'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'.$user['give_assurance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'.$user['during_the_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'.$user['proper_documentation'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'.$user['courteous_and_helpful'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			// $row .= '"'.$user['ending_the_call'].'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'.$user['proper_closing'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}

//////////////////////////////////////////////////////////////////////////
////////////////////////////// EDUTECH ///////////////////////////////////
//////////////////////////////////////////////////////////////////////////

/*------- CUEMATH ------*/
	public function qa_edtech_cuemath_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_edtech_cuemath_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = $this->input->get('campaign');

			$data["qa_edutech_cuemath_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_edtech_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_edutech_cuemath_list"] = $fullAray;
				$this->create_qa_edutech_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_edutech_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_edutech_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_edutech_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=="cuemath"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date", "Call Type", "Agent Disposition", "Disposition Validation", "Demo Scheduled", "Follow-up Call Done", "Customer interested", "Demo Scheduling Accuracy", "Demo Qualification Confirmed", "Contact Number", "Disposition Status", "Student ID", "Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Call opening meets standards of engagement", "Branding", "Stated the purpose of Call or Product Introduction in shown in short", "Seek Permission", "Language Preference", "Active Listening or Interruption", "Personalization", "Hold/Refreshing the hold","Dead Air/Mute on call", "**Sentence Construction & Grammar / Professionalism", "Confident & Energetic on call", "Voice Modulation/Pace level/Clear on call", "**Explain Complete & Accurate product Knowledge", "Effective Probing", "Convincing Skills/Create need", "Objection Handling & Effective rebuttals", "**Data Capturing", "**Resummarization Mandatory information", "Proper closing", "**Dispositon", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="cuemath_hygiene"){
			$header = array("Hygiene Audit Type", "Audit Date", "MSISDN", "Agent Name", "Fusion ID", "L1 Super", "Call Date", "Process", "Call Duration", "Disposition Selected", "Correct Disposition", "Valid/Invalid", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Call back date and time captured", "Followup done", "Demo Status", "DEMO Schedule as per the customer convience time or Requeird by us", "Conversation probality", "Alternate number Pitching or not", "ACPT", "L1", "Audit Observations", "VOC", "Auditor Name", "DoJ", "Today", "AON Days", "Tenurity", "Week", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="cuemath_new"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date", "Call Duration", "Call Type", "Agent Disposition", "Correct Disposition", "Customer interested", "Demo Status", "Invalid Reasons", "Contact Number", "Disposition Status", "Student ID", "Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Professionalism", "Time Duration Stamp with Remarks", "Data Capturing", "Time Duration Stamp with Remarks", "Resummarization", "Time Duration Stamp with Remarks", "Dispositon", "Time Duration Stamp with Remarks", "L1 Defect", "L2 Defect", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="cuemath_script"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date", "Call Duration", "Phone Number", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score", "Earned Score", "Overall Score", "Greeting & Self Introduction with Company name", "Branding & Probing", "Hook Line", "Neutral Accents", "Mirror & Match", "City/State Phone Number Time Zone Parent Availibility", "Proposing date & time curriculum", "Student Name Grade Email ID Alternate contact number", "Session Brief", "Mandatory Information", "Summarization", "Take Aways of the session", "Opt in to be confirmed", "Convincing Skills/Creating need", "Objection Handling & Effective rebuttals", "Proper closing", "Proper Closing of NIs", "Dispositon", "Call Opening Remarks1", "Call Opening Remarks2", "Call Opening Remarks3", "Call Handeling Skill Remarks1", "Call Handeling Skill Remarks2", "Data Capturing Remarks1", "Data Capturing Remarks2", "Data Capturing Remarks3", "Correct And complete Information Remarks", "Mandatory information Remarks1", "Mandatory information Remarks2", "Mandatory information Remarks3", "Mandatory information Remarks4", "Selling Skill Remarks1", "Selling Skill Remarks2", "Closing Remarks1", "Closing Remarks2", "Closing Remarks3", "Demo Status", "Invalid Reasons", "L1", "L2", "Call Observation", "ACPT", "ACPT Reason", "Script Adherence", "Disposition Selected", "Customer Feedback on Opt IN", "Ethnicity", "NI Analysis", "Lead source", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="democuemath"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date","Call Duration", "Phone Number","country","partner_name", "Audit Type", "VOC","Earned Score","Possible Score","Overall Score","Greeting self Introduction","Branding","Stated Purpose Call","Seek Permission","Language Preference","Active Listening Interruption","Personalization","Hold Refreshing","Dead air mute call","Sentence Construction","Confident Energetic","Voice Modulation","Child grade name confirmed","Laptop desktope confirmation","Child Analyis","Cummath Product Brif","Session Brief","Session take aways","Summarization","Proper Closing","Disposition","Demo audit type","Status","Invalid Reason","ACPT","ACPT Reason","Area of opportunity","Script Adherence","Call Summary","Feedback","Audit Start Date Time","Audit End Date Time","Interval(In Second)","Management Review Note","Management Review Date","Mgnt Review By","Agent Review Note","Agent Feedback ACPT","Agent Review Date","Client Review Note","Client Review Name","Client Review Date");
		}else if($campaign=="cuemathnew"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date", "Call Duration", "Phone Number", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Possible Score", "Earned Score", "Overall Score","Confidence","Tone","Content","Engagement","Call Etiquette","Force Scheduling","Product Knowledge","Introduction","Branding","Kid Details","Demo Slot","Parent Details","Logistics","Price","Summarizing","Rebuttal Handling","Incorrect Disposition","Confidence Remark","Tone Remark","Content","Engagement Remark","Call Etiquette Remark","Force Scheduling Remark","Product Knowledge Remark","Introduction Remark","Branding Remark","Kid Details Remark","Demo Slot Remark","Parent Details Remark","Logistics Remark","Price Remark","Summarizing Remark","Rebuttal Handling Remark","Incorrect Disposition Remark","Observation","Demo Status", "Invalid Reasons", "L1", "L2", "Call Observation", "ACPT", "ACPT Reason", "Script Adherence", "Disposition Selected", "Customer Feedback on Opt IN", "Ethnicity", "NI Analysis", "Lead source", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=="cuemath")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['demo_schld'].'",';
				$row .= '"'.$user['call_followup'].'",';
				$row .= '"'.$user['customer_interest'].'",';
				$row .= '"'.$user['schdl_accuracy'].'",';
				$row .= '"'.$user['demo_qualification'].'",';
				$row .= '"'.$user['contact_no'].'",';
				$row .= '"'.$user['disposition_status'].'",';
				$row .= '"'.$user['student_id'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greeting'].'",';
				$row .= '"'.$user['branding'].'",';
				$row .= '"'.$user['call_started_purpose'].'",';
				$row .= '"'.$user['seek_permission'].'",';
				$row .= '"'.$user['language_preference'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['personalization'].'",';
				$row .= '"'.$user['hold_refreshing'].'",';
				$row .= '"'.$user['mute_dead_air'].'",';
				$row .= '"'.$user['grammer_sentence'].'",';
				$row .= '"'.$user['energetic_on_call'].'",';
				$row .= '"'.$user['voice_modulation'].'",';
				$row .= '"'.$user['explain_product_knowledge'].'",';
				$row .= '"'.$user['effective_probing'].'",';
				$row .= '"'.$user['convincing_skill'].'",';
				$row .= '"'.$user['objection_handling'].'",';
				$row .= '"'.$user['data_capturing'].'",';
				$row .= '"'.$user['resummarization'].'",';
				$row .= '"'.$user['proper_closing'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($campaign=="cuemath_hygiene")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['go_live_date']=="" || $user['go_live_date']=='0000-00-00'){
					$aon_interval = '---';
				}else{
					$aon_interval = ((strtotime($currDate) - strtotime($user['go_live_date']))/86400);
				}

				$row = '"'.$user['hygiene_audit_type'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['msisdn'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['valid_invalid'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['call_back_date_capture'].'",';
				$row .= '"'.$user['followup_done'].'",';
				$row .= '"'.$user['demo_status'].'",';
				$row .= '"'.$user['customer_demo_schedule'].'",';
				$row .= '"'.$user['conversation_probality'].'",';
				$row .= '"'.$user['number_pitching'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['failure_reason1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['failure_reason2'])).'",';
				$row .= '"'.$auditorName.'",';
				$row .= '"'.$user['doj'].'",';
				$row .= '"'.$currDate.'",';
				$row .= '"'.$aon_interval.'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($campaign=="cuemath_new")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['customer_interest'].'",';
				$row .= '"'.$user['schdl_accuracy'].'",';
				$row .= '"'.$user['invalid_reason'].'",';
				$row .= '"'.$user['contact_no'].'",';
				$row .= '"'.$user['disposition_status'].'",';
				$row .= '"'.$user['student_id'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['professionalism'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['professionalism_remarks'])).'",';
				$row .= '"'.$user['data_capturing'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['data_capturing_remarks'])).'",';
				$row .= '"'.$user['resummarization'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['resummarization_remarks'])).'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['disposition_remarks'])).'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($campaign=="cuemath_script")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['greeting_self_introduction'].'",';
				$row .= '"'.$user['branding_probing'].'",';
				$row .= '"'.$user['hook_line'].'",';
				$row .= '"'.$user['natural_accents'].'",';
				$row .= '"'.$user['mirror_match'].'",';
				$row .= '"'.$user['state_phone_number'].'",';
				$row .= '"'.$user['proposing_date_time'].'",';
				$row .= '"'.$user['student_name_grade'].'",';
				$row .= '"'.$user['session_brief'].'",';
				$row .= '"'.$user['mandatory_information'].'",';
				$row .= '"'.$user['summarization'].'",';
				$row .= '"'.$user['session_take_away'].'",';
				$row .= '"'.$user['confirm_opt'].'",';
				$row .= '"'.$user['convincing_skill'].'",';
				$row .= '"'.$user['objection_handling'].'",';
				$row .= '"'.$user['proper_closing'].'",';
				$row .= '"'.$user['proper_NIS_closing'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'.$user['demo_status'].'",';
				$row .= '"'.$user['cuemath_invalid_reason'].'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['acpt_reason'].'",';
				$row .= '"'.$user['script_adherence'].'",';
				$row .= '"'.$user['disposition_selected'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_opt_feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ethnicity'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ni_analysis'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['lead_source'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($campaign=="cuemathnew")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['confidence'].'",';
				$row .= '"'.$user['tone'].'",';
				$row .= '"'.$user['content'].'",';
				$row .= '"'.$user['engagement'].'",';
				$row .= '"'.$user['call_etiquette'].'",';
				$row .= '"'.$user['force_scheduling'].'",';
				$row .= '"'.$user['product_knowledge'].'",';
				$row .= '"'.$user['introduction'].'",';
				$row .= '"'.$user['branding'].'",';
				$row .= '"'.$user['kid_details'].'",';
				$row .= '"'.$user['demo_slot'].'",';
				$row .= '"'.$user['parent_details'].'",';
				$row .= '"'.$user['logistics'].'",';
				$row .= '"'.$user['price'].'",';
				$row .= '"'.$user['summarizing'].'",';
				$row .= '"'.$user['rebuttal_handling'].'",';
				$row .= '"'.$user['incorrect_disposition'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'.$user['observation'].'",';
				$row .= '"'.$user['demo_status'].'",';
				$row .= '"'.$user['cuemath_invalid_reason'].'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['acpt_reason'].'",';
				$row .= '"'.$user['script_adherence'].'",';
				$row .= '"'.$user['disposition_selected'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['customer_opt_feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ethnicity'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ni_analysis'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['lead_source'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($campaign=="democuemath"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}


				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone_number'].'",';
				$row .= '"'.$user['country'].'",';
				$row .= '"'.$user['partner_name'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['greeting_self_introduction'].'",';
				$row .= '"'.$user['branding'].'",';
				$row .= '"'.$user['stated_purpose_call'].'",';
				$row .= '"'.$user['seek_permission'].'",';
				$row .= '"'.$user['language_preference'].'",';
				$row .= '"'.$user['active_listening_interruption'].'",';
				$row .= '"'.$user['personalization'].'",';
				$row .= '"'.$user['hold_refreshing'].'",';
				$row .= '"'.$user['dead_air_mute_call'].'",';
				$row .= '"'.$user['sentence_construction'].'",';
				$row .= '"'.$user['confident_energetic'].'%'.'",';
				$row .= '"'.$user['voice_modulation'].'",';
				$row .= '"'.$user['child_grade_name_confirmed'].'",';
				$row .= '"'.$user['laptop_desktope_confirmation'].'",';
				$row .= '"'.$user['child_analyis'].'",';
				$row .= '"'.$user['cummath_product_brif'].'",';
				$row .= '"'.$user['session_brief'].'",';
				$row .= '"'.$user['session_take_aways'].'",';
				$row .= '"'.$user['summarization'].'",';
				$row .= '"'.$user['proper_closing'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['demo_audit_type'].'",';
				$row .= '"'.$user['status'].'",';
				$row .= '"'.$user['invalid_reason'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['acpt_reason'].'",';
				$row .= '"'.$user['area_of_opportunity'].'",';
				$row .= '"'.$user['script_adherence'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				//$row .= '"'.$user['entry_by'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_note'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'.$user['client_rvw_date'].'",';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

	}

	/*------- Report Queen and English ------*/
	public function qa_queens_english_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_queens_english_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = "queens_english";

			$data["qa_queens_english_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_queens_english_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_queens_english_list"] = $fullAray;
				$this->create_qa_queens_english_CSV($fullAray,$campaign);
				$dn_link = base_url()."qa_edutech/download_qa_queens_english_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_queens_english_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_queens_english_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=="queens_english"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date","Demo Scheduled","Agent Disposition","Disposition Validation","Demo Scheduling Accuracy","Contact Number","Customer interested","Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Greeting & Self Introduction","Branding & Probing","Soft/comm skill", "Parents Name Student Name Grade Email ID WhatsApp number","Proposing date & time slot","Session Brief","Mandatory Information (Tech Detail)","Summarization","Benefits of demo","Convincing Skills / Creating need","Objection Handling & Effective rebuttals","Proper closing","Disposition","Call Summary","Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=="queens_english")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['demo_scheduled'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['disposition_validation'].'",';
				$row .= '"'.$user['scheduling_accuracy'].'",';
				$row .= '"'.$user['contact_number'].'",';
				$row .= '"'.$user['customer_interested'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['greeting_self_introduction'].'",';
				$row .= '"'.$user['branding_probing'].'",';
				$row .= '"'.$user['soft_comm_skill'].'",';
				$row .= '"'.$user['parents_student_name'].'",';
				$row .= '"'.$user['proposing_date'].'",';
				$row .= '"'.$user['session_brief'].'",';
				$row .= '"'.$user['mandatory_information'].'",';
				$row .= '"'.$user['summarization'].'",';
				$row .= '"'.$user['benefits_of_demo'].'",';
				$row .= '"'.$user['convincing_skills'].'",';
				$row .= '"'.$user['objection_handling'].'",';
				$row .= '"'.$user['proper_closing'].'",';
				$row .= '"'.$user['disposition'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

	}

/*------- LIDO ------*/
	public function qa_edtech_lido_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_edtech_lido_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = $this->input->get('campaign');

			$data["qa_edutech_lido_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_edtech_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_edutech_lido_list"] = $fullAray;
				$this->create_qa_lido_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_lido_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_lido_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_lido_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=="lido"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date", "Agent Disposition", "Disposition Validation", "Demo Scheduled","Customer interested","Demo Scheduling Accuracy", "Contact Number","Week", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)","Earned Score","Possible Score","Overall Score","Greeting & Self Introduction with Company name","Branding & Probing","Soft skill","Phone Number Time Zone Parent Availibility","Proposing date & time curriculum","Parents Name Student Name Grade Email ID Whats Up number Language pref","Session Brief","Mandatory Information (Tech Detail)","Summarization","Benefits of demo","Convincing Skills / Creating need","Objection Handling & Effective rebuttals","Proper closing","Dispositon","Invalid Demo Reason:","Observation","Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="lido_hygiene"){
			$header = array("Hygiene Audit Type", "Audit Date", "MSISDN", "Agent Name", "Fusion ID", "L1 Super", "Call Date", "Process", "Call Duration", "Disposition Selected", "Correct Disposition", "Valid/Invalid", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Call back date and time captured", "Followup done", "Demo Status", "DEMO Schedule as per the customer convience time or Requeird by us", "Conversation probality", "Alternate number Pitching or not", "ACPT", "L1", "Audit Observations", "VOC", "Auditor Name", "DoJ", "Today", "AON Days", "Tenurity", "Week", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=="lido")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['demo_schld'].'",';
				$row .= '"'.$user['customer_interest'].'",';
				$row .= '"'.$user['schdl_accuracy'].'",';
				$row .= '"'.$user['contact_no'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'%'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['greeting_self_introduction'].'",';
				$row .= '"'.$user['branding_probing'].'",';
				$row .= '"'.$user['soft_skill'].'",';
				$row .= '"'.$user['phone_time_parent'].'",';
				$row .= '"'.$user['proposing_date'].'",';
				$row .= '"'.$user['parent_student_grade'].'",';
				$row .= '"'.$user['session_brief'].'",';
				$row .= '"'.$user['mandatory_information'].'",';
				$row .= '"'.$user['summarization'].'",';
				$row .= '"'.$user['benefits_of_demo'].'",';
				$row .= '"'.$user['convincing_skills'].'",';
				$row .= '"'.$user['objection_handling'].'",';
				$row .= '"'.$user['proper_closing'].'",';
				$row .= '"'.$user['dispositon'].'",';
                $row .= '"'.$user['invalid_demo_reason'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($campaign=="lido_hygiene")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['go_live_date']=="" || $user['go_live_date']=='0000-00-00'){
					$aon_interval = '---';
				}else{
					$aon_interval = ((strtotime($currDate) - strtotime($user['go_live_date']))/86400);
				}

				$row = '"'.$user['hygiene_audit_type'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['msisdn'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['valid_invalid'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['call_back_date_capture'].'",';
				$row .= '"'.$user['followup_done'].'",';
				$row .= '"'.$user['demo_status'].'",';
				$row .= '"'.$user['customer_demo_schedule'].'",';
				$row .= '"'.$user['conversation_probality'].'",';
				$row .= '"'.$user['number_pitching'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['failure_reason1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['failure_reason2'])).'",';
				$row .= '"'.$auditorName.'",';
				$row .= '"'.$user['doj'].'",';
				$row .= '"'.$currDate.'",';
				$row .= '"'.$aon_interval.'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

	}

/*------- BEYONDSKOOL ------*/
	public function qa_edtech_beyondskool_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_edtech_beyondskool_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign=$this->input->get('campaign');

			$data["qa_edutech_beyondskool_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_edtech_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_edutech_beyondskool_list"] = $fullAray;
				$this->create_qa_beyondskool_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_beyondskool_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_beyondskool_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_beyondskool_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=="beyondskool"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Type", "Call Duration", "Contact Number", "Disposition", "Disposition Validation", "Customer interested", "Demo Scheduling Accuracy", "Demo Realization", "Demo Qualification Confirm", "Invalid Reason", "L1", "L2", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Greeting With Company Name Right Party Confirmation", "Purpose Of Call With Welcome Note", "Politeness On Call / Enthusiasm / Empathy", "Active Listening / Repetition On Call/ Rate Of Speech", "Confidence On Call / Energy / Clarity In Speech", "Dead Air/ Mute on call", "Explain about Subject/ Procedure", "Benefits for the child", "Explain about DEMO session", "Laptop/Desktop Webcam & Microphone Strong internet connection Updated Google chrome", "Student name Grade E-mail ID", "Objection Handling & Effective rebuttals", "Convincing Skills/Create need", "Summarization Not done", "Mandatory information shared", "Standard closing missing", "FA Missing", "Tagging Dispositon", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="beyondskool_hygiene"){
			$header = array("Hygiene Audit Type", "Audit Date", "MSISDN", "Agent Name", "Fusion ID", "L1 Super", "Call Date", "Process", "Call Duration", "Disposition Selected", "Correct Disposition", "Valid/Invalid", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Call back date and time captured", "Followup done", "Demo Status", "DEMO Schedule as per the customer convience time or Requeird by us", "Conversation probality", "Alternate number Pitching or not", "ACPT", "L1", "Audit Observations", "VOC", "Auditor Name", "DoJ", "Today", "AON Days", "Tenurity", "Week", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=="beyondskool"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['contact_no'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['dispo_validate'].'",';
				$row .= '"'.$user['customer_interest'].'",';
				$row .= '"'.$user['demo_schedule'].'",';
				$row .= '"'.$user['demo_realization'].'",';
				$row .= '"'.$user['demo_qualification'].'",';
				$row .= '"'.$user['invalid_reason'].'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'.$user['l2'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['company_name_greeting'].'",';
				$row .= '"'.$user['call_purpose'].'",';
				$row .= '"'.$user['call_politness'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['call_confidence'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['subject_explain'].'",';
				$row .= '"'.$user['child_benefit'].'",';
				$row .= '"'.$user['demo_session_explain'].'",';
				$row .= '"'.$user['update_laptop_desktop'].'",';
				$row .= '"'.$user['student_name_email'].'",';
				$row .= '"'.$user['object_handling'].'",';
				$row .= '"'.$user['convincing_skill'].'",';
				$row .= '"'.$user['summarization'].'",';
				$row .= '"'.$user['mandatory_information'].'",';
				$row .= '"'.$user['standart_closing'].'",';
				$row .= '"'.$user['fa_missing'].'",';
				$row .= '"'.$user['beyondskool_disposition'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=="beyondskool_hygiene"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['go_live_date']=="" || $user['go_live_date']=='0000-00-00'){
					$aon_interval = '---';
				}else{
					$aon_interval = ((strtotime($currDate) - strtotime($user['go_live_date']))/86400);
				}

				$row = '"'.$user['hygiene_audit_type'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['msisdn'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['process'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['correct_disposition'].'",';
				$row .= '"'.$user['valid_invalid'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['call_back_date_capture'].'",';
				$row .= '"'.$user['followup_done'].'",';
				$row .= '"'.$user['demo_status'].'",';
				$row .= '"'.$user['customer_demo_schedule'].'",';
				$row .= '"'.$user['conversation_probality'].'",';
				$row .= '"'.$user['number_pitching'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['l1'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['failure_reason1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['failure_reason2'])).'",';
				$row .= '"'.$auditorName.'",';
				$row .= '"'.$user['doj'].'",';
				$row .= '"'.$currDate.'",';
				$row .= '"'.$aon_interval.'",';
				$row .= '"'.$user['tenure'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}

	}

/////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////// QA Hygiene REPORT /////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_hygiene_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_hygiene_report.php";
			$data["content_js"] = "qa_metropolis_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$qSql="Select s.id, s.fusion_id, s.office_id, s.role_id, s.dept_id, s.status, iap.user_id, iap.process_id, p.id as pid, p.name, p.is_active, o.abbr, o.location from signin s left join info_assign_process iap on s.id=iap.user_id left join process p on p.id=iap.process_id left join office_location o on o.abbr=s.office_id where office_id in ('KOL','HWH','BLR','CHE','MUM','NOI') and role_id in (select id from role where folder ='agent') and dept_id=6 and iap.process_id!=0 and p.is_active=1 group by p.name order by p.name";
			$data["process"] = $this->Common_model->get_query_result_array($qSql);

			$office_id = "";
			$date_from="";
			$date_to="";
			$process_id="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_hygiene_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$process_id = $this->input->get('process_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($process_id=="All") $cond .= "";
				else $cond .=" and process_id='$process_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_hygiene_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_hygiene_list"] = $fullAray;
				$this->create_qa_hygiene_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_hygiene_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['process_id']=$process_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_hygiene_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Hygiene Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_hygiene_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Fusion ID", "Name", "Team Leader", "QA", "Call Date", "Audit Date", "Guest Calling number", "Audit Type", "VOC", "OCOP Pitching", "Urgency", "Payment Status", "FCL Pitching", "Audit Start Date/Time", "Audit End Date/Time", "Interval (in sec)", "Authenticity", "Reason", "Call Complete By", "Calling Reason", "ACPT", "L1", "L2", "Agent Disposition", "Correct Disposition", "Observation", "Week");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$auditorName.'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['guest_call_no'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['ocop_picth'].'",';
			$row .= '"'.$user['urgency'].'",';
			$row .= '"'.$user['payment_status'].'",';
			$row .= '"'.$user['fcl_pitch'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['authenticity'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['authenticity_reason'])).'",';
			$row .= '"'.$user['call_complete_by'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['calling_reason'])).'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['l1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['l2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_dispo'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['correct_dispo'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['observation'])).'",';
			$row .= '"'.$user['week'].'",';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}


//////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// UNACADEMY /////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_unacademy_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_unacademy_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			//$data['location_list'] = $this->Common_model->get_office_location_list();

			//$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			//$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			//$cond1="";

			//$campaign = $this->input->get('campaign');

			$data["qa_unacademy_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				//$office_id = $this->input->get('office_id');
				//$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				/* if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				} */


				$qSql="Select *,
				(select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=mgnt_rvw_by) as mgnt_rvw_name
				from qa_unacademy_feedback $cond order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_unacademy_list"] = $fullAray;
				$this->create_qa_unacademy_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_unacademy_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			//$data['office_id']=$office_id;
			//$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_unacademy_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Unacademy Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_unacademy_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Educator Name", "L1 Super", "Date of Upload", "Category", "Channel Name", "Channel Link", "Video Link", "Video Duration", "Integration done?", "Integration time stamp when it starts", "Audit Start Time", "Audit End Time", "Interval (in sec)", "Duration Of Subscription Pitch In One Hour Content 90 sec To 6 Minutes", "Price Of Plus Subscription", "Contest Promotion Only If Applicable For The Category", "Plus Product Offering", "Free Test Promotion", "Iconic Promotion Only If Applicable For The Category", "Multiple Obs Screens", "Clear Audio", "Appropriate Frame Educator Window", "Windows Not Activated Error", "Quiz Conducted Using A Different Platform", "Handwritten Notes Used", "Educator Absent In Middle Of The Video", "Video Description Is Missing", "Spelling And Grammatical Errors In Title And Description", "Title And Thumbnail Mismatch", "Missing Links In Description", "Eating/Talking on The Phone During The Class", "A Direct Or Indirect Personal Attack Or Defamatory Remark Against Any Person Or Institution", "Instigating Learners Basis Political Or Religious Beliefs", "Comments Or Remarks Containing Profanity Sexual Innuendo Racial Or Gender Bias", "Seeking The Personal Information Of Unacademy Learners", "Missing Merchandise (T-Shirt Jacket)", "Sharing Personal Information", "Subscription & Promotions", "Tech Quality", "Content Quality", "Team Quality Issue", "Unacceptable Behaviour", "Consolidate data (To be used by Internal Team)", "Call Summary", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['agent_id'].'",';
			$row .= '"'.$user['tl_id'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['category'].'",';
			$row .= '"'.$user['channel_name'].'",';
			$row .= '"'.$user['channel_link'].'",';
			$row .= '"'.$user['video_link'].'",';
			$row .= '"'.$user['video_duration'].'",';
			$row .= '"'.$user['integration_done'].'",';
			$row .= '"'.$user['integration_time_stamp'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['subsription_pitch'].'",';
			$row .= '"'.$user['plus_subcription_price'].'",';
			$row .= '"'.$user['contest_promotion'].'",';
			$row .= '"'.$user['plus_product_offering'].'",';
			$row .= '"'.$user['free_text_promotion'].'",';
			$row .= '"'.$user['iconic_promotion'].'",';
			$row .= '"'.$user['multiple_obs'].'",';
			$row .= '"'.$user['clear_audio'].'",';
			$row .= '"'.$user['appropiate_frame'].'",';
			$row .= '"'.$user['window_not_activated'].'",';
			$row .= '"'.$user['quiz_conducted'].'",';
			$row .= '"'.$user['handwritten_notes'].'",';
			$row .= '"'.$user['educator_absend'].'",';
			$row .= '"'.$user['video_description'].'",';
			$row .= '"'.$user['grammatical_error'].'",';
			$row .= '"'.$user['thumbnail_mismatch'].'",';
			$row .= '"'.$user['missing_link'].'",';
			$row .= '"'.$user['phone_during_class'].'",';
			$row .= '"'.$user['personal_attack'].'",';
			$row .= '"'.$user['instigeting_learner'].'",';
			$row .= '"'.$user['remsrks_containing'].'",';
			$row .= '"'.$user['seeking_personal_information'].'",';
			$row .= '"'.$user['missing_marchandise'].'",';
			$row .= '"'.$user['sharing_personal_information'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['subscription_promotion'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['tech_quality'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['content_quality'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['team_quality'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['unacceptable_behaviour'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['consolidate_data'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}

//////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Care.Com //////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_care_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_care_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$campaign = $this->input->get('campaign');
			$data["qa_care_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_care_list"] = $fullAray;
				$this->create_qa_care_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_care_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_care_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_care_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=="care_email_chat"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Case Number", "Phone Duration Length", "Priority", "Case Type", "Secondary Case Type", "Case Recap", "Follow Up Action Needed", "Positive Feedback", "Coaching Points", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did not appropriately follow protocol for safety", "Extremely poor customer service", "Did not take correct action/provide accurate information for all policy", "Agent used apology statement when needed", "Agent replied to all the Email queries", "Demonstrated exceptional service (Bonus)", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="care_billing"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Case Number", "Phone Duration Length", "Priority", "Case Type", "Secondary Case Type", "Case Recap", "Follow Up Action Needed", "Positive Feedback", "Coaching Points", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Did not appropriately follow protocol for safety", "Extremely poor customer service", "Did not take correct action/provide accurate information for all policy", "Agent used apology statement when needed", "Good active listening and avoided dead-air", "Demonstrated exceptional service (Bonus)", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="buc"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Client Name", "Call Duration", "Job ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "I adhered to suggested greeting(s)", "I use clients first name", "I use childs name when confirming care", "I ask if employee is interested in center care", "I sound like I am smiling - when appropriate", "If it is the employees first time using BUC I explain their benefit", "I show empathy whenever possible", "I do not leave dead air I make conversation", "I use please and thank you", "I verify the client phone number in order to locate account for registered users", "I confirmed the best call back number for employee", "I asked client to verify their home address", "I restate for understanding", "I let the client finish talking", "I apologized for the issue or inconvenience", "I took ownership of the problem", "I asked relevant questions to accurately diagnose the problem", "I sufficiently addressed the caller's issue", "I use appropriate resources to address the issue when time permits", "I explained the BUC process correctly", "If I was asked where I was located I provided an accurate answer", "I obtained sick symptoms of child and/or adult", "When a job is NOA I offered in Center & PN - if applicable", "I ask if client has used BUC before", "I asked the client to confirm where care is taking place", "I asked if emergency contacts have changed", "I asked necessary PN payment follow up questions", "I set proper expectations surrounding preferred caregivers", "I asked for a No Later Than (NLT) - same/next day", "I provided an accurate follow up date/time", "I set proper expectations for PN payment timeline", "I read the credit card disclosure at the end of the request", "I thanked the client for calling", "I ask if I can assist with other dates", "I documented important notes", "I reported new bugs",  "I escalated the call and noted the account appropriately (Safety / Feedback related)", "I sent cancellations to center/agency in a timely manner", "I updated the client's contact information & details if necessary", "Correct Cancellation reason chosen", "Center Fulfillment: I informed employee of necessary paperwork/immunization forms", "I shared with agency/center all needed information", "I escalated a request to expedite a PN claim to the PN team", "I escalated a PN payment (Over 10 days) to the BUC Supes", "Center Cancellations - I canceled in BO and CSR", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="bucnew"){
			$header = array("Auditor Name", "Audit Date","Call Date","Agent", "Fusion ID","L1 Supervisor","Call Id", "Job Id", "Call Time","Client Name","Phone Number","Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Overall Score","Total Score","Verified caller was enrolled in benefit before disclosing benefit information","Call escalated (Safety)","Verified home address","Caller needs fully addressed","Adult care needs fully captured","Call escalated (Feedback related)","Care location confirmed during intake","COVID Screening questions and mask policy fully read","Empathy for client adequately portrayed in overall tone of call","Provided apology for the issue or inconvenience","Important notes documented within request","Bugs reported through SF process","Cancellations sent to ABUC agency in a timely manner","Cancellation policy adequately explained to client","Employee informed of assessment for new ABUC clients","All appropriate resources used to address caller concerns","All information shared with ABUC agency in a timely manner","ABUC timeline expectation clearly outlines","Created client file in BO for new client","Client contact information and details updated","ABUC process explained correctly","Used client phone number in order to locate account for registered users process explained correctly","Best call back number for employee confirmed at the beginning of the call","Concerns restated for understanding","Client uninterrupted","Rep took ownership of the problem","NLT gathered for same/next day when necessary","Relevant questions asked to accurately diagnose the problem","Call logged in the appropriate location","Proper expectations surrounding splitting MDJs set","Rep provided clear conscise and cofident replies to client quesetions","Informed client that ABUC is for non-medical care only","Portal link sent to new client for CC information","Properly identified when to pass ABUC inquiry off to ABUC specialist","When portal link does not work case created for SL Billing team","Accurately provided remaining placement days for current contract year","How can I be there for you greeting used","Client name used","Client tone and speed matched","Inquired if client has used BUC before and explain benefit if not","No dead air","Please Thank you and polite tone used","Provided Austin TX as an answer when asked where located","Accurate follow up date and time provided","Client thanked for calling","Client asked if there is anything else they need assistance with before call is ended","Correct Cancellation reason chosen","Accurately explained ABUC caregiver duties","Call Summary","Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="care_member"){
			$header = array("Auditor Name", "Audit Date","Call Date","Agent", "Fusion ID","L1 Supervisor","Member ID","Time Stamp","Bucket Type","Category Error","Error Description","Fixed Description","Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Total Score", "Did not appropriately follow protocol for safety fraud legal privacy and/or liability matters that exposes Care.com to liability", "Did not choose correct status for content that includes or expresses a specific location underage status or content that warrants further review", "Did not choose correct status for content that contains contact information or wrongly pre-adversed for a bgc/carecheck", "Did not choose correct status for content that includes a child name competitor name third party site name mention of au pair or residing outside of US", "Did not take correct administrative action and/or spelling errors are evident", "Call Summary","Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");


		if($campaign=="care_email_chat"){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['case_number'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['priority'].'",';
				$row .= '"'.$user['case_type'].'",';
				$row .= '"'.$user['secondary_case_type'].'",';
				$row .= '"'.$user['case_recap'].'",';
				$row .= '"'.$user['follow_up'].'",';
				$row .= '"'.$user['positive_feedback'].'",';
				$row .= '"'.$user['coaching_point'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['did_not_follow_safety_protocol'].'",';
				$row .= '"'.$user['extremely_poor_customer_service'].'",';
				$row .= '"'.$user['did_not_take_correct_action'].'",';
				$row .= '"'.$user['agent_use_apology_statement'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['exceptional_bonus_service'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=="care_billing"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['case_number'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['priority'].'",';
				$row .= '"'.$user['case_type'].'",';
				$row .= '"'.$user['secondary_case_type'].'",';
				$row .= '"'.$user['case_recap'].'",';
				$row .= '"'.$user['follow_up'].'",';
				$row .= '"'.$user['positive_feedback'].'",';
				$row .= '"'.$user['coaching_point'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['did_not_follow_safety_protocol'].'",';
				$row .= '"'.$user['extremely_poor_customer_service'].'",';
				$row .= '"'.$user['did_not_take_correct_action'].'",';
				$row .= '"'.$user['agent_use_apology_statement'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['exceptional_bonus_service'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=="buc"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['customer_client_name'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['job_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['suggested_greeting'].'",';
				$row .= '"'.$user['use_client_first'].'",';
				$row .= '"'.$user['use_child_name_confirming_care'].'",';
				$row .= '"'.$user['if_employee_interested_center_care'].'",';
				$row .= '"'.$user['smiling_when_appropriate'].'",';
				$row .= '"'.$user['first_time_using_buc'].'",';
				$row .= '"'.$user['show_empathy'].'",';
				$row .= '"'.$user['do_not_leave_dead_air'].'",';
				$row .= '"'.$user['use_please_thank_you'].'",';

				$row .= '"'.$user['verify_client_phone_number'].'",';
				$row .= '"'.$user['confirmed_best_call_back_number'].'",';
				$row .= '"'.$user['verified_employee_registered_disclosing_benefit'].'",';
				$row .= '"'.$user['verify_home_address'].'",';

				$row .= '"'.$user['restate_understanding'].'",';
				$row .= '"'.$user['client_finish_talking'].'",';

				$row .= '"'.$user['apologized_issue_inconvenience'].'",';
				$row .= '"'.$user['took_ownership_problem'].'",';
				$row .= '"'.$user['questions_accurately_diagnose_problem'].'",';
				$row .= '"'.$user['sufficiently_caller_issue'].'",';
				$row .= '"'.$user['appropriate_resources_issue_time_permits'].'",';

				$row .= '"'.$user['buc_process_correctly'].'",';
				$row .= '"'.$user['provided_accurate_answer'].'",';
				$row .= '"'.$user['sick_symptoms_child'].'",';
				$row .= '"'.$user['job_offered_center'].'",';
				$row .= '"'.$user['used_buc_before'].'",';
				$row .= '"'.$user['care_taking_place'].'",';
				$row .= '"'.$user['emergency_contacts_changed'].'",';
				$row .= '"'.$user['pn_payment'].'",';
				$row .= '"'.$user['preferred_caregivers'].'",';
				$row .= '"'.$user['no_later_than'].'",';
				$row .= '"'.$user['accurate_follow_up'].'",';
				$row .= '"'.$user['pn_payment_timeline'].'",';
				$row .= '"'.$user['credit_card_disclosure'].'",';

				$row .= '"'.$user['thanked_client'].'",';
				$row .= '"'.$user['assist_other_dates'].'",';

				$row .= '"'.$user['documented_important'].'",';
				$row .= '"'.$user['new_bugs'].'",';
				$row .= '"'.$user['escalated_call'].'",';
				$row .= '"'.$user['cancellations_center'].'",';
				$row .= '"'.$user['updated_client_contact'].'",';
				$row .= '"'.$user['cancellation_reason_chosen'].'",';
				$row .= '"'.$user['cancellation_policy'].'",';
				$row .= '"'.$user['immunization_forms'].'",';
				$row .= '"'.$user['shared_agency'].'",';
				$row .= '"'.$user['pn_claim_pn_team'].'",';
				$row .= '"'.$user['escalated_pn_payment'].'",';
				$row .= '"'.$user['canceled_bo_csr'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=="bucnew"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['job_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['clients_name'].'",';
				$row .= '"'.$user['phone_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				// $row .= '"'.$user['earned_score'].'",';
				// $row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['total_score'].'",';
				$row .= '"'.$user['verified_caller_enrolled'].'",';
				$row .= '"'.$user['call_escalated_safty'].'",';
				$row .= '"'.$user['verified_home_address'].'",';
				$row .= '"'.$user['caller_needs_fully_addressed'].'",';
				$row .= '"'.$user['adult_care_needs_fully_captured'].'",';
				$row .= '"'.$user['call_escalated_feedback'].'",';
				$row .= '"'.$user['care_location'].'",';
				$row .= '"'.$user['covid'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['apology_for_issue'].'",';
				$row .= '"'.$user['notes_documented'].'",';
				$row .= '"'.$user['bugs_reporter'].'",';
				$row .= '"'.$user['cancell_sent_abuc_agency'].'",';
				$row .= '"'.$user['cancell_policy_adequately'].'",';
				$row .= '"'.$user['new_abuc_client'].'",';
				$row .= '"'.$user['caller_concern'].'",';
				$row .= '"'.$user['info_shared_with_abuc'].'",';
				$row .= '"'.$user['abuc_timeline'].'",';
				$row .= '"'.$user['bo_for_new_client'].'",';
				$row .= '"'.$user['client_contact_info'].'",';
				$row .= '"'.$user['abuc_process_explain'].'",';
				$row .= '"'.$user['client_phno'].'",';
				$row .= '"'.$user['callback_number_for_employ'].'",';
				$row .= '"'.$user['concern_restated'].'",';
				$row .= '"'.$user['client_unintrupted'].'",';
				$row .= '"'.$user['rep_took_ownership'].'",';
				$row .= '"'.$user['nlt_gathered'].'",';
				$row .= '"'.$user['dignose_the_problem'].'",';
				$row .= '"'.$user['call_logged_location'].'",';
				$row .= '"'.$user['spliting_mdj_set'].'",';
				$row .= '"'.$user['rep_provided_clear'].'",';
				$row .= '"'.$user['abuc_nonmedical_care'].'",';
				$row .= '"'.$user['portallink_sentclient'].'",';
				$row .= '"'.$user['abuc_specialist'].'",';
				$row .= '"'.$user['sl_billing_team'].'",';
				$row .= '"'.$user['current_contract_year'].'",';
				$row .= '"'.$user['greeting_used'].'",';
				$row .= '"'.$user['client_named_used'].'",';
				$row .= '"'.$user['client_tone_speed'].'",';
				$row .= '"'.$user['client_used_buc'].'",';
				$row .= '"'.$user['no_dead_air'].'",';
				$row .= '"'.$user['polite_tone_used'].'",';
				$row .= '"'.$user['austin_tx'].'",';
				$row .= '"'.$user['followup_datetime'].'",';
				$row .= '"'.$user['client_thanked_calling'].'",';
				$row .= '"'.$user['client_asked'].'",';
				$row .= '"'.$user['cancel_reason_chosen'].'",';
				$row .= '"'.$user['abuc_care_giver'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}

		}else if($campaign=="care_member"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['member_id'].'",';
				$row .= '"'.$user['time_stamp'].'",';
				$row .= '"'.$user['bucket_type'].'",';
				$row .= '"'.$user['category_error'].'",';
				$row .= '"'.$user['error_description'].'",';
				$row .= '"'.$user['fix_description'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				//$row .= '"'.$user['earned_score'].'",';
				//$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['total_score'].'",';
				$row .= '"'.$user['did_not_follow_protocol_for_safety'].'",';
				$row .= '"'.$user['did_not_choose_correct_status_for_specific_location'].'",';
				$row .= '"'.$user['did_not_choose_correct_status_for_contact_information'].'",';
				$row .= '"'.$user['did_not_choose_correct_status_for_child_name'].'",';
				$row .= '"'.$user['did_not_take_correct_administrative_action'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}

		}

	}

//////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// Huda ///////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_huda_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_huda_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_huda_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_huda_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_huda_list"] = $fullAray;
				$this->create_qa_huda_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_huda_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_huda_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Huda Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_huda_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Track ID", "Call Duration", "Type of Call", "Call Category", "Call Status", "Customer Contact number", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Opening/Closing of the call", "Verification of name and phone number", "Listened Actively to ensure Full and Complete Comprehension", "Empathy", "Hold", "Appropriate Speech & Language", "Probing", "Complete & Accurate infromation", "Correct & Complete Tagging Done", "Tagging Remarks", "Zero Tolerance issue observed", "Remarks1", "Remarks2", "Remarks3", "Remarks4", "Remarks5", "Remarks6", "Remarks7", "Remarks8", "Remarks9", "Remarks10", "Remarks11", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_track_id'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['call_category'].'",';
			$row .= '"'.$user['call_status'].'",';
			$row .= '"'.$user['customer_contact'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['opening_closing_call'].'",';
			$row .= '"'.$user['verification_name'].'",';
			$row .= '"'.$user['listen_actively'].'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'.$user['hold'].'",';
			$row .= '"'.$user['appropiate_speech'].'",';
			$row .= '"'.$user['probing'].'",';
			$row .= '"'.$user['accurate_information'].'",';
			$row .= '"'.$user['correct_tagging'].'",';
			$row .= '"'.$user['tagging_remarks'].'",';
			$row .= '"'.$user['zero_tolerance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}


//////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// FTPL ///////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_ftpl_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_ftpl_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";


			$data["qa_ftpl_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}


				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_ftpl_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_names(id) as campaign from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_ftpl_list"] = $fullAray;
				$this->create_qa_ftpl_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_ftpl_CSV";
			}
			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_ftpl_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="FTPL Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_ftpl_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Evaluation Mode", "Call Duration", "Session ID", "Fresh/Repeat", "Calling Number", "Order Number", "Ticket Number", "Hold Count", "Reason for Hold", "Other Reason For Hold", "VOC Type(Advisor)", "Return_Type(Advisor)", "Status(Advisor)", "VOC Type(Evaluator)", "Return_Type(Evaluator)", "Status(Evaluator)", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Opening", "Closing", "Empathy/Apology", "Ownership/Assurance", "Proactive and Alternate Information", "Hold Protocol/Dead Air", "Escalation", "Tone/Rate Of Speech/Fumbling", "Active Listening", "Interruption/Parallel Conversation", "Jargons/Fillers", "Incorrect/Incomplete Information", "Issue Identification/Understanding", "Probing (+System Information Used)", "Fake Commitment", "Incorrect Tagging/Remarks in SF", "Tracker or Panel Not/Incorrectly Updated", "WOW Call", "ZTP", "Remarks1", "Remarks2", "Remarks3", "Remarks4", "Remarks5", "Remarks6", "Remarks7", "Remarks8", "Remarks9", "Remarks10", "Remarks11", "Remarks12", "Remarks13", "Remarks14", "Remarks15", "Remarks16", "Remarks17", "Remarks18", "Remarks19", "Call Summary", "Feedback", "Agent Acceptance Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['evaluation_mode'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['session_id'].'",';
			$row .= '"'.$user['fresh_repeat'].'",';
			$row .= '"'.$user['calling_number'].'",';
			$row .= '"'.$user['order_number'].'",';
			$row .= '"'.$user['ticker_number'].'",';
			$row .= '"'.$user['hold_count'].'",';
			$row .= '"'.$user['hold_reason'].'",';
			$row .= '"'.$user['other_hold_reason'].'",';
			$row .= '"'.$user['advisor_voc_type'].'",';
			$row .= '"'.$user['advisor_return_type'].'",';
			$row .= '"'.$user['advisor_status'].'",';
			$row .= '"'.$user['evaluator_voc_type'].'",';
			$row .= '"'.$user['evaluator_return_type'].'",';
			$row .= '"'.$user['evaluator_status'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['opening'].'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'.$user['ownership'].'",';
			$row .= '"'.$user['proactive_information'].'",';
			$row .= '"'.$user['hold_protocol'].'",';
			$row .= '"'.$user['escalation'].'",';
			$row .= '"'.$user['rate_of_speech'].'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'.$user['parallel_conversion'].'",';
			$row .= '"'.$user['jargons'].'",';
			$row .= '"'.$user['incomplete_information'].'",';
			$row .= '"'.$user['issue_identification'].'",';
			$row .= '"'.$user['probing'].'",';
			$row .= '"'.$user['fake_comitment'].'",';
			$row .= '"'.$user['incorrect_tagging'].'",';
			$row .= '"'.$user['incorrectly_update'].'",';
			$row .= '"'.$user['wow_call'].'",';
			$row .= '"'.$user['ztp'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);


	}


//////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// SRL ////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_srl_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_srl_report.php";
			$data["content_js"] = "qa_biomet_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_srl_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');
				$campaign=$this->input->get("campaign");
				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}
				if($campaign=="inbound"){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_srl_inbound_feedback) xx Left Join
					(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_srl_list"] = $fullAray;
					$this->create_qa_srl_inb_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_srl_inb_CSV/";
				}else if($campaign=="outbound"){
					$qSql="SELECT * from
					(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
					(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
					(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
					(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
					(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_srl_feedback) xx Left Join
					(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

					$fullAray = $this->Common_model->get_query_result_array($qSql);
					$data["qa_srl_list"] = $fullAray;
					$this->create_qa_srl_CSV($fullAray);
					$dn_link = base_url()."reports_qa/download_qa_srl_CSV/";
				}
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_srl_CSV(){
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA SRL Outbound Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_srl_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Type of Call", "Phone Number", "Disconnected By", "Disposition (Associate)", "Disposition (QA)", "Audit Type", "VOC", "ACPT", "L1", "L2", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Call opening", "State the reason for the call", "Sentence construction", "Understood the customers need & gave the pitch", "Built Rapport & personalized the conversation", "Managed objections", "Adhere to processes", "Displayed knowledge of product", "Probing", "Explore options", "Clearly informed price and mandatory information", "Utilized upsell techniques", "Taken a clear buy in", "Summarize", "Follow up & setting expectations", "Wrong Tagging", "Prerequisites", "Correct Info", "Call Code of conduct (ZTP)", "Remarks1", "Remarks2", "Remarks3", "Remarks4", "Remarks5", "Remarks6", "Remarks7", "Remarks8", "Remarks9", "Remarks10", "Remarks11", "Remarks12", "Remarks13", "Remarks14", "Remarks15", "Remarks16", "Remarks17", "Remarks18", "Remarks19", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['disconnected_by'].'",';
			$row .= '"'.$user['associate_disposition'].'",';
			$row .= '"'.$user['qa_disposition'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['acpt'].'",';
			$row .= '"'.$user['l1'].'",';
			$row .= '"'.$user['l2'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['call_opening'].'",';
			$row .= '"'.$user['state_call_reason'].'",';
			$row .= '"'.$user['sentence_construction'].'",';
			$row .= '"'.$user['understand_customer_need'].'",';
			$row .= '"'.$user['built_rapport'].'",';
			$row .= '"'.$user['mannage_objection'].'",';
			$row .= '"'.$user['process_adhere'].'",';
			$row .= '"'.$user['display_product_knowledge'].'",';
			$row .= '"'.$user['probing'].'",';
			$row .= '"'.$user['explore_option'].'",';
			$row .= '"'.$user['clearly_inform_price'].'",';
			$row .= '"'.$user['utilize_upsell'].'",';
			$row .= '"'.$user['taken_clear_buy_in'].'",';
			$row .= '"'.$user['summarize'].'",';
			$row .= '"'.$user['expectation_followup'].'",';
			$row .= '"'.$user['wrong_tagging'].'",';
			$row .= '"'.$user['prerequisites'].'",';
			$row .= '"'.$user['correct_info'].'",';
			$row .= '"'.$user['ztp'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}

	public function download_qa_srl_inb_CSV(){
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA SRL Inbound Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	//SRL Inbound CQ rating
	public function srl_inb_rating(){
		return array("1"=>"Miss", "2"=>"Needs Work", "3"=>"Hit The Work", "4"=>"Amazing", "5"=>"N/A");
	}

	//SRL IB CSV Generation
	public function create_qa_srl_inb_CSV($rr){
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$srl_inb_rate=$this->srl_inb_rating();
		$common_yes_no=$this->common_yes_no();
		$header = array("Auditor Name",
		"Audit Date",
		"Agent",
		"Fusion ID",
		"L1 Super",
		"Call Date",
		"Call Duration",
		"Type of Call",
		"Phone Number",
		"Disconnected By",
		"Disposition (Associate)",
		"Disposition (QA)",
		"Audit Type",
		"VOC",
		"Call Recording",
		"Campaign",
		"CSAT Transfer Done",
		"Audit Start Date Time",
		"Audit End Date Time",
		"Interval(In Second)",
		"Overall Score",
		"Call opening",
		"Personalization",
		"Sentence Construction",
		"Positive statements",
		"Telephone etiquettes",
		"Active Listening",
		"Acknowledge",
		"Rapport",
		"Objection Handling",
		"Adhere to Process",
		"Demonstrate Knowledge",
		"Probing",
		"Resolution",
		"Explain Resolution",
		"Promote SRL Services",
		"Ownership",
		"Summarize",
		"Follow Up & Setting Expectation",
		"DPA",
		"Prerequisites",
		"Correct Info/Follow Up not completed",
		"Call Code of conduct",
		"Call Tagging",
		"Call Summary",
		"Feedback",
		"Agent Feedback Acceptance",
		"Agent Review Date",
		"Agent Comment",
		"Mgnt Review Date",
		"Mgnt Review By",
		"Mgnt Comment",
		"Client Review Date",
		"Client Review Name",
		"Client Review Note"
		);
		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['phone'].'",';
			$row .= '"'.$user['disconnected_by'].'",';
			$row .= '"'.$user['associate_disposition'].'",';
			$row .= '"'.$user['qa_disposition'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['call_recording'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['csat_transfer'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$srl_inb_rate[$user['call_opening']].'",';
			$row .= '"'.$srl_inb_rate[$user['personalization']].'",';
			$row .= '"'.$srl_inb_rate[$user['sentence_cons']].'",';
			$row .= '"'.$srl_inb_rate[$user['positive_statements']].'",';
			$row .= '"'.$srl_inb_rate[$user['tele_etiquettes']].'",';
			$row .= '"'.$srl_inb_rate[$user['active_listening']].'",';
			$row .= '"'.$srl_inb_rate[$user['acknowledge']].'",';
			$row .= '"'.$srl_inb_rate[$user['rapport']].'",';
			$row .= '"'.$srl_inb_rate[$user['objection_handling']].'",';
			$row .= '"'.$srl_inb_rate[$user['adhere_to_process']].'",';
			$row .= '"'.$srl_inb_rate[$user['demo_knowledge']].'",';
			$row .= '"'.$srl_inb_rate[$user['probing']].'",';
			$row .= '"'.$srl_inb_rate[$user['resolution']].'",';
			$row .= '"'.$srl_inb_rate[$user['exp_resolution']].'",';
			$row .= '"'.$srl_inb_rate[$user['promote_srl']].'",';
			$row .= '"'.$srl_inb_rate[$user['ownership']].'",';
			$row .= '"'.$srl_inb_rate[$user['summarize']].'",';
			$row .= '"'.$srl_inb_rate[$user['follow_setting']].'",';
			$row .= '"'.$common_yes_no[$user['dpa']].'",';
			$row .= '"'.$common_yes_no[$user['prerequisites']].'",';
			$row .= '"'.$common_yes_no[$user['correct_info']].'",';
			$row .= '"'.$common_yes_no[$user['call_code']].'",';
			$row .= '"'.$common_yes_no[$user['call_tagging']].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
	}

//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// Loanxm ///////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_loanxm_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_loanxm_report.php";
			$data["content_js"] = "qa_loanxm_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$cond2="";

			$campaign = $this->input->get('campaign');

			if($campaign=="Voicemail"){
				$table='qa_loanxm_voicemail_feedback';
				$cond2 .= "";
			}else if($campaign=="Inbound"){
				$table='qa_loanxm_feedback';
				$cond2 .= " and call_type='Inbound'";
			}else if($campaign=="Outbound"){
				$table='qa_loanxm_feedback';
				$cond2 .= " and call_type='Outbound'";
			}

			$data["qa_loanxm_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from ".$table.") xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond2 $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_loanxm_list"] = $fullAray;
				$this->create_qa_loanxm_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_loanxm_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_loanxm_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Debt Solution 123 ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_loanxm_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=="Voicemail"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Five9 Call ID", "Customer Name","Customer Contact number","Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)", "Pass/Fail", "Overall Score","Customer Score", "Business Score","Compliance Score",  "Adherence to Voicemail script", "Uses appropriate tone pace and voice inflection", "Did the agent use proper word choice pronunciation and enunciation?", "Leaves voicemail immediately after the tone", "Dispositioned properly in Five9","Term Code properly in Livebox","Background sound quality","Timely term coding of call", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($campaign=="Inbound" || $campaign=="Outbound"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Type of Call", "Five9 Call ID", "Customer Name","Customer Contact number","Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)", "Pass/Fail", "Overall Score", "Customer Score", "Business Score",
			"Opening/Introduction", "Qualifying Questions", "Conclusion - varies for a LT vs Post vs Call Backs", "Questions and Rebuttals", "Uses appropriate tone pace and voice inflection", "Did the agent use proper word choice pronunciation and enunciation?", "Listen actively and respond appropriately without interrupting customer?", "Used manual connector to pull up lead in Portal", "All Portal Fields filled out correctly", "Dispostioned properly in Portal", "If Red Light - Did agent proceed to Credit Card page in Portal?", "Dispositioned properly in Five9","Term Coded properly in Livebox and Dispositioned correctly inTMI","Proper phone system procedure to complete Live Transfer", "Did the agent use the prospects name at least twice?", "Did the agent reference to our Texas Office when applicable?","Background sound quality", "Proper script was used?", "Call Acknowledgement","Failure to Disposition TMI", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=="Voicemail"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['five9_id'].'",';
				$row .= '"'.$user['customer_name'].'",';
				$row .= '"'.$user['customer_contact'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['pass_fail'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['customer_score'].'%'.'",';
				$row .= '"'.$user['business_score'].'%'.'",';
				$row .= '"'.$user['compliance_score'].'%'.'",';
				$row .= '"'.$user['adherence_voicemail_script'].'",';
				$row .= '"'.$user['use_appropiate_tone'].'",';
				$row .= '"'.$user['agent_use_proper_word_choice'].'",';
				$row .= '"'.$user['leave_voicemail'].'",';
				$row .= '"'.$user['disposition_in_Five9'].'",';
				$row .= '"'.$user['disposition_in_livebox'].'",';
				$row .= '"'.$user['quality'].'",';
				$row .= '"'.$user['timely_coding'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=="Inbound" || $campaign=="Outbound"){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['five9_id'].'",';
				$row .= '"'.$user['customer_name'].'",';
				$row .= '"'.$user['customer_contact'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['pass_fail'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['customer_score'].'%'.'",';
				$row .= '"'.$user['business_score'].'%'.'",';
				$row .= '"'.$user['opening_introduction'].'",';
				$row .= '"'.$user['qualifying_questions'].'",';
				$row .= '"'.$user['conclusion'].'",';
				$row .= '"'.$user['questions_rebuttals'].'",';
				$row .= '"'.$user['voice_quality'].'",';
				$row .= '"'.$user['pronunciation'].'",';
				$row .= '"'.$user['listen_actively'].'",';
				$row .= '"'.$user['lead_portal'].'",';
				$row .= '"'.$user['all_portal_fields'].'",';
				$row .= '"'.$user['disposition_in_portal'].'",';
				$row .= '"'.$user['red_creditcard_portal'].'",';
				$row .= '"'.$user['dispositioned_five9'].'",';
				$row .= '"'.$user['dispositioned_livebox'].'",';
				$row .= '"'.$user['live_transfer_phone'].'",';
				$row .= '"'.$user['agent_use_prospect_name'].'",';
				$row .= '"'.$user['agent_houston_office'].'",';
				$row .= '"'.$user['quality'].'",';
				$row .= '"'.$user['proper_script_use'].'",';
				$row .= '"'.$user['call_acknowledge'].'",';
				$row .= '"'.$user['TMI'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}

	}


/////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// CLIO /////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
	public function qa_clio_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_clio_report.php";
			$data["content_js"] = "qa_clio_js.php";
			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign ="clio";

			$data["qa_clio_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}





				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_clio_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_clio_list"] = $fullAray;
				$this->create_qa_clio_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_clio_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_clio_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_clio_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_clio";
		$edit_url = "add_edit_clio";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super","Call Date","Call Duration","Call Type","Sampling","reference_id", "Query Type", "Query Sub Type", "Stat / Non-Stat","Auto Fail", "Total Opportunity", "Audit Type", "Auditor Type", "Voc","Audit Link","LOB","Inbound/Outbound","Overall Score", "Possible Score", "Earned Score", "Customer Score","Business Score","Compliance Score", "Did the CSR adhere to all Authentication and Security Policies of the account member?", "Properly verifies the account holder information before providing/discussing any account information.", "For account changes and caller should be authorized on the account (ie wife or dependent)", "Obtain verbal permission from an authenticated account owner before providing any account information.", "Did the agent check if the order is STAT?","Did the agent show empathy and acknowledge patients concern?", "Did the agent utilize all needed information before scheduling an appointment?","Check_list1 - Did the agent utilize all needed information before scheduling an appointment?","Did the agent observe proper Hold Procedure and avoid long silences?", "Did the agent maintain a positive interaction during the call?", "Did the agent asked Covid screening questions?","Did the agent provide accurate reminders for the patient?","Did the agent ask relevant probing questions?","Did the agent select the correct order status and left account notes?","Did the agent check if CPT and diagnosis are both correct?","Did the agent update the patient demographic information?","Did the agent follow up with necessary documents? (Going above and Beyond)","Did the agent offer alternatives to the patient?","Did the agent verify if it needs to be sent to corrections or pre-cert?","Did the agent make sure to set up the correct Modality for the patient?","Comments 1", "Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12", "Comments 13", "Comments 14", "Comments 15", "Comments 16", "Comments 17", "Comments 18", "Comments 19","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");


		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");



		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['sampling'].'",';
			$row .= '"'.$user['reference_id'].'",';
			$row .= '"'.$user['query_type'].'",';
			$row .= '"'.$user['query_sub_type'].'",';
			$row .= '"'.$user['stat'].'",';
			$row .= '"'.$user['auto_fail'].'",';
			$row .= '"'.$user['total_opportunity'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['lob'].'",';
			$row .= '"'.$user['in_out'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['customer_score'].'",';
			$row .= '"'.$user['business_score'].'",';
			$row .= '"'.$user['compliance_score'].'",';
			$row .= '"'.$user['do_csr_adhere'].'",';
			$row .= '"'.$user['properly_verifies_account_holder'].'",';
			$row .= '"'.$user['is_authorized_account'].'",';
			$row .= '"'.$user['obtain_verbal_permission'].'",';
			$row .= '"'.$user['do_agent_check'].'",';
			$row .= '"'.$user['do_show_empathy'].'",';
			$row .= '"'.$user['do_agent_utilize_information'].'",';
			$row .= '"'.$user['check_list1'].'",';
			$row .= '"'.$user['do_proper_hold_procedure'].'",';
			$row .= '"'.$user['do_maintain_positive_interaction'].'",';
			$row .= '"'.$user['do_ask_covid_question'].'",';
			$row .= '"'.$user['do_provide_accurate_reminders'].'",';
			$row .= '"'.$user['ask_relevant_probing'].'",';
			$row .= '"'.$user['do_select_correct_order_status'].'",';
			$row .= '"'.$user['do_check_cpt_diagnosis'].'",';
			$row .= '"'.$user['do_update_patient_demographic'].'",';
			$row .= '"'.$user['do_check_insurance_auth'].'",';
			$row .= '"'.$user['do_check_demog_prescription'].'",';
			$row .= '"'.$user['do_verify_need_sent_correction'].'",';
			$row .= '"'.$user['do_make_setup_correct_modality'].'",';
			$row .= '"'.$user['cmt1'].'",';
			$row .= '"'.$user['cmt2'].'",';
			$row .= '"'.$user['cmt3'].'",';
			$row .= '"'.$user['cmt4'].'",';
			$row .= '"'.$user['cmt5'].'",';
			$row .= '"'.$user['cmt6'].'",';
			$row .= '"'.$user['cmt7'].'",';
			$row .= '"'.$user['cmt8'].'",';
			$row .= '"'.$user['cmt9'].'",';
			$row .= '"'.$user['cmt10'].'",';
			$row .= '"'.$user['cmt11'].'",';
			$row .= '"'.$user['cmt12'].'",';
			$row .= '"'.$user['cmt20'].'",';
			$row .= '"'.$user['cmt13'].'",';
			$row .= '"'.$user['cmt14'].'",';
			$row .= '"'.$user['cmt15'].'",';
			$row .= '"'.$user['cmt16'].'",';
			$row .= '"'.$user['cmt17'].'",';
			$row .= '"'.$user['cmt18'].'",';
			$row .= '"'.$user['cmt19'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}


	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Clio Spot Check/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

		public function qa_clio_spot_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_clio_spot_report.php";
			$data["content_js"] = "qa_clio_js.php";
			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign ="clio";

			$data["qa_clio_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_clio_spot_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_clio_list"] = $fullAray;
				$this->create_qa_clio_spot_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_clio_spot_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_clio_spot_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_clio_spot_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_clio";
		$edit_url = "add_edit_clio_spot";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Call Duration", "Fusion ID", "Agent Name", "Customer Name", "Call Date", "Call Type","Modality","Line of Business","Audit Type", "VOC","Audit Link", "Overall Score","Referring Doctor","Eligibility","Authorization/Prescription","Orders","Account Notes","Appointment Accuracy","Complete Screening Questions","Followed prior notes/diagnosis report","Comment1","Comment2","Comment3","Comment4","Comment5","Comment6","Comment7","Comment8","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );


		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");



		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['modality'].'",';
			$row .= '"'.$user['lob'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['Referring_Doctor'].'",';
			$row .= '"'.$user['Eligibility'].'",';
			$row .= '"'.$user['Prescription'].'",';
			$row .= '"'.$user['Orders'].'",';
			$row .= '"'.$user['Account_Notes'].'",';
			$row .= '"'.$user['Appointment_Accuracy'].'",';
			$row .= '"'.$user['Screening_Questions'].'",';
			$row .= '"'.$user['diagnosis_report'].'",';
			$row .= '"'.$user['cmt1'].'",';
			$row .= '"'.$user['cmt2'].'",';
			$row .= '"'.$user['cmt3'].'",';
			$row .= '"'.$user['cmt4'].'",';
			$row .= '"'.$user['cmt5'].'",';
			$row .= '"'.$user['cmt6'].'",';
			$row .= '"'.$user['cmt7'].'",';
			$row .= '"'.$user['cmt8'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}



/////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////// Stifel ///////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////
	public function qa_stifel_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_stifel_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_stifel_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_stifel_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_stifel_list"] = $fullAray;
				$this->create_qa_stifel_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_stifel_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_stifel_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA stifel Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_stifel_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Hold Duration", "Verification Duration", "Interaction ID", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score", "Opening", "Closing", "Empathy / Apology", "Ownership / Assurance", "Call Control", "Transfer", "Tone / Rate Of Speech / Fumbling / Pacing", "Active Listening", "Professionalism", "**Issue Identification / Understanding", "Probing", "**False Commitment(Correct and Accurate Information)", "**Verification process followed", "**ZTP","Rudeness","Call Avoidance", "Remarks1", "Remarks2", "Remarks3", "Remarks4", "Remarks5", "Remarks6", "Remarks7", "Remarks8", "Remarks9", "Remarks10", "Remarks11", "Remarks12", "Remarks13", "Remarks14", "Remarks15","Remarks16","Customer score","Business score","Compliance score", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['hold_duration'].'",';
			$row .= '"'.$user['verification_duration'].'",';
			$row .= '"'.$user['interaction_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['opening'].'",';
			$row .= '"'.$user['closing'].'",';
			$row .= '"'.$user['empathy_apology'].'",';
			$row .= '"'.$user['owenship_assurance'].'",';
			$row .= '"'.$user['hold_protocol'].'",';
			$row .= '"'.$user['transfer'].'",';
			$row .= '"'.$user['rate_of_speech'].'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'.$user['parallel_conversion'].'",';
			$row .= '"'.$user['issue_identification'].'",';
			$row .= '"'.$user['probing'].'",';
			$row .= '"'.$user['false_commitment'].'",';
			$row .= '"'.$user['verification_process_follow'].'",';
			$row .= '"'.$user['ztp'].'",';
			$row .= '"'.$user['rudeness'].'",';
			$row .= '"'.$user['call_avoidance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'.$user['customer_score'].'%'.'",';
			$row .= '"'.$user['business_score'].'%'.'",';
			$row .= '"'.$user['compliance_score'].'%'.'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}


//////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// PHS ////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_phs_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_phs_report.php";
			$data["content_js"] = "qa_kabbage_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = $this->input->get('campaign');

			$data["qa_phs_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "and audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_phs_list"] = $fullAray;
				$this->create_qa_phs_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_phs_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_phs_CSV($pid)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";



		if($pid=="phs"){
			$pname='PHS';
		}else if($pid=="phs_chat"){
			$pname='PHS Chat';
		}else if($pid=="phs_email"){
			$pname='PHS Email';
		}else if($pid=="phs_chat_v2"){
			$pname='PHS Chat version 2';
		}else if($pid=="phs_email_v2"){
			$pname='PHS Email version 2';
		}else if($pid=="phs_voice_v2"){
			$pname='PHS Voice version 2';
		}
		$newfile="QA ".$pname." Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_phs_CSV($rr,$pid)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_phs";
		$fopen = fopen($filename,"w+");

		if($pid=="phs"){
			$header = array("Auditor Name","Audit Date","Fusion Id","Agent","L1 Super","Call Date","Call Duration","Channel","File_number","Acpt","ZTP","Member_id","Product/Agency","Audit Type","VOC","Call Type","Caller Type","Language", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Business Score","Customer Score","Compliance Score","Overall Score ",
			"Did the CSR adhere to all Authentication and Security Policies of the account member?","Did the CSR adhere to call back process?","Did the agent provide information to a provider about the status of the members account?","Did the agent able to handle a credit card information correctly?","For account closure did the agent follow cancellation process?","Did the agent submit or process all eligible refund requests in accordance with the Refund Policy","Did the agent properly change the payment method?","Did the agent properly discussed member benefits?","Did the agent able to properly provide the claims phone number and PO box?","Did the agent inform the customer that the calls may be recorded for security purposes during callback?","Was all product information provided accurately?","Did the agent locate the information in a timely manner?","Did the agent execute properly any of the Escalation?","Did the agent properly execute any of the process for DOCUMENTATION Were Case Comments Complete and Accurate?","Did the agent followed proper call handling?","Maintains a friendly confident and professional voice tone throughout interaction","Accurately communicate during the interaction?","Did the agent meet the expectations they set during the interaction?","Going above and beyond or doing the extra mile","Did the agent resolve the issue and addressed the caller needs on this call?",
			"Comments 1 ","Comments 2 ","Comments 3 ","Comments 4 ","Comments 5 ","Comments 6 ","Comments 7 ","Comments 8 ","Comments 9 ","Comments 10 ","Comments 11 ","Comments 12 ","Comments 13 ","Comments 14 ","Comments 15 ","Comments 16 ","Comments 17 ","Comments 18 ","Comments 19 ","Comments 20",
			"Call Summary","Feedback","Agent Feedback Acceptance","Agent review date","Agent review note","Mgnt review date","Mgnt review by","Mgnt review note","Client_rvw_date","Client review by","Client review note");
		}else if($pid=="phs_email"){
			$header = array("Auditor Name","Audit Date","Agent","Fusion ID","L1 Super","Email Date","Channel","Case Number","Time stamp/Link","ACPT","ZTP","Member ID","Call Type","Caller Type","PHS Product/Agency","Audit Type","VOC","Language","Audit Start Date Time","Audit End Date Time","Interval(In Second)","Overall Score",
			"Does the email have the proper greeting?","Does the email contain probing questions or initial information gathered from the original email of member/provider?","Does the email provide relevant self-service option that can resolve the issue?","Does the email have the best resolution which is to contact customer service via chat or call?","Does the email show setting clear expectation on when the service will be completed?","Does the email sound professional and courteous?","Does the email have proper spelling grammar and formatting for all written customer-facing communication?","Was the email showing the proper closing statement?","Did the agent use the proper template provided?","Did the agent resolve the issue and addressed the member's needs on this email?","Did the agent adhere to all email policy and standards?","Did the agent handle the information on the email correctly?","For account closure did the agent follow cancellation and refund process?","Did the agent execute properly any of the Escalation?","Did the agent provide the accurate information needed by the member on the email?","Did the agent include the ticket number in the email and on the email subject?","Did the agent put email signature on the email?","Did the agent reply to the email/case within 1 business day?","Did the agent properly execute any of the process for DOCUMENTATION",
			"Remarks1","Remarks2","Remarks3","Remarks4","Remarks5","Remarks6","Remarks7","Remarks8","Remarks9","Remarks10","Remarks11","Remarks12","Remarks13","Remarks14","Remarks15","Remarks16","Remarks17","Remarks18", "Remarks19","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($pid=="phs_chat"){
			$header = array("Auditor Name","Audit Date","Agent","Fusion ID","L1 Super","Chat Date","Channel","Case Number","Time stamp/Link","ACPT","ZTP","Member ID","Call Type","Caller Type","PHS Product/Agency","Audit Type","VOC","Language","Audit Start Date Time","Audit End Date Time","Interval(In Second)","Overall Score",
			"Did the CSR adhere to all Authentication and Security Policies of the account member?","Did the agent provide information to a provider about the status of the members account?","Did the agent able to handle a credit card information correctly?","For account closure did the agent follow cancellation process?","Did the agent submit/process all eligible refund requests in accordance with the Refund Policy","Did the agent properly change the payment method?","Did the agent properly discussed member benefits?","Did the agent able to properly provide the claims phone number and PO box?","Was all product information provided accurately?","Did the agent locate the information in a timely manner?","Did the agent execute properly any of the Escalation?","Did the agent properly execute any of the process for DOCUMENTATION","Did the agent followed proper chat handling?","Maintains a friendly confident and professionalism throughout chat interaction","Accurately communicate during the interaction?","Did the agent meet the expectations they set during the chat interaction?","Going above and beyond or doing the extra mile","Did the agent resolve the issue and addressed the caller's needs on this call?",
			"Remarks1", "Remarks2", "Remarks3", "Remarks4", "Remarks5", "Remarks6", "Remarks7", "Remarks8", "Remarks9", "Remarks10", "Remarks11","Remarks12","Remarks13","Remarks14","Remarks15","Remarks16","Remarks17", "Remarks18", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($pid=="phs_chat_v2"){
			$header = array("Auditor Name","Audit Date","Agent","Fusion ID","L1 Super","Chat Date","Channel","Case Number","Time stamp/Link","ACPT","ZTP","Member ID","Chat Type","Caller Type","PHS Product/Agency","Audit Type","VOC","Audit Link","Language","Audit Start Date Time","Audit End Date Time","Interval(In Second)","Overall Score",
			"Verified the name address phone # email and DOB (3 out of 4 required)","Entered Interaction Notes in E123","Did the CSR follow the Policy/Procedure correctly","Was the reason for the chat addressed fully according to policy?","Did the CSR provide accurate information? (Correct information given without liability impact)","Did the CSR adhere to all of the Security Policies of the member's account?","Did the CSR meet the expectations set during the interaction (hold time)","Was the CSR Words/Statements/Polite/Positive/Professional","Express Empathy/Understanding","Active Reading","Did the CSR locate the information in a timely manner?","Did the CSR achieve the expectation set for spelling grammar or abbreviating","Demonstrate control of the conversation","Did the CSR properly escalate the member's concerns to the correct department?","Did the CSR review all interactions history billing finance and AOR notes","Does the CSR have a good understanding of the products/benefits","Asked probing questions","Good Hold Etiquette","Offer Self Service options","Updated information correctly in E123 (NBD Payment Information Address Changes etc.)","Did the CSR select the appropriate dispositions","Offered help above & beyond",
			"Verified the name address phone # email and DOB (3 out of 4 required) Remarks", "Entered Interaction Notes in E123 Remarks", "Did the CSR follow the Policy/Procedure correctly Remarks", "Was the reason for the chat addressed fully according to policy? Remarks", "Did the CSR provide accurate information? (Correct information given without liability impact) Remarks", "Did the CSR adhere to all of the Security Policies of the members account? Remarks", "Did the CSR meet the expectations set during the interaction (hold time) Remarks", "Was the CSR Words/Statements/Polite/Positive/Professional Remarks", "Express Empathy/Understanding Remarks", "Active Reading Remarks", "Did the CSR locate the information in a timely manner? Remarks","Did the CSR achieve the expectation set for spelling grammar or abbreviating Remarks","Demonstrate control of the conversation Remarks","Did the CSR properly escalate the members concerns to the correct department? Remarks","Did the CSR review all interactions history billing finance and AOR notes Remarks","Does the CSR have a good understanding of the products/benefits Remarks","Asked probing questions Remarks", "Good Hold Etiquette Remarks","Offer Self Service options Remarks","Updated information correctly in E123 (NBD Payment Information Address Changes etc.) Remarks","Did the CSR select the appropriate dispositions Remarks","Offered help above & beyond Remarks", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($pid=="phs_email_v2"){
			$header = array("Auditor Name","Audit Date","Agent","Fusion ID","L1 Super","Email Date","Channel","Case Number","Time stamp/Link","ACPT","ZTP","Member ID","Email Type","Caller Type","PHS Product/Agency","Audit Type","VOC","Audit Link","Language","Audit Start Date Time","Audit End Date Time","Interval(In Second)","Overall Score",
			"Did the CSR adhere to all of the Security Policies of the member's account?","Entered Interaction Notes in E123","Did the CSR follow the Policy/Procedure correctly","Was the reason for the email addressed fully according to policy?","Did the CSR provide accurate information? (Correct information given without liability impact)","Was the email composed correctly?","Did the CSR reply to the email during the standard time allowed","Active Reading","Was the CSR Tone/Words/Statements/Polite/Positive/Professional","Express Empathy/Understanding","Did the CSR review all interactions history billing finance and AOR notes","Does the CSR have a good understanding of the products/benefits","Offer Self Service options","Provided information for additional assistance","Updated information correctly in E123 (NBD Payment Information Address Changes etc.)","Did the CSR select the appropriate dispositions","Offered help above & beyond",
			"Did the CSR adhere to all of the Security Policies of the members account? Remarks","Entered Interaction Notes in E123 Remarks","Did the CSR follow the Policy/Procedure correctly Remarks","Was the reason for the email addressed fully according to policy? Remarks","Did the CSR provide accurate information? (Correct information given without liability impact) Remarks","Was the email composed correctly? Remarks","Did the CSR reply to the email during the standard time allowed Remarks","Active Reading Remarks","Was the CSR Tone/Words/Statements/Polite/Positive/Professional Remarks","Express Empathy/Understanding Remarks","Did the CSR review all interactions history billing finance and AOR notes Remarks","Does the CSR have a good understanding of the products/benefits Remarks","Offer Self Service options Remarks","Provided information for additional assistance Remarks","Updated information correctly in E123 (NBD Payment Information Address Changes etc.) Remarks","Did the CSR select the appropriate dispositions Remarks","Offered help above & beyond Remarks","Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}else if($pid=="phs_voice_v2"){
			$header = array("Auditor Name","Audit Date","Agent","Fusion ID","L1 Super","Call Date","Channel","Case Number","Time stamp/Link","ACPT","ZTP","Member ID","Call Type","Caller Type","PHS Product/Agency","Audit Type","VOC","Audit Link","Language","Audit Start Date Time","Audit End Date Time","Interval(In Second)","Overall Score",
			"Verified the name address phone # email and DOB (3 out of 4 required)","Entered Interaction Notes in E123","Did the CSR follow the Policy/Procedure correctly","Did the CSR provide accurate information? (Correct information given without liability impact)","Appropriate greeting (advising this call may be recorded for quality assurance)","Provider Call - Ask for the PROVIDER's name and the name of the facility","Obtain call back number","Did the CSR meet the expectations set during the interaction (hold time)","Was the CSR Tone/Words/Statements/Polite/Positive/Professional","Express Empathy/Understanding","Active Listening","Did the CSR prevent unexplained dead air","Good Hold/Transfer Etiquette","Demonstrate control of call","Did the CSR allow the member/provider/caller to speak without interrupting","Did the CSR review all interactions history billing finance and AOR notes","Does the CSR have a good understanding of the products/benefits","Asked probing questions","Was the reason for the call addressed fully according to policy?","Call Recap (Summary of the call)","Inquired if additional assistance was needed","Updated information correctly in E123 (NBD Payment Information Address Changes etc.)","Offered help above & beyond ",
			"Verified the name address phone # email and DOB (3 out of 4 required) Remarks", "Entered Interaction Notes in E123 Remarks", "Did the CSR follow the Policy/Procedure correctly Remarks", "Did the CSR provide accurate information? (Correct information given without liability impact) Remarks", "Appropriate greeting (advising this call may be recorded for quality assurance) Remarks", "Provider Call - Ask for the PROVIDERs name and the name of the facility Remarks", "Obtain call back number Remarks", "Did the CSR meet the expectations set during the interaction (hold time) Remarks", "Was the CSR Words/Statements/Polite/Positive/Professional Remarks", "Express Empathy/Understanding Remarks", "Active Listening Remarks","Did the CSR prevent unexplained dead air Remarks","Good Hold/Transfer Etiquette Remarks","Demonstrate control of call Remarks","Did the CSR allow the member/provider/caller to speak without interrupting Remarks","Did the CSR review all interactions history billing finance and AOR notes Remarks","Does the CSR have a good understanding of the products/benefits Remarks", "Asked probing questions Remarks","Was the reason for the call addressed fully according to policy? Remarks","Call Recap (Summary of the call) Remarks","Inquired if additional assistance was needed Remarks","Updated information correctly in E123 (NBD Payment Information Address Changes etc.) Remarks","Offered help above & beyond Remarks", "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($pid=="phs")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['channel'].'",';
				$row .= '"'.$user['file_number'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['member_id'].'",';
				$row .= '"'.$user['product_agency'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['busi_score'].'",';
				$row .= '"'.$user['cust_score'].'",';
				$row .= '"'.$user['comp_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['didtheCSRadheretoa'].'",';
				$row .= '"'.$user['callCSRadhereProcess'].'",';
				$row .= '"'.$user['didtheagentprovide'].'",';
				$row .= '"'.$user['didtheagentabletoh'].'",';
				$row .= '"'.$user['foraccountclosured'].'",';
				$row .= '"'.$user['didtheagentsubmito'].'",';
				$row .= '"'.$user['didtheagentproper'].'",';
				$row .= '"'.$user['didtheagentprop'].'",';
				$row .= '"'.$user['didtheagentabletop'].'",';
				$row .= '"'.$user['didtheagentinformt'].'",';
				$row .= '"'.$user['didtheagentpro'].'",';
				$row .= '"'.$user['didtheagentp'].'",';
				$row .= '"'.$user['didtheagentexecute'].'",';
				$row .= '"'.$user['didtheagentproperl'].'",';
				$row .= '"'.$user['didtheagentfollowe'].'",';
				$row .= '"'.$user['maintainsafriendly'].'",';
				$row .= '"'.$user['accuratelycommunic'].'",';
				$row .= '"'.$user['didtheagentmeetthe'].'",';
				$row .= '"'.$user['goingaboveandbeyon'].'",';
				$row .= '"'.$user['did_the_agent_resolve'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($pid=="phs_email")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['channel'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['link'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['member_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['product_agency'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['have_proper_greeting'].'",';
				$row .= '"'.$user['contain_proving_question'].'",';
				$row .= '"'.$user['provide_relavent_selfservice'].'",';
				$row .= '"'.$user['have_best_resolution'].'",';
				$row .= '"'.$user['show_setting_clear_expectation'].'",';
				$row .= '"'.$user['sound_professional'].'",';
				$row .= '"'.$user['proper_spelling_grammer'].'",';
				$row .= '"'.$user['show_proper_cloing_statement'].'",';
				$row .= '"'.$user['use_proper_template_'].'",';
				$row .= '"'.$user['did_the_agent_resolve'].'",';
				$row .= '"'.$user['agnet_adhere_email_policy'].'",';
				$row .= '"'.$user['agent_handle_information'].'",';
				$row .= '"'.$user['agent_follow_cancellation_process'].'",';
				$row .= '"'.$user['agent_execute_properly'].'",';
				$row .= '"'.$user['provide_information_on_email'].'",';
				$row .= '"'.$user['agent_include_ticket_number'].'",';
				$row .= '"'.$user['agent_email_signature'].'",';
				$row .= '"'.$user['agent_reply_email_case'].'",';
				$row .= '"'.$user['agent_execute_documentation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=="phs_email_v2")
		{
			$edit_url = "add_edit_phs_email_v2";
			$main_url =  $currentURL.''.$controller.'/'.$edit_url;
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['channel'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['link'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['member_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['product_agency'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['csr_adhere'].'",';
				$row .= '"'.$user['entraction_notes'].'",';
				$row .= '"'.$user['csr_policy'].'",';
				$row .= '"'.$user['reason_for_email'].'",';
				$row .= '"'.$user['accurate_information'].'",';
				$row .= '"'.$user['email_composed'].'",';
				$row .= '"'.$user['standard_time'].'",';
				$row .= '"'.$user['active_reading'].'",';
				$row .= '"'.$user['csr_tone'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['csr_review'].'",';
				$row .= '"'.$user['products_benefits'].'",';
				$row .= '"'.$user['self_service'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['updated_information'].'",';
				$row .= '"'.$user['appropriate_disposition'].'",';
				$row .= '"'.$user['offer_help'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($pid=="phs_chat")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['channel'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['link'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['member_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['product_agency'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['cr_adhere_authentication'].'",';
				$row .= '"'.$user['agent_provide_information'].'",';
				$row .= '"'.$user['agent_able_handle_creditcard'].'",';
				$row .= '"'.$user['agent_follow_cancellation'].'",';
				$row .= '"'.$user['agent_submit_elighible_refund'].'",';
				$row .= '"'.$user['agent_change_payment_method'].'",';
				$row .= '"'.$user['agent_dicuss_member_benefit'].'",';
				$row .= '"'.$user['provide_claim_phone_no'].'",';
				$row .= '"'.$user['product_information_provide'].'",';
				$row .= '"'.$user['locate_information_timely_manner'].'",';
				$row .= '"'.$user['execute_properly_escalation'].'",';
				$row .= '"'.$user['execute_process_documentation'].'",';
				$row .= '"'.$user['agent_follo_chat_handling'].'",';
				$row .= '"'.$user['profeionally_through_interaction'].'",';
				$row .= '"'.$user['accurate_communicate_th'].'",';
				$row .= '"'.$user['agnet_meet_expectation'].'",';
				$row .= '"'.$user['going_beyond_doing_extra_mile'].'",';
				$row .= '"'.$user['did_the_agent_resolve'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
		else if($pid=="phs_chat_v2")
		{
			$edit_url = "add_edit_phs_chat_v2";
			$main_url =  $currentURL.''.$controller.'/'.$edit_url;
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['channel'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['link'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['member_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['product_agency'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['verify_name_address'].'",';
				$row .= '"'.$user['entraction_notes'].'",';
				$row .= '"'.$user['csr_policy'].'",';
				$row .= '"'.$user['reason_for_chat'].'",';
				$row .= '"'.$user['accurate_information'].'",';
				$row .= '"'.$user['csr_security_policy'].'",';
				$row .= '"'.$user['hold_time'].'",';
				$row .= '"'.$user['csr_statement'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['active_reading'].'",';
				$row .= '"'.$user['timely_manner'].'",';
				$row .= '"'.$user['spelling_grammer'].'",';
				$row .= '"'.$user['control_conservation'].'",';
				$row .= '"'.$user['members_concern'].'",';
				$row .= '"'.$user['csr_review'].'",';
				$row .= '"'.$user['products_benefits'].'",';
				$row .= '"'.$user['probing_questions'].'",';
				$row .= '"'.$user['hold_etiquette'].'",';
				$row .= '"'.$user['offer_self_service'].'",';
				$row .= '"'.$user['updated_information'].'",';
				$row .= '"'.$user['appropriate_disposition'].'",';
				$row .= '"'.$user['offer_help'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($pid=="phs_voice_v2")
		{
			$edit_url = "add_edit_phs_voice_v2";
			$main_url =  $currentURL.''.$controller.'/'.$edit_url;
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['channel'].'",';
				$row .= '"'.$user['file_no'].'",';
				$row .= '"'.$user['link'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['ztp'].'",';
				$row .= '"'.$user['member_id'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['caller_type'].'",';
				$row .= '"'.$user['product_agency'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['verify_name_address'].'",';
				$row .= '"'.$user['entraction_notes'].'",';
				$row .= '"'.$user['csr_policy'].'",';
				$row .= '"'.$user['accurate_information'].'",';
				$row .= '"'.$user['appropriate_greeting'].'",';
				$row .= '"'.$user['provider_call'].'",';
				$row .= '"'.$user['call_back_number'].'",';
				$row .= '"'.$user['hold_time'].'",';
				$row .= '"'.$user['csr_statement'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['transfer_etiquette'].'",';
				$row .= '"'.$user['control_of_call'].'",';
				$row .= '"'.$user['speak_without_interrupting'].'",';
				$row .= '"'.$user['csr_review'].'",';
				$row .= '"'.$user['products_benefits'].'",';
				$row .= '"'.$user['probing_questions'].'",';
				$row .= '"'.$user['reason_for_call'].'",';
				$row .= '"'.$user['call_recap'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['updated_information'].'",';
				$row .= '"'.$user['offer_help'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}
	}

//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// NETMEDS //////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_netmeds_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_netmeds_report.php";
			$data["content_js"] = "qa_loanxm_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_netmeds_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from 	= mmddyy2mysql($this->input->get('date_from'));
				$date_to 	= mmddyy2mysql($this->input->get('date_to'));
				$office_id 	= $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');
				$campaign 	= $this->input->get('campaign');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_netmeds_list"] = $fullAray;
				$this->create_qa_netmeds_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_netmeds_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_netmeds_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA netmeds Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_netmeds_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		if($campaign == 'chat_monitor_netmeds')
		{
			////////////////////////////////////////////////////////
			$header = array("Auditor Name", "Audit Date","L1 Supervisor:" ,"Agent", "Fusion ID","Incoming Number","Ticket Id","Chat Disconnected By","Register","Customer Name","Disposition", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Overall Score","Greet the customer / address the customer","Did the agent offer assistance","Empathy","Apology","Probing","Paraphrasing","Assurance","Accuracy in addressing issue","Avoid using templates that dont answer the customers question","Convey the info without deviation/Repetition","Incomplete statement","Followed hold script to place hold","Followed hold script to retreive hold","Clarity in Communication","SPELLING","PUNCTUATION","Comprehension (understanding of issue)","Jargons / Grammatical Error / Case sensitive","Plesantries please/thank you","Correct info about query/ webiste / Offers / Process(Return and SOP)","Appropriate and Timely Resolution","Acknowledgement and Response","Addressing concern","Mapping of Order ID","Clear disposition comment","Checking for duplicate Cases","Dispostion","Offer Additional Assistance","Did the agent use the appropriate closing statement?","SURVEY PITCH","Professionalism/ Profanity","Case Disposition / Wrong Documentation/ Amendments","Process Adherence","Chat avoidance","Misleading / Incorrect information given/ Wrong Resolution/ Improper Exit on Call","Rude Behaviour/Sarcastic or Personal comments","Ticket assignment",
            "Reason1","Reason2","Reason3","Reason4","Reason5","Reason6","Reason7","Reason8","Reason9","Reason10","Reason11",
            "Reason12","Reason13","Reason14","Reason15","Reason16","Reason17","Reason18","Reason19","Reason20","Reason21","Reason22","Reason23","Reason24","Reason25","Reason26","Reason27","Reason28","Reason29","Reason30","Reason31","Reason32","Reason33","Reason34","Reason35","Reason36","Observation","Call Summary","Agent Feedback Acceptance","Feedback", "Agent Comment","Agent Review Date", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer_name'].'",';
	            $row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['greet_customer'].'",';
				$row .= '"'.$user['agent_offer'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['apology'].'",';
				$row .= '"'.$user['probing'].'",';
				$row .= '"'.$user['paraphrasing'].'",';
				$row .= '"'.$user['assurance'].'",';
				$row .= '"'.$user['accuracy_in_address'].'",';
				$row .= '"'.$user['avoid_template'].'",';
				$row .= '"'.$user['convey_deviation'].'",';
				$row .= '"'.$user['incomplete_statement'].'",';
				$row .= '"'.$user['followed_hold'].'",';
				$row .= '"'.$user['followed_retreive'].'",';
				$row .= '"'.$user['clarity_in_comm'].'",';
				$row .= '"'.$user['spelling'].'",';
				$row .= '"'.$user['punctuation'].'",';
				$row .= '"'.$user['comprehension_issue'].'",';
				$row .= '"'.$user['grammatical_error'].'",';
				$row .= '"'.$user['plesantries_please'].'",';
				$row .= '"'.$user['return_sop'].'",';
				$row .= '"'.$user['timely_resolution'].'",';
				$row .= '"'.$user['acknowledgement_response'].'",';
				$row .= '"'.$user['address_concern'].'",';
				$row .= '"'.$user['mapping_orderid'].'",';
				$row .= '"'.$user['disposition_comment'].'",';
				$row .= '"'.$user['duplicate_cases'].'",';
				$row .= '"'.$user['disposition_param'].'",';
				$row .= '"'.$user['offer_additional_assistance'].'",';
				$row .= '"'.$user['appr_closing_statement'].'",';
				$row .= '"'.$user['survey_pitch'].'",';
				$row .= '"'.$user['professionalism'].'",';
				$row .= '"'.$user['amendments'].'",';
				$row .= '"'.$user['process_adherence'].'",';
				$row .= '"'.$user['misleading'].'",';
				$row .= '"'.$user['rude'].'",';
				$row .= '"'.$user['ticket_assigment'].'",';
				$row .= '"'.$user['rude'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'.$user['cmt22'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['cmt24'].'",';
				$row .= '"'.$user['cmt25'].'",';
				$row .= '"'.$user['cmt26'].'",';
				$row .= '"'.$user['cmt27'].'",';
				$row .= '"'.$user['cmt28'].'",';
				$row .= '"'.$user['cmt29'].'",';
				$row .= '"'.$user['cmt30'].'",';
				$row .= '"'.$user['cmt31'].'",';
				$row .= '"'.$user['cmt32'].'",';
				$row .= '"'.$user['cmt33'].'",';
				$row .= '"'.$user['cmt34'].'",';
				$row .= '"'.$user['cmt35'].'",';
				$row .= '"'.$user['cmt36'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


			////////////////////////////////////////////////////////
		}
		else{

				$header = array("Auditor Name", "Audit Date","L1 Supervisor:" ,"Agent", "Fusion ID","Incoming Number","Call Date", "Call Duration","Call Link","Ticket No","Call Disconnected By","How did the customer come in","Register","Customer Name","Disposition","Query/Service","Type of Call", "How did the cust leave in", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Overall Score","Opening Script","Tone","Empathy","Apology","Probing",
	            "Paraphrasing","Assurance","Accuracy in sharing or confirming Information","Placing the call on hold","Retrieving the call","Transfer Procedure","Offered Additional Assistance","Survey Script","Resolution confirmation/Recap","Closing script","Documentation","Appropriate and Timely Resolution","Listening & Comprehension","Patience & Interruption","Acknowledgement and Response","Politeness and Energy and Phone etiquette","Dead air Management","Grammar & Sentence construction","Pronunciation","Intonation","Rate of speech","Clarity in Communication","Professionalism/ Profanity","Call Disconnect","Case Disposition / Wrong Documentation/ Amendments","Process Adherence","Call avoidance ( Time Frame - 5 secs)","Misleading / Incorrect information given/ Wrong Resolution/ Improper Exit on Call","Call back not done","Rude Behaviour/Sarcastic or Personal comments",
	            "Reason1","Reason2","Reason3","Reason4","Reason5","Reason6","Reason7","Reason8","Reason9","Reason10","Reason11",
	            "Reason12","Reason13","Reason14","Reason15","Reason16","Reason17","Reason18","Reason19","Reason20","Reason21","Reason22","Reason23","Reason24","Reason25","Reason26","Reason27","Reason28","Reason29","Reason30","Reason31","Reason32","Reason33","Reason34","Reason35","Observation","Call Summary","Feedback","Agent Feedback Acceptance","Agent Comment","Agent Review Date", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['incoming_no'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_link'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect_by'].'",';
				$row .= '"'.$user['cust_come_in'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['customer_name'].'",';
	            $row .= '"'.$user['disposition'].'",';
	            $row .= '"'.$user['query_service'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['cust_come_in'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['opening_script'].'",';
				$row .= '"'.$user['tone'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['apology'].'",';
				$row .= '"'.$user['probing'].'",';
				$row .= '"'.$user['paraphrasing'].'",';
				$row .= '"'.$user['assurance'].'",';
				$row .= '"'.$user['sharing_information'].'",';
				$row .= '"'.$user['call_on_hold'].'",';
				$row .= '"'.$user['retrieving_call'].'",';
				$row .= '"'.$user['transfer_procedure'].'",';
				$row .= '"'.$user['additional_assist'].'",';
				$row .= '"'.$user['survey_script'].'",';
				$row .= '"'.$user['confirmation_recap'].'",';
				$row .= '"'.$user['closing_script'].'",';
				$row .= '"'.$user['documentation'].'",';
				$row .= '"'.$user['timely_resolution'].'",';
				$row .= '"'.$user['listening_comprehension'].'",';
				$row .= '"'.$user['patience_interrupt'].'",';
				$row .= '"'.$user['aknowledgement'].'",';
				$row .= '"'.$user['politeness'].'",';
				$row .= '"'.$user['air_management'].'",';
				$row .= '"'.$user['grammar_sentence'].'",';
				$row .= '"'.$user['pronunciation'].'",';
				$row .= '"'.$user['intonation'].'",';
				$row .= '"'.$user['rate_speech'].'",';
				$row .= '"'.$user['communication'].'",';
				$row .= '"'.$user['professionalism'].'",';
				$row .= '"'.$user['call_disconnect'].'",';
				$row .= '"'.$user['amendments'].'",';
				$row .= '"'.$user['process_adherence'].'",';
				$row .= '"'.$user['call_avoidance'].'",';
				$row .= '"'.$user['misleading'].'",';
				$row .= '"'.$user['call_back'].'",';
				$row .= '"'.$user['rude'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'.$user['cmt22'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['cmt24'].'",';
				$row .= '"'.$user['cmt25'].'",';
				$row .= '"'.$user['cmt26'].'",';
				$row .= '"'.$user['cmt27'].'",';
				$row .= '"'.$user['cmt28'].'",';
				$row .= '"'.$user['cmt29'].'",';
				$row .= '"'.$user['cmt30'].'",';
				$row .= '"'.$user['cmt31'].'",';
				$row .= '"'.$user['cmt32'].'",';
				$row .= '"'.$user['cmt33'].'",';
				$row .= '"'.$user['cmt34'].'",';
				$row .= '"'.$user['cmt35'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['observation'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}
	}

//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// DUNZO //////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_dunzo_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_dunzo_report.php";
			$data["content_js"] = "qa_loanxm_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_dunzo_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from 	= mmddyy2mysql($this->input->get('date_from'));
				$date_to 	= mmddyy2mysql($this->input->get('date_to'));
				$office_id 	= $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');
				$campaign 	= $this->input->get('campaign');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select email_id_off from info_personal ip where ip.user_id=entry_by) as auditor_email,
				(select email_id_off from info_personal ipa where ipa.user_id=agent_id) as agent_email,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_dunzo_list"] = $fullAray;
				$this->create_qa_dunzo_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_dunzo_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_dunzo_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Dunzo Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_dunzo_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		if($campaign == 'dunzo_call')
		{
			////////////////////////////////////////////////////////
			$header = array("Auditor Name", "Auditor Email", "Audit Date", "L1 Supervisor" ,"Agent", "Agent Email", "Fusion ID", "Chat Date", "AHT","Customer Contact Number","Campaign","Zone","Team Manager", "Transaction ID", "Label Category", "Call Link", "Week", "Audit Type","VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Possible Score","Earned Score","Overall Score",
			"Advisor used the standard greeting format","Appropriate responses ( acknowledging at the right time)","Ownership on Chats/ Delay in responding","Active Listening and Interruption","Empathy/Sympathy","Relevant responses","Hold","Grammar Sentence structure Tone","Probing done whenever necessary","Recap (Summarization of the conversation)","Advisor used the standard closing format","Accurate Resolution/Information is provided as per the process","Private notes","Professional / Courtesy","Verification process followed","Calls made to Partner/User","Process & Procedure Followed","Labels","First Chat Resolution",
            "Reason1","Reason2","Reason3","Reason4","Reason5","Reason6","Reason7","Reason8","Reason9","Reason10","Reason11",
            "Reason12","Reason13","Reason14","Reason15","Reason16","Reason17","Reason18","Areas of Improvement","Positives","Summary of the chat",
			"Agent Feedback Acceptance","Feedback", "Agent Comment","Agent Review Date", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['auditor_email'].'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['agent_email'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['chat_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['zone'].'",';
	            $row .= '"'.$user['team_manager'].'",';
	            $row .= '"'.$user['transaction_id'].'",';
	            $row .= '"'.$user['concept'].'",';
	            $row .= '"'.$user['call_link'].'",';
	            $row .= '"'.$user['week'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'%'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['standard_greeting'].'",';
				$row .= '"'.$user['appropriate_responses'].'",';
				$row .= '"'.$user['delay_response'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['empathise'].'",';
				$row .= '"'.$user['relevent_responses'].'",';
				$row .= '"'.$user['hold'].'",';
				$row .= '"'.$user['grammatically_correct'].'",';
				$row .= '"'.$user['probing_done'].'",';
				$row .= '"'.$user['summarization'].'",';
				$row .= '"'.$user['closing_format'].'",';
				$row .= '"'.$user['accurate_resolution'].'",';
				$row .= '"'.$user['private_notes'].'",';
				$row .= '"'.$user['professional'].'",';
				$row .= '"'.$user['verification_process'].'",';
				$row .= '"'.$user['call_partner'].'",';
				$row .= '"'.$user['process_procedure'].'",';
				$row .= '"'.$user['labels'].'",';
				$row .= '"'.$user['chat_resolution'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['positives'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';

				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
			////////////////////////////////////////////////////////
		}
	}

//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// Nurture Farms ////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_nurture_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_nurture_report.php";
			$data["content_js"] = "qa_loanxm_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_nurture_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from 	= mmddyy2mysql($this->input->get('date_from'));
				$date_to 	= mmddyy2mysql($this->input->get('date_to'));
				$office_id 	= $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');
				$campaign 	= $this->input->get('campaign');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_nurture_list"] = $fullAray;
				$this->create_qa_nurture_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_nurture_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_nurture_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA nurture farms Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_nurture_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign == 'nurture_farms')
		{
			////////////////////////////////////////////////////////
			$header = array("Auditor Name", "Audit Date","L1 Supervisor:" ,"Agent", "Fusion ID","QRC","Call Duration","Customer Contact Number","Additional Info","Zone","Auditor Role", "Auditor Name", "Auditor Id","Auditor Role","Customer Type","QRC Status","Call Language","Audit Type","Customer Audit Type","Call Type","VOC","Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Possible Score","Earned Score","Overall Score","Did the agent open the call correctly?","opening done within no reason","Was the call opened within the defined time frame? (Call to be opened in 6 seconds)","call_opened_no_reason","Did the agent follow the identification process?","Did the agent share the purpose of the call with the customer? (reason for outbound call)","purpose_of_the_call_no_reason","Did the agent ask appropriate fact finding questions/ Probing done?","Did the agent use previous notes appropriately on the call for reference?", "call reference no reason","Did the agent identify the customer as a potential DSAT and handle objections accordingly?","potential_dsat_no_reason","Were the issues/concerns/enquiries related to NF/NR App appropriately addressed and was the application use promoted?","concerns nfnr no reason","Were the issues/concerns for cashout and points redemption handled appropriately and was the customer educated about the reason for the same?","Did the agent speak clearly and concise","Was there an MTI/Regional influence observed on the call and was the agent able to construct grammatically correct sentences to ensure better customer understanding?","Did the agent sound energetic confident and intonate well?","sound energetic no reason","Did the agent maintain appropriate ROS?","maintain ros no reason","Did the agent actively listen throughout the call and avoid interruption?","avoid interruption no reason","Did the agent comprehend well and acknowledge appropriately and take ownership?","Did the agent avoid the usage of fillers and foghorns?","Did the agent follow correct Hold Transfer Procedure ( HMT ) and avoid dead air during the call ?","transfer procedure no reason","Did the agent personalize the call?","personalize call no reason","Did the agent used Service No techniques?","no service tech no reason","Did the agent empathize or apologize to the customer and offer assurance?","apologize customer no reason","Was the agent professional on the call and were there any wrong practices observed? harassed misbehaved was rude abused the customer","wrong practices no reason","Did the agent summarize the call appropriately ?","Did the agent check for customers understanding and ask for further assistance ?","further assistance no reason","Did the agent use appropriate call closing and CSAT Script?","Did the agent update detailed notes in the description box in SFDC?(no one liner or one word description)","description box no reason","Did the agent use accurate tagging for the call?","Did the agent provide all accurate information and did not mislead the customer or give any wrong information or a false commitment?","Did the agent provide Customer Experience beyond expectation?","Remarks1","Remarks2","Remarks3","Remarks4","Remarks5","Remarks6","Remarks7","Remarks8","Remarks9","Remarks10","Remarks11",
                "Remarks12","Remarks13","Remarks14","Remarks15","Remarks16","Remarks17","Remarks18","Remarks19","Remarks20","Remarks21","Remarks22","Remarks23","Remarks24","Remarks25","Remarks26","Remarks27","Remarks28","Agent related observations/challenges noticed on call","other observations challenges","suggestion observations challenges","Customer related observations/challenges noticed on call","other customer observations","suggestion customer observations","Technical related observations/challenges noticed on call","other technical observations","suggestion technical observations","Process related observations/challenges noticed on call","other process observations","suggestion process observations","Call Synopsis","Remark","AOI","Agent Feedback Acceptance","Feedback", "Agent Comment","Agent Review Date", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				$call_summary = '';
				$aoi = '';
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['qrc'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['additional_info'].'",';
				$row .= '"'.$user['zone'].'",';
	            $row .= '"'.$user['auditor_role'].'",';
	            $row .= '"'.$user['auditer_name'].'",';
	            $row .= '"'.$user['auditor_id'].'",';
	            $row .= '"'.$user['auditor_role'].'",';
	            $row .= '"'.$user['customer_type'].'",';
	            $row .= '"'.$user['qrc_status'].'",';
	            $row .= '"'.$user['call_language'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['customer_audit_type'].'",';
				$row .= '"'.$user['customer_call_type'].'",';
				$row .= '"'.$user['voc'].'",';
				// $row .= '"'.$user['audit_start_time'].'",';
				// $row .= '"'.$user['entry_date'].'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
                $row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'%'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['opening_done_within'].'",';
				$row .= '"'.$user['opening_done_within_no_reason'].'",';
				$row .= '"'.$user['call_opened'].'",';
				$row .= '"'.$user['call_opened_no_reason'].'",';
				$row .= '"'.$user['self_introduction'].'",';
				$row .= '"'.$user['purpose_of_the_call'].'",';
				$row .= '"'.$user['purpose_of_the_call_no_reason'].'",';
				$row .= '"'.$user['probing_done'].'",';
				$row .= '"'.$user['call_reference'].'",';
				$row .= '"'.$user['call_reference_no_reason'].'",';
				$row .= '"'.$user['potential_dsat'].'",';
				$row .= '"'.$user['potential_dsat_no_reason'].'",';
				$row .= '"'.$user['concerns_nfnr'].'",';
				$row .= '"'.$user['concerns_nfnr_no_reason'].'",';
				$row .= '"'.$user['concerns_cashout'].'",';
				$row .= '"'.$user['clear_concise'].'",';
				$row .= '"'.$user['grammatically_correct'].'",';
				$row .= '"'.$user['sound_energetic'].'",';
				$row .= '"'.$user['sound_energetic_no_reason'].'",';
				$row .= '"'.$user['maintain_ros'].'",';
				$row .= '"'.$user['maintain_ros_no_reason'].'",';
				$row .= '"'.$user['avoid_interruption'].'",';
				$row .= '"'.$user['avoid_interruption_no_reason'].'",';
				$row .= '"'.$user['comprehend_ownership'].'",';
				$row .= '"'.$user['fillers_foghorns'].'",';
				$row .= '"'.$user['transfer_procedure'].'",';
				$row .= '"'.$user['transfer_procedure_no_reason'].'",';
				$row .= '"'.$user['personalize_call'].'",';
				$row .= '"'.$user['personalize_call_no_reason'].'",';
				$row .= '"'.$user['no_service_tech'].'",';
				$row .= '"'.$user['no_service_tech_no_reason'].'",';
				$row .= '"'.$user['apologize_customer'].'",';
				$row .= '"'.$user['apologize_customer_no_reason'].'",';
				$row .= '"'.$user['wrong_practices'].'",';
				$row .= '"'.$user['wrong_practices_no_reason'].'",';
				$row .= '"'.$user['summarize_call'].'",';
				$row .= '"'.$user['further_assistance'].'",';
				$row .= '"'.$user['further_assistance_no_reason'].'",';
				$row .= '"'.$user['csat_link'].'",';
				$row .= '"'.$user['description_box'].'",';
				$row .= '"'.$user['description_box_no_reason'].'",';
				$row .= '"'.$user['accurate_tagging'].'",';
				$row .= '"'.$user['incorrect_information'].'",';
				$row .= '"'.$user['customer_experience'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'.$user['cmt22'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['cmt24'].'",';
				$row .= '"'.$user['cmt25'].'",';
				$row .= '"'.$user['cmt26'].'",';
				$row .= '"'.$user['cmt27'].'",';
				$row .= '"'.$user['cmt28'].'",';
				$row .= '"'.$user['observations_challenges'].'",';
				$row .= '"'.$user['other_observations_challenges'].'",';
				$row .= '"'.$user['suggestion_observations_challenges'].'",';
				$row .= '"'.$user['customer_observations'].'",';
				$row .= '"'.$user['other_customer_observations'].'",';
				$row .= '"'.$user['suggestion_customer_observations'].'",';
				$row .= '"'.$user['technical_observations'].'",';
				$row .= '"'.$user['other_technical_observations'].'",';
				$row .= '"'.$user['suggestion_technical_observations'].'",';
				$row .= '"'.$user['process_observations'].'",';
				$row .= '"'.$user['other_process_observations'].'",';
				$row .= '"'.$user['suggestion_process_observations'].'",';
				$call_summary = str_replace('"',"'",str_replace($searches, "", $user['call_summary']));

				$row .= '"'. preg_replace('/[^(\x20-\x7F)\x0A\x0D]*/','', $call_summary).'",';
				// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$aoi  =   str_replace('"',"'",str_replace($searches, "", $user['aoi']));
				$row .=  '"'. preg_replace('/[^(\x20-\x7F)\x0A\x0D]*/','', $aoi).'",';
				// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['aoi'])).'",';

				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
			////////////////////////////////////////////////////////
		}
		else{
				////////////////////////////////////////////////////////
			$header = array("Auditor Name", "Audit Date","L1 Supervisor:" ,"Agent", "Fusion ID","QRC","Call Duration","Customer Contact Number","Additional Info","Zone", "Auditor Name", "Auditor Id","Customer Type","QRC Status","Call Language","Audit Type","Customer Audit Type","Call Type","VOC","Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Possible Score","Earned Score","Overall Score",

			"Greeting & Introduction",
			"Explain The Reason Of Call & Seek Permission to Proceed",
			"Customer Authentication",
			"Tone confidence and clarity",
			"Paraphrasing & Comprehension",
			"Hold & Dead Air Followed",
			"Empathy",
			"Correct information Provided Offer Informed Correctly",
			"Handle The Objections Raised",
			"Complete the Sale With Consent",
			"Summarize and Call Closing",
			"Tagging & Documentation",
			"Call avoidance & Rudeness",
			"Remarks1","Remarks2","Remarks3","Remarks4","Remarks5","Remarks6","Remarks7","Remarks8","Remarks9","Remarks10","Remarks11",
			"Remarks12","Remarks13",
			"Call Synopsis","Remark","AOI","Agent Feedback Acceptance","Agent Review Date","Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			$call_summary = '';
			$aoi = '';
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['qrc'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['customer_contact_number'].'",';
			$row .= '"'.$user['additional_info'].'",';
			$row .= '"'.$user['zone'].'",';
			$row .= '"'.$user['auditer_name'].'",';
			$row .= '"'.$user['auditor_id'].'",';
			$row .= '"'.$user['customer_type'].'",';
			$row .= '"'.$user['qrc_status'].'",';
			$row .= '"'.$user['call_language'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['customer_audit_type'].'",';
			$row .= '"'.$user['customer_call_type'].'",';
			$row .= '"'.$user['voc'].'",';
			// $row .= '"'.$user['audit_start_time'].'",';
			// $row .= '"'.$user['entry_date'].'",';
			$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
            $row .= '"'.ConvServerToLocal($user['entry_date']).'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['possible_score'].'%'.'",';
			$row .= '"'.$user['earned_score'].'%'.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['greeting_introduction'].'",';
			$row .= '"'.$user['explain_reason'].'",';
			$row .= '"'.$user['customer_authentication'].'",';
			$row .= '"'.$user['tone_confidence'].'",';
			$row .= '"'.$user['paraphrasing_comprehension'].'",';
			$row .= '"'.$user['holddead_air'].'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'.$user['correct_information'].'",';
			$row .= '"'.$user['handle_objections'].'",';
			$row .= '"'.$user['complete_sale'].'",';
			$row .= '"'.$user['summarize_call'].'",';
			$row .= '"'.$user['tagging_documentation'].'",';
			$row .= '"'.$user['call_avoidance'].'",';
			$row .= '"'.$user['cmt1'].'",';
			$row .= '"'.$user['cmt2'].'",';
			$row .= '"'.$user['cmt3'].'",';
			$row .= '"'.$user['cmt4'].'",';
			$row .= '"'.$user['cmt5'].'",';
			$row .= '"'.$user['cmt6'].'",';
			$row .= '"'.$user['cmt7'].'",';
			$row .= '"'.$user['cmt8'].'",';
			$row .= '"'.$user['cmt9'].'",';
			$row .= '"'.$user['cmt10'].'",';
			$row .= '"'.$user['cmt11'].'",';
			$row .= '"'.$user['cmt12'].'",';
			$row .= '"'.$user['cmt13'].'",';
			$call_summary = str_replace('"',"'",str_replace($searches, "", $user['call_summary']));

			$row .= '"'. preg_replace('/[^(\x20-\x7F)\x0A\x0D]*/','', $call_summary).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$aoi  =   str_replace('"',"'",str_replace($searches, "", $user['aoi']));
			$row .=  '"'. preg_replace('/[^(\x20-\x7F)\x0A\x0D]*/','', $aoi).'",';
			// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['aoi'])).'",';

			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);
		////////////////////////////////////////////////////////
		}
	}

	//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// Revive Rx ////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_revive_rx_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_revive_rx_report.php";
			$data["content_js"] = "qa_loanxm_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_revive_rx_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from 	= mmddyy2mysql($this->input->get('date_from'));
				$date_to 	= mmddyy2mysql($this->input->get('date_to'));
				$office_id 	= $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');
				$campaign 	= $this->input->get('campaign');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					//$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				echo $qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
				exit;
				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_revive_rx_list"] = $fullAray;
				$this->create_qa_revive_rx_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_revive_rx_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_revive_rx_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Revive Rx Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_revive_rx_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		if($campaign == 'revive_rx')
		{
			////////////////////////////////////////////////////////
			$header = array("Auditor Name", "Audit Date","L1 Supervisor:" ,"Agent", "Fusion ID","Call Id","Call Duration","Contact Number","Audit Type","VOC","Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Possible Score","Earned Score","Overall Score","Did the agent confirm the shipping address before transfer the call?","Did the agent used soft skills during the call?","Did the agent send a text message and leave voice mail?","Did the agent used all phone numbers on the account to contact the patient?","Did the agent confirm the payment method and ask for authorization to process the payment?","Did the agent leave proper notes on the account?","Did the agent check the account to make sure that a call was needed?","Did the agent adhere properly to the hold/dead air policy?","Did the agent use a warm transfer?", "Did the agent cerify the patiente identity before provide details of the prescription?","Remarks1","Remarks2","Remarks3","Remarks4","Remarks5","Remarks6","Remarks7","Remarks8","Remarks9","Remarks10","Call Summary","Remark","Agent Feedback Acceptance","Agent Review Date","Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['possible_score'].'%'.'",';
				$row .= '"'.$user['earned_score'].'%'.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['confirm_shipping_address'].'",';
				$row .= '"'.$user['soft_skills'].'",';
				$row .= '"'.$user['voice_mail'].'",';
				$row .= '"'.$user['contact_patient'].'",';
				$row .= '"'.$user['payment_confirm'].'",';
				$row .= '"'.$user['proper_note'].'",';
				$row .= '"'.$user['verify_call'].'",';
				$row .= '"'.$user['hold'].'",';
				$row .= '"'.$user['warm_transfer'].'",';
				$row .= '"'.$user['validate_account'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
			////////////////////////////////////////////////////////
		}
	}

//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// INDIA MOE //////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_india_moe_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_india_moe_report.php";
			$data["content_js"] = "qa_loanxm_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_india_moe_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from 	= mmddyy2mysql($this->input->get('date_from'));
				$date_to 	= mmddyy2mysql($this->input->get('date_to'));
				$office_id 	= $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_india_moe_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_india_moe_list"] = $fullAray;
				$this->create_qa_india_moe_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_india_moe_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_india_moe_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA India Moe Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_india_moe_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
			////////////////////////////////////////////////////////
			$header = array("Auditor Name", "Audit Date","L1 Supervisor" ,"Agent", "Fusion ID","Call Duration","Contact Number","Audit Type","Revenue","VOC","Audit Start Date Time", "Audit End Date Time", "Interval(in sec)","Overall Score","Tagging Error Count","Tag error score","Probing Error Count","Probe error score","Any other error Count","Any other error score",
            "Reason1","Reason2","Reason3","Reason4","Fallout","FT Reason","ZIP","Call Status","Agent Feedback Acceptance","Feedback", "Agent Comment","Agent Review Date", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['contact_number'].'",';
	            $row .= '"'.$user['revenue'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['tagging_error'].'",';
				$row .= '"'.$user['tag_error_score'].'",';
				$row .= '"'.$user['probing_error'].'",';
				$row .= '"'.$user['probe_error_score'].'",';
				$row .= '"'.$user['any_other_error'].'",';
				$row .= '"'.$user['any_other_error_score'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['fallout_error'].'",';
				$row .= '"'.$user['ft_reason'].'",';
				$row .= '"'.$user['zip_error'].'",';
				$row .= '"'.$user['call_status'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
			////////////////////////////////////////////////////////

	}
//////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// STRATUS //////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////
	public function qa_stratus_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_stratus_report.php";
			$data["content_js"] = "qa_loanxm_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["qa_stratus_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_stratus_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_stratus_list"] = $fullAray;
				$this->create_qa_stratus_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_stratus_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_stratus_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA stratus Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_stratus_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date","Call Date", "Agent", "Fusion ID", "L1 Super","Order Number", "Customer Name", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(in sec)", "Auto Fail", "Overall Score","PATIENT INFORMATION","Did the agent input the correct patients first and last name?","Did the agent input the correct patient's date of birth?","Did the agent input the correct patient's physical address?","Did the agents added the correct patient's phone and alternative number/s?","Did the agents added the correct (Social Security Number) SSN Email Address when applicable.","Did the agent selected the correct branch facility and place of service?","CLINICAL","Did the agent selected the correct patient's gender?","Did the agent added the correct Ordering Provider?","Did the agent added the correct Marketing Rep?","Did the agent input the correct patient's diagnosis code?","INSURANCE","Unable to add/update insurance info to the order ","Failure to check insurance eligibility?","Did the agent updated the insurance eligibility date?","Failure to update the Insurance policy holder information?","SALES ORDER","Failure to delete scheduled unit delivery date.","Did the agent selected the correct branch office and Inv Location?","Did the agent added the Order Reference?","Did the agent updated the WIP state?","Did the agent add the appropriate EEG length of service?","Order Entry","Failure to mark work fax.","Did not move to EEG today.","Failure to update missing information","ATTACHMENT","Wrong attachment to order belonging to another patient? HIPAA","Did the agent create a duplicate order?","Did the agent upload the fax file to the order?","MAJOR ERRORS","Did the agent documented the account properly?","Did the agent input the correct ordered items?","Did the agent send an email to the correct marketing representative?","Did the agent send the missing fax information to the Doctor's office?","Markdown Comments1","Markdown Comments2","Markdown Comments3","Markdown Comments4","Markdown Comments5","Markdown Comments6","Markdown Comments7","Markdown Comments8","Markdown Comments9","Markdown Comments10","Markdown Comments11","Markdown Comments12","Markdown Comments13","Markdown Comments14","Markdown Comments15","Markdown Comments16","Markdown Comments17","Markdown Comments18","Markdown Comments19","Markdown Comments20","Markdown Comments21","Markdown Comments22","Markdown Comments23","Markdown Comments24","Markdown Comments25","Markdown Comments26","Markdown Comments27","Markdown Comments28","Markdown Comments29","Markdown Comments30","Markdown Comments31","Markdown Comments32","Markdown Comments33","Markdown Comments34","Markdown Comments35","Markdown Comments36","Call Summary", "Feedback", "Agent Feedback Acceptance","Agent Review Date", "Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['order_number'].'",';
			$row .= '"'.$user['customer_name'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['auto_fail'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['patient_information'].'",';
			$row .= '"'.$user['patient_name'].'",';
			$row .= '"'.$user['patient_dob'].'",';
			$row .= '"'.$user['patient_physical_address'].'",';
			$row .= '"'.$user['patient_phone_number'].'",';
            $row .= '"'.$user['agent_added_email'].'",';
            $row .= '"'.$user['agent_select_branch_facility'].'",';
            $row .= '"'.$user['clinical'].'",';
            $row .= '"'.$user['patient_gender'].'",';
            $row .= '"'.$user['ordering_provider'].'",';
            $row .= '"'.$user['marketing_rep'].'",';
            $row .= '"'.$user['diagnosis_code'].'",';
            $row .= '"'.$user['insurance'].'",';
            $row .= '"'.$user['info_order'].'",';
            $row .= '"'.$user['insurance_eligibility'].'",';
            $row .= '"'.$user['eligibility_date'].'",';
			$row .= '"'.$user['policy_holder_info'].'",';
            $row .= '"'.$user['sales_order'].'",';
            $row .= '"'.$user['delete_scheduled'].'",';
		    $row .= '"'.$user['branch_office'].'",';
            $row .= '"'.$user['order_reference'].'",';
            $row .= '"'.$user['wip_state'].'",';
            $row .= '"'.$user['eeg_length'].'",';
            $row .= '"'.$user['order_entry'].'",';
            $row .= '"'.$user['work_fax'].'",';
            $row .= '"'.$user['eeg_today'].'",';
            $row .= '"'.$user['missing_info'].'",';
            $row .= '"'.$user['attachment'].'",';
            $row .= '"'.$user['hippa'].'",';
            $row .= '"'.$user['duplicate_order'].'",';
            $row .= '"'.$user['fax_file'].'",';
            $row .= '"'.$user['major_errors'].'",';
            $row .= '"'.$user['account_properly'].'",';
            $row .= '"'.$user['ordered_items'].'",';
            $row .= '"'.$user['market_represent'].'",';
            $row .= '"'.$user['doctor_office'].'",';
			$row .= '"'.$user['cmt1'].'",';
			$row .= '"'.$user['cmt2'].'",';
			$row .= '"'.$user['cmt3'].'",';
			$row .= '"'.$user['cmt4'].'",';
			$row .= '"'.$user['cmt5'].'",';
			$row .= '"'.$user['cmt6'].'",';
			$row .= '"'.$user['cmt7'].'",';
			$row .= '"'.$user['cmt8'].'",';
			$row .= '"'.$user['cmt9'].'",';
			$row .= '"'.$user['cmt10'].'",';
			$row .= '"'.$user['cmt11'].'",';
			$row .= '"'.$user['cmt12'].'",';
			$row .= '"'.$user['cmt13'].'",';
			$row .= '"'.$user['cmt14'].'",';
			$row .= '"'.$user['cmt15'].'",';
			$row .= '"'.$user['cmt16'].'",';
			$row .= '"'.$user['cmt17'].'",';
			$row .= '"'.$user['cmt18'].'",';
			$row .= '"'.$user['cmt19'].'",';
			$row .= '"'.$user['cmt20'].'",';
			$row .= '"'.$user['cmt21'].'",';
			$row .= '"'.$user['cmt22'].'",';
			$row .= '"'.$user['cmt23'].'",';
			$row .= '"'.$user['cmt24'].'",';
			$row .= '"'.$user['cmt25'].'",';
			$row .= '"'.$user['cmt26'].'",';
			$row .= '"'.$user['cmt27'].'",';
			$row .= '"'.$user['cmt28'].'",';
			$row .= '"'.$user['cmt29'].'",';
			$row .= '"'.$user['cmt30'].'",';
			$row .= '"'.$user['cmt31'].'",';
			$row .= '"'.$user['cmt32'].'",';
			$row .= '"'.$user['cmt33'].'",';
			$row .= '"'.$user['cmt34'].'",';
			$row .= '"'.$user['cmt35'].'",';
			$row .= '"'.$user['cmt36'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}


	public function download_chariot_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_chariot_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		    if($campaign=='chariot'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super","Contact Date","Account Number","Contact Duration","Audit Type", "Auditor Type", "Voc","Overall Score","Identify himself/herself by first and last name at the beginning of the call?","Provide the Quality Assurance Statement verbatim before any specific account information was discussed?","Provide the Quality Assurance Statement verbatim before any specific account information was discussed?","State Chariot Energy with no deviation?","Verify that he/she was speaking to a right party (First and Last Name) and before providing the disclosures?","Verify one/two pieces of demographics information for both Outbound and Inbound call? 1) must abide by client requirements 2) Consumer must provide information unless there is a resistance. 3)Must be completed before disclosures 4) Exception on consumer fail to verify two pieces of demographics information/fail to verify complete address (missing street number etc)","Provide the Mini Miranda disclosure verbatim before any specific account information was discussed?","State the balance due and the purpose of the communication?","Ask for a reason for delinquency/intention to resolve the account?","Provide all account related information to the Consumer?","Ask appropriate close ended question to know why the Consumer is unable to pay the bill? ","Ask for the payment over the phone?","Ask for a post dated payment (except for the states MA or RI)?","Able to take a promise to pay on the account by confirming the payment amount and date of payment?","Ask the Consumer to pay full balance due on account","Offer a payment plan with significant down payment?","Did Collector follow proper negotiation sequence to provide settelment options?","Did Collector try to negotiate effectively to convince the Consumer for payment by explaining the advantage of paying the bill?","Offer a small good faith payment?","Did not  Misrepresent their identity or authorization and status of the consumers account as well as make any false representation regarding nature of the communication?","Did not Discuss or imply that any type of legal actions - will be taken or property repossessedas well as Did not threaten to take actions that the client cannot legally take?","Did not Contact the consumer at any unusual times (sate regulations) or outside the hours of 8:00 am and 9:00 pm at the consumers location?","Did not Communicate with the consumer at work if it is known or there is reason to know that such calls are prohibited?","Did not Communicate with the consumer after learning the consumer is represented by an attorney filed for bankruptcy unless a permissible reason exists?","Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers via cell phone email and fax?","Adhere to policy regarding third parties for the sole purpose of obtaining location information for the consumer?","Enter Status code/disposition codes correctly to ensure that inappropriate dialing does not take place?","Did not Make any statement that could constitute unfair deceptive or abusive acts or practices that may raise UDAAP concerns?","Did not Communicate or threaten to communicate false credit information or information which should be known to be false and utilized the proper CBR script whenever a consumer enquires about that?","Handle the consumers dispute correctly and take appropriate action including providing the consumer with the correct contact information to submit a written dispute or complaint or offer to escalate the call?","Did not Make the required statement on time barred accounts indicating that the consumer cannot be pursued with legal action?","Adhere to FDCPA  laws?","Did not Make any statement that could be considered discriminatory towards a consumer?","Did the collectors adhere to the State Restrictions?","Confirm with consumer if he/she is the authorized user of the debit or credit card / checking account","Recap the call by verifying consumers Name Address CC/AP information?","Stated the proper payment script before processing payment?","Advise of the payment processing fee before the payment was taken and take appropriate steps if the consumer pushed back?","Obtain permission from the consumer to initiate electronic credit /debit card transactions or through checking account and get supervisor verification if needed?","Educate the consumer about correspondence being sent (Receipts PIF SIF Confirmations etc)?","Provide the consumer with the confirmation code?","Demonstrate Active Listening?","Represent the company and the client in a positive manner?","Anticipate and overcome objections?","Summarize the call","Provided the call back number?","Set appropriate timelines and expectations for follow up which includes verifying best contact number and call back time for Consumer?","Close the call Professionally?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		        }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		    if($campaign=='chariot'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
                $row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['account_number'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['identifyhimselforher'].'",';
				$row .= '"'.$user['identifyhimselforher'].'",';
				$row .= '"'.$user['providetheQuality'].'",';
				$row .= '"'.$user['stateChariot'].'",';
				$row .= '"'.$user['verifythatheor'].'",';
				$row .= '"'.$user['verifyOneTwo'].'",';
				$row .= '"'.$user['providethe'].'",';
				$row .= '"'.$user['stateTheBalance'].'",';
				$row .= '"'.$user['askforareaso'].'",';
				$row .= '"'.$user['providea'].'",';
				$row .= '"'.$user['askappropriat'].'",';
				$row .= '"'.$user['askforthepaymentovertheph'].'",';
				$row .= '"'.$user['askforapo'].'",';
				$row .= '"'.$user['abletotakeapromise'].'",';
				$row .= '"'.$user['askTheCustomer'].'",';
				$row .= '"'.$user['OfferaPayment'].'",';
				$row .= '"'.$user['didtheagentprop'].'",';
				$row .= '"'.$user['didtheagentprope'].'",';
				$row .= '"'.$user['didCollectorfollowprope'].'",';
				$row .= '"'.$user['didCollectortry'].'",';
				$row .= '"'.$user['didnotMisrepresent'].'",';
				$row .= '"'.$user['notDiscussorimply'].'",';
				$row .= '"'.$user['didnotContacttheconsumer'].'",';
				$row .= '"'.$user['didnotCommunicatewiththeconsumer'].'",';
				$row .= '"'.$user['didnotCommunicatewiththeconsumerafter'].'",';
				$row .= '"'.$user['adheretothecellphone'].'",';
				$row .= '"'.$user['adheretopolicyregardingthirdparties'].'",';
				$row .= '"'.$user['enterStatuscodeordisposition'].'",';
				$row .= '"'.$user['didnotMakeany'].'",';
				$row .= '"'.$user['didnotCommunicateor'].'",';
				$row .= '"'.$user['handletheconsum'].'",';
				$row .= '"'.$user['didnotMak'].'",';
				$row .= '"'.$user['didnotMakeanystatementthatcoul'].'",';
				$row .= '"'.$user['collectorsadheretotheState'].'",';
				$row .= '"'.$user['confirmwithconsumer'].'",';
				$row .= '"'.$user['recapthecallby'].'",';
				$row .= '"'.$user['statedth'].'",';
				$row .= '"'.$user['adviseofthe'].'",';
				$row .= '"'.$user['obtainpermissionfromtheconsumer'].'",';
				$row .= '"'.$user['educatetheconsumer'].'",';
				$row .= '"'.$user['consumerwiththeconfirmationcode'].'",';
				$row .= '"'.$user['demonstrateActiveLis'].'",';
				$row .= '"'.$user['represen'].'",';
				$row .= '"'.$user['anticipateandovercomeobjecti'].'",';
				$row .= '"'.$user['summarize'].'",';
				$row .= '"'.$user['providedthecallbackn'].'",';
				$row .= '"'.$user['appropriatetimelines'].'",';
				$row .= '"'.$user['closethecallProfess'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		  }

       }




////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////// KIWI ////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////
	public function qa_kiwi_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_kiwi_new_report.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			$data["qa_kiwi_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}
				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}

				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_kiwi_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin $user) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				//print_r($fullAray);
				$data["qa_kiwi_list"] = $fullAray;
				$this->create_qa_kiwi_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_kiwi_CSV";

			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_kiwi_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA KIWI Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_kiwi_CSV($rr)
	{
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		$header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Super", "Call Date/Time","Email","Case Number", "Quality score","compliance","Call Summary","Feedback","Bucket", "Agent Review Date", "Agent Feedback Acceptance","Agent Comment", "Mgnt Review Date", "Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			$row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['email_id'].'",';
			$row .= '"'.$user['case_number'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';

			$row .= '"'.$user['compliance'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['bucket'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}

		fclose($fopen);
	}

////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////// Cars24 ////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
    public function qa_cars24_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_cars24_report.php";
			$data["content_js"] = "qa_clio_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";
			$campaign = $this->input->get('campaign');
			$data["qa_pre_list"] = array();

			if($this->input->get('show')=='Show')
			{

				    $from_date = mmddyy2mysql($this->input->get('date_from'));
					$to_date = mmddyy2mysql($this->input->get('date_to'));
					$office_id = $this->input->get('office_id');
					$lob = $this->input->get('lob');

					if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
						$ops_cond="";
					}else{
						if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
							$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
						}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
							$ops_cond=" Where assigned_to='$current_user'";
						}else{
							$ops_cond="";
						}
					}

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_cars24_".$campaign."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $ops_cond order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_pre_list"] = $fullAray;
				$this->create_qa_pre_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_pre_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $from_date;
			$data['date_to'] = $to_date;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_qa_pre_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_pre_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=='pre_booking'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Actual Tagging","Agent Tagging","Campaign","Call Duration","Agent Tenure","Customer Contact Number","Audit Type", "Auditor Type", "Voc","Standardization","Sales Pitch/Resolution","Tagging","Communication","Critical Parameters","Overall Score","Opening done within 5 Secs as per the defined skill","Self Introduction/Company Name","Customer Identification","Purpose of the call", "Hold/Un-Hold Script followed","Dead Air","Call Summarization for Interested Customers","Further assistance","Closing Script","Probing On Car selection","Probing Customer refusal reason","Probing Customer refusal relevant alternatives (If Required)","Probing- Others","All customer queries addressed effectively","Effective Rebuttals and objection handling used to encourage the customer to confirm the booking","Comprehensive Warranty & CARS24 Quality Standards covered","7 day trial & Hassle-free RC transfer","CARS 24 Consumer Finance & Benefits","Car Details- Make/Model confirmed","Payment Type confirmation","Loan details capturing & offer sharing(If any)","Loan documents information & link triggering (If applicable)","Delivery Type Date & Location confirmation (Hub-Pick Up/ Home Delivery)","Shipping Charges & RTO Charges Information (If Applicable)","Booking and final payment amount confirmation","RC Transfer documents information","Customer Email-ID confirmation","Whats app Opt-in pitching (where required)","Correct Dispostion captured","Correct Remarks captured","Voice Modulation","Language switching as per the requirement","Interruption","Rate of Speech","Voice Clarity","MTI/ RTI /Pronuncation","Grammatical errors","Unprofessional Tone","Attentiveness","Forcefull Booking","Incorrect Information/Misleading information","Rude behaviour Profanity offensive /Abusive","Call Disconnection","Opening Comment 1","Opening Comment 2","Opening Comment 3","Opening Comment 4","Hold/On-Hold comment 1","Hold/On-Hold Comment 2","Closing Comment 1","Closing Comment 2","Closing Comment 3","Relevant probing done to understand the customer needs and concern Comment 1","Relevant probing done to understand the customer needs and concern Comment 2","Relevant probing done to understand the customer needs and concern Comment 3","Relevant probing done to understand the customer needs and concern Comment 4","Effective addressal of customer queries Comment 1","Effective Rebuttals Comment 1","USPs & Process Information Comment 1","USPs & Process Information Comment 2","USPs & Process Information Comment 3","Booking & Consumer finance Process Comment 1","Booking & Consumer finance Process Comment 2","Booking & Consumer finance Process Comment 3","Booking & Consumer finance Process Comment 4","Booking & Consumer finance Process Comment 5","Booking & Consumer finance Process Comment 6","Booking & Consumer finance Process Comment 7","Booking & Consumer finance Process Comment 8","Booking & Consumer finance Process Comment 9","Booking & Consumer finance Process Comment 10","Disposition/Remarks comment 1","Disposition/Remarks comment 2","Soft Skills Comment 1","Soft Skills Comment 2","Soft Skills Comment 3","Soft Skills Comment 4","Soft Skills Comment 5","Soft Skills Comment 6","Soft Skills Comment 7","Soft Skills Comment 8","Soft Skills Comment 9","Critical Error Comment 1","Critical Error Comment 2","ZTP Comment 1","ZTP Comment 2","Call Summary", "Feedback","Probability of Booking basis the call","Factors that could impact Booking","Reasons for impact on Booking (ACPT)","Reasons for impact on Booking (WHY 1)","Reasons for impact on Booking (WHY 2)", "Overall feel of the call basis Sales Pitch","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='pre_booking_new'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super","Call Date","Actual Tagging","Agent Tagging","Campaign","Call Duration","Agent Tenure","Customer Contact Number","Audit Type", "Auditor Type", "Voc","Overall Score", "Audit Start Time", "Audit End Time", "Interval(in sec)",
			"Did the advisor open the call correctly?","Reason for No","Remarks", "Did the advisor follow the customer identification process?","Reason for No","Remarks", "Did the advisor share the purpose of the call with the customer?","Remarks", "Did the advisor ask appropriate fact-finding questions/do probing for the car booking?","Reason for No","Remarks", "Did the advisor use effective rebuttals/sales and objection handling to encourage the customer to confirm the booking?","Remarks", "Did the advisor answer all customer queries effectively/ understanding the customers concern/ comprehending well?","Reason for No","Remarks", "Did the advisor inform Comprehensive Warranty & CARS24 Quality Standards /7 day trial & Hassle-free RC transfer/CARS24 Consumer Finance & Benefits?","Reason for No","Remarks", "Did the advisor inform Car Details- Make/Model confirmed /Delivery Type Date & Location confirmation","Reason for No","Remarks", "Did the advisor inform RC Transfer documents & RTO Charges Information (If Applicable)?","rc ransfer documents no reason","cmt9","Did the advisor confirm/capture the customers Email-id confirmation/Whatsapp Opt-in pitching","Reason for No","Remarks", "Did the advisor share the Order link/Car link?","Reason for No","Remarks", "Did the advisor inform about the booking and final payment amount?","Reason for No","Remarks", "Did the advisor convince the customer to try to book a car on call?","Remarks", "Did the advisor share a pre-approved offer/ capture loan details?","Reason for No","Remarks", "Did the advisor inform about the loan documents and share the bank statement link?","Reason for No","Remarks", "Did the advisor inform you about the payment type?","Reason for No","Remarks", "Did the advisor speak clearly and concisely maintain appropriate ROS?","Reason for No","Remarks", "Did you observe any regional influence and was the advisor able to construct the sentences appropriately to ensure better customer understanding?","Reason for No","Remarks", "Did the advisor sound energetic confident and intonate well?","Reason for No","Remarks", "Did the advisor actively listen to the customer throughout the call avoid interruption avoid repeating himself/herself during the call and appropriately","Reason for No","Remarks", "Did the advisor avoid the usage of fillers and Jargon?","Reason for No","Remarks", "Did the advisor follow the correct Hold /Transfer Procedure Use Mute and avoid dead air during the call?","Reason for No","Remarks", "Did the advisor personalize over the call use pleasantries words and statements/adjust the conversation as per the customers requirements/circumstances in","Reason for No","Remarks", "Did the advisor use Service No techniques?","Remarks", "Did the advisor empathise/apologise to the customer wherever required?","Reason for No","Remarks", "Was the advisor professional on the call?","Reason for No","Remarks", "Did the advisor summarize/further assistance/close the call appropriately with CSAT link?","Reason for No","Remarks", "Did the advisor use the correct disposition/update all notes and details correctly on the call?","Reason for No","Remarks", "Did the advisor provide all accurate information and not mislead the customer provide incorrect information or make any false promises?","Reason for No","Remarks", "Did not find any non-adherence to wrong practices","Reason for No","Remarks", "Did the Advisor provide Customer Experience beyond expectation?","Reason for No","Remarks",
			"Opening script followed as per new Guidelines","Remarks", "Effective Objection handling was there or not- as per new guidelines","Remarks", "Different Car suggested or not","Remarks", "Booking probability as per QA","Remarks", "Did the call was having two way conversation?","Remarks", "Did the advisor followed replaced words or scripts?","Remarks", "Did the advisor followed the car finding flow process?","Remarks",
			"Advisor related observations / challenges noticed on call","other observations challenges","suggestion observations challenges", "Customer related observations / challenges noticed on call","other customer observations","suggestion customer observations", "Technical related observations / challenges noticed on call","other technical observations","suggestion technical observations", "Process related observations / challenges noticed on call","other process observations","suggestion process observations",
			"Call Summary", "Feedback","Probability of Booking basis the call","Factors that could impact Booking","Reasons for impact on Booking (WHY 1)","Reasons for impact on Booking (WHY 2)", "Overall feel of the call basis Sales Pitch","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		    }else if($campaign=='cars_pre_booking_new'){
				$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super","Call Date","Campaign","Call Duration","Agent Tenure","Customer Contact Number","Audit Type", "Auditor Type", "Voc","Overall Score","Auditor Role","AON","Disposition","Month","Sub Disposition","Language","Critical Transaction Flag","Overall Defects","Parameter Weighted Accuracy","Parameter Overall Result","Sub Parameter Overall Result","Sub Parameter Opportunities Process Parameters","Sub Parameter Opportunities Customer Parameters","Sub Parameter Defects Process Parameters","Sub Parameter Defects Customer Parameters","Sub Parameter Accuracy Process Parameters","Sub Parameter Accuracy Customer Parameters", "Audit Start Time", "Audit End Time", "Interval(in sec)",
				"Parameter Rating1","Parameter Rating2","Parameter Rating3","Parameter Rating4","Parameter Rating5","Parameter Rating6","Parameter Rating7","Parameter Rating8","Parameter Rating9",
				"Opening guideline was followed correctly", "Purpose of the call was shared as per lead type", "Context was set before asking for any information from the customer", "Customer's requirement was correctly understood relevant probing was done", "Appropriate options/ solutions were shared after understanding the customer needs","Relevant USPs/ rebuttals/offers were effectively used to handle customer objections", "Financing option was pitched in case of budget issue/ Loan USPs explained wherever required", "Loan eligibility was checked for the customer and pre-approved offer was shared/ EMI calculator was used wherever applicable", "In case of non-servicability or customer ineligible for loan alternative options were shared"," Information about the loan documents and the bank statement link was shared wherever applicable","Car details along with key highlights of the car were shared", "All the required details for for the test drive were confirmed ", "Effort was put for booking the test drive on the call itself", "There was rapport Rate of speech was appropriate energy and confidence friendly/polite tone and personalization on the call", "There was active listening and acknowledgement on the call- no interruption no unnecessary repetition no dead air", "Clear and concise communication- Sentences were appropriately constructed with the right grammar jargon/internal references/archaic Hindi terms were avoided", "The correct disposition and tags were selected", "Closing guideline was followed correctly", "No Incomplete or misleading information provided/Forceful/false booking was done on call", "ZTP", "Did the Advisor provide Customer Experience beyond expectation ?", "Advisor related observations / challenges noticed on call", "Customer related observations / challenges noticed on call", "Technical related observations / challenges noticed on call", "Process related observations / challenges noticed on call", "Different Car suggested and pitched properly", "Car Finding Process flow", "Order link shared", "Pitched for visit effectively", "Pitched paid where ever required",



				"Opening guideline was followed correctly Reason", "Purpose of the call was shared as per lead type Reason", "Context was set before asking for any information from the customer Reason", "Customer's requirement was correctly understood relevant probing was done Reason", "Appropriate options/ solutions were shared after understanding the customer needs Reason","Relevant USPs/ rebuttals/offers were effectively used to handle customer objections Reason", "Financing option was pitched in case of budget issue/ Loan USPs explained wherever required Reason", "Loan eligibility was checked for the customer and pre-approved offer was shared/ EMI calculator was used wherever applicable Reason", "In case of non-servicability or customer ineligible for loan alternative options were shared Reason"," Information about the loan documents and the bank statement link was shared wherever applicable Reason","Car details along with key highlights of the car were shared Reason", "All the required details for for the test drive were confirmed Reason", "Effort was put for booking the test drive on the call itself Reason", "There was rapport Rate of speech was appropriate energy and confidence friendly/polite tone and personalization on the call Reason", "There was active listening and acknowledgement on the call- no interruption no unnecessary repetition no dead air Reason", "Clear and concise communication- Sentences were appropriately constructed with the right grammar jargon/internal references/archaic Hindi terms were avoided Reason", "The correct disposition and tags were selected Reason", "Closing guideline was followed correctly Reason", "No Incomplete or misleading information provided/Forceful/false booking was done on call Reason", "ZTP Reason", "Did the Advisor provide Customer Experience beyond expectation ? Reason", "Advisor related observations / challenges noticed on call Reason", "Customer related observations / challenges noticed on call Reason", "Technical related observations / challenges noticed on call Reason", "Process related observations / challenges noticed on call Reason", "Different Car suggested and pitched properly Reason", "Car Finding Process flow Reason", "Order link shared Reason", "Pitched for visit effectively Reason", "Pitched paid where ever required Reason",


				"Opening guideline was followed correctly Remarks", "Purpose of the call was shared as per lead type Remarks", "Context was set before asking for any information from the customer Remarks", "Customer's requirement was correctly understood relevant probing was done Remarks", "Appropriate options/ solutions were shared after understanding the customer needs Remarks","Relevant USPs/ rebuttals/offers were effectively used to handle customer objections Remarks", "Financing option was pitched in case of budget issue/ Loan USPs explained wherever required Remarks", "Loan eligibility was checked for the customer and pre-approved offer was shared/ EMI calculator was used wherever applicable Remarks", "In case of non-servicability or customer ineligible for loan alternative options were shared Remarks"," Information about the loan documents and the bank statement link was shared wherever applicable Remarks","Car details along with key highlights of the car were shared Remarks", "All the required details for for the test drive were confirmed Remarks", "Effort was put for booking the test drive on the call itself Remarks", "There was rapport Rate of speech was appropriate energy and confidence friendly/polite tone and personalization on the call Remarks", "There was active listening and acknowledgement on the call- no interruption no unnecessary repetition no dead air Remarks", "Clear and concise communication- Sentences were appropriately constructed with the right grammar jargon/internal references/archaic Hindi terms were avoided Remarks", "The correct disposition and tags were selected Remarks", "Closing guideline was followed correctly Remarks", "No Incomplete or misleading information provided/Forceful/false booking was done on call Remarks", "ZTP Remarks", "Did the Advisor provide Customer Experience beyond expectation ? Remarks", "Advisor related observations / challenges noticed on call Remarks", "Customer related observations / challenges noticed on call Remarks", "Technical related observations / challenges noticed on call Remarks", "Process related observations / challenges noticed on call Remarks", "Different Car suggested and pitched properly Remarks", "Car Finding Process flow Remarks", "Order link shared Remarks", "Pitched for visit effectively Remarks", "Pitched paid where ever required Remarks",

					// "Subparameter Rating1","Subparameter Rating2","Subparameter Rating3","Subparameter Rating4","Subparameter Rating5","Subparameter Rating6","Subparameter Rating7","Subparameter Rating8","Subparameter Rating9","Subparameter Rating10","Subparameter Rating11","Subparameter Rating12","Subparameter Rating13","Subparameter Rating14","Subparameter Rating15","Subparameter Rating16","Subparameter Rating17","Subparameter Rating18","Subparameter Rating19","Subparameter Rating20","Subparameter Rating21","Subparameter Rating22","Subparameter Rating23","Subparameter Rating24","Subparameter Rating25","Subparameter Rating26","Subparameter Rating27","Subparameter Rating28","Subparameter Rating29","Subparameter Rating30",

					// "Reason1","Reason2","Reason3","Reason4","Reason5","Reason6","Reason7","Reason8","Reason9","Reason10","Reason11","Reason12","Reason13","Reason14","Reason15","Reason16","Reason17","Reason18","Reason19","Reason20","Reason21","Reason22","Reason23","Reason24","Reason25","Reason26","Reason27","Reason28","Reason29","Reason30",
					// "Remarks1","Remarks2","Remarks3","Remarks4","Remarks5","Remarks6","Remarks7","Remarks8","Remarks9","Remarks10","Remarks11","Remarks12","Remarks13","Remarks14","Remarks15","Remarks16","Reason17","Remarks18","Remarks19","Remarks20","Remarks21","Remarks22","Remarks23","Remarks24","Remarks25","Remarks26","Remarks27","Remarks28","Remarks29","Remarks30",

				"Call Summary", "Feedback","Probability of Booking basis the call","Factors that could impact Booking","AOI","Sub AOI","Reasons for impact on Booking (WHY 1)","Reasons for impact on Booking (WHY 2)", "Overall feel of the call basis Sales Pitch","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
				}else if($campaign=='live_snooping'){
				$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super","Call Date","Actual Tagging","Agent Tagging","Campaign","Call Duration","Agent Tenure","Customer Contact Number","Audit Type", "Auditor Type", "Voc","Overall Score", "Audit Start Time", "Audit End Time", "Interval(in sec)",

					"Opening & Identification","Reason","Remark","Customer assessment","Reason","Remark","Solution & Objection handling","Reason","Remark","Loan Process","Reason","Remark","Test drive booking process","Reason","Remark","Rapport Building & Conversation","Reason","Remark","Disposition","Reason","Remark","Closing","Reason","Remark","Wrong or misleading information","Reason","Remark",

				"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
				}else if($campaign=='post_booking'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Associate Name","Team Leader","Campaign","Call Duration","Actual Disposition","Agent Tenure","Customer Contact Number","Evaluator Name","Audit Type", "Auditor Type", "Voc","Standardization Rating","Standardization Scores","Standardization CQ Score","Product Rating","Product Scores","Product CQ Score","Communication Rating","Communication Scores","Communication CQ Score","Critical Rating","Critical Scores","Critical CQ Score","Fatal Rating","Fatal Scores","Fatal CQ Score","Language","Overall Score", "Possible Score", "Earned Score","Opening done in 5 Sec in English/ Regional Language","Greeting/ Self introduction/ Company Introduction/ Customer identification/Purpose of the call","Hold/On-Hold Procedure followed on call","No Dead Air","Call Summarization was done on the call","Associate asked for further assistance & closed the call properly","Relevant probing done to understand the customer needs and concern","All customer queries addressed effectively","Effective rebuttals and objection handling used to encourage the customer to confirm the Test Drive/ Helped in booking another car- If cancelled","Comprehensive Warranty & CARS24 Quality Standards covered","7 day trial & Hassle-free RC transfer covered","Consumer Financing & Benefits covered- If Required","Car Details- Make/Model confirmed", "Payment type confirmed & Loan offer pitched If - Pay On Delivery Scenario","Customer Eligibility Checked & link triggered for bank statement (if applicable)","Delivery Type Date & Location confirmed /Captured (Hub-Pick Up/ Home Delivery)","Final payment amount confirmed","RC Transfer documents informed","Customer Email-ID confirmed","Correct Dispostion and remarks captured","Whatsapp Opt-in pitched on call & consent taken If Applicable","First Call Resolution Provided to the customer","Customer concern raised on Zendesk- If Required","Correct Details & Remarks Captured against ticket","No Duplicate ticket created on Zendesk- If already available","Associate Personalized on call","Language switched as per customer ease","No interruption on call","Tone was appropriate throughout the call","Voice clarity and appropriate rate of speech","MTI/ RTI Error on call","Accurate sentence construction without any grammatical errors","No Pronunciation error","Active Listening and comprehension","Acknowledgement of customer inputs","Available tools used to help the customer (CRM/ Zendesk/ Knowledgebank etc)","Incorrect or Misleading information","No Rude behaviour Profanity offensive or Abusive remark or language found","No Disconnection found during the call","Call Summary", "Feedback","AOI (Area of improvement)","Process & Product Observations (If any)","Compliance (Special case study)","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='post_delivery'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Associate Name","Team Leader","Campaign","Call Duration","Actual Disposition","Agent Tenure","Customer Contact Number","Evaluator Name","Audit Type", "Auditor Type", "Voc","Disposition","Sub Disposition","Standardization Rating","Standardization Scores","Standardization CQ Score","Product Rating","Product Scores","Product CQ Score","Communication Rating","Communication Scores","Communication CQ Score","Critical Rating","Critical Scores","Critical CQ Score","Fatal Rating","Fatal Scores","Fatal CQ Score","Language","Overall Score", "Possible Score", "Earned Score","Opening done in 5 Sec in English/ Regional Language","Greeting/ Self introduction/ Company Introduction/ Customer identification/Purpose of the call","Hold/On-Hold Procedure followed on call","No Dead Air","Call Summarization was done on the call","Associate asked for further assistance & closed the call properly","Associate able to understand/identify the customer concern clearly","Relevant probing done to understand the customer needs and concern","All customer queries addressed effectively/ Effective rebuttals and objection handling used","Correct TAT informed (wherever applicable)","Warranty/Invoice/ RC-Receipt etc shared with customer(Wherever Applicable)","First Call Resolution Provided to the customer","Customer concern raised on Zendesk- If Required","Correct Details & Remarks Captured against ticket","No Duplicate ticket created on Zendesk- If already available","Correct Dispostion and remarks captured","Customer Email-ID confirmed/Captured","Associate Personalized on call","Language switched as per customer ease","No interruption on call","Showed Empathy/Apologized (Wherever required)","Tone was appropriate throughout the call","Voice clarity and appropriate rate of speech","MTI/ RTI Error on call","Accurate sentence construction without any grammatical errors","No Pronunciation error","Active Listening and comprehension","Acknowledgement of customer inputs","Available tools used to help the customer (CRM/ Zendesk/ Knowledgebank etc)","Incorrect or Misleading information","No Rude behaviour Profanity offensive or Abusive remark or language found","No Disconnection found during the call","Call Summary", "Feedback","AOI (Area of improvement)","Process & Product Observations (If any)","Compliance (Special case study)","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='pre_booking'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['actual_tagging'].'",';
				$row .= '"'.$user['agent_tagging'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['agen_tenure'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['standardization'].'",';
				$row .= '"'.$user['sales_pitch'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['communication'].'",';
				$row .= '"'.$user['critical_overallScore'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['opening_done_within'].'",';
				$row .= '"'.$user['self_ntroduction'].'",';
				$row .= '"'.$user['customer_identification'].'",';
				$row .= '"'.$user['purpose_of_the_call'].'",';
				$row .= '"'.$user['script_followed'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['call_summarization'].'",';
				$row .= '"'.$user['further_assistance'].'",';
				$row .= '"'.$user['closing_script'].'",';
				$row .= '"'.$user['on_car_selection'].'",';
				$row .= '"'.$user['customer_refusal_reason'].'",';
				$row .= '"'.$user['customer_refusal_relevant'].'",';
				$row .= '"'.$user['probing_others'].'",';
				$row .= '"'.$user['all_customer_queries'].'",';
				$row .= '"'.$user['effective_rebuttals'].'",';
				$row .= '"'.$user['comprehensive_warranty'].'",';
				$row .= '"'.$user['day_trial_hassle'].'",';
				$row .= '"'.$user['consumer_finance'].'",';
				$row .= '"'.$user['car_details_make'].'",';
				$row .= '"'.$user['payment_type_confirmation'].'",';
				$row .= '"'.$user['loan_details_capturing'].'",';
				$row .= '"'.$user['loan_documents_information'].'",';
				$row .= '"'.$user['delivery_type'].'",';
				$row .= '"'.$user['shipping_charges'].'",';
				$row .= '"'.$user['booking_and_final'].'",';
				$row .= '"'.$user['rc_ransfer_documents'].'",';
				$row .= '"'.$user['customer_email_id'].'",';
				$row .= '"'.$user['whats_app_opt'].'",';
				$row .= '"'.$user['correct_dispostion'].'",';
				$row .= '"'.$user['correct_remarks'].'",';
				$row .= '"'.$user['voice_modulation'].'",';
				$row .= '"'.$user['language_switching'].'",';
				$row .= '"'.$user['interruption'].'",';
				$row .= '"'.$user['rate_of_speech'].'",';
				$row .= '"'.$user['voice_clarity'].'",';
				$row .= '"'.$user['pronuncation'].'",';
				$row .= '"'.$user['grammatical_errors'].'",';
				$row .= '"'.$user['unprofessional'].'",';
				$row .= '"'.$user['attentiveness'].'",';
				$row .= '"'.$user['forcefull_booking'].'",';
				$row .= '"'.$user['incorrect_information'].'",';
				$row .= '"'.$user['rude_behaviour'].'",';
				$row .= '"'.$user['call_disconnection'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'.$user['cmt22'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['cmt24'].'",';
				$row .= '"'.$user['cmt25'].'",';
				$row .= '"'.$user['cmt26'].'",';
				$row .= '"'.$user['cmt27'].'",';
				$row .= '"'.$user['cmt28'].'",';
				$row .= '"'.$user['cmt29'].'",';
				$row .= '"'.$user['cmt30'].'",';
				$row .= '"'.$user['cmt31'].'",';
				$row .= '"'.$user['cmt32'].'",';
				$row .= '"'.$user['cmt33'].'",';
				$row .= '"'.$user['cmt34'].'",';
				$row .= '"'.$user['cmt35'].'",';
				$row .= '"'.$user['cmt36'].'",';
				$row .= '"'.$user['cmt37'].'",';
				$row .= '"'.$user['cmt38'].'",';
				$row .= '"'.$user['cmt39'].'",';
				$row .= '"'.$user['cmt40'].'",';
				$row .= '"'.$user['cmt41'].'",';
				$row .= '"'.$user['cmt42'].'",';
				$row .= '"'.$user['cmt43'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['probability_of'].'",';
				$row .= '"'.$user['factors_that_could'].'",';
				$row .= '"'.$user['reasons_for_impact'].'",';
				$row .= '"'.$user['reasons_for_why1'].'",';
				$row .= '"'.$user['reasons_for_why2'].'",';
				$row .= '"'.$user['overall_feel_of_the'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='pre_booking_new'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['actual_tagging'].'",';
				$row .= '"'.$user['agent_tagging'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['agen_tenure'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';

				$row .= '"'.$user['opening_done_within'].'",';
				$row .= '"'.$user['opening_done_within_no_reason'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['self_introduction'].'",';
				$row .= '"'.$user['self_introduction_no_reason'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['customer_identification'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['purpose_of_the_call'].'",';
				$row .= '"'.$user['purpose_of_the_call_no_reason'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['effective_rebuttals'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['customer_concern'].'",';
				$row .= '"'.$user['customer_concern_no_reason'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['comprehensive_warranty'].'",';
				$row .= '"'.$user['comprehensive_warranty_no_reason'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['delivery_type'].'",';
				$row .= '"'.$user['delivery_type_no_reason'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['rc_ransfer_documents'].'",';
				$row .= '"'.$user['rc_ransfer_documents_no_reason'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['whats_app_opt'].'",';
				$row .= '"'.$user['whats_app_opt_no_reason'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['car_details_link'].'",';
				$row .= '"'.$user['car_details_link_no_reason'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['payment_type_confirmation'].'",';
				$row .= '"'.$user['payment_type_confirmation_no_reason'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['consumer_convince_finance'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['loan_details_capturing'].'",';
				$row .= '"'.$user['loan_details_capturing_no_reason'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['loan_documents_information'].'",';
				$row .= '"'.$user['loan_documents_information_no_reason'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['payment_type_inform'].'",';
				$row .= '"'.$user['payment_type_inform_no_reason'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['voice_clarity'].'",';
				$row .= '"'.$user['voice_clarity_no_reason'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['language_switching'].'",';
				$row .= '"'.$user['language_switching_no_reason'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['voice_modulation'].'",';
				$row .= '"'.$user['voice_modulation_no_reason'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['voice_repeating'].'",';
				$row .= '"'.$user['voice_repeating_no_reason'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['filter_jardon'].'",';
				$row .= '"'.$user['filter_jardon_no_reason'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'.$user['transfer_procedure'].'",';
				$row .= '"'.$user['transfer_procedure_no_reason'].'",';
				$row .= '"'.$user['cmt22'].'",';
				$row .= '"'.$user['personalize_call'].'",';
				$row .= '"'.$user['personalize_call_no_reason'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['service_no_tech'].'",';
				$row .= '"'.$user['cmt24'].'",';
				$row .= '"'.$user['empathise'].'",';
				$row .= '"'.$user['empathise_no_reason'].'",';
				$row .= '"'.$user['cmt25'].'",';
				$row .= '"'.$user['rude_behaviour'].'",';
				$row .= '"'.$user['rude_behaviour_no_reason'].'",';
				$row .= '"'.$user['cmt26'].'",';
				$row .= '"'.$user['csat_link'].'",';
				$row .= '"'.$user['csat_link_no_reason'].'",';
				$row .= '"'.$user['cmt27'].'",';
				$row .= '"'.$user['correct_dispostion'].'",';
				$row .= '"'.$user['correct_dispostion_no_reason'].'",';
				$row .= '"'.$user['cmt28'].'",';
				$row .= '"'.$user['incorrect_information'].'",';
				$row .= '"'.$user['incorrect_information_no_reason'].'",';
				$row .= '"'.$user['cmt29'].'",';
				$row .= '"'.$user['unprofessional'].'",';
				$row .= '"'.$user['unprofessional_no_reason'].'",';
				$row .= '"'.$user['cmt30'].'",';
				$row .= '"'.$user['customer_experience'].'",';
				$row .= '"'.$user['customer_experience_reason'].'",';
				$row .= '"'.$user['cmt31'].'",';
				$row .= '"'.$user['opening_script_follow'].'",';
				$row .= '"'.$user['cmt44'].'",';
				$row .= '"'.$user['effective_objection_handling'].'",';
				$row .= '"'.$user['cmt45'].'",';
				$row .= '"'.$user['different_car_suggest_or_not'].'",';
				$row .= '"'.$user['cmt46'].'",';
				$row .= '"'.$user['booking_probably_as_qa'].'",';
				$row .= '"'.$user['cmt47'].'",';
				$row .= '"'.$user['call_having_tow_way_conversion'].'",';
				$row .= '"'.$user['cmt48'].'",';
				$row .= '"'.$user['advisor_follow_replace_words'].'",';
				$row .= '"'.$user['cmt49'].'",';
				$row .= '"'.$user['advisor_follow_car_finding_process'].'",';
				$row .= '"'.$user['cmt50'].'",';
				$row .= '"'.$user['observations_challenges'].'",';
				$row .= '"'.$user['other_observations_challenges'].'",';
				$row .= '"'.$user['suggestion_observations_challenges'].'",';
				$row .= '"'.$user['customer_observations'].'",';
				$row .= '"'.$user['other_customer_observations'].'",';
				$row .= '"'.$user['suggestion_customer_observations'].'",';
				$row .= '"'.$user['technical_observations'].'",';
				$row .= '"'.$user['other_technical_observations'].'",';
				$row .= '"'.$user['suggestion_technical_observations'].'",';
				$row .= '"'.$user['process_observations'].'",';
				$row .= '"'.$user['other_process_observations'].'",';
				$row .= '"'.$user['suggestion_process_observations'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['probability_of'].'",';
				$row .= '"'.$user['factors_that_could'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reasons_for_why1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['reasons_for_why2'])).'",';
				$row .= '"'.$user['overall_feel_of_the'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		  }else if($campaign=='cars_pre_booking_new'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['agen_tenure'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['Auditor_Role'].'",';

				$row .= '"'.$user['AON'].'",';
				$row .= '"'.$user['Disposition1'].'",';
				$row .= '"'.$user['Month'].'",';
				// $row .= '"'.$user['Week'].'",';
				$row .= '"'.$user['Sub_Disposition'].'",';
				$row .= '"'.$user['Language'].'",';
				$row .= '"'.$user['Critical_Transaction'].'",';
				$row .= '"'.$user['Overall_Defects'].'",';
				$row .= '"'.$user['Parameter_Weighted'].'%'.'",';
				$row .= '"'.$user['parameter_overall_result'].'",';
				$row .= '"'.$user['Overall_Result'].'",';
				// $row .= '"'.$user['Critical_Errors'].'",';
				$row .= '"'.$user['Sub_Parameter_Opportunities_Process'].'",';
				$row .= '"'.$user['Sub_Parameter_Opportunities_Customer'].'",';
				$row .= '"'.$user['Sub_Parameter_Defects_Process'].'",';
				$row .= '"'.$user['Sub_Parameter_Defects_Customer'].'",';
				$row .= '"'.$user['Customer_Score'].'%'.'",';
				$row .= '"'.$user['Process_Score'].'%'.'",';
				$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
				$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
				$row .= '"'.$interval1.'",';

				$row .= '"'.$user['Rating1'].'",';
				$row .= '"'.$user['Rating2'].'",';
				$row .= '"'.$user['Rating3'].'",';
				$row .= '"'.$user['Rating4'].'",';
				$row .= '"'.$user['Rating5'].'",';
				$row .= '"'.$user['Rating6'].'",';
				$row .= '"'.$user['Rating7'].'",';
				$row .= '"'.$user['Rating8'].'",';
				$row .= '"'.$user['Rating9'].'",';

				$row .= '"'.$user['Ratings1'].'",';
				$row .= '"'.$user['Ratings2'].'",';
				$row .= '"'.$user['Ratings3'].'",';
				$row .= '"'.$user['Ratings4'].'",';
				$row .= '"'.$user['Ratings5'].'",';
				$row .= '"'.$user['Ratings6'].'",';
				$row .= '"'.$user['Ratings7'].'",';
				$row .= '"'.$user['Ratings8'].'",';
				$row .= '"'.$user['Ratings9'].'",';
				$row .= '"'.$user['Ratings10'].'",';
				$row .= '"'.$user['Ratings11'].'",';
				$row .= '"'.$user['Ratings12'].'",';
				$row .= '"'.$user['Ratings13'].'",';
				$row .= '"'.$user['Ratings14'].'",';
				$row .= '"'.$user['Ratings15'].'",';
				$row .= '"'.$user['Ratings16'].'",';
				$row .= '"'.$user['Ratings17'].'",';
				$row .= '"'.$user['Ratings18'].'",';
				$row .= '"'.$user['Ratings19'].'",';
				$row .= '"'.$user['Ratings20'].'",';
				$row .= '"'.$user['Ratings21'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['cmt26'].'",';
				$row .= '"'.$user['cmt29'].'",';
				$row .= '"'.$user['cmt32'].'",';
				$row .= '"'.$user['cmt35'].'",';
				$row .= '"'.$user['cmt38'].'",';
				$row .= '"'.$user['cmt41'].'",';
				$row .= '"'.$user['cmt44'].'",';
				$row .= '"'.$user['cmt47'].'",';




				$row .= '"'.$user['Reason1'].'",';
				$row .= '"'.$user['Reason2'].'",';
				$row .= '"'.$user['Reason3'].'",';
				$row .= '"'.$user['Reason4'].'",';
				$row .= '"'.$user['Reason5'].'",';
				$row .= '"'.$user['Reason6'].'",';
				$row .= '"'.$user['Reason7'].'",';
				$row .= '"'.$user['Reason8'].'",';
				$row .= '"'.$user['Reason9'].'",';
				$row .= '"'.$user['Reason10'].'",';
				$row .= '"'.$user['Reason11'].'",';
				$row .= '"'.$user['Reason12'].'",';
				$row .= '"'.$user['Reason13'].'",';
				$row .= '"'.$user['Reason14'].'",';
				$row .= '"'.$user['Reason15'].'",';
				$row .= '"'.$user['Reason16'].'",';
				$row .= '"'.$user['Reason17'].'",';
				$row .= '"'.$user['Reason18'].'",';
				$row .= '"'.$user['Reason19'].'",';
				$row .= '"'.$user['Reason20'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt27'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt30'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt33'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt36'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt39'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt42'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt45'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt48'])).'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt28'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt31'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt34'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt37'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt40'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt43'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt46'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt49'])).'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['probability_of'].'",';
				$row .= '"'.$user['factors_that_could'].'",';
				$row .= '"'.$user['AOI'].'",';
				$row .= '"'.$user['Sub_AOI'].'",';
				$row .= '"'.$user['reasons_for_why1'].'",';
				$row .= '"'.$user['reasons_for_why2'].'",';
				$row .= '"'.$user['overall_feel_of_the'].'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		  }else if($campaign=='live_snooping'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['actual_tagging'].'",';
				$row .= '"'.$user['agent_tagging'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['agen_tenure'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';

				$row .= '"'.$user['Identification'].'",';
				$row .= '"'.$user['Reason1'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['handling'].'",';
				$row .= '"'.$user['Reason2'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['handling1'].'",';
				$row .= '"'.$user['Reason3'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['Process'].'",';
				$row .= '"'.$user['Reason4'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['booking_process'].'",';
				$row .= '"'.$user['Reason5'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['Conversation'].'",';
				$row .= '"'.$user['Reason6'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['information'].'",';
				$row .= '"'.$user['Reason7'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['Closing'].'",';
				$row .= '"'.$user['Reason8'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['misleading'].'",';
				$row .= '"'.$user['Reason9'].'",';
				$row .= '"'.$user['cmt9'].'",';


                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		  }else if($campaign=='post_booking'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['associate_name'].'",';
				$row .= '"'.$user['team_leader'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['actual_disposition'].'",';
				$row .= '"'.$user['agen_tenure'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['evaluator_name'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['standardization_rating'].'",';
                $row .= '"'.$user['standardization_score'].'",';
                $row .= '"'.$user['standardization_cqscore'].'",';
                $row .= '"'.$user['product_possibleScore'].'",';
                $row .= '"'.$user['product_earnedScore'].'",';
                $row .= '"'.$user['product_overallScore'].'",';
                $row .= '"'.$user['communication_possibleScore'].'",';
                $row .= '"'.$user['communication_earnedScore'].'",';
                $row .= '"'.$user['communication_overallScore'].'",';
                $row .= '"'.$user['critical_possibleScore'].'",';
                $row .= '"'.$user['critical_earnedScore'].'",';
                $row .= '"'.$user['critical_overallScore'].'",';
                $row .= '"'.$user['fatal_possibleScore'].'",';
                $row .= '"'.$user['fatal_earnedScore'].'",';
                $row .= '"'.$user['fatal_overallScore'].'",';
                $row .= '"'.$user['Language'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['opening_done_in'].'",';
				$row .= '"'.$user['greeting_self_introduction'].'",';
				$row .= '"'.$user['hold_procedure'].'",';
				$row .= '"'.$user['no_dead_air'].'",';
				$row .= '"'.$user['call_summarization'].'",';
				$row .= '"'.$user['associate_asked'].'",';
				$row .= '"'.$user['relevant_probing_done'].'",';
				$row .= '"'.$user['all_customer_queries'].'",';
				$row .= '"'.$user['effective_rebuttals'].'",';
				$row .= '"'.$user['comprehensive_warranty'].'",';
				$row .= '"'.$user['day_trial_hassle_free'].'",';
				$row .= '"'.$user['consumer_financing'].'",';
				$row .= '"'.$user['car_details_make'].'",';
				$row .= '"'.$user['payment_type_confirmed'].'",';
				$row .= '"'.$user['customer_eligibility_checked'].'",';
                $row .= '"'.$user['delivery_type'].'",';
                $row .= '"'.$user['booking_and_final'].'",';
				$row .= '"'.$user['rc_transfer_documents'].'",';
				$row .= '"'.$user['customer_email'].'",';
				$row .= '"'.$user['correct_dispostion'].'",';
				$row .= '"'.$user['whatsapp_opt_pitched'].'",';
				$row .= '"'.$user['first_Call_resolution'].'",';
				$row .= '"'.$user['customer_concern_raised'].'",';
				$row .= '"'.$user['correct_details_remarks'].'",';
				$row .= '"'.$user['no_duplicate_ticket'].'",';
				$row .= '"'.$user['associate_personalized'].'",';
				$row .= '"'.$user['language_switched'].'",';
				$row .= '"'.$user['no_interruption'].'",';
				$row .= '"'.$user['tone_was_appropriate'].'",';
				$row .= '"'.$user['voice_clarity_appropriate'].'",';
				$row .= '"'.$user['mit_rti_error'].'",';
				$row .= '"'.$user['accurate_sentence'].'",';
				$row .= '"'.$user['no_pronunciation_error'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['acknowledgement'].'",';
				$row .= '"'.$user['available_tools_used'].'",';
				$row .= '"'.$user['incorrect_or_misleading'].'",';
				$row .= '"'.$user['no_rude_behaviour'].'",';
				$row .= '"'.$user['no_disconnection'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['aoi'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ppo'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['css'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign=='post_delivery'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['associate_name'].'",';
				$row .= '"'.$user['team_leader'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['actual_disposition'].'",';
				$row .= '"'.$user['agen_tenure'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['evaluator_name'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['Disposition1'].'",';
				$row .= '"'.$user['Sub_Disposition'].'",';
                $row .= '"'.$user['standardization_rating'].'",';
                $row .= '"'.$user['standardization_score'].'",';
                $row .= '"'.$user['standardization_cqscore'].'",';
                $row .= '"'.$user['product_possibleScore'].'",';
                $row .= '"'.$user['product_earnedScore'].'",';
                $row .= '"'.$user['product_overallScore'].'",';
                $row .= '"'.$user['communication_possibleScore'].'",';
                $row .= '"'.$user['communication_earnedScore'].'",';
                $row .= '"'.$user['communication_overallScore'].'",';
                $row .= '"'.$user['critical_possibleScore'].'",';
                $row .= '"'.$user['critical_earnedScore'].'",';
                $row .= '"'.$user['critical_overallScore'].'",';
                $row .= '"'.$user['fatal_possibleScore'].'",';
                $row .= '"'.$user['fatal_earnedScore'].'",';
                $row .= '"'.$user['fatal_overallScore'].'",';
                $row .= '"'.$user['Language'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['opening_done_in'].'",';
				$row .= '"'.$user['greeting_self_introduction'].'",';
				$row .= '"'.$user['hold_procedure'].'",';
				$row .= '"'.$user['no_dead_air'].'",';
				$row .= '"'.$user['call_summarization'].'",';
				$row .= '"'.$user['associate_asked'].'",';
				$row .= '"'.$user['associate_able_to'].'",';
				$row .= '"'.$user['relevant_probing_done'].'",';
				$row .= '"'.$user['all_customer_queries'].'",';
				$row .= '"'.$user['correct_tat_informed'].'",';
				$row .= '"'.$user['warranty_invoice'].'",';
				$row .= '"'.$user['first_Call_resolution'].'",';
				$row .= '"'.$user['customer_concern_raised'].'",';
				$row .= '"'.$user['correct_details_remark'].'",';
				$row .= '"'.$user['no_duplicate_ticket'].'",';
                $row .= '"'.$user['correct_dispostion'].'",';
                $row .= '"'.$user['customer_email_id'].'",';
				$row .= '"'.$user['associate_personalized'].'",';
				$row .= '"'.$user['language_switched'].'",';
				$row .= '"'.$user['no_interruption'].'",';
				$row .= '"'.$user['showed_empathy'].'",';
				$row .= '"'.$user['tone_was_appropriate'].'",';
				$row .= '"'.$user['voice_clarity_appropriate'].'",';
				$row .= '"'.$user['mit_rti_error'].'",';
				$row .= '"'.$user['accurate_sentence'].'",';
				$row .= '"'.$user['no_pronunciation_error'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['acknowledgement'].'",';
				$row .= '"'.$user['available_tools_used'].'",';
				$row .= '"'.$user['incorrect_or_misleading'].'",';
				$row .= '"'.$user['no_rude_behaviour'].'",';
				$row .= '"'.$user['no_disconnection'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['aoi'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['ppo'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['css'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

    }

////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////// VARO ////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////
       public function qa_varo_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_varo_report.php";
			$data["content_js"] = "qa_clio_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			//$campaign ="varo_rp";

			$data["qa_varo_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('from_date'));
				$date_to = mmddyy2mysql($this->input->get('to_date'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');
				$campaign = $this->input->get('p_id');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					//$cond .=" and audit_type='All'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}

                 $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_".$campaign."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $cond1";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_varo_list"] = $fullAray;
				$this->create_qa_varo_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_varo_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['process_id']=$campaign;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_varo_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_varo_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		   if($campaign=='varo_rp') {
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Contact Date","Call Duration","Phone Number","Audit Type", "Auditor Type", "Voc","Audit Start Date Time","Audit End Date Time","Interval","VSI Account","QA Type","Call ID","Area of Opportunity","Overall Score","Identify himself/herself by first and last name at the beginning of the call? **SQ**","Provide the Quality Assurance Statement verbatim before any specific account information was discussed?**SQ**","State Varo Bank with no deviation? **SQ**","Verify that he/she was speaking to a right party according to the client requirements (First and Last Name) and before providing the disclosures?","Verify two pieces of demographics information on an outbound call and two pieces on an inbound call? 1) must abide by client requirements and 2) Consumer must provide information unless there is a resistance. 3)Must be completed before disclosures 4) Exception on consumer fail to verify two pieces of demographics information/fail to verify complete address (missing street number etc) ","Provide the Mini Miranda disclosure verbatim before any specific account information was discussed? **SQ**","State the client name and the purpose of the communication?","Did the rep ask for callback permission as per Reg F policy?","State/Ask for balance due?","Ask for intention to resolve the account?","Ask for the payment to the account?","Help customer reset password for app incase customer states they have forgotten password ?","Followed the previous conversations on the account for the follow-up call","Able to take a promise to pay on the account?","Did Collector try to negotiate effectively to convince the customer for payment?","Did not  Misrepresent their identity or authorization and status of the consumers account?","Did not Discuss or imply that any type of legal actions - will be taken or property repossessed also on time barred accounts amd Did not Threaten to take actions that VRS or the client cannot legally take? ","Did not Make any false representations regarding the nature of the communication?","Did not Contact the consumer at any unusual times (sate regulations) or outside the hours of 8:00 am and 9:00 pm at the consumers location?","Did not Communicate with the consumer at work if it is known or there is reason to know that such calls are prohibited?","Did not Communicate with the consumer after learning the consumer is represented by an attorney filed for bankruptcy unless a permissible reason exists?","Adhere to the cell phone policy/TCPA regulations and policy regarding contacting consumers via cell phone email and fax?","Adhere to policy regarding third parties for the sole purpose of obtaining location information for the consumer?","Enter Status code/disposition codes correctly to ensure that inappropriate dialing does not take place?","Did not Make any statement that could constitute unfair deceptive or abusive acts or practices that may raise UDAAP concerns?","Did not Communicate or threaten to communicate false credit information or information which should be known to be false and utilized the proper CBR script whenever a consumer enquires about that?","Handle the consumers dispute correctly and take appropriate action including providing the consumer with the correct contact information to submit a written dispute or complaint or offer to escalate the call?","Did not Make the required statement on time barred accounts indicating that the consumer cannot be pursued with legal action?","Adhere to FDCPA  laws?","Did not Make any statement that could be considered discriminatory towards a consumer or a violation of VRS ECOA policy?","Did the collectors adhere to the State Restrictions?","Demonstrate Active Listening?","Represent the company and the client in a positive manner?","Anticipate and overcome objections?","Transfer call to Varo support appropriately?","Summarize the call?","Provided Varo Bank support number incase its required?","Set appropriate timelines and expectations for follow up?","Close the call Professionally?","Use the proper action code?","Use the proper result code?","Document thoroughly the context of the conversation?","Confirmation Code captured on note incase of payment?","Did the rep document the callback permission on the account as per Reg F policy?","Remove any phone numbers known to be incorrect?**SQ**","Update address information if appropriate?**SQ**","Change the status of the account if appropriate?**SQ**","Escalate the account to a supervisor for handling if appropriate?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		        } else if($campaign=='varo_lm'){
		        $header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Audit Type", "Auditor Type", "Voc","Hire Date","Audit Start Date Time","Audit End Date Time","Interval","VSI Account","Overall Score","State the First/Second left message attempt with no deviation or did not leave any message in NYC or with consumers of clients that prohibit the leaving of voice mail messages. **SQ**","Misrepresent their identity? **SQ**","Make any false representations about the nature of the call/ **SQ**","Make an attempt at any unusual times (state restrictions) or outside the hours of 8am and 9pm? **SQ**","Make an attempt at a work number if it is known or there is reason to know that such calls are prohibited? **SQ**","Make an attempt after learning that the consumer is represented by an attorney unless a permissible reason exists? **SQ**	","Adhere to policy regarding third parties and third party disclosure? **SQ**","Enter dialer disposition codes correctly to ensure that inappropriate dialing does not take place? **SQ**","Use the proper Action Code? **SQ**","Use the proper Result Code? **SQ**","Document the account thoroughly?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		        }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

			    if($campaign=='varo_rp') {
				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['vsi_account'].'",';
				$row .= '"'.$user['qa_type'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['area_of_opportunity'].'",';
				$row .= '"'.$user['overall_score'].'",';

				$row .= '"'.$user['identify_himself'].'",';
				$row .= '"'.$user['provide_the_uality'].'",';
				$row .= '"'.$user['state_varo_bank'].'",';
				$row .= '"'.$user['verify_that_he'].'",';
				$row .= '"'.$user['verify_two_pieces'].'",';
				$row .= '"'.$user['provide_the_mini'].'",';
				$row .= '"'.$user['state_the_client'].'",';
				$row .= '"'.$user['callback_permission_policy'].'",';
				$row .= '"'.$user['state_ssk_for'].'",';
				$row .= '"'.$user['ask_for_intention'].'",';
				$row .= '"'.$user['ask_for_the_payment'].'",';
				$row .= '"'.$user['help_customer_reset'].'",';
				$row .= '"'.$user['followed_the_previous'].'",';
				$row .= '"'.$user['able_to_take'].'",';
				$row .= '"'.$user['did_collector_try'].'",';
				$row .= '"'.$user['did_not_misrepresent'].'",';
				$row .= '"'.$user['did_discuss_or_imply'].'",';
				$row .= '"'.$user['did_not_make_any'].'",';
				$row .= '"'.$user['did_contact_the_consumer'].'",';
				$row .= '"'.$user['did_not_communicate_consumar'].'",';
				$row .= '"'.$user['did_not_communicate_exists'].'",';
				$row .= '"'.$user['aahereto_the_cell'].'",';
				$row .= '"'.$user['adhere_to_policy'].'",';
				$row .= '"'.$user['enter_status_code'].'",';
				$row .= '"'.$user['did_not_make_any_statement'].'",';
				$row .= '"'.$user['did_not_communicate'].'",';
				$row .= '"'.$user['handle_the_consumer'].'",';
				$row .= '"'.$user['did_ake_the_required'].'",';
				$row .= '"'.$user['adhere_to_fdcpa'].'",';
				$row .= '"'.$user['make_any_statement'].'",';
				$row .= '"'.$user['did_the_collectors'].'",';
				$row .= '"'.$user['aemonstrate_active'].'",';
				$row .= '"'.$user['represent_the_company'].'",';
				$row .= '"'.$user['anticipate_and_overcome'].'",';
				$row .= '"'.$user['transfer_call_varo'].'",';
				$row .= '"'.$user['summarize_the_call'].'",';
				$row .= '"'.$user['provided_varo_bank'].'",';
				$row .= '"'.$user['set_appropriate_timelines'].'",';
				$row .= '"'.$user['close_the_call'].'",';
				$row .= '"'.$user['proper_action_code'].'",';
				$row .= '"'.$user['proper_result_code'].'",';
				$row .= '"'.$user['document_thoroughly'].'",';
				$row .= '"'.$user['confirmation_code'].'",';
				$row .= '"'.$user['callback_permission_document'].'",';
				$row .= '"'.$user['remove_any_phone'].'",';
				$row .= '"'.$user['update_address_information'].'",';
				$row .= '"'.$user['change_the_status'].'",';
	            $row .= '"'.$user['escalate_the_account'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");


               } else if($campaign=='varo_lm'){

                $row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['hire_date'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['vsi_account'].'",';
				$row .= '"'.$user['overall_score'].'",';

				$row .= '"'.$user['state_the_first'].'",';
				$row .= '"'.$user['misrepresent_their'].'",';
				$row .= '"'.$user['make_any_false'].'",';
				$row .= '"'.$user['make_an_attempt'].'",';
				$row .= '"'.$user['make_an_attempt_work'].'",';
				$row .= '"'.$user['make_an_attempt_after'].'",';
				$row .= '"'.$user['adhere_policy_regarding'].'",';
				$row .= '"'.$user['enter_dialer_disposition'].'",';
				$row .= '"'.$user['use_the_proper_action'].'",';
				$row .= '"'.$user['use_the_proper_result'].'",';
				$row .= '"'.$user['document_the_account'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
               }


			}
			fclose($fopen);


        }

/*---------------------------------------------------------------------------------------------*/
/*------------------------------------- Groupe and France -------------------------------------*/
/*---------------------------------------------------------------------------------------------*/
	public function qa_groupe_france_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_groupe_france_report.php";
			$data["content_js"] = "qa_universal_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$campaign = "groupe_france";

			$data["qa_groupe_france_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_groupe_france_assur_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_groupe_france_list"] = $fullAray;
				$this->create_qa_groupe_france_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_groupe_france_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_groupe_france_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_groupe_france_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=="groupe_france"){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Process", "Call Date","Call Duration","Contact Number", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Overall Score","Prsentation - (nom prnom sponsor)","recherche de l interlocuteur",  "Validation de l entre au foyer ","Prsentation de l objet de l appel",   "Traitement refus de rpondre ", "Prise de rendez-vous", "Personnalistion de l entretien", "Mise en situation ","Connaissance du produit","Connaissance du milieu de l assurance mutuelle et des administrations","Mise en avant des avantages produit ","Dcouverte du besoin ","Capacit  tablir le dialogue", "Ecoute active ","Capacit  rebondir","Validation de la comprhension du client","Validation de l intrt ","Validation du budget du client","Phrase de proposition", "Ne pas vendre la priode de rtractation","Comprhension de l objection","Reformulation","Questionnement / dcouverte","Traitement de l objection ", "Vrification de l adresse / portable & email", "Respect des phrases de validation du script", "validation de l opt IN commerciale ","Sourire/dynamisme ","Directivit", "Dbit de parole", "Verbe au prsent / discours clair concis / formulation positive", "Empathie ", "Gestion du silence","Prise de cong nominative + formule de politesse ","Proposition de visiter le site internet","Call Summary","Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=="groupe_france")
		{
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['presentation'].'",';
				$row .= '"'.$user['recherche'].'",';
				$row .= '"'.$user['validation_entree'].'",';
				$row .= '"'.$user['presentation_de'].'",';
				$row .= '"'.$user['traitement_refus'].'",';
				$row .= '"'.$user['prise_de'].'",';
				$row .= '"'.$user['personnalistion'].'",';
				$row .= '"'.$user['mise_en_situation'].'",';
				$row .= '"'.$user['connaissance_du_produit'].'",';
				$row .= '"'.$user['connaissance_du_milieu'].'",';
				$row .= '"'.$user['mise_en_avant'].'",';
				$row .= '"'.$user['decouverte_du'].'",';
				$row .= '"'.$user['capacite_etablir'].'",';
				$row .= '"'.$user['ecoute_active'].'",';
				$row .= '"'.$user['capacite_arebondir'].'",';
				$row .= '"'.$user['validation_de_la'].'",';
				$row .= '"'.$user['validation_de_interet'].'",';
				$row .= '"'.$user['validation_du_budget'].'",';
				$row .= '"'.$user['phrase_de_proposition'].'",';
				$row .= '"'.$user['ne_pas_vendre'].'",';
				$row .= '"'.$user['comprehension'].'",';
				$row .= '"'.$user['reformulation'].'",';
				$row .= '"'.$user['questionnement'].'",';
				$row .= '"'.$user['traitement_de'].'",';
				$row .= '"'.$user['verification_de_adresse'].'",';
				$row .= '"'.$user['respect_des_phrases'].'",';
				$row .= '"'.$user['validation_de_opt'].'",';
				$row .= '"'.$user['sourire_dynamisme'].'",';
				$row .= '"'.$user['directivite'].'",';
				$row .= '"'.$user['debit_de_parole'].'",';
				$row .= '"'.$user['verbe_au_present'].'",';
				$row .= '"'.$user['empathie'].'",';
				$row .= '"'.$user['gestion_du_silence'].'",';
				$row .= '"'.$user['prise_de_conge'].'",';
				$row .= '"'.$user['proposition_de_visiter'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

	}


/*---------------------------------------------------------------------------------------------*/
/*------------------------------------- Associate Material ------------------------------------*/
/*---------------------------------------------------------------------------------------------*/
	public function qa_associate_mats_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports/aside.php";
			$data["content_template"] = "qa_associate_materials/qa_associate_mats_report.php";
			$data["content_js"] = "qa_avon_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
            $qSql="";

			$data["qa_associate_list"] = array();

			if($this->input->get('show')=='Show'){
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


                $qSql="SELECT * from
                (Select *, get_user_name(entry_by) as auditor_name, get_user_name(client_entryby) as client_name, get_user_name(tl_id) as tl_name, get_user_name(mgnt_rvw_by) as mgnt_rvw_name,
                (select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_associate_materials) xx Left Join
                (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on
                (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
                $fullAray = $this->Common_model->get_query_result_array($qSql);

                $data["qa_associate_list"] = $fullAray;

                $this->qa_associate_CSV($fullAray);

                $dn_link = base_url()."qa_associate_materials/download_qa_associate_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}

    //Download CSV Report
    public function download_qa_associate_CSV(){
        $currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Associate Materials Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
    }

    //Generate CSV
    public function qa_associate_CSV($rr){
        $currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

        $infraction_type=$this->infraction_type();
        $aht_acpt=$this->aht_acpt();

        $header=array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Supervisor", "Call Date", "Call Duration", "Caller ID", "Interaction ID", "Week", "Audit Type", "Auditor Type", "VOC",
        "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Earned Score", "Possible Score", "Overall Score",
        "Greetings - Did agent greet the customer properly on call?",
        "Introduction -Did the agent mention his/her name on call and also branded the call",
        "WebClaim -Did the agent mention about 'WebClaim Management System'?",

        "Communication - Proper energy communication skill was reflecting on call while speaking to the customer",
        "Empathy- Advisor shown empathy or appology when and where required. Also advisors intonation was proper on call",
        "Did the agent overlapped or interruped the customer while he/she was speaking?",
        "Did the agent showed good listening skills on call?",
        "Professionalism - Advisor showing proper professionalism on call. Not being rude on call/abusive/call disconnection/sarcasm etc",
        "Using jargons/slangs or fumbling/stammering or MTI on call?",

        "Probing - Did agent probed well to understand customers query and provide right information",
        "Hold Verbiage - Did the agent asked permission to put the call on hold ? & after resuming agent should thank the customer",
        "Hold Refresh - Did the agent informed the customer that he/she still looking for information (if hold is more than 2 mins)- If disconnected due to long hold then it leads to infraction",
        "Managed Customer Expectations: Properly understood the customer need and assisted accordingly",
        "Process Knowledge- Utilized established guidelines and procedures/policy from the leadership team as per process knowledge",
        "Documentation- Agent has documented the call properly as per customer request",

        "Mandatory Information",
        "Did the agent provided correct and complete information on call? Educate - Educate the customer on how Webclaim Management system works?",
        "On call resolution",
        "Did the agent asked for further assistance on call",
        "Properly Closing - Advisor thanked the customer and closed the call properly",
        "Infraction",
        "Infraction Type",
        "AHT(ACPT)",
        "L1 Drill Down",
        "L2 Drill Down",
        "Observation",
        "Call Summary", "Feedback", "Agent Feedback Acceptance",
        "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

        $row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

        foreach($rr as $user){
            $auditorName=($user['entry_by']!="")?$user['auditor_name']:$user['client_name'];
            if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
            $row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['caller_id'].'",';
            $row .= '"'.$user['interaction_id'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$interval1.'",';
            $row .= '"'.$user['earned_score'].'",';
            $row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['overall_score'].'%'.'",';

            //Opening
            $row .= '"'.$user['greetings'].'",';
            $row .= '"'.$user['introduction'].'",';
            $row .= '"'.$user['webclaim'].'",';

            //Soft Skills
            $row .= '"'.$user['communication'].'",';
            $row .= '"'.$user['empathy'].'",';
            $row .= '"'.$user['interrupted_cust'].'",';
            $row .= '"'.$user['listening_skills'].'",';
            $row .= '"'.$user['professionalism'].'",';
            $row .= '"'.$user['mti_on_call'].'",';

            //Call Handling
            $row .= '"'.$user['probing'].'",';
            $row .= '"'.$user['hold_verbiage'].'",';
            $row .= '"'.$user['hold_refresh'].'",';
            $row .= '"'.$user['man_cust_expect'].'",';
            $row .= '"'.$user['process_knowledge'].'",';
            $row .= '"'.$user['documentation'].'",';

            $row .= '"'.$user['mandatory_information'].'",';
            $row .= '"'.$user['complete_info_on_call'].'",';
            $row .= '"'.$user['on_call_resolution'].'",';
            $row .= '"'.$user['further_assist_on_call'].'",';
            $row .= '"'.$user['properly_closing'].'",';
            $row .= '"'.$user['infraction'].'",';
            $row .= '"'.$infraction_type[$user['infraction_type']].'",';
            $row .= '"'.$aht_acpt[$user['aht_acpt']].'",';
            $row .= '"'.$user['l1_drill_down'].'",';
            $row .= '"'.$user['l2_drill_down'].'",';
            $row .= '"'.$user['observation'].'",';

            $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

            fwrite($fopen,$row."\r\n");
        }
        fclose($fopen);
    }


    /////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Report Part //////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////

	public function qa_sentient_jet_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports/aside.php";
			$data["content_template"] = "reports_qa/qa_sentient_jet_report.php";
			$data["content_js"] = "qa_universal_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			$campaign ="sentient_jet";

			$data["sentient_jet_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_sentient_jet_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["sentient_jet_list"] = $fullAray;
				$this->create_qa_sentient_jet_CSV($fullAray,$campaign);
				$dn_link = base_url()."Qa_sentient_jet/download_qa_sentient_jet_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_sentient_jet_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_sentient_jet_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Email Date","Date Evaluated", "Ticket", "Flight ID", "Month","Week","Final","Audit Type", "Auditor Type", "Voc","Earn Score","Possible Score","Overall Score","Customer Score","Business Score",
				"Appropriate subject line correct greeting and opening?","Did the agent ask for the outstanding details?","Sentence construction and tone of email","Did the CM label the ticket fields and submitted the ticket as solved?","Closing remarks and attachment(s)","Was the delivery information correct?","Did the CM submit the order to the appropriate vendor?","Did the order match the client's request?","Did the CM process a billback and was it correct?","Did the CM add revisions or catering instructions in the b2b?","Did the CM set the correct arranger/tracking for the GT request?","Did the CM utilize the correct car company?","Did the CM consider the number of luggage and pax for the vehicle type?","Did the CM set the correct date and spot time for the car service/rental car?","Did the CM provide the confirmation number?","Did the CM update the client and internal notes?","Did the CM update the flight worksheet?","Did the CM update the flight Leg?","Did the agent complete the To-Do task for CM?","Did the agent create a flight note to alert CM FP & FM?","Did the CM summarize ALL details of the task and was the disposition correct?","Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13","Remark 14","Remark 15","Remark 16","Remark 17","Remark 18","Remark 19","Remark 20","Remark 21","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['date_evaluated'].'",';
				$row .= '"'.$user['ticket'].'",';
				$row .= '"'.$user['flight_id'].'",';
				$row .= '"'.$user['month'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['final'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['customer_score'].'",';
				$row .= '"'.$user['business_score'].'",';

                $row .= '"'.$user['appropriate_subject'].'",';
				$row .= '"'.$user['did_the_agent_ask'].'",';
				$row .= '"'.$user['sentence_construction'].'",';
				$row .= '"'.$user['did_the_agent_tag'].'",';
				$row .= '"'.$user['closing_remarks'].'",';
				$row .= '"'.$user['correct_fbo_pax'].'",';
				$row .= '"'.$user['was_catering_submitted'].'",';
				$row .= '"'.$user['correct_items'].'",';
				$row .= '"'.$user['correctly_billed'].'",';
				$row .= '"'.$user['revisions_or_ca'].'",';
				$row .= '"'.$user['set_the_correct'].'",';
				$row .= '"'.$user['correct_gt_company'].'",';
				$row .= '"'.$user['does_car_meet'].'",';
				$row .= '"'.$user['is_car_service'].'",';
				$row .= '"'.$user['ensure_the_confirmation'].'",';
				$row .= '"'.$user['added_client_and'].'",';
				$row .= '"'.$user['complete_and_accurate'].'",';
				$row .= '"'.$user['complete_and_accurate_leg'].'",';
				$row .= '"'.$user['closed_flight_leg'].'",';
				$row .= '"'.$user['did_the_agent_create'].'",';
				$row .= '"'.$user['correct_disposition'].'",';


                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';


                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


        }

        public function qa_freedom_customer_service_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_freedom_customer_service_report.php";
			$data["content_js"] = "qa_chariot_energy_js.php";
			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";
			$campaign = "freedom_customer";
			$data["customer_list"] = array();

			if($this->input->get('show')=='Show')
			{

				    $from_date = mmddyy2mysql($this->input->get('date_from'));
					$to_date = mmddyy2mysql($this->input->get('date_to'));
					$office_id = $this->input->get('office_id');
					$lob = $this->input->get('lob');

					if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
						$ops_cond="";
					}else{
						if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
							$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
						}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
							$ops_cond=" Where assigned_to='$current_user'";
						}else{
							$ops_cond="";
						}
					}

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_freedom_customer_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $ops_cond order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["customer_list"] = $fullAray;
				$this->create_qa_freedom_customer_CSV($fullAray,$campaign);
				$dn_link = base_url()."qa_freedom_customer_service/download_freedom_customer_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $from_date;
			$data['date_to'] = $to_date;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_freedom_customer_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_freedom_customer_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		    if($campaign=='freedom_customer'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Type","Call Duration","Call Id","Audit Type","Auditor Type","VOC","Overall Score","Intro/Opening","Account Balance/Payments ","System Knowledge","Notes/NLS Updates",	"Summary/Closing","Reason for delinquency","Negotiation	","Ask probing/ open ended questions","Questions or objections appropriately addressed.","Disparaging comments about partners or internal departments avoided.", "ACH Payment","Contact Info Verification","Acknowledgement empathy or empathetic tone used as necessary.",	"Language or tone used that prevented a negative perception.","Concern/Reason for Call Addressed","Demonstrates professional call etiquette","Expectations set for follow up actions/next interaction. ", "Manages hold time & dead air","Respectfully attempt to re-engage borrower if questioning overall", "Unfair Deceptive Misleading or Inaccurate Information","Call Time ","Collection Disclosures","Locate Borrower (applicable for calls to third parties)","Detect/Respond to SCRA","Verify Identity","Additional Comments",	"Did agent go Above & Beyond?","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		        }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");
		    if($campaign=='freedom_customer'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['intro_pening'].'",';
				$row .= '"'.$user['account_balance'].'",';
				$row .= '"'.$user['system_knowledge'].'",';
				$row .= '"'.$user['notes_updates'].'",';
				$row .= '"'.$user['summary_closing'].'",';
				$row .= '"'.$user['season_for_del'].'",';
				$row .= '"'.$user['negotiation'].'",';
				$row .= '"'.$user['ssk_probing_open'].'",';
				$row .= '"'.$user['questions_or_objections'].'",';
				$row .= '"'.$user['disparaging_comments'].'",';
				$row .= '"'.$user['ach_ayment'].'",';
				$row .= '"'.$user['contact_info'].'",';

				$row .= '"'.$user['acknowledgement'].'",';
				$row .= '"'.$user['language_or_tone'].'",';
				$row .= '"'.$user['concern_reason'].'",';
				$row .= '"'.$user['demonstrates_professional'].'",';
				$row .= '"'.$user['expectations_set'].'",';
				$row .= '"'.$user['manages_hold'].'",';
				$row .= '"'.$user['respectfully_attempt'].'",';

				$row .= '"'.$user['unfair_deceptive'].'",';
				$row .= '"'.$user['call_time'].'",';
				$row .= '"'.$user['collection_disclosures'].'",';
				$row .= '"'.$user['locate_borrower'].'",';
				$row .= '"'.$user['detect_respond'].'",';
				$row .= '"'.$user['verify_identity'].'",';
				$row .= '"'.$user['additional_comments'].'",';
				$row .= '"'.$user['did_agent_go'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		  }

       }


       public function qa_ltfs_report(){
    if(check_logged_in()){

      $office_id = "";
      $user_office_id=get_user_office_id();
      $current_user = get_user_id();
      $is_global_access=get_global_access();
      $role_dir=get_role_dir();
      $data["show_download"] = false;
      $data["download_link"] = "";
      $data["show_table"] = false;
      $data["show_table"] = false;

      $data["aside_template"] = "reports_qa/aside.php";
      $data["content_template"] = "reports_qa/qa_ltfs_report.php";
      $data["content_js"] = "qa_universal_js.php";
      $date_from="";
      $date_to="";
      $action="";
      $dn_link="";
      $cond="";
      $cond1="";

      $data["qa_ltfs_list"] = array();
      if($this->input->get('show')=='Show') {
        $campaign ='ltfs';
        $date_from = mmddyy2mysql($this->input->get('date_from'));
        $date_to = mmddyy2mysql($this->input->get('date_to'));
        $office_id = $this->input->get('office_id');

        if($office_id=="All") $cond .= "";
        else $cond .=" and office_id='$office_id'";
        if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

        if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
          $cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
        }else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
          $cond1 .=" And assigned_to='$current_user'";
        }else{
          $cond1 .="";
        }

                //Nilkanta
        if($campaign=='ltfs'){
        $qSql="SELECT * from
        (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
        (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
        (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
        (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
        (select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_ltfs_feedback) xx Left Join
        (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

        $fullAray = $this->Common_model->get_query_result_array($qSql);
        $data["qa_ltfs_list"] = $fullAray;
          }

        $this->create_qa_ltfs_CSV($fullAray,$campaign);
        $dn_link = base_url()."qa_ltfs/download_qa_ltfs_CSV";


      }
      $data['location_list'] = $this->Common_model->get_office_location_list();

      $data['download_link']=$dn_link;
      $data["action"] = $action;
      $data['date_from'] = $date_from;
      $data['date_to'] = $date_to;


      $data['office_id']=$office_id;


      $this->load->view('dashboard',$data);
    }
  }

////////////LTFS ///////////////////////////////
  public function download_qa_ltfs_CSV()
  {
    $currDate=date("Y-m-d");
    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $newfile="QA LTFS Audit List-'".$currDate."'.csv";

    header('Content-Disposition: attachment;  filename="'.$newfile.'"');
    readfile($filename);
  }

  public function create_qa_ltfs_CSV($rr,$campaign)
  {

    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $fopen = fopen($filename,"w+");
    if($campaign=='ltfs'){
     $header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor","Call Date", "Call Duration", "Call Type", "Campaign","Employee ID","Phone Number","Call Record Id","Call Disconnect By","Disposition (associate)","Disposition (QA)","Audit Type", "Auditor Type", "VOC","Possible Score", "Earned Score", "Overall Score","Did the service executive attend the call within 5 seconds And gave appropriate greeting & self-introduction with brand name and identify the respondent along with the purpose of call?","Did the service executive listen actively without interrupting the customer & Provide appropriate acknowledgment during the interaction?","Did the service executive handled the interaction professionally with proper tone pitch volume & rate of speech and pace throughout the interaction?","Did the service executive sound confident energetic and enthusiastic throughout the interaction with the customer?","Did the service executive made sure the interaction is focused on the purpose of the call and was in complete control of the interaction?","Did the service executive briefly summarize the interaction next course of action & TAT check if any need for clarification and closed the call positively?","Did the service executive probe for the customer need to understand the requirement?","Did the service executive create customer's interest by understanding his background and need ?","Did the service executive effectively handled customer's objection on sales & service with appropriate rebuttals?","Did the service executive establish trust with the customer by explaining the brand presence success stories?","Did the service executive explained all the USP Benefits ?","Did the service executive utilized all the opportunities to convert the lead into sale","Did the service executive frame appropriate open ended questions statements during the interaction to engage the customer and refrained from using complicated jargon?","Did the service executive created urgency using convincing appropriate statements without forcing the customer?","Being a QA Are you satisfied with overall call handling ","FATAL Wrong Information Rude Unnecessary Redirection Wrong Commitment Invalid CCE Disconnection","From QA standpoint If the interaction less than 100% then as per ACPT where we could have improved? ","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
    }

    $row = "";
    foreach($header as $data) $row .= ''.$data.',';
    fwrite($fopen,rtrim($row,",")."\r\n");
    $searches = array("\r", "\n", "\r\n");

    if($campaign=='ltfs'){

      foreach($rr as $user){
         if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
          $interval1 = '---';
         }else{
          $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
         }


        $row = '"'.$user['auditor_name'].'",';
        $row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['fusion_id'].'",';
        $row .= '"'.$user['fname']." ".$user['lname'].'",';
        $row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_date'].'",';
        $row .= '"'.$user['call_duration'].'",';
        $row .= '"'.$user['call_type'].'",';
        $row .= '"'.$user['campaign'].'",';
        $row .= '"'.$user['employee_id'].'",';
        $row .= '"'.$user['phone_number'].'",';
        $row .= '"'.$user['call_record_id'].'",';
        $row .= '"'.$user['call_disconnect_by'].'",';
        $row .= '"'.$user['disposition'].'",';
        $row .= '"'.$user['disposition_qa'].'",';
        $row .= '"'.$user['audit_type'].'",';
        $row .= '"'.$user['auditor_type'].'",';
        $row .= '"'.$user['voc'].'",';
        $row .= '"'.$user['possible_score'].'",';
        $row .= '"'.$user['earned_score'].'",';
        $row .= '"'.$user['overall_score'].'",';
        $row .= '"'.$user['purpose_of_call'].'",';
        $row .= '"'.$user['during_the_interaction'].'",';
        $row .= '"'.$user['throughout_the_interaction'].'",';
        $row .= '"'.$user['with_the_customer'].'",';
        $row .= '"'.$user['control_of_the_interaction'].'",';
        $row .= '"'.$user['call_positively'].'",';
        $row .= '"'.$user['the_requirement'].'",';
        $row .= '"'.$user['background_and_need'].'",';
        $row .= '"'.$user['appropriate_rebuttals'].'",';
        $row .= '"'.$user['success_stories'].'",';
        $row .= '"'.$user['service_executive'].'",';
        $row .= '"'.$user['lead_into_sale'].'",';
        $row .= '"'.$user['complicated_jargon'].'",';
        $row .= '"'.$user['forcing_the_customer'].'",';
        $row .= '"'.$user['call_handling'].'",';
        $row .= '"'.$user['CCE_disconnection'].'",';
        $row .= '"'.$user['have_improved'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
        $row .= '"'.$user['agent_rvw_date'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
        $row .= '"'.$user['mgnt_rvw_date'].'",';
        $row .= '"'.$user['mgnt_rvw_name'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

        fwrite($fopen,$row."\r\n");
      }
      fclose($fopen);

    }
}


public function qa_freedom_financial_report(){
    if(check_logged_in()){

      $office_id = "";
      $user_office_id=get_user_office_id();
      $current_user = get_user_id();
      $is_global_access=get_global_access();
      $role_dir=get_role_dir();
      $data["show_download"] = false;
      $data["download_link"] = "";
      $data["show_table"] = false;
      $data["show_table"] = false;

      $data["aside_template"] = "reports_qa/aside.php";
      $data["content_template"] = "reports_qa/qa_freedom_financial_report.php";
      $data["content_js"] = "qa_universal_js.php";
      $date_from="";
      $date_to="";
      $action="";
      $dn_link="";
      $cond="";
      $cond1="";

      $data["qa_freedom_financial_list"] = array();
      if($this->input->get('show')=='Show') {
        $campaign ='freedom_financial';
        $date_from = mmddyy2mysql($this->input->get('date_from'));
        $date_to = mmddyy2mysql($this->input->get('date_to'));
        $office_id = $this->input->get('office_id');

        if($office_id=="All") $cond .= "";
        else $cond .=" and office_id='$office_id'";
        if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

        if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
          $cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
        }else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
          $cond1 .=" And assigned_to='$current_user'";
        }else{
          $cond1 .="";
        }

                //Nilkanta
        if($campaign=='freedom_financial'){
        $qSql="SELECT * from
        (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
        (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
        (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
        (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
        (select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_freedom_financial_feedback) xx Left Join
        (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

        $fullAray = $this->Common_model->get_query_result_array($qSql);
        $data["qa_freedom_financial_list"] = $fullAray;
          }

        $this->create_qa_freedom_financial_CSV($fullAray,$campaign);
        $dn_link = base_url()."reports_qa/download_qa_freedom_financial_CSV";


      }
      $data['location_list'] = $this->Common_model->get_office_location_list();

      $data['download_link']=$dn_link;
      $data["action"] = $action;
      $data['date_from'] = $date_from;
      $data['date_to'] = $date_to;


      $data['office_id']=$office_id;


      $this->load->view('dashboard',$data);
    }
  }

////////////Craftjack ///////////////////////////////
  public function download_qa_freedom_financial_CSV()
  {
    $currDate=date("Y-m-d");
    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $newfile="QA freedom financial Audit List-'".$currDate."'.csv";

    header('Content-Disposition: attachment;  filename="'.$newfile.'"');
    readfile($filename);
  }

  public function create_qa_freedom_financial_CSV($rr,$campaign)
  {

    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $fopen = fopen($filename,"w+");
    if($campaign=='freedom_financial'){
     $header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor","Call Date", "Call Duration", "Call Type","Call Id","Audit Type", "Auditor Type", "VOC","Possible Score", "Earned Score", "Overall Score","Business Score","Customer Score","Compliance Score","Intro/Opening","Account Balance/Payments","System Knowledge","Notes/NLS Updates","Summary/Closing","Reason for delinquency","Negotiation","Ask probing/ open ended questions","Questions or objections appropriately addressed","Disparaging comments about partners or internal 5 departments avoided.","ACH Payment","Contact Info V 15 erificatio","Acknowledgement empathy or empathetic tone used as necessary.","Language or tone used that prevented a negative perception","Concern/Reason for Call Addressed","Demonstrates professional call etiquette","Expectations set for follow up actions/next interaction","Manages hold time & dead air","Respectfully attempt to re-engage borrower if 0 questioning overall","Call Recorded Disclosure","Unfair 0 Deceptive Misleading or Inaccurate Information","Call Time","Collection Disclosures","Locate Borrower (applicable for calls to third parties)","Detect/Respond to SCRA","Verify Identity","Intro/Opening Comment","Account Balance/Payments Comment","System Knowledge Comment","Notes/NLS Updates Comment","Summary/Closing Comment","Reason for delinquency Comment","Negotiation Comment","Ask probing/ open ended questions Comment","Questions or objections appropriately addressed Comment","Disparaging comments about partners or internal 5 departments avoided. Comment","ACH Payment Comment","Contact Info V 15 erificatio Comment","Acknowledgement empathy or empathetic tone used as necessary. Comment","Language or tone used that prevented a negative perception Comment","Concern/Reason for Call Addressed Comment","Demonstrates professional call etiquette Comment","Expectations set for follow up actions/next interaction Comment","Manages hold time & dead air Comment","Respectfully attempt to re-engage borrower if 0 questioning overall Comment","Call Recorded Disclosure Comment","Unfair 0 Deceptive Misleading or Inaccurate Information Comment","Call Time Comment","Collection Disclosures Comment","Locate Borrower (applicable for calls to third parties) Comment","Detect/Respond to SCRA","Verify Identity Comment","Call Summary", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
    }

    $row = "";
    foreach($header as $data) $row .= ''.$data.',';
    fwrite($fopen,rtrim($row,",")."\r\n");
    $searches = array("\r", "\n", "\r\n");

    if($campaign=='freedom_financial'){

      foreach($rr as $user){
         if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
          $interval1 = '---';
         }else{
          $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
         }


        $row = '"'.$user['auditor_name'].'",';
        $row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['fusion_id'].'",';
        $row .= '"'.$user['fname']." ".$user['lname'].'",';
        $row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_date'].'",';
        $row .= '"'.$user['call_duration'].'",';
        $row .= '"'.$user['call_type'].'",';
        $row .= '"'.$user['call_id'].'",';
        $row .= '"'.$user['audit_type'].'",';
        $row .= '"'.$user['auditor_type'].'",';
        $row .= '"'.$user['voc'].'",';
        $row .= '"'.$user['possible_score'].'",';
        $row .= '"'.$user['earned_score'].'",';
        $row .= '"'.$user['overall_score'].'",';
        $row .= '"'.$user['busi_score'].'",';
        $row .= '"'.$user['cust_score'].'",';
        $row .= '"'.$user['comp_score'].'",';

        $row .= '"'.$user['opening'].'",';
        $row .= '"'.$user['account_balance'].'",';
        $row .= '"'.$user['system_knowledge'].'",';
        $row .= '"'.$user['NLS_updates'].'",';
        $row .= '"'.$user['Summary_closing'].'",';
        $row .= '"'.$user['delinquency'].'",';
        $row .= '"'.$user['Negotiation'].'",';
        $row .= '"'.$user['Ask_probing'].'",';
        $row .= '"'.$user['objections_appropriately'].'",';
        $row .= '"'.$user['Disparaging_comments'].'",';
        $row .= '"'.$user['ACH_payment'].'",';
        $row .= '"'.$user['Contact_Info'].'",';
        $row .= '"'.$user['Acknowledgement'].'",';
        $row .= '"'.$user['Language_tone'].'",';
        $row .= '"'.$user['Reason_call'].'",';
        $row .= '"'.$user['Demonstrates_call'].'",';
        $row .= '"'.$user['Expectations_set'].'",';
        $row .= '"'.$user['Manages_hold'].'",';
        $row .= '"'.$user['Respectfully_attempt'].'",';
        $row .= '"'.$user['Call_recorded'].'",';
        $row .= '"'.$user['Unfair'].'",';
        $row .= '"'.$user['Call_time'].'",';
        $row .= '"'.$user['Collection_disclosures'].'",';
        $row .= '"'.$user['Locate_borrower'].'",';
        $row .= '"'.$user['Detect_respond'].'",';
        $row .= '"'.$user['Verify_identity'].'",';
        $row .= '"'.$user['cmt1'].'",';
        $row .= '"'.$user['cmt2'].'",';
        $row .= '"'.$user['cmt3'].'",';
        $row .= '"'.$user['cmt4'].'",';
        $row .= '"'.$user['cmt5'].'",';
        $row .= '"'.$user['cmt6'].'",';
        $row .= '"'.$user['cmt7'].'",';
        $row .= '"'.$user['cmt8'].'",';
        $row .= '"'.$user['cmt9'].'",';
        $row .= '"'.$user['cmt10'].'",';

        $row .= '"'.$user['cmt11'].'",';
        $row .= '"'.$user['cmt12'].'",';
        $row .= '"'.$user['cmt13'].'",';
        $row .= '"'.$user['cmt14'].'",';
        $row .= '"'.$user['cmt15'].'",';
        $row .= '"'.$user['cmt16'].'",';
        $row .= '"'.$user['cmt17'].'",';
        $row .= '"'.$user['cmt18'].'",';
        $row .= '"'.$user['cmt19'].'",';
        $row .= '"'.$user['cmt20'].'",';
        $row .= '"'.$user['cmt21'].'",';
        $row .= '"'.$user['cmt22'].'",';
        $row .= '"'.$user['cmt23'].'",';
        $row .= '"'.$user['cmt24'].'",';
        $row .= '"'.$user['cmt25'].'",';
        $row .= '"'.$user['cmt26'].'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
        $row .= '"'.$user['agent_rvw_date'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
        $row .= '"'.$user['mgnt_rvw_date'].'",';
        $row .= '"'.$user['mgnt_rvw_name'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

        fwrite($fopen,$row."\r\n");
      }
      fclose($fopen);

    }
}

////////////////////////////One Assist(Riya 1/02/2022)/////////////////////////////////
	public function qa_one_assist_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_one_assist_report.php";
			$data["content_js"] = "qa_one_assist_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";
			$campaign = $this->input->get('campaign');
			$data["qa_pre_list"] = array();

			if($this->input->get('show')=='Show')
			{

				    $from_date = mmddyy2mysql($this->input->get('date_from'));
					$to_date = mmddyy2mysql($this->input->get('date_to'));
					$office_id = $this->input->get('office_id');
					$lob = $this->input->get('lob');

					if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
						$ops_cond="";
					}else{
						if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
							$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
						}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
							$ops_cond=" Where assigned_to='$current_user'";
						}else{
							$ops_cond="";
						}
					}

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_".$campaign."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $ops_cond order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_pre_list"] = $fullAray;
				$this->create_qa_one_assist_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_one_assist_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $from_date;
			$data['date_to'] = $to_date;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

public function download_qa_one_assist_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_one_assist_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		    if($campaign=='one_assist'){
				$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Campaign","Call Duration","Customer Contact Number","Audit Type","Voc","Overall Score","Customer Voc","Actual Disposition","Agent Disposition","Track ID","Customer ID","ACPT","Audit Start Time","Audit End Time","Interval (In Sec)",
				"Assurance and empathy","Customer Validation (Right Person Confirmation)","Customer IdentificationCall Opening / Purpose of Renewal","Need Creation / Sales Pitch", "Call Control","Interruption to the customer","Customer Understanding","Hold Protocal followed","Objection handling & convincing skill","Tool usage was required -Direct discount pitched / efforts","Fact Finding / Information Gathering","Pace Tone & voice modulation","Active listening/Attentiveness","Personalization","App and Chat promoted","Auto Renewal Informed","Fake/ Forcefull renewal","Creation of SR wherever required","Dialer Disposition/CRM Tagging/Escalation SR not Raised","Correct & Complete Information","Call Summary", "Agent Feedback Acceptance","Feedback", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		    }

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='one_assist'){
			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['customer_contact_number'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['customer_voc'].'",';
				$row .= '"'.$user['actual_disposition'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['track_id'].'",';
				$row .= '"'.$user['customer_id'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['assurance_and_empathy'].'",';
				$row .= '"'.$user['customer_validation'].'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['need_creation'].'",';
				$row .= '"'.$user['call_control'].'",';
				$row .= '"'.$user['interruption_to_the_customer'].'",';
				$row .= '"'.$user['customer_understanding'].'",';
				$row .= '"'.$user['hold_protocal_followed'].'",';
				$row .= '"'.$user['objection_handling'].'",';
				$row .= '"'.$user['tool_usage_was_required'].'",';
				$row .= '"'.$user['fact_finding'].'",';
				$row .= '"'.$user['pace_tone'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['personalization'].'",';
				$row .= '"'.$user['app_and_chat_promoted'].'",';
				$row .= '"'.$user['auto_renewal_informed'].'",';
				$row .= '"'.$user['fake_forcefull_renewal'].'",';
				$row .= '"'.$user['creation_of_SR_wherever_required'].'",';
				$row .= '"'.$user['dialer_disposition'].'",';
				$row .= '"'.$user['correct_complete_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_note'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}


    }

/////////////////////////////////////////////////////Riya/////////////////////////////////////////////
///////////////////////////Piyali 02/02/2022 ///////
	public function qa_bounce_infinity_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_bounce_infinity_report.php";
			$data["content_js"] = "qa_bounce_infinity_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			//$campaign ="bounce_infinity";

			$data["bounce_infinity_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$campaign = $this->input->get('campaign');
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}

				if($campaign=='cuemath_hygiene'){
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_bounce_infinity_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["bounce_infinity_list"] = $fullAray;
				}


				if($campaign=='inbound'){
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_inbound_bounce_infinity_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["bounce_infinity_list"] = $fullAray;
				}


				$this->create_qa_bounce_infinity_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_bounce_infinity_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_qa_bounce_infinity_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_bounce_infinity_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		if($campaign=='cuemath_hygiene'){
		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Duration", "Phone", "Tagging", "Audit Type", "Auditor Type", "Voc", "Earned Score", "Possible Score", "Overall Score",
		"Did the agent greet the customer appropriately?", "Did the agent self introduce?", "Did the agent confirm the name of the customer?", "Did the agent state the purpose of the call clearly?", "Did the agent collect the required details in case of a call back?", "Was clear in communincating without fumbling/using fillers?", "Sounded low/wasnt eneregetic on call?", "Did not probe the required info to understand the query better", "Did the agent assure the customer before answering to the query?", "Sounded professional and avoided casual speech", "Maintained moderate ROS and the customer was able to understand the agent.", "Avoided interruptions and built rapport?", "Did the agent answer to queries of the customer (completely&correctly)?", "Did the agent share the right information?", "Promoted the features & benefits suggested the customer to reserve the scooter?", "Sales effort was demonstrated by the agent when the customer was skeptical about the reservation?", "Did the agent tag the case appropriately?", "Did the agent leave appropriate remarks?", "Did the agent utilise hold when required and avoided dead air?", "Did the agent place the call on hold beyond 1 min?", "Offered additional assistance?", "Thanked customer for his time.", "Was rude with the customer & disconnected the call & was abusive with the customer", "Remark 1", "Remark 2", "Remark 3", "Remark 4", "Remark 5", "Remark 6", "Remark 7", "Remark 8", "Remark 9","Remark 10", "Remark 11", "Remark 12", "Remark 13", "Remark 14", "Remark 15", "Remark 16", "Remark 17", "Remark 18", "Remark 19", "Remark 20", "Remark 21", "Remark 22", "Remark 23","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}else if($campaign=='inbound'){
		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Duration", "Phone", "CSAT VOC", "Tagging", "Audit Type", "Auditor Type", "Voc", "Earned Score", "Possible Score", "Overall Score","Did the call opening reflected an energetic positive note followed by service executive self-introduction & brand name?", "Did the service executive respond within 5 seconds of call connection?", "Did the service executive leveraged opportunities for Sales Upsell Add-Ons?", "Did the service executive asked pertinent questions to accurately diagnose customer's issue?", "Did the service executive addressed the customer with correct personalization?", "Did the service executive summarize customer's need and personalized acknowledgment apology associated with the issue?", "Did the service executive handled the call professionally and without being abrupt and or long silence on the call Idle time?", "Did the service executive used empathetic listening skills without interruption or talk over the customer?", "Did the service executive maintained proper  polite & pleasant tone with appropriate pitch volume pace during the call and avoided internal jargons?", "Did the service executive completed the call within the optimum call time while ensuring positive customer experience & Average Call Wrap (ACW) time?", "Did the service executive documented crux of the call by adding notes?", "Did the service executive put in efforts by taking all possible steps to resolve customer's issue in First Contact?", "Did the service executive followed the Hold Transfer procedure as per the protocol Hold Refresh Time-30 Seconds.", "Did the service executive informed the customer if the issue not resolved on call provided estimated timeline for resolution?", "Did the service executive checked if the customer have any other issue and offered further assistance at the end of the call?", "Did the service executive thanked the customer and closed the call with appropriate positive note?", "Did the service executive tagged QRC accurately basis the interaction?", "Did the service executive tagged correct disposition as per call scenario?", "Did the response provided by the service executive sufficiently address all the customer's issue?", "Did the service executive shared the correct and complete imformation which leads critical to business and customer experience?", "Any rude behaviour & tone Arguments with customer will lead to Zero tolerence policy", "Being a QA Are you satisfied with overall call handling", "Remark 1", "Remark 2", "Remark 3", "Remark 4", "Remark 5", "Remark 6", "Remark 7", "Remark 8", "Remark 9","Remark 10", "Remark 11", "Remark 12", "Remark 13", "Remark 14", "Remark 15", "Remark 16", "Remark 17", "Remark 18", "Remark 19", "Remark 20", "Remark 21", "Remark 22","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment" );
	   }
		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='cuemath_hygiene'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
                $row .= '"'.$user['greet_customer'].'",';
				$row .= '"'.$user['agent_self_introduce'].'",';
				$row .= '"'.$user['confirm_customer_name'].'",';
				$row .= '"'.$user['state_purpose_of_call'].'",';
				$row .= '"'.$user['collect_required_details'].'",';
				$row .= '"'.$user['communication_without_fumbling'].'",';
				$row .= '"'.$user['sounded_low_call'].'",';
				$row .= '"'.$user['understand_query'].'",';
				$row .= '"'.$user['assure_customer'].'",';
				$row .= '"'.$user['sounded_professional'].'",';
				$row .= '"'.$user['maintained_moderate_ros'].'",';
				$row .= '"'.$user['avoided_interruptions'].'",';
				$row .= '"'.$user['answer_queries'].'",';
				$row .= '"'.$user['share_right_information'].'",';
				$row .= '"'.$user['promoted_features_benefits'].'",';
				$row .= '"'.$user['customer_skeptical_reservation'].'",';
				$row .= '"'.$user['tag_case'].'",';
				$row .= '"'.$user['leave_appropriate_remarks'].'",';
				$row .= '"'.$user['utilise_hold'].'",';
				$row .= '"'.$user['place_call_hold'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
                $row .= '"'.$user['thanked_customer'].'",';
				$row .= '"'.$user['rude_with_customer'].'",';
                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';
                $row .= '"'.$user['cmt22'].'",';
                $row .= '"'.$user['cmt23'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}else if($campaign=='inbound'){

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['phone'].'",';
				$row .= '"'.$user['csat_voc'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
                $row .= '"'.$user['brand_name'].'",';
				$row .= '"'.$user['call_connection'].'",';
				$row .= '"'.$user['add_Ons'].'",';
				$row .= '"'.$user['customers_issue'].'",';
				$row .= '"'.$user['correct_personalization'].'",';
				$row .= '"'.$user['the_issue'].'",';
				$row .= '"'.$user['idle_time'].'",';
				$row .= '"'.$user['the_customer'].'",';
				$row .= '"'.$user['internal_jargons'].'",';
				$row .= '"'.$user['average_call_wrap'].'",';
				$row .= '"'.$user['adding_notes'].'",';
				$row .= '"'.$user['first_contact'].'",';
				$row .= '"'.$user['30_seconds'].'",';
				$row .= '"'.$user['for_resolution'].'",';
				$row .= '"'.$user['end_of_the_call'].'",';
				$row .= '"'.$user['positive_note'].'",';
				$row .= '"'.$user['the_interaction'].'",';
				$row .= '"'.$user['call_scenario'].'",';
				$row .= '"'.$user['sufficiently_address'].'",';
				$row .= '"'.$user['customer_experience'].'",';
				$row .= '"'.$user['tolerence_policy'].'",';
                $row .= '"'.$user['call_handling'].'",';
                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';
                $row .= '"'.$user['cmt22'].'",';
                //$row .= '"'.$user['cmt23'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';


				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}
	}


/////////////////////////////////////// BSNL //////////////////////////////////////////////
	public function qa_bsnl_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_bsnl_report.php";
			$data["content_js"] = "qa_bsnl_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";

			$campaign ="bsnl";

			$data["bsnl_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}

				if(get_role_dir()=='agent'){
					$user .="where id ='$current_user'";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_bsnl_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["bsnl_list"] = $fullAray;
				$this->create_qa_bsnl_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_bsnl_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_bsnl_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_bsnl_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Queue", "Call Type", "Sub-type of Call", "Recording Track ID", "Category", "Sap ID", "Asst. Manager", "DNIS (VDN)", "Call Date", "Call Duration", "Week", "Circle", "Phone", "Audit Type", "Auditor Type", "VOC", "Earned Score", "Possible Score","Overall Score",
			"Greeted customer and started call with smile","Remarks", "Introduced self (first name)","Remarks", "Asked callers name (first and last name)","Remarks", "Asked callers required verification questions (if any)","Remarks", "Asked caller the purpose of the call","Remarks", "Verified the purpose with the caller(paraphrase)","Remarks", "Identified the call type and identified the process to be followed","Remarks", "Identified the IT systems/tools to be used","Remarks", "Followed all process and steps/activities in sequence","Remarks", "Navigate the system without any errors (leading to increased call hold time)","Remarks", "Procured the required information from customer","Remarks", "Utilized all information and system access before escalation","Remarks", "Used approved questions /language","Remarks", "Demonstrated active listening skills","Remarks", "Used confidence and empathy wordings","Remarks", "Gave appology/reassurence/appropriate response","Remarks", "Explained hold time and dead air","Remarks", "Upheld BSNL positive image","Remarks", "Maintained focus on callers problem","Remarks", "Identify other issues raised (if any) during the call and sequenced each issue","Remarks", "Gave accurate information /next steps on each issue","Remarks", "Transferred call appropriately (if required)","Remarks", "Gave SR Number (if applicable)","Remarks", "Thanked the caller for calling","Remarks", "Waited for caller to hang up and appropriately closed the call","Remarks", "Captured accurate notes in CRM","Remarks",
			"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['agent_rvw_date']!="") $agent_rvw_date=ConvServerToLocal($user['agent_rvw_date']);
				else $agent_rvw_date="";

				if($user['mgnt_rvw_date']!="") $mgnt_rvw_date=ConvServerToLocal($user['mgnt_rvw_date']);
				else $mgnt_rvw_date="";

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_queue'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['sub_type'].'",';
				$row .= '"'.$user['record_track'].'",';
				$row .= '"'.$user['category'].'",';
				$row .= '"'.$user['sap_id'].'",';
				$row .= '"'.$user['asst_manager'].'",';
				$row .= '"'.$user['dnis'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['week'].'",';
				$row .= '"'.$user['circle'].'",';
				$row .= '"'.$user['mobile_no'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'",';
                $row .= '"'.$user['greeted_customer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['introduced_self'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['asked_callers_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['asked_verification_questions'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['purpose_of_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['verified_the_purpose'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['identified_call_type'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['identified_it_systems'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['followed_process'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['navigate_system'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['procured_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['utilized_all_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'.$user['used_approved_questions'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user['demonstrated_active'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'.$user['used_confidence_empathy'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'.$user['gave_appology'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'.$user['explained_hold_time'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'.$user['upheld_positive_image'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'.$user['maintained_focus'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				$row .= '"'.$user['identify_other_issues'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'.$user['gave_accurate_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
                $row .= '"'.$user['transferred_call'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'.$user['gave_sr_number'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'.$user['thanked_caller'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
				$row .= '"'.$user['waited_for_hangup'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'.$user['accurate_notes'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt26'])).'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$agent_rvw_date.'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$mgnt_rvw_date.'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';
				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


        }

////////////////////////////////Chariot Energy////////////////////////////////


 	public function qa_chariot_energy_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports/aside.php";
			$data["content_template"] = "reports_qa/qa_chariot_energy_report.php";
			$data["content_js"] = "qa_chariot_energy_js.php";
			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";
			$campaign = "chariot_energy";
			$data["chariot_list"] = array();

			if($this->input->get('show')=='Show')
			{

				$from_date = mmddyy2mysql($this->input->get('date_from'));
				$to_date = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$lob = $this->input->get('lob');

				if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
					$ops_cond="";
				}else{
					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
					}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
						$ops_cond=" Where assigned_to='$current_user'";
					}else{
						$ops_cond="";
					}
				}

				$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_chariot_energy_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $ops_cond order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["chariot_list"] = $fullAray;
				$this->create_qa_chariot_new_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_chariot_new_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $from_date;
			$data['date_to'] = $to_date;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_chariot_new_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_chariot_new_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign=='chariot_energy'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Type","Call Duration","Customer Name","Account/REF","Analyst","Audit Type", "Auditor Type", "Voc","Overall Score","greeting","Acknowledgement statement / Paraphrase Reason for Call","Authentication","Establish Rapport/Personalization","Listen Actively","Take Responsibility and ownership","Project enthusiastic tone and confidence","Communicate with clarity","Show appreciation and/or Attempts to save customer (when applicable)","Controls conversation/uses time efficiently","Minimizes pauses/dead air","Uses proper phone etiquette (ask permission to place on hold/proper transfer courtesies/please/thank you)","Provides accurate information","Follows appropriate process / policies","Documents customer contact in system","Offer additional assistance","Uses proper closing statement that includes Chariot brand","Did agent verify last 4 of SS# (or alternate authentication method) & Service Add?","Was this repeat interaction?","Will this contact create a repeat interaction?","Did customer seem satisfied after interaction?","Comments","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='chariot_energy'){
			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['customer_name'].'",';
				$row .= '"'.$user['account_ref'].'",';

				$row .= '"'.$user['analyst'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['greeting'].'",';
				$row .= '"'.$user['acknowledgement'].'",';
				$row .= '"'.$user['authentication'].'",';
				$row .= '"'.$user['establish_rapport'].'",';
				$row .= '"'.$user['listen_actively'].'",';
				$row .= '"'.$user['take_responsibility'].'",';
				$row .= '"'.$user['project_enthusiastic'].'",';
				$row .= '"'.$user['communicate_with_clarity'].'",';
				$row .= '"'.$user['show_appreciation'].'",';
				$row .= '"'.$user['controls_conversation'].'",';
				$row .= '"'.$user['minimizes_pauses'].'",';
				$row .= '"'.$user['proper_phone_etiquette'].'",';
				$row .= '"'.$user['provides_accurate_information'].'",';
				$row .= '"'.$user['follows_appropriate_process'].'",';
				$row .= '"'.$user['documents_customer_contact'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['proper_closing'].'",';
				$row .= '"'.$user['agent_verify'].'",';
				$row .= '"'.$user['repeat_interaction'].'",';
				$row .= '"'.$user['contact_create_repeat_interaction'].'",';
				$row .= '"'.$user['customer_seem_satisfied'].'",';
				$row .= '"'.$user['comments'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

     }


	public function qa_cinemark_report(){
		if(check_logged_in()){

		  $office_id = "";
		  $user_office_id=get_user_office_id();
		  $current_user = get_user_id();
		  $is_global_access=get_global_access();
		  $role_dir=get_role_dir();
		  $data["show_download"] = false;
		  $data["download_link"] = "";
		  $data["show_table"] = false;
		  $data["show_table"] = false;

		  $data["aside_template"] = "reports_qa/aside.php";
		  $data["content_template"] = "reports_qa/qa_cinemark_report.php";
		  $data["content_js"] = "qa_universal_js.php";
		  $date_from="";
		  $date_to="";
		  $action="";
		  $dn_link="";
		  $cond="";
		  $cond1="";

		  $data["qa_cinemark_list"] = array();
		  if($this->input->get('show')=='Show') {
			$campaign ='cinemark';
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";
			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
			  $cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
			  $cond1 .=" And assigned_to='$current_user'";
			}else{
			  $cond1 .="";
			}

			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_amd_cinemark_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";
			$fullAray = $this->Common_model->get_query_result_array($qSql);

			$data["qa_cinemark_list"] = $fullAray;
			$this->create_qa_cinemark_CSV($fullAray,$campaign);
			$dn_link = base_url()."reports_qa/download_qa_cinemark_CSV";

		  }
		  $data['location_list'] = $this->Common_model->get_office_location_list();

		  $data['download_link']=$dn_link;
		  $data["action"] = $action;
		  $data['date_from'] = $date_from;
		  $data['date_to'] = $date_to;


		  $data['office_id']=$office_id;


		  $this->load->view('dashboard',$data);
		}
    }

//////////// ///////////////////////////////
  public function download_qa_cinemark_CSV()
  {
    $currDate=date("Y-m-d");
    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $newfile="QA Cinemark Audit List-'".$currDate."'.csv";

    header('Content-Disposition: attachment;  filename="'.$newfile.'"');
    readfile($filename);
  }

  public function create_qa_cinemark_CSV($rr,$campaign)
  {

    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $fopen = fopen($filename,"w+");
    if($campaign=='cinemark'){
     $header= Array("Auditor Name","Audit Date","Call Date","Fusion ID","Agent","L1 Supervisor","Call Duration","File Number","Audit Type","VOC","Audit Start Date Time","Audit End Date Time","Interval","QA Score",
      "1.1 Did the agent greet the customer appropriately?","1.2 Did the agent provide his/her name?","1.3 Did the agent ask how/he or she could assist the caller?","2.1 Did the agent adhere to the refund rules?",
      "2.2 If the customer asked to speak to a supervisor did we transfer to an internal supervisor?","2.3 Did the agent fill out a ticket properly?","2.4 Did the agent include the theater number?",
      "2.5 Did the agent leave a correct note?","2.6 Did the agent leave the confirmation number or order number?","2.7 If a Fandango customer called in did the agent supply the correct information?",
      "2.8 Was the agent able to access customers past transactions (if applicable)?","3.1 Did the agent have an appropriate tone and use please and thank you throughout the call?",
      "3.2 Did the agent close the call correctly?","4.1 Did the agent complete all necessary tasks correctly?","4.2 Did the agent use any inappropriate language or demean the caller?",
      "4.3 Did the agent hang up on the caller?","Remarks 1","Remarks 2","Remarks 3","Remarks 4","Remarks 5","Remarks 6","Remarks 7","Remarks 8","Remarks 9","Remarks 10","Remarks 11",
      "Remarks 12","Remarks 13","Remarks 14","Remarks 15","Remarks 16","Call Summary","Feedback","Agent Feedback Acceptance","Agent review note","Agent review date",
      "Mgnt review date","Mgnt review by","Mgnt review note");
    }

    $row = "";
    foreach($header as $data) $row .= ''.$data.',';
    fwrite($fopen,rtrim($row,",")."\r\n");
    $searches = array("\r", "\n", "\r\n");

    if($campaign=='cinemark'){

      foreach($rr as $user){
         if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
          $interval1 = '---';
         }else{
          $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
         }


        $row = '"'.$user['auditor_name'].'",';
        $row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['call_date'].'",';
        $row .= '"'.$user['fusion_id'].'",';
        $row .= '"'.$user['fname']." ".$user['lname'].'",';
        $row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_duration'].'",';
        $row .= '"'.$user['file_no'].'",';
        $row .= '"'.$user['audit_type'].'",';
        $row .= '"'.$user['voc'].'",';
        $row .= '"'.$user['audit_start_time'].'",';
        $row .= '"'.$user['entry_date'].'",';
        $row .= '"'.$interval1.'",';
        $row .= '"'.$user['overall_score'].'%'.'",';

        $row .= '"'.$user['greet_customer_appropriately'].'",';
        $row .= '"'.$user['agent_provide_name'].'",';
        $row .= '"'.$user['agent_ask_how_assist'].'",';

        $row .= '"'.$user['adhere_to_refund_rules'].'",';
        $row .= '"'.$user['transfer_to_inter_super'].'",';
        $row .= '"'.$user['agent_fill_ticket'].'",';
        $row .= '"'.$user['agent_include_th_no'].'",';
        $row .= '"'.$user['agent_leave_correct_note'].'",';
        $row .= '"'.$user['agent_leave_conf_no'].'",';
        $row .= '"'.$user['agent_supply_correct_info'].'",';
        $row .= '"'.$user['agent_able_access_cust_past_transacs'].'",';
        $row .= '"'.$user['agent_appropriate_tone'].'",';
        $row .= '"'.$user['agent_close_correctly'].'",';
        $row .= '"'.$user['agent_complete_necessary_task'].'",';
        $row .= '"'.$user['agent_use_inappropriate_lang'].'",';
        $row .= '"'.$user['agent_provide_cinemark_customer_advise'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';

        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
        $row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
        $row .= '"'.$user['agent_rvw_date'].'",';
        $row .= '"'.$user['mgnt_rvw_date'].'",';
        $row .= '"'.$user['mgnt_rvw_name'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

        fwrite($fopen,$row."\r\n");
      }
      fclose($fopen);

    }
  }

   /////ffai
  public function qa_ffai_report(){
    if(check_logged_in()){

      $office_id = "";
      $user_office_id=get_user_office_id();
      $current_user = get_user_id();
      $is_global_access=get_global_access();
      $role_dir=get_role_dir();
      $data["show_download"] = false;
      $data["download_link"] = "";
      $data["show_table"] = false;
      $data["show_table"] = false;

      $data["aside_template"] = "reports_qa/aside.php";
      $data["content_template"] = "reports_qa/qa_ffai_report.php";
      $data["content_js"] = "qa_universal_js.php";
      $date_from="";
      $date_to="";
      $action="";
      $dn_link="";
      $cond="";
      $cond1="";

      $data["qa_ffai_list"] = array();
      if($this->input->get('show')=='Show') {
        $campaign ='ffai';
        $date_from = mmddyy2mysql($this->input->get('date_from'));
        $date_to = mmddyy2mysql($this->input->get('date_to'));
        $office_id = $this->input->get('office_id');

        if($office_id=="All") $cond .= "";
        else $cond .=" and office_id='$office_id'";
        if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

        if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
          $cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
        }else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
          $cond1 .=" And assigned_to='$current_user'";
        }else{
          $cond1 .="";
        }

                //Nilkanta
        if($campaign=='ffai'){
        $qSql="SELECT * from
        (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
        (select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
        (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
        (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
        (select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_amd_ffai_feedback) xx Left Join
        (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

        $fullAray = $this->Common_model->get_query_result_array($qSql);
        $data["qa_ffai_list"] = $fullAray;
          }

        $this->create_Qa_ffai_CSV($fullAray,$campaign);
        $dn_link = base_url()."reports_qa/download_Qa_ffai_CSV";


      }
      $data['location_list'] = $this->Common_model->get_office_location_list();

      $data['download_link']=$dn_link;
      $data["action"] = $action;
      $data['date_from'] = $date_from;
      $data['date_to'] = $date_to;


      $data['office_id']=$office_id;


      $this->load->view('dashboard',$data);
    }
  }


  public function download_Qa_ffai_CSV()
  {
    $currDate=date("Y-m-d");
    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $newfile="QA Craftjack Audit List-'".$currDate."'.csv";

    header('Content-Disposition: attachment;  filename="'.$newfile.'"');
    readfile($filename);
  }

  public function create_Qa_ffai_CSV($rr,$campaign)
  {

    $filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
    $fopen = fopen($filename,"w+");
    if($campaign=='ffai'){
     $header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent", "L1 Super", "Call Date", "Call Duration", "File No", "Audit Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval(In Second)", "Earn Score","Possible Score","Overall Score", "Customer Score", "Business Score", "Compliance Score", "Did the agent open the call using their name and the appropriate branding for the call?", "Remark1","Did the agent close the call using the appropriate branding?", "Remark2","Did the agent verify/confirm all necessary information and spell back email address using NATO?","Remark3", "Did agent provide consistent/accurate information regarding products and availability?","Remark4", "Did agent provide confirm shipping information/next steps/resolution of issue to ensure one call resolution?", "Remark5","Did agent accurately and clearly fill out pulse on Monday.com?","Remark6", "Was agent engaged/empathetic with customer?","Remark7", "Did agent offer membership in the Home Filter Club (if applicable)?", "Remark8","Did agent offer donation to Wine to Water?", "Remark9","Was customer satisfied/fulfilled?", "Remark10","Did agent offer the survey?", "Remark11","Use stop recording button","Remark12","Rude Remarks","Remark13","Call Avoidance / Dumping","Remark14","Compliance Score","Customer Score","Business Score","Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date", "Mgnt Review By","Mgnt Comment");
    }

    $row = "";
    foreach($header as $data) $row .= ''.$data.',';
    fwrite($fopen,rtrim($row,",")."\r\n");
    $searches = array("\r", "\n", "\r\n");

    if($campaign=='ffai'){

      foreach($rr as $user){
         if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
          $interval1 = '---';
         }else{
          $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
         }


        $row = '"'.$user['auditor_name'].'",';
        $row .= '"'.$user['audit_date'].'",';
        $row .= '"'.$user['fusion_id'].'",';
        $row .= '"'.$user['fname']." ".$user['lname'].'",';
        $row .= '"'.$user['tl_name'].'",';
        $row .= '"'.$user['call_date'].'",';
        $row .= '"'.$user['call_duration'].'",';
        $row .= '"'.$user['file_no'].'",';
        $row .= '"'.$user['audit_type'].'",';
        $row .= '"'.$user['voc'].'",';
        $row .= '"'.$user['audit_start_time'].'",';
        $row .= '"'.$user['entry_date'].'",';
        $row .= '"'.$interval1.'",';
		$row .= '"'.$user['earned_score'].'",';
		$row .= '"'.$user['possible_score'].'",';
        $row .= '"'.$user['overall_score'].'%'.'",';
        $row .= '"'.$user['customer_score_percent'].'%'.'",';
        $row .= '"'.$user['business_score_percent'].'%'.'",';
        $row .= '"'.$user['compliance_score_percent'].'%'.'",';
        $row .= '"'.$user['open_call_appropriate_branding'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
        $row .= '"'.$user['close_call_appropriate_branding'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
        $row .= '"'.$user['address_using_nato'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
        $row .= '"'.$user['products_availability'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
        $row .= '"'.$user['one_call_resolution'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
        $row .= '"'.$user['agent_accurately_clearly'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
        $row .= '"'.$user['agent_engaged_customer'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
        $row .= '"'.$user['membership'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
        $row .= '"'.$user['offer_donation'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
        $row .= '"'.$user['was_cust_sat_fulfilled'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
        $row .= '"'.$user['did_agent_offer_survey'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
		$row .= '"'.$user['use_stop_recording_button'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
		$row .= '"'.$user['rude_remarks'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
		$row .= '"'.$user['call_avoidance'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
		$row .= '"'.$user['compliance_score_percent'].'%'.'",';
		$row .= '"'.$user['customer_score_percent'].'%'.'",';
		$row .= '"'.$user['business_score_percent'].'%'.'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
        $row .= '"'.$user['agnt_fd_acpt'].'",';
        $row .= '"'.$user['agent_rvw_date'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
        $row .= '"'.$user['mgnt_rvw_date'].'",';
        $row .= '"'.$user['mgnt_rvw_name'].'",';
        $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

        fwrite($fopen,$row."\r\n");
      }
      fclose($fopen);

    }
  }
/////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////AT&T / Fiberconnect /  AT&T VERINT /  AT&T FLORIDA / COMPLIANCE///////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////

    public function qa_att_report()
	{
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_att_report.php";
			$data["content_js"] = "qa_ameridial_healthcare_js.php";
			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";
			//$campaign = "att";
			$campaign = $this->input->get('campaign');

			$data["customer_list"] = array();

			if($this->input->get('show')=='Show')
			{

				    $from_date = mmddyy2mysql($this->input->get('date_from'));
					$to_date = mmddyy2mysql($this->input->get('date_to'));
					$office_id = $this->input->get('office_id');
					$lob = $this->input->get('lob');

					if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
						$ops_cond="";
					}else{
						if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
							$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
						}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
							$ops_cond=" Where assigned_to='$current_user'";
						}else{
							$ops_cond="";
						}
					}

					$qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_".$campaign."_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $ops_cond order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["att"] = $fullAray;
				$this->create_qa_att_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_att_CSV/".$campaign;
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $from_date;
			$data['date_to'] = $to_date;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

	public function download_att_CSV($campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA ".$campaign." Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_att_CSV($rr,$campaign)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		if($campaign == 'att'){

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Type","Call Duration","Call Id","ATTUID","Register Number","LOB","Was this a first call from customer","Issue resolved","Coral Usage","Transfer Department","Fiber Offer","Sales Attempt","Audit Type","Customer Audit Type","Violation","Type of Violation","Auditor Type","VOC","Overall Score",
			"Warmly welcome","Warmly welcome Comment" ,"Call flow utilization","Call flow utilization Comment", "Acknowledge","Acknowledge Comment", "Empathy","Empathy Comment", "Reassurance","Reassurance Comment", "CPNI","CPNI Comment", "CBR","CBR Comment", "Resources Utilization","Resources Utilization Comment", "Professional Language / Communication","Professional Language / Communication Comment", "Hold & Dead air","Hold & Dead air Comment", "Fully Resolve","Fully Resolve Comment", "Transfer procedure","Transfer procedure Comment", "Recap","Recap Comment", "Next steps","Next steps Comment","Self service options","Self service options Comment", "Additional Assistance","Additional Assistance Comment", "Sincerely Thank","Sincerely Thank Comment",

			"Compliance Score","Authentication","Comment", "CPNI Compliance","Comment", "Required disclosures","Comment", "Credit Check","Comment", "Documentation","Comment", "Added to CX account without permission","Comment", "Verbal consent to use SSN","Comment", "compliance Sales","Comment", "Vulgar Offensive or sexually oriented language in communication with customers","Comment", "Derogatory references","Comment", "Rude abusive or discourteous","Comment", "Flirting or making social engagements","Comment", "Hung up on","Remarks"," Blind Transferred","Remarks", "Intentional transferring the call back to the queue","Remarks", "Intentional disseminating of inaccurate information or troubleshooting steps to release the call","Remarks", "Intentionally ignoring customer from the queue","Remarks", "Camping","Remarks", "Hold/Dead air > 4 minutes","Remarks", "Refused to escalate","Remarks", "Unauthorized access","Remarks", "Was the agent seen retaining collecting accessing and/or using customer information","Remarks", "Falsify AT&Ts or customers records","Remarks", "Misrepresent or misleading","Remarks",
			"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
			/* "Make it personal","Make it personal Comment", "Ownership","Ownership Comment", "Effective Sales Offer","Effective Sales Offer Comment", "**Sales compliance","**Sales compliance Comment", "Next call prevention","Next call prevention Comment", */

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_record_id'].'",';
				$row .= '"'.$user['attuid'].'",';
				$row .= '"'.$user['register_no'].'",';
				$row .= '"'.$user['lob'].'",';
				$row .= '"'.$user['first_call'].'",';
				$row .= '"'.$user['issue_resolved'].'",';
				$row .= '"'.$user['coral_usage'].'",';
				$row .= '"'.$user['transfer_department'].'",';
				$row .= '"'.$user['fiber_offer'].'",';
				$row .= '"'.$user['sales_attempt'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['customer_audit_type'].'",';
				$row .= '"'.$user['violation'].'",';
				$row .= '"'.$user['violation_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';

				$row .= '"'.$user['warmly_welcome'].'",';
				$row .= '"'.$user['cmt_1'].'",';
				$row .= '"'.$user['call_flow_utilization'].'",';
				$row .= '"'.$user['cmt_2'].'",';
				$row .= '"'.$user['acknowledge'].'",';
				$row .= '"'.$user['cmt_3'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['cmt_4'].'",';
				$row .= '"'.$user['reassurance'].'",';
				$row .= '"'.$user['cmt_5'].'",';
				$row .= '"'.$user['cpni'].'",';
				$row .= '"'.$user['cmt_6'].'",';
				$row .= '"'.$user['cbr'].'",';
				$row .= '"'.$user['cmt_7'].'",';
				$row .= '"'.$user['resources_utilization'].'",';
				$row .= '"'.$user['cmt_8'].'",';
				$row .= '"'.$user['professional_language'].'",';
				$row .= '"'.$user['cmt_9'].'",';
				$row .= '"'.$user['hold_dead_air'].'",';
				$row .= '"'.$user['cmt_10'].'",';
				$row .= '"'.$user['fully_resolved'].'",';
				$row .= '"'.$user['cmt_11'].'",';
				$row .= '"'.$user['transfer_procedure'].'",';
				$row .= '"'.$user['cmt_12'].'",';
				$row .= '"'.$user['recap'].'",';
				$row .= '"'.$user['cmt_13'].'",';
				$row .= '"'.$user['next_step'].'",';
				$row .= '"'.$user['cmt_14'].'",';
				$row .= '"'.$user['self_service_option'].'",';
				$row .= '"'.$user['cmt_15'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['cmt_16'].'",';
				$row .= '"'.$user['sincerely_thanks'].'",';
				$row .= '"'.$user['cmt_17'].'",';

				$row .= '"'.$user['compliance_score'].'",';
				$row .= '"'.$user['authentication'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
				$row .= '"'.$user['cpni_compliance'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
				$row .= '"'.$user['required_disclosures'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
				$row .= '"'.$user['credit_check'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
				$row .= '"'.$user['documentation'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
				$row .= '"'.$user['account_permission'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
				$row .= '"'.$user['verbal_consent'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
				$row .= '"'.$user['compliance_sales'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
				$row .= '"'.$user['communication_customers'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
				$row .= '"'.$user['derogatory_references'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
				$row .= '"'.$user['discourteous'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
				$row .= '"'.$user['social_engagements'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
				$row .= '"'.$user['hang_up'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt25'])).'",';
				$row .= '"'.$user['blind_transferred'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
				$row .= '"'.$user['intentional_transferring'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
				$row .= '"'.$user['inaccurate_information'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
				$row .= '"'.$user['intentioanlly_ignoring_customer'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
				$row .= '"'.$user['camping'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
				$row .= '"'.$user['compliance_hold_dead_air'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
				$row .= '"'.$user['refused_escalate'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
				// $row .= '"'.$user['transfer_in_scope'].'",';
				// $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
				$row .= '"'.$user['unauthorized_access'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
				$row .= '"'.$user['agent_seen_retaining_collecting'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
				$row .= '"'.$user['att_customer_records'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
				$row .= '"'.$user['misrepresent_misleading'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
				}
				fclose($fopen);
			////////////////////////////////////////

		}else if($campaign == 'fiberconnect'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Type","Call Duration","Call Id","Audit Type","Auditor Type","VOC","Overall Score",

			 "Opening",
			 "Greeting",
			 "Owner Discovery",
			 "Professionalism",
			 "Hold Procedure",
			 "Acknowledgement",
			 "Dead Air",
			 "Rebuttals",
			 "Urgency",
			 "Education regarding Change and improvement customer would get",
			 "Resolution/assistance if customer use any other provider",
			 "Discovery Probing",
			 "Product Knowledge",
			 "Correct Information",
			 "On call resolution (addressed all query of customer before taking authorization",
			 "Authorization (Customer said clear yes)",
			 "Closing",
			 "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");


			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user){
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['call_id'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';

				$row .= '"'.$user['opening'].'",';
				$row .= '"'.$user['greeting'].'",';
				$row .= '"'.$user['ownerDis'].'",';
				$row .= '"'.$user['profession'].'",';
				$row .= '"'.$user['holdProced'].'",';
				$row .= '"'.$user['acknowledg'].'",';
				$row .= '"'.$user['deadAir'].'",';
				$row .= '"'.$user['rebuttals'].'",';
				$row .= '"'.$user['urgency'].'",';
				$row .= '"'.$user['educationr'].'",';
				$row .= '"'.$user['resolut'].'",';
				$row .= '"'.$user['discove'].'",';
				$row .= '"'.$user['productKnow'].'",';
				$row .= '"'.$user['correctInfor'].'",';
				$row .= '"'.$user['oncallresol'].'",';
				$row .= '"'.$user['authorization'].'",';
				$row .= '"'.$user['closing'].'",';

                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

		}else if($campaign == 'att_verint')
		{
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration","Audit Type","Auditor Type","VOC","Audit Start Time","Entry Date","Possible Score","Earn Score","Overall Score",
			"Proper Greeting",
			"PIR/Willingness to Assist",
			"Caring and Engaged Overall feel Tone of call",
			"Personalization",
			"Acknowledgement Empathy",
			"Professionalism Language",
			"Identify Need",
			"Ownership",
			"Problem Solving",
			"Verification",
			"Correctly Completed Request",
			"Setting Expectations",
			"Educate on MyATT Apps",
			"Recap Check for Understanding",
			"Additional Assistance Closing Question",
			"Appreciation",
			"Rudeness Disrespect Condescending Tone Disconnects  etc",
			"Call Avoidance",
			"Complete Verification",
			"Notation",
			"Correct Tagging Yes Should tag on active CTN",
			"Select NO here if the agent missed any Zero Tolerance questions above",
			"Followed Process Procedure Steps Non-FCR impacting",
			"PCN",
			"Silence Hold Policy",
			"Transfer Guidelines",
			"Notes",
			"Call Resolution",
			"Reason for Non Resolution",
			"Used MyCSP",
			"Main Reason for Calling",
			"Other Issues",
			"Account Type",
			"Welcome Comment",
			"Personalize Comment",
			"Own Resolve Comment",
			"Educate Comment",
			"Gain Agreement Comment",
			"Appreciate Comment",
			"Zero Tolerance Comment",
			"Adherence to Policy Comment",


			"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

				$row = "";
				foreach($header as $data) $row .= ''.$data.',';
				fwrite($fopen,rtrim($row,",")."\r\n");
				$searches = array("\r", "\n", "\r\n");

				foreach($rr as $user)
				{
					if($user['entry_by']!=''){
						$auditorName = $user['auditor_name'];
					}else{
						$auditorName = $user['client_name'];
					}

					if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
						$interval1 = '---';
					}else{
						$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
					}

					$row = '"'.$auditorName.'",';
					$row .= '"'.$user['audit_date'].'",';
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
					$row .= '"'.$user['fusion_id'].'",';
					$row .= '"'.$user['tl_name'].'",';
					$row .= '"'.$user['call_date'].'",';
					$row .= '"'.$user['call_duration'].'",';
					$row .= '"'.$user['audit_type'].'",';
					$row .= '"'.$user['auditor_type'].'",';
					$row .= '"'.$user['voc'].'",';
					$row .= '"'.$user['audit_start_time'].'",';
					$row .= '"'.$user['entry_date'].'",';
					$row .= '"'.$user['possible_score'].'",';
					$row .= '"'.$user['earned_score'].'",';
					// $row .= '"'.$interval1.'",';
					$row .= '"'.$user['overall_score'].'%'.'",';
					$row .= '"'.$user['proper_greeting'].'",';
					$row .= '"'.$user['willingness_assist'].'",';
					$row .= '"'.$user['caring_engaged'].'",';
					$row .= '"'.$user['personalization'].'",';
					$row .= '"'.$user['acknowledgement'].'",';
					$row .= '"'.$user['professionalism'].'",';
					$row .= '"'.$user['identify_need'].'",';
					$row .= '"'.$user['ownership'].'",';
					$row .= '"'.$user['problem_solving'].'",';
					$row .= '"'.$user['verification'].'",';
					$row .= '"'.$user['correctly_completed_request'].'",';
					$row .= '"'.$user['setting_expectations'].'",';
					$row .= '"'.$user['educate_ATT'].'",';
					$row .= '"'.$user['check_understanding'].'",';
					$row .= '"'.$user['additional_assistance'].'",';
					$row .= '"'.$user['appreciation'].'",';
					$row .= '"'.$user['rudeness'].'",';
					$row .= '"'.$user['call_avoidance'].'",';
					$row .= '"'.$user['complete_verification'].'",';
					$row .= '"'.$user['notation'].'",';
					$row .= '"'.$user['correct_tagging'].'",';
					$row .= '"'.$user['select_NO'].'",';
					$row .= '"'.$user['followed_process'].'",';
					$row .= '"'.$user['pcn'].'",';
					$row .= '"'.$user['silence_policy'].'",';
					$row .= '"'.$user['transfer_guidelines'].'",';
					$row .= '"'.$user['notes'].'",';
					$row .= '"'.$user['call_resolution'].'",';
					$row .= '"'.$user['reason_non_resolution'].'",';
					$row .= '"'.$user['used_myCSP'].'",';
					$row .= '"'.$user['reason_calling'].'",';
					$row .= '"'.$user['other_issue'].'",';
					$row .= '"'.$user['account_type'].'",';
					$row .= '"'.$user['welcome_comment'].'",';
					$row .= '"'.$user['personalize_comment	'].'",';
					$row .= '"'.$user['resolve_offer_comment'].'",';
					$row .= '"'.$user['educate_comment'].'",';
					$row .= '"'.$user['gain_agreement_comment'].'",';
					$row .= '"'.$user['appreciate_comment'].'",';
					$row .= '"'.$user['zero_tolerance_comment'].'",';
					$row .= '"'.$user['adherence_policy_comment'].'",';

					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
					$row .= '"'.$user['agnt_fd_acpt'].'",';
					$row .= '"'.$user['agent_rvw_date'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
					$row .= '"'.$user['mgnt_rvw_date'].'",';
					$row .= '"'.$user['mgnt_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
					$row .= '"'.$user['client_rvw_date'].'",';
					$row .= '"'.$user['client_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

	   }else if($campaign == 'att_florida'){
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Phone","Call Duration","Audit Type","Auditor Type","VOC","Audit Start Time","Entry Date","Possible Score","Earn Score","Overall Score",
			"Warmly Welcome",
			"Call flow utilization",
			"Make it personal",
			"Acknowledge",
			"Empathy",
			"Reassurance",
			"Ownership",
			"CPNI",
			"Blank",
			"Resources Utilization",
			"Professional Language  Communication",
			"Hold & Dead air",
			"Effective Sales Offer",
			"Sales compliance",
			"Fully resolve",
			"Transfer procedure",
			"Recap",
			"Next call prevention",
			"Self service options",
			"Additional Assistance",
			"Sincerely Thank",
			"Greet Comment",
			"Understand Comment",
			"Recommend Comment",
			"Resolve Comment",
			"Confirm Educate Comment",
			"Positive Close Comment",

			 "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['phone_number'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['warmly_welcome'].'",';
				$row .= '"'.$user['call_flow_utilization'].'",';
				$row .= '"'.$user['make_personal'].'",';
				$row .= '"'.$user['acknowledge'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['reassurance'].'",';
				$row .= '"'.$user['ownership'].'",';
				$row .= '"'.$user['cpni'].'",';
				$row .= '"'.$user['na'].'",';
				$row .= '"'.$user['resources_utilization'].'",';
				$row .= '"'.$user['professional_language'].'",';
				$row .= '"'.$user['hold_dead_air'].'",';
				$row .= '"'.$user['effective_sales_offer'].'",';
				$row .= '"'.$user['sales_compliance'].'",';
				$row .= '"'.$user['fully_resolve'].'",';
				$row .= '"'.$user['transfer_procedure'].'",';
				$row .= '"'.$user['recap'].'",';
				$row .= '"'.$user['next_call_prevention'].'",';
				$row .= '"'.$user['self_service_options'].'",';
				$row .= '"'.$user['additional_assistance'].'",';
				$row .= '"'.$user['sincerely_thank'].'",';
				$row .= '"'.$user['greet_comment'].'",';
				$row .= '"'.$user['understand_comment'].'",';
				$row .= '"'.$user['recommend_comment'].'",';
				$row .= '"'.$user['resolve_comment'].'",';
				$row .= '"'.$user['confirm_educate_comment'].'",';
				$row .= '"'.$user['positive_close_comment'].'",';


				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

	   }else if($campaign == 'att_compliance'){

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Phone","Call Duration","Audit Type","Auditor Type","VOC","Audit Start Time","Audit End Time","Interval(in sec)",
			"Authentication","Comment", "CPNI","Comment", "Required disclosures","Comment", "Credit Check","Comment", "Documentation","Comment", "Added to CX account without permission","Comment", "Verbal consent to use SSN","Comment", "Sales compliance","Comment", "Vulgar Offensive or sexually oriented language in communication with customers","Comment", "Derogatory references","Comment", "Rude abusive or discourteous","Comment", "Flirting or making social engagements","Comment", "Hung up on or blind transferred","Remarks", "Intentional transferring the call back to the queue","Remarks", "Intentional disseminating of inaccurate information or troubleshooting steps to release the call","Remarks", "Intentionally ignoring customer from the queue","Remarks", "Camping","Remarks", "Hold/Dead air > 4 minutes","Remarks", "Refused to escalate","Remarks", "Transfer/Reassign/Redirect - in-scope","Remarks", "Unauthorized access","Remarks", "Was the agent seen retaining collecting accessing and/or using customer information","Remarks", "Falsify AT&Ts or customers records","Remarks", "Misrepresent or misleading","Remarks",
			"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

				$row = "";
				foreach($header as $data) $row .= ''.$data.',';
				fwrite($fopen,rtrim($row,",")."\r\n");
				$searches = array("\r", "\n", "\r\n");

				foreach($rr as $user)
				{
					if($user['entry_by']!=''){
						$auditorName = $user['auditor_name'];
					}else{
						$auditorName = $user['client_name'];
					}

					if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
						$interval1 = '---';
					}else{
						$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
					}

					$row = '"'.$auditorName.'",';
					$row .= '"'.$user['audit_date'].'",';
					$row .= '"'.$user['fname']." ".$user['lname'].'",';
					$row .= '"'.$user['fusion_id'].'",';
					$row .= '"'.$user['tl_name'].'",';
					$row .= '"'.$user['call_date'].'",';
					$row .= '"'.$user['phone_number'].'",';
					$row .= '"'.$user['call_duration'].'",';
					$row .= '"'.$user['audit_type'].'",';
					$row .= '"'.$user['auditor_type'].'",';
					$row .= '"'.$user['voc'].'",';
					$row .= '"'.$user['audit_start_time'].'",';
					$row .= '"'.$user['entry_date'].'",';
					$row .= '"'.$interval1.'",';
					$row .= '"'.$user['authentication'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
					$row .= '"'.$user['cpni'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
					$row .= '"'.$user['required_disclosures'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
					$row .= '"'.$user['credit_check'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
					$row .= '"'.$user['documentation'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
					$row .= '"'.$user['account_permission'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
					$row .= '"'.$user['verbal_consent'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
					$row .= '"'.$user['sales_compliance'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
					$row .= '"'.$user['communication_customers'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
					$row .= '"'.$user['derogatory_references'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
					$row .= '"'.$user['discourteous'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
					$row .= '"'.$user['social_engagements'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
					$row .= '"'.$user['blind_transferred'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
					$row .= '"'.$user['intentional_transferring'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
					$row .= '"'.$user['inaccurate_information'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
					$row .= '"'.$user['intentioanlly_ignoring_customer'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
					$row .= '"'.$user['camping'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
					$row .= '"'.$user['hold_dead_air'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
					$row .= '"'.$user['refused_escalate'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
					$row .= '"'.$user['transfer_in_scope'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt20'])).'",';
					$row .= '"'.$user['unauthorized_access'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt21'])).'",';
					$row .= '"'.$user['agent_seen_retaining_collecting'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt22'])).'",';
					$row .= '"'.$user['att_customer_records'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt23'])).'",';
					$row .= '"'.$user['misrepresent_misleading'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt24'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
					$row .= '"'.$user['agnt_fd_acpt'].'",';
					$row .= '"'.$user['agent_rvw_date'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
					$row .= '"'.$user['mgnt_rvw_date'].'",';
					$row .= '"'.$user['mgnt_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
					$row .= '"'.$user['client_rvw_date'].'",';
					$row .= '"'.$user['client_rvw_name'].'",';
					$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
	   }

	}
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// AT&T VERINT //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
// public function qa_attverint_report()
// {
// 	if(check_logged_in()){
// 		$user_office_id=get_user_office_id();
// 		$current_user = get_user_id();
// 		$is_global_access=get_global_access();
// 		$role_dir=get_role_dir();
// 		$data["show_download"] = false;
// 		$data["download_link"] = "";
// 		$data["show_table"] = false;
// 		$data["show_table"] = false;
// 		$data["aside_template"] = "reports_qa/aside.php";
// 		$data["content_template"] = "reports_qa/qa_attverint_report.php";
// 		$data["content_js"] = "qa_grille_evaluation_js.php";

// 		$data['location_list'] = $this->Common_model->get_office_location_list();

// 		$office_id = "";
// 		$date_from="";
// 		$date_to="";
// 		$audit_type="";
// 		$campaign="";
// 		$action="";
// 		$dn_link="";
// 		$cond="";
// 		$cond1="";

// 		$data["qa_attverint_list"] = array();

// 		if($this->input->get('show')=='Show')
// 		{
// 			$date_from = mmddyy2mysql($this->input->get('date_from'));
// 			$date_to = mmddyy2mysql($this->input->get('date_to'));
// 			$office_id = $this->input->get('office_id');
// 			$audit_type = $this->input->get('audit_type');

// 			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

// 			if($office_id=="All") $cond .= "";
// 			else $cond .=" and office_id='$office_id'";

// 			if($audit_type=="All"){
// 				if(get_login_type()=="client"){
// 					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
// 				}else{
// 					$cond .= "";
// 				}
// 			}else{
// 				$cond .=" and audit_type='$audit_type'";
// 			}

// 			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
// 				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
// 			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
// 				$cond1 .=" And assigned_to='$current_user'";
// 			}else{
// 				$cond1 .="";
// 			}


// 			$qSql="SELECT * from
// 			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
// 			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
// 			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
// 			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
// 			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_att_verint_feedback) xx Left Join
// 			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

// 			$fullAray = $this->Common_model->get_query_result_array($qSql);
// 			$data["qa_attverint_list"] = $fullAray;
// 			$this->create_qa_attverint_CSV($fullAray,);
// 			$dn_link = base_url()."reports_qa/download_qa_attverint_CSV/";
// 		}

// 			$data['download_link']=$dn_link;
// 			$data["action"] = $action;
// 			$data['date_from'] = $date_from;
// 			$data['date_to'] = $date_to;
// 			$data['office_id']=$office_id;
// 			$data['audit_type']=$audit_type;

// 			$this->load->view('dashboard',$data);
// 	}
// }


// public function download_qa_attverint_CSV()
// {
// 	$currDate=date("Y-m-d");
// 	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
// 	$newfile="QA AT&T VERINT Audit List-'".$currDate."'.csv";
// 	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
// 	readfile($filename);
// }

// public function create_qa_attverint_CSV($rr)
// {
// 	$currDate=date("Y-m-d");
// 	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
// 	$fopen = fopen($filename,"w+");

// 		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Call Type","Call Duration","Call Id","Audit Type","Auditor Type","VOC","Overall Score",
// 		"Proper Greeting",
// 		"PIR/Willingness to Assist",
// 		"Caring and Engaged Overall feel Tone of call",
// 		"Personalization",
// 		"Acknowledgement Empathy",
// 		"Professionalism Language",
// 		"Identify Need",
// 		"Ownership",
// 		"Problem Solving",
// 		"Verification",
// 		"Correctly Completed Request",
// 		"Setting Expectations",
// 		"Educate on MyATT Apps",
// 		"Recap Check for Understanding",
// 		"Additional Assistance Closing Question",
// 		"Appreciation",
// 		"Rudeness Disrespect Condescending Tone Disconnects  etc",
// 		"Call Avoidance",
// 		"Complete Verification",
// 		"Notation",
// 		"Correct Tagging Yes Should tag on active CTN",
// 		"Select NO here if the agent missed any Zero Tolerance questions above",
// 		"Followed Process Procedure Steps Non-FCR impacting",
// 		"PCN",
// 		"Silence Hold Policy",
// 		"Transfer Guidelines",
// 		"Notes",
// 		"Call Resolution",
// 		"Reason for Non Resolution",
// 		"Used MyCSP",
// 		"Main Reason for Calling",
// 		"Other Issues",
// 		"Account Type",

// 		 "Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

// 			$row = "";
// 			foreach($header as $data) $row .= ''.$data.',';
// 			fwrite($fopen,rtrim($row,",")."\r\n");
// 			$searches = array("\r", "\n", "\r\n");

// 			foreach($rr as $user)
// 			{
// 				if($user['entry_by']!=''){
// 					$auditorName = $user['auditor_name'];
// 				}else{
// 					$auditorName = $user['client_name'];
// 				}

// 				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
// 					$interval1 = '---';
// 				}else{
// 					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
// 				}

// 				$row = '"'.$auditorName.'",';
// 				$row .= '"'.$user['audit_date'].'",';
// 				$row .= '"'.$user['fname']." ".$user['lname'].'",';
// 				$row .= '"'.$user['fusion_id'].'",';
// 				$row .= '"'.$user['tl_name'].'",';
// 				$row .= '"'.$user['call_date'].'",';
// 				$row .= '"'.$user['call_duration'].'",';
// 				$row .= '"'.$user['audit_type'].'",';
// 				$row .= '"'.$user['auditor_type'].'",';
// 				$row .= '"'.$user['voc'].'",';
// 				$row .= '"'.$user['audit_start_time'].'",';
// 				$row .= '"'.$user['entry_date'].'",';
// 				$row .= '"'.$user['earned_score'].'",';
// 				$row .= '"'.$user['possible_score'].'",';
// 				// $row .= '"'.$interval1.'",';
// 				$row .= '"'.$user['overall_score'].'%'.'",';
// 				$row .= '"'.$user['proper_greeting'].'",';
// 				$row .= '"'.$user['willingness_assist'].'",';
// 				$row .= '"'.$user['caring_engaged'].'",';
// 				$row .= '"'.$user['personalization'].'",';
// 				$row .= '"'.$user['acknowledgement'].'",';
// 				$row .= '"'.$user['professionalism'].'",';
// 				$row .= '"'.$user['identify_need'].'",';
// 				$row .= '"'.$user['ownership'].'",';
// 				$row .= '"'.$user['problem_solving'].'",';
// 				$row .= '"'.$user['verification'].'",';
// 				$row .= '"'.$user['correctly_completed_request'].'",';
// 				$row .= '"'.$user['setting_expectations'].'",';
// 				$row .= '"'.$user['educate_ATT'].'",';
// 				$row .= '"'.$user['check_understanding'].'",';
// 				$row .= '"'.$user['additional_assistance'].'",';
// 				$row .= '"'.$user['appreciation'].'",';
// 				$row .= '"'.$user['rudeness'].'",';
// 				$row .= '"'.$user['call_avoidance'].'",';
// 				$row .= '"'.$user['complete_verification'].'",';
// 				$row .= '"'.$user['notation'].'",';
// 				$row .= '"'.$user['correct_tagging'].'",';
// 				$row .= '"'.$user['select_NO'].'",';
// 				$row .= '"'.$user['followed_process'].'",';
// 				$row .= '"'.$user['pcn'].'",';
// 				$row .= '"'.$user['silence_policy'].'",';
// 				$row .= '"'.$user['transfer_guidelines'].'",';
// 				$row .= '"'.$user['notes'].'",';
// 				$row .= '"'.$user['call_resolution'].'",';
// 				$row .= '"'.$user['reason_non_resolution'].'",';
// 				$row .= '"'.$user['used_myCSP'].'",';
// 				$row .= '"'.$user['reason_calling'].'",';
// 				$row .= '"'.$user['other_issue'].'",';
// 				$row .= '"'.$user['account_type'].'",';
// 				$row .= '"'.$user['welcome_comment'].'",';
// 				$row .= '"'.$user['personalize_comment	'].'",';
// 				$row .= '"'.$user['resolve_offer_comment'].'",';
// 				$row .= '"'.$user['educate_comment'].'",';
// 				$row .= '"'.$user['gain_agreement_comment'].'",';
// 				$row .= '"'.$user['appreciate_comment'].'",';
// 				$row .= '"'.$user['zero_tolerance_comment'].'",';
// 				$row .= '"'.$user['adherence_policy_comment'].'",';

// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
// 				$row .= '"'.$user['agnt_fd_acpt'].'",';
// 				$row .= '"'.$user['agent_rvw_date'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
// 				$row .= '"'.$user['mgnt_rvw_date'].'",';
// 				$row .= '"'.$user['mgnt_rvw_name'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
// 				$row .= '"'.$user['client_rvw_date'].'",';
// 				$row .= '"'.$user['client_rvw_name'].'",';
// 				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

// 				fwrite($fopen,$row."\r\n");
// 			}
// 			fclose($fopen);

// 	//}
// }

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// ACC Audit//////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

public function qa_acc_report()
{



	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_acc_report.php";
		//$data["content_js"] = "qa_grille_evaluation_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["content_js"] = "qa_idfc_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

	 	$campaign = $this->input->get('campaign');
        $show=$this->input->get('show');
		$data["qa_acc_list"] = array();
		
		if($show=='Show' &&	$campaign =='1')
		{
 		$date_from = mmddyy2mysql($this->input->get('date_from'));
		 	$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
		 	$audit_type = $this->input->get('audit_type');


			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_acc_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
      $data["qa_acc_list"] = $fullAray;
      $this->create_qa_acc_CSV($fullAray);
      $dn_link = base_url()."reports_qa/download_qa_acc_CSV/";
$data['campaign']=$campaign;
      ////////////////////////////}//////////////////////////////////////////
      $data['download_link']=$dn_link;
      $data["action"] = $action;
      $data['date_from'] = $date_from;
      $data['date_to'] = $date_to;
      $data['office_id']=$office_id;
      $data['audit_type']=$audit_type;
      //$data['campaign']=$campaign;
      $this->load->view('dashboard',$data);

    }else if ($show=='Show' &&	$campaign =='2'){
////////////////////////////// new one
//	$data["qa_accs_list"] = array();
$date_from = mmddyy2mysql($this->input->get('date_from'));
$date_to = mmddyy2mysql($this->input->get('date_to'));
$office_id = $this->input->get('office_id');

if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

if($office_id=="All") $cond .= "";
else $cond .=" and office_id='$office_id'";

if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
  $cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
  $cond1 .=" And assigned_to='$current_user'";
}else{
  $cond1 .="";
}


$qSql="SELECT * from
(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
(select d.description from department d left join signin sd on d.id=sd.dept_id where sd.id=entry_by) as auditor_dept,
(select r.name from role r left join signin sr on r.id=sr.role_id where sr.id=entry_by) as auditor_role,
(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_acc_new_feedback) xx
Left Join (Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

$fullAray = $this->Common_model->get_query_result_array($qSql);


 $data["qa_acc_list"]=$fullAray;

  //print_r($fullAray);
//  $_session['qa_acc_list']=$fullAray;


  $this->create_qa_accs_CSV($fullAray);
  $dn_link = base_url()."qa_acc/download_qa_accs_CSV"; //     important link









$data['campaign']=$campaign;


  $data['download_link']=$dn_link;
  $data["action"] = $action;
  $data['date_from'] = $date_from;
  $data['date_to'] = $date_to;


$this->load->view('dashboard',$data);

  //$data['office_id']=$office_id;
  //$data['campaign']=$campaign;
  //$this->load->view('dashboard',$data);
  /////////////////////////////new one
}else{
$data['campaign']=$campaign;


  $data['download_link']=$dn_link;
  $data["action"] = $action;
  $data['date_from'] = $date_from;
  $data['date_to'] = $date_to;

$this->load->view('dashboard',$data);
}

	}

///////////////////////////////old
}

////////////////////////////////////////////////////22 december

public  function download_qa_accs_CSV() // testing sougata
{
  $currDate=date("Y-m-d");

  $filename = "./qa_files/qa_accs/Report".get_user_id().".csv";
  $newfile="QA accs  List-'".$currDate."'.csv";
  header('Content-Disposition: attachment;  filename="'.$newfile.'"');
  readfile($filename);
}









public function create_qa_accs_CSV($rr)
{






  $currDate=date("Y-m-d");


  $filename = FCPATH . "qa_files/qa_accs/Report".get_user_id().".csv";
  $fopen = fopen($filename,"w+");


  $header = array("Auditor Name", "Audit Date ", "Agent Name "," Infraction  ","Infraction Reason", "Fusion ID ", "L1 Supervisor ", "Call Date ", "Audit Type ", "Type of Auditor ","Call ID ", "Earned Score ", "Possible Score ", "Overall Score % ",  "VOC","Interaction Initial Call","Interaction Follow Up 1","Interaction Follow Up 2","Phone No ","Sales","Disposition","UCID", "Opening","Opening Reason", "Greeting ","Greeting Reason", "Owner Discovery", "Owner Discovery Reason","Professionalism","Professionalism Reason","Rebuttals", "Rebuttals  Reason", "Urgency","Urgency Reason ",  "Education regarding Change and improvement customer would get","Education regarding Change and improvement customer would get Reason ", "On call resolution","On call resolution Reason ", "Probing Question","Probing Question Reason ","Product Knowledge","Product Knowledge Reason ", "Resolution/Assistance if customer use any other provider	","Resolution/Assistance if customer use any other provider	Reason ", "Contract Prompt","Contract Prompt Reason "," closing  ", "closing reason","Correct Information","Correct Information Reason ","Audit Start date and  Time ", "Audit End Date and  Time"," Call Interval",  "Call Summary ","Feedback ","Agent Feedback Status ", "Feedback Acceptance","Agent Review Date","Management Review Date ", "Management Review Name ","Management Review Note", "Client Review Name","Client Review Note","Client Review Date " );




  $row = "";
  foreach($header as $data) $row .= ''.$data.',';
  fwrite($fopen,rtrim($row,",")."\r\n");
  $searches = array("\r", "\n", "\r\n");



    foreach($rr as $user)
    {
      if($user['entry_by']!=''){
        $auditorName = $user['auditor_name'];
      }else{
        $auditorName = $user['client_name'];
      }

      if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
        $interval1 = '---';
      }else{
        $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
      }







      $row = '"'.$auditorName.'",';
      $row .= '"'.$user['audit_date'].'",';
      $row .= '"'.$user['fname']." ".$user['lname'].'",';
      $row .= '"'.$user['form_submits'].'",';
       $row .= '"'.$user['extra'].'",';
      $row .= '"'.$user['fusion_id'].'",';
      $row .= '"'.$user['tl_name'].'",';
      $row .= '"'.$user['call_date'].'",';
      $row .= '"'.$user['audit_type'].'",';
      $row .= '"'.$user['auditor_type'].'",';

      $row .= '"'.$user['call_id'].'",';
      $row .= '"'.$user['earned_score'].'",';
      $row .= '"'.$user['possible_score'].'",';

      $row .= '"'.$user['overall_score'].'"% ,';

      $row .= '"'.$user['voc'].'",';
$row .= '"'.$user['Initial'].'",';
$row .= '"'.$user['up1'].'",';
$row .= '"'.$user['up2'].'",';
$row .= '"'.$user['phone_no'].'",';
$row .= '"'.$user['sales'].'",';
$row .= '"'.$user['Disposition'].'",';
$row .= '"'.$user['UCID'].'",';
$row .= '"'.$user['Opening'].'",';
$row .= '"'.$user['Opening_reason'].'",';
$row .= '"'.$user['Greeting'].'",';
  $row .= '"'.$user['Greeting_reason'].'",';
$row .= '"'.$user['Discovery'].'",';
$row .= '"'.$user['Discovery_reason'].'",';
$row .= '"'.$user['Professionalism'].'",';
$row .= '"'.$user['Professionalism_reason'].'",';
$row .= '"'.$user['Rebuttals'].'",';
$row .= '"'.$user['Rebuttals_reason'].'",';
$row .= '"'.$user['Urgency'].'",';
$row .= '"'.$user['Urgency_reason'].'",';



$row .= '"'.$user['Education'].'",';
$row .= '"'.$user['Education_reason'].'",';
  $row .= '"'.$user['Resolution'].'",';
$row .= '"'.$user['Resolution_reason'].'",';
$row .= '"'.$user['Probing'].'",';
$row .= '"'.$user['Probing_reason'].'",';
$row .= '"'.$user['Knowledge'].'",';
$row .= '"'.$user['Knowledge_reason'].'",';

$row .= '"'.$user['assistance'].'",';
$row .= '"'.$user['assistance_reason'].'",';
$row .= '"'.$user['prompt'].'",';
  $row .= '"'.$user['prompt_reason'].'",';
$row .= '"'.$user['Closing'].'",';
$row .= '"'.$user['Closing_reason'].'",';
$row .= '"'.$user['Information'].'",';
$row .= '"'.$user['Information_reason'].'",';



      $row .= '"'.$user['audit_start_time'].'",';
      $row .= '"'.$user['entry_date'].'",';
      $row .= '"'.$interval1.'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
      $row .= '"'.$user['agnt_fd_acpt'].'",';

      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
      $row .= '"'.$user['agent_rvw_date'].'",';
      $row .= '"'.$user['mgnt_rvw_date'].'",';
      $row .= '"'.$user['mgnt_rvw_name'].'",';

      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';




      $row .= '"'.$user['client_rvw_name'].'",';
      $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

      $row .= '"'.$user['client_rvw_date'].'",';




      fwrite($fopen,$row."\r\n");
    }
    fclose($fopen);


  }










/////////////////////////////////////////////////////22  december





public function download_qa_acc_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA ACC Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_acc_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");


	$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Disposition", "Call Duration", "UCID","Audit Type","Auditor Type", "VOC","Infraction","Reason", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

	"Introduction -Did the agent mention his/her name on call and also branded the call",
	"Remark 1",
	"Did the agent confirm the Account information?",
	"Remark 2",
	"Empathy- Advisor shown empathy or appology when and where required Also advisors intonation was proper on call	",
	"Remark 3",
	"Did the agent overlapped or interruped the customer while he/she was speaking or Did the agent showed good listening skills on call?",
	"Remark 4",
	"Communication skills Sentense formation Gramatical error  pronounciation etc",
	"Remark 5",
	"Dead air",
	"Remark 6",
	"Agent provided the correct information about the currect service?",
	"Remark 7",
	"Probing - Did agent probed well to understand customer query and provide right information",
	"Remark 8",
	"Hold Verbiage - Did the agent asked permission to put the call on hold ? & after resuming agent should thank the customer",
	"Remark 9",
	"Mandatory Information",
	"Remark 10",
	"Proper Education",
	"Remark 11",
	"The agent makes good use of FAQs to rebuttal any possible sale when applicable",
	"Remark 12",
	"Did the agent asked for further assistance on call",
	"Remark 13",
	"Properly Closing - Advisor thanked the customer and closed the call properly",
	"Remark 14",
	"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['ucid'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['infraction'].'",';
			$row .= '"'.$user['rsn'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			// $row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			$row .= '"'.$user['warmly_welcome'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'.$user['call_flow_utilization'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'.$user['acknowledge'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'.$user['reassurance'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'.$user['cpni'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'.$user['cbr'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'.$user['resources_utilization'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'.$user['professional_language'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'.$user['hold_dead_air'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'.$user['fully_resolved'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'.$user['transfer_procedure'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'.$user['recap'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'.$user['next_step'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

}












////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Day Dreams //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_daydreams_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_daydreams_report.php";
		$data["content_js"] = "qa_grille_evaluation_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_daydreams_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_daydreams_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_daydreams_list"] = $fullAray;
			$this->create_qa_daydreams_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_daydreams_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_daydreams_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Day Dreams Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_daydreams_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	//if($campaign == 'grille_evaluation'){
		//////////////////////////////////////////////

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Presentation du conseiller  Presentation de sa societe  Identification de son interlocuteur",
			"Presentation adaptee de l objet de l appel  accroche du prospect",
			"Traitement de barrage",
			"Phase CNIL  Bloctel",
			"Questionnement pertinent cible adapte et suffisant info collectee suffisante pour apporter une reponse correcte au prospect",
			"Ecoute et creation d echange",
			"maitrise argument et Traitement objections",
			"Presentation de l offre",
			"Valorisation de l offre",
			"Obligation des repas",
			"ecoutes du client",
			"Capacite a creer l echange et a projeter le client vers des vacances",
			"Traiter les objections explicites du client",
			"Trouver l objection fondamentale du client et la traiter dont objection implicite",
			"Si REFUS  Proposer une offre de repli de maniere adaptee. Si VENTE et campagne avec VA  Proposer une vente additionnelle",
			"Valider que le client accepte l offre presentee",
			"explication claire du comment qa marche reception choix reservation utilisation",
			"Expliquer au client la suite donnee pour concretiser l accord + confirmation des coordonnees postales et email",
			"respect du process de prise de commande CBK",
			"Transmettre coordonnees commande et RC client",
			"Prendre conge de maniere ouverte",
			"S autoevaluer  identifier ses points forts et axes de travail",
			"S engager sur ses preedents PA",
			"Resilience resister et rebondir",
			"Savoir convaincre",
			"Offre saisie conforme  l offre vendue",
			"Conformite legale",
			"Satisfaction du client",
			"Techniques de vente",
			"IS 7  Attitude commerciale",
			"Langage simple precis et efficace",
			"L indisponibilite du client n est pas prise en compte et a entraine son refus categorique  la fiche ne pourra plus etre traitee",
			"Vente ou tentative de vente fallacieuse Promesse commerciale irrealisable",
			"Le client a subi une incivilit",
			"Mise en attente non conforme dlai trop lent sans faire patienter le client  pas de remerciement  la fin de l attente",
			"Introduction Comment",
			"Decouverte Comment",
			"Proposition Comment",
			"Argumenter Comment",
			"Evaluation Comment",
			"Conformite Comment",
			"Technique Comment",
			"Bonus Comment",
			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['presentation_conseiller'].'",';
				$row .= '"'.$user['presentation_adaptee'].'",';
				$row .= '"'.$user['traitement'].'",';
				$row .= '"'.$user['phase_cnil'].'",';
				$row .= '"'.$user['questionnement'].'",';
				$row .= '"'.$user['ecoute'].'",';
				$row .= '"'.$user['maitrise'].'",';
				$row .= '"'.$user['presentation_offre'].'",';
				$row .= '"'.$user['valorisation'].'",';
				$row .= '"'.$user['obligation'].'",';
				$row .= '"'.$user['ecoutes'].'",';
				$row .= '"'.$user['capacite'].'",';
				$row .= '"'.$user['traiter_les'].'",';
				$row .= '"'.$user['trouver'].'",';
				$row .= '"'.$user['si_refus'].'",';
				$row .= '"'.$user['valider_que'].'",';
				$row .= '"'.$user['explication'].'",';
				$row .= '"'.$user['expliquer'].'",';
				$row .= '"'.$user['respect'].'",';
				$row .= '"'.$user['transmettre'].'",';
				$row .= '"'.$user['prendre_conge'].'",';
				$row .= '"'.$user['autoevaluer'].'",';
				$row .= '"'.$user['engager_sur'].'",';
				$row .= '"'.$user['resilience'].'",';
				$row .= '"'.$user['savoir_convaincre'].'",';
				$row .= '"'.$user['offre_saisie'].'",';
				$row .= '"'.$user['conformite'].'",';
				$row .= '"'.$user['satisfaction'].'",';
				$row .= '"'.$user['techniques_vente'].'",';
				$row .= '"'.$user['attitude'].'",';
				$row .= '"'.$user['langage_simple'].'",';
				$row .= '"'.$user['indisponibilite'].'",';
				$row .= '"'.$user['vente'].'",';
				$row .= '"'.$user['le_client'].'",';
				$row .= '"'.$user['mise_attente'].'",';
				$row .= '"'.$user['introduction_comment'].'",';
				$row .= '"'.$user['decouverte_comment'].'",';
				$row .= '"'.$user['proposition_comment'].'",';
				$row .= '"'.$user['argumenter_comment'].'",';
				$row .= '"'.$user['evaluation_comment'].'",';
				$row .= '"'.$user['conformite_comment'].'",';
				$row .= '"'.$user['technique_comment'].'",';
				$row .= '"'.$user['bonus_comment'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

	//}
}
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// GRID AIFI //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_gridaifi_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_gridaifi_report.php";
		$data["content_js"] = "qa_grille_evaluation_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_gridaifi_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_grid_aifi_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_gridaifi_list"] = $fullAray;
			$this->create_qa_gridaifi_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_gridaifi_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_gridaifi_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA GRID AIFIs Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_gridaifi_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$currentURL = base_url();
	$controller = "qa_grid_aifi";
	$edit_url = "add_edit_grid_aifi";
	$main_url =  $currentURL.''.$controller.'/'.$edit_url;
	$fopen = fopen($filename,"w+");

	//if($campaign == 'grille_evaluation'){
		//////////////////////////////////////////////

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Audit Type","Auditor Type", "VOC","Audit Link", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Did the advisor select the correct product ?",
			"Did the advisor select the correct number of items ?",
			"Did the advisor review the session from the beginning ?",
			"Did the advisor compare the products in the Planogram with the video ?",
			"Did the advisor check if there is a missing product ?",
			"Iteams Comment",

			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}
				$main_urls = $main_url.'/'.$user['id'];
				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['correct_product'].'",';
				$row .= '"'.$user['correct_numberitems'].'",';
				$row .= '"'.$user['review_session'].'",';
				$row .= '"'.$user['compare_products'].'",';
				$row .= '"'.$user['missing_product'].'",';
				$row .= '"'.$user['items_comment'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

	//}
}

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// PAYTAIL //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_paytail_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_paytail_report.php";
		//$data["content_js"] = "qa_grille_evaluation_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["content_js"] = "qa_idfc_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_paytail_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_paytail_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_paytail_list"] = $fullAray;
			$this->create_qa_paytail_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_paytail_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_paytail_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA PAYTAIL Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_paytail_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	//if($campaign == 'grille_evaluation'){
		//////////////////////////////////////////////

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Product Name","Customer VOC","Customer Sub VOC","Campaign Name","Objections","Phone","Agent Disposition","QA Disposition","Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Call Opening",
			"Call Closing",
			"Purpose and O/S Amount",
			"Probing",
			"Negotiation",
			"Urgency Creation",
			"Tone & Pace",
			"Dead air & Hold",
			"Language",
			"Personalisation",
			"Soft Skills",
			"Objection Handling",
			"Right party verification",
			"Complete & Correct Information",
			"Documentation",
			"Behaviour on Call",
			"Integrity",
			"Call Disc Comment",
			"Call Opening Comment",
			"Call Closing Comment",
			"Purpose and O/S Amount Comment",
			"Probing Comment",
			"Negotiation Comment",
			"Urgency Creation Comment",
			"Tone & Pace Comment",
			"Dead air & Hold Comment",
			"Language Comment",
			"Personalisation Comment",
			"Soft Skills Comment",
			"Objection Handling Comment",
			"Right party verification Comment",
			"Complete & Correct Information Comment",
			"Documentation Comment",
			"Behaviour on Call Comment",
			"Integrity Comment",
			"Call Disc Comment",

			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['product_name'].'",';
				$row .= '"'.$user['customer_voc'].'",';
				$row .= '"'.$user['customer_sub_voc'].'",';
				$row .= '"'.$user['campaign_name'].'",';
				$row .= '"'.$user['objections'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['qa_disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['call_closing'].'",';
				$row .= '"'.$user['purpose_amount'].'",';
				$row .= '"'.$user['probing'].'",';
				$row .= '"'.$user['negotiation'].'",';
				$row .= '"'.$user['urgency_creation'].'",';
				$row .= '"'.$user['tone_pace'].'",';
				$row .= '"'.$user['dead_air_hold'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['personalisation'].'",';
				$row .= '"'.$user['soft_skills'].'",';
				$row .= '"'.$user['objection_handling'].'",';
				$row .= '"'.$user['right_party_verification'].'",';
				$row .= '"'.$user['complete_correct_information'].'",';
				$row .= '"'.$user['documentation'].'",';
				$row .= '"'.$user['behaviour_call'].'",';
				$row .= '"'.$user['integrity'].'",';
				$row .= '"'.$user['call_disc'].'",';
				$row .= '"'.$user['call_opening_cmnt'].'",';
				$row .= '"'.$user['call_closing_cmnt'].'",';
				$row .= '"'.$user['purpose_amount_cmnt'].'",';
				$row .= '"'.$user['probing_cmnt'].'",';
				$row .= '"'.$user['negotiation_cmnt'].'",';
				$row .= '"'.$user['urgency_creation_cmnt'].'",';
				$row .= '"'.$user['tone_pace_cmnt'].'",';
				$row .= '"'.$user['dead_air_hold_cmnt'].'",';
				$row .= '"'.$user['language_cmnt'].'",';
				$row .= '"'.$user['personalisation_cmnt'].'",';
				$row .= '"'.$user['soft_skills_cmnt'].'",';
				$row .= '"'.$user['objection_handling_cmnt'].'",';
				$row .= '"'.$user['rightparty_verification_cmnt'].'",';
				$row .= '"'.$user['completecorrect_information_cmnt'].'",';
				$row .= '"'.$user['documentation_cmnt'].'",';
				$row .= '"'.$user['behaviour_call_cmnt'].'",';
				$row .= '"'.$user['integrity_cmnt'].'",';
				$row .= '"'.$user['call_disc_cmnt'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

}

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Pine Labs- Outbound //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_pinelabs_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_pinelabs_report.php";
		//$data["content_js"] = "qa_grille_evaluation_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["content_js"] = "qa_idfc_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_pinelabs_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_pinelabs_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_pinelabs_list"] = $fullAray;
			$this->create_qa_pinelabs_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_pinelabs_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_pinelabs_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Pine Labs Outbound Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_pinelabs_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");


		//////////////////////////////////////////////

			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Product Name", "Customer VOC","Customer Sub VOC", "Campaign Name","Objections","Email ID","Phone","Agent Disposition","QA Disposition","ACPT","ACPT 1 Remarks","ACPT 2 Remarks","Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Call Opening",
			"Call Opening Comment",
			"Call Closing",
			"Call Closing Comment",
			"Purpose and O/S Amount",
			"Purpose and O/S Amount Comment",
			"Probing",
			"Probing Comment",
			"Negotiation",
			"Negotiation Comment",
			"Urgency Creation",
			"Urgency Creation Comment",
			"Tone & Pace",
			"Tone & Pace Comment",
			"Dead air & Hold",
			"Dead air & Hold Comment",
			"Language",
			"Language Comment",
			"Personalisation",
			"Personalisation Comment",
			"Objection Handling",
			"Objection Handling Comment",
			"Right party verification",
			"Right party verification Comment",
			"Complete & Correct Information",
			"Complete & Correct Information Comment",
			"Documentation",
			"Documentation Comment",
			"Behaviour on Call",
			"Behaviour on Call Comment",
			"Integrity",
			"Integrity Comment",
			"Call Disconnection",
			"Call Disc Comment",

			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['product_name'].'",';
				$row .= '"'.$user['customer_voc'].'",';
				$row .= '"'.$user['customer_sub_voc'].'",';
				$row .= '"'.$user['campaign_name'].'",';
				$row .= '"'.$user['objections'].'",';
				$row .= '"'.$user['email'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['qa_disposition'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['acpt1'].'",';
				$row .= '"'.$user['acpt2'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';

				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['call_opening_cmnt'].'",';
				$row .= '"'.$user['call_closing'].'",';
				$row .= '"'.$user['call_closing_cmnt'].'",';
				$row .= '"'.$user['purpose_amount'].'",';
				$row .= '"'.$user['purpose_amount_cmnt'].'",';
				$row .= '"'.$user['probing'].'",';
				$row .= '"'.$user['probing_cmnt'].'",';
				$row .= '"'.$user['negotiation'].'",';
				$row .= '"'.$user['negotiation_cmnt'].'",';
				$row .= '"'.$user['urgency_creation'].'",';
				$row .= '"'.$user['urgency_creation_cmnt'].'",';
				$row .= '"'.$user['tone_pace'].'",';
				$row .= '"'.$user['tone_pace_cmnt'].'",';
				$row .= '"'.$user['dead_air_hold'].'",';
				$row .= '"'.$user['dead_air_hold_cmnt'].'",';
				$row .= '"'.$user['language'].'",';
				$row .= '"'.$user['language_cmnt'].'",';
				$row .= '"'.$user['personalisation'].'",';
				$row .= '"'.$user['personalisation_cmnt'].'",';
				$row .= '"'.$user['objection_handling'].'",';
				$row .= '"'.$user['objection_handling_cmnt'].'",';
				$row .= '"'.$user['right_party_verification'].'",';
				$row .= '"'.$user['rightparty_verification_cmnt'].'",';
				$row .= '"'.$user['complete_correct_information'].'",';
				$row .= '"'.$user['completecorrect_information_cmnt'].'",';
				$row .= '"'.$user['documentation'].'",';
				$row .= '"'.$user['documentation_cmnt'].'",';
				$row .= '"'.$user['behaviour_call'].'",';
				$row .= '"'.$user['behaviour_call_cmnt'].'",';
				$row .= '"'.$user['integrity'].'",';
				$row .= '"'.$user['integrity_cmnt'].'",';
				$row .= '"'.$user['call_disc'].'",';
				$row .= '"'.$user['call_disc_cmnt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

}

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// MOBIKWIK //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_mobikwik_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_mobikwik_report.php";
		//$data["content_js"] = "qa_grille_evaluation_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["content_js"] = "qa_idfc_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		$campaign = $this->input->get('campaign');

		$data["qa_mobikwik_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(SELECT r.folder as designation FROM `signin` sd
			LEFT JOIN role r ON sd.role_id=r.id
			where sd.id=agent_id) as designation,
			(SELECT r.name as roleName FROM `signin` sr
			LEFT JOIN role r ON sr.role_id=r.id
			where sr.id=agent_id) as roleName,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_mobikwik_list"] = $fullAray;
			$this->create_qa_mobikwik_CSV($fullAray,$campaign);
			$dn_link = base_url()."reports_qa/download_qa_mobikwik_CSV/".$campaign;
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_mobikwik_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA ". $campaign."  Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_mobikwik_CSV($rr, $campaign)
{
	$currDate=date("Y-m-d");
	date_default_timezone_set('Asia/Kolkata');
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	if($campaign == 'mobikwik'){


			$header = array("Auditor Name", "Audit Date", "User Name","Designation", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Customer VOC","Objections","Email ID","Phone","Agent Disposition","QA Disposition","ACPT","ACPT 1 Remarks","ACPT 2 Remarks","Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Interval (in sec)", "Earned Score", "Possible Score","Overall Score",

			"Call Opening",
			"Call Opening Comment",
			"Verify any of the two details for verification from the list",
			"Verification Comment",
			"Understanding of user concern",
			"Concern Comment",
			"System Check for Previously Raised Complaint",
			"Raised Complaint Comment",
			"Problem Resolution",
			"Resolution Comment",
			"Escalation Matrix",
			"Matrix Comment",
			"Ask for further assistance",
			"Assistance Comment",
			"Follow complete closing script",
			"Complete Comment",
			"Pitch Disclaimer",
			"Disclaimer Comment",
			"Remarks",
			"Remarks Comment",
			"Disposition",
			"Disposition Comment",
			"Be polite with customer/Agent hangup",
			"Hangup Comment",
			"Dead air",
			"Dead air Comment",
			"Attentiveness",
			"Attentiveness Comment",
			"Speak Clearly",
			"Speak Clearly Comment",
			"Empathize /Apologize if required",
			"Empathize Comment",
			"Hold guidelines should be followed	",
			"Guidelines Comment",
			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			$desig = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				if($user['roleName'] == 'QA Auditor' || $user['roleName'] == 'QA Specialist' || $user['roleName'] == 'Quality Analyst'){
					$desig = 'QA';
				}else{
					$desig = strtoupper($user['designation']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$desig.'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				//$row .= '"'.$user['product_name'].'",';
				$row .= '"'.$user['customer_voc'].'",';
				//$row .= '"'.$user['customer_sub_voc'].'",';
				//$row .= '"'.$user['campaign_name'].'",';
				$row .= '"'.$user['objections'].'",';
				$row .= '"'.$user['email'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['agent_disposition'].'",';
				$row .= '"'.$user['qa_disposition'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['acpt1'].'",';
				$row .= '"'.$user['acpt2'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$interval1.'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['call_opening_cmnt'].'",';
				$row .= '"'.$user['verification'].'",';
				$row .= '"'.$user['verification_cmnt'].'",';
				$row .= '"'.$user['concern'].'",';
				$row .= '"'.$user['concern_cmnt'].'",';
				$row .= '"'.$user['raised_complaint'].'",';
				$row .= '"'.$user['raised_complaint_cmnt'].'",';
				$row .= '"'.$user['resolution'].'",';
				$row .= '"'.$user['resolution_cmnt'].'",';
				$row .= '"'.$user['matrix'].'",';
				$row .= '"'.$user['matrix_cmnt'].'",';
				$row .= '"'.$user['assistance'].'",';
				$row .= '"'.$user['assistance_cmnt'].'",';
				$row .= '"'.$user['complete'].'",';
				$row .= '"'.$user['complete_cmnt'].'",';
				$row .= '"'.$user['disclaimer'].'",';
				$row .= '"'.$user['disclaimer_cmnt'].'",';
				$row .= '"'.$user['remarks'].'",';
				$row .= '"'.$user['remarks_cmnt'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['disposition_cmnt'].'",';
				$row .= '"'.$user['hangup'].'",';
				$row .= '"'.$user['hangup_cmnt'].'",';
				$row .= '"'.$user['dead_air'].'",';
				$row .= '"'.$user['dead_air_cmnt'].'",';
				$row .= '"'.$user['attentiveness'].'",';
				$row .= '"'.$user['attentiveness_cmnt'].'",';
				$row .= '"'.$user['speak_clearly'].'",';
				$row .= '"'.$user['speak_clearly_cmnt'].'",';
				$row .= '"'.$user['empathize'].'",';
				$row .= '"'.$user['empathize_cmnt'].'",';
				$row .= '"'.$user['guidelines'].'",';
				$row .= '"'.$user['guidelines_cmnt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

}else if($campaign == 'mobikwikemail'){
	$header = array("Auditor Name", "Audit Date", "User Name","Designation", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Customer VOC","Objections","Email ID","Phone","Agent Disposition","QA Disposition","ACPT","ACPT 1 Remarks","ACPT 2 Remarks","Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

	"Did the advisor greet and personalized on email wherever required",
	"Call Opening Comment",
	"Did the Advisor understand the customer query concern used relevant probing",
	"Query Objection Comment",
	"Did Advisor edit  use relevant canned responses?",
	"Responses Comment",
	"Did the Advisor provide correct complete information to resolve customers query concern?",
	"Advisor Comment",
	"Did the advisor check previously raised complaint or escalate the concern to dedicated team on email sheet",
	"Complaint Comment",
	"Did the Advisor use Empathy Apology and acknowledgement of query or complaint",
	"Empathy Comment",
	"Did the Advisor make personalize Email",
	"Personalize Comment",
	"Did the Advisor use accurate Sentence formation Grammar Punctuation Tenses Spellings avoid usage of jargons & correct choice of words?",
	"Grammar Comment",
	"Repeat response  did the advisor use same content as per the trail email Case got reopen due to wrong response shared by agent",
	"Trail Email Comment",
	"Did the Advisor use the correct disposition Tagging and category as per the conversation?",
	"Conversation Comment",
	"Did the Advisor inform the correct TAT?",
	"Correct TAT Comment",
	"Did the Advisor close the email properly followed the closing procedure",
	"Email Properly Comment",
	"No instance of email avoidance or wrong practice followed?",
	"Avoidance Comment",
	"The Advisor was professional during email",
	"Professional Comment",

	"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
	$row = "";
	$desig = "";
	foreach($header as $data) $row .= ''.$data.',';
	fwrite($fopen,rtrim($row,",")."\r\n");
	$searches = array("\r", "\n", "\r\n");

	foreach($rr as $user)
	{
		if($user['entry_by']!=''){
			$auditorName = $user['auditor_name'];
		}else{
			$auditorName = $user['client_name'];
		}

		if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
			$interval1 = '---';
		}else{
			$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
		}
		if($user['roleName'] == 'QA Auditor' || $user['roleName'] == 'QA Specialist' || $user['roleName'] == 'Quality Analyst')
		{
			$desig = 'QA';

		}else{
			$desig = strtoupper($user['designation']);
		}

		$row = '"'.$auditorName.'",';
		$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
		$row .= '"'.$user['fname']." ".$user['lname'].'",';
		$row .= '"'.$desig.'",';
		$row .= '"'.$user['fusion_id'].'",';
		$row .= '"'.$user['tl_name'].'",';
		$row .= '"'.ConvServerToLocal($user['call_date']).'",';
		$row .= '"'.ConvServerToLocal($user['call_duration']).'",';
		//$row .= '"'.$user['product_name'].'",';
		$row .= '"'.$user['customer_voc'].'",';
		//$row .= '"'.$user['customer_sub_voc'].'",';
		//$row .= '"'.$user['campaign_name'].'",';
		$row .= '"'.$user['objections'].'",';
		$row .= '"'.$user['email'].'",';
		$row .= '"'.$user['customer_phone'].'",';
		$row .= '"'.$user['agent_disposition'].'",';
		$row .= '"'.$user['qa_disposition'].'",';
		$row .= '"'.$user['acpt'].'",';
		$row .= '"'.$user['acpt1'].'",';
		$row .= '"'.$user['acpt2'].'",';
		$row .= '"'.$user['audit_type'].'",';
		$row .= '"'.$user['auditor_type'].'",';
		$row .= '"'.$user['voc'].'",';
		$row .= '"'.ConvServerToLocal($user['audit_start_time']).'",';
		$row .= '"'.ConvServerToLocal($user['entry_date']).'",';
		$row .= '"'.$user['earned_score'].'",';
		$row .= '"'.$user['possible_score'].'",';
		// $row .= '"'.$interval1.'",';
		$row .= '"'.$user['overall_score'].'%'.'",';
		$row .= '"'.$user['call_opening'].'",';
		$row .= '"'.$user['call_opening_cmnt'].'",';
		$row .= '"'.$user['query_objection'].'",';
		$row .= '"'.$user['query_objection_cmnt'].'",';
		$row .= '"'.$user['responses'].'",';
		$row .= '"'.$user['responses_cmnt'].'",';
		$row .= '"'.$user['advisor'].'",';
		$row .= '"'.$user['advisor_cmnt'].'",';
		$row .= '"'.$user['complaint'].'",';
		$row .= '"'.$user['complaint_cmnt'].'",';
		$row .= '"'.$user['empathy'].'",';
		$row .= '"'.$user['empathy_cmnt'].'",';
		$row .= '"'.$user['personalize'].'",';
		$row .= '"'.$user['personalize_cmnt'].'",';
		$row .= '"'.$user['grammar'].'",';
		$row .= '"'.$user['grammar_cmnt'].'",';
		$row .= '"'.$user['trail_email'].'",';
		$row .= '"'.$user['trail_email_cmnt'].'",';
		$row .= '"'.$user['conversation'].'",';
		$row .= '"'.$user['conversation_cmnt'].'",';
		$row .= '"'.$user['correct_TAT'].'",';
		$row .= '"'.$user['correct_TAT_cmnt'].'",';
		$row .= '"'.$user['email_properly'].'",';
		$row .= '"'.$user['email_properly_cmnt'].'",';
		$row .= '"'.$user['avoidance'].'",';
		$row .= '"'.$user['avoidance_cmnt'].'",';
		$row .= '"'.$user['professional'].'",';
		$row .= '"'.$user['professional_cmnt'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
		$row .= '"'.$user['agnt_fd_acpt'].'",';
		$row .= '"'.$user['agent_rvw_date'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
		$row .= '"'.$user['mgnt_rvw_date'].'",';
		$row .= '"'.$user['mgnt_rvw_name'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
		$row .= '"'.$user['client_rvw_date'].'",';
		$row .= '"'.$user['client_rvw_name'].'",';
		$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

		fwrite($fopen,$row."\r\n");
	}
	fclose($fopen);

}
}

///////////////////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Maalomatia //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_maalomatia_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_maalomatia_report.php";
		//$data["content_js"] = "qa_grille_evaluation_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["content_js"] = "qa_idfc_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_maalomatia_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_maalomatia_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_maalomatia_list"] = $fullAray;
			$this->create_qa_maalomatia_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_maalomatia_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_maalomatia_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Maalomatia Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_maalomatia_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");


			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Objections","Email ID","Phone","Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Call Opening",
			"Call Opening Comment",
			"Word Choice",
			"Word Choice Comment",
			"Effective Speaking and Script Adherence",
			"Effective Speaking Comment",
			"Tone of Voice",
			"Tone Voice Comment",
			"Empathy and De escalation",
			"Empathy Comment",
			"Control the call",
			"Control Call Comment",
			"Active listening and Comprehension",
			"Comprehension Comment",
			"Hold Transfer Process Followed",
			"Transfer Process Comment",
			"Personalization",
			"Personalization Comment",
			"Closing",
			"Closing Comment",
			"Resolution Knowledge  Effectiveness position",
			"Resolution Comment",
			"Ownership",
			"Ownership Comment",
			"Professionalism",
			"Professionalism Comment",
			"Customer Profile",
			"Customer Profile Comment",
			"Ticket Creation and Status",
			"Ticket Creation Comment",
			"Ticket Type and Categorization",
			"Categorization Comment",
			"Ticket Description",
			"Description Comment",
			"Case History",
			"Case History Comment",
			"Ticket Assignment",
			"Ticket Assignment Comment",
			"Avoided Escalation/Ticket",
			"Avoided Escalation Comment",
			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['objections'].'",';
				$row .= '"'.$user['email'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['call_opening_cmnt'].'",';
				$row .= '"'.$user['word_choice'].'",';
				$row .= '"'.$user['word_choice_cmnt'].'",';
				$row .= '"'.$user['effective_speaking'].'",';
				$row .= '"'.$user['effective_speaking_cmnt'].'",';
				$row .= '"'.$user['tone_voice'].'",';
				$row .= '"'.$user['tone_voice_cmnt'].'",';
				$row .= '"'.$user['empathy'].'",';
				$row .= '"'.$user['empathy_cmnt'].'",';
				$row .= '"'.$user['control_call'].'",';
				$row .= '"'.$user['control_call_cmnt'].'",';
				$row .= '"'.$user['active_listening'].'",';
				$row .= '"'.$user['active_listening_cmnt'].'",';
				$row .= '"'.$user['transfer_process'].'",';
				$row .= '"'.$user['transfer_process_cmnt'].'",';
				$row .= '"'.$user['personalization'].'",';
				$row .= '"'.$user['personalization_cmnt'].'",';
				$row .= '"'.$user['closing'].'",';
				$row .= '"'.$user['closing_cmnt'].'",';
				$row .= '"'.$user['resolution'].'",';
				$row .= '"'.$user['resolution_cmnt'].'",';
				$row .= '"'.$user['ownership'].'",';
				$row .= '"'.$user['ownership_cmnt'].'",';
				$row .= '"'.$user['professionalism'].'",';
				$row .= '"'.$user['professionalism_cmnt'].'",';
				$row .= '"'.$user['customer_profile'].'",';
				$row .= '"'.$user['customer_profile_cmnt'].'",';
				$row .= '"'.$user['ticket_creation'].'",';
				$row .= '"'.$user['ticket_creation_cmnt'].'",';
				$row .= '"'.$user['categorization'].'",';
				$row .= '"'.$user['categorization_cmnt'].'",';
				$row .= '"'.$user['description'].'",';
				$row .= '"'.$user['description_cmnt'].'",';
				$row .= '"'.$user['case_history'].'",';
				$row .= '"'.$user['case_history_cmnt'].'",';
				$row .= '"'.$user['assignment'].'",';
				$row .= '"'.$user['assignment_cmnt'].'",';
				$row .= '"'.$user['avoided_escalation'].'",';
				$row .= '"'.$user['avoided_escalation_cmnt'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

}

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Heaps Outbound //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_heaps_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_heaps_report.php";
		//$data["content_js"] = "qa_grille_evaluation_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["content_js"] = "qa_idfc_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_heaps_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_heaps_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_heaps_list"] = $fullAray;
			$this->create_qa_heaps_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_heaps_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_heaps_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Heaps Outbound Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_heaps_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");


			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Campaign","Phone","Call Type","Call Disconnect By","Disposition associate","Audit Type","Auditor Type", "Disposition QA","VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Did the agent open the call correctly within 5 secs self intro hospital name & RPC confirmation?",
			"Remarks 1",
			"Did the agent pitch the call recording disclaimer?",
			"Remarks 2",
			"Did the service executive sound confident energetic and enthusiastic throughout the interaction with the customer?",
			"Remarks 3",
			"Did the service executive listen actively without interrupting the customer & Provide appropriate acknowledgment during the interaction?",
			"Remarks 4",
			"Did the service executive handled the interaction professionally with proper tone pitch volume & rate of speech and pace throughout the interaction?",
			"Remarks 5",
			"Did agent created the opportunity to hold the customer to avoid reschedule?",
			"Remarks 6",
			"Did agent grabbed the customer interest and utilised the eqaul opportunity?",
			"Remarks 7",
			"Did agent probed for all the right set of questions to complete the form?",
			"Remarks 8",
			"Did the agent pitched 90 day program/previous call detail discussed?",
			"Remarks 9",
			"Did the agent asked symptom list if all symptoms are asked",
			"Remarks 10",
			"Did the service executive probe other queries  including mild symptoms?",
			"Remarks 11",
			"Did the service executive effectively handled customers objection on sales & service with appropriate rebuttals?",
			"Remarks 12",
			"Empathised apologises whenver required",
			"Remarks 13",
			"Agent gave closing with the proper script.",
			"Remarks 14",
			"Polite and Professionalism",
			"Remarks 15",
			"Complete and correct notes updation (Readmission case ? correctly documented? Patient leakage ? Physician escalation raised ?",
			"Remarks 16",
			"Appropriate Call Notes Documentation?",
			"Remarks 17",
			"Mortality Documented correctly?",
			"Remarks 18",
			"Physician escalation closed?",
			"Remarks 19",
			"Rating taken/Compliments recorded?",
			"Remarks 20",
			"Call avoidance/Immediate call back after disconnection",
			"Remarks 21",
			"Being a QA Are you satisfied with overall call handling (Good (YES)/ Average(NA) / Poor(NO))",
			"Remarks 22",
			"From QA standpoint If the interaction less than 100% then as per ACPT where we could have improved?",
			"Remarks 23",
			"Voice of Customer",
			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['campaign'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['call_type'].'",';
				$row .= '"'.$user['call_disconnect'].'",';
				$row .= '"'.$user['disposition'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['qa_dispo'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['agent_pitch'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['sound_confident'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['listen_actively'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['service_executive'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['agent_created'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['agent_grabbed'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['agent_probed'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['pitched_90'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['symptom_list'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['service_probe'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['effectively'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['empathised'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['closing_agent'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['polite_professionalism'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['correct_notes'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['appropriate_call'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['mortality'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['physician'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['rating_compliments'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['call_avoidance'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'.$user['rating'].'",';
				$row .= '"'.$user['cmt22'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['voice_cust'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

}

///////////////////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Actyv AI Audit //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_actyvAI_report()
{
	if(check_logged_in()){
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_actyvAI_report.php";
		//$data["content_js"] = "qa_grille_evaluation_js.php";
		//$data["content_js"] = "qa_metropolis_js.php";
		$data["content_js"] = "qa_idfc_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_actyvAI_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_actyvAI_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_actyvAI_list"] = $fullAray;
			$this->create_qa_actyvAI_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_actyvAI_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_actyvAI_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Actyv AI Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_actyvAI_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");


			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Registered No", "Ticket No", "Call Disconnect By", "Phone","Audit Type","Auditor Type", "Tagging/Disposition", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Standard Call Opening Greeting With Company Name Right Party Confirmation",
			"Remark1",
			"Appropriate Empathy/Apology Wherever Applicable / Professional Tone / Assurance",
			"Remark2",
			"Personalization & Connect",
			"Remark3",
			"Ros/Clarity Of Speech / Jargons",
			"Remark4",
			"Active Listening/Attentive On Call",
			"Remark5",
			"Interruption & Parallel Talking",
			"Remark6",
			"Closing On Call",
			"Remark7",
			"HMT",
			"TRemark8",
			"Effective Probing open / close ended questiones to be asked whenever required",
			"Remark9",
			"Sequential Probing",
			"Remark10",
			"Polite Denial",
			"Remark11",
			"Polite Handover",
			"Remark12",
			"Agent Shared The Correct/Complete Information",
			"Remark13",
			"All Product Features Mentioned.",
			"Remark14",
			"Whether All The Information Collected And Recorded Properly",
			"Remark15",
			"Update The Vertical/Lob Issue Category & Sub Category/ Issue Category Reason/Order Id Or Transaction Id If Any",
			"Remark16",
			"Policy And Procedure Followed By The Agent As Per Ztp Rude And Profanity Etc",
			"Remark17",

			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");
			$row = "";
			foreach($header as $data) $row .= ''.$data.',';
			fwrite($fopen,rtrim($row,",")."\r\n");
			$searches = array("\r", "\n", "\r\n");

			foreach($rr as $user)
			{
				if($user['entry_by']!=''){
					$auditorName = $user['auditor_name'];
				}else{
					$auditorName = $user['client_name'];
				}

				if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
					$interval1 = '---';
				}else{
					$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
				}

				$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['call_duration'].'",';
				//$row .= '"'.$user['email'].'",';
				$row .= '"'.$user['reg_no'].'",';
				$row .= '"'.$user['ticket_no'].'",';
				$row .= '"'.$user['call_disconnect'].'",';
				$row .= '"'.$user['customer_phone'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['tagging'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['audit_start_time'].'",';
				$row .= '"'.$user['entry_date'].'",';
				$row .= '"'.$user['earned_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				// $row .= '"'.$interval1.'",';
				$row .= '"'.$user['overall_score'].'%'.'",';
				$row .= '"'.$user['call_opening'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['assurance'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['personalization'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['clarity_speech'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['attentive_call'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['interruption'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['call_closing'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['hmt'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['questiones'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['sequential'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['polite_denial'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['handover'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['complete_info'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['product_features'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['information'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['transaction'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['rude_profanity'].'",';
				$row .= '"'.$user['cmt17'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);

}

///////////////////////////////////////////////////////////////////////////////////////////////////


public function qa_telaidqa_report()
	{
		if(check_logged_in())
		{
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_telaidqa_report.php";
			$data["content_js"] = "qa_grille_evaluation_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			//$campaign = $this->input->get('campaign');

			$data["qa_telaidqa_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_telaidqa_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_telaidqa_list"] = $fullAray;
				$this->create_qa_telaidqa_CSV($fullAray,);
				$dn_link = base_url()."reports_qa/download_qa_telaidqa_CSV/";
			}

				$data['download_link']=$dn_link;
				$data["action"] = $action;
				$data['date_from'] = $date_from;
				$data['date_to'] = $date_to;
				$data['office_id']=$office_id;
				$data['audit_type']=$audit_type;
				//$data['campaign']=$campaign;
				$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_telaidqa_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Telaid IB Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_telaidqa_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_telaid";
		$edit_url = "add_edit_final_telaid";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		//if($campaign == 'grille_evaluation'){
			//////////////////////////////////////////////
			$header = array("Auditor Name",
			"Audit Date",
			"Call Date",
			"Agent Id",
			// "Fusion ID",
			"L1 Supervisor",
			"CSR Name:",
			"Team Manager:",
			
			"Reviewed By:",
			"ACPT",
			"Call Duration",
			"Audit Type",
			"Auditor Type",
			"VOC",
			"Audit Link",
			"Overall Score",
			"Possible Score",
			"Earn Score",
			"Escalate ticket to the correct level Notify PM via email if necessary",
			"Direct the technician to previous Service Analyst/Technical Analyst upon request.",
			"Send a message to SDMGC for any notification and request follow-up.",
			"Make complete and concise documentation on the note field.",
			"Properly tie the correct PRJ ID to its parent ticket.",
			"Make a separate documentation segment for disconnected calls and callbacks.",
			"Refrain from any negative or derogatory comments about customers fellow employees or services within their case notes.",
			"Leave notes in the ticket.",
			"Review previous ticket notes",
			"Provide closure notes survey and close task upon completion.",
			"Mention TelAid in the recommended spiels during opening and closing of the call.",
			"Deliver ghost spiel",
			"Verify the caller's name location (city state and store type) and contact information (callback number).",
			"Provide accurate information from PRJ/SOW in ticket.",
			"Employ accurate and logical probing questions to uncover call drivers.",
			"Offer additional assistance",
			"Acknowledge and respond to the callers emotional statements or tone while actively controlling the interaction.",
			"Maintain a friendly confident and professional tone of voice throughout the interaction.",
			"Listen actively during the interaction.",
			"MAdvise caller accurately about ticket status next steps and relevant time frames.",
			"Follow proper hold procedures and mute expectations.",
			"Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13",
			"Remark 14","Remark 15","Remark 16","Remark 17","Remark 18","Remark 19","Remark 20","Remark 21",
			"Call Summary",
			"Feedback",
			"Audit Start Time",
			"Agent review date",
			"Agent review note",
			"Mgnt review date",
			"Mgnt review by",
			"Mgnt review note");

			 $row = "";
		   foreach($header as $data) $row .= ''.$data.',';
		   fwrite($fopen,rtrim($row,",")."\r\n");
		   $searches = array("\r", "\n", "\r\n");

		   foreach($rr as $user)
		   {
			   if($user['entry_by']!=''){
				   $auditorName = $user['auditor_name'];
			   }else{
				   $auditorName = $user['client_name'];
			   }

			   if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				   $interval1 = '---';
			   }else{
				   $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			   }
			   $main_urls = $main_url.'/'.$user['id'];

			    $row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';


				$row .= '"'.$user['csr'].'",';
				$row .= '"'.$user['team_manager'].'",';
				// $row .= '"'.$user['case_topic'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['necessary'].'",';
				$row .= '"'.$user['request'].'",';
				$row .= '"'.$user['follow_up'].'",';
				$row .= '"'.$user['field'].'",';
				$row .= '"'.$user['ticket'].'",';
				$row .= '"'.$user['callbacks'].'",';
				$row .= '"'.$user['notes'].'",';
				$row .= '"'.$user['Leave'].'",';
				$row .= '"'.$user['Review'].'",';
				$row .= '"'.$user['completion'].'",';
				$row .= '"'.$user['CALL1'].'",';
				$row .= '"'.$user['CALL2'].'",';
				$row .= '"'.$user['CALL3'].'",';
				$row .= '"'.$user['SUPPORT1'].'",';
				$row .= '"'.$user['SUPPORT2'].'",';
				$row .= '"'.$user['SUPPORT3'].'",';
				$row .= '"'.$user['LISTENING1'].'",';
				$row .= '"'.$user['LISTENING2'].'",';
				$row .= '"'.$user['LISTENING3'].'",';
				$row .= '"'.$user['INTERACTION1'].'",';
				$row .= '"'.$user['INTERACTION2'].'",';


                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
                $row .= '"'.$user['cmt21'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

					fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


		//}
	}

///////////////////////////////////////////////////////////////////////////////////////////////////

public function qa_telaidobqa_report()
	{
		if(check_logged_in())
		{
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_telaidobqa_report.php";
			$data["content_js"] = "qa_grille_evaluation_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			//$campaign = $this->input->get('campaign');

			$data["qa_telaidobqa_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_telaidobqa_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_telaidobqa_list"] = $fullAray;
				$this->create_qa_telaidobqa_CSV($fullAray,);
				$dn_link = base_url()."reports_qa/download_qa_telaidobqa_CSV/";
			}

				$data['download_link']=$dn_link;
				$data["action"] = $action;
				$data['date_from'] = $date_from;
				$data['date_to'] = $date_to;
				$data['office_id']=$office_id;
				$data['audit_type']=$audit_type;
				//$data['campaign']=$campaign;
				$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_telaidobqa_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Telaid OB Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_telaidobqa_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "Qa_telaid";
		$edit_url = "add_edit_ob_telaid";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		//if($campaign == 'grille_evaluation'){
			//////////////////////////////////////////////
			$header = array("Auditor Name",
			"Audit Date",
			"Call Date",
			"Agent Id",
			// "Fusion ID",
			"L1 Supervisor",
			"CSR Name:",
			"Team Manager:",
			"Case Topic:",
			"Reviewed By:",
			"ACPT",
			"Call Duration",
			"Audit Type",
			"Auditor Type",
			"VOC",
			"Audit Link",
			"Overall Score",
			"Possible Score",
			"Earn Score",
			"Leave complete documentation in the notes field.",
			"Refrain from any negative or derogatory comments about customers fellow employees or services within their case notes.",
			"Associate the call to the right ticket.",
			"Post notes on the correct platforms.",
			"Verify if LCON/Site contact receives the email regarding the AMP & VOLTE task.",
			"Offer to resend the email for the AMP & VOLTE task.",
			"Verify the site and discusse the details of the project..",
			"Escalate the ticket correctly.",
			"Review the ticket and provide accurate details within the scope of support.",
			"Offer additional assistance",
			"Execute the opening spiel clearly and correctly.",
			"Deliver ghost call spiel.",
			"Recap the details of the task.",
			"Follow proper hold procedures and mute expectations.",
			"Call the correct technician's number.",
			"Acknowledge and respond to the callers emotional statements or tone while actively controlling the interaction.",
			"Maintain a friendly confident and professional tone of voice throughout the interaction.",
			"Listen actively during the interaction.",
			"Advise customer accurately about ticket status next steps and relevant time frames.",
			"Move tasks to the correct stage after calling the client location.",
			"Remark 1","Remark 2","Remark 3","Remark 4","Remark 5","Remark 6","Remark 7","Remark 8","Remark 9","Remark 10","Remark 11","Remark 12","Remark 13",
			"Remark 14","Remark 15","Remark 16","Remark 17","Remark 18","Remark 19","Remark 20",
			"Call Summary",
			"Feedback",
			"Audit Start Time",
			"Agent review date",
			"Agent review note",
			"Mgnt review date",
			"Mgnt review by",
			"Mgnt review note");

			 $row = "";
		   foreach($header as $data) $row .= ''.$data.',';
		   fwrite($fopen,rtrim($row,",")."\r\n");
		   $searches = array("\r", "\n", "\r\n");

		   foreach($rr as $user)
		   {
			   if($user['entry_by']!=''){
				   $auditorName = $user['auditor_name'];
			   }else{
				   $auditorName = $user['client_name'];
			   }

			   if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				   $interval1 = '---';
			   }else{
				   $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			   }
			   $main_urls = $main_url.'/'.$user['id'];

			    $row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';


				$row .= '"'.$user['csr'].'",';
				$row .= '"'.$user['team_manager'].'",';
				$row .= '"'.$user['case_topic'].'",';
				$row .= '"'.$user['reviewed'].'",';
				$row .= '"'.$user['acpt'].'",';
				$row .= '"'.$user['call_duration'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$main_urls.'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['possible_score'].'",';
				$row .= '"'.$user['earned_score'].'",';

				$row .= '"'.$user['DOCUMENTATION1'].'",';
				$row .= '"'.$user['DOCUMENTATION2'].'",';
				$row .= '"'.$user['DOCUMENTATION3'].'",';
				$row .= '"'.$user['DOCUMENTATION4'].'",';
				$row .= '"'.$user['PROCESS1'].'",';
				$row .= '"'.$user['PROCESS2'].'",';
				$row .= '"'.$user['PROCESS3'].'",';
				$row .= '"'.$user['PROCESS4'].'",';
				$row .= '"'.$user['SUPPORT1'].'",';
				$row .= '"'.$user['SUPPORT2'].'",';
				$row .= '"'.$user['HANDLING1'].'",';
				$row .= '"'.$user['HANDLING2'].'",';
				$row .= '"'.$user['HANDLING3'].'",';
				$row .= '"'.$user['HANDLING4'].'",';
				$row .= '"'.$user['HANDLING5'].'",';
				$row .= '"'.$user['LISTENING1'].'",';
				$row .= '"'.$user['LISTENING2'].'",';
				$row .= '"'.$user['LISTENING3'].'",';
				$row .= '"'.$user['INTERACTION1'].'",';
				$row .= '"'.$user['INTERACTION2'].'",';


                $row .= '"'.$user['cmt1'].'",';
                $row .= '"'.$user['cmt2'].'",';
                $row .= '"'.$user['cmt3'].'",';
                $row .= '"'.$user['cmt4'].'",';
                $row .= '"'.$user['cmt5'].'",';
                $row .= '"'.$user['cmt6'].'",';
                $row .= '"'.$user['cmt7'].'",';
                $row .= '"'.$user['cmt8'].'",';
                $row .= '"'.$user['cmt9'].'",';
                $row .= '"'.$user['cmt10'].'",';
                $row .= '"'.$user['cmt11'].'",';
                $row .= '"'.$user['cmt12'].'",';
                $row .= '"'.$user['cmt13'].'",';
                $row .= '"'.$user['cmt14'].'",';
                $row .= '"'.$user['cmt15'].'",';
                $row .= '"'.$user['cmt16'].'",';
                $row .= '"'.$user['cmt17'].'",';
                $row .= '"'.$user['cmt18'].'",';
                $row .= '"'.$user['cmt19'].'",';
                $row .= '"'.$user['cmt20'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

					fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
	}

///////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Grille Evaluation(Trevi Pool) //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
	public function qa_grille_evaluation_report()
	{
		if(check_logged_in())
		{
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_grille_evaluation_report.php";
			$data["content_js"] = "qa_grille_evaluation_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			//$campaign = $this->input->get('campaign');

			$data["qa_grille_evaluation_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
					$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
				}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
					$cond1 .=" And assigned_to='$current_user'";
				}else{
					$cond1 .="";
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_grille_evaluation_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_grille_evaluation_list"] = $fullAray;
				$this->create_qa_grille_evaluation_CSV($fullAray,);
				$dn_link = base_url()."reports_qa/download_qa_grille_evaluation_CSV/";
			}

				$data['download_link']=$dn_link;
				$data["action"] = $action;
				$data['date_from'] = $date_from;
				$data['date_to'] = $date_to;
				$data['office_id']=$office_id;
				$data['audit_type']=$audit_type;
				//$data['campaign']=$campaign;
				$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_grille_evaluation_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Grille Evaluation Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}

	public function create_qa_grille_evaluation_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");

		//if($campaign == 'grille_evaluation'){
			//////////////////////////////////////////////
			$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

			"Accueil  Presentation de l entreprise et de l agent",
			"Ecoute du besoin client",
			"Authentification du client",
			"Reformulation de la demande",
			"Recueil des elements essentiels au traitement de la demande",
			"Consultation du dossier client",
			"Prise de conge",
			"Reprise de ligne",
			"Aisance de l expression  Elocution  Vocabulaire",
			"Directivite",
			"Dynamisme  Rythme de la voix",
			"Courtoisie  Convivialite de l entretien",
			"Sens du service  Implication",
			"Capaciee e desamorcer l insatisfaction",
			"Ton  sourire",
			"Respect de la procedure",
			"Clarte des explications fournies",
			"Traqage du RDV",
			"Transfert conforme",
			"Technique Comment",
			"Qualite Comment",
			"Gestion Comment",
			"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

			 $row = "";
		   foreach($header as $data) $row .= ''.$data.',';
		   fwrite($fopen,rtrim($row,",")."\r\n");
		   $searches = array("\r", "\n", "\r\n");

		   foreach($rr as $user)
		   {
			   if($user['entry_by']!=''){
				   $auditorName = $user['auditor_name'];
			   }else{
				   $auditorName = $user['client_name'];
			   }

			   if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				   $interval1 = '---';
			   }else{
				   $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			   }

			   $row = '"'.$auditorName.'",';
			   $row .= '"'.$user['audit_date'].'",';
			   $row .= '"'.$user['fname']." ".$user['lname'].'",';
			   $row .= '"'.$user['fusion_id'].'",';
			   $row .= '"'.$user['tl_name'].'",';
			   $row .= '"'.$user['call_date'].'",';
			   $row .= '"'.$user['call_duration'].'",';
			   $row .= '"'.$user['audit_type'].'",';
			   $row .= '"'.$user['auditor_type'].'",';
			   $row .= '"'.$user['voc'].'",';
			   $row .= '"'.$user['audit_start_time'].'",';
			   $row .= '"'.$user['entry_date'].'",';
			   $row .= '"'.$user['earned_score'].'",';
			   $row .= '"'.$user['possible_score'].'",';
			   // $row .= '"'.$interval1.'",';
			   $row .= '"'.$user['overall_score'].'%'.'",';

			   $row .= '"'.$user['accueil'].'",';
				$row .= '"'.$user['ecoute'].'",';
				$row .= '"'.$user['authentification'].'",';
				$row .= '"'.$user['reformulation'].'",';
				$row .= '"'.$user['recueil'].'",';
				$row .= '"'.$user['consultation'].'",';
				$row .= '"'.$user['prise'].'",';
				$row .= '"'.$user['reprise'].'",';
				$row .= '"'.$user['aisance'].'",';
				$row .= '"'.$user['directivite'].'",';
				$row .= '"'.$user['dynamisme'].'",';
				$row .= '"'.$user['courtoisie'].'",';
				$row .= '"'.$user['sens'].'",';
				$row .= '"'.$user['capacite'].'",';
				$row .= '"'.$user['ton'].'",';
				$row .= '"'.$user['respect'].'",';
				$row .= '"'.$user['clarte'].'",';
				$row .= '"'.$user['tracage'].'",';
				$row .= '"'.$user['transfert'].'",';

				$row .= '"'.$user['technique_comment'].'",';
				$row .= '"'.$user['qualite_comment'].'",';
				$row .= '"'.$user['gestion_comment'].'",';

				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
				$row .= '"'.$user['client_rvw_date'].'",';
				$row .= '"'.$user['client_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

					fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);


		//}
	}

	////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Comcast //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_comcast_report()
{
	if(check_logged_in())
	{
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_comcast_report.php";
		$data["content_js"] = "qa_comcast_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		//$campaign = $this->input->get('campaign');

		$data["qa_comcast_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_comcast_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_comcast_list"] = $fullAray;
			$this->create_qa_comcast_CSV($fullAray,);
			$dn_link = base_url()."reports_qa/download_qa_comcast_CSV/";
		}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			//$data['campaign']=$campaign;
			$this->load->view('dashboard',$data);
	}
}


public function download_qa_comcast_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Comcast Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_comcast_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	//if($campaign == 'comcast'){
		//////////////////////////////////////////////
		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Caller ID", "Interaction ID", "Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score","Overall Score",

		"Greetings Did agent greet the customer properly on call?",
		"Introduction Did the agent mention his her name on call and also branded the call",
		"Communication Proper energy communication skill was reflecting on call while speaking to the customer",
		"Did the agent asked for a suitable callback time if the customer was busy?",
		"Did the agent overlapped or interruped the customer while he she was speaking?",
		"Did the agent showed good listening skills on call ?",
		"Professionalism Rep showed proper professionalism on call Not being rude on call abusive call disconnection sarcasm etc",
		"Probing Did agent probed well to understand customers need and gather information?",
		"Did the agent used all methods to obtain customers current provider details?",
		"Objection Handling Did the agent used prompt rebuttal whenever objected by customer?",
		"Urgency Did the agent mentioned asked if it a exisiting customer",
		"Did the agent probed for additional services If it is an exisiting service holder",
		"Ownership Did the agent showed proper ownership and used proper process knowledge?",
		"Confirm Authorize person Did the agent speak with the Decision Maker",
		"Verification Agent should verify Address of the business",
		"Package Description Agent read package description to the customer",
		"Did the agent tried to transfer the call to ensure it as a sales?",
		"Did the agent answered all the queries of the customer before transfer or asked the customer if he she has any doubt or query?",
		"Did the agent mentioned all the information according to the sales disclosure? Verbatim",
		"Infraction If Yes then Auto Fail",
		"Infraction Reason",
		"Factor",
		"L1",
		"L2",
		"Opening Comment",
		"Soft Skills Comment",
		"Sales Comment",
		"Mandatory Comment",
		"Resolution Comment",
		"Closing Comment",
		"Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		 $row = "";
	   foreach($header as $data) $row .= ''.$data.',';
	   fwrite($fopen,rtrim($row,",")."\r\n");
	   $searches = array("\r", "\n", "\r\n");

	   foreach($rr as $user)
	   {
		   if($user['entry_by']!=''){
			   $auditorName = $user['auditor_name'];
		   }else{
			   $auditorName = $user['client_name'];
		   }

		   if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
			   $interval1 = '---';
		   }else{
			   $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
		   }

		   $row = '"'.$auditorName.'",';
		   $row .= '"'.$user['audit_date'].'",';
		   $row .= '"'.$user['fname']." ".$user['lname'].'",';
		   $row .= '"'.$user['fusion_id'].'",';
		   $row .= '"'.$user['tl_name'].'",';
		   $row .= '"'.$user['call_date'].'",';
		   $row .= '"'.$user['call_duration'].'",';
		   $row .= '"'.$user['caller_id'].'",';
		   $row .= '"'.$user['interaction_id'].'",';
		   $row .= '"'.$user['audit_type'].'",';
		   $row .= '"'.$user['auditor_type'].'",';
		   $row .= '"'.$user['voc'].'",';
		   $row .= '"'.$user['audit_start_time'].'",';
		   $row .= '"'.$user['entry_date'].'",';
		   $row .= '"'.$user['earned_score'].'",';
		   $row .= '"'.$user['possible_score'].'",';
		   // $row .= '"'.$interval1.'",';
		   $row .= '"'.$user['overall_score'].'%'.'",';

		   $row .= '"'.$user['greetings'].'",';
			$row .= '"'.$user['introduction'].'",';
			$row .= '"'.$user['communication'].'",';
			$row .= '"'.$user['callback'].'",';
			$row .= '"'.$user['overlapped'].'",';
			$row .= '"'.$user['skills'].'",';
			$row .= '"'.$user['professionalism'].'",';
			$row .= '"'.$user['probing'].'",';
			$row .= '"'.$user['provider_details'].'",';
			$row .= '"'.$user['objection'].'",';
			$row .= '"'.$user['urgency'].'",';
			$row .= '"'.$user['additional_services'].'",';
			$row .= '"'.$user['ownership'].'",';
			$row .= '"'.$user['decision_maker'].'",';
			$row .= '"'.$user['verification'].'",';
			$row .= '"'.$user['package_description'].'",';
			$row .= '"'.$user['resolution'].'",';
			$row .= '"'.$user['queries'].'",';
			$row .= '"'.$user['sales_disclosure'].'",';
		   	$row .= '"'.$user['infraction'].'",';
			$row .= '"'.$user['infraction_reason'].'",';
			$row .= '"'.$user['factor'].'",';
			$row .= '"'.$user['l1'].'",';
			$row .= '"'.$user['l2'].'",';

			$row .= '"'.$user['opening_comment'].'",';
			$row .= '"'.$user['soft_skills_comment'].'",';
			$row .= '"'.$user['sales_comment'].'",';
			$row .= '"'.$user['mandatory_comment'].'",';
			$row .= '"'.$user['resolution_comment'].'",';
			$row .= '"'.$user['closing_comment'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);


	//}
}
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////// Cholamandlam //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
public function qa_cholamandlam_report()
{
	if(check_logged_in())
	{
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_cholamandlam_report.php";
		$data["content_js"] = "qa_cholamandlam_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		$campaign = $this->input->get('campaign');

		$data["qa_cholamandlam_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_".$campaign."_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_cholamandlam_list"] = $fullAray;
			$this->create_qa_cholamandlam_CSV($fullAray,$campaign);
			$dn_link = base_url()."reports_qa/download_qa_cholamandlam_CSV/".$campaign;
		}

		$data['download_link']=$dn_link;
		$data["action"] = $action;
		$data['date_from'] = $date_from;
		$data['date_to'] = $date_to;
		$data['office_id']=$office_id;
		$data['audit_type']=$audit_type;
		$this->load->view('dashboard',$data);
	}
}


public function download_qa_cholamandlam_CSV($campaign)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA Cholamandlam Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_cholamandlam_CSV($rr,$campaign)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Audit Type","Auditor Type", "Track ID", "Mobile No", "Language", "Week", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score", "Interval1", "Overall Score",

		 	"Objection Handling",
		 	"Disposition",
		 	"Verification",
		 	"Follow up (Lead/ Call back/ Email)",
		 	"Uphold Company Image",
		 	"Customer Centricity & Professionalism",
		 	"Politeness and Courtesy",
		 	"Product /Process Knowledge (Complete and correct information)",
		 	"Opening Script",
		 	"Probing",
		 	"Clarity of Speech",
		 	"Pace of Speech",
		 	"Interruption",
		 	"Active Listening and Attentiveness",
		 	"Telephone Etiquette/Signposting & Jargons",
		 	"Lack of Energy",
		 	"Empathy",
		 	"Hold procedure",
		 	"Mute/Dead air",
		 	"Stammering",
		 	"Digital Pitch",
		 	"Sales Pitch & Effort on call",
		 	"Closing script",
		 	"Business critical comment",
		 	"Customer critical comment",
		 	"Non critical comment",
		 	"Correct Disposition",
		 	"Disposition selected by agent",
		 	"Wrong Disposition -Failure Remarks",
		 	"Maintain Professionalism - Failure Reason",
		 	"Standard call opening Adherence",
		 	"Pick up call validation",
		 	"EMI Amount Confirmation",
		 	"Address Confirmation",
		 	"Invalid Pickup Remarks",
		 	 "Call Summary", "Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['track_id'].'",';
			$row .= '"'.$user['mobile_no'].'",';
			$row .= '"'.$user['language'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';

			$row .= '"'.$user['objection_handling'].'",';
			$row .= '"'.$user['disposition'].'",';
			$row .= '"'.$user['verification'].'",';
			$row .= '"'.$user['follow_up'].'",';
			$row .= '"'.$user['uphold_company'].'",';
			$row .= '"'.$user['professionalism'].'",';
			$row .= '"'.$user['politeness_courtesy'].'",';
			$row .= '"'.$user['process_knowledge'].'",';
			$row .= '"'.$user['opening_script'].'",';
			$row .= '"'.$user['probing'].'",';
			$row .= '"'.$user['clarity_speech'].'",';
			$row .= '"'.$user['pace_speech'].'",';
			$row .= '"'.$user['interruption'].'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'.$user['telephone_etiquette'].'",';
			$row .= '"'.$user['lack_energy'].'",';
			$row .= '"'.$user['empathy'].'",';
			$row .= '"'.$user['hold_procedure'].'",';
			$row .= '"'.$user['dead_air'].'",';
			$row .= '"'.$user['stammering'].'",';
			$row .= '"'.$user['digital_pitch'].'",';
			$row .= '"'.$user['sales_pitch'].'",';
			$row .= '"'.$user['closing_script'].'",';

			$row .= '"'.$user['business_critical_comment'].'",';
			$row .= '"'.$user['customer_critical_comment'].'",';
			$row .= '"'.$user['non_critical_comment'].'",';

			$row .= '"'.$user['correct_disposition'].'",';
			$row .= '"'.$user['disposition_agent'].'",';
			$row .= '"'.$user['failure_remarks'].'",';
			$row .= '"'.$user['failure_reason'].'",';
			$row .= '"'.$user['standard_call'].'",';
			$row .= '"'.$user['call_validation'].'",';
			$row .= '"'.$user['emi_amount'].'",';
			$row .= '"'.$user['address'].'",';
			$row .= '"'.$user['pickup_remarks'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
	fclose($fopen);
}





////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////World Vision Canada //////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
public function qa_vision_canada_report()
{
	if(check_logged_in())
	{
		$user_office_id=get_user_office_id();
		$current_user = get_user_id();
		$is_global_access=get_global_access();
		$role_dir=get_role_dir();
		$data["show_download"] = false;
		$data["download_link"] = "";
		$data["show_table"] = false;
		$data["show_table"] = false;
		$data["aside_template"] = "reports_qa/aside.php";
		$data["content_template"] = "reports_qa/qa_vision_canada_report.php";
		$data["content_js"] = "qa_vision_canada_js.php";

		$data['location_list'] = $this->Common_model->get_office_location_list();

		$office_id = "";
		$date_from="";
		$date_to="";
		$audit_type="";
		$campaign="";
		$action="";
		$dn_link="";
		$cond="";
		$cond1="";

		$data["qa_vision_canada_list"] = array();

		if($this->input->get('show')=='Show')
		{
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');
			$audit_type = $this->input->get('audit_type');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if($audit_type=="All"){
				if(get_login_type()=="client"){
					$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
				}else{
					$cond .= "";
				}
			}else{
				$cond .=" and audit_type='$audit_type'";
			}

			if(get_role_dir()=='manager' && get_dept_folder()=='operations')
			{
				$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations')
			{
				$cond1 .=" And assigned_to='$current_user'";
			}else{
				$cond1 .="";
			}


			$qSql="SELECT * from
			(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
			(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
			(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
			(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
			(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_vision_canada_feedback) xx Left Join
			(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

			$fullAray = $this->Common_model->get_query_result_array($qSql);
			$data["qa_vision_canada_list"] = $fullAray;
			$this->create_qa_vision_canada_CSV($fullAray);
			$dn_link = base_url()."reports_qa/download_qa_vision_canada_CSV/";
		}

		$data['download_link']=$dn_link;
		$data["action"] = $action;
		$data['date_from'] = $date_from;
		$data['date_to'] = $date_to;
		$data['office_id']=$office_id;
		$data['audit_type']=$audit_type;
		$this->load->view('dashboard',$data);
	}
}


public function download_qa_vision_canada_CSV()
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$newfile="QA World Vision Canada Audit List-'".$currDate."'.csv";
	header('Content-Disposition: attachment;  filename="'.$newfile.'"');
	readfile($filename);
}

public function create_qa_vision_canada_CSV($rr)
{
	$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Call Type", "CRM Transaction ID", "REP ID", "Mobile No", "Language", "Donor Name", "Score Grade", "Week", "Audit Type","Auditor Type", "VOC", "Audit Start Date Time", "Audit End Date Time", "Earned Score", "Possible Score", "Interval1", "Overall Score",
	"Did rep appropriately greet the caller introduce him/herself?",
	"Did the rep inform about the call recording on the call?",
	"Did the rep listen actively acknowledged & empathized correctly and did not interrupt/over talk the donor while speaking?",
	"Did the rep not sound Robotic/monotone and reading while reading the script?",
	"Did rep use a pleasant respectful tone spoke clearly concisely apprepreciational tone and at an appropriate pace throughout the call?",
	"Did the rep follow proper Hold & Dead Air Procedure (whenever required)?",
	"Was the rep able to build a good rapport with the donor on the call?",
	"Did the rep not use any Internal abbreviation (as Jargon) through out the call?",
	"Did rep Close for 'No'?",
	"Did rep drive positive donor experience?",
	"Did rep collect/provide all required information to engage with donor?",
	"Did rep consider supporting training and FAQ's appropriately on the call?",
	"Did the rep follow proper process flow for every scenario?",
	"Did the rep mention to pause the recording before taking the card details and after resuming followed rest procedure to process payment?",
	"Did the rep properly escalated the case wherever required?",
	"Did the rep adhere to scripting ask structure and products?",
	"Did the rep addresse concerns or customer service issues positively and appropriately?",
	"Did the rep mention the pledges/sponsorships and their amounts properly and clearly to donor on call?",
	"Did the rep read and take proper authorization disclosure for the use of the debit or credit card / checking account provided before processing payment?",
	"Did the rep provide payment process details after processing payment?",
	"Did the rep close the call properly mentioning brand name?",
	"Greeting Comment",
	"Communication Skills Comment",
	"Positive Donor Experience Comment",
	"Positive Agent Experience Comment",
	"Compliance Comment",
	"Payment Script Comment",
	"Closing Comment",
	 "Call Summary", "Call Status", "Error Summary/Feedback", "Agent Feedback Acceptance", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment", "Client Review Date", "Client Review Name", "Client Review Note");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user)
		{
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['transaction_id'].'",';
			$row .= '"'.$user['rep_id'].'",';
			$row .= '"'.$user['mobile_no'].'",';
			$row .= '"'.$user['language'].'",';
			$row .= '"'.$user['donor_name'].'",';
			$row .= '"'.$user['score_grade'].'",';
			$row .= '"'.$user['week'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['audit_start_time'].'",';
			$row .= '"'.$user['entry_date'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$interval1.'",';
			$row .= '"'.$user['overall_score'].'%'.'",';
			// $row .= '"'.$user['customer_score'].'%'.'",';
			// $row .= '"'.$user['business_score'].'%'.'",';
			// $row .= '"'.$user['compliance_score'].'%'.'",';
			$row .= '"'.$user['greet_caller_introduce'].'",';
			$row .= '"'.$user['call_recording'].'",';
			$row .= '"'.$user['acknowledged'].'",';
			$row .= '"'.$user['robotic_reading'].'",';
			$row .= '"'.$user['apprepreciational'].'",';
			$row .= '"'.$user['air_procedure'].'",';
			$row .= '"'.$user['rapport'].'",';
			$row .= '"'.$user['abbreviation'].'",';
			$row .= '"'.$user['rep_close'].'",';
			$row .= '"'.$user['positive_donor'].'",';
			$row .= '"'.$user['engage'].'",';
			$row .= '"'.$user['training_faq'].'",';
			$row .= '"'.$user['proper_process'].'",';
			$row .= '"'.$user['process_payment'].'",';
			$row .= '"'.$user['escalated'].'",';
			$row .= '"'.$user['structure_products'].'",';
			$row .= '"'.$user['customer_service'].'",';
			$row .= '"'.$user['sponsorships'].'",';
			$row .= '"'.$user['authorization_disclosure'].'",';
			$row .= '"'.$user['payment_process_details'].'",';
			$row .= '"'.$user['mentioning_brand'].'",';
			$row .= '"'.$user['greeting_comment'].'",';
			$row .= '"'.$user['communication_skills_comment'].'",';
			$row .= '"'.$user['positive_donor_experience_comment'].'",';
			$row .= '"'.$user['positive_agent_experience_comment'].'",';
			$row .= '"'.$user['compliance_comment'].'",';
			$row .= '"'.$user['payment_script_comment'].'",';
			$row .= '"'.$user['closing_comment'].'",';

			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_status'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'",';
			$row .= '"'.$user['client_rvw_date'].'",';
			$row .= '"'.$user['client_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['client_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
	fclose($fopen);
}


////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////// LEAD SCHOOL //////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
	public function qa_lead_report(){
		if(check_logged_in()){

		  $office_id = "";
		  $user_office_id=get_user_office_id();
		  $current_user = get_user_id();
		  $is_global_access=get_global_access();
		  $role_dir=get_role_dir();
		  $data["show_download"] = false;
		  $data["download_link"] = "";
		  $data["show_table"] = false;
		  $data["show_table"] = false;

		  $data["aside_template"] = "reports_qa/aside.php";
		  $data["content_template"] = "reports_qa/qa_lead_report.php";
		  $data["content_js"] = "qa_universal_js.php";
		  $date_from="";
		  $date_to="";
		  $action="";
		  $dn_link="";
		  $cond="";
		  $cond1="";

		  $data['location_list'] = $this->Common_model->get_office_location_list();

		  $data["qa_lead_list"] = array();
		  if($this->input->get('show')=='Show') {
			$campaign ='lead';
			$date_from = mmddyy2mysql($this->input->get('date_from'));
			$date_to = mmddyy2mysql($this->input->get('date_to'));
			$office_id = $this->input->get('office_id');

			if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' ) ";

			if($office_id=="All") $cond .= "";
			else $cond .=" and office_id='$office_id'";

			if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
			  $cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
			}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
			  $cond1 .=" And assigned_to='$current_user'";
			}else{
			  $cond1 .="";
			}

			if($campaign=='lead'){
				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_lead_feedback) xx Left Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_lead_list"] = $fullAray;
			}

			$this->create_qa_lead_CSV($fullAray,$campaign);
			$dn_link = base_url()."reports_qa/download_qa_lead_CSV";


		  }

		  $data['download_link']=$dn_link;
		  $data["action"] = $action;
		  $data['date_from'] = $date_from;
		  $data['date_to'] = $date_to;
		  $data['office_id']=$office_id;
		  $this->load->view('dashboard',$data);
		}
	  }


	  public function download_qa_lead_CSV()
	 {
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Lead Audit List-'".$currDate."'.csv";

		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	  }


	  public function create_qa_lead_CSV($rr,$campaign)
	  {

		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$fopen = fopen($filename,"w+");
		if($campaign=='lead'){
		 $header = array("Auditor Name", "Audit Date", "Fusion ID", "Agent Name", "L1 Supervisor","Call Date","Call Type","Campaign","Call Duration","Call Disconnect By","Disposition(QA)","Disposition(associate)","Call Recording ID","Ticket ID","Audit Type","Auditor Type","Voc","Possible Score","Earned Score","Overall Score","Opened the call within 5 Seconds", "Agent was energetic & pleasant in the opening","Self-Introduction & Used the Correct Script & Brand (Lead)","Active Listening & Understanding the issue","Asked appropriate Probing questions","Complete and correct information given","Was correct process adhered to give resolution","Used grammaticlly correct sentences avoided jargons fillers","Agent followed the Hold Procedure & avoided Dead Air","Empathised/apologises whenver required","Polite and Professionalism","Complete and correct notes updation (Hubspot CRM)/ Ticket movement done as per process","Relevant attachments attached in the ticket","Correct disposition/tagging as per the query type on Hubspot","Further assistance offered/close looping","Agent gave closing with the proper script (Brand Name).","IVR transfer for all scope cases","Observation", "Feedback", "Agent Review Date", "Agent Comment", "Mgnt Review Date","Mgnt Review By", "Mgnt Comment");
		}

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		if($campaign=='lead'){

		  foreach($rr as $user){
			 if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
			  $interval1 = '---';
			 }else{
			  $interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			 }


		   $row = '"'.$user['auditor_name'].'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_type'].'",';
			$row .= '"'.$user['campaign'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['call_disconnected'].'",';
			$row .= '"'.$user['disposition_qa'].'",';
			$row .= '"'.$user['disposition_associate'].'",';
			$row .= '"'.$user['call_recording_id'].'",';
			$row .= '"'.$user['ticket_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['opened_the_call'].'",';
			$row .= '"'.$user['agent_was_energetic'].'",';
			$row .= '"'.$user['self_introduction'].'",';
			$row .= '"'.$user['active_listening'].'",';
			$row .= '"'.$user['asked_appropriate'].'",';
			$row .= '"'.$user['complete_and_correct'].'",';
			$row .= '"'.$user['was_correct_process'].'",';
			$row .= '"'.$user['used_grammaticlly'].'",';
			$row .= '"'.$user['agent_followed'].'",';
			$row .= '"'.$user['empathised_apologises'].'",';
			$row .= '"'.$user['polite_and_professionalism'].'",';
			$row .= '"'.$user['complete_and_correct_updation'].'",';
			$row .= '"'.$user['relevant_attachments'].'",';
			$row .= '"'.$user['correct_disposition'].'",';
			$row .= '"'.$user['further_assistance'].'",';
			$row .= '"'.$user['agent_gave_closing'].'",';
			$row .= '"'.$user['transfer_for_all'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		  }
		  fclose($fopen);

		}
	}
//////////////////////////////////////////Credit Pro Report////////////////////////////////////////////////////////////


public function qa_credit_pro_report(){
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/credit_pro_report.php";
			$data["content_js"] = "qa_one_assist_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$from_date="";
			$to_date="";
			$audit_type="";
			$campaign="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";
			$user="";
			$campaign = $this->input->get('campaign');
			$data["qa_pre_list"] = array();

			if($this->input->get('show')=='Show')
			{

				    $from_date = mmddyy2mysql($this->input->get('date_from'));
					$to_date = mmddyy2mysql($this->input->get('date_to'));
					$office_id = $this->input->get('office_id');
					$lob = $this->input->get('lob');

					if($from_date !="" && $to_date!=="" )  $cond= " Where (date(audit_date) >= '$from_date' and date(audit_date) <= '$to_date' ) ";

					if($office_id=="All") $cond .= "";
					else $cond .=" and office_id='$office_id'";

					if(get_user_fusion_id()!='FMIN000011' || get_user_fusion_id()!='FUTA000007' || get_user_fusion_id()!='FUTA000012'){
						$ops_cond="";
					}else{
						if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
							$ops_cond=" Where (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
						}else if(get_role_dir()=='tl' && get_dept_folder()=='operations'){
							$ops_cond=" Where assigned_to='$current_user'";
						}else{
							$ops_cond="";
						}
					}

				 $qSql="SELECT * from (Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name, (select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name, (select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name from qa_credit_pro_feedback) xx Left Join (Select id as sid, fname, lname, fusion_id, office_id, get_process_names(id) as campaign, DATEDIFF(CURDATE(), doj) as tenure, assigned_to from signin) yy on (xx.agent_id=yy.sid) $cond $ops_cond order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["qa_pre_list"] = $fullAray;
				$this->create_qa_credit_pro_CSV($fullAray,$campaign);
				$dn_link = base_url()."reports_qa/download_qa_credit_pro_CSV";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $from_date;
			$data['date_to'] = $to_date;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$data['campaign']=$campaign;

			$this->load->view('dashboard',$data);
		}
	}

public function download_qa_credit_pro_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Credit Pro Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_credit_pro_CSV($rr)
	{
		$currDate=date("Y-m-d");
	$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
	$fopen = fopen($filename,"w+");

	$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date","Audit Type", "Auditor Type","Voc","Overall Score","Verbatim Introduction","This is a paid service","Credit Summary","Income source", "The Service","The Right Package","Identify/Handle Objection","Urgency","Professionalism","Call Avoidance","Tonality","Clarity/Pacing/Clearness","Acknowledgement/Empathy","Promptness","Hold Time/Dead Air","Active Listening","Financial Recap","Burned call","Call Disposition","ACE Transfer","No Misleading Statement","Improper Enrollment","Credit Card Disclosure","Family Plan","Auto Fail Status","Auto Fail Reason","Comments 1","Comments 2","Comments 3","Comments 4","Comments 5","Comments 6","Comments 7","Comments 8","Comments 9","Comments 10","Comments 11","Comments 12","Comments 13","Comments 14","Comments 15","Comments 16","Comments 17","Comments 18","Comments 19","Comments 20","Comments 21","Comments 22","Comments 23","Comments 24","Call Summary", "Agent Feedback Acceptance","Feedback", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}

			$row = '"'.$auditorName.'",';
				$row .= '"'.$user['audit_date'].'",';
				$row .= '"'.$user['fname']." ".$user['lname'].'",';
				$row .= '"'.$user['fusion_id'].'",';
				$row .= '"'.$user['tl_name'].'",';
				$row .= '"'.$user['call_date'].'",';
				$row .= '"'.$user['audit_type'].'",';
				$row .= '"'.$user['auditor_type'].'",';
				$row .= '"'.$user['voc'].'",';
				$row .= '"'.$user['overall_score'].'",';
				$row .= '"'.$user['verbatim_introduction'].'",';
				$row .= '"'.$user['paid_service'].'",';
				$row .= '"'.$user['Credit_Summary'].'",';
				$row .= '"'.$user['Income_source'].'",';
				$row .= '"'.$user['The_Service'].'",';
				$row .= '"'.$user['Right_Package'].'",';
				$row .= '"'.$user['Handle_Objection'].'",';
				$row .= '"'.$user['Urgency'].'",';
				$row .= '"'.$user['Professionalism'].'",';
				$row .= '"'.$user['Call_Avoidance'].'",';
				$row .= '"'.$user['Tonality'].'",';
				$row .= '"'.$user['Clearness'].'",';
				$row .= '"'.$user['Empathy'].'",';
				$row .= '"'.$user['Promptness'].'",';
				$row .= '"'.$user['Dead_Air'].'",';
				$row .= '"'.$user['Active_Listening'].'",';
				$row .= '"'.$user['Financial_Recap'].'",';
				$row .= '"'.$user['Burned_call'].'",';
				$row .= '"'.$user['Call_Disposition'].'",';
				$row .= '"'.$user['ACE_Transfer'].'",';
				$row .= '"'.$user['Misleading_Statement'].'",';
				$row .= '"'.$user['Improper_Enrollment'].'",';
				$row .= '"'.$user['Card_Disclosure'].'",';
				$row .= '"'.$user['Family_Plan'].'",';
				$row .= '"'.$user['auto_fail_status'].'",';
				$row .= '"'.$user['auto_fail_reason'].'",';
				$row .= '"'.$user['cmt1'].'",';
				$row .= '"'.$user['cmt2'].'",';
				$row .= '"'.$user['cmt3'].'",';
				$row .= '"'.$user['cmt4'].'",';
				$row .= '"'.$user['cmt5'].'",';
				$row .= '"'.$user['cmt6'].'",';
				$row .= '"'.$user['cmt7'].'",';
				$row .= '"'.$user['cmt8'].'",';
				$row .= '"'.$user['cmt9'].'",';
				$row .= '"'.$user['cmt10'].'",';
				$row .= '"'.$user['cmt11'].'",';
				$row .= '"'.$user['cmt12'].'",';
				$row .= '"'.$user['cmt13'].'",';
				$row .= '"'.$user['cmt14'].'",';
				$row .= '"'.$user['cmt15'].'",';
				$row .= '"'.$user['cmt16'].'",';
				$row .= '"'.$user['cmt17'].'",';
				$row .= '"'.$user['cmt18'].'",';
				$row .= '"'.$user['cmt19'].'",';
				$row .= '"'.$user['cmt20'].'",';
				$row .= '"'.$user['cmt21'].'",';
				$row .= '"'.$user['cmt22'].'",';
				$row .= '"'.$user['cmt23'].'",';
				$row .= '"'.$user['cmt24'].'",';
                $row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
				$row .= '"'.$user['agnt_fd_acpt'].'",';
				$row .= '"'.$user['agent_rvw_note'].'",';
				$row .= '"'.$user['agent_rvw_date'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
				$row .= '"'.$user['mgnt_rvw_date'].'",';
				$row .= '"'.$user['mgnt_rvw_name'].'",';
				$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

				fwrite($fopen,$row."\r\n");
			}
			fclose($fopen);
		}

//////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////// AMERIFLEX /////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////
    public function qa_ameriflex_report()
	{
		if(check_logged_in()){
			$user_office_id=get_user_office_id();
			$current_user = get_user_id();
			$is_global_access=get_global_access();
			$role_dir=get_role_dir();
			$data["show_download"] = false;
			$data["download_link"] = "";
			$data["show_table"] = false;
			$data["show_table"] = false;
			$data["aside_template"] = "reports_qa/aside.php";
			$data["content_template"] = "reports_qa/qa_ameriflex_report.php";
			$data["content_js"] = "qa_bsnl_js.php";

			$data['location_list'] = $this->Common_model->get_office_location_list();

			$office_id = "";
			$date_from="";
			$date_to="";
			$audit_type="";
			$action="";
			$dn_link="";
			$cond="";
			$cond1="";

			$data["ameriflex_list"] = array();

			if($this->input->get('show')=='Show')
			{
				$date_from = mmddyy2mysql($this->input->get('date_from'));
				$date_to = mmddyy2mysql($this->input->get('date_to'));
				$office_id = $this->input->get('office_id');
				$audit_type = $this->input->get('audit_type');

				if($date_from !="" && $date_to!=="" )  $cond= " Where (audit_date >= '$date_from' and audit_date <= '$date_to' )";

				if($office_id=="All") $cond .= "";
				else $cond .=" and office_id='$office_id'";

				if($audit_type=="All"){
					if(get_login_type()=="client"){
						$cond .= "audit_type not in ('Operation Audit','Trainer Audit')";
					}else{
						$cond .= "";
					}
				}else{
					$cond .=" and audit_type='$audit_type'";
				}

				if(get_user_fusion_id()=='FCEB006520'){
					$cond1="";
				}else{
					if(get_role_dir()=='manager' && get_dept_folder()=='operations'){
						$cond1 .=" And (assigned_to='$current_user' OR assigned_to in (SELECT id FROM signin where assigned_to ='$current_user'))";
					}else if((get_role_dir()=='tl' && get_user_fusion_id()!='FMAN000616') && get_dept_folder()=='operations'){
						$cond1 .=" And assigned_to='$current_user'";
					}else{
						$cond1="";
					}
				}


				$qSql="SELECT * from
				(Select *, (select concat(fname, ' ', lname) as name from signin s where s.id=entry_by) as auditor_name,
				(select concat(fname, ' ', lname) as name from signin_client sc where sc.id=client_entryby) as client_name,
				(select concat(fname, ' ', lname) as name from signin s where s.id=tl_id) as tl_name,
				(select concat(fname, ' ', lname) as name from signin sx where sx.id=mgnt_rvw_by) as mgnt_rvw_name,
				(select concat(fname, ' ', lname) as name from signin_client scx where scx.id=client_rvw_by) as client_rvw_name from qa_ameriflex_feedback) xx Inner Join
				(Select id as sid, fname, lname, fusion_id, office_id, assigned_to, get_process_ids(id) as process_id, get_process_names(id) as process, doj, DATEDIFF(CURDATE(), doj) as tenure from signin) yy on (xx.agent_id=yy.sid) $cond $cond1 order by audit_date";

				$fullAray = $this->Common_model->get_query_result_array($qSql);
				$data["ameriflex_list"] = $fullAray;
				$this->create_qa_ameriflex_CSV($fullAray);
				$dn_link = base_url()."reports_qa/download_qa_ameriflex_CSV/";
			}

			$data['download_link']=$dn_link;
			$data["action"] = $action;
			$data['date_from'] = $date_from;
			$data['date_to'] = $date_to;
			$data['office_id']=$office_id;
			$data['audit_type']=$audit_type;
			$this->load->view('dashboard',$data);
		}
	}


	public function download_qa_ameriflex_CSV()
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$newfile="QA Ameriflex Audit List-'".$currDate."'.csv";
		header('Content-Disposition: attachment;  filename="'.$newfile.'"');
		readfile($filename);
	}


	public function create_qa_ameriflex_CSV($rr)
	{
		$currDate=date("Y-m-d");
		$filename = "./qa_files/qa_reports_data/Report".get_user_id().".csv";
		$currentURL = base_url();
		$controller = "qa_ameriflex";
		$edit_url = "add_edit_ameriflex";
		$main_url =  $currentURL.''.$controller.'/'.$edit_url;
		$fopen = fopen($filename,"w+");

		$header = array("Auditor Name", "Audit Date", "Agent", "Fusion ID", "L1 Super", "Call Date", "Call Duration", "Type", "Interaction ID", "Audit Type", "Auditor Type", "VOC","Audit Link", "Earned Score", "Possible Score","Overall Score",
		"Has the caller been properly greeted and verified?", "Did we show empathy/sympathy when necessary if applicable?", "Did we adjust to the callers pace and demeanor?", "Did we use the callers name two times throughout the call?", "Did we sound as though we wanted to assist the caller?", "Did we avoid interruptions and speaking over the caller?", "Did we use thank yous and apologies as appropriate?", "Did we own the issue ?", "Did we avoid dead air?", "Did we confirm/update callers contact information?", "Did we communicate all appropriate timelines and steps?", "Did we repeat the callers question/issue verify or confirm our understanding?", "Did we provide professional accurate details via call/chat?", "Did we take appropriate actions in Ameriflex Systems?", "Did we demonstrate appropriate use of the hold process?", "Did we avoid internal jargon?", "Did we validate if the issue/question was resolved?", "Did we ask if any additional assistance is needed?", "Did we properly close the call?",
		"Remarks 1", "Remarks 2", "Remarks 3", "Remarks 4", "Remarks 5", "Remarks 6", "Remarks 7", "Remarks 8", "Remarks 9", "Remarks 10", "Remarks 11", "Remarks 12", "Remarks 13", "Remarks 14", "Remarks 15", "Remarks 16", "Remarks 17", "Remarks 18", "Remarks 19",
		"Call Summary", "Feedback","Agent Feedback Acceptance", "Agent Review Date","Agent Comment","Mgnt Review Date","Mgnt Review By", "Mgnt Comment");

		$row = "";
		foreach($header as $data) $row .= ''.$data.',';
		fwrite($fopen,rtrim($row,",")."\r\n");
		$searches = array("\r", "\n", "\r\n");

		foreach($rr as $user){
			if($user['entry_by']!=''){
				$auditorName = $user['auditor_name'];
			}else{
				$auditorName = $user['client_name'];
			}

			if($user['audit_start_time']=="" || $user['audit_start_time']=='0000-00-00 00:00:00'){
				$interval1 = '---';
			}else{
				$interval1 = strtotime($user['entry_date']) - strtotime($user['audit_start_time']);
			}
			$main_urls = $main_url.'/'.$user['id'];

			$row = '"'.$auditorName.'",';
			$row .= '"'.$user['audit_date'].'",';
			$row .= '"'.$user['fname']." ".$user['lname'].'",';
			$row .= '"'.$user['fusion_id'].'",';
			$row .= '"'.$user['tl_name'].'",';
			$row .= '"'.$user['call_date'].'",';
			$row .= '"'.$user['call_duration'].'",';
			$row .= '"'.$user['type'].'",';
			$row .= '"'.$user['interaction_id'].'",';
			$row .= '"'.$user['audit_type'].'",';
			$row .= '"'.$user['auditor_type'].'",';
			$row .= '"'.$user['voc'].'",';
			$row .= '"'.$main_urls.'",';
			$row .= '"'.$user['earned_score'].'",';
			$row .= '"'.$user['possible_score'].'",';
			$row .= '"'.$user['overall_score'].'",';
			$row .= '"'.$user['caller_properly_greed'].'",';
			$row .= '"'.$user['show_empathy_sympathy'].'",';
			$row .= '"'.$user['adjust_caller_pace'].'",';
			$row .= '"'.$user['use_caller_name_two_times'].'",';
			$row .= '"'.$user['sound_though_assist_caller'].'",';
			$row .= '"'.$user['avoid_interruption_caller_speaking'].'",';
			$row .= '"'.$user['use_thatnk_you_appologies'].'",';
			$row .= '"'.$user['own_the_issue'].'",';
			$row .= '"'.$user['avoid_dead_air'].'",';
			$row .= '"'.$user['confirm_caller_contact'].'",';
			$row .= '"'.$user['communicate_timelines'].'",';
			$row .= '"'.$user['repeat_caller_question_issue'].'",';
			$row .= '"'.$user['provide_professional_accurate'].'",';
			$row .= '"'.$user['take_appropiate_actiona'].'",';
			$row .= '"'.$user['demonstrate_appropiate_hold_process'].'",';
			$row .= '"'.$user['avoid_internal_jargon'].'",';
			$row .= '"'.$user['validate_issue_was_resolved'].'",';
			$row .= '"'.$user['ask_any_additional_assistance'].'",';
			$row .= '"'.$user['properly_close_the_call'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt1'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt2'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt3'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt4'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt5'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt6'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt7'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt8'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt9'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt10'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt11'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt12'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt13'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt14'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt15'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt16'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt17'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt18'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['cmt19'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['call_summary'])).'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['feedback'])).'",';
			$row .= '"'.$user['agnt_fd_acpt'].'",';
			$row .= '"'.$user['agent_rvw_date'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['agent_rvw_note'])).'",';
			$row .= '"'.$user['mgnt_rvw_date'].'",';
			$row .= '"'.$user['mgnt_rvw_name'].'",';
			$row .= '"'. str_replace('"',"'",str_replace($searches, "", $user['mgnt_rvw_note'])).'"';

			fwrite($fopen,$row."\r\n");
		}
		fclose($fopen);

	}




//////////////////////////////////////////////////////////////////////////////////////////////////////
}
